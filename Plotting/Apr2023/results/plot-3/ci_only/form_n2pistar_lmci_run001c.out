Rank =    0  Free Memory = 52313 MB
Rank =    1  Free Memory = 52308 MB
Rank =    2  Free Memory = 52308 MB
Rank =    3  Free Memory = 52308 MB
Rank =    4  Free Memory = 52307 MB
Rank =    5  Free Memory = 52307 MB
Rank =    6  Free Memory = 52307 MB
Rank =    7  Free Memory = 52307 MB
Rank =    8  Free Memory = 52307 MB
Rank =    9  Free Memory = 52307 MB
Rank =   10  Free Memory = 52307 MB
Rank =   11  Free Memory = 52307 MB
Rank =   12  Free Memory = 52307 MB
Rank =   13  Free Memory = 52307 MB
Rank =   14  Free Memory = 52307 MB
Rank =   15  Free Memory = 52294 MB
Rank =   16  Free Memory = 52290 MB
Rank =   17  Free Memory = 52290 MB
Rank =   18  Free Memory = 52290 MB
Rank =   19  Free Memory = 52290 MB
Rank =   20  Free Memory = 52290 MB
Rank =   21  Free Memory = 52290 MB
Rank =   22  Free Memory = 52290 MB
Rank =   23  Free Memory = 52290 MB
Rank =   24  Free Memory = 54574 MB
Rank =   25  Free Memory = 54574 MB
Rank =   26  Free Memory = 54574 MB
Rank =   27  Free Memory = 54573 MB
Rank =   28  Free Memory = 54573 MB
Rank =   29  Free Memory = 54573 MB
Rank =   30  Free Memory = 54573 MB
Rank =   31  Free Memory = 54573 MB
Rank =   32  Free Memory = 54573 MB
Rank =   33  Free Memory = 54573 MB
Rank =   34  Free Memory = 54573 MB
Rank =   35  Free Memory = 54573 MB
Rank =   36  Free Memory = 54573 MB
Rank =   37  Free Memory = 54573 MB
Rank =   38  Free Memory = 54573 MB
Rank =   39  Free Memory = 54573 MB
Rank =   40  Free Memory = 54573 MB
Rank =   41  Free Memory = 54573 MB
Rank =   42  Free Memory = 54573 MB
Rank =   43  Free Memory = 54573 MB
Rank =   44  Free Memory = 54573 MB
Rank =   45  Free Memory = 54573 MB
Rank =   46  Free Memory = 54573 MB
Rank =   47  Free Memory = 54573 MB
Rank =   48  Free Memory = 52422 MB
Rank =   49  Free Memory = 52422 MB
Rank =   50  Free Memory = 52422 MB
Rank =   51  Free Memory = 52422 MB
Rank =   52  Free Memory = 52422 MB
Rank =   53  Free Memory = 52422 MB
Rank =   54  Free Memory = 52422 MB
Rank =   55  Free Memory = 52422 MB
Rank =   56  Free Memory = 52422 MB
Rank =   57  Free Memory = 52422 MB
Rank =   58  Free Memory = 52422 MB
Rank =   59  Free Memory = 52422 MB
Rank =   60  Free Memory = 52422 MB
Rank =   61  Free Memory = 52422 MB
Rank =   62  Free Memory = 52422 MB
Rank =   63  Free Memory = 52422 MB
Rank =   64  Free Memory = 52422 MB
Rank =   65  Free Memory = 52422 MB
Rank =   66  Free Memory = 52422 MB
Rank =   67  Free Memory = 52422 MB
Rank =   68  Free Memory = 52422 MB
Rank =   69  Free Memory = 52422 MB
Rank =   70  Free Memory = 52422 MB
Rank =   71  Free Memory = 52422 MB
Rank =   72  Free Memory = 50669 MB
Rank =   73  Free Memory = 50669 MB
Rank =   74  Free Memory = 50669 MB
Rank =   75  Free Memory = 50669 MB
Rank =   76  Free Memory = 50669 MB
Rank =   77  Free Memory = 50669 MB
Rank =   78  Free Memory = 50669 MB
Rank =   79  Free Memory = 50669 MB
Rank =   80  Free Memory = 50669 MB
Rank =   81  Free Memory = 50669 MB
Rank =   82  Free Memory = 50669 MB
Rank =   83  Free Memory = 50669 MB
Rank =   84  Free Memory = 50669 MB
Rank =   85  Free Memory = 50669 MB
Rank =   86  Free Memory = 50669 MB
Rank =   87  Free Memory = 50669 MB
Rank =   88  Free Memory = 50669 MB
Rank =   89  Free Memory = 50669 MB
Rank =   90  Free Memory = 50669 MB
Rank =   91  Free Memory = 50663 MB
Rank =   92  Free Memory = 50662 MB
Rank =   93  Free Memory = 50662 MB
Rank =   94  Free Memory = 50662 MB
Rank =   95  Free Memory = 50662 MB
  Input file(s): opt_form_n2pistar_lmci_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 96
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 96
  MPI ranks per node        = 24
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_lmci_run001c.xml

  Project = FORM
  date    = 2023-05-02 12:06:38 PDT
  host    = n0112.savio2

 Random Number
 -------------
  Offset for the random number seeds based on time: 830

  Range of prime numbers to use as seeds over processors and threads = 6379-7253


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0
  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 10.1859

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.00067
Norm of qchem ci vector (sum of qchem_ci^2): 0
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 1.405

  Adding pseudopotential for O
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 1.075

  Adding pseudopotential for H1
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001

  Adding pseudopotential for H2
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 0.2004 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAB source=e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.3367
    reference variance = 2.55012
====================================================
  Execution time = 2.4552e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0284e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7658e+00
  Total weights = 1.949753753e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9470e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818945850358
                                         uncertainty =       0.051907564535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818945850358
                                         uncertainty =       0.051907564535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381675929
  error estimate for blocks of size 2^( 2) =       0.001452107392
  error estimate for blocks of size 2^( 3) =       0.001514839852
  error estimate for blocks of size 2^( 4) =       0.001559699327
  error estimate for blocks of size 2^( 5) =       0.001584914052
  error estimate for blocks of size 2^( 6) =       0.001599302979
  error estimate for blocks of size 2^( 7) =       0.001594893938

      target function =                  N/A
              le_mean =     -22.326267149040
             les_mean =     502.228046302785
             stat err =       0.001584702574
             autocorr =       1.315476650567
              std dev =       1.954016100462
             le_variance =       3.818178920864


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.232626714904e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326267148236       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326305037045       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326308991511       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326308931803       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326308825838       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.446250e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326267148236       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326281294081       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326281794377       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326281797434       residual = 9.92e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 4.481383e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326267148236       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326271182298       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326271250763       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 1.251151e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.003609 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0510e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001 -6.962311e-01                3 1 ON  0
ci_002 -7.042540e-01                3 1 ON  1
ci_003 -6.185033e-02                3 1 ON  2
ci_004 -6.194734e-02                3 1 ON  3
ci_005 4.562366e-02                 3 1 ON  4
ci_006 4.624120e-02                 3 1 ON  5
ci_007 3.158082e-02                 3 1 ON  6
ci_008 3.151900e-02                 3 1 ON  7
ci_009 -2.499692e-02                3 1 ON  8
ci_010 -2.552110e-02                3 1 ON  9
ci_011 -2.255459e-02                3 1 ON  10
ci_012 -2.263017e-02                3 1 ON  11
ci_013 1.990940e-02                 3 1 ON  12
ci_014 2.018792e-02                 3 1 ON  13
ci_015 1.967761e-02                 3 1 ON  14
ci_016 2.068968e-02                 3 1 ON  15
ci_017 1.556335e-02                 3 1 ON  16
ci_018 1.582507e-02                 3 1 ON  17
ci_019 1.073089e-02                 3 1 ON  18
ci_020 1.052569e-02                 3 1 ON  19
ci_021 -9.972512e-03                3 1 ON  20
ci_022 -9.387869e-03                3 1 ON  21
ci_023 8.722680e-03                 3 1 ON  22
ci_024 9.485372e-03                 3 1 ON  23
ci_025 7.258239e-03                 3 1 ON  24
ci_026 8.096471e-03                 3 1 ON  25
ci_027 7.704847e-03                 3 1 ON  26
ci_028 7.810375e-03                 3 1 ON  27
ci_029 -7.606447e-03                3 1 ON  28
ci_030 -7.791503e-03                3 1 ON  29
ci_031 -7.193387e-03                3 1 ON  30
ci_032 -7.734700e-03                3 1 ON  31
ci_033 6.860613e-03                 3 1 ON  32
ci_034 6.523402e-03                 3 1 ON  33
ci_035 6.398627e-03                 3 1 ON  34
ci_036 7.035257e-03                 3 1 ON  35
ci_037 6.688338e-03                 3 1 ON  36
ci_038 5.704332e-03                 3 1 ON  37
ci_039 5.819872e-03                 3 1 ON  38
ci_040 6.170981e-03                 3 1 ON  39
ci_041 5.195299e-03                 3 1 ON  40
ci_042 5.058181e-03                 3 1 ON  41
ci_043 5.102848e-03                 3 1 ON  42
ci_044 4.548139e-03                 3 1 ON  43
ci_045 5.251577e-03                 3 1 ON  44
ci_046 5.367252e-03                 3 1 ON  45
ci_047 -4.005526e-03                3 1 ON  46
ci_048 -4.077805e-03                3 1 ON  47
ci_049 4.015724e-03                 3 1 ON  48
ci_050 3.354731e-03                 3 1 ON  49
ci_051 -3.024810e-03                3 1 ON  50
ci_052 -2.410447e-03                3 1 ON  51
ci_053 -2.752439e-03                3 1 ON  52
ci_054 -2.997712e-03                3 1 ON  53
ci_055 -1.890553e-03                3 1 ON  54
ci_056 -2.229603e-03                3 1 ON  55
ci_057 -1.968387e-03                3 1 ON  56
ci_058 -1.908580e-03                3 1 ON  57
ci_059 -2.073076e-03                3 1 ON  58
ci_060 -1.744201e-03                3 1 ON  59
ci_061 -1.944758e-03                3 1 ON  60
ci_062 -1.923339e-03                3 1 ON  61
ci_063 -1.774805e-03                3 1 ON  62
ci_064 -9.257977e-04                3 1 ON  63
ci_065 -1.651660e-03                3 1 ON  64
ci_066 -1.532578e-03                3 1 ON  65
ci_067 -1.727013e-03                3 1 ON  66
ci_068 -1.339109e-03                3 1 ON  67
ci_069 1.110419e-03                 3 1 ON  68
ci_070 1.655266e-03                 3 1 ON  69
ci_071 -1.349796e-04                3 1 ON  70
ci_072 -3.555785e-04                3 1 ON  71
ci_073 1.505672e-03                 3 1 ON  72
ci_074 1.019535e-03                 3 1 ON  73
ci_075 -1.393582e-03                3 1 ON  74
ci_076 -7.949279e-04                3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.427
    reference variance = 3.51739
====================================================
  Execution time = 2.6362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7255e+00
  Total weights = 1.9500e+06
  Execution time = 4.4193e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776306117236
                                         uncertainty =       0.025668361207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776306117236
                                         uncertainty =       0.025668361207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374313471
  error estimate for blocks of size 2^( 2) =       0.001445990157
  error estimate for blocks of size 2^( 3) =       0.001509541210
  error estimate for blocks of size 2^( 4) =       0.001555752331
  error estimate for blocks of size 2^( 5) =       0.001580947762
  error estimate for blocks of size 2^( 6) =       0.001593163745
  error estimate for blocks of size 2^( 7) =       0.001586218920

      target function =                  N/A
              le_mean =     -22.327025730212
             les_mean =     502.233219113564
             stat err =       0.001579020690
             autocorr =       1.320091497940
              std dev =       1.943603846725
             le_variance =       3.777595913005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776292733998
                                         uncertainty =       0.025663936373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776292733998
                                         uncertainty =       0.025663936373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374311351
  error estimate for blocks of size 2^( 2) =       0.001446015831
  error estimate for blocks of size 2^( 3) =       0.001509586249
  error estimate for blocks of size 2^( 4) =       0.001555814103
  error estimate for blocks of size 2^( 5) =       0.001581019350
  error estimate for blocks of size 2^( 6) =       0.001593216346
  error estimate for blocks of size 2^( 7) =       0.001586266454

      target function =                  N/A
              le_mean =     -22.327027056882
             les_mean =     502.223824347004
             stat err =       0.001579079063
             autocorr =       1.320193175738
              std dev =       1.943600848536
             le_variance =       3.777584258428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776261567049
                                         uncertainty =       0.025663837903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776261567049
                                         uncertainty =       0.025663837903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374305621
  error estimate for blocks of size 2^( 2) =       0.001446005114
  error estimate for blocks of size 2^( 3) =       0.001509575678
  error estimate for blocks of size 2^( 4) =       0.001555798055
  error estimate for blocks of size 2^( 5) =       0.001581000423
  error estimate for blocks of size 2^( 6) =       0.001593202469
  error estimate for blocks of size 2^( 7) =       0.001586246109

      target function =                  N/A
              le_mean =     -22.327020746480
             les_mean =     502.229708701426
             stat err =       0.001579061764
             autocorr =       1.320175259293
              std dev =       1.943592744385
             le_variance =       3.777552756025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776290889685
                                         uncertainty =       0.025667576672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.776290889685
                                         uncertainty =       0.025667576672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374310740
  error estimate for blocks of size 2^( 2) =       0.001445991560
  error estimate for blocks of size 2^( 3) =       0.001509546266
  error estimate for blocks of size 2^( 4) =       0.001555761073
  error estimate for blocks of size 2^( 5) =       0.001580956862
  error estimate for blocks of size 2^( 6) =       0.001593171477
  error estimate for blocks of size 2^( 7) =       0.001586229707

      target function =                  N/A
              le_mean =     -22.327022509605
             les_mean =     502.221533513723
             stat err =       0.001579029780
             autocorr =       1.320111944155
              std dev =       1.943599983975
             le_variance =       3.777580897709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327025730212        initial
     2.5000e-01     2.5000e+00             1.4463e-03       -22.327027056882  <--
     1.0000e+00     1.0000e+01             4.4814e-04       -22.327020746480
     4.0000e+00     4.0000e+01             1.2512e-04       -22.327022509605

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.8477e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001                -6.959076e-01 3 1  ON 0
ci_002                -7.047152e-01 3 1  ON 1
ci_003                -6.180715e-02 3 1  ON 2
ci_004                -6.091310e-02 3 1  ON 3
ci_005                 4.500245e-02 3 1  ON 4
ci_006                 4.635365e-02 3 1  ON 5
ci_007                 3.117434e-02 3 1  ON 6
ci_008                 3.163824e-02 3 1  ON 7
ci_009                -2.497826e-02 3 1  ON 8
ci_010                -2.554777e-02 3 1  ON 9
ci_011                -2.195853e-02 3 1  ON 10
ci_012                -2.278966e-02 3 1  ON 11
ci_013                 1.980977e-02 3 1  ON 12
ci_014                 2.018892e-02 3 1  ON 13
ci_015                 1.962655e-02 3 1  ON 14
ci_016                 2.057211e-02 3 1  ON 15
ci_017                 1.593579e-02 3 1  ON 16
ci_018                 1.602135e-02 3 1  ON 17
ci_019                 1.093764e-02 3 1  ON 18
ci_020                 1.071984e-02 3 1  ON 19
ci_021                -1.036852e-02 3 1  ON 20
ci_022                -9.245310e-03 3 1  ON 21
ci_023                 8.697470e-03 3 1  ON 22
ci_024                 9.467703e-03 3 1  ON 23
ci_025                 7.451936e-03 3 1  ON 24
ci_026                 7.970701e-03 3 1  ON 25
ci_027                 7.410285e-03 3 1  ON 26
ci_028                 7.738539e-03 3 1  ON 27
ci_029                -7.525756e-03 3 1  ON 28
ci_030                -7.820652e-03 3 1  ON 29
ci_031                -7.182574e-03 3 1  ON 30
ci_032                -8.108766e-03 3 1  ON 31
ci_033                 6.874069e-03 3 1  ON 32
ci_034                 6.877569e-03 3 1  ON 33
ci_035                 6.337836e-03 3 1  ON 34
ci_036                 7.148337e-03 3 1  ON 35
ci_037                 6.978339e-03 3 1  ON 36
ci_038                 5.856070e-03 3 1  ON 37
ci_039                 5.727669e-03 3 1  ON 38
ci_040                 6.217692e-03 3 1  ON 39
ci_041                 4.833463e-03 3 1  ON 40
ci_042                 4.971201e-03 3 1  ON 41
ci_043                 5.105560e-03 3 1  ON 42
ci_044                 4.733178e-03 3 1  ON 43
ci_045                 5.486566e-03 3 1  ON 44
ci_046                 5.508061e-03 3 1  ON 45
ci_047                -4.033360e-03 3 1  ON 46
ci_048                -3.634325e-03 3 1  ON 47
ci_049                 3.964218e-03 3 1  ON 48
ci_050                 3.148663e-03 3 1  ON 49
ci_051                -2.913371e-03 3 1  ON 50
ci_052                -2.782766e-03 3 1  ON 51
ci_053                -2.814661e-03 3 1  ON 52
ci_054                -2.176320e-03 3 1  ON 53
ci_055                -1.821739e-03 3 1  ON 54
ci_056                -2.694844e-03 3 1  ON 55
ci_057                -2.263489e-03 3 1  ON 56
ci_058                -2.040246e-03 3 1  ON 57
ci_059                -2.321949e-03 3 1  ON 58
ci_060                -1.255763e-03 3 1  ON 59
ci_061                -2.099071e-03 3 1  ON 60
ci_062                -1.920019e-03 3 1  ON 61
ci_063                -1.481563e-03 3 1  ON 62
ci_064                -8.957188e-04 3 1  ON 63
ci_065                -1.443712e-03 3 1  ON 64
ci_066                -1.720348e-03 3 1  ON 65
ci_067                -1.296074e-03 3 1  ON 66
ci_068                -9.662200e-04 3 1  ON 67
ci_069                 1.017090e-03 3 1  ON 68
ci_070                 1.743833e-03 3 1  ON 69
ci_071                -3.902317e-04 3 1  ON 70
ci_072                -5.090122e-04 3 1  ON 71
ci_073                 1.709543e-03 3 1  ON 72
ci_074                 1.168697e-03 3 1  ON 73
ci_075                -1.487872e-03 3 1  ON 74
ci_076                -9.044921e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8996e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2382e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.2303
    reference variance = 3.48846
====================================================
  Execution time = 2.4497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0325e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.9063e+00
  Total weights = 1.950158954e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9815e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.961847339673
                                         uncertainty =       0.082235248355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.961847339673
                                         uncertainty =       0.082235248355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001407318122
  error estimate for blocks of size 2^( 2) =       0.001475849663
  error estimate for blocks of size 2^( 3) =       0.001538140107
  error estimate for blocks of size 2^( 4) =       0.001579931285
  error estimate for blocks of size 2^( 5) =       0.001604895714
  error estimate for blocks of size 2^( 6) =       0.001619308204
  error estimate for blocks of size 2^( 7) =       0.001628379554

      target function =                  N/A
              le_mean =     -22.326075518654
             les_mean =     502.359985419291
             stat err =       0.001608128689
             autocorr =       1.305740996062
              std dev =       1.990280218048
             le_variance =       3.961215346351


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232607551865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326075517870       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326185977010       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326192728542       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326194730624       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326195277813       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326195301242       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 2.305066e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326075517870       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326139169666       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326140399223       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326140640051       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.276111e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326075517870       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326099135993       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326099175225       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326099181374       residual = 6.23e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 4.547061e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005453 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0486e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -6.959344e-01 3 1  ON 0
ci_002                -7.046289e-01 3 1  ON 1
ci_003                -6.115080e-02 3 1  ON 2
ci_004                -6.117176e-02 3 1  ON 3
ci_005                 4.517196e-02 3 1  ON 4
ci_006                 4.633231e-02 3 1  ON 5
ci_007                 3.165242e-02 3 1  ON 6
ci_008                 3.187079e-02 3 1  ON 7
ci_009                -2.466147e-02 3 1  ON 8
ci_010                -2.548415e-02 3 1  ON 9
ci_011                -2.174587e-02 3 1  ON 10
ci_012                -2.363846e-02 3 1  ON 11
ci_013                 1.977738e-02 3 1  ON 12
ci_014                 2.086059e-02 3 1  ON 13
ci_015                 1.994715e-02 3 1  ON 14
ci_016                 2.110658e-02 3 1  ON 15
ci_017                 1.639262e-02 3 1  ON 16
ci_018                 1.624510e-02 3 1  ON 17
ci_019                 1.037733e-02 3 1  ON 18
ci_020                 1.003368e-02 3 1  ON 19
ci_021                -9.875007e-03 3 1  ON 20
ci_022                -1.008772e-02 3 1  ON 21
ci_023                 9.085792e-03 3 1  ON 22
ci_024                 9.403007e-03 3 1  ON 23
ci_025                 7.970204e-03 3 1  ON 24
ci_026                 8.390348e-03 3 1  ON 25
ci_027                 8.254525e-03 3 1  ON 26
ci_028                 7.628197e-03 3 1  ON 27
ci_029                -7.828043e-03 3 1  ON 28
ci_030                -7.880877e-03 3 1  ON 29
ci_031                -7.571117e-03 3 1  ON 30
ci_032                -7.710313e-03 3 1  ON 31
ci_033                 6.737649e-03 3 1  ON 32
ci_034                 7.433096e-03 3 1  ON 33
ci_035                 5.995809e-03 3 1  ON 34
ci_036                 7.225943e-03 3 1  ON 35
ci_037                 6.721866e-03 3 1  ON 36
ci_038                 6.243033e-03 3 1  ON 37
ci_039                 5.928993e-03 3 1  ON 38
ci_040                 5.517287e-03 3 1  ON 39
ci_041                 4.897942e-03 3 1  ON 40
ci_042                 4.841908e-03 3 1  ON 41
ci_043                 4.528345e-03 3 1  ON 42
ci_044                 3.968286e-03 3 1  ON 43
ci_045                 5.573608e-03 3 1  ON 44
ci_046                 4.920951e-03 3 1  ON 45
ci_047                -4.026257e-03 3 1  ON 46
ci_048                -4.115056e-03 3 1  ON 47
ci_049                 2.688107e-03 3 1  ON 48
ci_050                 3.268493e-03 3 1  ON 49
ci_051                -2.867721e-03 3 1  ON 50
ci_052                -3.202197e-03 3 1  ON 51
ci_053                -2.513066e-03 3 1  ON 52
ci_054                -2.422647e-03 3 1  ON 53
ci_055                -1.530008e-03 3 1  ON 54
ci_056                -2.036290e-03 3 1  ON 55
ci_057                -2.630930e-03 3 1  ON 56
ci_058                -2.097304e-03 3 1  ON 57
ci_059                -2.022147e-03 3 1  ON 58
ci_060                -1.298713e-03 3 1  ON 59
ci_061                -1.964890e-03 3 1  ON 60
ci_062                -1.966129e-03 3 1  ON 61
ci_063                -1.037136e-03 3 1  ON 62
ci_064                -1.726337e-03 3 1  ON 63
ci_065                -1.845131e-03 3 1  ON 64
ci_066                -1.209089e-03 3 1  ON 65
ci_067                -1.822295e-03 3 1  ON 66
ci_068                -1.246414e-03 3 1  ON 67
ci_069                 1.732105e-03 3 1  ON 68
ci_070                 1.648752e-03 3 1  ON 69
ci_071                -6.013585e-04 3 1  ON 70
ci_072                -5.598558e-04 3 1  ON 71
ci_073                 1.590752e-03 3 1  ON 72
ci_074                 1.069985e-03 3 1  ON 73
ci_075                -9.781117e-04 3 1  ON 74
ci_076                -1.145440e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.2045
    reference variance = 4.35414
====================================================
  Execution time = 2.3858e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7107e+00
  Total weights = 1.9497e+06
  Execution time = 4.4207e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763713764840
                                         uncertainty =       0.032543904006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763713764840
                                         uncertainty =       0.032543904006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371828668
  error estimate for blocks of size 2^( 2) =       0.001442839825
  error estimate for blocks of size 2^( 3) =       0.001507029005
  error estimate for blocks of size 2^( 4) =       0.001551584771
  error estimate for blocks of size 2^( 5) =       0.001573710490
  error estimate for blocks of size 2^( 6) =       0.001589816726
  error estimate for blocks of size 2^( 7) =       0.001597657477

      target function =                  N/A
              le_mean =     -22.329945823797
             les_mean =     502.667946500133
             stat err =       0.001578192366
             autocorr =       1.323488365444
              std dev =       1.940089748482
             le_variance =       3.763948232163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762849577092
                                         uncertainty =       0.032465319617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762849577092
                                         uncertainty =       0.032465319617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371671713
  error estimate for blocks of size 2^( 2) =       0.001442654593
  error estimate for blocks of size 2^( 3) =       0.001506846699
  error estimate for blocks of size 2^( 4) =       0.001551394173
  error estimate for blocks of size 2^( 5) =       0.001573470963
  error estimate for blocks of size 2^( 6) =       0.001589504619
  error estimate for blocks of size 2^( 7) =       0.001597352784

      target function =                  N/A
              le_mean =     -22.329908968841
             les_mean =     502.382237263151
             stat err =       0.001577930634
             autocorr =       1.323352219729
              std dev =       1.939867777149
             le_variance =       3.763086992823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763374358064
                                         uncertainty =       0.032497224491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763374358064
                                         uncertainty =       0.032497224491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371767152
  error estimate for blocks of size 2^( 2) =       0.001442745886
  error estimate for blocks of size 2^( 3) =       0.001506941082
  error estimate for blocks of size 2^( 4) =       0.001551470740
  error estimate for blocks of size 2^( 5) =       0.001573531002
  error estimate for blocks of size 2^( 6) =       0.001589570546
  error estimate for blocks of size 2^( 7) =       0.001597397846

      target function =                  N/A
              le_mean =     -22.329902868998
             les_mean =     503.292478902630
             stat err =       0.001577992533
             autocorr =       1.323271897201
              std dev =       1.940002750301
             le_variance =       3.763610671174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762463215383
                                         uncertainty =       0.032476056324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762463215383
                                         uncertainty =       0.032476056324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371601217
  error estimate for blocks of size 2^( 2) =       0.001442603737
  error estimate for blocks of size 2^( 3) =       0.001506795778
  error estimate for blocks of size 2^( 4) =       0.001551368993
  error estimate for blocks of size 2^( 5) =       0.001573479059
  error estimate for blocks of size 2^( 6) =       0.001589534296
  error estimate for blocks of size 2^( 7) =       0.001597385968

      target function =                  N/A
              le_mean =     -22.329900397965
             les_mean =     502.371135754267
             stat err =       0.001577942079
             autocorr =       1.323507454503
              std dev =       1.939768078598
             le_variance =       3.762700198748


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329945823797        initial  <--
     6.2500e-02     6.2500e-01             2.3051e-03       -22.329908968841
     2.5000e-01     2.5000e+00             1.2761e-03       -22.329902868998
     1.0000e+00     1.0000e+01             4.5471e-04       -22.329900397965

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.0306
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -6.959076e-01 3 1  ON 0
ci_002                -7.047152e-01 3 1  ON 1
ci_003                -6.180715e-02 3 1  ON 2
ci_004                -6.091310e-02 3 1  ON 3
ci_005                 4.500245e-02 3 1  ON 4
ci_006                 4.635365e-02 3 1  ON 5
ci_007                 3.117434e-02 3 1  ON 6
ci_008                 3.163824e-02 3 1  ON 7
ci_009                -2.497826e-02 3 1  ON 8
ci_010                -2.554777e-02 3 1  ON 9
ci_011                -2.195853e-02 3 1  ON 10
ci_012                -2.278966e-02 3 1  ON 11
ci_013                 1.980977e-02 3 1  ON 12
ci_014                 2.018892e-02 3 1  ON 13
ci_015                 1.962655e-02 3 1  ON 14
ci_016                 2.057211e-02 3 1  ON 15
ci_017                 1.593579e-02 3 1  ON 16
ci_018                 1.602135e-02 3 1  ON 17
ci_019                 1.093764e-02 3 1  ON 18
ci_020                 1.071984e-02 3 1  ON 19
ci_021                -1.036852e-02 3 1  ON 20
ci_022                -9.245310e-03 3 1  ON 21
ci_023                 8.697470e-03 3 1  ON 22
ci_024                 9.467703e-03 3 1  ON 23
ci_025                 7.451936e-03 3 1  ON 24
ci_026                 7.970701e-03 3 1  ON 25
ci_027                 7.410285e-03 3 1  ON 26
ci_028                 7.738539e-03 3 1  ON 27
ci_029                -7.525756e-03 3 1  ON 28
ci_030                -7.820652e-03 3 1  ON 29
ci_031                -7.182574e-03 3 1  ON 30
ci_032                -8.108766e-03 3 1  ON 31
ci_033                 6.874069e-03 3 1  ON 32
ci_034                 6.877569e-03 3 1  ON 33
ci_035                 6.337836e-03 3 1  ON 34
ci_036                 7.148337e-03 3 1  ON 35
ci_037                 6.978339e-03 3 1  ON 36
ci_038                 5.856070e-03 3 1  ON 37
ci_039                 5.727669e-03 3 1  ON 38
ci_040                 6.217692e-03 3 1  ON 39
ci_041                 4.833463e-03 3 1  ON 40
ci_042                 4.971201e-03 3 1  ON 41
ci_043                 5.105560e-03 3 1  ON 42
ci_044                 4.733178e-03 3 1  ON 43
ci_045                 5.486566e-03 3 1  ON 44
ci_046                 5.508061e-03 3 1  ON 45
ci_047                -4.033360e-03 3 1  ON 46
ci_048                -3.634325e-03 3 1  ON 47
ci_049                 3.964218e-03 3 1  ON 48
ci_050                 3.148663e-03 3 1  ON 49
ci_051                -2.913371e-03 3 1  ON 50
ci_052                -2.782766e-03 3 1  ON 51
ci_053                -2.814661e-03 3 1  ON 52
ci_054                -2.176320e-03 3 1  ON 53
ci_055                -1.821739e-03 3 1  ON 54
ci_056                -2.694844e-03 3 1  ON 55
ci_057                -2.263489e-03 3 1  ON 56
ci_058                -2.040246e-03 3 1  ON 57
ci_059                -2.321949e-03 3 1  ON 58
ci_060                -1.255763e-03 3 1  ON 59
ci_061                -2.099071e-03 3 1  ON 60
ci_062                -1.920019e-03 3 1  ON 61
ci_063                -1.481563e-03 3 1  ON 62
ci_064                -8.957188e-04 3 1  ON 63
ci_065                -1.443712e-03 3 1  ON 64
ci_066                -1.720348e-03 3 1  ON 65
ci_067                -1.296074e-03 3 1  ON 66
ci_068                -9.662200e-04 3 1  ON 67
ci_069                 1.017090e-03 3 1  ON 68
ci_070                 1.743833e-03 3 1  ON 69
ci_071                -3.902317e-04 3 1  ON 70
ci_072                -5.090122e-04 3 1  ON 71
ci_073                 1.709543e-03 3 1  ON 72
ci_074                 1.168697e-03 3 1  ON 73
ci_075                -1.487872e-03 3 1  ON 74
ci_076                -9.044921e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6528e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2300e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.3342
    reference variance = 2.54813
====================================================
  Execution time = 2.4360e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0308e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6899e+00
  Total weights = 1.950087357e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9954e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741846783620
                                         uncertainty =       0.044408928998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741846783620
                                         uncertainty =       0.044408928998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367773223
  error estimate for blocks of size 2^( 2) =       0.001439106923
  error estimate for blocks of size 2^( 3) =       0.001503156163
  error estimate for blocks of size 2^( 4) =       0.001545486586
  error estimate for blocks of size 2^( 5) =       0.001571734227
  error estimate for blocks of size 2^( 6) =       0.001579274745
  error estimate for blocks of size 2^( 7) =       0.001587208552

      target function =                  N/A
              le_mean =     -22.329386528615
             les_mean =     502.291386944285
             stat err =       0.001570926027
             autocorr =       1.319116874696
              std dev =       1.934354390748
             le_variance =       3.741726909007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232938652861e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329386527767       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329407556147       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329407655433       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329407677481       residual = 1.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 5.593575e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329386527767       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329392969717       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329392966143       residual = 6.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.670419e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329386527767       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329388234415       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329388232792       residual = 2.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 4.416650e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006755 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0362e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -6.959076e-01 3 1  ON 0
ci_002                -7.047127e-01 3 1  ON 1
ci_003                -6.179913e-02 3 1  ON 2
ci_004                -6.091309e-02 3 1  ON 3
ci_005                 4.503935e-02 3 1  ON 4
ci_006                 4.636306e-02 3 1  ON 5
ci_007                 3.118108e-02 3 1  ON 6
ci_008                 3.171694e-02 3 1  ON 7
ci_009                -2.493661e-02 3 1  ON 8
ci_010                -2.554865e-02 3 1  ON 9
ci_011                -2.200153e-02 3 1  ON 10
ci_012                -2.276344e-02 3 1  ON 11
ci_013                 1.982088e-02 3 1  ON 12
ci_014                 2.008610e-02 3 1  ON 13
ci_015                 1.968256e-02 3 1  ON 14
ci_016                 2.049895e-02 3 1  ON 15
ci_017                 1.599164e-02 3 1  ON 16
ci_018                 1.602196e-02 3 1  ON 17
ci_019                 1.089725e-02 3 1  ON 18
ci_020                 1.068175e-02 3 1  ON 19
ci_021                -1.038365e-02 3 1  ON 20
ci_022                -9.254991e-03 3 1  ON 21
ci_023                 8.735081e-03 3 1  ON 22
ci_024                 9.428085e-03 3 1  ON 23
ci_025                 7.475683e-03 3 1  ON 24
ci_026                 7.986233e-03 3 1  ON 25
ci_027                 7.443400e-03 3 1  ON 26
ci_028                 7.681055e-03 3 1  ON 27
ci_029                -7.505516e-03 3 1  ON 28
ci_030                -7.907920e-03 3 1  ON 29
ci_031                -7.293664e-03 3 1  ON 30
ci_032                -8.080308e-03 3 1  ON 31
ci_033                 6.905630e-03 3 1  ON 32
ci_034                 6.859427e-03 3 1  ON 33
ci_035                 6.368799e-03 3 1  ON 34
ci_036                 7.136741e-03 3 1  ON 35
ci_037                 6.879465e-03 3 1  ON 36
ci_038                 5.888001e-03 3 1  ON 37
ci_039                 5.617878e-03 3 1  ON 38
ci_040                 6.182770e-03 3 1  ON 39
ci_041                 4.886608e-03 3 1  ON 40
ci_042                 4.906771e-03 3 1  ON 41
ci_043                 5.164734e-03 3 1  ON 42
ci_044                 4.655007e-03 3 1  ON 43
ci_045                 5.494613e-03 3 1  ON 44
ci_046                 5.556115e-03 3 1  ON 45
ci_047                -3.870367e-03 3 1  ON 46
ci_048                -3.740097e-03 3 1  ON 47
ci_049                 3.929851e-03 3 1  ON 48
ci_050                 3.296285e-03 3 1  ON 49
ci_051                -2.972396e-03 3 1  ON 50
ci_052                -2.790039e-03 3 1  ON 51
ci_053                -2.828471e-03 3 1  ON 52
ci_054                -2.255417e-03 3 1  ON 53
ci_055                -1.769005e-03 3 1  ON 54
ci_056                -2.619162e-03 3 1  ON 55
ci_057                -2.177107e-03 3 1  ON 56
ci_058                -2.083932e-03 3 1  ON 57
ci_059                -2.317990e-03 3 1  ON 58
ci_060                -1.320635e-03 3 1  ON 59
ci_061                -2.060087e-03 3 1  ON 60
ci_062                -1.883689e-03 3 1  ON 61
ci_063                -1.526727e-03 3 1  ON 62
ci_064                -9.589189e-04 3 1  ON 63
ci_065                -1.409353e-03 3 1  ON 64
ci_066                -1.553306e-03 3 1  ON 65
ci_067                -1.288732e-03 3 1  ON 66
ci_068                -9.932583e-04 3 1  ON 67
ci_069                 1.006024e-03 3 1  ON 68
ci_070                 1.773132e-03 3 1  ON 69
ci_071                -4.841095e-04 3 1  ON 70
ci_072                -5.107431e-04 3 1  ON 71
ci_073                 1.676582e-03 3 1  ON 72
ci_074                 1.246649e-03 3 1  ON 73
ci_075                -1.478806e-03 3 1  ON 74
ci_076                -9.713155e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.3294
    reference variance = 2.98147
====================================================
  Execution time = 2.3820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7482e+00
  Total weights = 1.9498e+06
  Execution time = 4.4237e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800121475542
                                         uncertainty =       0.044580704474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800121475542
                                         uncertainty =       0.044580704474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378409767
  error estimate for blocks of size 2^( 2) =       0.001449144433
  error estimate for blocks of size 2^( 3) =       0.001512030284
  error estimate for blocks of size 2^( 4) =       0.001556462821
  error estimate for blocks of size 2^( 5) =       0.001583060652
  error estimate for blocks of size 2^( 6) =       0.001592627078
  error estimate for blocks of size 2^( 7) =       0.001601560604

      target function =                  N/A
              le_mean =     -22.326081314059
             les_mean =     502.202183451512
             stat err =       0.001583427789
             autocorr =       1.319592508389
              std dev =       1.949396976811
             le_variance =       3.800148573198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800167816162
                                         uncertainty =       0.044578239187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800167816162
                                         uncertainty =       0.044578239187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378417774
  error estimate for blocks of size 2^( 2) =       0.001449150754
  error estimate for blocks of size 2^( 3) =       0.001512030301
  error estimate for blocks of size 2^( 4) =       0.001556461064
  error estimate for blocks of size 2^( 5) =       0.001583059471
  error estimate for blocks of size 2^( 6) =       0.001592624583
  error estimate for blocks of size 2^( 7) =       0.001601552153

      target function =                  N/A
              le_mean =     -22.326085003043
             les_mean =     502.202596892838
             stat err =       0.001583424318
             autocorr =       1.319571392902
              std dev =       1.949408300522
             le_variance =       3.800192722142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800146642683
                                         uncertainty =       0.044579196450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800146642683
                                         uncertainty =       0.044579196450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378414099
  error estimate for blocks of size 2^( 2) =       0.001449147848
  error estimate for blocks of size 2^( 3) =       0.001512029908
  error estimate for blocks of size 2^( 4) =       0.001556461400
  error estimate for blocks of size 2^( 5) =       0.001583060261
  error estimate for blocks of size 2^( 6) =       0.001592626176
  error estimate for blocks of size 2^( 7) =       0.001601556383

      target function =                  N/A
              le_mean =     -22.326082828022
             les_mean =     502.202354706135
             stat err =       0.001583426055
             autocorr =       1.319581325199
              std dev =       1.949403102806
             le_variance =       3.800172457229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800123861199
                                         uncertainty =       0.044580509529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800123861199
                                         uncertainty =       0.044580509529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378410169
  error estimate for blocks of size 2^( 2) =       0.001449144717
  error estimate for blocks of size 2^( 3) =       0.001512030062
  error estimate for blocks of size 2^( 4) =       0.001556462492
  error estimate for blocks of size 2^( 5) =       0.001583060454
  error estimate for blocks of size 2^( 6) =       0.001592626856
  error estimate for blocks of size 2^( 7) =       0.001601559941

      target function =                  N/A
              le_mean =     -22.326081274714
             les_mean =     502.202142524803
             stat err =       0.001583427436
             autocorr =       1.319591149786
              std dev =       1.949397545727
             le_variance =       3.800150791287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326081314059        initial
     6.2500e-01     6.2500e+00             5.5936e-04       -22.326085003043  <--
     2.5000e+00     2.5000e+01             1.6704e-04       -22.326082828022
     1.0000e+01     1.0000e+02             4.4167e-05       -22.326081274714

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.5955e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -6.959098e-01 3 1  ON 0
ci_002                -7.047057e-01 3 1  ON 1
ci_003                -6.177660e-02 3 1  ON 2
ci_004                -6.091315e-02 3 1  ON 3
ci_005                 4.511824e-02 3 1  ON 4
ci_006                 4.638377e-02 3 1  ON 5
ci_007                 3.119684e-02 3 1  ON 6
ci_008                 3.191077e-02 3 1  ON 7
ci_009                -2.482582e-02 3 1  ON 8
ci_010                -2.555317e-02 3 1  ON 9
ci_011                -2.210741e-02 3 1  ON 10
ci_012                -2.269891e-02 3 1  ON 11
ci_013                 1.983521e-02 3 1  ON 12
ci_014                 1.983750e-02 3 1  ON 13
ci_015                 1.982827e-02 3 1  ON 14
ci_016                 2.030768e-02 3 1  ON 15
ci_017                 1.612788e-02 3 1  ON 16
ci_018                 1.601475e-02 3 1  ON 17
ci_019                 1.080017e-02 3 1  ON 18
ci_020                 1.058360e-02 3 1  ON 19
ci_021                -1.040888e-02 3 1  ON 20
ci_022                -9.285410e-03 3 1  ON 21
ci_023                 8.820082e-03 3 1  ON 22
ci_024                 9.339222e-03 3 1  ON 23
ci_025                 7.530943e-03 3 1  ON 24
ci_026                 8.026925e-03 3 1  ON 25
ci_027                 7.512546e-03 3 1  ON 26
ci_028                 7.565002e-03 3 1  ON 27
ci_029                -7.452619e-03 3 1  ON 28
ci_030                -8.128041e-03 3 1  ON 29
ci_031                -7.559830e-03 3 1  ON 30
ci_032                -8.007061e-03 3 1  ON 31
ci_033                 6.983651e-03 3 1  ON 32
ci_034                 6.809293e-03 3 1  ON 33
ci_035                 6.438307e-03 3 1  ON 34
ci_036                 7.107214e-03 3 1  ON 35
ci_037                 6.652441e-03 3 1  ON 36
ci_038                 5.952645e-03 3 1  ON 37
ci_039                 5.393417e-03 3 1  ON 38
ci_040                 6.117971e-03 3 1  ON 39
ci_041                 4.999707e-03 3 1  ON 40
ci_042                 4.772306e-03 3 1  ON 41
ci_043                 5.295934e-03 3 1  ON 42
ci_044                 4.476149e-03 3 1  ON 43
ci_045                 5.512153e-03 3 1  ON 44
ci_046                 5.669107e-03 3 1  ON 45
ci_047                -3.536786e-03 3 1  ON 46
ci_048                -3.962978e-03 3 1  ON 47
ci_049                 3.847557e-03 3 1  ON 48
ci_050                 3.648144e-03 3 1  ON 49
ci_051                -3.106702e-03 3 1  ON 50
ci_052                -2.812855e-03 3 1  ON 51
ci_053                -2.850217e-03 3 1  ON 52
ci_054                -2.448456e-03 3 1  ON 53
ci_055                -1.642169e-03 3 1  ON 54
ci_056                -2.429841e-03 3 1  ON 55
ci_057                -1.979979e-03 3 1  ON 56
ci_058                -2.185703e-03 3 1  ON 57
ci_059                -2.306251e-03 3 1  ON 58
ci_060                -1.455997e-03 3 1  ON 59
ci_061                -1.979190e-03 3 1  ON 60
ci_062                -1.804854e-03 3 1  ON 61
ci_063                -1.635954e-03 3 1  ON 62
ci_064                -1.114759e-03 3 1  ON 63
ci_065                -1.330604e-03 3 1  ON 64
ci_066                -1.160990e-03 3 1  ON 65
ci_067                -1.273149e-03 3 1  ON 66
ci_068                -1.059416e-03 3 1  ON 67
ci_069                 9.806758e-04 3 1  ON 68
ci_070                 1.840460e-03 3 1  ON 69
ci_071                -6.969154e-04 3 1  ON 70
ci_072                -5.203520e-04 3 1  ON 71
ci_073                 1.614155e-03 3 1  ON 72
ci_074                 1.401649e-03 3 1  ON 73
ci_075                -1.466661e-03 3 1  ON 74
ci_076                -1.124602e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6325e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6435
    reference variance = 2.27125
====================================================
  Execution time = 2.4433e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0352e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7478e+00
  Total weights = 1.950073929e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9133e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795970937685
                                         uncertainty =       0.058548402006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795970937685
                                         uncertainty =       0.058548402006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377532106
  error estimate for blocks of size 2^( 2) =       0.001447928103
  error estimate for blocks of size 2^( 3) =       0.001510146935
  error estimate for blocks of size 2^( 4) =       0.001553218785
  error estimate for blocks of size 2^( 5) =       0.001576498016
  error estimate for blocks of size 2^( 6) =       0.001592305130
  error estimate for blocks of size 2^( 7) =       0.001603818030

      target function =                  N/A
              le_mean =     -22.328546625763
             les_mean =     502.311761164240
             stat err =       0.001581459990
             autocorr =       1.317992560955
              std dev =       1.948155756295
             le_variance =       3.795310850786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232854662576e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328546624943       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328607916352       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328612338964       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328611944298       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328611927673       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.359221e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328546624943       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328572806299       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328573418659       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328573374550       residual = 9.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 5.357439e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328546624943       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328554579499       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328554650399       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.563316e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008304 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0353e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -6.961312e-01 3 1  ON 0
ci_002                -7.045043e-01 3 1  ON 1
ci_003                -6.154024e-02 3 1  ON 2
ci_004                -6.119189e-02 3 1  ON 3
ci_005                 4.521521e-02 3 1  ON 4
ci_006                 4.648671e-02 3 1  ON 5
ci_007                 3.125711e-02 3 1  ON 6
ci_008                 3.154964e-02 3 1  ON 7
ci_009                -2.510054e-02 3 1  ON 8
ci_010                -2.554317e-02 3 1  ON 9
ci_011                -2.223371e-02 3 1  ON 10
ci_012                -2.262411e-02 3 1  ON 11
ci_013                 1.971139e-02 3 1  ON 12
ci_014                 1.961342e-02 3 1  ON 13
ci_015                 2.003083e-02 3 1  ON 14
ci_016                 2.054238e-02 3 1  ON 15
ci_017                 1.583500e-02 3 1  ON 16
ci_018                 1.571984e-02 3 1  ON 17
ci_019                 1.060114e-02 3 1  ON 18
ci_020                 1.053646e-02 3 1  ON 19
ci_021                -1.008805e-02 3 1  ON 20
ci_022                -9.559113e-03 3 1  ON 21
ci_023                 8.628766e-03 3 1  ON 22
ci_024                 9.280980e-03 3 1  ON 23
ci_025                 6.995199e-03 3 1  ON 24
ci_026                 8.139395e-03 3 1  ON 25
ci_027                 7.580533e-03 3 1  ON 26
ci_028                 7.762768e-03 3 1  ON 27
ci_029                -7.191749e-03 3 1  ON 28
ci_030                -8.510222e-03 3 1  ON 29
ci_031                -7.303330e-03 3 1  ON 30
ci_032                -7.751312e-03 3 1  ON 31
ci_033                 6.673594e-03 3 1  ON 32
ci_034                 6.822798e-03 3 1  ON 33
ci_035                 6.506563e-03 3 1  ON 34
ci_036                 6.930347e-03 3 1  ON 35
ci_037                 6.506780e-03 3 1  ON 36
ci_038                 5.808587e-03 3 1  ON 37
ci_039                 5.655110e-03 3 1  ON 38
ci_040                 6.189298e-03 3 1  ON 39
ci_041                 5.165626e-03 3 1  ON 40
ci_042                 5.123211e-03 3 1  ON 41
ci_043                 4.824839e-03 3 1  ON 42
ci_044                 4.493433e-03 3 1  ON 43
ci_045                 5.128070e-03 3 1  ON 44
ci_046                 5.652118e-03 3 1  ON 45
ci_047                -3.934767e-03 3 1  ON 46
ci_048                -4.128291e-03 3 1  ON 47
ci_049                 3.834033e-03 3 1  ON 48
ci_050                 3.234523e-03 3 1  ON 49
ci_051                -2.959500e-03 3 1  ON 50
ci_052                -3.206671e-03 3 1  ON 51
ci_053                -3.032825e-03 3 1  ON 52
ci_054                -2.308584e-03 3 1  ON 53
ci_055                -1.690787e-03 3 1  ON 54
ci_056                -2.350293e-03 3 1  ON 55
ci_057                -2.082542e-03 3 1  ON 56
ci_058                -1.938736e-03 3 1  ON 57
ci_059                -1.994668e-03 3 1  ON 58
ci_060                -1.719648e-03 3 1  ON 59
ci_061                -2.012550e-03 3 1  ON 60
ci_062                -2.067523e-03 3 1  ON 61
ci_063                -1.621006e-03 3 1  ON 62
ci_064                -9.864699e-04 3 1  ON 63
ci_065                -1.221041e-03 3 1  ON 64
ci_066                -1.031890e-03 3 1  ON 65
ci_067                -1.286273e-03 3 1  ON 66
ci_068                -1.083039e-03 3 1  ON 67
ci_069                 7.988429e-04 3 1  ON 68
ci_070                 1.913709e-03 3 1  ON 69
ci_071                -7.783227e-04 3 1  ON 70
ci_072                -7.662898e-04 3 1  ON 71
ci_073                 1.580304e-03 3 1  ON 72
ci_074                 1.337179e-03 3 1  ON 73
ci_075                -1.149692e-03 3 1  ON 74
ci_076                -1.392653e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.0193
    reference variance = 4.68691
====================================================
  Execution time = 2.3800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7001e+00
  Total weights = 1.9500e+06
  Execution time = 4.4162e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752395702380
                                         uncertainty =       0.027073202470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752395702380
                                         uncertainty =       0.027073202470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369614852
  error estimate for blocks of size 2^( 2) =       0.001440719654
  error estimate for blocks of size 2^( 3) =       0.001503213940
  error estimate for blocks of size 2^( 4) =       0.001546522730
  error estimate for blocks of size 2^( 5) =       0.001571781185
  error estimate for blocks of size 2^( 6) =       0.001581041988
  error estimate for blocks of size 2^( 7) =       0.001582044763

      target function =                  N/A
              le_mean =     -22.328439418255
             les_mean =     502.281565638115
             stat err =       0.001570347666
             autocorr =       1.314603285350
              std dev =       1.936958889555
             le_variance =       3.751809739826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752331733727
                                         uncertainty =       0.027070769477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752331733727
                                         uncertainty =       0.027070769477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369603147
  error estimate for blocks of size 2^( 2) =       0.001440720422
  error estimate for blocks of size 2^( 3) =       0.001503231894
  error estimate for blocks of size 2^( 4) =       0.001546575892
  error estimate for blocks of size 2^( 5) =       0.001571850710
  error estimate for blocks of size 2^( 6) =       0.001581084988
  error estimate for blocks of size 2^( 7) =       0.001582119799

      target function =                  N/A
              le_mean =     -22.328449349164
             les_mean =     502.265400849133
             stat err =       0.001570407847
             autocorr =       1.314726519257
              std dev =       1.936942335699
             le_variance =       3.751745611822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752323252978
                                         uncertainty =       0.027070903226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752323252978
                                         uncertainty =       0.027070903226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369601582
  error estimate for blocks of size 2^( 2) =       0.001440717216
  error estimate for blocks of size 2^( 3) =       0.001503226389
  error estimate for blocks of size 2^( 4) =       0.001546564020
  error estimate for blocks of size 2^( 5) =       0.001571837577
  error estimate for blocks of size 2^( 6) =       0.001581075208
  error estimate for blocks of size 2^( 7) =       0.001582111472

      target function =                  N/A
              le_mean =     -22.328440680984
             les_mean =     502.276975831688
             stat err =       0.001570397069
             autocorr =       1.314711477725
              std dev =       1.936940121962
             le_variance =       3.751737036068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752367372274
                                         uncertainty =       0.027072980268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752367372274
                                         uncertainty =       0.027072980268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369609675
  error estimate for blocks of size 2^( 2) =       0.001440716422
  error estimate for blocks of size 2^( 3) =       0.001503211473
  error estimate for blocks of size 2^( 4) =       0.001546525327
  error estimate for blocks of size 2^( 5) =       0.001571788192
  error estimate for blocks of size 2^( 6) =       0.001581042071
  error estimate for blocks of size 2^( 7) =       0.001582048808

      target function =                  N/A
              le_mean =     -22.328437303368
             les_mean =     502.263364660377
             stat err =       0.001570351099
             autocorr =       1.314618971143
              std dev =       1.936951568240
             le_variance =       3.751781377706


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328439418255        initial
     1.5625e-01     1.5625e+00             1.3592e-03       -22.328449349164  <--
     6.2500e-01     6.2500e+00             5.3574e-04       -22.328440680984
     2.5000e+00     2.5000e+01             1.5633e-04       -22.328437303368

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.5980e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -6.967591e-01 3 1  ON 0
ci_002                -7.039051e-01 3 1  ON 1
ci_003                -6.101559e-02 3 1  ON 2
ci_004                -6.181653e-02 3 1  ON 3
ci_005                 4.535317e-02 3 1  ON 4
ci_006                 4.659196e-02 3 1  ON 5
ci_007                 3.136373e-02 3 1  ON 6
ci_008                 3.106915e-02 3 1  ON 7
ci_009                -2.551476e-02 3 1  ON 8
ci_010                -2.556438e-02 3 1  ON 9
ci_011                -2.237957e-02 3 1  ON 10
ci_012                -2.253749e-02 3 1  ON 11
ci_013                 1.951106e-02 3 1  ON 12
ci_014                 1.926154e-02 3 1  ON 13
ci_015                 2.043269e-02 3 1  ON 14
ci_016                 2.099805e-02 3 1  ON 15
ci_017                 1.538511e-02 3 1  ON 16
ci_018                 1.524941e-02 3 1  ON 17
ci_019                 1.028224e-02 3 1  ON 18
ci_020                 1.046893e-02 3 1  ON 19
ci_021                -9.566764e-03 3 1  ON 20
ci_022                -1.002677e-02 3 1  ON 21
ci_023                 8.376517e-03 3 1  ON 22
ci_024                 9.182376e-03 3 1  ON 23
ci_025                 6.171722e-03 3 1  ON 24
ci_026                 8.324504e-03 3 1  ON 25
ci_027                 7.659748e-03 3 1  ON 26
ci_028                 7.957126e-03 3 1  ON 27
ci_029                -6.856120e-03 3 1  ON 28
ci_030                -9.094843e-03 3 1  ON 29
ci_031                -6.945331e-03 3 1  ON 30
ci_032                -7.314063e-03 3 1  ON 31
ci_033                 6.264827e-03 3 1  ON 32
ci_034                 6.859999e-03 3 1  ON 33
ci_035                 6.554792e-03 3 1  ON 34
ci_036                 6.742632e-03 3 1  ON 35
ci_037                 6.288106e-03 3 1  ON 36
ci_038                 5.595580e-03 3 1  ON 37
ci_039                 5.915317e-03 3 1  ON 38
ci_040                 6.235546e-03 3 1  ON 39
ci_041                 5.366633e-03 3 1  ON 40
ci_042                 5.517861e-03 3 1  ON 41
ci_043                 4.188729e-03 3 1  ON 42
ci_044                 4.541243e-03 3 1  ON 43
ci_045                 4.609555e-03 3 1  ON 44
ci_046                 5.636056e-03 3 1  ON 45
ci_047                -4.357776e-03 3 1  ON 46
ci_048                -4.297597e-03 3 1  ON 47
ci_049                 3.838337e-03 3 1  ON 48
ci_050                 2.621063e-03 3 1  ON 49
ci_051                -2.719401e-03 3 1  ON 50
ci_052                -3.727712e-03 3 1  ON 51
ci_053                -3.283265e-03 3 1  ON 52
ci_054                -2.132372e-03 3 1  ON 53
ci_055                -1.754366e-03 3 1  ON 54
ci_056                -2.210700e-03 3 1  ON 55
ci_057                -2.236032e-03 3 1  ON 56
ci_058                -1.619282e-03 3 1  ON 57
ci_059                -1.666204e-03 3 1  ON 58
ci_060                -1.997703e-03 3 1  ON 59
ci_061                -2.033515e-03 3 1  ON 60
ci_062                -2.396400e-03 3 1  ON 61
ci_063                -1.617618e-03 3 1  ON 62
ci_064                -8.339834e-04 3 1  ON 63
ci_065                -1.116187e-03 3 1  ON 64
ci_066                -8.021935e-04 3 1  ON 65
ci_067                -1.349061e-03 3 1  ON 66
ci_068                -1.130818e-03 3 1  ON 67
ci_069                 5.390126e-04 3 1  ON 68
ci_070                 2.008753e-03 3 1  ON 69
ci_071                -9.333908e-04 3 1  ON 70
ci_072                -1.036955e-03 3 1  ON 71
ci_073                 1.502629e-03 3 1  ON 72
ci_074                 1.270137e-03 3 1  ON 73
ci_075                -7.005071e-04 3 1  ON 74
ci_076                -1.741713e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6339e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2316e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.2869
    reference variance = 2.29571
====================================================
  Execution time = 2.4380e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0305e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6982e+00
  Total weights = 1.949670035e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9712e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.749981041222
                                         uncertainty =       0.024889819230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.749981041222
                                         uncertainty =       0.024889819230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369184416
  error estimate for blocks of size 2^( 2) =       0.001439849363
  error estimate for blocks of size 2^( 3) =       0.001501091350
  error estimate for blocks of size 2^( 4) =       0.001543415936
  error estimate for blocks of size 2^( 5) =       0.001570054360
  error estimate for blocks of size 2^( 6) =       0.001583587588
  error estimate for blocks of size 2^( 7) =       0.001603461112

      target function =                  N/A
              le_mean =     -22.329061333724
             les_mean =     502.285204737589
             stat err =       0.001575129749
             autocorr =       1.323453763784
              std dev =       1.936350151250
             le_variance =       3.749451908247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232906133372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329061332923       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329154256262       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329161822292       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329160903196       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329161115487       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329161345953       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329161061437       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-02 is 2.523899e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329061332923       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329123074948       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329125468840       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329125005842       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329125034226       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.194465e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329061332923       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329087692929       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329087987438       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329087909423       residual = 2.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 5.497786e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0367e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -6.967776e-01 3 1  ON 0
ci_002                -7.037489e-01 3 1  ON 1
ci_003                -6.114120e-02 3 1  ON 2
ci_004                -6.290409e-02 3 1  ON 3
ci_005                 4.526190e-02 3 1  ON 4
ci_006                 4.539750e-02 3 1  ON 5
ci_007                 3.213485e-02 3 1  ON 6
ci_008                 3.164032e-02 3 1  ON 7
ci_009                -2.539502e-02 3 1  ON 8
ci_010                -2.562953e-02 3 1  ON 9
ci_011                -2.332198e-02 3 1  ON 10
ci_012                -2.230290e-02 3 1  ON 11
ci_013                 1.960420e-02 3 1  ON 12
ci_014                 1.969635e-02 3 1  ON 13
ci_015                 2.086755e-02 3 1  ON 14
ci_016                 2.104245e-02 3 1  ON 15
ci_017                 1.635740e-02 3 1  ON 16
ci_018                 1.606334e-02 3 1  ON 17
ci_019                 9.493986e-03 3 1  ON 18
ci_020                 1.008922e-02 3 1  ON 19
ci_021                -9.611117e-03 3 1  ON 20
ci_022                -1.006199e-02 3 1  ON 21
ci_023                 7.983471e-03 3 1  ON 22
ci_024                 8.703039e-03 3 1  ON 23
ci_025                 7.183900e-03 3 1  ON 24
ci_026                 7.804164e-03 3 1  ON 25
ci_027                 8.020946e-03 3 1  ON 26
ci_028                 7.566417e-03 3 1  ON 27
ci_029                -7.764977e-03 3 1  ON 28
ci_030                -8.568790e-03 3 1  ON 29
ci_031                -6.261157e-03 3 1  ON 30
ci_032                -7.400175e-03 3 1  ON 31
ci_033                 6.297763e-03 3 1  ON 32
ci_034                 7.531684e-03 3 1  ON 33
ci_035                 6.725171e-03 3 1  ON 34
ci_036                 6.801967e-03 3 1  ON 35
ci_037                 6.003136e-03 3 1  ON 36
ci_038                 6.592372e-03 3 1  ON 37
ci_039                 5.764613e-03 3 1  ON 38
ci_040                 6.000310e-03 3 1  ON 39
ci_041                 4.589361e-03 3 1  ON 40
ci_042                 5.897343e-03 3 1  ON 41
ci_043                 4.107942e-03 3 1  ON 42
ci_044                 4.643060e-03 3 1  ON 43
ci_045                 5.159831e-03 3 1  ON 44
ci_046                 5.342788e-03 3 1  ON 45
ci_047                -4.519381e-03 3 1  ON 46
ci_048                -4.256524e-03 3 1  ON 47
ci_049                 3.554824e-03 3 1  ON 48
ci_050                 3.041707e-03 3 1  ON 49
ci_051                -2.774226e-03 3 1  ON 50
ci_052                -2.583343e-03 3 1  ON 51
ci_053                -2.915520e-03 3 1  ON 52
ci_054                -1.538394e-03 3 1  ON 53
ci_055                -1.284599e-03 3 1  ON 54
ci_056                -2.354595e-03 3 1  ON 55
ci_057                -2.279600e-03 3 1  ON 56
ci_058                -2.004129e-03 3 1  ON 57
ci_059                -2.113923e-03 3 1  ON 58
ci_060                -1.258410e-03 3 1  ON 59
ci_061                -2.024440e-03 3 1  ON 60
ci_062                -2.068839e-03 3 1  ON 61
ci_063                -1.580762e-03 3 1  ON 62
ci_064                -1.381695e-03 3 1  ON 63
ci_065                -1.128676e-03 3 1  ON 64
ci_066                -1.388292e-04 3 1  ON 65
ci_067                -1.616778e-03 3 1  ON 66
ci_068                -1.026033e-03 3 1  ON 67
ci_069                 1.397725e-03 3 1  ON 68
ci_070                 1.578079e-03 3 1  ON 69
ci_071                -8.096717e-04 3 1  ON 70
ci_072                -1.706137e-03 3 1  ON 71
ci_073                 1.730973e-03 3 1  ON 72
ci_074                 7.579656e-04 3 1  ON 73
ci_075                -7.175757e-04 3 1  ON 74
ci_076                -1.215492e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -21.932
    reference variance = 7.33662
====================================================
  Execution time = 2.5933e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.6608e+00
  Total weights = 1.9501e+06
  Execution time = 4.3646e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.712174497811
                                         uncertainty =       0.022786235226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.712174497811
                                         uncertainty =       0.022786235226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362283432
  error estimate for blocks of size 2^( 2) =       0.001434125999
  error estimate for blocks of size 2^( 3) =       0.001495903299
  error estimate for blocks of size 2^( 4) =       0.001539916533
  error estimate for blocks of size 2^( 5) =       0.001563726706
  error estimate for blocks of size 2^( 6) =       0.001574821766
  error estimate for blocks of size 2^( 7) =       0.001588096156

      target function =                  N/A
              le_mean =     -22.326047006465
             les_mean =     502.237370647900
             stat err =       0.001566640290
             autocorr =       1.322524216393
              std dev =       1.926590530277
             le_variance =       3.711751071355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711748524338
                                         uncertainty =       0.022769915451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711748524338
                                         uncertainty =       0.022769915451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362205918
  error estimate for blocks of size 2^( 2) =       0.001434050133
  error estimate for blocks of size 2^( 3) =       0.001495808928
  error estimate for blocks of size 2^( 4) =       0.001539824084
  error estimate for blocks of size 2^( 5) =       0.001563587079
  error estimate for blocks of size 2^( 6) =       0.001574674466
  error estimate for blocks of size 2^( 7) =       0.001587936533

      target function =                  N/A
              le_mean =     -22.326040898176
             les_mean =     502.119603073943
             stat err =       0.001566505540
             autocorr =       1.322447210961
              std dev =       1.926480906965
             le_variance =       3.711328684901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711810357840
                                         uncertainty =       0.022771216367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711810357840
                                         uncertainty =       0.022771216367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362217464
  error estimate for blocks of size 2^( 2) =       0.001434068470
  error estimate for blocks of size 2^( 3) =       0.001495817897
  error estimate for blocks of size 2^( 4) =       0.001539837696
  error estimate for blocks of size 2^( 5) =       0.001563587151
  error estimate for blocks of size 2^( 6) =       0.001574701595
  error estimate for blocks of size 2^( 7) =       0.001587956172

      target function =                  N/A
              le_mean =     -22.326050090672
             les_mean =     502.120462105971
             stat err =       0.001566520654
             autocorr =       1.322450310663
              std dev =       1.926497235256
             le_variance =       3.711391597450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711901007591
                                         uncertainty =       0.022769926164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711901007591
                                         uncertainty =       0.022769926164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362233497
  error estimate for blocks of size 2^( 2) =       0.001434083778
  error estimate for blocks of size 2^( 3) =       0.001495863062
  error estimate for blocks of size 2^( 4) =       0.001539866302
  error estimate for blocks of size 2^( 5) =       0.001563667095
  error estimate for blocks of size 2^( 6) =       0.001574769273
  error estimate for blocks of size 2^( 7) =       0.001588037802

      target function =                  N/A
              le_mean =     -22.326039736390
             les_mean =     502.122087270197
             stat err =       0.001566585118
             autocorr =       1.322528021821
              std dev =       1.926519910125
             le_variance =       3.711478964109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326047006465        initial
     3.9062e-02     3.9062e-01             2.5239e-03       -22.326040898176
     1.5625e-01     1.5625e+00             1.1945e-03       -22.326050090672  <--
     6.2500e-01     6.2500e+00             5.4978e-04       -22.326039736390

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.7870e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -6.967776e-01 3 1  ON 0
ci_002                -7.037489e-01 3 1  ON 1
ci_003                -6.114120e-02 3 1  ON 2
ci_004                -6.290409e-02 3 1  ON 3
ci_005                 4.526190e-02 3 1  ON 4
ci_006                 4.539750e-02 3 1  ON 5
ci_007                 3.213485e-02 3 1  ON 6
ci_008                 3.164032e-02 3 1  ON 7
ci_009                -2.539502e-02 3 1  ON 8
ci_010                -2.562953e-02 3 1  ON 9
ci_011                -2.332198e-02 3 1  ON 10
ci_012                -2.230290e-02 3 1  ON 11
ci_013                 1.960420e-02 3 1  ON 12
ci_014                 1.969635e-02 3 1  ON 13
ci_015                 2.086755e-02 3 1  ON 14
ci_016                 2.104245e-02 3 1  ON 15
ci_017                 1.635740e-02 3 1  ON 16
ci_018                 1.606334e-02 3 1  ON 17
ci_019                 9.493986e-03 3 1  ON 18
ci_020                 1.008922e-02 3 1  ON 19
ci_021                -9.611117e-03 3 1  ON 20
ci_022                -1.006199e-02 3 1  ON 21
ci_023                 7.983471e-03 3 1  ON 22
ci_024                 8.703039e-03 3 1  ON 23
ci_025                 7.183900e-03 3 1  ON 24
ci_026                 7.804164e-03 3 1  ON 25
ci_027                 8.020946e-03 3 1  ON 26
ci_028                 7.566417e-03 3 1  ON 27
ci_029                -7.764977e-03 3 1  ON 28
ci_030                -8.568790e-03 3 1  ON 29
ci_031                -6.261157e-03 3 1  ON 30
ci_032                -7.400175e-03 3 1  ON 31
ci_033                 6.297763e-03 3 1  ON 32
ci_034                 7.531684e-03 3 1  ON 33
ci_035                 6.725171e-03 3 1  ON 34
ci_036                 6.801967e-03 3 1  ON 35
ci_037                 6.003136e-03 3 1  ON 36
ci_038                 6.592372e-03 3 1  ON 37
ci_039                 5.764613e-03 3 1  ON 38
ci_040                 6.000310e-03 3 1  ON 39
ci_041                 4.589361e-03 3 1  ON 40
ci_042                 5.897343e-03 3 1  ON 41
ci_043                 4.107942e-03 3 1  ON 42
ci_044                 4.643060e-03 3 1  ON 43
ci_045                 5.159831e-03 3 1  ON 44
ci_046                 5.342788e-03 3 1  ON 45
ci_047                -4.519381e-03 3 1  ON 46
ci_048                -4.256524e-03 3 1  ON 47
ci_049                 3.554824e-03 3 1  ON 48
ci_050                 3.041707e-03 3 1  ON 49
ci_051                -2.774226e-03 3 1  ON 50
ci_052                -2.583343e-03 3 1  ON 51
ci_053                -2.915520e-03 3 1  ON 52
ci_054                -1.538394e-03 3 1  ON 53
ci_055                -1.284599e-03 3 1  ON 54
ci_056                -2.354595e-03 3 1  ON 55
ci_057                -2.279600e-03 3 1  ON 56
ci_058                -2.004129e-03 3 1  ON 57
ci_059                -2.113923e-03 3 1  ON 58
ci_060                -1.258410e-03 3 1  ON 59
ci_061                -2.024440e-03 3 1  ON 60
ci_062                -2.068839e-03 3 1  ON 61
ci_063                -1.580762e-03 3 1  ON 62
ci_064                -1.381695e-03 3 1  ON 63
ci_065                -1.128676e-03 3 1  ON 64
ci_066                -1.388292e-04 3 1  ON 65
ci_067                -1.616778e-03 3 1  ON 66
ci_068                -1.026033e-03 3 1  ON 67
ci_069                 1.397725e-03 3 1  ON 68
ci_070                 1.578079e-03 3 1  ON 69
ci_071                -8.096717e-04 3 1  ON 70
ci_072                -1.706137e-03 3 1  ON 71
ci_073                 1.730973e-03 3 1  ON 72
ci_074                 7.579656e-04 3 1  ON 73
ci_075                -7.175757e-04 3 1  ON 74
ci_076                -1.215492e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8247e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2274e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.1999
    reference variance = 3.17708
====================================================
  Execution time = 2.4192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0358e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7342e+00
  Total weights = 1.950061742e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8824e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.786866932735
                                         uncertainty =       0.036805005560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.786866932735
                                         uncertainty =       0.036805005560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375997798
  error estimate for blocks of size 2^( 2) =       0.001446713993
  error estimate for blocks of size 2^( 3) =       0.001509743298
  error estimate for blocks of size 2^( 4) =       0.001552360102
  error estimate for blocks of size 2^( 5) =       0.001575621636
  error estimate for blocks of size 2^( 6) =       0.001587918042
  error estimate for blocks of size 2^( 7) =       0.001593395856

      target function =                  N/A
              le_mean =     -22.328799568002
             les_mean =     502.309534590766
             stat err =       0.001577323909
             autocorr =       1.314033069659
              std dev =       1.945985882524
             le_variance =       3.786861054982


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232879956800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328799567206       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328873977734       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328878725550       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328879006017       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328880139918       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328880187740       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328880366149       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.328880480061       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-02 is 2.740736e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328799567206       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328847244401       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328848377469       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328848330079       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328848476708       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-01 is 1.570925e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328799567206       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328819130336       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328819173573       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328819167343       residual = 1.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 6.218632e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0082e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -6.964542e-01 3 1  ON 0
ci_002                -7.038990e-01 3 1  ON 1
ci_003                -6.234905e-02 3 1  ON 2
ci_004                -6.291347e-02 3 1  ON 3
ci_005                 4.538800e-02 3 1  ON 4
ci_006                 4.592016e-02 3 1  ON 5
ci_007                 3.157516e-02 3 1  ON 6
ci_008                 3.227000e-02 3 1  ON 7
ci_009                -2.605312e-02 3 1  ON 8
ci_010                -2.592569e-02 3 1  ON 9
ci_011                -2.258276e-02 3 1  ON 10
ci_012                -2.296558e-02 3 1  ON 11
ci_013                 1.947140e-02 3 1  ON 12
ci_014                 2.012535e-02 3 1  ON 13
ci_015                 2.216377e-02 3 1  ON 14
ci_016                 2.075998e-02 3 1  ON 15
ci_017                 1.529955e-02 3 1  ON 16
ci_018                 1.520973e-02 3 1  ON 17
ci_019                 1.063681e-02 3 1  ON 18
ci_020                 9.449777e-03 3 1  ON 19
ci_021                -9.337390e-03 3 1  ON 20
ci_022                -1.058331e-02 3 1  ON 21
ci_023                 8.421310e-03 3 1  ON 22
ci_024                 7.745507e-03 3 1  ON 23
ci_025                 6.656219e-03 3 1  ON 24
ci_026                 8.451648e-03 3 1  ON 25
ci_027                 8.048405e-03 3 1  ON 26
ci_028                 7.408991e-03 3 1  ON 27
ci_029                -8.394682e-03 3 1  ON 28
ci_030                -8.254233e-03 3 1  ON 29
ci_031                -6.472427e-03 3 1  ON 30
ci_032                -7.574336e-03 3 1  ON 31
ci_033                 7.178826e-03 3 1  ON 32
ci_034                 5.960759e-03 3 1  ON 33
ci_035                 6.525875e-03 3 1  ON 34
ci_036                 6.830897e-03 3 1  ON 35
ci_037                 5.866555e-03 3 1  ON 36
ci_038                 6.486394e-03 3 1  ON 37
ci_039                 6.120013e-03 3 1  ON 38
ci_040                 5.936247e-03 3 1  ON 39
ci_041                 4.321971e-03 3 1  ON 40
ci_042                 5.456551e-03 3 1  ON 41
ci_043                 3.863865e-03 3 1  ON 42
ci_044                 5.378545e-03 3 1  ON 43
ci_045                 5.126122e-03 3 1  ON 44
ci_046                 5.825935e-03 3 1  ON 45
ci_047                -4.228604e-03 3 1  ON 46
ci_048                -4.316547e-03 3 1  ON 47
ci_049                 3.501466e-03 3 1  ON 48
ci_050                 3.349278e-03 3 1  ON 49
ci_051                -2.982128e-03 3 1  ON 50
ci_052                -1.959700e-03 3 1  ON 51
ci_053                -2.983471e-03 3 1  ON 52
ci_054                -1.752521e-03 3 1  ON 53
ci_055                -1.370811e-03 3 1  ON 54
ci_056                -2.476023e-03 3 1  ON 55
ci_057                -2.159980e-03 3 1  ON 56
ci_058                -1.521868e-03 3 1  ON 57
ci_059                -2.365755e-03 3 1  ON 58
ci_060                -1.604613e-03 3 1  ON 59
ci_061                -1.332521e-03 3 1  ON 60
ci_062                -1.349893e-03 3 1  ON 61
ci_063                -1.364760e-03 3 1  ON 62
ci_064                -1.226919e-03 3 1  ON 63
ci_065                -1.391448e-03 3 1  ON 64
ci_066                -7.185737e-04 3 1  ON 65
ci_067                -1.360728e-03 3 1  ON 66
ci_068                -6.500775e-04 3 1  ON 67
ci_069                 1.646773e-03 3 1  ON 68
ci_070                 1.946787e-03 3 1  ON 69
ci_071                -9.193399e-04 3 1  ON 70
ci_072                -1.346265e-03 3 1  ON 71
ci_073                 1.392589e-03 3 1  ON 72
ci_074                 6.714562e-04 3 1  ON 73
ci_075                -6.391271e-04 3 1  ON 74
ci_076                -1.191204e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.5501
    reference variance = 2.46808
====================================================
  Execution time = 2.3667e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.7143e+00
  Total weights = 1.9498e+06
  Execution time = 4.3720e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764202633204
                                         uncertainty =       0.030996866114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764202633204
                                         uncertainty =       0.030996866114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372018479
  error estimate for blocks of size 2^( 2) =       0.001443392149
  error estimate for blocks of size 2^( 3) =       0.001506016051
  error estimate for blocks of size 2^( 4) =       0.001551932909
  error estimate for blocks of size 2^( 5) =       0.001578875149
  error estimate for blocks of size 2^( 6) =       0.001590780476
  error estimate for blocks of size 2^( 7) =       0.001607554357

      target function =                  N/A
              le_mean =     -22.330596866695
             les_mean =     502.400882733908
             stat err =       0.001582285723
             autocorr =       1.329994660740
              std dev =       1.940358185716
             le_variance =       3.764989888875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764209930380
                                         uncertainty =       0.031015025875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764209930380
                                         uncertainty =       0.031015025875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372019688
  error estimate for blocks of size 2^( 2) =       0.001443352993
  error estimate for blocks of size 2^( 3) =       0.001505947529
  error estimate for blocks of size 2^( 4) =       0.001551929151
  error estimate for blocks of size 2^( 5) =       0.001578830660
  error estimate for blocks of size 2^( 6) =       0.001590799791
  error estimate for blocks of size 2^( 7) =       0.001607582217

      target function =                  N/A
              le_mean =     -22.330571942931
             les_mean =     502.389122332423
             stat err =       0.001582285455
             autocorr =       1.329991865329
              std dev =       1.940359895960
             le_variance =       3.764996525848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764314651881
                                         uncertainty =       0.031011883910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764314651881
                                         uncertainty =       0.031011883910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372038737
  error estimate for blocks of size 2^( 2) =       0.001443365719
  error estimate for blocks of size 2^( 3) =       0.001505958112
  error estimate for blocks of size 2^( 4) =       0.001551942916
  error estimate for blocks of size 2^( 5) =       0.001578833932
  error estimate for blocks of size 2^( 6) =       0.001590802756
  error estimate for blocks of size 2^( 7) =       0.001607602210

      target function =                  N/A
              le_mean =     -22.330584821963
             les_mean =     502.380936614060
             stat err =       0.001582295454
             autocorr =       1.329971743912
              std dev =       1.940386835782
             le_variance =       3.765101072474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763977801117
                                         uncertainty =       0.031004975169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763977801117
                                         uncertainty =       0.031004975169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371977465
  error estimate for blocks of size 2^( 2) =       0.001443332049
  error estimate for blocks of size 2^( 3) =       0.001505949572
  error estimate for blocks of size 2^( 4) =       0.001551902651
  error estimate for blocks of size 2^( 5) =       0.001578828593
  error estimate for blocks of size 2^( 6) =       0.001590775548
  error estimate for blocks of size 2^( 7) =       0.001607554015

      target function =                  N/A
              le_mean =     -22.330574370262
             les_mean =     502.369602970465
             stat err =       0.001582265202
             autocorr =       1.330039679035
              std dev =       1.940300182798
             le_variance =       3.764764799364


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330596866695        initial  <--
     3.9062e-02     3.9062e-01             2.7407e-03       -22.330571942931
     1.5625e-01     1.5625e+00             1.5709e-03       -22.330584821963
     6.2500e-01     6.2500e+00             6.2186e-04       -22.330574370262

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6378
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -6.967776e-01 3 1  ON 0
ci_002                -7.037489e-01 3 1  ON 1
ci_003                -6.114120e-02 3 1  ON 2
ci_004                -6.290409e-02 3 1  ON 3
ci_005                 4.526190e-02 3 1  ON 4
ci_006                 4.539750e-02 3 1  ON 5
ci_007                 3.213485e-02 3 1  ON 6
ci_008                 3.164032e-02 3 1  ON 7
ci_009                -2.539502e-02 3 1  ON 8
ci_010                -2.562953e-02 3 1  ON 9
ci_011                -2.332198e-02 3 1  ON 10
ci_012                -2.230290e-02 3 1  ON 11
ci_013                 1.960420e-02 3 1  ON 12
ci_014                 1.969635e-02 3 1  ON 13
ci_015                 2.086755e-02 3 1  ON 14
ci_016                 2.104245e-02 3 1  ON 15
ci_017                 1.635740e-02 3 1  ON 16
ci_018                 1.606334e-02 3 1  ON 17
ci_019                 9.493986e-03 3 1  ON 18
ci_020                 1.008922e-02 3 1  ON 19
ci_021                -9.611117e-03 3 1  ON 20
ci_022                -1.006199e-02 3 1  ON 21
ci_023                 7.983471e-03 3 1  ON 22
ci_024                 8.703039e-03 3 1  ON 23
ci_025                 7.183900e-03 3 1  ON 24
ci_026                 7.804164e-03 3 1  ON 25
ci_027                 8.020946e-03 3 1  ON 26
ci_028                 7.566417e-03 3 1  ON 27
ci_029                -7.764977e-03 3 1  ON 28
ci_030                -8.568790e-03 3 1  ON 29
ci_031                -6.261157e-03 3 1  ON 30
ci_032                -7.400175e-03 3 1  ON 31
ci_033                 6.297763e-03 3 1  ON 32
ci_034                 7.531684e-03 3 1  ON 33
ci_035                 6.725171e-03 3 1  ON 34
ci_036                 6.801967e-03 3 1  ON 35
ci_037                 6.003136e-03 3 1  ON 36
ci_038                 6.592372e-03 3 1  ON 37
ci_039                 5.764613e-03 3 1  ON 38
ci_040                 6.000310e-03 3 1  ON 39
ci_041                 4.589361e-03 3 1  ON 40
ci_042                 5.897343e-03 3 1  ON 41
ci_043                 4.107942e-03 3 1  ON 42
ci_044                 4.643060e-03 3 1  ON 43
ci_045                 5.159831e-03 3 1  ON 44
ci_046                 5.342788e-03 3 1  ON 45
ci_047                -4.519381e-03 3 1  ON 46
ci_048                -4.256524e-03 3 1  ON 47
ci_049                 3.554824e-03 3 1  ON 48
ci_050                 3.041707e-03 3 1  ON 49
ci_051                -2.774226e-03 3 1  ON 50
ci_052                -2.583343e-03 3 1  ON 51
ci_053                -2.915520e-03 3 1  ON 52
ci_054                -1.538394e-03 3 1  ON 53
ci_055                -1.284599e-03 3 1  ON 54
ci_056                -2.354595e-03 3 1  ON 55
ci_057                -2.279600e-03 3 1  ON 56
ci_058                -2.004129e-03 3 1  ON 57
ci_059                -2.113923e-03 3 1  ON 58
ci_060                -1.258410e-03 3 1  ON 59
ci_061                -2.024440e-03 3 1  ON 60
ci_062                -2.068839e-03 3 1  ON 61
ci_063                -1.580762e-03 3 1  ON 62
ci_064                -1.381695e-03 3 1  ON 63
ci_065                -1.128676e-03 3 1  ON 64
ci_066                -1.388292e-04 3 1  ON 65
ci_067                -1.616778e-03 3 1  ON 66
ci_068                -1.026033e-03 3 1  ON 67
ci_069                 1.397725e-03 3 1  ON 68
ci_070                 1.578079e-03 3 1  ON 69
ci_071                -8.096717e-04 3 1  ON 70
ci_072                -1.706137e-03 3 1  ON 71
ci_073                 1.730973e-03 3 1  ON 72
ci_074                 7.579656e-04 3 1  ON 73
ci_075                -7.175757e-04 3 1  ON 74
ci_076                -1.215492e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5726e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2291e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.3927
    reference variance = 2.58196
====================================================
  Execution time = 2.4152e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0288e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7549e+00
  Total weights = 1.950251881e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8924e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807072853932
                                         uncertainty =       0.033377057936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807072853932
                                         uncertainty =       0.033377057936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379630122
  error estimate for blocks of size 2^( 2) =       0.001450748206
  error estimate for blocks of size 2^( 3) =       0.001514183927
  error estimate for blocks of size 2^( 4) =       0.001557479791
  error estimate for blocks of size 2^( 5) =       0.001581032370
  error estimate for blocks of size 2^( 6) =       0.001591765058
  error estimate for blocks of size 2^( 7) =       0.001594835079

      target function =                  N/A
              le_mean =     -22.325748390705
             les_mean =     502.193950313898
             stat err =       0.001581278075
             autocorr =       1.313684763242
              std dev =       1.951122846283
             le_variance =       3.806880361286


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232574839071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325748389897       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325795388520       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325797062509       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325796914989       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e-01 is 9.324630e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325748389897       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325764077272       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325764233823       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+00 is 2.972213e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325748389897       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325752670368       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325752686712       residual = 9.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 8.108629e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014367 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0050e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -6.968823e-01 3 1  ON 0
ci_002                -7.036151e-01 3 1  ON 1
ci_003                -6.115475e-02 3 1  ON 2
ci_004                -6.295169e-02 3 1  ON 3
ci_005                 4.548477e-02 3 1  ON 4
ci_006                 4.562567e-02 3 1  ON 5
ci_007                 3.203628e-02 3 1  ON 6
ci_008                 3.182384e-02 3 1  ON 7
ci_009                -2.539404e-02 3 1  ON 8
ci_010                -2.571467e-02 3 1  ON 9
ci_011                -2.302476e-02 3 1  ON 10
ci_012                -2.239765e-02 3 1  ON 11
ci_013                 1.968651e-02 3 1  ON 12
ci_014                 1.963963e-02 3 1  ON 13
ci_015                 2.074627e-02 3 1  ON 14
ci_016                 2.095297e-02 3 1  ON 15
ci_017                 1.635297e-02 3 1  ON 16
ci_018                 1.607713e-02 3 1  ON 17
ci_019                 9.422715e-03 3 1  ON 18
ci_020                 1.013011e-02 3 1  ON 19
ci_021                -9.520816e-03 3 1  ON 20
ci_022                -1.012859e-02 3 1  ON 21
ci_023                 8.148552e-03 3 1  ON 22
ci_024                 8.753395e-03 3 1  ON 23
ci_025                 7.243166e-03 3 1  ON 24
ci_026                 7.662197e-03 3 1  ON 25
ci_027                 8.054856e-03 3 1  ON 26
ci_028                 7.729924e-03 3 1  ON 27
ci_029                -7.806698e-03 3 1  ON 28
ci_030                -8.390335e-03 3 1  ON 29
ci_031                -6.363852e-03 3 1  ON 30
ci_032                -7.368902e-03 3 1  ON 31
ci_033                 6.310615e-03 3 1  ON 32
ci_034                 7.594734e-03 3 1  ON 33
ci_035                 6.609481e-03 3 1  ON 34
ci_036                 6.762636e-03 3 1  ON 35
ci_037                 6.114763e-03 3 1  ON 36
ci_038                 6.563219e-03 3 1  ON 37
ci_039                 5.571011e-03 3 1  ON 38
ci_040                 6.031218e-03 3 1  ON 39
ci_041                 4.619314e-03 3 1  ON 40
ci_042                 5.808803e-03 3 1  ON 41
ci_043                 4.401499e-03 3 1  ON 42
ci_044                 4.655274e-03 3 1  ON 43
ci_045                 5.284446e-03 3 1  ON 44
ci_046                 5.174215e-03 3 1  ON 45
ci_047                -4.544691e-03 3 1  ON 46
ci_048                -4.231442e-03 3 1  ON 47
ci_049                 3.604032e-03 3 1  ON 48
ci_050                 3.199067e-03 3 1  ON 49
ci_051                -2.788093e-03 3 1  ON 50
ci_052                -2.548337e-03 3 1  ON 51
ci_053                -2.914995e-03 3 1  ON 52
ci_054                -1.653863e-03 3 1  ON 53
ci_055                -1.442851e-03 3 1  ON 54
ci_056                -2.273841e-03 3 1  ON 55
ci_057                -2.137669e-03 3 1  ON 56
ci_058                -2.032298e-03 3 1  ON 57
ci_059                -1.976711e-03 3 1  ON 58
ci_060                -1.298525e-03 3 1  ON 59
ci_061                -1.973864e-03 3 1  ON 60
ci_062                -1.803906e-03 3 1  ON 61
ci_063                -1.585201e-03 3 1  ON 62
ci_064                -1.419467e-03 3 1  ON 63
ci_065                -1.073644e-03 3 1  ON 64
ci_066                -2.950600e-04 3 1  ON 65
ci_067                -1.639436e-03 3 1  ON 66
ci_068                -1.077331e-03 3 1  ON 67
ci_069                 1.507251e-03 3 1  ON 68
ci_070                 1.479474e-03 3 1  ON 69
ci_071                -7.805732e-04 3 1  ON 70
ci_072                -1.665110e-03 3 1  ON 71
ci_073                 1.714932e-03 3 1  ON 72
ci_074                 7.622898e-04 3 1  ON 73
ci_075                -6.074850e-04 3 1  ON 74
ci_076                -1.353555e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.2311
    reference variance = 2.9787
====================================================
  Execution time = 2.3625e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.9591e+00
  Total weights = 1.9496e+06
  Execution time = 4.3611e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.017997066007
                                         uncertainty =       0.208645526807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.017997066007
                                         uncertainty =       0.208645526807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001417282252
  error estimate for blocks of size 2^( 2) =       0.001487285231
  error estimate for blocks of size 2^( 3) =       0.001550932638
  error estimate for blocks of size 2^( 4) =       0.001592639885
  error estimate for blocks of size 2^( 5) =       0.001617400179
  error estimate for blocks of size 2^( 6) =       0.001631132386
  error estimate for blocks of size 2^( 7) =       0.001638766369

      target function =                  N/A
              le_mean =     -22.328289253320
             les_mean =     502.520920411175
             stat err =       0.001619984705
             autocorr =       1.306499147584
              std dev =       2.004371852265
             le_variance =       4.017506522151

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.083948
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.018343790226
                                         uncertainty =       0.208651775647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.018343790226
                                         uncertainty =       0.208651775647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001417343388
  error estimate for blocks of size 2^( 2) =       0.001487322274
  error estimate for blocks of size 2^( 3) =       0.001550954713
  error estimate for blocks of size 2^( 4) =       0.001592697152
  error estimate for blocks of size 2^( 5) =       0.001617502883
  error estimate for blocks of size 2^( 6) =       0.001631274261
  error estimate for blocks of size 2^( 7) =       0.001638890159

      target function =                  N/A
              le_mean =     -22.328274841050
             les_mean =     502.615399623517
             stat err =       0.001620091114
             autocorr =       1.306558067572
              std dev =       2.004458312129
             le_variance =       4.017853125065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.018065013574
                                         uncertainty =       0.208651602197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.018065013574
                                         uncertainty =       0.208651602197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001417294303
  error estimate for blocks of size 2^( 2) =       0.001487274638
  error estimate for blocks of size 2^( 3) =       0.001550917195
  error estimate for blocks of size 2^( 4) =       0.001592602172
  error estimate for blocks of size 2^( 5) =       0.001617366606
  error estimate for blocks of size 2^( 6) =       0.001631090707
  error estimate for blocks of size 2^( 7) =       0.001638703184

      target function =                  N/A
              le_mean =     -22.328280375413
             les_mean =     502.686431505146
             stat err =       0.001619940667
             autocorr =       1.306405901421
              std dev =       2.004388894460
             le_variance =       4.017574840235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.017994505222
                                         uncertainty =       0.208646319349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.017994505222
                                         uncertainty =       0.208646319349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001417281811
  error estimate for blocks of size 2^( 2) =       0.001487281811
  error estimate for blocks of size 2^( 3) =       0.001550928824
  error estimate for blocks of size 2^( 4) =       0.001592630944
  error estimate for blocks of size 2^( 5) =       0.001617389912
  error estimate for blocks of size 2^( 6) =       0.001631118100
  error estimate for blocks of size 2^( 7) =       0.001638752786

      target function =                  N/A
              le_mean =     -22.328285924450
             les_mean =     502.512788414059
             stat err =       0.001619972935
             autocorr =       1.306480977672
              std dev =       2.004371227833
             le_variance =       4.017504018965


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328289253320        initial  <--
     3.9062e-01     3.9062e+00             9.3246e-04       -22.328274841050
     1.5625e+00     1.5625e+01             2.9722e-04       -22.328280375413
     6.2500e+00     6.2500e+01             8.1086e-05       -22.328285924450

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5448
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -6.967776e-01 3 1  ON 0
ci_002                -7.037489e-01 3 1  ON 1
ci_003                -6.114120e-02 3 1  ON 2
ci_004                -6.290409e-02 3 1  ON 3
ci_005                 4.526190e-02 3 1  ON 4
ci_006                 4.539750e-02 3 1  ON 5
ci_007                 3.213485e-02 3 1  ON 6
ci_008                 3.164032e-02 3 1  ON 7
ci_009                -2.539502e-02 3 1  ON 8
ci_010                -2.562953e-02 3 1  ON 9
ci_011                -2.332198e-02 3 1  ON 10
ci_012                -2.230290e-02 3 1  ON 11
ci_013                 1.960420e-02 3 1  ON 12
ci_014                 1.969635e-02 3 1  ON 13
ci_015                 2.086755e-02 3 1  ON 14
ci_016                 2.104245e-02 3 1  ON 15
ci_017                 1.635740e-02 3 1  ON 16
ci_018                 1.606334e-02 3 1  ON 17
ci_019                 9.493986e-03 3 1  ON 18
ci_020                 1.008922e-02 3 1  ON 19
ci_021                -9.611117e-03 3 1  ON 20
ci_022                -1.006199e-02 3 1  ON 21
ci_023                 7.983471e-03 3 1  ON 22
ci_024                 8.703039e-03 3 1  ON 23
ci_025                 7.183900e-03 3 1  ON 24
ci_026                 7.804164e-03 3 1  ON 25
ci_027                 8.020946e-03 3 1  ON 26
ci_028                 7.566417e-03 3 1  ON 27
ci_029                -7.764977e-03 3 1  ON 28
ci_030                -8.568790e-03 3 1  ON 29
ci_031                -6.261157e-03 3 1  ON 30
ci_032                -7.400175e-03 3 1  ON 31
ci_033                 6.297763e-03 3 1  ON 32
ci_034                 7.531684e-03 3 1  ON 33
ci_035                 6.725171e-03 3 1  ON 34
ci_036                 6.801967e-03 3 1  ON 35
ci_037                 6.003136e-03 3 1  ON 36
ci_038                 6.592372e-03 3 1  ON 37
ci_039                 5.764613e-03 3 1  ON 38
ci_040                 6.000310e-03 3 1  ON 39
ci_041                 4.589361e-03 3 1  ON 40
ci_042                 5.897343e-03 3 1  ON 41
ci_043                 4.107942e-03 3 1  ON 42
ci_044                 4.643060e-03 3 1  ON 43
ci_045                 5.159831e-03 3 1  ON 44
ci_046                 5.342788e-03 3 1  ON 45
ci_047                -4.519381e-03 3 1  ON 46
ci_048                -4.256524e-03 3 1  ON 47
ci_049                 3.554824e-03 3 1  ON 48
ci_050                 3.041707e-03 3 1  ON 49
ci_051                -2.774226e-03 3 1  ON 50
ci_052                -2.583343e-03 3 1  ON 51
ci_053                -2.915520e-03 3 1  ON 52
ci_054                -1.538394e-03 3 1  ON 53
ci_055                -1.284599e-03 3 1  ON 54
ci_056                -2.354595e-03 3 1  ON 55
ci_057                -2.279600e-03 3 1  ON 56
ci_058                -2.004129e-03 3 1  ON 57
ci_059                -2.113923e-03 3 1  ON 58
ci_060                -1.258410e-03 3 1  ON 59
ci_061                -2.024440e-03 3 1  ON 60
ci_062                -2.068839e-03 3 1  ON 61
ci_063                -1.580762e-03 3 1  ON 62
ci_064                -1.381695e-03 3 1  ON 63
ci_065                -1.128676e-03 3 1  ON 64
ci_066                -1.388292e-04 3 1  ON 65
ci_067                -1.616778e-03 3 1  ON 66
ci_068                -1.026033e-03 3 1  ON 67
ci_069                 1.397725e-03 3 1  ON 68
ci_070                 1.578079e-03 3 1  ON 69
ci_071                -8.096717e-04 3 1  ON 70
ci_072                -1.706137e-03 3 1  ON 71
ci_073                 1.730973e-03 3 1  ON 72
ci_074                 7.579656e-04 3 1  ON 73
ci_075                -7.175757e-04 3 1  ON 74
ci_076                -1.215492e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5605e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2294e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.587
    reference variance = 1.99727
====================================================
  Execution time = 2.4178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0297e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7604e+00
  Total weights = 1.949617486e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8719e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813643853560
                                         uncertainty =       0.046878142574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813643853560
                                         uncertainty =       0.046878142574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380828088
  error estimate for blocks of size 2^( 2) =       0.001451240036
  error estimate for blocks of size 2^( 3) =       0.001514706543
  error estimate for blocks of size 2^( 4) =       0.001557905728
  error estimate for blocks of size 2^( 5) =       0.001580633041
  error estimate for blocks of size 2^( 6) =       0.001596006986
  error estimate for blocks of size 2^( 7) =       0.001603491488

      target function =                  N/A
              le_mean =     -22.329420437529
             les_mean =     502.363420529229
             stat err =       0.001584509311
             autocorr =       1.316771341968
              std dev =       1.952817053286
             le_variance =       3.813494443603


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232942043753e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329420436709       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329428009279       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329428050940       residual = 5.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 1.163962e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329420436709       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329422400208       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329422411059       residual = 3.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 3.045317e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329420436709       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329420932187       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329420934947       residual = 3.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+01 is 7.703075e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017383 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0060e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -6.967811e-01 3 1  ON 0
ci_002                -7.037460e-01 3 1  ON 1
ci_003                -6.114191e-02 3 1  ON 2
ci_004                -6.291162e-02 3 1  ON 3
ci_005                 4.526456e-02 3 1  ON 4
ci_006                 4.540284e-02 3 1  ON 5
ci_007                 3.212515e-02 3 1  ON 6
ci_008                 3.164209e-02 3 1  ON 7
ci_009                -2.540365e-02 3 1  ON 8
ci_010                -2.562019e-02 3 1  ON 9
ci_011                -2.330269e-02 3 1  ON 10
ci_012                -2.232416e-02 3 1  ON 11
ci_013                 1.959320e-02 3 1  ON 12
ci_014                 1.968431e-02 3 1  ON 13
ci_015                 2.085369e-02 3 1  ON 14
ci_016                 2.102597e-02 3 1  ON 15
ci_017                 1.635698e-02 3 1  ON 16
ci_018                 1.605629e-02 3 1  ON 17
ci_019                 9.500670e-03 3 1  ON 18
ci_020                 1.009804e-02 3 1  ON 19
ci_021                -9.603611e-03 3 1  ON 20
ci_022                -1.005054e-02 3 1  ON 21
ci_023                 7.996817e-03 3 1  ON 22
ci_024                 8.687761e-03 3 1  ON 23
ci_025                 7.189640e-03 3 1  ON 24
ci_026                 7.820548e-03 3 1  ON 25
ci_027                 8.024016e-03 3 1  ON 26
ci_028                 7.586590e-03 3 1  ON 27
ci_029                -7.775575e-03 3 1  ON 28
ci_030                -8.548815e-03 3 1  ON 29
ci_031                -6.277263e-03 3 1  ON 30
ci_032                -7.398861e-03 3 1  ON 31
ci_033                 6.290191e-03 3 1  ON 32
ci_034                 7.536091e-03 3 1  ON 33
ci_035                 6.717780e-03 3 1  ON 34
ci_036                 6.801009e-03 3 1  ON 35
ci_037                 6.006066e-03 3 1  ON 36
ci_038                 6.567227e-03 3 1  ON 37
ci_039                 5.755543e-03 3 1  ON 38
ci_040                 5.990144e-03 3 1  ON 39
ci_041                 4.601416e-03 3 1  ON 40
ci_042                 5.908208e-03 3 1  ON 41
ci_043                 4.138395e-03 3 1  ON 42
ci_044                 4.636591e-03 3 1  ON 43
ci_045                 5.163445e-03 3 1  ON 44
ci_046                 5.322391e-03 3 1  ON 45
ci_047                -4.526886e-03 3 1  ON 46
ci_048                -4.257610e-03 3 1  ON 47
ci_049                 3.558948e-03 3 1  ON 48
ci_050                 3.050950e-03 3 1  ON 49
ci_051                -2.765019e-03 3 1  ON 50
ci_052                -2.605592e-03 3 1  ON 51
ci_053                -2.910910e-03 3 1  ON 52
ci_054                -1.565895e-03 3 1  ON 53
ci_055                -1.307708e-03 3 1  ON 54
ci_056                -2.347775e-03 3 1  ON 55
ci_057                -2.269758e-03 3 1  ON 56
ci_058                -1.995776e-03 3 1  ON 57
ci_059                -2.095681e-03 3 1  ON 58
ci_060                -1.275563e-03 3 1  ON 59
ci_061                -2.021216e-03 3 1  ON 60
ci_062                -2.073112e-03 3 1  ON 61
ci_063                -1.579886e-03 3 1  ON 62
ci_064                -1.384651e-03 3 1  ON 63
ci_065                -1.129968e-03 3 1  ON 64
ci_066                -1.579294e-04 3 1  ON 65
ci_067                -1.621011e-03 3 1  ON 66
ci_068                -1.022078e-03 3 1  ON 67
ci_069                 1.405756e-03 3 1  ON 68
ci_070                 1.566137e-03 3 1  ON 69
ci_071                -8.037323e-04 3 1  ON 70
ci_072                -1.704669e-03 3 1  ON 71
ci_073                 1.715418e-03 3 1  ON 72
ci_074                 7.372461e-04 3 1  ON 73
ci_075                -6.928047e-04 3 1  ON 74
ci_076                -1.211829e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.1972
    reference variance = 3.28698
====================================================
  Execution time = 2.3587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.8245e+00
  Total weights = 1.9499e+06
  Execution time = 4.3774e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860241561686
                                         uncertainty =       0.057329565681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860241561686
                                         uncertainty =       0.057329565681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389248908
  error estimate for blocks of size 2^( 2) =       0.001461829160
  error estimate for blocks of size 2^( 3) =       0.001524281424
  error estimate for blocks of size 2^( 4) =       0.001567406196
  error estimate for blocks of size 2^( 5) =       0.001591779887
  error estimate for blocks of size 2^( 6) =       0.001600284762
  error estimate for blocks of size 2^( 7) =       0.001606990532

      target function =                  N/A
              le_mean =     -22.326260069398
             les_mean =     502.286435723357
             stat err =       0.001591615344
             autocorr =       1.312550755656
              std dev =       1.964726082506
             le_variance =       3.860148579280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860225941152
                                         uncertainty =       0.057328472825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860225941152
                                         uncertainty =       0.057328472825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389246103
  error estimate for blocks of size 2^( 2) =       0.001461827363
  error estimate for blocks of size 2^( 3) =       0.001524280240
  error estimate for blocks of size 2^( 4) =       0.001567403132
  error estimate for blocks of size 2^( 5) =       0.001591778543
  error estimate for blocks of size 2^( 6) =       0.001600282623
  error estimate for blocks of size 2^( 7) =       0.001606990739

      target function =                  N/A
              le_mean =     -22.326260346882
             les_mean =     502.286519064755
             stat err =       0.001591613759
             autocorr =       1.312553443037
              std dev =       1.964722114931
             le_variance =       3.860132988899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860233195182
                                         uncertainty =       0.057328996905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860233195182
                                         uncertainty =       0.057328996905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389247406
  error estimate for blocks of size 2^( 2) =       0.001461828174
  error estimate for blocks of size 2^( 3) =       0.001524280763
  error estimate for blocks of size 2^( 4) =       0.001567404564
  error estimate for blocks of size 2^( 5) =       0.001591779129
  error estimate for blocks of size 2^( 6) =       0.001600283565
  error estimate for blocks of size 2^( 7) =       0.001606990685

      target function =                  N/A
              le_mean =     -22.326260122779
             les_mean =     502.286421041881
             stat err =       0.001591614486
             autocorr =       1.312552179608
              std dev =       1.964723957287
             le_variance =       3.860140228339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860240469878
                                         uncertainty =       0.057329493917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860240469878
                                         uncertainty =       0.057329493917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389248712
  error estimate for blocks of size 2^( 2) =       0.001461829029
  error estimate for blocks of size 2^( 3) =       0.001524281333
  error estimate for blocks of size 2^( 4) =       0.001567405979
  error estimate for blocks of size 2^( 5) =       0.001591779781
  error estimate for blocks of size 2^( 6) =       0.001600284592
  error estimate for blocks of size 2^( 7) =       0.001606990513

      target function =                  N/A
              le_mean =     -22.326260063943
             les_mean =     502.286445119348
             stat err =       0.001591615216
             autocorr =       1.312550915487
              std dev =       1.964725805154
             le_variance =       3.860147489437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326260069398        initial
     3.9062e+00     3.9062e+01             1.1640e-04       -22.326260346882  <--
     1.5625e+01     1.5625e+02             3.0453e-05       -22.326260122779
     6.2500e+01     6.2500e+02             7.7031e-06       -22.326260063943

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.5578e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -6.967916e-01 3 1  ON 0
ci_002                -7.037375e-01 3 1  ON 1
ci_003                -6.114399e-02 3 1  ON 2
ci_004                -6.293414e-02 3 1  ON 3
ci_005                 4.527228e-02 3 1  ON 4
ci_006                 4.541784e-02 3 1  ON 5
ci_007                 3.209709e-02 3 1  ON 6
ci_008                 3.164762e-02 3 1  ON 7
ci_009                -2.542885e-02 3 1  ON 8
ci_010                -2.559304e-02 3 1  ON 9
ci_011                -2.324749e-02 3 1  ON 10
ci_012                -2.238517e-02 3 1  ON 11
ci_013                 1.956159e-02 3 1  ON 12
ci_014                 1.964891e-02 3 1  ON 13
ci_015                 2.081352e-02 3 1  ON 14
ci_016                 2.097788e-02 3 1  ON 15
ci_017                 1.635572e-02 3 1  ON 16
ci_018                 1.603581e-02 3 1  ON 17
ci_019                 9.519829e-03 3 1  ON 18
ci_020                 1.012350e-02 3 1  ON 19
ci_021                -9.581778e-03 3 1  ON 20
ci_022                -1.001738e-02 3 1  ON 21
ci_023                 8.034912e-03 3 1  ON 22
ci_024                 8.643915e-03 3 1  ON 23
ci_025                 7.206205e-03 3 1  ON 24
ci_026                 7.867756e-03 3 1  ON 25
ci_027                 8.032675e-03 3 1  ON 26
ci_028                 7.643010e-03 3 1  ON 27
ci_029                -7.806063e-03 3 1  ON 28
ci_030                -8.490782e-03 3 1  ON 29
ci_031                -6.323622e-03 3 1  ON 30
ci_032                -7.395292e-03 3 1  ON 31
ci_033                 6.268182e-03 3 1  ON 32
ci_034                 7.549162e-03 3 1  ON 33
ci_035                 6.696981e-03 3 1  ON 34
ci_036                 6.798349e-03 3 1  ON 35
ci_037                 6.014310e-03 3 1  ON 36
ci_038                 6.495314e-03 3 1  ON 37
ci_039                 5.730237e-03 3 1  ON 38
ci_040                 5.961752e-03 3 1  ON 39
ci_041                 4.635535e-03 3 1  ON 40
ci_042                 5.939007e-03 3 1  ON 41
ci_043                 4.224338e-03 3 1  ON 42
ci_044                 4.617894e-03 3 1  ON 43
ci_045                 5.173826e-03 3 1  ON 44
ci_046                 5.263636e-03 3 1  ON 45
ci_047                -4.547774e-03 3 1  ON 46
ci_048                -4.260507e-03 3 1  ON 47
ci_049                 3.570823e-03 3 1  ON 48
ci_050                 3.077625e-03 3 1  ON 49
ci_051                -2.738441e-03 3 1  ON 50
ci_052                -2.669835e-03 3 1  ON 51
ci_053                -2.897355e-03 3 1  ON 52
ci_054                -1.644550e-03 3 1  ON 53
ci_055                -1.374204e-03 3 1  ON 54
ci_056                -2.328095e-03 3 1  ON 55
ci_057                -2.241493e-03 3 1  ON 56
ci_058                -1.972077e-03 3 1  ON 57
ci_059                -2.043923e-03 3 1  ON 58
ci_060                -1.323577e-03 3 1  ON 59
ci_061                -2.012421e-03 3 1  ON 60
ci_062                -2.085553e-03 3 1  ON 61
ci_063                -1.577527e-03 3 1  ON 62
ci_064                -1.393449e-03 3 1  ON 63
ci_065                -1.133909e-03 3 1  ON 64
ci_066                -2.130195e-04 3 1  ON 65
ci_067                -1.632422e-03 3 1  ON 66
ci_068                -1.010679e-03 3 1  ON 67
ci_069                 1.428756e-03 3 1  ON 68
ci_070                 1.531998e-03 3 1  ON 69
ci_071                -7.867119e-04 3 1  ON 70
ci_072                -1.700004e-03 3 1  ON 71
ci_073                 1.672456e-03 3 1  ON 72
ci_074                 6.799987e-04 3 1  ON 73
ci_075                -6.224754e-04 3 1  ON 74
ci_076                -1.201246e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5651e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2306e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.5337
    reference variance = 2.81653
====================================================
  Execution time = 2.4192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0274e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7215e+00
  Total weights = 1.949805421e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8491e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773606290244
                                         uncertainty =       0.035030162637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773606290244
                                         uncertainty =       0.035030162637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373649657
  error estimate for blocks of size 2^( 2) =       0.001444733769
  error estimate for blocks of size 2^( 3) =       0.001511591653
  error estimate for blocks of size 2^( 4) =       0.001553722181
  error estimate for blocks of size 2^( 5) =       0.001579803315
  error estimate for blocks of size 2^( 6) =       0.001595557991
  error estimate for blocks of size 2^( 7) =       0.001591197072

      target function =                  N/A
              le_mean =     -22.329081505050
             les_mean =     502.309340404973
             stat err =       0.001580070140
             autocorr =       1.323124671739
              std dev =       1.942665056669
             le_variance =       3.773947522403


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232908150505e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329081504205       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329100583673       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329100664755       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 4.256860e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329081504205       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329086951870       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329087022204       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 1.172200e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329081504205       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329082916285       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329082938880       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+01 is 3.007217e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0047e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -6.967974e-01 3 1  ON 0
ci_002                -7.037441e-01 3 1  ON 1
ci_003                -6.110066e-02 3 1  ON 2
ci_004                -6.294282e-02 3 1  ON 3
ci_005                 4.525619e-02 3 1  ON 4
ci_006                 4.542044e-02 3 1  ON 5
ci_007                 3.207605e-02 3 1  ON 6
ci_008                 3.163461e-02 3 1  ON 7
ci_009                -2.542455e-02 3 1  ON 8
ci_010                -2.557037e-02 3 1  ON 9
ci_011                -2.321630e-02 3 1  ON 10
ci_012                -2.241573e-02 3 1  ON 11
ci_013                 1.952165e-02 3 1  ON 12
ci_014                 1.965000e-02 3 1  ON 13
ci_015                 2.076706e-02 3 1  ON 14
ci_016                 2.091979e-02 3 1  ON 15
ci_017                 1.629262e-02 3 1  ON 16
ci_018                 1.603410e-02 3 1  ON 17
ci_019                 9.517115e-03 3 1  ON 18
ci_020                 1.012711e-02 3 1  ON 19
ci_021                -9.613539e-03 3 1  ON 20
ci_022                -1.004867e-02 3 1  ON 21
ci_023                 8.099838e-03 3 1  ON 22
ci_024                 8.681289e-03 3 1  ON 23
ci_025                 7.171160e-03 3 1  ON 24
ci_026                 7.872052e-03 3 1  ON 25
ci_027                 8.028516e-03 3 1  ON 26
ci_028                 7.641604e-03 3 1  ON 27
ci_029                -7.824324e-03 3 1  ON 28
ci_030                -8.404131e-03 3 1  ON 29
ci_031                -6.344762e-03 3 1  ON 30
ci_032                -7.404947e-03 3 1  ON 31
ci_033                 6.303649e-03 3 1  ON 32
ci_034                 7.508756e-03 3 1  ON 33
ci_035                 6.749777e-03 3 1  ON 34
ci_036                 6.752902e-03 3 1  ON 35
ci_037                 6.058135e-03 3 1  ON 36
ci_038                 6.504179e-03 3 1  ON 37
ci_039                 5.754934e-03 3 1  ON 38
ci_040                 5.942293e-03 3 1  ON 39
ci_041                 4.720209e-03 3 1  ON 40
ci_042                 5.843972e-03 3 1  ON 41
ci_043                 4.233404e-03 3 1  ON 42
ci_044                 4.662967e-03 3 1  ON 43
ci_045                 5.085287e-03 3 1  ON 44
ci_046                 5.194806e-03 3 1  ON 45
ci_047                -4.517959e-03 3 1  ON 46
ci_048                -4.241629e-03 3 1  ON 47
ci_049                 3.584311e-03 3 1  ON 48
ci_050                 3.062324e-03 3 1  ON 49
ci_051                -2.790989e-03 3 1  ON 50
ci_052                -2.699710e-03 3 1  ON 51
ci_053                -2.825852e-03 3 1  ON 52
ci_054                -1.712561e-03 3 1  ON 53
ci_055                -1.491424e-03 3 1  ON 54
ci_056                -2.266437e-03 3 1  ON 55
ci_057                -2.212711e-03 3 1  ON 56
ci_058                -1.952874e-03 3 1  ON 57
ci_059                -2.087727e-03 3 1  ON 58
ci_060                -1.337242e-03 3 1  ON 59
ci_061                -1.941266e-03 3 1  ON 60
ci_062                -2.070024e-03 3 1  ON 61
ci_063                -1.471922e-03 3 1  ON 62
ci_064                -1.374327e-03 3 1  ON 63
ci_065                -1.113935e-03 3 1  ON 64
ci_066                -2.691808e-04 3 1  ON 65
ci_067                -1.641459e-03 3 1  ON 66
ci_068                -1.005512e-03 3 1  ON 67
ci_069                 1.390665e-03 3 1  ON 68
ci_070                 1.541183e-03 3 1  ON 69
ci_071                -7.677267e-04 3 1  ON 70
ci_072                -1.668089e-03 3 1  ON 71
ci_073                 1.620220e-03 3 1  ON 72
ci_074                 7.405404e-04 3 1  ON 73
ci_075                -5.969433e-04 3 1  ON 74
ci_076                -1.270217e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.3603
    reference variance = 3.66098
====================================================
  Execution time = 2.3682e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.8055e+00
  Total weights = 1.9499e+06
  Execution time = 4.3852e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000401245
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859107745069
                                         uncertainty =       0.040592405659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859107745069
                                         uncertainty =       0.040592405659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388936648
  error estimate for blocks of size 2^( 2) =       0.001458809767
  error estimate for blocks of size 2^( 3) =       0.001521887283
  error estimate for blocks of size 2^( 4) =       0.001566016783
  error estimate for blocks of size 2^( 5) =       0.001588723044
  error estimate for blocks of size 2^( 6) =       0.001599923307
  error estimate for blocks of size 2^( 7) =       0.001612339748

      target function =                  N/A
              le_mean =     -22.328641536970
             les_mean =     502.373672748463
             stat err =       0.001591750721
             autocorr =       1.313364387771
              std dev =       1.964284472145
             le_variance =       3.858413487511

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 8.07782e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859036286102
                                         uncertainty =       0.040591679687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859036286102
                                         uncertainty =       0.040591679687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388923737
  error estimate for blocks of size 2^( 2) =       0.001458801740
  error estimate for blocks of size 2^( 3) =       0.001521882350
  error estimate for blocks of size 2^( 4) =       0.001566017392
  error estimate for blocks of size 2^( 5) =       0.001588723346
  error estimate for blocks of size 2^( 6) =       0.001599923815
  error estimate for blocks of size 2^( 7) =       0.001612339370

      target function =                  N/A
              le_mean =     -22.328644616572
             les_mean =     502.376348145728
             stat err =       0.001591750981
             autocorr =       1.313389233728
              std dev =       1.964266213744
             le_variance =       3.858341758458

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00040329
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859067949019
                                         uncertainty =       0.040591704775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859067949019
                                         uncertainty =       0.040591704775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388929459
  error estimate for blocks of size 2^( 2) =       0.001458807563
  error estimate for blocks of size 2^( 3) =       0.001521887021
  error estimate for blocks of size 2^( 4) =       0.001566018450
  error estimate for blocks of size 2^( 5) =       0.001588723994
  error estimate for blocks of size 2^( 6) =       0.001599923037
  error estimate for blocks of size 2^( 7) =       0.001612343394

      target function =                  N/A
              le_mean =     -22.328642783962
             les_mean =     502.401752719884
             stat err =       0.001591752219
             autocorr =       1.313380456080
              std dev =       1.964274305067
             le_variance =       3.858373545547

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000946187
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859102188480
                                         uncertainty =       0.040592301209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859102188480
                                         uncertainty =       0.040592301209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388935644
  error estimate for blocks of size 2^( 2) =       0.001458809169
  error estimate for blocks of size 2^( 3) =       0.001521886975
  error estimate for blocks of size 2^( 4) =       0.001566016799
  error estimate for blocks of size 2^( 5) =       0.001588723032
  error estimate for blocks of size 2^( 6) =       0.001599923261
  error estimate for blocks of size 2^( 7) =       0.001612339992

      target function =                  N/A
              le_mean =     -22.328641641274
             les_mean =     502.373654386501
             stat err =       0.001591750771
             autocorr =       1.313366368609
              std dev =       1.964283053103
             le_variance =       3.858407912706


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328641536970        initial
     9.7656e-01     9.7656e+00             4.2569e-04       -22.328644616572  <--
     3.9062e+00     3.9062e+01             1.1722e-04       -22.328642783962
     1.5625e+01     1.5625e+02             3.0072e-05       -22.328641641274

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 4.5683e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -6.968108e-01 3 1  ON 0
ci_002                -7.037623e-01 3 1  ON 1
ci_003                -6.098264e-02 3 1  ON 2
ci_004                -6.296777e-02 3 1  ON 3
ci_005                 4.521654e-02 3 1  ON 4
ci_006                 4.542666e-02 3 1  ON 5
ci_007                 3.202515e-02 3 1  ON 6
ci_008                 3.160282e-02 3 1  ON 7
ci_009                -2.541520e-02 3 1  ON 8
ci_010                -2.550954e-02 3 1  ON 9
ci_011                -2.314421e-02 3 1  ON 10
ci_012                -2.249462e-02 3 1  ON 11
ci_013                 1.942457e-02 3 1  ON 12
ci_014                 1.965256e-02 3 1  ON 13
ci_015                 2.064109e-02 3 1  ON 14
ci_016                 2.076699e-02 3 1  ON 15
ci_017                 1.612975e-02 3 1  ON 16
ci_018                 1.603374e-02 3 1  ON 17
ci_019                 9.512594e-03 3 1  ON 18
ci_020                 1.013854e-02 3 1  ON 19
ci_021                -9.696319e-03 3 1  ON 20
ci_022                -1.013102e-02 3 1  ON 21
ci_023                 8.262163e-03 3 1  ON 22
ci_024                 8.773779e-03 3 1  ON 23
ci_025                 7.086111e-03 3 1  ON 24
ci_026                 7.885508e-03 3 1  ON 25
ci_027                 8.018334e-03 3 1  ON 26
ci_028                 7.637272e-03 3 1  ON 27
ci_029                -7.872230e-03 3 1  ON 28
ci_030                -8.179403e-03 3 1  ON 29
ci_031                -6.399686e-03 3 1  ON 30
ci_032                -7.430039e-03 3 1  ON 31
ci_033                 6.399498e-03 3 1  ON 32
ci_034                 7.407637e-03 3 1  ON 33
ci_035                 6.869778e-03 3 1  ON 34
ci_036                 6.647930e-03 3 1  ON 35
ci_037                 6.164448e-03 3 1  ON 36
ci_038                 6.525760e-03 3 1  ON 37
ci_039                 5.805364e-03 3 1  ON 38
ci_040                 5.897299e-03 3 1  ON 39
ci_041                 4.924889e-03 3 1  ON 40
ci_042                 5.614591e-03 3 1  ON 41
ci_043                 4.253597e-03 3 1  ON 42
ci_044                 4.782039e-03 3 1  ON 43
ci_045                 4.858033e-03 3 1  ON 44
ci_046                 5.021664e-03 3 1  ON 45
ci_047                -4.447248e-03 3 1  ON 46
ci_048                -4.199496e-03 3 1  ON 47
ci_049                 3.616408e-03 3 1  ON 48
ci_050                 3.022525e-03 3 1  ON 49
ci_051                -2.922573e-03 3 1  ON 50
ci_052                -2.776767e-03 3 1  ON 51
ci_053                -2.643389e-03 3 1  ON 52
ci_054                -1.884797e-03 3 1  ON 53
ci_055                -1.799890e-03 3 1  ON 54
ci_056                -2.108756e-03 3 1  ON 55
ci_057                -2.142637e-03 3 1  ON 56
ci_058                -1.902584e-03 3 1  ON 57
ci_059                -2.188473e-03 3 1  ON 58
ci_060                -1.371663e-03 3 1  ON 59
ci_061                -1.764756e-03 3 1  ON 60
ci_062                -2.022626e-03 3 1  ON 61
ci_063                -1.211133e-03 3 1  ON 62
ci_064                -1.324111e-03 3 1  ON 63
ci_065                -1.061220e-03 3 1  ON 64
ci_066                -4.143815e-04 3 1  ON 65
ci_067                -1.659835e-03 3 1  ON 66
ci_068                -9.921344e-04 3 1  ON 67
ci_069                 1.290188e-03 3 1  ON 68
ci_070                 1.565437e-03 3 1  ON 69
ci_071                -7.156258e-04 3 1  ON 70
ci_072                -1.584960e-03 3 1  ON 71
ci_073                 1.504233e-03 3 1  ON 72
ci_074                 8.819738e-04 3 1  ON 73
ci_075                -5.313219e-04 3 1  ON 74
ci_076                -1.442048e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5740e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2322e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.0397
    reference variance = 3.6401
====================================================
  Execution time = 2.4114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0306e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7313e+00
  Total weights = 1.950030730e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9140e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783075671467
                                         uncertainty =       0.064755949788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783075671467
                                         uncertainty =       0.064755949788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375500032
  error estimate for blocks of size 2^( 2) =       0.001447036940
  error estimate for blocks of size 2^( 3) =       0.001509072809
  error estimate for blocks of size 2^( 4) =       0.001549967851
  error estimate for blocks of size 2^( 5) =       0.001576258388
  error estimate for blocks of size 2^( 6) =       0.001587294023
  error estimate for blocks of size 2^( 7) =       0.001592411204

      target function =                  N/A
              le_mean =     -22.326813144475
             les_mean =     502.217859523215
             stat err =       0.001576482866
             autocorr =       1.313582337691
              std dev =       1.945281924582
             le_variance =       3.784121766105


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232681314448e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326813143709       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326862297112       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326864677537       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326864656286       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326864689965       residual = 1.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.286206e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326813143709       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326831655860       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326831903447       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326831888598       residual = 7.26e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 4.404078e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326813143709       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326818442693       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326818474332       residual = 1.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 1.214387e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022083 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0039e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -6.969857e-01 3 1  ON 0
ci_002                -7.035418e-01 3 1  ON 1
ci_003                -6.114064e-02 3 1  ON 2
ci_004                -6.293462e-02 3 1  ON 3
ci_005                 4.542635e-02 3 1  ON 4
ci_006                 4.559323e-02 3 1  ON 5
ci_007                 3.200539e-02 3 1  ON 6
ci_008                 3.173098e-02 3 1  ON 7
ci_009                -2.535043e-02 3 1  ON 8
ci_010                -2.541470e-02 3 1  ON 9
ci_011                -2.319445e-02 3 1  ON 10
ci_012                -2.269463e-02 3 1  ON 11
ci_013                 1.964307e-02 3 1  ON 12
ci_014                 1.987175e-02 3 1  ON 13
ci_015                 2.058046e-02 3 1  ON 14
ci_016                 2.070623e-02 3 1  ON 15
ci_017                 1.600821e-02 3 1  ON 16
ci_018                 1.604207e-02 3 1  ON 17
ci_019                 9.472023e-03 3 1  ON 18
ci_020                 1.016732e-02 3 1  ON 19
ci_021                -9.580090e-03 3 1  ON 20
ci_022                -1.019093e-02 3 1  ON 21
ci_023                 8.247989e-03 3 1  ON 22
ci_024                 8.588319e-03 3 1  ON 23
ci_025                 7.411067e-03 3 1  ON 24
ci_026                 7.863058e-03 3 1  ON 25
ci_027                 7.820498e-03 3 1  ON 26
ci_028                 7.841819e-03 3 1  ON 27
ci_029                -7.944647e-03 3 1  ON 28
ci_030                -8.462124e-03 3 1  ON 29
ci_031                -6.718181e-03 3 1  ON 30
ci_032                -7.446309e-03 3 1  ON 31
ci_033                 6.331883e-03 3 1  ON 32
ci_034                 7.157078e-03 3 1  ON 33
ci_035                 6.623935e-03 3 1  ON 34
ci_036                 6.654294e-03 3 1  ON 35
ci_037                 6.150116e-03 3 1  ON 36
ci_038                 6.639372e-03 3 1  ON 37
ci_039                 5.884105e-03 3 1  ON 38
ci_040                 6.106643e-03 3 1  ON 39
ci_041                 4.748055e-03 3 1  ON 40
ci_042                 5.505952e-03 3 1  ON 41
ci_043                 4.419541e-03 3 1  ON 42
ci_044                 4.692892e-03 3 1  ON 43
ci_045                 4.691948e-03 3 1  ON 44
ci_046                 5.144977e-03 3 1  ON 45
ci_047                -4.386313e-03 3 1  ON 46
ci_048                -3.907722e-03 3 1  ON 47
ci_049                 3.597942e-03 3 1  ON 48
ci_050                 2.990347e-03 3 1  ON 49
ci_051                -2.841109e-03 3 1  ON 50
ci_052                -2.641014e-03 3 1  ON 51
ci_053                -2.575039e-03 3 1  ON 52
ci_054                -2.127679e-03 3 1  ON 53
ci_055                -2.240298e-03 3 1  ON 54
ci_056                -2.000819e-03 3 1  ON 55
ci_057                -1.818628e-03 3 1  ON 56
ci_058                -1.914275e-03 3 1  ON 57
ci_059                -1.998142e-03 3 1  ON 58
ci_060                -1.218399e-03 3 1  ON 59
ci_061                -1.709031e-03 3 1  ON 60
ci_062                -1.963030e-03 3 1  ON 61
ci_063                -1.390332e-03 3 1  ON 62
ci_064                -1.223509e-03 3 1  ON 63
ci_065                -1.161137e-03 3 1  ON 64
ci_066                -4.332099e-04 3 1  ON 65
ci_067                -1.812600e-03 3 1  ON 66
ci_068                -1.008820e-03 3 1  ON 67
ci_069                 1.528491e-03 3 1  ON 68
ci_070                 1.367126e-03 3 1  ON 69
ci_071                -8.018503e-04 3 1  ON 70
ci_072                -1.344422e-03 3 1  ON 71
ci_073                 1.626107e-03 3 1  ON 72
ci_074                 9.630285e-04 3 1  ON 73
ci_075                -4.594801e-04 3 1  ON 74
ci_076                -1.600336e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.4796
    reference variance = 2.65499
====================================================
  Execution time = 2.3608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7418e+00
  Total weights = 1.9500e+06
  Execution time = 4.4076e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795048776236
                                         uncertainty =       0.057854098032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795048776236
                                         uncertainty =       0.057854098032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377516761
  error estimate for blocks of size 2^( 2) =       0.001448846775
  error estimate for blocks of size 2^( 3) =       0.001511512039
  error estimate for blocks of size 2^( 4) =       0.001555775893
  error estimate for blocks of size 2^( 5) =       0.001579635121
  error estimate for blocks of size 2^( 6) =       0.001593016793
  error estimate for blocks of size 2^( 7) =       0.001600333615

      target function =                  N/A
              le_mean =     -22.328549088284
             les_mean =     502.334210286214
             stat err =       0.001582190355
             autocorr =       1.319239608052
              std dev =       1.948134055412
             le_variance =       3.795226297856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795849861927
                                         uncertainty =       0.057854002365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795849861927
                                         uncertainty =       0.057854002365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377661711
  error estimate for blocks of size 2^( 2) =       0.001448972396
  error estimate for blocks of size 2^( 3) =       0.001511642912
  error estimate for blocks of size 2^( 4) =       0.001555868243
  error estimate for blocks of size 2^( 5) =       0.001579772344
  error estimate for blocks of size 2^( 6) =       0.001593135473
  error estimate for blocks of size 2^( 7) =       0.001600332841

      target function =                  N/A
              le_mean =     -22.328541672743
             les_mean =     503.007095953838
             stat err =       0.001582277225
             autocorr =       1.319106855193
              std dev =       1.948339048852
             le_variance =       3.796025049281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795157161253
                                         uncertainty =       0.057858028076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795157161253
                                         uncertainty =       0.057858028076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377536073
  error estimate for blocks of size 2^( 2) =       0.001448848221
  error estimate for blocks of size 2^( 3) =       0.001511483079
  error estimate for blocks of size 2^( 4) =       0.001555726136
  error estimate for blocks of size 2^( 5) =       0.001579580211
  error estimate for blocks of size 2^( 6) =       0.001592957439
  error estimate for blocks of size 2^( 7) =       0.001600269006

      target function =                  N/A
              le_mean =     -22.328552631881
             les_mean =     502.309118460039
             stat err =       0.001582133198
             autocorr =       1.319107307600
              std dev =       1.948161366688
             le_variance =       3.795332710656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795054752475
                                         uncertainty =       0.057854687927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795054752475
                                         uncertainty =       0.057854687927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377517794
  error estimate for blocks of size 2^( 2) =       0.001448845440
  error estimate for blocks of size 2^( 3) =       0.001511506455
  error estimate for blocks of size 2^( 4) =       0.001555766119
  error estimate for blocks of size 2^( 5) =       0.001579624751
  error estimate for blocks of size 2^( 6) =       0.001593005784
  error estimate for blocks of size 2^( 7) =       0.001600320006

      target function =                  N/A
              le_mean =     -22.328548507556
             les_mean =     502.306088121413
             stat err =       0.001582179165
             autocorr =       1.319218968950
              std dev =       1.948135516093
             le_variance =       3.795231989063


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328549088284        initial
     2.4414e-01     2.4414e+00             1.2862e-03       -22.328541672743
     9.7656e-01     9.7656e+00             4.4041e-04       -22.328552631881  <--
     3.9062e+00     3.9062e+01             1.2144e-04       -22.328548507556

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 4.5862e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -6.969857e-01 3 1  ON 0
ci_002                -7.035418e-01 3 1  ON 1
ci_003                -6.114064e-02 3 1  ON 2
ci_004                -6.293462e-02 3 1  ON 3
ci_005                 4.542635e-02 3 1  ON 4
ci_006                 4.559323e-02 3 1  ON 5
ci_007                 3.200539e-02 3 1  ON 6
ci_008                 3.173098e-02 3 1  ON 7
ci_009                -2.535043e-02 3 1  ON 8
ci_010                -2.541470e-02 3 1  ON 9
ci_011                -2.319445e-02 3 1  ON 10
ci_012                -2.269463e-02 3 1  ON 11
ci_013                 1.964307e-02 3 1  ON 12
ci_014                 1.987175e-02 3 1  ON 13
ci_015                 2.058046e-02 3 1  ON 14
ci_016                 2.070623e-02 3 1  ON 15
ci_017                 1.600821e-02 3 1  ON 16
ci_018                 1.604207e-02 3 1  ON 17
ci_019                 9.472023e-03 3 1  ON 18
ci_020                 1.016732e-02 3 1  ON 19
ci_021                -9.580090e-03 3 1  ON 20
ci_022                -1.019093e-02 3 1  ON 21
ci_023                 8.247989e-03 3 1  ON 22
ci_024                 8.588319e-03 3 1  ON 23
ci_025                 7.411067e-03 3 1  ON 24
ci_026                 7.863058e-03 3 1  ON 25
ci_027                 7.820498e-03 3 1  ON 26
ci_028                 7.841819e-03 3 1  ON 27
ci_029                -7.944647e-03 3 1  ON 28
ci_030                -8.462124e-03 3 1  ON 29
ci_031                -6.718181e-03 3 1  ON 30
ci_032                -7.446309e-03 3 1  ON 31
ci_033                 6.331883e-03 3 1  ON 32
ci_034                 7.157078e-03 3 1  ON 33
ci_035                 6.623935e-03 3 1  ON 34
ci_036                 6.654294e-03 3 1  ON 35
ci_037                 6.150116e-03 3 1  ON 36
ci_038                 6.639372e-03 3 1  ON 37
ci_039                 5.884105e-03 3 1  ON 38
ci_040                 6.106643e-03 3 1  ON 39
ci_041                 4.748055e-03 3 1  ON 40
ci_042                 5.505952e-03 3 1  ON 41
ci_043                 4.419541e-03 3 1  ON 42
ci_044                 4.692892e-03 3 1  ON 43
ci_045                 4.691948e-03 3 1  ON 44
ci_046                 5.144977e-03 3 1  ON 45
ci_047                -4.386313e-03 3 1  ON 46
ci_048                -3.907722e-03 3 1  ON 47
ci_049                 3.597942e-03 3 1  ON 48
ci_050                 2.990347e-03 3 1  ON 49
ci_051                -2.841109e-03 3 1  ON 50
ci_052                -2.641014e-03 3 1  ON 51
ci_053                -2.575039e-03 3 1  ON 52
ci_054                -2.127679e-03 3 1  ON 53
ci_055                -2.240298e-03 3 1  ON 54
ci_056                -2.000819e-03 3 1  ON 55
ci_057                -1.818628e-03 3 1  ON 56
ci_058                -1.914275e-03 3 1  ON 57
ci_059                -1.998142e-03 3 1  ON 58
ci_060                -1.218399e-03 3 1  ON 59
ci_061                -1.709031e-03 3 1  ON 60
ci_062                -1.963030e-03 3 1  ON 61
ci_063                -1.390332e-03 3 1  ON 62
ci_064                -1.223509e-03 3 1  ON 63
ci_065                -1.161137e-03 3 1  ON 64
ci_066                -4.332099e-04 3 1  ON 65
ci_067                -1.812600e-03 3 1  ON 66
ci_068                -1.008820e-03 3 1  ON 67
ci_069                 1.528491e-03 3 1  ON 68
ci_070                 1.367126e-03 3 1  ON 69
ci_071                -8.018503e-04 3 1  ON 70
ci_072                -1.344422e-03 3 1  ON 71
ci_073                 1.626107e-03 3 1  ON 72
ci_074                 9.630285e-04 3 1  ON 73
ci_075                -4.594801e-04 3 1  ON 74
ci_076                -1.600336e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2316e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.3111
    reference variance = 2.66694
====================================================
  Execution time = 2.4116e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0318e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7667e+00
  Total weights = 1.949524572e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9108e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820078175669
                                         uncertainty =       0.033787292496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820078175669
                                         uncertainty =       0.033787292496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381997757
  error estimate for blocks of size 2^( 2) =       0.001452295858
  error estimate for blocks of size 2^( 3) =       0.001515456999
  error estimate for blocks of size 2^( 4) =       0.001556174444
  error estimate for blocks of size 2^( 5) =       0.001579057550
  error estimate for blocks of size 2^( 6) =       0.001588279926
  error estimate for blocks of size 2^( 7) =       0.001592513700

      target function =                  N/A
              le_mean =     -22.328797719685
             les_mean =     502.341928988671
             stat err =       0.001579006405
             autocorr =       1.305428550647
              std dev =       1.954471242204
             le_variance =       3.819957836604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232879771969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328797718816       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328824931012       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328826113211       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328826198578       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.000968e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328797718816       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328808019076       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328808149974       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 3.500912e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328797718816       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328800673618       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328800690465       residual = 5.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+00 is 1.069176e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025165 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0037e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -6.970207e-01 3 1  ON 0
ci_002                -7.035551e-01 3 1  ON 1
ci_003                -6.092666e-02 3 1  ON 2
ci_004                -6.289249e-02 3 1  ON 3
ci_005                 4.531570e-02 3 1  ON 4
ci_006                 4.567375e-02 3 1  ON 5
ci_007                 3.182025e-02 3 1  ON 6
ci_008                 3.158458e-02 3 1  ON 7
ci_009                -2.547318e-02 3 1  ON 8
ci_010                -2.549084e-02 3 1  ON 9
ci_011                -2.301235e-02 3 1  ON 10
ci_012                -2.264246e-02 3 1  ON 11
ci_013                 1.947371e-02 3 1  ON 12
ci_014                 1.989048e-02 3 1  ON 13
ci_015                 2.048057e-02 3 1  ON 14
ci_016                 2.059166e-02 3 1  ON 15
ci_017                 1.580565e-02 3 1  ON 16
ci_018                 1.593772e-02 3 1  ON 17
ci_019                 9.581895e-03 3 1  ON 18
ci_020                 1.022285e-02 3 1  ON 19
ci_021                -9.906966e-03 3 1  ON 20
ci_022                -1.001736e-02 3 1  ON 21
ci_023                 8.241341e-03 3 1  ON 22
ci_024                 8.485740e-03 3 1  ON 23
ci_025                 7.408931e-03 3 1  ON 24
ci_026                 8.095052e-03 3 1  ON 25
ci_027                 7.815342e-03 3 1  ON 26
ci_028                 7.646969e-03 3 1  ON 27
ci_029                -7.801069e-03 3 1  ON 28
ci_030                -8.599299e-03 3 1  ON 29
ci_031                -6.787642e-03 3 1  ON 30
ci_032                -7.494858e-03 3 1  ON 31
ci_033                 6.526306e-03 3 1  ON 32
ci_034                 7.051017e-03 3 1  ON 33
ci_035                 6.520410e-03 3 1  ON 34
ci_036                 6.757488e-03 3 1  ON 35
ci_037                 6.230284e-03 3 1  ON 36
ci_038                 6.579751e-03 3 1  ON 37
ci_039                 5.979632e-03 3 1  ON 38
ci_040                 5.902885e-03 3 1  ON 39
ci_041                 4.844770e-03 3 1  ON 40
ci_042                 5.610683e-03 3 1  ON 41
ci_043                 4.744064e-03 3 1  ON 42
ci_044                 4.809469e-03 3 1  ON 43
ci_045                 4.702611e-03 3 1  ON 44
ci_046                 5.122922e-03 3 1  ON 45
ci_047                -4.328167e-03 3 1  ON 46
ci_048                -4.257813e-03 3 1  ON 47
ci_049                 3.560686e-03 3 1  ON 48
ci_050                 3.070279e-03 3 1  ON 49
ci_051                -2.923004e-03 3 1  ON 50
ci_052                -2.781776e-03 3 1  ON 51
ci_053                -2.523135e-03 3 1  ON 52
ci_054                -2.050602e-03 3 1  ON 53
ci_055                -2.167491e-03 3 1  ON 54
ci_056                -2.121159e-03 3 1  ON 55
ci_057                -1.917948e-03 3 1  ON 56
ci_058                -2.072228e-03 3 1  ON 57
ci_059                -1.914112e-03 3 1  ON 58
ci_060                -1.318672e-03 3 1  ON 59
ci_061                -1.684743e-03 3 1  ON 60
ci_062                -1.944019e-03 3 1  ON 61
ci_063                -1.520822e-03 3 1  ON 62
ci_064                -1.020869e-03 3 1  ON 63
ci_065                -9.860416e-04 3 1  ON 64
ci_066                -6.325448e-04 3 1  ON 65
ci_067                -1.676053e-03 3 1  ON 66
ci_068                -1.169169e-03 3 1  ON 67
ci_069                 1.431455e-03 3 1  ON 68
ci_070                 1.348584e-03 3 1  ON 69
ci_071                -7.240611e-04 3 1  ON 70
ci_072                -1.207179e-03 3 1  ON 71
ci_073                 1.422896e-03 3 1  ON 72
ci_074                 9.049126e-04 3 1  ON 73
ci_075                -7.255346e-04 3 1  ON 74
ci_076                -1.380860e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.2928
    reference variance = 3.04784
====================================================
  Execution time = 2.3608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7210e+00
  Total weights = 1.9499e+06
  Execution time = 4.3991e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773879085858
                                         uncertainty =       0.031925361545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773879085858
                                         uncertainty =       0.031925361545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373610933
  error estimate for blocks of size 2^( 2) =       0.001445180406
  error estimate for blocks of size 2^( 3) =       0.001509369676
  error estimate for blocks of size 2^( 4) =       0.001553001472
  error estimate for blocks of size 2^( 5) =       0.001577758009
  error estimate for blocks of size 2^( 6) =       0.001591568605
  error estimate for blocks of size 2^( 7) =       0.001599759602

      target function =                  N/A
              le_mean =     -22.326702422194
             les_mean =     502.214877925739
             stat err =       0.001580521922
             autocorr =       1.323956055105
              std dev =       1.942610291542
             le_variance =       3.773734744805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773811029486
                                         uncertainty =       0.031935463610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773811029486
                                         uncertainty =       0.031935463610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373598628
  error estimate for blocks of size 2^( 2) =       0.001445187957
  error estimate for blocks of size 2^( 3) =       0.001509386817
  error estimate for blocks of size 2^( 4) =       0.001553043206
  error estimate for blocks of size 2^( 5) =       0.001577792041
  error estimate for blocks of size 2^( 6) =       0.001591570823
  error estimate for blocks of size 2^( 7) =       0.001599791584

      target function =                  N/A
              le_mean =     -22.326710425628
             les_mean =     502.214029566778
             stat err =       0.001580549413
             autocorr =       1.324025834859
              std dev =       1.942592889362
             le_variance =       3.773667133798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773802272289
                                         uncertainty =       0.031933014657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773802272289
                                         uncertainty =       0.031933014657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373597011
  error estimate for blocks of size 2^( 2) =       0.001445182276
  error estimate for blocks of size 2^( 3) =       0.001509379434
  error estimate for blocks of size 2^( 4) =       0.001553029406
  error estimate for blocks of size 2^( 5) =       0.001577777423
  error estimate for blocks of size 2^( 6) =       0.001591558384
  error estimate for blocks of size 2^( 7) =       0.001599773745

      target function =                  N/A
              le_mean =     -22.326703155914
             les_mean =     502.203161289425
             stat err =       0.001580534740
             autocorr =       1.324004367166
              std dev =       1.942590603107
             le_variance =       3.773658251279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773849655630
                                         uncertainty =       0.031926973348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773849655630
                                         uncertainty =       0.031926973348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373605588
  error estimate for blocks of size 2^( 2) =       0.001445179710
  error estimate for blocks of size 2^( 3) =       0.001509371758
  error estimate for blocks of size 2^( 4) =       0.001553007501
  error estimate for blocks of size 2^( 5) =       0.001577762196
  error estimate for blocks of size 2^( 6) =       0.001591564818
  error estimate for blocks of size 2^( 7) =       0.001599754546

      target function =                  N/A
              le_mean =     -22.326700661361
             les_mean =     502.208988694774
             stat err =       0.001580522265
             autocorr =       1.323966933328
              std dev =       1.942602733134
             le_variance =       3.773705378778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326702422194        initial
     2.4414e-01     2.4414e+00             1.0010e-03       -22.326710425628  <--
     9.7656e-01     9.7656e+00             3.5009e-04       -22.326703155914
     3.9062e+00     3.9062e+01             1.0692e-04       -22.326700661361

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.5781e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -6.970862e-01 3 1  ON 0
ci_002                -7.035822e-01 3 1  ON 1
ci_003                -6.040340e-02 3 1  ON 2
ci_004                -6.279425e-02 3 1  ON 3
ci_005                 4.515873e-02 3 1  ON 4
ci_006                 4.579539e-02 3 1  ON 5
ci_007                 3.148867e-02 3 1  ON 6
ci_008                 3.134583e-02 3 1  ON 7
ci_009                -2.569266e-02 3 1  ON 8
ci_010                -2.568984e-02 3 1  ON 9
ci_011                -2.272375e-02 3 1  ON 10
ci_012                -2.257022e-02 3 1  ON 11
ci_013                 1.917530e-02 3 1  ON 12
ci_014                 1.995753e-02 3 1  ON 13
ci_015                 2.028269e-02 3 1  ON 14
ci_016                 2.037958e-02 3 1  ON 15
ci_017                 1.541696e-02 3 1  ON 16
ci_018                 1.575127e-02 3 1  ON 17
ci_019                 9.829487e-03 3 1  ON 18
ci_020                 1.028566e-02 3 1  ON 19
ci_021                -1.058106e-02 3 1  ON 20
ci_022                -9.685554e-03 3 1  ON 21
ci_023                 8.230127e-03 3 1  ON 22
ci_024                 8.317277e-03 3 1  ON 23
ci_025                 7.413710e-03 3 1  ON 24
ci_026                 8.544855e-03 3 1  ON 25
ci_027                 7.801982e-03 3 1  ON 26
ci_028                 7.398733e-03 3 1  ON 27
ci_029                -7.563930e-03 3 1  ON 28
ci_030                -8.833599e-03 3 1  ON 29
ci_031                -6.885071e-03 3 1  ON 30
ci_032                -7.609876e-03 3 1  ON 31
ci_033                 6.903113e-03 3 1  ON 32
ci_034                 6.861542e-03 3 1  ON 33
ci_035                 6.365925e-03 3 1  ON 34
ci_036                 6.890659e-03 3 1  ON 35
ci_037                 6.326833e-03 3 1  ON 36
ci_038                 6.481824e-03 3 1  ON 37
ci_039                 6.106877e-03 3 1  ON 38
ci_040                 5.628414e-03 3 1  ON 39
ci_041                 4.994015e-03 3 1  ON 40
ci_042                 5.777608e-03 3 1  ON 41
ci_043                 5.294632e-03 3 1  ON 42
ci_044                 4.977105e-03 3 1  ON 43
ci_045                 4.700801e-03 3 1  ON 44
ci_046                 5.100314e-03 3 1  ON 45
ci_047                -4.256276e-03 3 1  ON 46
ci_048                -4.719816e-03 3 1  ON 47
ci_049                 3.497129e-03 3 1  ON 48
ci_050                 3.213649e-03 3 1  ON 49
ci_051                -3.060196e-03 3 1  ON 50
ci_052                -3.042818e-03 3 1  ON 51
ci_053                -2.438790e-03 3 1  ON 52
ci_054                -1.917224e-03 3 1  ON 53
ci_055                -2.036263e-03 3 1  ON 54
ci_056                -2.343746e-03 3 1  ON 55
ci_057                -2.077301e-03 3 1  ON 56
ci_058                -2.329481e-03 3 1  ON 57
ci_059                -1.775316e-03 3 1  ON 58
ci_060                -1.467400e-03 3 1  ON 59
ci_061                -1.640018e-03 3 1  ON 60
ci_062                -1.931342e-03 3 1  ON 61
ci_063                -1.761524e-03 3 1  ON 62
ci_064                -6.614914e-04 3 1  ON 63
ci_065                -6.881332e-04 3 1  ON 64
ci_066                -9.800105e-04 3 1  ON 65
ci_067                -1.431348e-03 3 1  ON 66
ci_068                -1.449461e-03 3 1  ON 67
ci_069                 1.248931e-03 3 1  ON 68
ci_070                 1.327702e-03 3 1  ON 69
ci_071                -5.785100e-04 3 1  ON 70
ci_072                -9.281604e-04 3 1  ON 71
ci_073                 1.152303e-03 3 1  ON 72
ci_074                 8.432057e-04 3 1  ON 73
ci_075                -1.203159e-03 3 1  ON 74
ci_076                -1.011458e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5831e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2315e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.2083
    reference variance = 4.78193
====================================================
  Execution time = 2.4208e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0286e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6933e+00
  Total weights = 1.949854311e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9227e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747015738319
                                         uncertainty =       0.031944457416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.747015738319
                                         uncertainty =       0.031944457416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368698643
  error estimate for blocks of size 2^( 2) =       0.001439431387
  error estimate for blocks of size 2^( 3) =       0.001501954008
  error estimate for blocks of size 2^( 4) =       0.001544257139
  error estimate for blocks of size 2^( 5) =       0.001566885702
  error estimate for blocks of size 2^( 6) =       0.001576858531
  error estimate for blocks of size 2^( 7) =       0.001588076088

      target function =                  N/A
              le_mean =     -22.329368662163
             les_mean =     502.294027759253
             stat err =       0.001569019365
             autocorr =       1.314137880771
              std dev =       1.935663153398
             le_variance =       3.746791843423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232936866216e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329368661370       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329453892820       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329459746994       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329462482385       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329462708350       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329462782071       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329462607526       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 2.422320e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329368661370       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329418159395       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329419757086       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329420122666       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.310817e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329368661370       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329387151274       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329387459721       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 4.660831e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029044 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0142e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -6.972557e-01 3 1  ON 0
ci_002                -7.033935e-01 3 1  ON 1
ci_003                -6.083565e-02 3 1  ON 2
ci_004                -6.276839e-02 3 1  ON 3
ci_005                 4.525501e-02 3 1  ON 4
ci_006                 4.591137e-02 3 1  ON 5
ci_007                 3.092014e-02 3 1  ON 6
ci_008                 3.155392e-02 3 1  ON 7
ci_009                -2.544996e-02 3 1  ON 8
ci_010                -2.529462e-02 3 1  ON 9
ci_011                -2.289317e-02 3 1  ON 10
ci_012                -2.356690e-02 3 1  ON 11
ci_013                 1.970891e-02 3 1  ON 12
ci_014                 2.044337e-02 3 1  ON 13
ci_015                 2.021256e-02 3 1  ON 14
ci_016                 2.052569e-02 3 1  ON 15
ci_017                 1.501457e-02 3 1  ON 16
ci_018                 1.478073e-02 3 1  ON 17
ci_019                 9.621163e-03 3 1  ON 18
ci_020                 1.031761e-02 3 1  ON 19
ci_021                -9.728471e-03 3 1  ON 20
ci_022                -9.829076e-03 3 1  ON 21
ci_023                 8.387301e-03 3 1  ON 22
ci_024                 9.031703e-03 3 1  ON 23
ci_025                 7.147581e-03 3 1  ON 24
ci_026                 8.575693e-03 3 1  ON 25
ci_027                 7.754924e-03 3 1  ON 26
ci_028                 8.117455e-03 3 1  ON 27
ci_029                -8.209456e-03 3 1  ON 28
ci_030                -7.522782e-03 3 1  ON 29
ci_031                -7.241182e-03 3 1  ON 30
ci_032                -7.554379e-03 3 1  ON 31
ci_033                 6.657338e-03 3 1  ON 32
ci_034                 6.712049e-03 3 1  ON 33
ci_035                 6.631059e-03 3 1  ON 34
ci_036                 6.968489e-03 3 1  ON 35
ci_037                 6.023278e-03 3 1  ON 36
ci_038                 6.819801e-03 3 1  ON 37
ci_039                 5.987446e-03 3 1  ON 38
ci_040                 5.924653e-03 3 1  ON 39
ci_041                 4.577807e-03 3 1  ON 40
ci_042                 5.715453e-03 3 1  ON 41
ci_043                 5.331921e-03 3 1  ON 42
ci_044                 4.997268e-03 3 1  ON 43
ci_045                 5.322099e-03 3 1  ON 44
ci_046                 4.663717e-03 3 1  ON 45
ci_047                -4.196553e-03 3 1  ON 46
ci_048                -3.830911e-03 3 1  ON 47
ci_049                 2.877754e-03 3 1  ON 48
ci_050                 3.433958e-03 3 1  ON 49
ci_051                -2.822950e-03 3 1  ON 50
ci_052                -2.238042e-03 3 1  ON 51
ci_053                -2.211707e-03 3 1  ON 52
ci_054                -2.112715e-03 3 1  ON 53
ci_055                -1.737429e-03 3 1  ON 54
ci_056                -1.557376e-03 3 1  ON 55
ci_057                -1.991084e-03 3 1  ON 56
ci_058                -2.192687e-03 3 1  ON 57
ci_059                -1.635097e-03 3 1  ON 58
ci_060                -1.496084e-03 3 1  ON 59
ci_061                -1.133510e-03 3 1  ON 60
ci_062                -1.927691e-03 3 1  ON 61
ci_063                -1.605990e-03 3 1  ON 62
ci_064                -8.898359e-04 3 1  ON 63
ci_065                -6.827343e-04 3 1  ON 64
ci_066                -9.004946e-04 3 1  ON 65
ci_067                -1.571489e-03 3 1  ON 66
ci_068                -1.238764e-03 3 1  ON 67
ci_069                 1.538449e-03 3 1  ON 68
ci_070                 1.546905e-03 3 1  ON 69
ci_071                -1.100034e-04 3 1  ON 70
ci_072                -1.564042e-03 3 1  ON 71
ci_073                 1.243393e-03 3 1  ON 72
ci_074                 1.135702e-03 3 1  ON 73
ci_075                -5.652988e-04 3 1  ON 74
ci_076                -1.770012e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.374
    reference variance = 2.90493
====================================================
  Execution time = 2.3769e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7183e+00
  Total weights = 1.9500e+06
  Execution time = 4.4140e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770563186210
                                         uncertainty =       0.031109096312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770563186210
                                         uncertainty =       0.031109096312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373147186
  error estimate for blocks of size 2^( 2) =       0.001444893491
  error estimate for blocks of size 2^( 3) =       0.001508463657
  error estimate for blocks of size 2^( 4) =       0.001553999529
  error estimate for blocks of size 2^( 5) =       0.001578526910
  error estimate for blocks of size 2^( 6) =       0.001594452346
  error estimate for blocks of size 2^( 7) =       0.001602905624

      target function =                  N/A
              le_mean =     -22.327731499226
             les_mean =     502.255801336261
             stat err =       0.001582471102
             autocorr =       1.328120235707
              std dev =       1.941954443803
             le_variance =       3.771187061805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770638405274
                                         uncertainty =       0.031117971018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770638405274
                                         uncertainty =       0.031117971018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373160650
  error estimate for blocks of size 2^( 2) =       0.001444892800
  error estimate for blocks of size 2^( 3) =       0.001508461812
  error estimate for blocks of size 2^( 4) =       0.001553964561
  error estimate for blocks of size 2^( 5) =       0.001578491327
  error estimate for blocks of size 2^( 6) =       0.001594378097
  error estimate for blocks of size 2^( 7) =       0.001602802909

      target function =                  N/A
              le_mean =     -22.327720797366
             les_mean =     502.312339529809
             stat err =       0.001582409224
             autocorr =       1.327990329106
              std dev =       1.941973485260
             le_variance =       3.771261017453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770695560712
                                         uncertainty =       0.031118166952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770695560712
                                         uncertainty =       0.031118166952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373171052
  error estimate for blocks of size 2^( 2) =       0.001444892092
  error estimate for blocks of size 2^( 3) =       0.001508455373
  error estimate for blocks of size 2^( 4) =       0.001553954984
  error estimate for blocks of size 2^( 5) =       0.001578444583
  error estimate for blocks of size 2^( 6) =       0.001594310178
  error estimate for blocks of size 2^( 7) =       0.001602706208

      target function =                  N/A
              le_mean =     -22.327744502755
             les_mean =     502.340505429938
             stat err =       0.001582353988
             autocorr =       1.327877502243
              std dev =       1.941988196932
             le_variance =       3.771318157024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770464486181
                                         uncertainty =       0.031114991935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770464486181
                                         uncertainty =       0.031114991935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373129228
  error estimate for blocks of size 2^( 2) =       0.001444875881
  error estimate for blocks of size 2^( 3) =       0.001508443679
  error estimate for blocks of size 2^( 4) =       0.001553971121
  error estimate for blocks of size 2^( 5) =       0.001578494017
  error estimate for blocks of size 2^( 6) =       0.001594410464
  error estimate for blocks of size 2^( 7) =       0.001602856610

      target function =                  N/A
              le_mean =     -22.327718992024
             les_mean =     502.265481043510
             stat err =       0.001582433053
             autocorr =       1.328091105479
              std dev =       1.941929047384
             le_variance =       3.771088425073


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327731499226        initial
     6.1035e-02     6.1035e-01             2.4223e-03       -22.327720797366
     2.4414e-01     2.4414e+00             1.3108e-03       -22.327744502755  <--
     9.7656e-01     9.7656e+00             4.6608e-04       -22.327718992024

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.6014e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -6.972557e-01 3 1  ON 0
ci_002                -7.033935e-01 3 1  ON 1
ci_003                -6.083565e-02 3 1  ON 2
ci_004                -6.276839e-02 3 1  ON 3
ci_005                 4.525501e-02 3 1  ON 4
ci_006                 4.591137e-02 3 1  ON 5
ci_007                 3.092014e-02 3 1  ON 6
ci_008                 3.155392e-02 3 1  ON 7
ci_009                -2.544996e-02 3 1  ON 8
ci_010                -2.529462e-02 3 1  ON 9
ci_011                -2.289317e-02 3 1  ON 10
ci_012                -2.356690e-02 3 1  ON 11
ci_013                 1.970891e-02 3 1  ON 12
ci_014                 2.044337e-02 3 1  ON 13
ci_015                 2.021256e-02 3 1  ON 14
ci_016                 2.052569e-02 3 1  ON 15
ci_017                 1.501457e-02 3 1  ON 16
ci_018                 1.478073e-02 3 1  ON 17
ci_019                 9.621163e-03 3 1  ON 18
ci_020                 1.031761e-02 3 1  ON 19
ci_021                -9.728471e-03 3 1  ON 20
ci_022                -9.829076e-03 3 1  ON 21
ci_023                 8.387301e-03 3 1  ON 22
ci_024                 9.031703e-03 3 1  ON 23
ci_025                 7.147581e-03 3 1  ON 24
ci_026                 8.575693e-03 3 1  ON 25
ci_027                 7.754924e-03 3 1  ON 26
ci_028                 8.117455e-03 3 1  ON 27
ci_029                -8.209456e-03 3 1  ON 28
ci_030                -7.522782e-03 3 1  ON 29
ci_031                -7.241182e-03 3 1  ON 30
ci_032                -7.554379e-03 3 1  ON 31
ci_033                 6.657338e-03 3 1  ON 32
ci_034                 6.712049e-03 3 1  ON 33
ci_035                 6.631059e-03 3 1  ON 34
ci_036                 6.968489e-03 3 1  ON 35
ci_037                 6.023278e-03 3 1  ON 36
ci_038                 6.819801e-03 3 1  ON 37
ci_039                 5.987446e-03 3 1  ON 38
ci_040                 5.924653e-03 3 1  ON 39
ci_041                 4.577807e-03 3 1  ON 40
ci_042                 5.715453e-03 3 1  ON 41
ci_043                 5.331921e-03 3 1  ON 42
ci_044                 4.997268e-03 3 1  ON 43
ci_045                 5.322099e-03 3 1  ON 44
ci_046                 4.663717e-03 3 1  ON 45
ci_047                -4.196553e-03 3 1  ON 46
ci_048                -3.830911e-03 3 1  ON 47
ci_049                 2.877754e-03 3 1  ON 48
ci_050                 3.433958e-03 3 1  ON 49
ci_051                -2.822950e-03 3 1  ON 50
ci_052                -2.238042e-03 3 1  ON 51
ci_053                -2.211707e-03 3 1  ON 52
ci_054                -2.112715e-03 3 1  ON 53
ci_055                -1.737429e-03 3 1  ON 54
ci_056                -1.557376e-03 3 1  ON 55
ci_057                -1.991084e-03 3 1  ON 56
ci_058                -2.192687e-03 3 1  ON 57
ci_059                -1.635097e-03 3 1  ON 58
ci_060                -1.496084e-03 3 1  ON 59
ci_061                -1.133510e-03 3 1  ON 60
ci_062                -1.927691e-03 3 1  ON 61
ci_063                -1.605990e-03 3 1  ON 62
ci_064                -8.898359e-04 3 1  ON 63
ci_065                -6.827343e-04 3 1  ON 64
ci_066                -9.004946e-04 3 1  ON 65
ci_067                -1.571489e-03 3 1  ON 66
ci_068                -1.238764e-03 3 1  ON 67
ci_069                 1.538449e-03 3 1  ON 68
ci_070                 1.546905e-03 3 1  ON 69
ci_071                -1.100034e-04 3 1  ON 70
ci_072                -1.564042e-03 3 1  ON 71
ci_073                 1.243393e-03 3 1  ON 72
ci_074                 1.135702e-03 3 1  ON 73
ci_075                -5.652988e-04 3 1  ON 74
ci_076                -1.770012e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6171e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6028
    reference variance = 2.74485
====================================================
  Execution time = 2.4318e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0318e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8376e+00
  Total weights = 1.949718413e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9161e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.894238838588
                                         uncertainty =       0.089102023431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.894238838588
                                         uncertainty =       0.089102023431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395219996
  error estimate for blocks of size 2^( 2) =       0.001465853265
  error estimate for blocks of size 2^( 3) =       0.001527597385
  error estimate for blocks of size 2^( 4) =       0.001569264655
  error estimate for blocks of size 2^( 5) =       0.001597698865
  error estimate for blocks of size 2^( 6) =       0.001615893540
  error estimate for blocks of size 2^( 7) =       0.001620541010

      target function =                  N/A
              le_mean =     -22.327830037622
             les_mean =     502.369548267283
             stat err =       0.001600849518
             autocorr =       1.316484151911
              std dev =       1.973170610589
             le_variance =       3.893402258494


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232783003762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327830036827       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327892054717       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327898897595       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327900683698       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327901058866       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327900929287       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327900976477       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 2.628233e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327830036827       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327866275290       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327867859573       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327867904103       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327867906446       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 8.439617e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327830036827       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327843646364       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327843869212       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 3.372178e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033129 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0245e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -6.965459e-01 3 1  ON 0
ci_002                -7.039917e-01 3 1  ON 1
ci_003                -6.141179e-02 3 1  ON 2
ci_004                -6.312665e-02 3 1  ON 3
ci_005                 4.568755e-02 3 1  ON 4
ci_006                 4.559812e-02 3 1  ON 5
ci_007                 3.154483e-02 3 1  ON 6
ci_008                 3.211136e-02 3 1  ON 7
ci_009                -2.565953e-02 3 1  ON 8
ci_010                -2.477175e-02 3 1  ON 9
ci_011                -2.237153e-02 3 1  ON 10
ci_012                -2.295290e-02 3 1  ON 11
ci_013                 2.009247e-02 3 1  ON 12
ci_014                 2.060978e-02 3 1  ON 13
ci_015                 2.045856e-02 3 1  ON 14
ci_016                 1.996917e-02 3 1  ON 15
ci_017                 1.488160e-02 3 1  ON 16
ci_018                 1.496896e-02 3 1  ON 17
ci_019                 1.002325e-02 3 1  ON 18
ci_020                 9.771972e-03 3 1  ON 19
ci_021                -9.559268e-03 3 1  ON 20
ci_022                -1.005247e-02 3 1  ON 21
ci_023                 9.155462e-03 3 1  ON 22
ci_024                 8.975304e-03 3 1  ON 23
ci_025                 7.150697e-03 3 1  ON 24
ci_026                 9.119736e-03 3 1  ON 25
ci_027                 7.417237e-03 3 1  ON 26
ci_028                 7.805804e-03 3 1  ON 27
ci_029                -8.603479e-03 3 1  ON 28
ci_030                -7.120560e-03 3 1  ON 29
ci_031                -7.176256e-03 3 1  ON 30
ci_032                -8.036515e-03 3 1  ON 31
ci_033                 7.032050e-03 3 1  ON 32
ci_034                 6.442569e-03 3 1  ON 33
ci_035                 6.728174e-03 3 1  ON 34
ci_036                 6.165177e-03 3 1  ON 35
ci_037                 5.955748e-03 3 1  ON 36
ci_038                 7.224268e-03 3 1  ON 37
ci_039                 5.912607e-03 3 1  ON 38
ci_040                 5.595783e-03 3 1  ON 39
ci_041                 4.664123e-03 3 1  ON 40
ci_042                 5.589536e-03 3 1  ON 41
ci_043                 5.137040e-03 3 1  ON 42
ci_044                 4.779339e-03 3 1  ON 43
ci_045                 4.478137e-03 3 1  ON 44
ci_046                 5.131836e-03 3 1  ON 45
ci_047                -4.472157e-03 3 1  ON 46
ci_048                -3.606116e-03 3 1  ON 47
ci_049                 2.957208e-03 3 1  ON 48
ci_050                 3.360384e-03 3 1  ON 49
ci_051                -2.933566e-03 3 1  ON 50
ci_052                -1.742542e-03 3 1  ON 51
ci_053                -2.216008e-03 3 1  ON 52
ci_054                -2.189278e-03 3 1  ON 53
ci_055                -1.982465e-03 3 1  ON 54
ci_056                -1.576641e-03 3 1  ON 55
ci_057                -2.531449e-03 3 1  ON 56
ci_058                -2.400135e-03 3 1  ON 57
ci_059                -2.028885e-03 3 1  ON 58
ci_060                -2.304104e-03 3 1  ON 59
ci_061                -1.523841e-03 3 1  ON 60
ci_062                -1.552215e-03 3 1  ON 61
ci_063                -1.421886e-03 3 1  ON 62
ci_064                -9.108963e-04 3 1  ON 63
ci_065                -8.253348e-04 3 1  ON 64
ci_066                -7.974475e-04 3 1  ON 65
ci_067                -1.928886e-03 3 1  ON 66
ci_068                -1.116791e-03 3 1  ON 67
ci_069                 1.959331e-03 3 1  ON 68
ci_070                 1.553216e-03 3 1  ON 69
ci_071                -3.650743e-04 3 1  ON 70
ci_072                -1.726789e-03 3 1  ON 71
ci_073                 1.291650e-03 3 1  ON 72
ci_074                 1.554454e-03 3 1  ON 73
ci_075                -6.518075e-04 3 1  ON 74
ci_076                -6.213072e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.5
    reference variance = 4.28989
====================================================
  Execution time = 2.3686e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6839e+00
  Total weights = 1.9501e+06
  Execution time = 4.4156e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734160166939
                                         uncertainty =       0.028161649512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734160166939
                                         uncertainty =       0.028161649512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366356995
  error estimate for blocks of size 2^( 2) =       0.001436973175
  error estimate for blocks of size 2^( 3) =       0.001500472039
  error estimate for blocks of size 2^( 4) =       0.001545112651
  error estimate for blocks of size 2^( 5) =       0.001568990601
  error estimate for blocks of size 2^( 6) =       0.001579760380
  error estimate for blocks of size 2^( 7) =       0.001580251028

      target function =                  N/A
              le_mean =     -22.328780618995
             les_mean =     502.287333731795
             stat err =       0.001568528665
             autocorr =       1.317821385214
              std dev =       1.932351510024
             le_variance =       3.733982358291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734356296348
                                         uncertainty =       0.028177592203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734356296348
                                         uncertainty =       0.028177592203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366393095
  error estimate for blocks of size 2^( 2) =       0.001436991237
  error estimate for blocks of size 2^( 3) =       0.001500471938
  error estimate for blocks of size 2^( 4) =       0.001545067300
  error estimate for blocks of size 2^( 5) =       0.001568913646
  error estimate for blocks of size 2^( 6) =       0.001579704299
  error estimate for blocks of size 2^( 7) =       0.001580215933

      target function =                  N/A
              le_mean =     -22.328787974436
             les_mean =     502.262608420020
             stat err =       0.001568475294
             autocorr =       1.317662078273
              std dev =       1.932402564063
             le_variance =       3.734179669597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734455738061
                                         uncertainty =       0.028178856292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734455738061
                                         uncertainty =       0.028178856292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366411361
  error estimate for blocks of size 2^( 2) =       0.001437004683
  error estimate for blocks of size 2^( 3) =       0.001500484326
  error estimate for blocks of size 2^( 4) =       0.001545077207
  error estimate for blocks of size 2^( 5) =       0.001568918271
  error estimate for blocks of size 2^( 6) =       0.001579709530
  error estimate for blocks of size 2^( 7) =       0.001580207072

      target function =                  N/A
              le_mean =     -22.328800668704
             les_mean =     502.264439093998
             stat err =       0.001568478020
             autocorr =       1.317631429419
              std dev =       1.932428396923
             le_variance =       3.734279509236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734020949273
                                         uncertainty =       0.028170302445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734020949273
                                         uncertainty =       0.028170302445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366331590
  error estimate for blocks of size 2^( 2) =       0.001436946532
  error estimate for blocks of size 2^( 3) =       0.001500442727
  error estimate for blocks of size 2^( 4) =       0.001545070626
  error estimate for blocks of size 2^( 5) =       0.001568916151
  error estimate for blocks of size 2^( 6) =       0.001579715002
  error estimate for blocks of size 2^( 7) =       0.001580228937

      target function =                  N/A
              le_mean =     -22.328777782241
             les_mean =     502.260796454896
             stat err =       0.001568482679
             autocorr =       1.317793118153
              std dev =       1.932315581426
             le_variance =       3.733843506223


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328780618995        initial
     6.1035e-02     6.1035e-01             2.6282e-03       -22.328787974436
     2.4414e-01     2.4414e+00             8.4396e-04       -22.328800668704  <--
     9.7656e-01     9.7656e+00             3.3722e-04       -22.328777782241

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.5947e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -6.965459e-01 3 1  ON 0
ci_002                -7.039917e-01 3 1  ON 1
ci_003                -6.141179e-02 3 1  ON 2
ci_004                -6.312665e-02 3 1  ON 3
ci_005                 4.568755e-02 3 1  ON 4
ci_006                 4.559812e-02 3 1  ON 5
ci_007                 3.154483e-02 3 1  ON 6
ci_008                 3.211136e-02 3 1  ON 7
ci_009                -2.565953e-02 3 1  ON 8
ci_010                -2.477175e-02 3 1  ON 9
ci_011                -2.237153e-02 3 1  ON 10
ci_012                -2.295290e-02 3 1  ON 11
ci_013                 2.009247e-02 3 1  ON 12
ci_014                 2.060978e-02 3 1  ON 13
ci_015                 2.045856e-02 3 1  ON 14
ci_016                 1.996917e-02 3 1  ON 15
ci_017                 1.488160e-02 3 1  ON 16
ci_018                 1.496896e-02 3 1  ON 17
ci_019                 1.002325e-02 3 1  ON 18
ci_020                 9.771972e-03 3 1  ON 19
ci_021                -9.559268e-03 3 1  ON 20
ci_022                -1.005247e-02 3 1  ON 21
ci_023                 9.155462e-03 3 1  ON 22
ci_024                 8.975304e-03 3 1  ON 23
ci_025                 7.150697e-03 3 1  ON 24
ci_026                 9.119736e-03 3 1  ON 25
ci_027                 7.417237e-03 3 1  ON 26
ci_028                 7.805804e-03 3 1  ON 27
ci_029                -8.603479e-03 3 1  ON 28
ci_030                -7.120560e-03 3 1  ON 29
ci_031                -7.176256e-03 3 1  ON 30
ci_032                -8.036515e-03 3 1  ON 31
ci_033                 7.032050e-03 3 1  ON 32
ci_034                 6.442569e-03 3 1  ON 33
ci_035                 6.728174e-03 3 1  ON 34
ci_036                 6.165177e-03 3 1  ON 35
ci_037                 5.955748e-03 3 1  ON 36
ci_038                 7.224268e-03 3 1  ON 37
ci_039                 5.912607e-03 3 1  ON 38
ci_040                 5.595783e-03 3 1  ON 39
ci_041                 4.664123e-03 3 1  ON 40
ci_042                 5.589536e-03 3 1  ON 41
ci_043                 5.137040e-03 3 1  ON 42
ci_044                 4.779339e-03 3 1  ON 43
ci_045                 4.478137e-03 3 1  ON 44
ci_046                 5.131836e-03 3 1  ON 45
ci_047                -4.472157e-03 3 1  ON 46
ci_048                -3.606116e-03 3 1  ON 47
ci_049                 2.957208e-03 3 1  ON 48
ci_050                 3.360384e-03 3 1  ON 49
ci_051                -2.933566e-03 3 1  ON 50
ci_052                -1.742542e-03 3 1  ON 51
ci_053                -2.216008e-03 3 1  ON 52
ci_054                -2.189278e-03 3 1  ON 53
ci_055                -1.982465e-03 3 1  ON 54
ci_056                -1.576641e-03 3 1  ON 55
ci_057                -2.531449e-03 3 1  ON 56
ci_058                -2.400135e-03 3 1  ON 57
ci_059                -2.028885e-03 3 1  ON 58
ci_060                -2.304104e-03 3 1  ON 59
ci_061                -1.523841e-03 3 1  ON 60
ci_062                -1.552215e-03 3 1  ON 61
ci_063                -1.421886e-03 3 1  ON 62
ci_064                -9.108963e-04 3 1  ON 63
ci_065                -8.253348e-04 3 1  ON 64
ci_066                -7.974475e-04 3 1  ON 65
ci_067                -1.928886e-03 3 1  ON 66
ci_068                -1.116791e-03 3 1  ON 67
ci_069                 1.959331e-03 3 1  ON 68
ci_070                 1.553216e-03 3 1  ON 69
ci_071                -3.650743e-04 3 1  ON 70
ci_072                -1.726789e-03 3 1  ON 71
ci_073                 1.291650e-03 3 1  ON 72
ci_074                 1.554454e-03 3 1  ON 73
ci_075                -6.518075e-04 3 1  ON 74
ci_076                -6.213072e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6208e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2331e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.3145
    reference variance = 3.85871
====================================================
  Execution time = 2.4340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0288e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6889e+00
  Total weights = 1.949868214e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5067e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738209625998
                                         uncertainty =       0.035747194264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738209625998
                                         uncertainty =       0.035747194264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367229405
  error estimate for blocks of size 2^( 2) =       0.001438380377
  error estimate for blocks of size 2^( 3) =       0.001501987443
  error estimate for blocks of size 2^( 4) =       0.001544017403
  error estimate for blocks of size 2^( 5) =       0.001570264273
  error estimate for blocks of size 2^( 6) =       0.001581675296
  error estimate for blocks of size 2^( 7) =       0.001586523579

      target function =                  N/A
              le_mean =     -22.329496061130
             les_mean =     502.295296485240
             stat err =       0.001570620138
             autocorr =       1.319652370878
              std dev =       1.933585304681
             le_variance =       3.738752130478


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232949606113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329496060355       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329566472721       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329576299802       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329580439149       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329579275732       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329579775921       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329580025806       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.329580115436       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 2.243551e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329496060355       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329535765999       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329538096245       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329538536530       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329538399384       residual = 1.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 8.992620e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329496060355       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329510528155       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329510808246       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e-01 is 3.500365e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.035208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0855e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -6.960092e-01 3 1  ON 0
ci_002                -7.045406e-01 3 1  ON 1
ci_003                -6.178256e-02 3 1  ON 2
ci_004                -6.223707e-02 3 1  ON 3
ci_005                 4.562116e-02 3 1  ON 4
ci_006                 4.649738e-02 3 1  ON 5
ci_007                 3.184538e-02 3 1  ON 6
ci_008                 3.184126e-02 3 1  ON 7
ci_009                -2.546986e-02 3 1  ON 8
ci_010                -2.477138e-02 3 1  ON 9
ci_011                -2.192775e-02 3 1  ON 10
ci_012                -2.279827e-02 3 1  ON 11
ci_013                 1.990322e-02 3 1  ON 12
ci_014                 2.037636e-02 3 1  ON 13
ci_015                 2.022541e-02 3 1  ON 14
ci_016                 2.077841e-02 3 1  ON 15
ci_017                 1.488000e-02 3 1  ON 16
ci_018                 1.529179e-02 3 1  ON 17
ci_019                 1.073802e-02 3 1  ON 18
ci_020                 9.981675e-03 3 1  ON 19
ci_021                -1.034338e-02 3 1  ON 20
ci_022                -1.002315e-02 3 1  ON 21
ci_023                 8.960484e-03 3 1  ON 22
ci_024                 9.082919e-03 3 1  ON 23
ci_025                 6.596257e-03 3 1  ON 24
ci_026                 8.966006e-03 3 1  ON 25
ci_027                 7.895457e-03 3 1  ON 26
ci_028                 7.591806e-03 3 1  ON 27
ci_029                -7.920598e-03 3 1  ON 28
ci_030                -7.151391e-03 3 1  ON 29
ci_031                -7.506295e-03 3 1  ON 30
ci_032                -7.673852e-03 3 1  ON 31
ci_033                 7.130516e-03 3 1  ON 32
ci_034                 6.236967e-03 3 1  ON 33
ci_035                 6.372284e-03 3 1  ON 34
ci_036                 6.363351e-03 3 1  ON 35
ci_037                 5.884385e-03 3 1  ON 36
ci_038                 6.906162e-03 3 1  ON 37
ci_039                 5.393922e-03 3 1  ON 38
ci_040                 5.385026e-03 3 1  ON 39
ci_041                 4.227781e-03 3 1  ON 40
ci_042                 5.836812e-03 3 1  ON 41
ci_043                 4.867198e-03 3 1  ON 42
ci_044                 4.380298e-03 3 1  ON 43
ci_045                 3.980597e-03 3 1  ON 44
ci_046                 5.194949e-03 3 1  ON 45
ci_047                -4.717663e-03 3 1  ON 46
ci_048                -3.965035e-03 3 1  ON 47
ci_049                 3.164977e-03 3 1  ON 48
ci_050                 2.994048e-03 3 1  ON 49
ci_051                -3.188564e-03 3 1  ON 50
ci_052                -2.441306e-03 3 1  ON 51
ci_053                -2.400159e-03 3 1  ON 52
ci_054                -2.605670e-03 3 1  ON 53
ci_055                -1.909212e-03 3 1  ON 54
ci_056                -2.443648e-03 3 1  ON 55
ci_057                -1.853819e-03 3 1  ON 56
ci_058                -3.074769e-03 3 1  ON 57
ci_059                -1.722848e-03 3 1  ON 58
ci_060                -2.069232e-03 3 1  ON 59
ci_061                -1.142103e-03 3 1  ON 60
ci_062                -2.053356e-03 3 1  ON 61
ci_063                -1.423936e-03 3 1  ON 62
ci_064                -1.756307e-03 3 1  ON 63
ci_065                -1.206208e-03 3 1  ON 64
ci_066                -1.173185e-03 3 1  ON 65
ci_067                -1.615227e-03 3 1  ON 66
ci_068                -1.074012e-03 3 1  ON 67
ci_069                 1.124281e-03 3 1  ON 68
ci_070                 9.816865e-04 3 1  ON 69
ci_071                -2.686387e-04 3 1  ON 70
ci_072                -9.511376e-04 3 1  ON 71
ci_073                 1.341459e-03 3 1  ON 72
ci_074                 1.198145e-03 3 1  ON 73
ci_075                -7.321380e-04 3 1  ON 74
ci_076                -4.821155e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.1431
    reference variance = 4.81925
====================================================
  Execution time = 2.3825e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7447e+00
  Total weights = 1.9498e+06
  Execution time = 4.4868e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810351839455
                                         uncertainty =       0.061860428091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810351839455
                                         uncertainty =       0.061860428091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380055607
  error estimate for blocks of size 2^( 2) =       0.001449979177
  error estimate for blocks of size 2^( 3) =       0.001512129170
  error estimate for blocks of size 2^( 4) =       0.001555660338
  error estimate for blocks of size 2^( 5) =       0.001580577359
  error estimate for blocks of size 2^( 6) =       0.001596037856
  error estimate for blocks of size 2^( 7) =       0.001611790777

      target function =                  N/A
              le_mean =     -22.327508298577
             les_mean =     515.625010012612
             stat err =       0.001586016582
             autocorr =       1.320755037922
              std dev =       1.951724582417
             le_variance =       3.809228845612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795507469371
                                         uncertainty =       0.059018365699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795507469371
                                         uncertainty =       0.059018365699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377371203
  error estimate for blocks of size 2^( 2) =       0.001447421681
  error estimate for blocks of size 2^( 3) =       0.001509679658
  error estimate for blocks of size 2^( 4) =       0.001553199670
  error estimate for blocks of size 2^( 5) =       0.001578189425
  error estimate for blocks of size 2^( 6) =       0.001593674555
  error estimate for blocks of size 2^( 7) =       0.001608997415

      target function =                  N/A
              le_mean =     -22.327603001687
             les_mean =     502.385814734880
             stat err =       0.001583515266
             autocorr =       1.321729281657
              std dev =       1.947928202181
             le_variance =       3.794424280852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795124448266
                                         uncertainty =       0.059021026058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.795124448266
                                         uncertainty =       0.059021026058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377301878
  error estimate for blocks of size 2^( 2) =       0.001447364400
  error estimate for blocks of size 2^( 3) =       0.001509614654
  error estimate for blocks of size 2^( 4) =       0.001553115662
  error estimate for blocks of size 2^( 5) =       0.001578123373
  error estimate for blocks of size 2^( 6) =       0.001593670465
  error estimate for blocks of size 2^( 7) =       0.001609035787

      target function =                  N/A
              le_mean =     -22.327585906053
             les_mean =     502.272399611043
             stat err =       0.001583486322
             autocorr =       1.321814017505
              std dev =       1.947830159952
             le_variance =       3.794042332018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794951305466
                                         uncertainty =       0.059020363327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794951305466
                                         uncertainty =       0.059020363327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377270861
  error estimate for blocks of size 2^( 2) =       0.001447341053
  error estimate for blocks of size 2^( 3) =       0.001509609386
  error estimate for blocks of size 2^( 4) =       0.001553108520
  error estimate for blocks of size 2^( 5) =       0.001578107697
  error estimate for blocks of size 2^( 6) =       0.001593660038
  error estimate for blocks of size 2^( 7) =       0.001608983563

      target function =                  N/A
              le_mean =     -22.327582762155
             les_mean =     502.269616952649
             stat err =       0.001583464955
             autocorr =       1.321837881872
              std dev =       1.947786293888
             le_variance =       3.793871446658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327508298577        initial
     6.1035e-02     6.1035e-01             2.2436e-03       -22.327603001687  <--
     2.4414e-01     2.4414e+00             8.9926e-04       -22.327585906053
     9.7656e-01     9.7656e+00             3.5004e-04       -22.327582762155

*****************************************************************************
Applying the update for shift_i =   6.1035e-02     and shift_s =   6.1035e-01
*****************************************************************************

  Execution time = 4.6397e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -6.943730e-01 3 1  ON 0
ci_002                -7.062071e-01 3 1  ON 1
ci_003                -6.237601e-02 3 1  ON 2
ci_004                -6.088310e-02 3 1  ON 3
ci_005                 4.551545e-02 3 1  ON 4
ci_006                 4.714685e-02 3 1  ON 5
ci_007                 3.206729e-02 3 1  ON 6
ci_008                 3.174781e-02 3 1  ON 7
ci_009                -2.519957e-02 3 1  ON 8
ci_010                -2.489428e-02 3 1  ON 9
ci_011                -2.143616e-02 3 1  ON 10
ci_012                -2.268531e-02 3 1  ON 11
ci_013                 1.967158e-02 3 1  ON 12
ci_014                 2.019304e-02 3 1  ON 13
ci_015                 1.990762e-02 3 1  ON 14
ci_016                 2.165878e-02 3 1  ON 15
ci_017                 1.478820e-02 3 1  ON 16
ci_018                 1.565229e-02 3 1  ON 17
ci_019                 1.156658e-02 3 1  ON 18
ci_020                 1.020717e-02 3 1  ON 19
ci_021                -1.112819e-02 3 1  ON 20
ci_022                -1.006246e-02 3 1  ON 21
ci_023                 8.818932e-03 3 1  ON 22
ci_024                 9.176540e-03 3 1  ON 23
ci_025                 5.994833e-03 3 1  ON 24
ci_026                 8.863919e-03 3 1  ON 25
ci_027                 8.148851e-03 3 1  ON 26
ci_028                 7.494629e-03 3 1  ON 27
ci_029                -7.257643e-03 3 1  ON 28
ci_030                -7.177070e-03 3 1  ON 29
ci_031                -7.758380e-03 3 1  ON 30
ci_032                -7.330839e-03 3 1  ON 31
ci_033                 7.254368e-03 3 1  ON 32
ci_034                 6.050583e-03 3 1  ON 33
ci_035                 6.206490e-03 3 1  ON 34
ci_036                 6.385700e-03 3 1  ON 35
ci_037                 5.778732e-03 3 1  ON 36
ci_038                 6.625094e-03 3 1  ON 37
ci_039                 5.105937e-03 3 1  ON 38
ci_040                 5.268103e-03 3 1  ON 39
ci_041                 3.958736e-03 3 1  ON 40
ci_042                 6.024937e-03 3 1  ON 41
ci_043                 4.625769e-03 3 1  ON 42
ci_044                 4.061591e-03 3 1  ON 43
ci_045                 3.535641e-03 3 1  ON 44
ci_046                 5.261902e-03 3 1  ON 45
ci_047                -4.848107e-03 3 1  ON 46
ci_048                -4.147907e-03 3 1  ON 47
ci_049                 3.349760e-03 3 1  ON 48
ci_050                 2.679546e-03 3 1  ON 49
ci_051                -3.423752e-03 3 1  ON 50
ci_052                -3.081849e-03 3 1  ON 51
ci_053                -2.561647e-03 3 1  ON 52
ci_054                -2.948412e-03 3 1  ON 53
ci_055                -1.797211e-03 3 1  ON 54
ci_056                -3.311927e-03 3 1  ON 55
ci_057                -1.363154e-03 3 1  ON 56
ci_058                -3.599589e-03 3 1  ON 57
ci_059                -1.545586e-03 3 1  ON 58
ci_060                -1.917582e-03 3 1  ON 59
ci_061                -7.813337e-04 3 1  ON 60
ci_062                -2.391320e-03 3 1  ON 61
ci_063                -1.401872e-03 3 1  ON 62
ci_064                -2.439058e-03 3 1  ON 63
ci_065                -1.527286e-03 3 1  ON 64
ci_066                -1.444722e-03 3 1  ON 65
ci_067                -1.355762e-03 3 1  ON 66
ci_068                -9.745601e-04 3 1  ON 67
ci_069                 4.561576e-04 3 1  ON 68
ci_070                 5.597800e-04 3 1  ON 69
ci_071                -1.980940e-04 3 1  ON 70
ci_072                -2.967173e-04 3 1  ON 71
ci_073                 1.363030e-03 3 1  ON 72
ci_074                 9.974552e-04 3 1  ON 73
ci_075                -7.613902e-04 3 1  ON 74
ci_076                -3.471743e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2324e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.3224
    reference variance = 4.09056
====================================================
  Execution time = 2.4466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0273e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7234e+00
  Total weights = 1.949874382e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9948e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773190787152
                                         uncertainty =       0.040806102327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773190787152
                                         uncertainty =       0.040806102327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373568436
  error estimate for blocks of size 2^( 2) =       0.001443535075
  error estimate for blocks of size 2^( 3) =       0.001507490445
  error estimate for blocks of size 2^( 4) =       0.001550226153
  error estimate for blocks of size 2^( 5) =       0.001574522325
  error estimate for blocks of size 2^( 6) =       0.001586712639
  error estimate for blocks of size 2^( 7) =       0.001595015348

      target function =                  N/A
              le_mean =     -22.328823726939
             les_mean =     502.299811790033
             stat err =       0.001576619116
             autocorr =       1.317507121125
              std dev =       1.942550190967
             le_variance =       3.773501244427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232882372694e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328823726121       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328941786161       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328952704735       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328956451635       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328955102749       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328956230871       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328956594333       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.328956858772       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.328956653669       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.328956970529       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-02 is 2.559508e-03

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328823726121       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328919876639       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328925829138       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328927444603       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328926831418       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328927110295       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328927126725       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-02 is 1.915872e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328823726121       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328878910979       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328880149381       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328880373469       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e-01 is 1.113953e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0490e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -6.949203e-01 3 1  ON 0
ci_002                -7.057107e-01 3 1  ON 1
ci_003                -6.138248e-02 3 1  ON 2
ci_004                -6.199465e-02 3 1  ON 3
ci_005                 4.470157e-02 3 1  ON 4
ci_006                 4.628523e-02 3 1  ON 5
ci_007                 3.255400e-02 3 1  ON 6
ci_008                 3.015575e-02 3 1  ON 7
ci_009                -2.517686e-02 3 1  ON 8
ci_010                -2.562620e-02 3 1  ON 9
ci_011                -2.320984e-02 3 1  ON 10
ci_012                -2.380510e-02 3 1  ON 11
ci_013                 2.026050e-02 3 1  ON 12
ci_014                 2.150117e-02 3 1  ON 13
ci_015                 1.805425e-02 3 1  ON 14
ci_016                 1.988329e-02 3 1  ON 15
ci_017                 1.534646e-02 3 1  ON 16
ci_018                 1.632341e-02 3 1  ON 17
ci_019                 1.068072e-02 3 1  ON 18
ci_020                 1.032387e-02 3 1  ON 19
ci_021                -1.165196e-02 3 1  ON 20
ci_022                -1.020824e-02 3 1  ON 21
ci_023                 8.960780e-03 3 1  ON 22
ci_024                 8.570865e-03 3 1  ON 23
ci_025                 5.970207e-03 3 1  ON 24
ci_026                 8.417712e-03 3 1  ON 25
ci_027                 8.184666e-03 3 1  ON 26
ci_028                 7.848176e-03 3 1  ON 27
ci_029                -8.582750e-03 3 1  ON 28
ci_030                -8.131232e-03 3 1  ON 29
ci_031                -8.169005e-03 3 1  ON 30
ci_032                -7.487765e-03 3 1  ON 31
ci_033                 7.016624e-03 3 1  ON 32
ci_034                 6.938392e-03 3 1  ON 33
ci_035                 6.977476e-03 3 1  ON 34
ci_036                 7.007162e-03 3 1  ON 35
ci_037                 6.954592e-03 3 1  ON 36
ci_038                 7.358354e-03 3 1  ON 37
ci_039                 5.044028e-03 3 1  ON 38
ci_040                 5.245413e-03 3 1  ON 39
ci_041                 4.365763e-03 3 1  ON 40
ci_042                 5.076016e-03 3 1  ON 41
ci_043                 5.533792e-03 3 1  ON 42
ci_044                 3.695016e-03 3 1  ON 43
ci_045                 4.781372e-03 3 1  ON 44
ci_046                 5.547580e-03 3 1  ON 45
ci_047                -4.178751e-03 3 1  ON 46
ci_048                -3.024673e-03 3 1  ON 47
ci_049                 2.657314e-03 3 1  ON 48
ci_050                 1.772868e-03 3 1  ON 49
ci_051                -3.736449e-03 3 1  ON 50
ci_052                -2.607240e-03 3 1  ON 51
ci_053                -2.271371e-03 3 1  ON 52
ci_054                -2.306663e-03 3 1  ON 53
ci_055                -1.665633e-03 3 1  ON 54
ci_056                -2.509970e-03 3 1  ON 55
ci_057                -2.132198e-03 3 1  ON 56
ci_058                -1.683717e-03 3 1  ON 57
ci_059                -1.723365e-03 3 1  ON 58
ci_060                -2.040675e-03 3 1  ON 59
ci_061                -1.796629e-03 3 1  ON 60
ci_062                -2.054724e-03 3 1  ON 61
ci_063                -1.413232e-03 3 1  ON 62
ci_064                -2.068428e-03 3 1  ON 63
ci_065                -4.310008e-04 3 1  ON 64
ci_066                -9.886813e-04 3 1  ON 65
ci_067                -1.249185e-03 3 1  ON 66
ci_068                -6.468480e-04 3 1  ON 67
ci_069                 1.035955e-03 3 1  ON 68
ci_070                 1.338534e-03 3 1  ON 69
ci_071                -1.009321e-03 3 1  ON 70
ci_072                 1.679409e-04 3 1  ON 71
ci_073                 8.814194e-04 3 1  ON 72
ci_074                 1.269428e-03 3 1  ON 73
ci_075                -1.088863e-03 3 1  ON 74
ci_076                -1.037158e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.3965
    reference variance = 2.91301
====================================================
  Execution time = 2.3952e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7380e+00
  Total weights = 1.9502e+06
  Execution time = 4.5016e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797280699116
                                         uncertainty =       0.029481778982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797280699116
                                         uncertainty =       0.029481778982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377770481
  error estimate for blocks of size 2^( 2) =       0.001448650664
  error estimate for blocks of size 2^( 3) =       0.001512317578
  error estimate for blocks of size 2^( 4) =       0.001555138052
  error estimate for blocks of size 2^( 5) =       0.001581790237
  error estimate for blocks of size 2^( 6) =       0.001596430901
  error estimate for blocks of size 2^( 7) =       0.001595440306

      target function =                  N/A
              le_mean =     -22.327623883365
             les_mean =     503.701701367697
             stat err =       0.001582199874
             autocorr =       1.318769636933
              std dev =       1.948492875809
             le_variance =       3.796624487079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788259917672
                                         uncertainty =       0.028817848440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788259917672
                                         uncertainty =       0.028817848440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376140122
  error estimate for blocks of size 2^( 2) =       0.001447184490
  error estimate for blocks of size 2^( 3) =       0.001510926478
  error estimate for blocks of size 2^( 4) =       0.001553864959
  error estimate for blocks of size 2^( 5) =       0.001580722331
  error estimate for blocks of size 2^( 6) =       0.001595211577
  error estimate for blocks of size 2^( 7) =       0.001594132659

      target function =                  N/A
              le_mean =     -22.327556059000
             les_mean =     502.313037793526
             stat err =       0.001580982882
             autocorr =       1.319863506533
              std dev =       1.946187162299
             le_variance =       3.787644470697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       8.050395199589
                                         uncertainty =       4.242438449617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       8.050395199589
                                         uncertainty =       4.242438449617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.002006599258
  error estimate for blocks of size 2^( 2) =       0.002056283212
  error estimate for blocks of size 2^( 3) =       0.002101932686
  error estimate for blocks of size 2^( 4) =       0.002136033519
  error estimate for blocks of size 2^( 5) =       0.002156805619
  error estimate for blocks of size 2^( 6) =       0.002170126602
  error estimate for blocks of size 2^( 7) =       0.002175460171

      target function =                  N/A
              le_mean =     -22.326188691406
             les_mean =    1885.484816253680
             stat err =       0.002159606478
             autocorr =       1.158318381684
              std dev =       2.837805288401
             le_variance =       8.053138854878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788220202785
                                         uncertainty =       0.028857860034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.788220202785
                                         uncertainty =       0.028857860034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376132829
  error estimate for blocks of size 2^( 2) =       0.001447186699
  error estimate for blocks of size 2^( 3) =       0.001510945651
  error estimate for blocks of size 2^( 4) =       0.001553903565
  error estimate for blocks of size 2^( 5) =       0.001580769342
  error estimate for blocks of size 2^( 6) =       0.001595250289
  error estimate for blocks of size 2^( 7) =       0.001594126900

      target function =                  N/A
              le_mean =     -22.327541392369
             les_mean =     502.270366077549
             stat err =       0.001581012524
             autocorr =       1.319926989905
              std dev =       1.946176848181
             le_variance =       3.787604324395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327623883365        initial  <--
     1.5259e-02     1.5259e-01             2.5595e-03       -22.327556059000
     6.1035e-02     6.1035e-01             1.9159e-03       -22.326188691406
     2.4414e-01     2.4414e+00             1.1140e-03       -22.327541392369

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.5754
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -6.943730e-01 3 1  ON 0
ci_002                -7.062071e-01 3 1  ON 1
ci_003                -6.237601e-02 3 1  ON 2
ci_004                -6.088310e-02 3 1  ON 3
ci_005                 4.551545e-02 3 1  ON 4
ci_006                 4.714685e-02 3 1  ON 5
ci_007                 3.206729e-02 3 1  ON 6
ci_008                 3.174781e-02 3 1  ON 7
ci_009                -2.519957e-02 3 1  ON 8
ci_010                -2.489428e-02 3 1  ON 9
ci_011                -2.143616e-02 3 1  ON 10
ci_012                -2.268531e-02 3 1  ON 11
ci_013                 1.967158e-02 3 1  ON 12
ci_014                 2.019304e-02 3 1  ON 13
ci_015                 1.990762e-02 3 1  ON 14
ci_016                 2.165878e-02 3 1  ON 15
ci_017                 1.478820e-02 3 1  ON 16
ci_018                 1.565229e-02 3 1  ON 17
ci_019                 1.156658e-02 3 1  ON 18
ci_020                 1.020717e-02 3 1  ON 19
ci_021                -1.112819e-02 3 1  ON 20
ci_022                -1.006246e-02 3 1  ON 21
ci_023                 8.818932e-03 3 1  ON 22
ci_024                 9.176540e-03 3 1  ON 23
ci_025                 5.994833e-03 3 1  ON 24
ci_026                 8.863919e-03 3 1  ON 25
ci_027                 8.148851e-03 3 1  ON 26
ci_028                 7.494629e-03 3 1  ON 27
ci_029                -7.257643e-03 3 1  ON 28
ci_030                -7.177070e-03 3 1  ON 29
ci_031                -7.758380e-03 3 1  ON 30
ci_032                -7.330839e-03 3 1  ON 31
ci_033                 7.254368e-03 3 1  ON 32
ci_034                 6.050583e-03 3 1  ON 33
ci_035                 6.206490e-03 3 1  ON 34
ci_036                 6.385700e-03 3 1  ON 35
ci_037                 5.778732e-03 3 1  ON 36
ci_038                 6.625094e-03 3 1  ON 37
ci_039                 5.105937e-03 3 1  ON 38
ci_040                 5.268103e-03 3 1  ON 39
ci_041                 3.958736e-03 3 1  ON 40
ci_042                 6.024937e-03 3 1  ON 41
ci_043                 4.625769e-03 3 1  ON 42
ci_044                 4.061591e-03 3 1  ON 43
ci_045                 3.535641e-03 3 1  ON 44
ci_046                 5.261902e-03 3 1  ON 45
ci_047                -4.848107e-03 3 1  ON 46
ci_048                -4.147907e-03 3 1  ON 47
ci_049                 3.349760e-03 3 1  ON 48
ci_050                 2.679546e-03 3 1  ON 49
ci_051                -3.423752e-03 3 1  ON 50
ci_052                -3.081849e-03 3 1  ON 51
ci_053                -2.561647e-03 3 1  ON 52
ci_054                -2.948412e-03 3 1  ON 53
ci_055                -1.797211e-03 3 1  ON 54
ci_056                -3.311927e-03 3 1  ON 55
ci_057                -1.363154e-03 3 1  ON 56
ci_058                -3.599589e-03 3 1  ON 57
ci_059                -1.545586e-03 3 1  ON 58
ci_060                -1.917582e-03 3 1  ON 59
ci_061                -7.813337e-04 3 1  ON 60
ci_062                -2.391320e-03 3 1  ON 61
ci_063                -1.401872e-03 3 1  ON 62
ci_064                -2.439058e-03 3 1  ON 63
ci_065                -1.527286e-03 3 1  ON 64
ci_066                -1.444722e-03 3 1  ON 65
ci_067                -1.355762e-03 3 1  ON 66
ci_068                -9.745601e-04 3 1  ON 67
ci_069                 4.561576e-04 3 1  ON 68
ci_070                 5.597800e-04 3 1  ON 69
ci_071                -1.980940e-04 3 1  ON 70
ci_072                -2.967173e-04 3 1  ON 71
ci_073                 1.363030e-03 3 1  ON 72
ci_074                 9.974552e-04 3 1  ON 73
ci_075                -7.613902e-04 3 1  ON 74
ci_076                -3.471743e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7091e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2326e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.2307
    reference variance = 5.79359
====================================================
  Execution time = 2.4643e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0272e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7686e+00
  Total weights = 1.949759503e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0538e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.822221935879
                                         uncertainty =       0.049409869222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.822221935879
                                         uncertainty =       0.049409869222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382483231
  error estimate for blocks of size 2^( 2) =       0.001452385173
  error estimate for blocks of size 2^( 3) =       0.001516558763
  error estimate for blocks of size 2^( 4) =       0.001559264460
  error estimate for blocks of size 2^( 5) =       0.001581633080
  error estimate for blocks of size 2^( 6) =       0.001593990340
  error estimate for blocks of size 2^( 7) =       0.001601779866

      target function =                  N/A
              le_mean =     -22.329830708943
             les_mean =     502.389910428046
             stat err =       0.001584166937
             autocorr =       1.313052663921
              std dev =       1.955157817231
             le_variance =       3.822642090279


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232983070894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329830708166       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329891735313       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329893747720       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329893876546       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329893924794       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 1.189044e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329830708166       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329857366057       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329857542432       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329857540923       residual = 3.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 4.529998e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329830708166       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329838903704       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329838926596       residual = 7.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+00 is 1.361606e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0704e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -6.944071e-01 3 1  ON 0
ci_002                -7.062172e-01 3 1  ON 1
ci_003                -6.199791e-02 3 1  ON 2
ci_004                -6.077898e-02 3 1  ON 3
ci_005                 4.551467e-02 3 1  ON 4
ci_006                 4.688459e-02 3 1  ON 5
ci_007                 3.192715e-02 3 1  ON 6
ci_008                 3.205816e-02 3 1  ON 7
ci_009                -2.507772e-02 3 1  ON 8
ci_010                -2.516374e-02 3 1  ON 9
ci_011                -2.147955e-02 3 1  ON 10
ci_012                -2.278956e-02 3 1  ON 11
ci_013                 1.961874e-02 3 1  ON 12
ci_014                 2.037153e-02 3 1  ON 13
ci_015                 1.983626e-02 3 1  ON 14
ci_016                 2.165770e-02 3 1  ON 15
ci_017                 1.481316e-02 3 1  ON 16
ci_018                 1.576311e-02 3 1  ON 17
ci_019                 1.129131e-02 3 1  ON 18
ci_020                 1.022598e-02 3 1  ON 19
ci_021                -1.093274e-02 3 1  ON 20
ci_022                -1.023897e-02 3 1  ON 21
ci_023                 8.834270e-03 3 1  ON 22
ci_024                 9.006830e-03 3 1  ON 23
ci_025                 6.136017e-03 3 1  ON 24
ci_026                 8.644659e-03 3 1  ON 25
ci_027                 8.252939e-03 3 1  ON 26
ci_028                 7.454800e-03 3 1  ON 27
ci_029                -7.205692e-03 3 1  ON 28
ci_030                -7.401102e-03 3 1  ON 29
ci_031                -7.835901e-03 3 1  ON 30
ci_032                -7.315377e-03 3 1  ON 31
ci_033                 6.920710e-03 3 1  ON 32
ci_034                 6.257229e-03 3 1  ON 33
ci_035                 6.449363e-03 3 1  ON 34
ci_036                 6.409407e-03 3 1  ON 35
ci_037                 5.760539e-03 3 1  ON 36
ci_038                 6.513669e-03 3 1  ON 37
ci_039                 5.346017e-03 3 1  ON 38
ci_040                 5.281204e-03 3 1  ON 39
ci_041                 4.351401e-03 3 1  ON 40
ci_042                 5.831296e-03 3 1  ON 41
ci_043                 4.502268e-03 3 1  ON 42
ci_044                 4.278427e-03 3 1  ON 43
ci_045                 3.771975e-03 3 1  ON 44
ci_046                 5.547796e-03 3 1  ON 45
ci_047                -4.614455e-03 3 1  ON 46
ci_048                -4.072320e-03 3 1  ON 47
ci_049                 3.450361e-03 3 1  ON 48
ci_050                 2.779158e-03 3 1  ON 49
ci_051                -3.408049e-03 3 1  ON 50
ci_052                -3.077229e-03 3 1  ON 51
ci_053                -3.014647e-03 3 1  ON 52
ci_054                -2.898296e-03 3 1  ON 53
ci_055                -1.867133e-03 3 1  ON 54
ci_056                -3.126662e-03 3 1  ON 55
ci_057                -1.651452e-03 3 1  ON 56
ci_058                -3.152094e-03 3 1  ON 57
ci_059                -1.750471e-03 3 1  ON 58
ci_060                -1.564969e-03 3 1  ON 59
ci_061                -1.034929e-03 3 1  ON 60
ci_062                -2.051386e-03 3 1  ON 61
ci_063                -1.283356e-03 3 1  ON 62
ci_064                -2.257172e-03 3 1  ON 63
ci_065                -1.618182e-03 3 1  ON 64
ci_066                -1.014532e-03 3 1  ON 65
ci_067                -1.159249e-03 3 1  ON 66
ci_068                -8.300177e-04 3 1  ON 67
ci_069                 6.845431e-04 3 1  ON 68
ci_070                 7.608763e-04 3 1  ON 69
ci_071                -3.714571e-04 3 1  ON 70
ci_072                -1.313541e-04 3 1  ON 71
ci_073                 1.008446e-03 3 1  ON 72
ci_074                 1.100783e-03 3 1  ON 73
ci_075                -7.040081e-04 3 1  ON 74
ci_076                -1.181379e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.3264
    reference variance = 2.85971
====================================================
  Execution time = 2.3879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7472e+00
  Total weights = 1.9496e+06
  Execution time = 4.4859e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800057869560
                                         uncertainty =       0.063208346438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800057869560
                                         uncertainty =       0.063208346438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378227627
  error estimate for blocks of size 2^( 2) =       0.001448549632
  error estimate for blocks of size 2^( 3) =       0.001512304280
  error estimate for blocks of size 2^( 4) =       0.001557066629
  error estimate for blocks of size 2^( 5) =       0.001583435386
  error estimate for blocks of size 2^( 6) =       0.001596688089
  error estimate for blocks of size 2^( 7) =       0.001608548219

      target function =                  N/A
              le_mean =     -22.328638599681
             les_mean =     502.334066931996
             stat err =       0.001586434581
             autocorr =       1.324958982116
              std dev =       1.949139387015
             le_variance =       3.799144350013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800121409714
                                         uncertainty =       0.063201536635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800121409714
                                         uncertainty =       0.063201536635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378240480
  error estimate for blocks of size 2^( 2) =       0.001448551038
  error estimate for blocks of size 2^( 3) =       0.001512292816
  error estimate for blocks of size 2^( 4) =       0.001557043888
  error estimate for blocks of size 2^( 5) =       0.001583425277
  error estimate for blocks of size 2^( 6) =       0.001596642978
  error estimate for blocks of size 2^( 7) =       0.001608544205

      target function =                  N/A
              le_mean =     -22.328655315967
             les_mean =     502.327406021446
             stat err =       0.001586414087
             autocorr =       1.324900038538
              std dev =       1.949157564680
             le_variance =       3.799215211950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.802254753313
                                         uncertainty =       0.063138510512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.802254753313
                                         uncertainty =       0.063138510512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378626513
  error estimate for blocks of size 2^( 2) =       0.001448916822
  error estimate for blocks of size 2^( 3) =       0.001512613721
  error estimate for blocks of size 2^( 4) =       0.001557311044
  error estimate for blocks of size 2^( 5) =       0.001583667346
  error estimate for blocks of size 2^( 6) =       0.001596851828
  error estimate for blocks of size 2^( 7) =       0.001608790560

      target function =                  N/A
              le_mean =     -22.328614994427
             les_mean =     508.542030118283
             stat err =       0.001586655195
             autocorr =       1.324560692642
              std dev =       1.949703507167
             le_variance =       3.801343765858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800038409201
                                         uncertainty =       0.063207775939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800038409201
                                         uncertainty =       0.063207775939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378224255
  error estimate for blocks of size 2^( 2) =       0.001448545004
  error estimate for blocks of size 2^( 3) =       0.001512297721
  error estimate for blocks of size 2^( 4) =       0.001557058704
  error estimate for blocks of size 2^( 5) =       0.001583428132
  error estimate for blocks of size 2^( 6) =       0.001596679053
  error estimate for blocks of size 2^( 7) =       0.001608547159

      target function =                  N/A
              le_mean =     -22.328636341840
             les_mean =     502.316530270558
             stat err =       0.001586428262
             autocorr =       1.324954910763
              std dev =       1.949134618737
             le_variance =       3.799125761961


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328638599681        initial
     1.5259e-01     1.5259e+00             1.1890e-03       -22.328655315967  <--
     6.1035e-01     6.1035e+00             4.5300e-04       -22.328614994427
     2.4414e+00     2.4414e+01             1.3616e-04       -22.328636341840

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 4.6371e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -6.944699e-01 3 1  ON 0
ci_002                -7.062527e-01 3 1  ON 1
ci_003                -6.118697e-02 3 1  ON 2
ci_004                -6.049641e-02 3 1  ON 3
ci_005                 4.550926e-02 3 1  ON 4
ci_006                 4.657883e-02 3 1  ON 5
ci_007                 3.174394e-02 3 1  ON 6
ci_008                 3.248263e-02 3 1  ON 7
ci_009                -2.491284e-02 3 1  ON 8
ci_010                -2.552420e-02 3 1  ON 9
ci_011                -2.153665e-02 3 1  ON 10
ci_012                -2.294104e-02 3 1  ON 11
ci_013                 1.958641e-02 3 1  ON 12
ci_014                 2.062802e-02 3 1  ON 13
ci_015                 1.971353e-02 3 1  ON 14
ci_016                 2.164224e-02 3 1  ON 15
ci_017                 1.485154e-02 3 1  ON 16
ci_018                 1.592187e-02 3 1  ON 17
ci_019                 1.079458e-02 3 1  ON 18
ci_020                 1.028658e-02 3 1  ON 19
ci_021                -1.055099e-02 3 1  ON 20
ci_022                -1.054277e-02 3 1  ON 21
ci_023                 8.840582e-03 3 1  ON 22
ci_024                 8.794392e-03 3 1  ON 23
ci_025                 6.386359e-03 3 1  ON 24
ci_026                 8.287124e-03 3 1  ON 25
ci_027                 8.341412e-03 3 1  ON 26
ci_028                 7.430685e-03 3 1  ON 27
ci_029                -7.116250e-03 3 1  ON 28
ci_030                -7.788591e-03 3 1  ON 29
ci_031                -7.975813e-03 3 1  ON 30
ci_032                -7.253749e-03 3 1  ON 31
ci_033                 6.381741e-03 3 1  ON 32
ci_034                 6.529723e-03 3 1  ON 33
ci_035                 6.664457e-03 3 1  ON 34
ci_036                 6.440821e-03 3 1  ON 35
ci_037                 5.732017e-03 3 1  ON 36
ci_038                 6.371691e-03 3 1  ON 37
ci_039                 5.583980e-03 3 1  ON 38
ci_040                 5.301828e-03 3 1  ON 39
ci_041                 4.827111e-03 3 1  ON 40
ci_042                 5.592467e-03 3 1  ON 41
ci_043                 4.302503e-03 3 1  ON 42
ci_044                 4.590043e-03 3 1  ON 43
ci_045                 4.168497e-03 3 1  ON 44
ci_046                 5.925558e-03 3 1  ON 45
ci_047                -4.360979e-03 3 1  ON 46
ci_048                -4.013959e-03 3 1  ON 47
ci_049                 3.599709e-03 3 1  ON 48
ci_050                 2.920235e-03 3 1  ON 49
ci_051                -3.364512e-03 3 1  ON 50
ci_052                -3.115981e-03 3 1  ON 51
ci_053                -3.670311e-03 3 1  ON 52
ci_054                -2.824998e-03 3 1  ON 53
ci_055                -2.031286e-03 3 1  ON 54
ci_056                -2.812707e-03 3 1  ON 55
ci_057                -2.056151e-03 3 1  ON 56
ci_058                -2.554681e-03 3 1  ON 57
ci_059                -1.948175e-03 3 1  ON 58
ci_060                -1.193571e-03 3 1  ON 59
ci_061                -1.401505e-03 3 1  ON 60
ci_062                -1.597525e-03 3 1  ON 61
ci_063                -1.107357e-03 3 1  ON 62
ci_064                -1.967156e-03 3 1  ON 63
ci_065                -1.754964e-03 3 1  ON 64
ci_066                -4.277276e-04 3 1  ON 65
ci_067                -8.467696e-04 3 1  ON 66
ci_068                -6.256129e-04 3 1  ON 67
ci_069                 1.022150e-03 3 1  ON 68
ci_070                 1.038964e-03 3 1  ON 69
ci_071                -5.941654e-04 3 1  ON 70
ci_072                 6.362563e-05 3 1  ON 71
ci_073                 6.754745e-04 3 1  ON 72
ci_074                 1.212537e-03 3 1  ON 73
ci_075                -6.517405e-04 3 1  ON 74
ci_076                 1.476465e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7081e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2323e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4307
    reference variance = 2.51598
====================================================
  Execution time = 2.4500e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0316e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7874e+00
  Total weights = 1.950227643e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0077e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.835505701054
                                         uncertainty =       0.051951566923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.835505701054
                                         uncertainty =       0.051951566923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384950025
  error estimate for blocks of size 2^( 2) =       0.001454699174
  error estimate for blocks of size 2^( 3) =       0.001517969663
  error estimate for blocks of size 2^( 4) =       0.001560937782
  error estimate for blocks of size 2^( 5) =       0.001584783286
  error estimate for blocks of size 2^( 6) =       0.001596186978
  error estimate for blocks of size 2^( 7) =       0.001601160807

      target function =                  N/A
              le_mean =     -22.327868220156
             les_mean =     502.321131014587
             stat err =       0.001585767213
             autocorr =       1.311024064660
              std dev =       1.958646446193
             le_variance =       3.836295901185


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232786822016e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327868219342       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327977673226       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327998060045       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327999670804       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328001092751       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328001829019       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328001767690       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.328001193662       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.328001208844       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-02 is 4.140685e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327868219342       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327939511634       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327946418179       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327946045518       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327946111392       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327946115000       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 2.284712e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327868219342       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327897990843       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327899026534       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327898945040       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 8.890171e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0515e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -6.935704e-01 3 1  ON 0
ci_002                -7.073062e-01 3 1  ON 1
ci_003                -5.953708e-02 3 1  ON 2
ci_004                -5.976225e-02 3 1  ON 3
ci_005                 4.558246e-02 3 1  ON 4
ci_006                 4.667077e-02 3 1  ON 5
ci_007                 3.178681e-02 3 1  ON 6
ci_008                 3.227308e-02 3 1  ON 7
ci_009                -2.450311e-02 3 1  ON 8
ci_010                -2.472397e-02 3 1  ON 9
ci_011                -2.167899e-02 3 1  ON 10
ci_012                -2.304305e-02 3 1  ON 11
ci_013                 2.048909e-02 3 1  ON 12
ci_014                 2.069223e-02 3 1  ON 13
ci_015                 1.988378e-02 3 1  ON 14
ci_016                 2.206740e-02 3 1  ON 15
ci_017                 1.543174e-02 3 1  ON 16
ci_018                 1.591064e-02 3 1  ON 17
ci_019                 1.039319e-02 3 1  ON 18
ci_020                 1.041789e-02 3 1  ON 19
ci_021                -9.932989e-03 3 1  ON 20
ci_022                -1.143949e-02 3 1  ON 21
ci_023                 9.103632e-03 3 1  ON 22
ci_024                 8.794407e-03 3 1  ON 23
ci_025                 8.671071e-03 3 1  ON 24
ci_026                 8.336891e-03 3 1  ON 25
ci_027                 7.348903e-03 3 1  ON 26
ci_028                 7.479625e-03 3 1  ON 27
ci_029                -7.430330e-03 3 1  ON 28
ci_030                -7.928019e-03 3 1  ON 29
ci_031                -7.795154e-03 3 1  ON 30
ci_032                -6.038058e-03 3 1  ON 31
ci_033                 5.772408e-03 3 1  ON 32
ci_034                 7.039071e-03 3 1  ON 33
ci_035                 6.797015e-03 3 1  ON 34
ci_036                 6.672639e-03 3 1  ON 35
ci_037                 6.083375e-03 3 1  ON 36
ci_038                 6.290239e-03 3 1  ON 37
ci_039                 5.354825e-03 3 1  ON 38
ci_040                 5.553213e-03 3 1  ON 39
ci_041                 5.776552e-03 3 1  ON 40
ci_042                 5.590060e-03 3 1  ON 41
ci_043                 3.874546e-03 3 1  ON 42
ci_044                 5.699127e-03 3 1  ON 43
ci_045                 4.761965e-03 3 1  ON 44
ci_046                 5.151801e-03 3 1  ON 45
ci_047                -4.633985e-03 3 1  ON 46
ci_048                -4.046538e-03 3 1  ON 47
ci_049                 3.921580e-03 3 1  ON 48
ci_050                 3.518429e-03 3 1  ON 49
ci_051                -2.365588e-03 3 1  ON 50
ci_052                -2.810658e-03 3 1  ON 51
ci_053                -2.876537e-03 3 1  ON 52
ci_054                -3.083573e-03 3 1  ON 53
ci_055                -3.452799e-03 3 1  ON 54
ci_056                -2.936371e-03 3 1  ON 55
ci_057                -2.196266e-03 3 1  ON 56
ci_058                -1.764909e-03 3 1  ON 57
ci_059                -1.406937e-03 3 1  ON 58
ci_060                -1.496969e-03 3 1  ON 59
ci_061                -1.958075e-03 3 1  ON 60
ci_062                -6.372168e-04 3 1  ON 61
ci_063                -1.482906e-03 3 1  ON 62
ci_064                -1.455831e-03 3 1  ON 63
ci_065                -1.626355e-03 3 1  ON 64
ci_066                -3.026284e-04 3 1  ON 65
ci_067                -8.821244e-04 3 1  ON 66
ci_068                -8.732891e-04 3 1  ON 67
ci_069                 6.136464e-04 3 1  ON 68
ci_070                 1.998695e-03 3 1  ON 69
ci_071                -1.033280e-03 3 1  ON 70
ci_072                -7.295428e-04 3 1  ON 71
ci_073                 5.736349e-04 3 1  ON 72
ci_074                 9.046489e-04 3 1  ON 73
ci_075                -9.686622e-04 3 1  ON 74
ci_076                -6.972178e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.4315
    reference variance = 2.99943
====================================================
  Execution time = 2.3900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7439e+00
  Total weights = 1.9499e+06
  Execution time = 4.4998e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796865421771
                                         uncertainty =       0.039395551213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796865421771
                                         uncertainty =       0.039395551213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377767529
  error estimate for blocks of size 2^( 2) =       0.001448998304
  error estimate for blocks of size 2^( 3) =       0.001512927468
  error estimate for blocks of size 2^( 4) =       0.001556048415
  error estimate for blocks of size 2^( 5) =       0.001580889498
  error estimate for blocks of size 2^( 6) =       0.001592528460
  error estimate for blocks of size 2^( 7) =       0.001599289956

      target function =                  N/A
              le_mean =     -22.330399561788
             les_mean =     502.563346197026
             stat err =       0.001582189082
             autocorr =       1.318757300002
              std dev =       1.948488699812
             le_variance =       3.796608213293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797152129897
                                         uncertainty =       0.039495644279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797152129897
                                         uncertainty =       0.039495644279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377819168
  error estimate for blocks of size 2^( 2) =       0.001449063143
  error estimate for blocks of size 2^( 3) =       0.001512983985
  error estimate for blocks of size 2^( 4) =       0.001556080581
  error estimate for blocks of size 2^( 5) =       0.001580970202
  error estimate for blocks of size 2^( 6) =       0.001592499607
  error estimate for blocks of size 2^( 7) =       0.001599176942

      target function =                  N/A
              le_mean =     -22.330388645290
             les_mean =     502.607056118383
             stat err =       0.001582181833
             autocorr =       1.318646366080
              std dev =       1.948561730551
             le_variance =       3.796892817769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797034241870
                                         uncertainty =       0.039389921646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797034241870
                                         uncertainty =       0.039389921646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377797558
  error estimate for blocks of size 2^( 2) =       0.001449033699
  error estimate for blocks of size 2^( 3) =       0.001512934050
  error estimate for blocks of size 2^( 4) =       0.001556020718
  error estimate for blocks of size 2^( 5) =       0.001580907872
  error estimate for blocks of size 2^( 6) =       0.001592525934
  error estimate for blocks of size 2^( 7) =       0.001599296564

      target function =                  N/A
              le_mean =     -22.330431847819
             les_mean =     502.408456507055
             stat err =       0.001582187772
             autocorr =       1.318697631187
              std dev =       1.948531168648
             le_variance =       3.796773715191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796692538670
                                         uncertainty =       0.039396896622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796692538670
                                         uncertainty =       0.039396896622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377736071
  error estimate for blocks of size 2^( 2) =       0.001448971267
  error estimate for blocks of size 2^( 3) =       0.001512895321
  error estimate for blocks of size 2^( 4) =       0.001556013433
  error estimate for blocks of size 2^( 5) =       0.001580851959
  error estimate for blocks of size 2^( 6) =       0.001592464827
  error estimate for blocks of size 2^( 7) =       0.001599252146

      target function =                  N/A
              le_mean =     -22.330380565321
             les_mean =     502.391043678640
             stat err =       0.001582145591
             autocorr =       1.318745020859
              std dev =       1.948444211177
             le_variance =       3.796434844069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330399561788        initial
     3.8147e-02     3.8147e-01             4.1407e-03       -22.330388645290
     1.5259e-01     1.5259e+00             2.2847e-03       -22.330431847819  <--
     6.1035e-01     6.1035e+00             8.8902e-04       -22.330380565321

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 4.6547e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -6.935704e-01 3 1  ON 0
ci_002                -7.073062e-01 3 1  ON 1
ci_003                -5.953708e-02 3 1  ON 2
ci_004                -5.976225e-02 3 1  ON 3
ci_005                 4.558246e-02 3 1  ON 4
ci_006                 4.667077e-02 3 1  ON 5
ci_007                 3.178681e-02 3 1  ON 6
ci_008                 3.227308e-02 3 1  ON 7
ci_009                -2.450311e-02 3 1  ON 8
ci_010                -2.472397e-02 3 1  ON 9
ci_011                -2.167899e-02 3 1  ON 10
ci_012                -2.304305e-02 3 1  ON 11
ci_013                 2.048909e-02 3 1  ON 12
ci_014                 2.069223e-02 3 1  ON 13
ci_015                 1.988378e-02 3 1  ON 14
ci_016                 2.206740e-02 3 1  ON 15
ci_017                 1.543174e-02 3 1  ON 16
ci_018                 1.591064e-02 3 1  ON 17
ci_019                 1.039319e-02 3 1  ON 18
ci_020                 1.041789e-02 3 1  ON 19
ci_021                -9.932989e-03 3 1  ON 20
ci_022                -1.143949e-02 3 1  ON 21
ci_023                 9.103632e-03 3 1  ON 22
ci_024                 8.794407e-03 3 1  ON 23
ci_025                 8.671071e-03 3 1  ON 24
ci_026                 8.336891e-03 3 1  ON 25
ci_027                 7.348903e-03 3 1  ON 26
ci_028                 7.479625e-03 3 1  ON 27
ci_029                -7.430330e-03 3 1  ON 28
ci_030                -7.928019e-03 3 1  ON 29
ci_031                -7.795154e-03 3 1  ON 30
ci_032                -6.038058e-03 3 1  ON 31
ci_033                 5.772408e-03 3 1  ON 32
ci_034                 7.039071e-03 3 1  ON 33
ci_035                 6.797015e-03 3 1  ON 34
ci_036                 6.672639e-03 3 1  ON 35
ci_037                 6.083375e-03 3 1  ON 36
ci_038                 6.290239e-03 3 1  ON 37
ci_039                 5.354825e-03 3 1  ON 38
ci_040                 5.553213e-03 3 1  ON 39
ci_041                 5.776552e-03 3 1  ON 40
ci_042                 5.590060e-03 3 1  ON 41
ci_043                 3.874546e-03 3 1  ON 42
ci_044                 5.699127e-03 3 1  ON 43
ci_045                 4.761965e-03 3 1  ON 44
ci_046                 5.151801e-03 3 1  ON 45
ci_047                -4.633985e-03 3 1  ON 46
ci_048                -4.046538e-03 3 1  ON 47
ci_049                 3.921580e-03 3 1  ON 48
ci_050                 3.518429e-03 3 1  ON 49
ci_051                -2.365588e-03 3 1  ON 50
ci_052                -2.810658e-03 3 1  ON 51
ci_053                -2.876537e-03 3 1  ON 52
ci_054                -3.083573e-03 3 1  ON 53
ci_055                -3.452799e-03 3 1  ON 54
ci_056                -2.936371e-03 3 1  ON 55
ci_057                -2.196266e-03 3 1  ON 56
ci_058                -1.764909e-03 3 1  ON 57
ci_059                -1.406937e-03 3 1  ON 58
ci_060                -1.496969e-03 3 1  ON 59
ci_061                -1.958075e-03 3 1  ON 60
ci_062                -6.372168e-04 3 1  ON 61
ci_063                -1.482906e-03 3 1  ON 62
ci_064                -1.455831e-03 3 1  ON 63
ci_065                -1.626355e-03 3 1  ON 64
ci_066                -3.026284e-04 3 1  ON 65
ci_067                -8.821244e-04 3 1  ON 66
ci_068                -8.732891e-04 3 1  ON 67
ci_069                 6.136464e-04 3 1  ON 68
ci_070                 1.998695e-03 3 1  ON 69
ci_071                -1.033280e-03 3 1  ON 70
ci_072                -7.295428e-04 3 1  ON 71
ci_073                 5.736349e-04 3 1  ON 72
ci_074                 9.046489e-04 3 1  ON 73
ci_075                -9.686622e-04 3 1  ON 74
ci_076                -6.972178e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7069e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2329e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.3867
    reference variance = 3.05466
====================================================
  Execution time = 2.4555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0341e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6919e+00
  Total weights = 1.949816277e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0982e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742509548373
                                         uncertainty =       0.028996785050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742509548373
                                         uncertainty =       0.028996785050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367949844
  error estimate for blocks of size 2^( 2) =       0.001439606927
  error estimate for blocks of size 2^( 3) =       0.001501857742
  error estimate for blocks of size 2^( 4) =       0.001544796282
  error estimate for blocks of size 2^( 5) =       0.001569047195
  error estimate for blocks of size 2^( 6) =       0.001578686888
  error estimate for blocks of size 2^( 7) =       0.001588681371

      target function =                  N/A
              le_mean =     -22.328057237160
             les_mean =     502.233999784368
             stat err =       0.001570302934
             autocorr =       1.317730311257
              std dev =       1.934604174668
             le_variance =       3.742693312641


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232805723716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328057236320       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328146415653       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328168783764       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328171480081       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328171927756       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328171019099       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328171903881       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.328171851011       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.328171862853       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-02 is 3.434613e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328057236320       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328117860102       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328131633982       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328131812306       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328131844710       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328131754892       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e-01 is 2.292567e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328057236320       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328083815957       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328089793681       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328089692478       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e-01 is 9.888992e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065858 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0661e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -6.939563e-01 3 1  ON 0
ci_002                -7.067884e-01 3 1  ON 1
ci_003                -6.079383e-02 3 1  ON 2
ci_004                -6.104162e-02 3 1  ON 3
ci_005                 4.632408e-02 3 1  ON 4
ci_006                 4.647547e-02 3 1  ON 5
ci_007                 3.127993e-02 3 1  ON 6
ci_008                 3.136898e-02 3 1  ON 7
ci_009                -2.478256e-02 3 1  ON 8
ci_010                -2.533046e-02 3 1  ON 9
ci_011                -2.141389e-02 3 1  ON 10
ci_012                -2.295097e-02 3 1  ON 11
ci_013                 2.007492e-02 3 1  ON 12
ci_014                 2.140398e-02 3 1  ON 13
ci_015                 2.019712e-02 3 1  ON 14
ci_016                 2.064701e-02 3 1  ON 15
ci_017                 1.511982e-02 3 1  ON 16
ci_018                 1.554424e-02 3 1  ON 17
ci_019                 1.011763e-02 3 1  ON 18
ci_020                 1.128521e-02 3 1  ON 19
ci_021                -1.093291e-02 3 1  ON 20
ci_022                -1.142728e-02 3 1  ON 21
ci_023                 6.811065e-03 3 1  ON 22
ci_024                 9.081644e-03 3 1  ON 23
ci_025                 7.970016e-03 3 1  ON 24
ci_026                 7.566642e-03 3 1  ON 25
ci_027                 5.334810e-03 3 1  ON 26
ci_028                 8.426180e-03 3 1  ON 27
ci_029                -6.049056e-03 3 1  ON 28
ci_030                -7.927943e-03 3 1  ON 29
ci_031                -6.964202e-03 3 1  ON 30
ci_032                -6.536067e-03 3 1  ON 31
ci_033                 7.269978e-03 3 1  ON 32
ci_034                 8.040531e-03 3 1  ON 33
ci_035                 6.695396e-03 3 1  ON 34
ci_036                 6.625470e-03 3 1  ON 35
ci_037                 6.255475e-03 3 1  ON 36
ci_038                 7.117513e-03 3 1  ON 37
ci_039                 4.550088e-03 3 1  ON 38
ci_040                 5.080344e-03 3 1  ON 39
ci_041                 5.054897e-03 3 1  ON 40
ci_042                 5.271970e-03 3 1  ON 41
ci_043                 4.465593e-03 3 1  ON 42
ci_044                 5.777527e-03 3 1  ON 43
ci_045                 5.355452e-03 3 1  ON 44
ci_046                 5.315371e-03 3 1  ON 45
ci_047                -3.544576e-03 3 1  ON 46
ci_048                -3.956928e-03 3 1  ON 47
ci_049                 4.652510e-03 3 1  ON 48
ci_050                 4.144574e-03 3 1  ON 49
ci_051                -3.395870e-03 3 1  ON 50
ci_052                -2.179886e-03 3 1  ON 51
ci_053                -3.952619e-03 3 1  ON 52
ci_054                -2.555027e-03 3 1  ON 53
ci_055                -3.953304e-03 3 1  ON 54
ci_056                -3.620964e-03 3 1  ON 55
ci_057                -2.656497e-03 3 1  ON 56
ci_058                -1.590292e-03 3 1  ON 57
ci_059                -6.588013e-04 3 1  ON 58
ci_060                -2.085547e-03 3 1  ON 59
ci_061                -1.836288e-03 3 1  ON 60
ci_062                -1.291230e-03 3 1  ON 61
ci_063                -1.925793e-03 3 1  ON 62
ci_064                 7.806969e-05 3 1  ON 63
ci_065                -5.919328e-04 3 1  ON 64
ci_066                -1.135501e-03 3 1  ON 65
ci_067                -1.031991e-03 3 1  ON 66
ci_068                -3.468034e-04 3 1  ON 67
ci_069                 5.458183e-04 3 1  ON 68
ci_070                 2.053495e-03 3 1  ON 69
ci_071                -2.175024e-03 3 1  ON 70
ci_072                -9.699602e-05 3 1  ON 71
ci_073                 1.599348e-04 3 1  ON 72
ci_074                 1.398225e-03 3 1  ON 73
ci_075                -2.379534e-03 3 1  ON 74
ci_076                -7.425934e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.3002
    reference variance = 5.89793
====================================================
  Execution time = 2.3816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2323e+01
  VMC Evar = 3.7181e+00
  Total weights = 1.9495e+06
  Execution time = 4.4857e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774349512916
                                         uncertainty =       0.039863929740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774349512916
                                         uncertainty =       0.039863929740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373674987
  error estimate for blocks of size 2^( 2) =       0.001445498104
  error estimate for blocks of size 2^( 3) =       0.001509284598
  error estimate for blocks of size 2^( 4) =       0.001552111339
  error estimate for blocks of size 2^( 5) =       0.001574147989
  error estimate for blocks of size 2^( 6) =       0.001590215208
  error estimate for blocks of size 2^( 7) =       0.001594819379

      target function =                  N/A
              le_mean =     -22.323463417151
             les_mean =     502.092136188856
             stat err =       0.001577823479
             autocorr =       1.319316056063
              std dev =       1.942700879355
             le_variance =       3.774086706647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772337516433
                                         uncertainty =       0.039835703258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772337516433
                                         uncertainty =       0.039835703258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373309223
  error estimate for blocks of size 2^( 2) =       0.001445160727
  error estimate for blocks of size 2^( 3) =       0.001508969274
  error estimate for blocks of size 2^( 4) =       0.001551864580
  error estimate for blocks of size 2^( 5) =       0.001573826071
  error estimate for blocks of size 2^( 6) =       0.001589947970
  error estimate for blocks of size 2^( 7) =       0.001594515444

      target function =                  N/A
              le_mean =     -22.323402243274
             les_mean =     502.054441493845
             stat err =       0.001577538517
             autocorr =       1.319542156752
              std dev =       1.942183602947
             le_variance =       3.772077147556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772777576802
                                         uncertainty =       0.039834308697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772777576802
                                         uncertainty =       0.039834308697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373388947
  error estimate for blocks of size 2^( 2) =       0.001445239406
  error estimate for blocks of size 2^( 3) =       0.001509049867
  error estimate for blocks of size 2^( 4) =       0.001551948153
  error estimate for blocks of size 2^( 5) =       0.001573901318
  error estimate for blocks of size 2^( 6) =       0.001590041145
  error estimate for blocks of size 2^( 7) =       0.001594570519

      target function =                  N/A
              le_mean =     -22.323444760594
             les_mean =     502.064579215907
             stat err =       0.001577615284
             autocorr =       1.319517378523
              std dev =       1.942296350912
             le_variance =       3.772515114766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772979781754
                                         uncertainty =       0.039832360807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772979781754
                                         uncertainty =       0.039832360807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373425888
  error estimate for blocks of size 2^( 2) =       0.001445259924
  error estimate for blocks of size 2^( 3) =       0.001509073687
  error estimate for blocks of size 2^( 4) =       0.001551944122
  error estimate for blocks of size 2^( 5) =       0.001573926924
  error estimate for blocks of size 2^( 6) =       0.001590037791
  error estimate for blocks of size 2^( 7) =       0.001594665964

      target function =                  N/A
              le_mean =     -22.323404333697
             les_mean =     502.094788607944
             stat err =       0.001577643700
             autocorr =       1.319493930276
              std dev =       1.942348594235
             le_variance =       3.772718061526


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.323463417151        initial  <--
     3.8147e-02     3.8147e-01             3.4346e-03       -22.323402243274
     1.5259e-01     1.5259e+00             2.2926e-03       -22.323444760594
     6.1035e-01     6.1035e+00             9.8890e-04       -22.323404333697

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.4438
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -6.935704e-01 3 1  ON 0
ci_002                -7.073062e-01 3 1  ON 1
ci_003                -5.953708e-02 3 1  ON 2
ci_004                -5.976225e-02 3 1  ON 3
ci_005                 4.558246e-02 3 1  ON 4
ci_006                 4.667077e-02 3 1  ON 5
ci_007                 3.178681e-02 3 1  ON 6
ci_008                 3.227308e-02 3 1  ON 7
ci_009                -2.450311e-02 3 1  ON 8
ci_010                -2.472397e-02 3 1  ON 9
ci_011                -2.167899e-02 3 1  ON 10
ci_012                -2.304305e-02 3 1  ON 11
ci_013                 2.048909e-02 3 1  ON 12
ci_014                 2.069223e-02 3 1  ON 13
ci_015                 1.988378e-02 3 1  ON 14
ci_016                 2.206740e-02 3 1  ON 15
ci_017                 1.543174e-02 3 1  ON 16
ci_018                 1.591064e-02 3 1  ON 17
ci_019                 1.039319e-02 3 1  ON 18
ci_020                 1.041789e-02 3 1  ON 19
ci_021                -9.932989e-03 3 1  ON 20
ci_022                -1.143949e-02 3 1  ON 21
ci_023                 9.103632e-03 3 1  ON 22
ci_024                 8.794407e-03 3 1  ON 23
ci_025                 8.671071e-03 3 1  ON 24
ci_026                 8.336891e-03 3 1  ON 25
ci_027                 7.348903e-03 3 1  ON 26
ci_028                 7.479625e-03 3 1  ON 27
ci_029                -7.430330e-03 3 1  ON 28
ci_030                -7.928019e-03 3 1  ON 29
ci_031                -7.795154e-03 3 1  ON 30
ci_032                -6.038058e-03 3 1  ON 31
ci_033                 5.772408e-03 3 1  ON 32
ci_034                 7.039071e-03 3 1  ON 33
ci_035                 6.797015e-03 3 1  ON 34
ci_036                 6.672639e-03 3 1  ON 35
ci_037                 6.083375e-03 3 1  ON 36
ci_038                 6.290239e-03 3 1  ON 37
ci_039                 5.354825e-03 3 1  ON 38
ci_040                 5.553213e-03 3 1  ON 39
ci_041                 5.776552e-03 3 1  ON 40
ci_042                 5.590060e-03 3 1  ON 41
ci_043                 3.874546e-03 3 1  ON 42
ci_044                 5.699127e-03 3 1  ON 43
ci_045                 4.761965e-03 3 1  ON 44
ci_046                 5.151801e-03 3 1  ON 45
ci_047                -4.633985e-03 3 1  ON 46
ci_048                -4.046538e-03 3 1  ON 47
ci_049                 3.921580e-03 3 1  ON 48
ci_050                 3.518429e-03 3 1  ON 49
ci_051                -2.365588e-03 3 1  ON 50
ci_052                -2.810658e-03 3 1  ON 51
ci_053                -2.876537e-03 3 1  ON 52
ci_054                -3.083573e-03 3 1  ON 53
ci_055                -3.452799e-03 3 1  ON 54
ci_056                -2.936371e-03 3 1  ON 55
ci_057                -2.196266e-03 3 1  ON 56
ci_058                -1.764909e-03 3 1  ON 57
ci_059                -1.406937e-03 3 1  ON 58
ci_060                -1.496969e-03 3 1  ON 59
ci_061                -1.958075e-03 3 1  ON 60
ci_062                -6.372168e-04 3 1  ON 61
ci_063                -1.482906e-03 3 1  ON 62
ci_064                -1.455831e-03 3 1  ON 63
ci_065                -1.626355e-03 3 1  ON 64
ci_066                -3.026284e-04 3 1  ON 65
ci_067                -8.821244e-04 3 1  ON 66
ci_068                -8.732891e-04 3 1  ON 67
ci_069                 6.136464e-04 3 1  ON 68
ci_070                 1.998695e-03 3 1  ON 69
ci_071                -1.033280e-03 3 1  ON 70
ci_072                -7.295428e-04 3 1  ON 71
ci_073                 5.736349e-04 3 1  ON 72
ci_074                 9.046489e-04 3 1  ON 73
ci_075                -9.686622e-04 3 1  ON 74
ci_076                -6.972178e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7126e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2330e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.0433
    reference variance = 4.1648
====================================================
  Execution time = 2.4540e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0314e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7343e+00
  Total weights = 1.949737875e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1263e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.787934050718
                                         uncertainty =       0.035432682683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.787934050718
                                         uncertainty =       0.035432682683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376068477
  error estimate for blocks of size 2^( 2) =       0.001445108243
  error estimate for blocks of size 2^( 3) =       0.001507681196
  error estimate for blocks of size 2^( 4) =       0.001548456665
  error estimate for blocks of size 2^( 5) =       0.001571355028
  error estimate for blocks of size 2^( 6) =       0.001583112390
  error estimate for blocks of size 2^( 7) =       0.001593063730

      target function =                  N/A
              le_mean =     -22.328202565162
             les_mean =     502.282891957531
             stat err =       0.001573996953
             autocorr =       1.308361278108
              std dev =       1.946085839452
             le_variance =       3.787250094514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232820256516e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328202564371       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328242767399       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328242992169       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328242895893       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 8.365463e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328202564371       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328215890163       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328215859693       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 2.309849e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328202564371       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328206191270       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328206184465       residual = 1.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+00 is 6.102141e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067153 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0673e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -6.934780e-01 3 1  ON 0
ci_002                -7.073822e-01 3 1  ON 1
ci_003                -5.976807e-02 3 1  ON 2
ci_004                -5.979033e-02 3 1  ON 3
ci_005                 4.550057e-02 3 1  ON 4
ci_006                 4.655414e-02 3 1  ON 5
ci_007                 3.179819e-02 3 1  ON 6
ci_008                 3.240865e-02 3 1  ON 7
ci_009                -2.453880e-02 3 1  ON 8
ci_010                -2.478918e-02 3 1  ON 9
ci_011                -2.176907e-02 3 1  ON 10
ci_012                -2.296657e-02 3 1  ON 11
ci_013                 2.055858e-02 3 1  ON 12
ci_014                 2.062662e-02 3 1  ON 13
ci_015                 1.984694e-02 3 1  ON 14
ci_016                 2.194718e-02 3 1  ON 15
ci_017                 1.530673e-02 3 1  ON 16
ci_018                 1.587026e-02 3 1  ON 17
ci_019                 1.037835e-02 3 1  ON 18
ci_020                 1.053925e-02 3 1  ON 19
ci_021                -9.988962e-03 3 1  ON 20
ci_022                -1.124373e-02 3 1  ON 21
ci_023                 9.132455e-03 3 1  ON 22
ci_024                 8.721512e-03 3 1  ON 23
ci_025                 8.652787e-03 3 1  ON 24
ci_026                 8.469183e-03 3 1  ON 25
ci_027                 7.442079e-03 3 1  ON 26
ci_028                 7.585849e-03 3 1  ON 27
ci_029                -7.656542e-03 3 1  ON 28
ci_030                -7.884844e-03 3 1  ON 29
ci_031                -7.784007e-03 3 1  ON 30
ci_032                -6.081529e-03 3 1  ON 31
ci_033                 5.791715e-03 3 1  ON 32
ci_034                 6.896081e-03 3 1  ON 33
ci_035                 6.892351e-03 3 1  ON 34
ci_036                 6.538853e-03 3 1  ON 35
ci_037                 6.122865e-03 3 1  ON 36
ci_038                 6.310295e-03 3 1  ON 37
ci_039                 5.496010e-03 3 1  ON 38
ci_040                 5.528678e-03 3 1  ON 39
ci_041                 5.618788e-03 3 1  ON 40
ci_042                 5.502561e-03 3 1  ON 41
ci_043                 3.995575e-03 3 1  ON 42
ci_044                 5.774432e-03 3 1  ON 43
ci_045                 4.680194e-03 3 1  ON 44
ci_046                 5.253532e-03 3 1  ON 45
ci_047                -4.515767e-03 3 1  ON 46
ci_048                -4.238835e-03 3 1  ON 47
ci_049                 3.886595e-03 3 1  ON 48
ci_050                 3.476270e-03 3 1  ON 49
ci_051                -2.242486e-03 3 1  ON 50
ci_052                -2.827763e-03 3 1  ON 51
ci_053                -2.833602e-03 3 1  ON 52
ci_054                -2.976176e-03 3 1  ON 53
ci_055                -3.500499e-03 3 1  ON 54
ci_056                -2.740956e-03 3 1  ON 55
ci_057                -2.197893e-03 3 1  ON 56
ci_058                -1.829745e-03 3 1  ON 57
ci_059                -1.436509e-03 3 1  ON 58
ci_060                -1.676412e-03 3 1  ON 59
ci_061                -1.901843e-03 3 1  ON 60
ci_062                -7.162615e-04 3 1  ON 61
ci_063                -1.660845e-03 3 1  ON 62
ci_064                -1.395402e-03 3 1  ON 63
ci_065                -1.651084e-03 3 1  ON 64
ci_066                -3.865931e-04 3 1  ON 65
ci_067                -1.003854e-03 3 1  ON 66
ci_068                -8.443141e-04 3 1  ON 67
ci_069                 6.401759e-04 3 1  ON 68
ci_070                 2.024461e-03 3 1  ON 69
ci_071                -1.148328e-03 3 1  ON 70
ci_072                -7.950370e-04 3 1  ON 71
ci_073                 6.645462e-04 3 1  ON 72
ci_074                 1.020235e-03 3 1  ON 73
ci_075                -1.022756e-03 3 1  ON 74
ci_076                -8.291475e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.3662
    reference variance = 4.75423
====================================================
  Execution time = 2.3902e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7114e+00
  Total weights = 1.9497e+06
  Execution time = 4.4902e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763747041344
                                         uncertainty =       0.039405183431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763747041344
                                         uncertainty =       0.039405183431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371767825
  error estimate for blocks of size 2^( 2) =       0.001442508298
  error estimate for blocks of size 2^( 3) =       0.001505564957
  error estimate for blocks of size 2^( 4) =       0.001548413750
  error estimate for blocks of size 2^( 5) =       0.001573765569
  error estimate for blocks of size 2^( 6) =       0.001586904908
  error estimate for blocks of size 2^( 7) =       0.001595935848

      target function =                  N/A
              le_mean =     -22.328137786628
             les_mean =     502.258168081130
             stat err =       0.001576255019
             autocorr =       1.320358118303
              std dev =       1.940003702481
             le_variance =       3.763614365640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763707267847
                                         uncertainty =       0.039402394475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763707267847
                                         uncertainty =       0.039402394475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371760471
  error estimate for blocks of size 2^( 2) =       0.001442504541
  error estimate for blocks of size 2^( 3) =       0.001505568316
  error estimate for blocks of size 2^( 4) =       0.001548416359
  error estimate for blocks of size 2^( 5) =       0.001573771210
  error estimate for blocks of size 2^( 6) =       0.001586898568
  error estimate for blocks of size 2^( 7) =       0.001595956718

      target function =                  N/A
              le_mean =     -22.328139288920
             les_mean =     502.260074211301
             stat err =       0.001576260714
             autocorr =       1.320381815660
              std dev =       1.939993302246
             le_variance =       3.763574012759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763705064019
                                         uncertainty =       0.039404412955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763705064019
                                         uncertainty =       0.039404412955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371760106
  error estimate for blocks of size 2^( 2) =       0.001442502759
  error estimate for blocks of size 2^( 3) =       0.001505565379
  error estimate for blocks of size 2^( 4) =       0.001548415447
  error estimate for blocks of size 2^( 5) =       0.001573766149
  error estimate for blocks of size 2^( 6) =       0.001586898170
  error estimate for blocks of size 2^( 7) =       0.001595947661

      target function =                  N/A
              le_mean =     -22.328135498434
             les_mean =     502.258906357246
             stat err =       0.001576256857
             autocorr =       1.320376058051
              std dev =       1.939992785216
             le_variance =       3.763572006691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763737145480
                                         uncertainty =       0.039404994722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763737145480
                                         uncertainty =       0.039404994722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371766013
  error estimate for blocks of size 2^( 2) =       0.001442506787
  error estimate for blocks of size 2^( 3) =       0.001505563987
  error estimate for blocks of size 2^( 4) =       0.001548412886
  error estimate for blocks of size 2^( 5) =       0.001573763150
  error estimate for blocks of size 2^( 6) =       0.001586903254
  error estimate for blocks of size 2^( 7) =       0.001595935018

      target function =                  N/A
              le_mean =     -22.328137179802
             les_mean =     502.258457867375
             stat err =       0.001576253577
             autocorr =       1.320359191807
              std dev =       1.940001139255
             le_variance =       3.763604420311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328137786628        initial
     3.8147e-01     3.8147e+00             8.3655e-04       -22.328139288920  <--
     1.5259e+00     1.5259e+01             2.3098e-04       -22.328135498434
     6.1035e+00     6.1035e+01             6.1021e-05       -22.328137179802

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 4.6472e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -6.932135e-01 3 1  ON 0
ci_002                -7.075973e-01 3 1  ON 1
ci_003                -6.037363e-02 3 1  ON 2
ci_004                -5.985721e-02 3 1  ON 3
ci_005                 4.533829e-02 3 1  ON 4
ci_006                 4.634388e-02 3 1  ON 5
ci_007                 3.180387e-02 3 1  ON 6
ci_008                 3.270940e-02 3 1  ON 7
ci_009                -2.461721e-02 3 1  ON 8
ci_010                -2.493328e-02 3 1  ON 9
ci_011                -2.196708e-02 3 1  ON 10
ci_012                -2.283484e-02 3 1  ON 11
ci_013                 2.068339e-02 3 1  ON 12
ci_014                 2.050205e-02 3 1  ON 13
ci_015                 1.976571e-02 3 1  ON 14
ci_016                 2.168208e-02 3 1  ON 15
ci_017                 1.504761e-02 3 1  ON 16
ci_018                 1.577561e-02 3 1  ON 17
ci_019                 1.035420e-02 3 1  ON 18
ci_020                 1.079311e-02 3 1  ON 19
ci_021                -1.010702e-02 3 1  ON 20
ci_022                -1.080997e-02 3 1  ON 21
ci_023                 9.184807e-03 3 1  ON 22
ci_024                 8.582936e-03 3 1  ON 23
ci_025                 8.617627e-03 3 1  ON 24
ci_026                 8.750375e-03 3 1  ON 25
ci_027                 7.598327e-03 3 1  ON 26
ci_028                 7.773903e-03 3 1  ON 27
ci_029                -8.130136e-03 3 1  ON 28
ci_030                -7.793597e-03 3 1  ON 29
ci_031                -7.746866e-03 3 1  ON 30
ci_032                -6.211906e-03 3 1  ON 31
ci_033                 5.837049e-03 3 1  ON 32
ci_034                 6.571766e-03 3 1  ON 33
ci_035                 7.070888e-03 3 1  ON 34
ci_036                 6.306215e-03 3 1  ON 35
ci_037                 6.211188e-03 3 1  ON 36
ci_038                 6.347032e-03 3 1  ON 37
ci_039                 5.734600e-03 3 1  ON 38
ci_040                 5.489432e-03 3 1  ON 39
ci_041                 5.324629e-03 3 1  ON 40
ci_042                 5.339826e-03 3 1  ON 41
ci_043                 4.249729e-03 3 1  ON 42
ci_044                 5.940568e-03 3 1  ON 43
ci_045                 4.511532e-03 3 1  ON 44
ci_046                 5.479092e-03 3 1  ON 45
ci_047                -4.310757e-03 3 1  ON 46
ci_048                -4.574823e-03 3 1  ON 47
ci_049                 3.815964e-03 3 1  ON 48
ci_050                 3.391114e-03 3 1  ON 49
ci_051                -1.974990e-03 3 1  ON 50
ci_052                -2.871448e-03 3 1  ON 51
ci_053                -2.736747e-03 3 1  ON 52
ci_054                -2.764235e-03 3 1  ON 53
ci_055                -3.585827e-03 3 1  ON 54
ci_056                -2.321043e-03 3 1  ON 55
ci_057                -2.199007e-03 3 1  ON 56
ci_058                -1.955912e-03 3 1  ON 57
ci_059                -1.491423e-03 3 1  ON 58
ci_060                -2.000786e-03 3 1  ON 59
ci_061                -1.802977e-03 3 1  ON 60
ci_062                -8.788740e-04 3 1  ON 61
ci_063                -2.031428e-03 3 1  ON 62
ci_064                -1.279786e-03 3 1  ON 63
ci_065                -1.674667e-03 3 1  ON 64
ci_066                -5.639369e-04 3 1  ON 65
ci_067                -1.260370e-03 3 1  ON 66
ci_068                -8.036904e-04 3 1  ON 67
ci_069                 7.072947e-04 3 1  ON 68
ci_070                 2.077450e-03 3 1  ON 69
ci_071                -1.396673e-03 3 1  ON 70
ci_072                -9.333364e-04 3 1  ON 71
ci_073                 8.188207e-04 3 1  ON 72
ci_074                 1.222469e-03 3 1  ON 73
ci_075                -1.136999e-03 3 1  ON 74
ci_076                -1.094809e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7152e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2324e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.2906
    reference variance = 2.796
====================================================
  Execution time = 2.4410e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0306e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7404e+00
  Total weights = 1.949752923e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0175e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792320871338
                                         uncertainty =       0.033382070461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792320871338
                                         uncertainty =       0.033382070461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376966141
  error estimate for blocks of size 2^( 2) =       0.001447087104
  error estimate for blocks of size 2^( 3) =       0.001510774879
  error estimate for blocks of size 2^( 4) =       0.001556409462
  error estimate for blocks of size 2^( 5) =       0.001580510474
  error estimate for blocks of size 2^( 6) =       0.001590520802
  error estimate for blocks of size 2^( 7) =       0.001595208293

      target function =                  N/A
              le_mean =     -22.327683654285
             les_mean =     502.265868155944
             stat err =       0.001580662258
             autocorr =       1.317745812982
              std dev =       1.947355347775
             le_variance =       3.792192850509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232768365428e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327683653442       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327742386367       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327747927103       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327748421890       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327749065770       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327748962566       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-02 is 2.314443e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327683653442       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327712755130       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327713442053       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327713373821       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 1.088136e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327683653442       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327693295994       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327693348615       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+00 is 3.512410e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0434e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -6.926567e-01 3 1  ON 0
ci_002                -7.080794e-01 3 1  ON 1
ci_003                -6.027195e-02 3 1  ON 2
ci_004                -6.041052e-02 3 1  ON 3
ci_005                 4.543477e-02 3 1  ON 4
ci_006                 4.592037e-02 3 1  ON 5
ci_007                 3.201094e-02 3 1  ON 6
ci_008                 3.273238e-02 3 1  ON 7
ci_009                -2.505983e-02 3 1  ON 8
ci_010                -2.602142e-02 3 1  ON 9
ci_011                -2.223235e-02 3 1  ON 10
ci_012                -2.310170e-02 3 1  ON 11
ci_013                 2.051040e-02 3 1  ON 12
ci_014                 2.047106e-02 3 1  ON 13
ci_015                 1.997743e-02 3 1  ON 14
ci_016                 2.167916e-02 3 1  ON 15
ci_017                 1.475777e-02 3 1  ON 16
ci_018                 1.569539e-02 3 1  ON 17
ci_019                 1.024341e-02 3 1  ON 18
ci_020                 1.035473e-02 3 1  ON 19
ci_021                -9.927930e-03 3 1  ON 20
ci_022                -1.068823e-02 3 1  ON 21
ci_023                 8.997762e-03 3 1  ON 22
ci_024                 8.718009e-03 3 1  ON 23
ci_025                 8.623703e-03 3 1  ON 24
ci_026                 8.717187e-03 3 1  ON 25
ci_027                 7.512277e-03 3 1  ON 26
ci_028                 7.958489e-03 3 1  ON 27
ci_029                -7.959541e-03 3 1  ON 28
ci_030                -7.705768e-03 3 1  ON 29
ci_031                -7.526963e-03 3 1  ON 30
ci_032                -6.317617e-03 3 1  ON 31
ci_033                 5.832602e-03 3 1  ON 32
ci_034                 6.899870e-03 3 1  ON 33
ci_035                 6.909925e-03 3 1  ON 34
ci_036                 6.277392e-03 3 1  ON 35
ci_037                 6.137305e-03 3 1  ON 36
ci_038                 6.455482e-03 3 1  ON 37
ci_039                 5.572849e-03 3 1  ON 38
ci_040                 5.783780e-03 3 1  ON 39
ci_041                 5.127993e-03 3 1  ON 40
ci_042                 5.117573e-03 3 1  ON 41
ci_043                 4.443589e-03 3 1  ON 42
ci_044                 6.023936e-03 3 1  ON 43
ci_045                 4.111834e-03 3 1  ON 44
ci_046                 5.303699e-03 3 1  ON 45
ci_047                -3.993794e-03 3 1  ON 46
ci_048                -4.325177e-03 3 1  ON 47
ci_049                 3.548530e-03 3 1  ON 48
ci_050                 3.688179e-03 3 1  ON 49
ci_051                -2.161302e-03 3 1  ON 50
ci_052                -2.874228e-03 3 1  ON 51
ci_053                -2.491918e-03 3 1  ON 52
ci_054                -2.949591e-03 3 1  ON 53
ci_055                -3.410874e-03 3 1  ON 54
ci_056                -2.374338e-03 3 1  ON 55
ci_057                -2.022377e-03 3 1  ON 56
ci_058                -2.138031e-03 3 1  ON 57
ci_059                -1.390054e-03 3 1  ON 58
ci_060                -2.188434e-03 3 1  ON 59
ci_061                -1.962755e-03 3 1  ON 60
ci_062                -5.738551e-04 3 1  ON 61
ci_063                -1.868842e-03 3 1  ON 62
ci_064                -1.589004e-03 3 1  ON 63
ci_065                -1.244493e-03 3 1  ON 64
ci_066                -8.537951e-04 3 1  ON 65
ci_067                -9.767360e-04 3 1  ON 66
ci_068                -8.896581e-04 3 1  ON 67
ci_069                 8.465661e-04 3 1  ON 68
ci_070                 1.981011e-03 3 1  ON 69
ci_071                -7.634751e-04 3 1  ON 70
ci_072                -1.234286e-03 3 1  ON 71
ci_073                 8.543943e-04 3 1  ON 72
ci_074                 9.457805e-04 3 1  ON 73
ci_075                -1.176768e-03 3 1  ON 74
ci_076                -1.128104e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.4154
    reference variance = 4.98552
====================================================
  Execution time = 2.3858e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.6944e+00
  Total weights = 1.9499e+06
  Execution time = 4.4954e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746338908931
                                         uncertainty =       0.035488075305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746338908931
                                         uncertainty =       0.035488075305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368567282
  error estimate for blocks of size 2^( 2) =       0.001440020693
  error estimate for blocks of size 2^( 3) =       0.001502999370
  error estimate for blocks of size 2^( 4) =       0.001545190826
  error estimate for blocks of size 2^( 5) =       0.001568832599
  error estimate for blocks of size 2^( 6) =       0.001576272140
  error estimate for blocks of size 2^( 7) =       0.001583373995

      target function =                  N/A
              le_mean =     -22.326189400646
             les_mean =     502.154555099592
             stat err =       0.001568417390
             autocorr =       1.313381793924
              std dev =       1.935477377612
             le_variance =       3.746072679246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746734584690
                                         uncertainty =       0.035492326403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746734584690
                                         uncertainty =       0.035492326403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368639486
  error estimate for blocks of size 2^( 2) =       0.001440066063
  error estimate for blocks of size 2^( 3) =       0.001503018548
  error estimate for blocks of size 2^( 4) =       0.001545218098
  error estimate for blocks of size 2^( 5) =       0.001568841145
  error estimate for blocks of size 2^( 6) =       0.001576216894
  error estimate for blocks of size 2^( 7) =       0.001583191457

      target function =                  N/A
              le_mean =     -22.326217000427
             les_mean =     504.817052667185
             stat err =       0.001568366899
             autocorr =       1.313158666335
              std dev =       1.935579492038
             le_variance =       3.746467970000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746323563268
                                         uncertainty =       0.035493376221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746323563268
                                         uncertainty =       0.035493376221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368564670
  error estimate for blocks of size 2^( 2) =       0.001439998629
  error estimate for blocks of size 2^( 3) =       0.001502955385
  error estimate for blocks of size 2^( 4) =       0.001545150929
  error estimate for blocks of size 2^( 5) =       0.001568799147
  error estimate for blocks of size 2^( 6) =       0.001576223481
  error estimate for blocks of size 2^( 7) =       0.001583231646

      target function =                  N/A
              le_mean =     -22.326196307062
             les_mean =     502.230911441022
             stat err =       0.001568351301
             autocorr =       1.313276123353
              std dev =       1.935473683675
             le_variance =       3.746058380200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746310098340
                                         uncertainty =       0.035488781333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746310098340
                                         uncertainty =       0.035488781333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368562052
  error estimate for blocks of size 2^( 2) =       0.001440011891
  error estimate for blocks of size 2^( 3) =       0.001502986070
  error estimate for blocks of size 2^( 4) =       0.001545177178
  error estimate for blocks of size 2^( 5) =       0.001568820668
  error estimate for blocks of size 2^( 6) =       0.001576256495
  error estimate for blocks of size 2^( 7) =       0.001583336539

      target function =                  N/A
              le_mean =     -22.326185777915
             les_mean =     502.154569331977
             stat err =       0.001568397720
             autocorr =       1.313358887662
              std dev =       1.935469982091
             le_variance =       3.746044051576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326189400646        initial
     9.5367e-02     9.5367e-01             2.3144e-03       -22.326217000427  <--
     3.8147e-01     3.8147e+00             1.0881e-03       -22.326196307062
     1.5259e+00     1.5259e+01             3.5124e-04       -22.326185777915

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 4.6505e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -6.909845e-01 3 1  ON 0
ci_002                -7.096286e-01 3 1  ON 1
ci_003                -5.997648e-02 3 1  ON 2
ci_004                -6.149897e-02 3 1  ON 3
ci_005                 4.541701e-02 3 1  ON 4
ci_006                 4.559066e-02 3 1  ON 5
ci_007                 3.212591e-02 3 1  ON 6
ci_008                 3.271272e-02 3 1  ON 7
ci_009                -2.544238e-02 3 1  ON 8
ci_010                -2.724772e-02 3 1  ON 9
ci_011                -2.253004e-02 3 1  ON 10
ci_012                -2.340876e-02 3 1  ON 11
ci_013                 2.025383e-02 3 1  ON 12
ci_014                 2.041402e-02 3 1  ON 13
ci_015                 2.029670e-02 3 1  ON 14
ci_016                 2.172239e-02 3 1  ON 15
ci_017                 1.442664e-02 3 1  ON 16
ci_018                 1.557919e-02 3 1  ON 17
ci_019                 1.007235e-02 3 1  ON 18
ci_020                 9.766759e-03 3 1  ON 19
ci_021                -9.687073e-03 3 1  ON 20
ci_022                -1.045613e-02 3 1  ON 21
ci_023                 8.794379e-03 3 1  ON 22
ci_024                 8.863911e-03 3 1  ON 23
ci_025                 8.659171e-03 3 1  ON 24
ci_026                 8.752524e-03 3 1  ON 25
ci_027                 7.438916e-03 3 1  ON 26
ci_028                 8.090231e-03 3 1  ON 27
ci_029                -7.848839e-03 3 1  ON 28
ci_030                -7.659644e-03 3 1  ON 29
ci_031                -7.274394e-03 3 1  ON 30
ci_032                -6.479502e-03 3 1  ON 31
ci_033                 5.860874e-03 3 1  ON 32
ci_034                 7.317594e-03 3 1  ON 33
ci_035                 6.797965e-03 3 1  ON 34
ci_036                 6.321648e-03 3 1  ON 35
ci_037                 6.042841e-03 3 1  ON 36
ci_038                 6.556270e-03 3 1  ON 37
ci_039                 5.447495e-03 3 1  ON 38
ci_040                 6.003516e-03 3 1  ON 39
ci_041                 4.944061e-03 3 1  ON 40
ci_042                 4.927101e-03 3 1  ON 41
ci_043                 4.671562e-03 3 1  ON 42
ci_044                 6.100318e-03 3 1  ON 43
ci_045                 3.654677e-03 3 1  ON 44
ci_046                 5.109121e-03 3 1  ON 45
ci_047                -3.788688e-03 3 1  ON 46
ci_048                -4.199926e-03 3 1  ON 47
ci_049                 3.233197e-03 3 1  ON 48
ci_050                 4.033629e-03 3 1  ON 49
ci_051                -2.443480e-03 3 1  ON 50
ci_052                -2.842540e-03 3 1  ON 51
ci_053                -2.188737e-03 3 1  ON 52
ci_054                -3.141354e-03 3 1  ON 53
ci_055                -3.247140e-03 3 1  ON 54
ci_056                -2.407007e-03 3 1  ON 55
ci_057                -1.833568e-03 3 1  ON 56
ci_058                -2.322134e-03 3 1  ON 57
ci_059                -1.307156e-03 3 1  ON 58
ci_060                -2.334337e-03 3 1  ON 59
ci_061                -2.119687e-03 3 1  ON 60
ci_062                -2.772416e-04 3 1  ON 61
ci_063                -1.691960e-03 3 1  ON 62
ci_064                -1.943860e-03 3 1  ON 63
ci_065                -8.145216e-04 3 1  ON 64
ci_066                -1.223624e-03 3 1  ON 65
ci_067                -6.922739e-04 3 1  ON 66
ci_068                -1.000908e-03 3 1  ON 67
ci_069                 9.808138e-04 3 1  ON 68
ci_070                 1.899191e-03 3 1  ON 69
ci_071                -8.341984e-05 3 1  ON 70
ci_072                -1.546899e-03 3 1  ON 71
ci_073                 8.751612e-04 3 1  ON 72
ci_074                 7.611549e-04 3 1  ON 73
ci_075                -1.226733e-03 3 1  ON 74
ci_076                -1.175221e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6946e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2325e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.3298
    reference variance = 3.44555
====================================================
  Execution time = 2.4499e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0344e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7032e+00
  Total weights = 1.950114812e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9870e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753500203979
                                         uncertainty =       0.031356634516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753500203979
                                         uncertainty =       0.031356634516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369855498
  error estimate for blocks of size 2^( 2) =       0.001441566783
  error estimate for blocks of size 2^( 3) =       0.001504023176
  error estimate for blocks of size 2^( 4) =       0.001547654042
  error estimate for blocks of size 2^( 5) =       0.001572708376
  error estimate for blocks of size 2^( 6) =       0.001586505226
  error estimate for blocks of size 2^( 7) =       0.001599428817

      target function =                  N/A
              le_mean =     -22.329395816890
             les_mean =     502.305087860733
             stat err =       0.001576574115
             autocorr =       1.324583282807
              std dev =       1.937299219471
             le_variance =       3.753128265763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232939581689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329395816104       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329525311070       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329544808461       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329548627722       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329551999484       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329553909011       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329555086496       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.329555319471       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.329556062595       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.329556079506       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-02 is 5.402117e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329395816104       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329492336740       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329500861057       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329501236244       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329501420677       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329501431746       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-02 is 1.495576e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329395816104       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329443632244       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329445003165       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329444981860       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e-01 is 7.131589e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071403 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0493e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -6.922356e-01 3 1  ON 0
ci_002                -7.084037e-01 3 1  ON 1
ci_003                -6.135546e-02 3 1  ON 2
ci_004                -6.045397e-02 3 1  ON 3
ci_005                 4.491797e-02 3 1  ON 4
ci_006                 4.623353e-02 3 1  ON 5
ci_007                 3.227795e-02 3 1  ON 6
ci_008                 3.221224e-02 3 1  ON 7
ci_009                -2.476104e-02 3 1  ON 8
ci_010                -2.652003e-02 3 1  ON 9
ci_011                -2.277365e-02 3 1  ON 10
ci_012                -2.208008e-02 3 1  ON 11
ci_013                 1.980593e-02 3 1  ON 12
ci_014                 2.151111e-02 3 1  ON 13
ci_015                 2.003428e-02 3 1  ON 14
ci_016                 2.095742e-02 3 1  ON 15
ci_017                 1.570722e-02 3 1  ON 16
ci_018                 1.687940e-02 3 1  ON 17
ci_019                 9.641299e-03 3 1  ON 18
ci_020                 1.043614e-02 3 1  ON 19
ci_021                -1.081748e-02 3 1  ON 20
ci_022                -1.130709e-02 3 1  ON 21
ci_023                 8.934299e-03 3 1  ON 22
ci_024                 8.482667e-03 3 1  ON 23
ci_025                 8.518354e-03 3 1  ON 24
ci_026                 8.751214e-03 3 1  ON 25
ci_027                 8.039215e-03 3 1  ON 26
ci_028                 8.374825e-03 3 1  ON 27
ci_029                -7.987463e-03 3 1  ON 28
ci_030                -7.594503e-03 3 1  ON 29
ci_031                -7.052786e-03 3 1  ON 30
ci_032                -5.949422e-03 3 1  ON 31
ci_033                 7.356450e-03 3 1  ON 32
ci_034                 6.075759e-03 3 1  ON 33
ci_035                 5.956190e-03 3 1  ON 34
ci_036                 6.523675e-03 3 1  ON 35
ci_037                 6.658260e-03 3 1  ON 36
ci_038                 6.112974e-03 3 1  ON 37
ci_039                 5.265454e-03 3 1  ON 38
ci_040                 5.044029e-03 3 1  ON 39
ci_041                 4.809148e-03 3 1  ON 40
ci_042                 5.324378e-03 3 1  ON 41
ci_043                 5.287716e-03 3 1  ON 42
ci_044                 6.688202e-03 3 1  ON 43
ci_045                 4.763007e-03 3 1  ON 44
ci_046                 5.136312e-03 3 1  ON 45
ci_047                -4.253605e-03 3 1  ON 46
ci_048                -4.313012e-03 3 1  ON 47
ci_049                 3.472778e-03 3 1  ON 48
ci_050                 3.990609e-03 3 1  ON 49
ci_051                -2.948189e-03 3 1  ON 50
ci_052                -3.191772e-03 3 1  ON 51
ci_053                -2.237444e-03 3 1  ON 52
ci_054                -2.871662e-03 3 1  ON 53
ci_055                -2.084637e-03 3 1  ON 54
ci_056                -3.770319e-03 3 1  ON 55
ci_057                -1.862787e-03 3 1  ON 56
ci_058                -2.855920e-03 3 1  ON 57
ci_059                -1.928848e-03 3 1  ON 58
ci_060                -1.810244e-03 3 1  ON 59
ci_061                -2.401255e-03 3 1  ON 60
ci_062                -1.752999e-03 3 1  ON 61
ci_063                -2.453598e-03 3 1  ON 62
ci_064                -1.108574e-03 3 1  ON 63
ci_065                -9.205844e-05 3 1  ON 64
ci_066                -8.425861e-04 3 1  ON 65
ci_067                -1.077611e-03 3 1  ON 66
ci_068                -8.660974e-04 3 1  ON 67
ci_069                 1.448544e-03 3 1  ON 68
ci_070                 1.487280e-03 3 1  ON 69
ci_071                 9.572281e-05 3 1  ON 70
ci_072                -3.709099e-04 3 1  ON 71
ci_073                 1.411254e-03 3 1  ON 72
ci_074                 1.016845e-03 3 1  ON 73
ci_075                -6.825113e-04 3 1  ON 74
ci_076                -5.492330e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.084
    reference variance = 7.66873
====================================================
  Execution time = 2.3992e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7430e+00
  Total weights = 1.9495e+06
  Execution time = 4.5004e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793892846722
                                         uncertainty =       0.035491499585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793892846722
                                         uncertainty =       0.035491499585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377204676
  error estimate for blocks of size 2^( 2) =       0.001447667387
  error estimate for blocks of size 2^( 3) =       0.001510945717
  error estimate for blocks of size 2^( 4) =       0.001555415840
  error estimate for blocks of size 2^( 5) =       0.001577994409
  error estimate for blocks of size 2^( 6) =       0.001586810005
  error estimate for blocks of size 2^( 7) =       0.001595758794

      target function =                  N/A
              le_mean =     -22.328390390746
             les_mean =     502.307999926118
             stat err =       0.001578994762
             autocorr =       1.314511534896
              std dev =       1.947692693723
             le_variance =       3.793506829181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794258331148
                                         uncertainty =       0.035485841928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794258331148
                                         uncertainty =       0.035485841928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377269929
  error estimate for blocks of size 2^( 2) =       0.001447741082
  error estimate for blocks of size 2^( 3) =       0.001511018236
  error estimate for blocks of size 2^( 4) =       0.001555466099
  error estimate for blocks of size 2^( 5) =       0.001578023752
  error estimate for blocks of size 2^( 6) =       0.001586845791
  error estimate for blocks of size 2^( 7) =       0.001595649445

      target function =                  N/A
              le_mean =     -22.328338675231
             les_mean =     502.302540647580
             stat err =       0.001578996272
             autocorr =       1.314389492627
              std dev =       1.947784976140
             le_variance =       3.793866313278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794919513986
                                         uncertainty =       0.035485853998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794919513986
                                         uncertainty =       0.035485853998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377389641
  error estimate for blocks of size 2^( 2) =       0.001447859328
  error estimate for blocks of size 2^( 3) =       0.001511141506
  error estimate for blocks of size 2^( 4) =       0.001555587362
  error estimate for blocks of size 2^( 5) =       0.001578163278
  error estimate for blocks of size 2^( 6) =       0.001586980973
  error estimate for blocks of size 2^( 7) =       0.001595749042

      target function =                  N/A
              le_mean =     -22.328374336313
             les_mean =     502.310758816437
             stat err =       0.001579120164
             autocorr =       1.314367262443
              std dev =       1.947954277092
             le_variance =       3.794525865641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793922645839
                                         uncertainty =       0.035488904517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793922645839
                                         uncertainty =       0.035488904517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377209803
  error estimate for blocks of size 2^( 2) =       0.001447677699
  error estimate for blocks of size 2^( 3) =       0.001510958674
  error estimate for blocks of size 2^( 4) =       0.001555420070
  error estimate for blocks of size 2^( 5) =       0.001577976816
  error estimate for blocks of size 2^( 6) =       0.001586788115
  error estimate for blocks of size 2^( 7) =       0.001595688073

      target function =                  N/A
              le_mean =     -22.328350505825
             les_mean =     502.305704720166
             stat err =       0.001578968269
             autocorr =       1.314457637221
              std dev =       1.947699944260
             le_variance =       3.793535072870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328390390746        initial  <--
     2.3842e-02     2.3842e-01             5.4021e-03       -22.328338675231
     9.5367e-02     9.5367e-01             1.4956e-03       -22.328374336313
     3.8147e-01     3.8147e+00             7.1316e-04       -22.328350505825

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.6153
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -6.909845e-01 3 1  ON 0
ci_002                -7.096286e-01 3 1  ON 1
ci_003                -5.997648e-02 3 1  ON 2
ci_004                -6.149897e-02 3 1  ON 3
ci_005                 4.541701e-02 3 1  ON 4
ci_006                 4.559066e-02 3 1  ON 5
ci_007                 3.212591e-02 3 1  ON 6
ci_008                 3.271272e-02 3 1  ON 7
ci_009                -2.544238e-02 3 1  ON 8
ci_010                -2.724772e-02 3 1  ON 9
ci_011                -2.253004e-02 3 1  ON 10
ci_012                -2.340876e-02 3 1  ON 11
ci_013                 2.025383e-02 3 1  ON 12
ci_014                 2.041402e-02 3 1  ON 13
ci_015                 2.029670e-02 3 1  ON 14
ci_016                 2.172239e-02 3 1  ON 15
ci_017                 1.442664e-02 3 1  ON 16
ci_018                 1.557919e-02 3 1  ON 17
ci_019                 1.007235e-02 3 1  ON 18
ci_020                 9.766759e-03 3 1  ON 19
ci_021                -9.687073e-03 3 1  ON 20
ci_022                -1.045613e-02 3 1  ON 21
ci_023                 8.794379e-03 3 1  ON 22
ci_024                 8.863911e-03 3 1  ON 23
ci_025                 8.659171e-03 3 1  ON 24
ci_026                 8.752524e-03 3 1  ON 25
ci_027                 7.438916e-03 3 1  ON 26
ci_028                 8.090231e-03 3 1  ON 27
ci_029                -7.848839e-03 3 1  ON 28
ci_030                -7.659644e-03 3 1  ON 29
ci_031                -7.274394e-03 3 1  ON 30
ci_032                -6.479502e-03 3 1  ON 31
ci_033                 5.860874e-03 3 1  ON 32
ci_034                 7.317594e-03 3 1  ON 33
ci_035                 6.797965e-03 3 1  ON 34
ci_036                 6.321648e-03 3 1  ON 35
ci_037                 6.042841e-03 3 1  ON 36
ci_038                 6.556270e-03 3 1  ON 37
ci_039                 5.447495e-03 3 1  ON 38
ci_040                 6.003516e-03 3 1  ON 39
ci_041                 4.944061e-03 3 1  ON 40
ci_042                 4.927101e-03 3 1  ON 41
ci_043                 4.671562e-03 3 1  ON 42
ci_044                 6.100318e-03 3 1  ON 43
ci_045                 3.654677e-03 3 1  ON 44
ci_046                 5.109121e-03 3 1  ON 45
ci_047                -3.788688e-03 3 1  ON 46
ci_048                -4.199926e-03 3 1  ON 47
ci_049                 3.233197e-03 3 1  ON 48
ci_050                 4.033629e-03 3 1  ON 49
ci_051                -2.443480e-03 3 1  ON 50
ci_052                -2.842540e-03 3 1  ON 51
ci_053                -2.188737e-03 3 1  ON 52
ci_054                -3.141354e-03 3 1  ON 53
ci_055                -3.247140e-03 3 1  ON 54
ci_056                -2.407007e-03 3 1  ON 55
ci_057                -1.833568e-03 3 1  ON 56
ci_058                -2.322134e-03 3 1  ON 57
ci_059                -1.307156e-03 3 1  ON 58
ci_060                -2.334337e-03 3 1  ON 59
ci_061                -2.119687e-03 3 1  ON 60
ci_062                -2.772416e-04 3 1  ON 61
ci_063                -1.691960e-03 3 1  ON 62
ci_064                -1.943860e-03 3 1  ON 63
ci_065                -8.145216e-04 3 1  ON 64
ci_066                -1.223624e-03 3 1  ON 65
ci_067                -6.922739e-04 3 1  ON 66
ci_068                -1.000908e-03 3 1  ON 67
ci_069                 9.808138e-04 3 1  ON 68
ci_070                 1.899191e-03 3 1  ON 69
ci_071                -8.341984e-05 3 1  ON 70
ci_072                -1.546899e-03 3 1  ON 71
ci_073                 8.751612e-04 3 1  ON 72
ci_074                 7.611549e-04 3 1  ON 73
ci_075                -1.226733e-03 3 1  ON 74
ci_076                -1.175221e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7130e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2319e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.1464
    reference variance = 3.45719
====================================================
  Execution time = 2.6701e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0336e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7507e+00
  Total weights = 1.950048135e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8732e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801724533235
                                         uncertainty =       0.046690992716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801724533235
                                         uncertainty =       0.046690992716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378614743
  error estimate for blocks of size 2^( 2) =       0.001449770073
  error estimate for blocks of size 2^( 3) =       0.001513004975
  error estimate for blocks of size 2^( 4) =       0.001554704436
  error estimate for blocks of size 2^( 5) =       0.001580279835
  error estimate for blocks of size 2^( 6) =       0.001589182249
  error estimate for blocks of size 2^( 7) =       0.001605835590

      target function =                  N/A
              le_mean =     -22.328597482375
             les_mean =     502.316950685529
             stat err =       0.001582500527
             autocorr =       1.317655532454
              std dev =       1.949686860846
             le_variance =       3.801278855355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232859748238e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328597481571       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328642578493       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328644003097       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328643769275       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328643794677       residual = 5.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 1.118316e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328597481571       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328614323892       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328614457498       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 3.834646e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328597481571       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328602285249       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328602297976       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+00 is 1.060962e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072794 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2581e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -6.910430e-01 3 1  ON 0
ci_002                -7.095867e-01 3 1  ON 1
ci_003                -6.012432e-02 3 1  ON 2
ci_004                -6.141158e-02 3 1  ON 3
ci_005                 4.554596e-02 3 1  ON 4
ci_006                 4.579806e-02 3 1  ON 5
ci_007                 3.197076e-02 3 1  ON 6
ci_008                 3.253107e-02 3 1  ON 7
ci_009                -2.526184e-02 3 1  ON 8
ci_010                -2.693150e-02 3 1  ON 9
ci_011                -2.234875e-02 3 1  ON 10
ci_012                -2.322424e-02 3 1  ON 11
ci_013                 2.018304e-02 3 1  ON 12
ci_014                 2.053164e-02 3 1  ON 13
ci_015                 2.027501e-02 3 1  ON 14
ci_016                 2.160087e-02 3 1  ON 15
ci_017                 1.481010e-02 3 1  ON 16
ci_018                 1.562926e-02 3 1  ON 17
ci_019                 1.013570e-02 3 1  ON 18
ci_020                 9.406348e-03 3 1  ON 19
ci_021                -9.744520e-03 3 1  ON 20
ci_022                -1.048519e-02 3 1  ON 21
ci_023                 8.697085e-03 3 1  ON 22
ci_024                 9.071927e-03 3 1  ON 23
ci_025                 8.586175e-03 3 1  ON 24
ci_026                 8.848730e-03 3 1  ON 25
ci_027                 7.287997e-03 3 1  ON 26
ci_028                 8.088038e-03 3 1  ON 27
ci_029                -8.012258e-03 3 1  ON 28
ci_030                -7.852425e-03 3 1  ON 29
ci_031                -7.117135e-03 3 1  ON 30
ci_032                -6.680718e-03 3 1  ON 31
ci_033                 5.903769e-03 3 1  ON 32
ci_034                 7.108865e-03 3 1  ON 33
ci_035                 6.875882e-03 3 1  ON 34
ci_036                 6.322842e-03 3 1  ON 35
ci_037                 6.055832e-03 3 1  ON 36
ci_038                 6.451552e-03 3 1  ON 37
ci_039                 5.379500e-03 3 1  ON 38
ci_040                 5.971326e-03 3 1  ON 39
ci_041                 5.047157e-03 3 1  ON 40
ci_042                 5.067022e-03 3 1  ON 41
ci_043                 4.740309e-03 3 1  ON 42
ci_044                 5.800915e-03 3 1  ON 43
ci_045                 3.786266e-03 3 1  ON 44
ci_046                 5.205037e-03 3 1  ON 45
ci_047                -3.746850e-03 3 1  ON 46
ci_048                -4.111800e-03 3 1  ON 47
ci_049                 3.134346e-03 3 1  ON 48
ci_050                 3.933484e-03 3 1  ON 49
ci_051                -2.446958e-03 3 1  ON 50
ci_052                -2.937342e-03 3 1  ON 51
ci_053                -2.280757e-03 3 1  ON 52
ci_054                -3.031528e-03 3 1  ON 53
ci_055                -3.324222e-03 3 1  ON 54
ci_056                -2.411225e-03 3 1  ON 55
ci_057                -1.930107e-03 3 1  ON 56
ci_058                -2.136002e-03 3 1  ON 57
ci_059                -1.552509e-03 3 1  ON 58
ci_060                -2.412937e-03 3 1  ON 59
ci_061                -1.993287e-03 3 1  ON 60
ci_062                -4.634761e-04 3 1  ON 61
ci_063                -1.674081e-03 3 1  ON 62
ci_064                -1.901554e-03 3 1  ON 63
ci_065                -9.839404e-04 3 1  ON 64
ci_066                -1.366755e-03 3 1  ON 65
ci_067                -6.478413e-04 3 1  ON 66
ci_068                -1.127032e-03 3 1  ON 67
ci_069                 7.820977e-04 3 1  ON 68
ci_070                 1.836275e-03 3 1  ON 69
ci_071                -2.152777e-04 3 1  ON 70
ci_072                -1.613888e-03 3 1  ON 71
ci_073                 8.035070e-04 3 1  ON 72
ci_074                 9.003684e-04 3 1  ON 73
ci_075                -1.432750e-03 3 1  ON 74
ci_076                -8.249175e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.0968
    reference variance = 5.25531
====================================================
  Execution time = 2.3935e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8329e+00
  Total weights = 1.9498e+06
  Execution time = 4.4032e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885466134894
                                         uncertainty =       0.093968830979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885466134894
                                         uncertainty =       0.093968830979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001393965472
  error estimate for blocks of size 2^( 2) =       0.001463432292
  error estimate for blocks of size 2^( 3) =       0.001524961208
  error estimate for blocks of size 2^( 4) =       0.001569484775
  error estimate for blocks of size 2^( 5) =       0.001595767794
  error estimate for blocks of size 2^( 6) =       0.001611767128
  error estimate for blocks of size 2^( 7) =       0.001618035495

      target function =                  N/A
              le_mean =     -22.328320306783
             les_mean =     502.387132100808
             stat err =       0.001598763798
             autocorr =       1.315420416154
              std dev =       1.971396417466
             le_variance =       3.886403834799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885376916574
                                         uncertainty =       0.093973249891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885376916574
                                         uncertainty =       0.093973249891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001393949543
  error estimate for blocks of size 2^( 2) =       0.001463420054
  error estimate for blocks of size 2^( 3) =       0.001524953619
  error estimate for blocks of size 2^( 4) =       0.001569487411
  error estimate for blocks of size 2^( 5) =       0.001595776146
  error estimate for blocks of size 2^( 6) =       0.001611778628
  error estimate for blocks of size 2^( 7) =       0.001618057549

      target function =                  N/A
              le_mean =     -22.328330325847
             les_mean =     502.387918473255
             stat err =       0.001598774933
             autocorr =       1.315468803362
              std dev =       1.971373890631
             le_variance =       3.886315016660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885392746750
                                         uncertainty =       0.093972056978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885392746750
                                         uncertainty =       0.093972056978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001393952353
  error estimate for blocks of size 2^( 2) =       0.001463421469
  error estimate for blocks of size 2^( 3) =       0.001524952895
  error estimate for blocks of size 2^( 4) =       0.001569482892
  error estimate for blocks of size 2^( 5) =       0.001595765513
  error estimate for blocks of size 2^( 6) =       0.001611766727
  error estimate for blocks of size 2^( 7) =       0.001618038622

      target function =                  N/A
              le_mean =     -22.328325082557
             les_mean =     502.437718757650
             stat err =       0.001598763438
             autocorr =       1.315444583890
              std dev =       1.971377864516
             le_variance =       3.886330684703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885449756261
                                         uncertainty =       0.093969268360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.885449756261
                                         uncertainty =       0.093969268360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001393962529
  error estimate for blocks of size 2^( 2) =       0.001463429772
  error estimate for blocks of size 2^( 3) =       0.001524959120
  error estimate for blocks of size 2^( 4) =       0.001569483642
  error estimate for blocks of size 2^( 5) =       0.001595766905
  error estimate for blocks of size 2^( 6) =       0.001611766367
  error estimate for blocks of size 2^( 7) =       0.001618035655

      target function =                  N/A
              le_mean =     -22.328319544291
             les_mean =     502.387025056860
             stat err =       0.001598763142
             autocorr =       1.315424891097
              std dev =       1.971392255862
             le_variance =       3.886387426472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328320306783        initial
     2.3842e-01     2.3842e+00             1.1183e-03       -22.328330325847  <--
     9.5367e-01     9.5367e+00             3.8346e-04       -22.328325082557
     3.8147e+00     3.8147e+01             1.0610e-04       -22.328319544291

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 4.6121e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -6.912068e-01 3 1  ON 0
ci_002                -7.094520e-01 3 1  ON 1
ci_003                -6.052832e-02 3 1  ON 2
ci_004                -6.121150e-02 3 1  ON 3
ci_005                 4.575545e-02 3 1  ON 4
ci_006                 4.609519e-02 3 1  ON 5
ci_007                 3.171566e-02 3 1  ON 6
ci_008                 3.223892e-02 3 1  ON 7
ci_009                -2.496507e-02 3 1  ON 8
ci_010                -2.640130e-02 3 1  ON 9
ci_011                -2.202387e-02 3 1  ON 10
ci_012                -2.285426e-02 3 1  ON 11
ci_013                 2.007904e-02 3 1  ON 12
ci_014                 2.076033e-02 3 1  ON 13
ci_015                 2.022401e-02 3 1  ON 14
ci_016                 2.130107e-02 3 1  ON 15
ci_017                 1.554496e-02 3 1  ON 16
ci_018                 1.573562e-02 3 1  ON 17
ci_019                 1.028616e-02 3 1  ON 18
ci_020                 8.686561e-03 3 1  ON 19
ci_021                -9.883327e-03 3 1  ON 20
ci_022                -1.048086e-02 3 1  ON 21
ci_023                 8.542418e-03 3 1  ON 22
ci_024                 9.394967e-03 3 1  ON 23
ci_025                 8.421907e-03 3 1  ON 24
ci_026                 9.063100e-03 3 1  ON 25
ci_027                 7.081606e-03 3 1  ON 26
ci_028                 8.076534e-03 3 1  ON 27
ci_029                -8.262227e-03 3 1  ON 28
ci_030                -8.143255e-03 3 1  ON 29
ci_031                -6.805803e-03 3 1  ON 30
ci_032                -7.052485e-03 3 1  ON 31
ci_033                 5.968836e-03 3 1  ON 32
ci_034                 6.717937e-03 3 1  ON 33
ci_035                 6.986596e-03 3 1  ON 34
ci_036                 6.307522e-03 3 1  ON 35
ci_037                 6.063668e-03 3 1  ON 36
ci_038                 6.285092e-03 3 1  ON 37
ci_039                 5.292756e-03 3 1  ON 38
ci_040                 5.927885e-03 3 1  ON 39
ci_041                 5.215585e-03 3 1  ON 40
ci_042                 5.277606e-03 3 1  ON 41
ci_043                 4.845167e-03 3 1  ON 42
ci_044                 5.247798e-03 3 1  ON 43
ci_045                 3.999496e-03 3 1  ON 44
ci_046                 5.402546e-03 3 1  ON 45
ci_047                -3.668229e-03 3 1  ON 46
ci_048                -3.981089e-03 3 1  ON 47
ci_049                 2.952874e-03 3 1  ON 48
ci_050                 3.754990e-03 3 1  ON 49
ci_051                -2.428470e-03 3 1  ON 50
ci_052                -3.084871e-03 3 1  ON 51
ci_053                -2.474221e-03 3 1  ON 52
ci_054                -2.847904e-03 3 1  ON 53
ci_055                -3.450711e-03 3 1  ON 54
ci_056                -2.430369e-03 3 1  ON 55
ci_057                -2.090679e-03 3 1  ON 56
ci_058                -1.827268e-03 3 1  ON 57
ci_059                -1.878447e-03 3 1  ON 58
ci_060                -2.511566e-03 3 1  ON 59
ci_061                -1.795057e-03 3 1  ON 60
ci_062                -7.737875e-04 3 1  ON 61
ci_063                -1.655294e-03 3 1  ON 62
ci_064                -1.820450e-03 3 1  ON 63
ci_065                -1.221524e-03 3 1  ON 64
ci_066                -1.578696e-03 3 1  ON 65
ci_067                -5.684283e-04 3 1  ON 66
ci_068                -1.344259e-03 3 1  ON 67
ci_069                 4.734149e-04 3 1  ON 68
ci_070                 1.715369e-03 3 1  ON 69
ci_071                -4.300158e-04 3 1  ON 70
ci_072                -1.698594e-03 3 1  ON 71
ci_073                 7.162305e-04 3 1  ON 72
ci_074                 1.070900e-03 3 1  ON 73
ci_075                -1.763259e-03 3 1  ON 74
ci_076                -2.035499e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8709e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.479
    reference variance = 2.02251
====================================================
  Execution time = 2.4358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0312e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7228e+00
  Total weights = 1.950137710e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9388e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775459129436
                                         uncertainty =       0.036303071566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775459129436
                                         uncertainty =       0.036303071566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373807722
  error estimate for blocks of size 2^( 2) =       0.001445070864
  error estimate for blocks of size 2^( 3) =       0.001509988123
  error estimate for blocks of size 2^( 4) =       0.001554089990
  error estimate for blocks of size 2^( 5) =       0.001580036552
  error estimate for blocks of size 2^( 6) =       0.001591124414
  error estimate for blocks of size 2^( 7) =       0.001595483963

      target function =                  N/A
              le_mean =     -22.326977176838
             les_mean =     502.216684822428
             stat err =       0.001580183730
             autocorr =       1.323010421631
              std dev =       1.942888597867
             le_variance =       3.774816103721


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232697717684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326977176024       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327054294944       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327057915814       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327060886302       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327060361435       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327060436384       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327060716479       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-02 is 1.903251e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326977176024       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327023953677       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327024361038       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327024728664       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327024642430       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 7.876599e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326977176024       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326995350871       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326995292007       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326995305893       residual = 8.29e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 2.962375e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0304e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -6.916874e-01 3 1  ON 0
ci_002                -7.089696e-01 3 1  ON 1
ci_003                -6.075324e-02 3 1  ON 2
ci_004                -6.161019e-02 3 1  ON 3
ci_005                 4.521609e-02 3 1  ON 4
ci_006                 4.601392e-02 3 1  ON 5
ci_007                 3.131314e-02 3 1  ON 6
ci_008                 3.245401e-02 3 1  ON 7
ci_009                -2.510478e-02 3 1  ON 8
ci_010                -2.584105e-02 3 1  ON 9
ci_011                -2.200159e-02 3 1  ON 10
ci_012                -2.313833e-02 3 1  ON 11
ci_013                 2.060091e-02 3 1  ON 12
ci_014                 2.095309e-02 3 1  ON 13
ci_015                 2.073950e-02 3 1  ON 14
ci_016                 2.110825e-02 3 1  ON 15
ci_017                 1.542388e-02 3 1  ON 16
ci_018                 1.615126e-02 3 1  ON 17
ci_019                 1.038414e-02 3 1  ON 18
ci_020                 9.215432e-03 3 1  ON 19
ci_021                -9.887012e-03 3 1  ON 20
ci_022                -1.062091e-02 3 1  ON 21
ci_023                 8.054225e-03 3 1  ON 22
ci_024                 8.658848e-03 3 1  ON 23
ci_025                 7.965742e-03 3 1  ON 24
ci_026                 9.110636e-03 3 1  ON 25
ci_027                 7.539466e-03 3 1  ON 26
ci_028                 7.767346e-03 3 1  ON 27
ci_029                -7.967249e-03 3 1  ON 28
ci_030                -7.800326e-03 3 1  ON 29
ci_031                -6.862883e-03 3 1  ON 30
ci_032                -7.050153e-03 3 1  ON 31
ci_033                 6.466844e-03 3 1  ON 32
ci_034                 6.493871e-03 3 1  ON 33
ci_035                 6.803658e-03 3 1  ON 34
ci_036                 6.635749e-03 3 1  ON 35
ci_037                 6.793436e-03 3 1  ON 36
ci_038                 6.164390e-03 3 1  ON 37
ci_039                 5.478910e-03 3 1  ON 38
ci_040                 5.293943e-03 3 1  ON 39
ci_041                 4.940294e-03 3 1  ON 40
ci_042                 4.754106e-03 3 1  ON 41
ci_043                 4.432208e-03 3 1  ON 42
ci_044                 5.307672e-03 3 1  ON 43
ci_045                 4.504256e-03 3 1  ON 44
ci_046                 5.962965e-03 3 1  ON 45
ci_047                -3.749986e-03 3 1  ON 46
ci_048                -4.191644e-03 3 1  ON 47
ci_049                 2.762590e-03 3 1  ON 48
ci_050                 3.626661e-03 3 1  ON 49
ci_051                -3.031353e-03 3 1  ON 50
ci_052                -2.878194e-03 3 1  ON 51
ci_053                -2.558891e-03 3 1  ON 52
ci_054                -2.437710e-03 3 1  ON 53
ci_055                -2.820411e-03 3 1  ON 54
ci_056                -2.249878e-03 3 1  ON 55
ci_057                -2.391077e-03 3 1  ON 56
ci_058                -1.528963e-03 3 1  ON 57
ci_059                -1.996234e-03 3 1  ON 58
ci_060                -2.044762e-03 3 1  ON 59
ci_061                -1.470446e-03 3 1  ON 60
ci_062                -1.167913e-03 3 1  ON 61
ci_063                -2.069056e-03 3 1  ON 62
ci_064                -1.681054e-03 3 1  ON 63
ci_065                -1.398116e-03 3 1  ON 64
ci_066                -1.462822e-03 3 1  ON 65
ci_067                -1.004924e-03 3 1  ON 66
ci_068                -1.247121e-03 3 1  ON 67
ci_069                 1.479824e-04 3 1  ON 68
ci_070                 1.728307e-03 3 1  ON 69
ci_071                -1.217676e-03 3 1  ON 70
ci_072                -9.750226e-04 3 1  ON 71
ci_073                 8.324134e-04 3 1  ON 72
ci_074                 1.435818e-03 3 1  ON 73
ci_075                -1.248152e-03 3 1  ON 74
ci_076                -5.127549e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.3595
    reference variance = 2.97029
====================================================
  Execution time = 2.3806e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7692e+00
  Total weights = 1.9498e+06
  Execution time = 4.3953e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.822075335771
                                         uncertainty =       0.069358297583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.822075335771
                                         uncertainty =       0.069358297583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382220380
  error estimate for blocks of size 2^( 2) =       0.001452967911
  error estimate for blocks of size 2^( 3) =       0.001515427181
  error estimate for blocks of size 2^( 4) =       0.001558686959
  error estimate for blocks of size 2^( 5) =       0.001582228593
  error estimate for blocks of size 2^( 6) =       0.001590583324
  error estimate for blocks of size 2^( 7) =       0.001594269357

      target function =                  N/A
              le_mean =     -22.328191558535
             les_mean =     502.329859700659
             stat err =       0.001581442058
             autocorr =       1.309037189896
              std dev =       1.954786083380
             le_variance =       3.821188631774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.822028538894
                                         uncertainty =       0.069349877690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.822028538894
                                         uncertainty =       0.069349877690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382212113
  error estimate for blocks of size 2^( 2) =       0.001452978401
  error estimate for blocks of size 2^( 3) =       0.001515459946
  error estimate for blocks of size 2^( 4) =       0.001558716739
  error estimate for blocks of size 2^( 5) =       0.001582263292
  error estimate for blocks of size 2^( 6) =       0.001590647989
  error estimate for blocks of size 2^( 7) =       0.001594400560

      target function =                  N/A
              le_mean =     -22.328189509327
             les_mean =     502.318635375177
             stat err =       0.001581507145
             autocorr =       1.309160604124
              std dev =       1.954774391494
             le_variance =       3.821142921639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823085499576
                                         uncertainty =       0.069307672596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823085499576
                                         uncertainty =       0.069307672596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382402487
  error estimate for blocks of size 2^( 2) =       0.001453164991
  error estimate for blocks of size 2^( 3) =       0.001515631601
  error estimate for blocks of size 2^( 4) =       0.001558883521
  error estimate for blocks of size 2^( 5) =       0.001582475584
  error estimate for blocks of size 2^( 6) =       0.001590858299
  error estimate for blocks of size 2^( 7) =       0.001594364573

      target function =                  N/A
              le_mean =     -22.328226997501
             les_mean =     502.524306122434
             stat err =       0.001581645494
             autocorr =       1.309029048263
              std dev =       1.955043625852
             le_variance =       3.822195578985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.822370892398
                                         uncertainty =       0.069340802781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.822370892398
                                         uncertainty =       0.069340802781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382273729
  error estimate for blocks of size 2^( 2) =       0.001453029059
  error estimate for blocks of size 2^( 3) =       0.001515491825
  error estimate for blocks of size 2^( 4) =       0.001558750303
  error estimate for blocks of size 2^( 5) =       0.001582231439
  error estimate for blocks of size 2^( 6) =       0.001590682237
  error estimate for blocks of size 2^( 7) =       0.001594441774

      target function =                  N/A
              le_mean =     -22.328169246568
             les_mean =     502.469393393617
             stat err =       0.001581526438
             autocorr =       1.309075830096
              std dev =       1.954861531961
             le_variance =       3.821483609142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328191558535        initial
     5.9605e-02     5.9605e-01             1.9033e-03       -22.328189509327
     2.3842e-01     2.3842e+00             7.8766e-04       -22.328226997501  <--
     9.5367e-01     9.5367e+00             2.9624e-04       -22.328169246568

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 4.5955e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -6.916874e-01 3 1  ON 0
ci_002                -7.089696e-01 3 1  ON 1
ci_003                -6.075324e-02 3 1  ON 2
ci_004                -6.161019e-02 3 1  ON 3
ci_005                 4.521609e-02 3 1  ON 4
ci_006                 4.601392e-02 3 1  ON 5
ci_007                 3.131314e-02 3 1  ON 6
ci_008                 3.245401e-02 3 1  ON 7
ci_009                -2.510478e-02 3 1  ON 8
ci_010                -2.584105e-02 3 1  ON 9
ci_011                -2.200159e-02 3 1  ON 10
ci_012                -2.313833e-02 3 1  ON 11
ci_013                 2.060091e-02 3 1  ON 12
ci_014                 2.095309e-02 3 1  ON 13
ci_015                 2.073950e-02 3 1  ON 14
ci_016                 2.110825e-02 3 1  ON 15
ci_017                 1.542388e-02 3 1  ON 16
ci_018                 1.615126e-02 3 1  ON 17
ci_019                 1.038414e-02 3 1  ON 18
ci_020                 9.215432e-03 3 1  ON 19
ci_021                -9.887012e-03 3 1  ON 20
ci_022                -1.062091e-02 3 1  ON 21
ci_023                 8.054225e-03 3 1  ON 22
ci_024                 8.658848e-03 3 1  ON 23
ci_025                 7.965742e-03 3 1  ON 24
ci_026                 9.110636e-03 3 1  ON 25
ci_027                 7.539466e-03 3 1  ON 26
ci_028                 7.767346e-03 3 1  ON 27
ci_029                -7.967249e-03 3 1  ON 28
ci_030                -7.800326e-03 3 1  ON 29
ci_031                -6.862883e-03 3 1  ON 30
ci_032                -7.050153e-03 3 1  ON 31
ci_033                 6.466844e-03 3 1  ON 32
ci_034                 6.493871e-03 3 1  ON 33
ci_035                 6.803658e-03 3 1  ON 34
ci_036                 6.635749e-03 3 1  ON 35
ci_037                 6.793436e-03 3 1  ON 36
ci_038                 6.164390e-03 3 1  ON 37
ci_039                 5.478910e-03 3 1  ON 38
ci_040                 5.293943e-03 3 1  ON 39
ci_041                 4.940294e-03 3 1  ON 40
ci_042                 4.754106e-03 3 1  ON 41
ci_043                 4.432208e-03 3 1  ON 42
ci_044                 5.307672e-03 3 1  ON 43
ci_045                 4.504256e-03 3 1  ON 44
ci_046                 5.962965e-03 3 1  ON 45
ci_047                -3.749986e-03 3 1  ON 46
ci_048                -4.191644e-03 3 1  ON 47
ci_049                 2.762590e-03 3 1  ON 48
ci_050                 3.626661e-03 3 1  ON 49
ci_051                -3.031353e-03 3 1  ON 50
ci_052                -2.878194e-03 3 1  ON 51
ci_053                -2.558891e-03 3 1  ON 52
ci_054                -2.437710e-03 3 1  ON 53
ci_055                -2.820411e-03 3 1  ON 54
ci_056                -2.249878e-03 3 1  ON 55
ci_057                -2.391077e-03 3 1  ON 56
ci_058                -1.528963e-03 3 1  ON 57
ci_059                -1.996234e-03 3 1  ON 58
ci_060                -2.044762e-03 3 1  ON 59
ci_061                -1.470446e-03 3 1  ON 60
ci_062                -1.167913e-03 3 1  ON 61
ci_063                -2.069056e-03 3 1  ON 62
ci_064                -1.681054e-03 3 1  ON 63
ci_065                -1.398116e-03 3 1  ON 64
ci_066                -1.462822e-03 3 1  ON 65
ci_067                -1.004924e-03 3 1  ON 66
ci_068                -1.247121e-03 3 1  ON 67
ci_069                 1.479824e-04 3 1  ON 68
ci_070                 1.728307e-03 3 1  ON 69
ci_071                -1.217676e-03 3 1  ON 70
ci_072                -9.750226e-04 3 1  ON 71
ci_073                 8.324134e-04 3 1  ON 72
ci_074                 1.435818e-03 3 1  ON 73
ci_075                -1.248152e-03 3 1  ON 74
ci_076                -5.127549e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6265e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2315e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.2525
    reference variance = 2.73309
====================================================
  Execution time = 2.4347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0299e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7294e+00
  Total weights = 1.949780205e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9441e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781920779374
                                         uncertainty =       0.035324934270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781920779374
                                         uncertainty =       0.035324934270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375039148
  error estimate for blocks of size 2^( 2) =       0.001445973718
  error estimate for blocks of size 2^( 3) =       0.001508938119
  error estimate for blocks of size 2^( 4) =       0.001553063237
  error estimate for blocks of size 2^( 5) =       0.001576424388
  error estimate for blocks of size 2^( 6) =       0.001589879669
  error estimate for blocks of size 2^( 7) =       0.001594957392

      target function =                  N/A
              le_mean =     -22.325073963156
             les_mean =     502.138327224361
             stat err =       0.001578581171
             autocorr =       1.317964495389
              std dev =       1.944630125227
             le_variance =       3.781586323941


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232507396316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325073962312       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325139957254       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325147724292       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325148953391       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325149988488       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.325149984420       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.325149827675       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.325149997736       residual = 1.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-02 is 2.160227e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325073962312       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325112997578       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325114826906       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325114856671       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325114910150       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e-01 is 1.008904e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325073962312       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325088781728       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325088953817       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325088949212       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e-01 is 3.586281e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076955 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0299e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -6.920755e-01 3 1  ON 0
ci_002                -7.085151e-01 3 1  ON 1
ci_003                -6.157190e-02 3 1  ON 2
ci_004                -6.188408e-02 3 1  ON 3
ci_005                 4.522667e-02 3 1  ON 4
ci_006                 4.627879e-02 3 1  ON 5
ci_007                 3.129044e-02 3 1  ON 6
ci_008                 3.281063e-02 3 1  ON 7
ci_009                -2.453296e-02 3 1  ON 8
ci_010                -2.573003e-02 3 1  ON 9
ci_011                -2.162033e-02 3 1  ON 10
ci_012                -2.281893e-02 3 1  ON 11
ci_013                 2.074034e-02 3 1  ON 12
ci_014                 2.072869e-02 3 1  ON 13
ci_015                 2.115426e-02 3 1  ON 14
ci_016                 2.138995e-02 3 1  ON 15
ci_017                 1.522178e-02 3 1  ON 16
ci_018                 1.609910e-02 3 1  ON 17
ci_019                 1.038243e-02 3 1  ON 18
ci_020                 9.536716e-03 3 1  ON 19
ci_021                -9.289339e-03 3 1  ON 20
ci_022                -1.031973e-02 3 1  ON 21
ci_023                 8.157311e-03 3 1  ON 22
ci_024                 8.259767e-03 3 1  ON 23
ci_025                 7.812545e-03 3 1  ON 24
ci_026                 8.512595e-03 3 1  ON 25
ci_027                 7.213930e-03 3 1  ON 26
ci_028                 8.131814e-03 3 1  ON 27
ci_029                -8.334997e-03 3 1  ON 28
ci_030                -7.258322e-03 3 1  ON 29
ci_031                -6.963229e-03 3 1  ON 30
ci_032                -7.385579e-03 3 1  ON 31
ci_033                 6.628969e-03 3 1  ON 32
ci_034                 6.879202e-03 3 1  ON 33
ci_035                 6.146444e-03 3 1  ON 34
ci_036                 6.602262e-03 3 1  ON 35
ci_037                 6.606069e-03 3 1  ON 36
ci_038                 6.164644e-03 3 1  ON 37
ci_039                 5.743583e-03 3 1  ON 38
ci_040                 5.789065e-03 3 1  ON 39
ci_041                 5.688307e-03 3 1  ON 40
ci_042                 4.923235e-03 3 1  ON 41
ci_043                 4.690591e-03 3 1  ON 42
ci_044                 5.163581e-03 3 1  ON 43
ci_045                 4.961183e-03 3 1  ON 44
ci_046                 4.954061e-03 3 1  ON 45
ci_047                -4.076394e-03 3 1  ON 46
ci_048                -4.188421e-03 3 1  ON 47
ci_049                 2.927682e-03 3 1  ON 48
ci_050                 3.999270e-03 3 1  ON 49
ci_051                -2.600091e-03 3 1  ON 50
ci_052                -2.272181e-03 3 1  ON 51
ci_053                -2.358855e-03 3 1  ON 52
ci_054                -2.245166e-03 3 1  ON 53
ci_055                -2.012412e-03 3 1  ON 54
ci_056                -2.010068e-03 3 1  ON 55
ci_057                -2.690759e-03 3 1  ON 56
ci_058                -1.727478e-03 3 1  ON 57
ci_059                -2.191088e-03 3 1  ON 58
ci_060                -1.991011e-03 3 1  ON 59
ci_061                -1.397073e-03 3 1  ON 60
ci_062                -1.390176e-03 3 1  ON 61
ci_063                -1.942857e-03 3 1  ON 62
ci_064                -1.689863e-03 3 1  ON 63
ci_065                -1.218573e-03 3 1  ON 64
ci_066                -1.290206e-03 3 1  ON 65
ci_067                -7.597409e-04 3 1  ON 66
ci_068                -6.662292e-04 3 1  ON 67
ci_069                 6.944241e-04 3 1  ON 68
ci_070                 2.078691e-03 3 1  ON 69
ci_071                -1.749128e-03 3 1  ON 70
ci_072                -1.126449e-03 3 1  ON 71
ci_073                 1.291917e-03 3 1  ON 72
ci_074                 1.497781e-03 3 1  ON 73
ci_075                -1.689489e-03 3 1  ON 74
ci_076                -1.001671e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.2384
    reference variance = 2.65067
====================================================
  Execution time = 2.3653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6687e+00
  Total weights = 1.9499e+06
  Execution time = 4.3954e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000339954
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719595237816
                                         uncertainty =       0.023095878758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719595237816
                                         uncertainty =       0.023095878758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363531733
  error estimate for blocks of size 2^( 2) =       0.001434720656
  error estimate for blocks of size 2^( 3) =       0.001498470139
  error estimate for blocks of size 2^( 4) =       0.001543020566
  error estimate for blocks of size 2^( 5) =       0.001565315675
  error estimate for blocks of size 2^( 6) =       0.001569862945
  error estimate for blocks of size 2^( 7) =       0.001576903106

      target function =                  N/A
              le_mean =     -22.327293690504
             les_mean =     502.301683476836
             stat err =       0.001563775573
             autocorr =       1.315280407920
              std dev =       1.928355921978
             le_variance =       3.718556561829

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00145173
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719528223507
                                         uncertainty =       0.023104874253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719528223507
                                         uncertainty =       0.023104874253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363519420
  error estimate for blocks of size 2^( 2) =       0.001434715937
  error estimate for blocks of size 2^( 3) =       0.001498466059
  error estimate for blocks of size 2^( 4) =       0.001543028032
  error estimate for blocks of size 2^( 5) =       0.001565361815
  error estimate for blocks of size 2^( 6) =       0.001569897447
  error estimate for blocks of size 2^( 7) =       0.001577016409

      target function =                  N/A
              le_mean =     -22.327286809692
             les_mean =     502.204401831236
             stat err =       0.001563825926
             autocorr =       1.315388867519
              std dev =       1.928338508753
             le_variance =       3.718489404341

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000338413
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719566575721
                                         uncertainty =       0.023105201652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719566575721
                                         uncertainty =       0.023105201652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363526500
  error estimate for blocks of size 2^( 2) =       0.001434720893
  error estimate for blocks of size 2^( 3) =       0.001498469420
  error estimate for blocks of size 2^( 4) =       0.001543030220
  error estimate for blocks of size 2^( 5) =       0.001565374905
  error estimate for blocks of size 2^( 6) =       0.001569910723
  error estimate for blocks of size 2^( 7) =       0.001577040378

      target function =                  N/A
              le_mean =     -22.327292930716
             les_mean =     502.179735722502
             stat err =       0.001563839056
             autocorr =       1.315397297379
              std dev =       1.928348521154
             le_variance =       3.718528019036

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00123484
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719429993693
                                         uncertainty =       0.023099634378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.719429993693
                                         uncertainty =       0.023099634378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363501553
  error estimate for blocks of size 2^( 2) =       0.001434694043
  error estimate for blocks of size 2^( 3) =       0.001498440378
  error estimate for blocks of size 2^( 4) =       0.001542998541
  error estimate for blocks of size 2^( 5) =       0.001565313123
  error estimate for blocks of size 2^( 6) =       0.001569839380
  error estimate for blocks of size 2^( 7) =       0.001576908277

      target function =                  N/A
              le_mean =     -22.327277564038
             les_mean =     502.176920454379
             stat err =       0.001563764830
             autocorr =       1.315320561059
              std dev =       1.928313241036
             le_variance =       3.718391955557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327293690504        initial  <--
     5.9605e-02     5.9605e-01             2.1602e-03       -22.327286809692
     2.3842e-01     2.3842e+00             1.0089e-03       -22.327292930716
     9.5367e-01     9.5367e+00             3.5863e-04       -22.327277564038

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8088
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -6.916874e-01 3 1  ON 0
ci_002                -7.089696e-01 3 1  ON 1
ci_003                -6.075324e-02 3 1  ON 2
ci_004                -6.161019e-02 3 1  ON 3
ci_005                 4.521609e-02 3 1  ON 4
ci_006                 4.601392e-02 3 1  ON 5
ci_007                 3.131314e-02 3 1  ON 6
ci_008                 3.245401e-02 3 1  ON 7
ci_009                -2.510478e-02 3 1  ON 8
ci_010                -2.584105e-02 3 1  ON 9
ci_011                -2.200159e-02 3 1  ON 10
ci_012                -2.313833e-02 3 1  ON 11
ci_013                 2.060091e-02 3 1  ON 12
ci_014                 2.095309e-02 3 1  ON 13
ci_015                 2.073950e-02 3 1  ON 14
ci_016                 2.110825e-02 3 1  ON 15
ci_017                 1.542388e-02 3 1  ON 16
ci_018                 1.615126e-02 3 1  ON 17
ci_019                 1.038414e-02 3 1  ON 18
ci_020                 9.215432e-03 3 1  ON 19
ci_021                -9.887012e-03 3 1  ON 20
ci_022                -1.062091e-02 3 1  ON 21
ci_023                 8.054225e-03 3 1  ON 22
ci_024                 8.658848e-03 3 1  ON 23
ci_025                 7.965742e-03 3 1  ON 24
ci_026                 9.110636e-03 3 1  ON 25
ci_027                 7.539466e-03 3 1  ON 26
ci_028                 7.767346e-03 3 1  ON 27
ci_029                -7.967249e-03 3 1  ON 28
ci_030                -7.800326e-03 3 1  ON 29
ci_031                -6.862883e-03 3 1  ON 30
ci_032                -7.050153e-03 3 1  ON 31
ci_033                 6.466844e-03 3 1  ON 32
ci_034                 6.493871e-03 3 1  ON 33
ci_035                 6.803658e-03 3 1  ON 34
ci_036                 6.635749e-03 3 1  ON 35
ci_037                 6.793436e-03 3 1  ON 36
ci_038                 6.164390e-03 3 1  ON 37
ci_039                 5.478910e-03 3 1  ON 38
ci_040                 5.293943e-03 3 1  ON 39
ci_041                 4.940294e-03 3 1  ON 40
ci_042                 4.754106e-03 3 1  ON 41
ci_043                 4.432208e-03 3 1  ON 42
ci_044                 5.307672e-03 3 1  ON 43
ci_045                 4.504256e-03 3 1  ON 44
ci_046                 5.962965e-03 3 1  ON 45
ci_047                -3.749986e-03 3 1  ON 46
ci_048                -4.191644e-03 3 1  ON 47
ci_049                 2.762590e-03 3 1  ON 48
ci_050                 3.626661e-03 3 1  ON 49
ci_051                -3.031353e-03 3 1  ON 50
ci_052                -2.878194e-03 3 1  ON 51
ci_053                -2.558891e-03 3 1  ON 52
ci_054                -2.437710e-03 3 1  ON 53
ci_055                -2.820411e-03 3 1  ON 54
ci_056                -2.249878e-03 3 1  ON 55
ci_057                -2.391077e-03 3 1  ON 56
ci_058                -1.528963e-03 3 1  ON 57
ci_059                -1.996234e-03 3 1  ON 58
ci_060                -2.044762e-03 3 1  ON 59
ci_061                -1.470446e-03 3 1  ON 60
ci_062                -1.167913e-03 3 1  ON 61
ci_063                -2.069056e-03 3 1  ON 62
ci_064                -1.681054e-03 3 1  ON 63
ci_065                -1.398116e-03 3 1  ON 64
ci_066                -1.462822e-03 3 1  ON 65
ci_067                -1.004924e-03 3 1  ON 66
ci_068                -1.247121e-03 3 1  ON 67
ci_069                 1.479824e-04 3 1  ON 68
ci_070                 1.728307e-03 3 1  ON 69
ci_071                -1.217676e-03 3 1  ON 70
ci_072                -9.750226e-04 3 1  ON 71
ci_073                 8.324134e-04 3 1  ON 72
ci_074                 1.435818e-03 3 1  ON 73
ci_075                -1.248152e-03 3 1  ON 74
ci_076                -5.127549e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6118e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2312e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6354
    reference variance = 1.90317
====================================================
  Execution time = 2.4187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0313e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6417e+00
  Total weights = 1.949938309e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9628e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.692823032577
                                         uncertainty =       0.020393016576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.692823032577
                                         uncertainty =       0.020393016576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001358726547
  error estimate for blocks of size 2^( 2) =       0.001430438258
  error estimate for blocks of size 2^( 3) =       0.001492391926
  error estimate for blocks of size 2^( 4) =       0.001537016424
  error estimate for blocks of size 2^( 5) =       0.001564846414
  error estimate for blocks of size 2^( 6) =       0.001582611761
  error estimate for blocks of size 2^( 7) =       0.001589499780

      target function =                  N/A
              le_mean =     -22.329983609886
             les_mean =     502.269885836396
             stat err =       0.001568493595
             autocorr =       1.332604813541
              std dev =       1.921560254081
             le_variance =       3.692393810065


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232998360989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329983609104       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330010873758       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330011389301       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330011406005       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 5.288642e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329983609104       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329992038713       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329992087554       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.783307e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329983609104       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329985849059       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329985857450       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+00 is 4.898806e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080036 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0160e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -6.917513e-01 3 1  ON 0
ci_002                -7.089164e-01 3 1  ON 1
ci_003                -6.072937e-02 3 1  ON 2
ci_004                -6.164413e-02 3 1  ON 3
ci_005                 4.516966e-02 3 1  ON 4
ci_006                 4.606278e-02 3 1  ON 5
ci_007                 3.130715e-02 3 1  ON 6
ci_008                 3.243413e-02 3 1  ON 7
ci_009                -2.513270e-02 3 1  ON 8
ci_010                -2.581238e-02 3 1  ON 9
ci_011                -2.197403e-02 3 1  ON 10
ci_012                -2.313962e-02 3 1  ON 11
ci_013                 2.044468e-02 3 1  ON 12
ci_014                 2.088263e-02 3 1  ON 13
ci_015                 2.062413e-02 3 1  ON 14
ci_016                 2.119980e-02 3 1  ON 15
ci_017                 1.541792e-02 3 1  ON 16
ci_018                 1.606769e-02 3 1  ON 17
ci_019                 1.044992e-02 3 1  ON 18
ci_020                 9.219911e-03 3 1  ON 19
ci_021                -9.745431e-03 3 1  ON 20
ci_022                -1.064565e-02 3 1  ON 21
ci_023                 8.160396e-03 3 1  ON 22
ci_024                 8.684057e-03 3 1  ON 23
ci_025                 7.960256e-03 3 1  ON 24
ci_026                 9.032177e-03 3 1  ON 25
ci_027                 7.583485e-03 3 1  ON 26
ci_028                 7.836532e-03 3 1  ON 27
ci_029                -7.986615e-03 3 1  ON 28
ci_030                -7.759652e-03 3 1  ON 29
ci_031                -6.935686e-03 3 1  ON 30
ci_032                -6.990318e-03 3 1  ON 31
ci_033                 6.612580e-03 3 1  ON 32
ci_034                 6.577788e-03 3 1  ON 33
ci_035                 6.728940e-03 3 1  ON 34
ci_036                 6.623521e-03 3 1  ON 35
ci_037                 6.780823e-03 3 1  ON 36
ci_038                 6.071118e-03 3 1  ON 37
ci_039                 5.507465e-03 3 1  ON 38
ci_040                 5.440566e-03 3 1  ON 39
ci_041                 4.894165e-03 3 1  ON 40
ci_042                 4.862558e-03 3 1  ON 41
ci_043                 4.447561e-03 3 1  ON 42
ci_044                 5.259503e-03 3 1  ON 43
ci_045                 4.463830e-03 3 1  ON 44
ci_046                 5.836289e-03 3 1  ON 45
ci_047                -3.928317e-03 3 1  ON 46
ci_048                -4.136218e-03 3 1  ON 47
ci_049                 2.748452e-03 3 1  ON 48
ci_050                 3.619841e-03 3 1  ON 49
ci_051                -2.973562e-03 3 1  ON 50
ci_052                -2.885968e-03 3 1  ON 51
ci_053                -2.627867e-03 3 1  ON 52
ci_054                -2.441237e-03 3 1  ON 53
ci_055                -2.822338e-03 3 1  ON 54
ci_056                -2.149298e-03 3 1  ON 55
ci_057                -2.380240e-03 3 1  ON 56
ci_058                -1.536344e-03 3 1  ON 57
ci_059                -1.908634e-03 3 1  ON 58
ci_060                -2.012773e-03 3 1  ON 59
ci_061                -1.580746e-03 3 1  ON 60
ci_062                -1.116423e-03 3 1  ON 61
ci_063                -2.073499e-03 3 1  ON 62
ci_064                -1.696438e-03 3 1  ON 63
ci_065                -1.428762e-03 3 1  ON 64
ci_066                -1.409196e-03 3 1  ON 65
ci_067                -1.002111e-03 3 1  ON 66
ci_068                -1.219063e-03 3 1  ON 67
ci_069                 2.078713e-04 3 1  ON 68
ci_070                 1.723812e-03 3 1  ON 69
ci_071                -1.155737e-03 3 1  ON 70
ci_072                -9.511768e-04 3 1  ON 71
ci_073                 8.910017e-04 3 1  ON 72
ci_074                 1.330787e-03 3 1  ON 73
ci_075                -1.152925e-03 3 1  ON 74
ci_076                -5.552291e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.5969
    reference variance = 2.76877
====================================================
  Execution time = 2.3722e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6876e+00
  Total weights = 1.9502e+06
  Execution time = 4.4058e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738030183437
                                         uncertainty =       0.042482600705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738030183437
                                         uncertainty =       0.042482600705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367274912
  error estimate for blocks of size 2^( 2) =       0.001439574559
  error estimate for blocks of size 2^( 3) =       0.001502517077
  error estimate for blocks of size 2^( 4) =       0.001545620599
  error estimate for blocks of size 2^( 5) =       0.001566907245
  error estimate for blocks of size 2^( 6) =       0.001578318107
  error estimate for blocks of size 2^( 7) =       0.001580709272

      target function =                  N/A
              le_mean =     -22.328200540318
             les_mean =     502.259895805614
             stat err =       0.001567888806
             autocorr =       1.314979034410
              std dev =       1.933649661939
             le_variance =       3.739001015118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737979084004
                                         uncertainty =       0.042481290781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737979084004
                                         uncertainty =       0.042481290781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367265757
  error estimate for blocks of size 2^( 2) =       0.001439569169
  error estimate for blocks of size 2^( 3) =       0.001502516082
  error estimate for blocks of size 2^( 4) =       0.001545627581
  error estimate for blocks of size 2^( 5) =       0.001566918589
  error estimate for blocks of size 2^( 6) =       0.001578318565
  error estimate for blocks of size 2^( 7) =       0.001580688049

      target function =                  N/A
              le_mean =     -22.328206035182
             les_mean =     502.236679434961
             stat err =       0.001567888196
             autocorr =       1.314995621709
              std dev =       1.933636714094
             le_variance =       3.738950942092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737990582292
                                         uncertainty =       0.042481757348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737990582292
                                         uncertainty =       0.042481757348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367267788
  error estimate for blocks of size 2^( 2) =       0.001439569666
  error estimate for blocks of size 2^( 3) =       0.001502514317
  error estimate for blocks of size 2^( 4) =       0.001545623542
  error estimate for blocks of size 2^( 5) =       0.001566912144
  error estimate for blocks of size 2^( 6) =       0.001578316371
  error estimate for blocks of size 2^( 7) =       0.001580692110

      target function =                  N/A
              le_mean =     -22.328201843487
             les_mean =     502.236291122093
             stat err =       0.001567886042
             autocorr =       1.314988101556
              std dev =       1.933639586632
             le_variance =       3.738962050992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738021463049
                                         uncertainty =       0.042482551644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738021463049
                                         uncertainty =       0.042482551644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367273333
  error estimate for blocks of size 2^( 2) =       0.001439573690
  error estimate for blocks of size 2^( 3) =       0.001502515951
  error estimate for blocks of size 2^( 4) =       0.001545620420
  error estimate for blocks of size 2^( 5) =       0.001566906232
  error estimate for blocks of size 2^( 6) =       0.001578317112
  error estimate for blocks of size 2^( 7) =       0.001580704300

      target function =                  N/A
              le_mean =     -22.328199660415
             les_mean =     502.236843613330
             stat err =       0.001567887016
             autocorr =       1.314979070728
              std dev =       1.933647427967
             le_variance =       3.738992375684


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328200540318        initial
     5.9605e-01     5.9605e+00             5.2886e-04       -22.328206035182  <--
     2.3842e+00     2.3842e+01             1.7833e-04       -22.328201843487
     9.5367e+00     9.5367e+01             4.8988e-05       -22.328199660415

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 4.5895e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -6.919351e-01 3 1  ON 0
ci_002                -7.087586e-01 3 1  ON 1
ci_003                -6.066772e-02 3 1  ON 2
ci_004                -6.173900e-02 3 1  ON 3
ci_005                 4.508256e-02 3 1  ON 4
ci_006                 4.615993e-02 3 1  ON 5
ci_007                 3.130420e-02 3 1  ON 6
ci_008                 3.238197e-02 3 1  ON 7
ci_009                -2.521871e-02 3 1  ON 8
ci_010                -2.573551e-02 3 1  ON 9
ci_011                -2.191506e-02 3 1  ON 10
ci_012                -2.314061e-02 3 1  ON 11
ci_013                 2.007205e-02 3 1  ON 12
ci_014                 2.069926e-02 3 1  ON 13
ci_015                 2.033937e-02 3 1  ON 14
ci_016                 2.143553e-02 3 1  ON 15
ci_017                 1.540556e-02 3 1  ON 16
ci_018                 1.587433e-02 3 1  ON 17
ci_019                 1.059925e-02 3 1  ON 18
ci_020                 9.239612e-03 3 1  ON 19
ci_021                -9.399510e-03 3 1  ON 20
ci_022                -1.070908e-02 3 1  ON 21
ci_023                 8.399909e-03 3 1  ON 22
ci_024                 8.735056e-03 3 1  ON 23
ci_025                 7.945584e-03 3 1  ON 24
ci_026                 8.841678e-03 3 1  ON 25
ci_027                 7.670466e-03 3 1  ON 26
ci_028                 7.966856e-03 3 1  ON 27
ci_029                -8.037125e-03 3 1  ON 28
ci_030                -7.669677e-03 3 1  ON 29
ci_031                -7.123155e-03 3 1  ON 30
ci_032                -6.842283e-03 3 1  ON 31
ci_033                 6.964130e-03 3 1  ON 32
ci_034                 6.789048e-03 3 1  ON 33
ci_035                 6.568991e-03 3 1  ON 34
ci_036                 6.602118e-03 3 1  ON 35
ci_037                 6.743391e-03 3 1  ON 36
ci_038                 5.844890e-03 3 1  ON 37
ci_039                 5.560624e-03 3 1  ON 38
ci_040                 5.724525e-03 3 1  ON 39
ci_041                 4.792930e-03 3 1  ON 40
ci_042                 5.092837e-03 3 1  ON 41
ci_043                 4.475622e-03 3 1  ON 42
ci_044                 5.154125e-03 3 1  ON 43
ci_045                 4.359331e-03 3 1  ON 44
ci_046                 5.539316e-03 3 1  ON 45
ci_047                -4.276182e-03 3 1  ON 46
ci_048                -4.023439e-03 3 1  ON 47
ci_049                 2.717465e-03 3 1  ON 48
ci_050                 3.602038e-03 3 1  ON 49
ci_051                -2.844356e-03 3 1  ON 50
ci_052                -2.900431e-03 3 1  ON 51
ci_053                -2.795501e-03 3 1  ON 52
ci_054                -2.453198e-03 3 1  ON 53
ci_055                -2.832848e-03 3 1  ON 54
ci_056                -1.897925e-03 3 1  ON 55
ci_057                -2.354640e-03 3 1  ON 56
ci_058                -1.554125e-03 3 1  ON 57
ci_059                -1.735151e-03 3 1  ON 58
ci_060                -1.939591e-03 3 1  ON 59
ci_061                -1.833883e-03 3 1  ON 60
ci_062                -9.990874e-04 3 1  ON 61
ci_063                -2.090815e-03 3 1  ON 62
ci_064                -1.733004e-03 3 1  ON 63
ci_065                -1.506413e-03 3 1  ON 64
ci_066                -1.288777e-03 3 1  ON 65
ci_067                -9.942309e-04 3 1  ON 66
ci_068                -1.165425e-03 3 1  ON 67
ci_069                 3.530921e-04 3 1  ON 68
ci_070                 1.709335e-03 3 1  ON 69
ci_071                -1.021264e-03 3 1  ON 70
ci_072                -8.935301e-04 3 1  ON 71
ci_073                 1.007021e-03 3 1  ON 72
ci_074                 1.114758e-03 3 1  ON 73
ci_075                -9.376448e-04 3 1  ON 74
ci_076                -6.498112e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6072e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2324e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.4449
    reference variance = 2.59386
====================================================
  Execution time = 2.4356e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0306e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8840e+00
  Total weights = 1.949766288e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9396e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.939552521702
                                         uncertainty =       0.127896892553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.939552521702
                                         uncertainty =       0.127896892553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001403309687
  error estimate for blocks of size 2^( 2) =       0.001472783173
  error estimate for blocks of size 2^( 3) =       0.001534316235
  error estimate for blocks of size 2^( 4) =       0.001578883109
  error estimate for blocks of size 2^( 5) =       0.001603125264
  error estimate for blocks of size 2^( 6) =       0.001612213183
  error estimate for blocks of size 2^( 7) =       0.001622822786

      target function =                  N/A
              le_mean =     -22.326934637157
             les_mean =     502.376018478045
             stat err =       0.001604261086
             autocorr =       1.306902088468
              std dev =       1.984611343975
             le_variance =       3.938682186634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232693463716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326934636350       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327004877598       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327009845128       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327008845427       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327008982384       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e-01 is 1.678655e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326934636350       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326964998267       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326965662408       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326965570979       residual = 4.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e-01 is 6.009845e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326934636350       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326943918479       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326943987207       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+00 is 1.754639e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083517 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0307e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -6.919632e-01 3 1  ON 0
ci_002                -7.086723e-01 3 1  ON 1
ci_003                -6.119300e-02 3 1  ON 2
ci_004                -6.200187e-02 3 1  ON 3
ci_005                 4.481770e-02 3 1  ON 4
ci_006                 4.614597e-02 3 1  ON 5
ci_007                 3.145590e-02 3 1  ON 6
ci_008                 3.253261e-02 3 1  ON 7
ci_009                -2.542887e-02 3 1  ON 8
ci_010                -2.546546e-02 3 1  ON 9
ci_011                -2.188101e-02 3 1  ON 10
ci_012                -2.314780e-02 3 1  ON 11
ci_013                 2.017801e-02 3 1  ON 12
ci_014                 2.060111e-02 3 1  ON 13
ci_015                 2.003299e-02 3 1  ON 14
ci_016                 2.118850e-02 3 1  ON 15
ci_017                 1.521215e-02 3 1  ON 16
ci_018                 1.587277e-02 3 1  ON 17
ci_019                 1.037517e-02 3 1  ON 18
ci_020                 9.413713e-03 3 1  ON 19
ci_021                -9.329031e-03 3 1  ON 20
ci_022                -1.070739e-02 3 1  ON 21
ci_023                 8.360160e-03 3 1  ON 22
ci_024                 8.845185e-03 3 1  ON 23
ci_025                 7.827914e-03 3 1  ON 24
ci_026                 9.019582e-03 3 1  ON 25
ci_027                 7.651158e-03 3 1  ON 26
ci_028                 8.375475e-03 3 1  ON 27
ci_029                -7.743004e-03 3 1  ON 28
ci_030                -7.632568e-03 3 1  ON 29
ci_031                -7.503374e-03 3 1  ON 30
ci_032                -7.443267e-03 3 1  ON 31
ci_033                 6.670344e-03 3 1  ON 32
ci_034                 6.986448e-03 3 1  ON 33
ci_035                 6.481187e-03 3 1  ON 34
ci_036                 6.627601e-03 3 1  ON 35
ci_037                 6.602410e-03 3 1  ON 36
ci_038                 6.018291e-03 3 1  ON 37
ci_039                 5.361533e-03 3 1  ON 38
ci_040                 6.231168e-03 3 1  ON 39
ci_041                 4.846537e-03 3 1  ON 40
ci_042                 5.088692e-03 3 1  ON 41
ci_043                 4.990047e-03 3 1  ON 42
ci_044                 5.309937e-03 3 1  ON 43
ci_045                 4.673697e-03 3 1  ON 44
ci_046                 5.433742e-03 3 1  ON 45
ci_047                -4.392961e-03 3 1  ON 46
ci_048                -4.475291e-03 3 1  ON 47
ci_049                 2.875638e-03 3 1  ON 48
ci_050                 3.577256e-03 3 1  ON 49
ci_051                -2.762927e-03 3 1  ON 50
ci_052                -2.894111e-03 3 1  ON 51
ci_053                -3.001881e-03 3 1  ON 52
ci_054                -2.353247e-03 3 1  ON 53
ci_055                -2.351447e-03 3 1  ON 54
ci_056                -2.201648e-03 3 1  ON 55
ci_057                -2.375091e-03 3 1  ON 56
ci_058                -1.566106e-03 3 1  ON 57
ci_059                -1.818731e-03 3 1  ON 58
ci_060                -1.721537e-03 3 1  ON 59
ci_061                -1.293153e-03 3 1  ON 60
ci_062                -8.900334e-04 3 1  ON 61
ci_063                -1.850570e-03 3 1  ON 62
ci_064                -2.032851e-03 3 1  ON 63
ci_065                -1.404791e-03 3 1  ON 64
ci_066                -1.188236e-03 3 1  ON 65
ci_067                -1.032866e-03 3 1  ON 66
ci_068                -1.449041e-03 3 1  ON 67
ci_069                 8.898702e-04 3 1  ON 68
ci_070                 1.756663e-03 3 1  ON 69
ci_071                -5.275277e-04 3 1  ON 70
ci_072                -1.240084e-03 3 1  ON 71
ci_073                 9.916661e-04 3 1  ON 72
ci_074                 1.155277e-03 3 1  ON 73
ci_075                -1.343568e-03 3 1  ON 74
ci_076                -6.710205e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.3934
    reference variance = 3.48234
====================================================
  Execution time = 2.3732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.6710e+00
  Total weights = 1.9498e+06
  Execution time = 4.4024e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722976846470
                                         uncertainty =       0.025723914703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722976846470
                                         uncertainty =       0.025723914703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364141811
  error estimate for blocks of size 2^( 2) =       0.001435049903
  error estimate for blocks of size 2^( 3) =       0.001497741804
  error estimate for blocks of size 2^( 4) =       0.001540427587
  error estimate for blocks of size 2^( 5) =       0.001565367074
  error estimate for blocks of size 2^( 6) =       0.001576177331
  error estimate for blocks of size 2^( 7) =       0.001583612203

      target function =                  N/A
              le_mean =     -22.330771630761
             les_mean =     502.339810554765
             stat err =       0.001566396049
             autocorr =       1.318512093015
              std dev =       1.929218716568
             le_variance =       3.721884856358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.723087984285
                                         uncertainty =       0.025709093517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.723087984285
                                         uncertainty =       0.025709093517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364162584
  error estimate for blocks of size 2^( 2) =       0.001435055438
  error estimate for blocks of size 2^( 3) =       0.001497727728
  error estimate for blocks of size 2^( 4) =       0.001540388059
  error estimate for blocks of size 2^( 5) =       0.001565326565
  error estimate for blocks of size 2^( 6) =       0.001576110283
  error estimate for blocks of size 2^( 7) =       0.001583533917

      target function =                  N/A
              le_mean =     -22.330770819676
             les_mean =     502.349236833262
             stat err =       0.001566339706
             autocorr =       1.318377090280
              std dev =       1.929248094537
             le_variance =       3.721998210273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.723017271038
                                         uncertainty =       0.025715790236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.723017271038
                                         uncertainty =       0.025715790236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364149549
  error estimate for blocks of size 2^( 2) =       0.001435054682
  error estimate for blocks of size 2^( 3) =       0.001497740428
  error estimate for blocks of size 2^( 4) =       0.001540406637
  error estimate for blocks of size 2^( 5) =       0.001565335213
  error estimate for blocks of size 2^( 6) =       0.001576115465
  error estimate for blocks of size 2^( 7) =       0.001583547445

      target function =                  N/A
              le_mean =     -22.330759774358
             les_mean =     502.343089109419
             stat err =       0.001566351190
             autocorr =       1.318421617256
              std dev =       1.929229659903
             le_variance =       3.721927080649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722954793531
                                         uncertainty =       0.025722496927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722954793531
                                         uncertainty =       0.025722496927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364137825
  error estimate for blocks of size 2^( 2) =       0.001435045411
  error estimate for blocks of size 2^( 3) =       0.001497737522
  error estimate for blocks of size 2^( 4) =       0.001540418145
  error estimate for blocks of size 2^( 5) =       0.001565356340
  error estimate for blocks of size 2^( 6) =       0.001576162575
  error estimate for blocks of size 2^( 7) =       0.001583611592

      target function =                  N/A
              le_mean =     -22.330765697764
             les_mean =     502.334746793147
             stat err =       0.001566387163
             autocorr =       1.318504838041
              std dev =       1.929213080421
             le_variance =       3.721863109667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330771630761        initial  <--
     1.4901e-01     1.4901e+00             1.6787e-03       -22.330770819676
     5.9605e-01     5.9605e+00             6.0098e-04       -22.330759774358
     2.3842e+00     2.3842e+01             1.7546e-04       -22.330765697764

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8745
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -6.919351e-01 3 1  ON 0
ci_002                -7.087586e-01 3 1  ON 1
ci_003                -6.066772e-02 3 1  ON 2
ci_004                -6.173900e-02 3 1  ON 3
ci_005                 4.508256e-02 3 1  ON 4
ci_006                 4.615993e-02 3 1  ON 5
ci_007                 3.130420e-02 3 1  ON 6
ci_008                 3.238197e-02 3 1  ON 7
ci_009                -2.521871e-02 3 1  ON 8
ci_010                -2.573551e-02 3 1  ON 9
ci_011                -2.191506e-02 3 1  ON 10
ci_012                -2.314061e-02 3 1  ON 11
ci_013                 2.007205e-02 3 1  ON 12
ci_014                 2.069926e-02 3 1  ON 13
ci_015                 2.033937e-02 3 1  ON 14
ci_016                 2.143553e-02 3 1  ON 15
ci_017                 1.540556e-02 3 1  ON 16
ci_018                 1.587433e-02 3 1  ON 17
ci_019                 1.059925e-02 3 1  ON 18
ci_020                 9.239612e-03 3 1  ON 19
ci_021                -9.399510e-03 3 1  ON 20
ci_022                -1.070908e-02 3 1  ON 21
ci_023                 8.399909e-03 3 1  ON 22
ci_024                 8.735056e-03 3 1  ON 23
ci_025                 7.945584e-03 3 1  ON 24
ci_026                 8.841678e-03 3 1  ON 25
ci_027                 7.670466e-03 3 1  ON 26
ci_028                 7.966856e-03 3 1  ON 27
ci_029                -8.037125e-03 3 1  ON 28
ci_030                -7.669677e-03 3 1  ON 29
ci_031                -7.123155e-03 3 1  ON 30
ci_032                -6.842283e-03 3 1  ON 31
ci_033                 6.964130e-03 3 1  ON 32
ci_034                 6.789048e-03 3 1  ON 33
ci_035                 6.568991e-03 3 1  ON 34
ci_036                 6.602118e-03 3 1  ON 35
ci_037                 6.743391e-03 3 1  ON 36
ci_038                 5.844890e-03 3 1  ON 37
ci_039                 5.560624e-03 3 1  ON 38
ci_040                 5.724525e-03 3 1  ON 39
ci_041                 4.792930e-03 3 1  ON 40
ci_042                 5.092837e-03 3 1  ON 41
ci_043                 4.475622e-03 3 1  ON 42
ci_044                 5.154125e-03 3 1  ON 43
ci_045                 4.359331e-03 3 1  ON 44
ci_046                 5.539316e-03 3 1  ON 45
ci_047                -4.276182e-03 3 1  ON 46
ci_048                -4.023439e-03 3 1  ON 47
ci_049                 2.717465e-03 3 1  ON 48
ci_050                 3.602038e-03 3 1  ON 49
ci_051                -2.844356e-03 3 1  ON 50
ci_052                -2.900431e-03 3 1  ON 51
ci_053                -2.795501e-03 3 1  ON 52
ci_054                -2.453198e-03 3 1  ON 53
ci_055                -2.832848e-03 3 1  ON 54
ci_056                -1.897925e-03 3 1  ON 55
ci_057                -2.354640e-03 3 1  ON 56
ci_058                -1.554125e-03 3 1  ON 57
ci_059                -1.735151e-03 3 1  ON 58
ci_060                -1.939591e-03 3 1  ON 59
ci_061                -1.833883e-03 3 1  ON 60
ci_062                -9.990874e-04 3 1  ON 61
ci_063                -2.090815e-03 3 1  ON 62
ci_064                -1.733004e-03 3 1  ON 63
ci_065                -1.506413e-03 3 1  ON 64
ci_066                -1.288777e-03 3 1  ON 65
ci_067                -9.942309e-04 3 1  ON 66
ci_068                -1.165425e-03 3 1  ON 67
ci_069                 3.530921e-04 3 1  ON 68
ci_070                 1.709335e-03 3 1  ON 69
ci_071                -1.021264e-03 3 1  ON 70
ci_072                -8.935301e-04 3 1  ON 71
ci_073                 1.007021e-03 3 1  ON 72
ci_074                 1.114758e-03 3 1  ON 73
ci_075                -9.376448e-04 3 1  ON 74
ci_076                -6.498112e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6196e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2328e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -21.9969
    reference variance = 4.05806
====================================================
  Execution time = 2.4342e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0307e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.6948e+00
  Total weights = 1.949972232e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9356e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746150025311
                                         uncertainty =       0.026748146777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746150025311
                                         uncertainty =       0.026748146777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368538050
  error estimate for blocks of size 2^( 2) =       0.001440124681
  error estimate for blocks of size 2^( 3) =       0.001503536634
  error estimate for blocks of size 2^( 4) =       0.001547938398
  error estimate for blocks of size 2^( 5) =       0.001568930616
  error estimate for blocks of size 2^( 6) =       0.001578875664
  error estimate for blocks of size 2^( 7) =       0.001590761516

      target function =                  N/A
              le_mean =     -22.325864686909
             les_mean =     502.139052364365
             stat err =       0.001571626548
             autocorr =       1.318818283219
              std dev =       1.935436037143
             le_variance =       3.745912653872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232586468691e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325864686096       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325877014525       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325877157617       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+00 is 2.428072e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325864686096       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325868027132       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325868057105       residual = 5.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+00 is 6.546868e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325864686096       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325865539274       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325865546596       residual = 5.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+01 is 1.670022e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0288e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -6.919688e-01 3 1  ON 0
ci_002                -7.087261e-01 3 1  ON 1
ci_003                -6.071494e-02 3 1  ON 2
ci_004                -6.174350e-02 3 1  ON 3
ci_005                 4.509235e-02 3 1  ON 4
ci_006                 4.618049e-02 3 1  ON 5
ci_007                 3.127649e-02 3 1  ON 6
ci_008                 3.234868e-02 3 1  ON 7
ci_009                -2.515324e-02 3 1  ON 8
ci_010                -2.568106e-02 3 1  ON 9
ci_011                -2.193775e-02 3 1  ON 10
ci_012                -2.314249e-02 3 1  ON 11
ci_013                 2.011025e-02 3 1  ON 12
ci_014                 2.074395e-02 3 1  ON 13
ci_015                 2.031025e-02 3 1  ON 14
ci_016                 2.140758e-02 3 1  ON 15
ci_017                 1.539370e-02 3 1  ON 16
ci_018                 1.585108e-02 3 1  ON 17
ci_019                 1.059995e-02 3 1  ON 18
ci_020                 9.219760e-03 3 1  ON 19
ci_021                -9.424375e-03 3 1  ON 20
ci_022                -1.070923e-02 3 1  ON 21
ci_023                 8.402343e-03 3 1  ON 22
ci_024                 8.713919e-03 3 1  ON 23
ci_025                 7.951521e-03 3 1  ON 24
ci_026                 8.813665e-03 3 1  ON 25
ci_027                 7.664601e-03 3 1  ON 26
ci_028                 7.948653e-03 3 1  ON 27
ci_029                -8.053322e-03 3 1  ON 28
ci_030                -7.660011e-03 3 1  ON 29
ci_031                -7.147632e-03 3 1  ON 30
ci_032                -6.847420e-03 3 1  ON 31
ci_033                 6.965020e-03 3 1  ON 32
ci_034                 6.736693e-03 3 1  ON 33
ci_035                 6.579985e-03 3 1  ON 34
ci_036                 6.648542e-03 3 1  ON 35
ci_037                 6.691593e-03 3 1  ON 36
ci_038                 5.892084e-03 3 1  ON 37
ci_039                 5.590666e-03 3 1  ON 38
ci_040                 5.737905e-03 3 1  ON 39
ci_041                 4.799442e-03 3 1  ON 40
ci_042                 5.137360e-03 3 1  ON 41
ci_043                 4.462751e-03 3 1  ON 42
ci_044                 5.145755e-03 3 1  ON 43
ci_045                 4.363678e-03 3 1  ON 44
ci_046                 5.530683e-03 3 1  ON 45
ci_047                -4.244221e-03 3 1  ON 46
ci_048                -4.038602e-03 3 1  ON 47
ci_049                 2.748634e-03 3 1  ON 48
ci_050                 3.611493e-03 3 1  ON 49
ci_051                -2.825859e-03 3 1  ON 50
ci_052                -2.895741e-03 3 1  ON 51
ci_053                -2.800368e-03 3 1  ON 52
ci_054                -2.416196e-03 3 1  ON 53
ci_055                -2.813794e-03 3 1  ON 54
ci_056                -1.913337e-03 3 1  ON 55
ci_057                -2.327599e-03 3 1  ON 56
ci_058                -1.579502e-03 3 1  ON 57
ci_059                -1.714196e-03 3 1  ON 58
ci_060                -1.919687e-03 3 1  ON 59
ci_061                -1.788905e-03 3 1  ON 60
ci_062                -1.033040e-03 3 1  ON 61
ci_063                -2.046152e-03 3 1  ON 62
ci_064                -1.701430e-03 3 1  ON 63
ci_065                -1.499771e-03 3 1  ON 64
ci_066                -1.288991e-03 3 1  ON 65
ci_067                -1.019693e-03 3 1  ON 66
ci_068                -1.166719e-03 3 1  ON 67
ci_069                 3.774409e-04 3 1  ON 68
ci_070                 1.670817e-03 3 1  ON 69
ci_071                -1.000624e-03 3 1  ON 70
ci_072                -9.013660e-04 3 1  ON 71
ci_073                 9.941120e-04 3 1  ON 72
ci_074                 1.119502e-03 3 1  ON 73
ci_075                -9.754983e-04 3 1  ON 74
ci_076                -6.067787e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.456
    reference variance = 1.9595
====================================================
  Execution time = 2.3726e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.6805e+00
  Total weights = 1.9499e+06
  Execution time = 4.3947e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730706124119
                                         uncertainty =       0.026095771113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730706124119
                                         uncertainty =       0.026095771113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365777309
  error estimate for blocks of size 2^( 2) =       0.001438370313
  error estimate for blocks of size 2^( 3) =       0.001501309055
  error estimate for blocks of size 2^( 4) =       0.001544748516
  error estimate for blocks of size 2^( 5) =       0.001570623396
  error estimate for blocks of size 2^( 6) =       0.001583043997
  error estimate for blocks of size 2^( 7) =       0.001592193915

      target function =                  N/A
              le_mean =     -22.326247410450
             les_mean =     502.141860309233
             stat err =       0.001572652456
             autocorr =       1.325884608162
              std dev =       1.931531697126
             le_variance =       3.730814697003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730703439736
                                         uncertainty =       0.026096631147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730703439736
                                         uncertainty =       0.026096631147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365776806
  error estimate for blocks of size 2^( 2) =       0.001438371331
  error estimate for blocks of size 2^( 3) =       0.001501308231
  error estimate for blocks of size 2^( 4) =       0.001544748010
  error estimate for blocks of size 2^( 5) =       0.001570624394
  error estimate for blocks of size 2^( 6) =       0.001583040705
  error estimate for blocks of size 2^( 7) =       0.001592194893

      target function =                  N/A
              le_mean =     -22.326247632164
             les_mean =     502.141894485848
             stat err =       0.001572652000
             autocorr =       1.325884816183
              std dev =       1.931530985728
             le_variance =       3.730811948829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730703345305
                                         uncertainty =       0.026096244028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730703345305
                                         uncertainty =       0.026096244028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365776794
  error estimate for blocks of size 2^( 2) =       0.001438370708
  error estimate for blocks of size 2^( 3) =       0.001501308473
  error estimate for blocks of size 2^( 4) =       0.001544747977
  error estimate for blocks of size 2^( 5) =       0.001570623495
  error estimate for blocks of size 2^( 6) =       0.001583041742
  error estimate for blocks of size 2^( 7) =       0.001592193591

      target function =                  N/A
              le_mean =     -22.326247227355
             les_mean =     502.141937132748
             stat err =       0.001572651701
             autocorr =       1.325884335341
              std dev =       1.931530968835
             le_variance =       3.730811883568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730705578147
                                         uncertainty =       0.026095832174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730705578147
                                         uncertainty =       0.026095832174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365777208
  error estimate for blocks of size 2^( 2) =       0.001438370325
  error estimate for blocks of size 2^( 3) =       0.001501308949
  error estimate for blocks of size 2^( 4) =       0.001544748400
  error estimate for blocks of size 2^( 5) =       0.001570623368
  error estimate for blocks of size 2^( 6) =       0.001583043665
  error estimate for blocks of size 2^( 7) =       0.001592193811

      target function =                  N/A
              le_mean =     -22.326247359073
             les_mean =     502.141844474328
             stat err =       0.001572652311
             autocorr =       1.325884559060
              std dev =       1.931531554672
             le_variance =       3.730814146693


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326247410450        initial
     1.4901e+00     1.4901e+01             2.4281e-04       -22.326247632164  <--
     5.9605e+00     5.9605e+01             6.5469e-05       -22.326247227355
     2.3842e+01     2.3842e+02             1.6700e-05       -22.326247359073

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 4.5833e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -6.920689e-01 3 1  ON 0
ci_002                -7.086292e-01 3 1  ON 1
ci_003                -6.085092e-02 3 1  ON 2
ci_004                -6.175726e-02 3 1  ON 3
ci_005                 4.511908e-02 3 1  ON 4
ci_006                 4.623299e-02 3 1  ON 5
ci_007                 3.120172e-02 3 1  ON 6
ci_008                 3.226059e-02 3 1  ON 7
ci_009                -2.497590e-02 3 1  ON 8
ci_010                -2.553433e-02 3 1  ON 9
ci_011                -2.199781e-02 3 1  ON 10
ci_012                -2.314734e-02 3 1  ON 11
ci_013                 2.021208e-02 3 1  ON 12
ci_014                 2.086848e-02 3 1  ON 13
ci_015                 2.022957e-02 3 1  ON 14
ci_016                 2.133004e-02 3 1  ON 15
ci_017                 1.536192e-02 3 1  ON 16
ci_018                 1.578831e-02 3 1  ON 17
ci_019                 1.060257e-02 3 1  ON 18
ci_020                 9.164979e-03 3 1  ON 19
ci_021                -9.493478e-03 3 1  ON 20
ci_022                -1.070989e-02 3 1  ON 21
ci_023                 8.408501e-03 3 1  ON 22
ci_024                 8.657545e-03 3 1  ON 23
ci_025                 7.967232e-03 3 1  ON 24
ci_026                 8.737829e-03 3 1  ON 25
ci_027                 7.650353e-03 3 1  ON 26
ci_028                 7.902609e-03 3 1  ON 27
ci_029                -8.095312e-03 3 1  ON 28
ci_030                -7.631526e-03 3 1  ON 29
ci_031                -7.214052e-03 3 1  ON 30
ci_032                -6.861586e-03 3 1  ON 31
ci_033                 6.967386e-03 3 1  ON 32
ci_034                 6.594182e-03 3 1  ON 33
ci_035                 6.610270e-03 3 1  ON 34
ci_036                 6.764279e-03 3 1  ON 35
ci_037                 6.556762e-03 3 1  ON 36
ci_038                 6.020482e-03 3 1  ON 37
ci_039                 5.666198e-03 3 1  ON 38
ci_040                 5.770694e-03 3 1  ON 39
ci_041                 4.815683e-03 3 1  ON 40
ci_042                 5.252379e-03 3 1  ON 41
ci_043                 4.429306e-03 3 1  ON 42
ci_044                 5.121576e-03 3 1  ON 43
ci_045                 4.374674e-03 3 1  ON 44
ci_046                 5.509902e-03 3 1  ON 45
ci_047                -4.161243e-03 3 1  ON 46
ci_048                -4.073324e-03 3 1  ON 47
ci_049                 2.833241e-03 3 1  ON 48
ci_050                 3.636412e-03 3 1  ON 49
ci_051                -2.776166e-03 3 1  ON 50
ci_052                -2.880389e-03 3 1  ON 51
ci_053                -2.813854e-03 3 1  ON 52
ci_054                -2.315924e-03 3 1  ON 53
ci_055                -2.758735e-03 3 1  ON 54
ci_056                -1.957812e-03 3 1  ON 55
ci_057                -2.255947e-03 3 1  ON 56
ci_058                -1.647427e-03 3 1  ON 57
ci_059                -1.661563e-03 3 1  ON 58
ci_060                -1.869460e-03 3 1  ON 59
ci_061                -1.667926e-03 3 1  ON 60
ci_062                -1.123746e-03 3 1  ON 61
ci_063                -1.925321e-03 3 1  ON 62
ci_064                -1.615053e-03 3 1  ON 63
ci_065                -1.480475e-03 3 1  ON 64
ci_066                -1.288408e-03 3 1  ON 65
ci_067                -1.089491e-03 3 1  ON 66
ci_068                -1.169586e-03 3 1  ON 67
ci_069                 4.431017e-04 3 1  ON 68
ci_070                 1.566519e-03 3 1  ON 69
ci_071                -9.443341e-04 3 1  ON 70
ci_072                -9.218720e-04 3 1  ON 71
ci_073                 9.604487e-04 3 1  ON 72
ci_074                 1.129974e-03 3 1  ON 73
ci_075                -1.076571e-03 3 1  ON 74
ci_076                -4.905331e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2324e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.088
    reference variance = 4.49072
====================================================
  Execution time = 2.4306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0337e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6606e+00
  Total weights = 1.950082408e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9534e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711029724036
                                         uncertainty =       0.024321696434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711029724036
                                         uncertainty =       0.024321696434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362056819
  error estimate for blocks of size 2^( 2) =       0.001434522297
  error estimate for blocks of size 2^( 3) =       0.001498571824
  error estimate for blocks of size 2^( 4) =       0.001540631735
  error estimate for blocks of size 2^( 5) =       0.001563898684
  error estimate for blocks of size 2^( 6) =       0.001575485751
  error estimate for blocks of size 2^( 7) =       0.001587800792

      target function =                  N/A
              le_mean =     -22.329558084337
             les_mean =     502.269757390202
             stat err =       0.001566954241
             autocorr =       1.323494614984
              std dev =       1.926270045551
             le_variance =       3.710516288386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232955808434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329558083530       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329576546582       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329577431241       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329577394886       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 7.333153e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329558083530       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329564331714       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329564442960       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+00 is 2.413935e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329558083530       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329559797080       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329559813721       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+00 is 6.564240e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089672 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0269e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -6.920919e-01 3 1  ON 0
ci_002                -7.086127e-01 3 1  ON 1
ci_003                -6.087889e-02 3 1  ON 2
ci_004                -6.188325e-02 3 1  ON 3
ci_005                 4.509572e-02 3 1  ON 4
ci_006                 4.607610e-02 3 1  ON 5
ci_007                 3.130901e-02 3 1  ON 6
ci_008                 3.231917e-02 3 1  ON 7
ci_009                -2.491992e-02 3 1  ON 8
ci_010                -2.543757e-02 3 1  ON 9
ci_011                -2.195259e-02 3 1  ON 10
ci_012                -2.302346e-02 3 1  ON 11
ci_013                 2.024049e-02 3 1  ON 12
ci_014                 2.088323e-02 3 1  ON 13
ci_015                 2.019964e-02 3 1  ON 14
ci_016                 2.127696e-02 3 1  ON 15
ci_017                 1.544687e-02 3 1  ON 16
ci_018                 1.575784e-02 3 1  ON 17
ci_019                 1.050750e-02 3 1  ON 18
ci_020                 9.131222e-03 3 1  ON 19
ci_021                -9.662179e-03 3 1  ON 20
ci_022                -1.073011e-02 3 1  ON 21
ci_023                 8.293802e-03 3 1  ON 22
ci_024                 8.698906e-03 3 1  ON 23
ci_025                 7.927903e-03 3 1  ON 24
ci_026                 8.693120e-03 3 1  ON 25
ci_027                 7.696143e-03 3 1  ON 26
ci_028                 8.045279e-03 3 1  ON 27
ci_029                -8.066758e-03 3 1  ON 28
ci_030                -7.555728e-03 3 1  ON 29
ci_031                -7.246054e-03 3 1  ON 30
ci_032                -7.021687e-03 3 1  ON 31
ci_033                 6.937005e-03 3 1  ON 32
ci_034                 6.510078e-03 3 1  ON 33
ci_035                 6.465574e-03 3 1  ON 34
ci_036                 6.663015e-03 3 1  ON 35
ci_037                 6.573702e-03 3 1  ON 36
ci_038                 5.942074e-03 3 1  ON 37
ci_039                 5.710583e-03 3 1  ON 38
ci_040                 5.708489e-03 3 1  ON 39
ci_041                 4.902588e-03 3 1  ON 40
ci_042                 5.263155e-03 3 1  ON 41
ci_043                 4.575166e-03 3 1  ON 42
ci_044                 5.190350e-03 3 1  ON 43
ci_045                 4.421593e-03 3 1  ON 44
ci_046                 5.390111e-03 3 1  ON 45
ci_047                -3.997737e-03 3 1  ON 46
ci_048                -4.093675e-03 3 1  ON 47
ci_049                 2.684554e-03 3 1  ON 48
ci_050                 3.622900e-03 3 1  ON 49
ci_051                -2.734708e-03 3 1  ON 50
ci_052                -2.790161e-03 3 1  ON 51
ci_053                -2.804143e-03 3 1  ON 52
ci_054                -2.418194e-03 3 1  ON 53
ci_055                -2.703192e-03 3 1  ON 54
ci_056                -1.942888e-03 3 1  ON 55
ci_057                -2.182517e-03 3 1  ON 56
ci_058                -1.770651e-03 3 1  ON 57
ci_059                -1.633363e-03 3 1  ON 58
ci_060                -1.830411e-03 3 1  ON 59
ci_061                -1.650303e-03 3 1  ON 60
ci_062                -1.031280e-03 3 1  ON 61
ci_063                -1.905642e-03 3 1  ON 62
ci_064                -1.504701e-03 3 1  ON 63
ci_065                -1.239082e-03 3 1  ON 64
ci_066                -1.240334e-03 3 1  ON 65
ci_067                -1.055810e-03 3 1  ON 66
ci_068                -1.322240e-03 3 1  ON 67
ci_069                 4.723129e-04 3 1  ON 68
ci_070                 1.462748e-03 3 1  ON 69
ci_071                -1.058297e-03 3 1  ON 70
ci_072                -8.923360e-04 3 1  ON 71
ci_073                 8.657646e-04 3 1  ON 72
ci_074                 1.164594e-03 3 1  ON 73
ci_075                -1.108913e-03 3 1  ON 74
ci_076                -5.187901e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.2615
    reference variance = 2.44651
====================================================
  Execution time = 2.3706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6805e+00
  Total weights = 1.9499e+06
  Execution time = 4.3936e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732109832454
                                         uncertainty =       0.031486077461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732109832454
                                         uncertainty =       0.031486077461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365922860
  error estimate for blocks of size 2^( 2) =       0.001437120215
  error estimate for blocks of size 2^( 3) =       0.001498580293
  error estimate for blocks of size 2^( 4) =       0.001541272875
  error estimate for blocks of size 2^( 5) =       0.001566841929
  error estimate for blocks of size 2^( 6) =       0.001577602649
  error estimate for blocks of size 2^( 7) =       0.001582272428

      target function =                  N/A
              le_mean =     -22.328599477109
             les_mean =     502.246870125993
             stat err =       0.001566997470
             autocorr =       1.316085922557
              std dev =       1.931737541303
             le_variance =       3.731609928478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732059462351
                                         uncertainty =       0.031484471020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732059462351
                                         uncertainty =       0.031484471020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365913561
  error estimate for blocks of size 2^( 2) =       0.001437121473
  error estimate for blocks of size 2^( 3) =       0.001498591947
  error estimate for blocks of size 2^( 4) =       0.001541287947
  error estimate for blocks of size 2^( 5) =       0.001566855624
  error estimate for blocks of size 2^( 6) =       0.001577602722
  error estimate for blocks of size 2^( 7) =       0.001582247630

      target function =                  N/A
              le_mean =     -22.328600846572
             les_mean =     502.249260529488
             stat err =       0.001566998481
             autocorr =       1.316105539625
              std dev =       1.931724390126
             le_variance =       3.731559119408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732059606010
                                         uncertainty =       0.031485975241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732059606010
                                         uncertainty =       0.031485975241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365913625
  error estimate for blocks of size 2^( 2) =       0.001437119675
  error estimate for blocks of size 2^( 3) =       0.001498585977
  error estimate for blocks of size 2^( 4) =       0.001541280841
  error estimate for blocks of size 2^( 5) =       0.001566853513
  error estimate for blocks of size 2^( 6) =       0.001577597424
  error estimate for blocks of size 2^( 7) =       0.001582260176

      target function =                  N/A
              le_mean =     -22.328596430036
             les_mean =     502.258889783212
             stat err =       0.001566997989
             autocorr =       1.316104589214
              std dev =       1.931724480910
             le_variance =       3.731559470146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732099923802
                                         uncertainty =       0.031486088422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732099923802
                                         uncertainty =       0.031486088422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365921042
  error estimate for blocks of size 2^( 2) =       0.001437119472
  error estimate for blocks of size 2^( 3) =       0.001498580412
  error estimate for blocks of size 2^( 4) =       0.001541273209
  error estimate for blocks of size 2^( 5) =       0.001566842529
  error estimate for blocks of size 2^( 6) =       0.001577601399
  error estimate for blocks of size 2^( 7) =       0.001582269149

      target function =                  N/A
              le_mean =     -22.328598752951
             les_mean =     502.246774316121
             stat err =       0.001566996572
             autocorr =       1.316087916732
              std dev =       1.931734969875
             le_variance =       3.731599993838


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328599477109        initial
     3.7253e-01     3.7253e+00             7.3332e-04       -22.328600846572  <--
     1.4901e+00     1.4901e+01             2.4139e-04       -22.328596430036
     5.9605e+00     5.9605e+01             6.5642e-05       -22.328598752951

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 4.5842e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -6.921612e-01 3 1  ON 0
ci_002                -7.085517e-01 3 1  ON 1
ci_003                -6.093775e-02 3 1  ON 2
ci_004                -6.221033e-02 3 1  ON 3
ci_005                 4.505121e-02 3 1  ON 4
ci_006                 4.579092e-02 3 1  ON 5
ci_007                 3.152882e-02 3 1  ON 6
ci_008                 3.244049e-02 3 1  ON 7
ci_009                -2.476800e-02 3 1  ON 8
ci_010                -2.522041e-02 3 1  ON 9
ci_011                -2.186838e-02 3 1  ON 10
ci_012                -2.275338e-02 3 1  ON 11
ci_013                 2.029910e-02 3 1  ON 12
ci_014                 2.091859e-02 3 1  ON 13
ci_015                 2.012315e-02 3 1  ON 14
ci_016                 2.113754e-02 3 1  ON 15
ci_017                 1.562665e-02 3 1  ON 16
ci_018                 1.568984e-02 3 1  ON 17
ci_019                 1.031127e-02 3 1  ON 18
ci_020                 9.063107e-03 3 1  ON 19
ci_021                -1.003458e-02 3 1  ON 20
ci_022                -1.076105e-02 3 1  ON 21
ci_023                 8.067893e-03 3 1  ON 22
ci_024                 8.778161e-03 3 1  ON 23
ci_025                 7.846560e-03 3 1  ON 24
ci_026                 8.594729e-03 3 1  ON 25
ci_027                 7.770713e-03 3 1  ON 26
ci_028                 8.287769e-03 3 1  ON 27
ci_029                -8.023992e-03 3 1  ON 28
ci_030                -7.386492e-03 3 1  ON 29
ci_031                -7.289232e-03 3 1  ON 30
ci_032                -7.360794e-03 3 1  ON 31
ci_033                 6.861644e-03 3 1  ON 32
ci_034                 6.331626e-03 3 1  ON 33
ci_035                 6.230705e-03 3 1  ON 34
ci_036                 6.498823e-03 3 1  ON 35
ci_037                 6.609281e-03 3 1  ON 36
ci_038                 5.787541e-03 3 1  ON 37
ci_039                 5.778901e-03 3 1  ON 38
ci_040                 5.603694e-03 3 1  ON 39
ci_041                 5.058929e-03 3 1  ON 40
ci_042                 5.285068e-03 3 1  ON 41
ci_043                 4.860985e-03 3 1  ON 42
ci_044                 5.300825e-03 3 1  ON 43
ci_045                 4.522914e-03 3 1  ON 44
ci_046                 5.144047e-03 3 1  ON 45
ci_047                -3.730911e-03 3 1  ON 46
ci_048                -4.126696e-03 3 1  ON 47
ci_049                 2.376661e-03 3 1  ON 48
ci_050                 3.598942e-03 3 1  ON 49
ci_051                -2.651123e-03 3 1  ON 50
ci_052                -2.607658e-03 3 1  ON 51
ci_053                -2.778269e-03 3 1  ON 52
ci_054                -2.624825e-03 3 1  ON 53
ci_055                -2.592739e-03 3 1  ON 54
ci_056                -1.898464e-03 3 1  ON 55
ci_057                -2.033387e-03 3 1  ON 56
ci_058                -2.007442e-03 3 1  ON 57
ci_059                -1.571461e-03 3 1  ON 58
ci_060                -1.765178e-03 3 1  ON 59
ci_061                -1.640111e-03 3 1  ON 60
ci_062                -8.554235e-04 3 1  ON 61
ci_063                -1.866306e-03 3 1  ON 62
ci_064                -1.276636e-03 3 1  ON 63
ci_065                -7.471598e-04 3 1  ON 64
ci_066                -1.145750e-03 3 1  ON 65
ci_067                -9.840949e-04 3 1  ON 66
ci_068                -1.633353e-03 3 1  ON 67
ci_069                 5.170706e-04 3 1  ON 68
ci_070                 1.259103e-03 3 1  ON 69
ci_071                -1.302337e-03 3 1  ON 70
ci_072                -8.404352e-04 3 1  ON 71
ci_073                 7.105898e-04 3 1  ON 72
ci_074                 1.228431e-03 3 1  ON 73
ci_075                -1.189401e-03 3 1  ON 74
ci_076                -5.849929e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6126e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2319e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.2071
    reference variance = 2.76814
====================================================
  Execution time = 2.4200e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0313e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7740e+00
  Total weights = 1.949823469e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9447e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815987574511
                                         uncertainty =       0.040559726062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815987574511
                                         uncertainty =       0.040559726062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382571067
  error estimate for blocks of size 2^( 2) =       0.001453879984
  error estimate for blocks of size 2^( 3) =       0.001514108630
  error estimate for blocks of size 2^( 4) =       0.001555103179
  error estimate for blocks of size 2^( 5) =       0.001582492157
  error estimate for blocks of size 2^( 6) =       0.001594844873
  error estimate for blocks of size 2^( 7) =       0.001608756380

      target function =                  N/A
              le_mean =     -22.329181797121
             les_mean =     502.366405138719
             stat err =       0.001585299147
             autocorr =       1.314763151071
              std dev =       1.955282037869
             le_variance =       3.823127847612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232918179712e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329181796287       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329232550221       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329237223039       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329237001628       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329236834342       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329236927888       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-02 is 1.421988e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329181796287       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329207263857       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329208279725       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329208222961       residual = 9.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 7.150194e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329181796287       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329190305693       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329190403768       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+00 is 2.399688e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0155e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -6.922491e-01 3 1  ON 0
ci_002                -7.084614e-01 3 1  ON 1
ci_003                -6.079297e-02 3 1  ON 2
ci_004                -6.231159e-02 3 1  ON 3
ci_005                 4.495581e-02 3 1  ON 4
ci_006                 4.574049e-02 3 1  ON 5
ci_007                 3.149602e-02 3 1  ON 6
ci_008                 3.273008e-02 3 1  ON 7
ci_009                -2.509107e-02 3 1  ON 8
ci_010                -2.553344e-02 3 1  ON 9
ci_011                -2.137987e-02 3 1  ON 10
ci_012                -2.229491e-02 3 1  ON 11
ci_013                 1.980110e-02 3 1  ON 12
ci_014                 2.075626e-02 3 1  ON 13
ci_015                 2.050048e-02 3 1  ON 14
ci_016                 2.122383e-02 3 1  ON 15
ci_017                 1.586971e-02 3 1  ON 16
ci_018                 1.540626e-02 3 1  ON 17
ci_019                 1.012821e-02 3 1  ON 18
ci_020                 9.197436e-03 3 1  ON 19
ci_021                -9.926268e-03 3 1  ON 20
ci_022                -1.054582e-02 3 1  ON 21
ci_023                 8.473367e-03 3 1  ON 22
ci_024                 9.359985e-03 3 1  ON 23
ci_025                 7.934821e-03 3 1  ON 24
ci_026                 8.484275e-03 3 1  ON 25
ci_027                 7.709689e-03 3 1  ON 26
ci_028                 8.104646e-03 3 1  ON 27
ci_029                -8.418537e-03 3 1  ON 28
ci_030                -7.839020e-03 3 1  ON 29
ci_031                -7.451685e-03 3 1  ON 30
ci_032                -6.860411e-03 3 1  ON 31
ci_033                 7.370745e-03 3 1  ON 32
ci_034                 6.391587e-03 3 1  ON 33
ci_035                 6.209776e-03 3 1  ON 34
ci_036                 6.498966e-03 3 1  ON 35
ci_037                 7.158000e-03 3 1  ON 36
ci_038                 6.060306e-03 3 1  ON 37
ci_039                 6.019448e-03 3 1  ON 38
ci_040                 5.447436e-03 3 1  ON 39
ci_041                 4.990970e-03 3 1  ON 40
ci_042                 5.296095e-03 3 1  ON 41
ci_043                 4.371453e-03 3 1  ON 42
ci_044                 5.332012e-03 3 1  ON 43
ci_045                 4.872646e-03 3 1  ON 44
ci_046                 4.730294e-03 3 1  ON 45
ci_047                -4.141745e-03 3 1  ON 46
ci_048                -4.187299e-03 3 1  ON 47
ci_049                 2.454555e-03 3 1  ON 48
ci_050                 3.438439e-03 3 1  ON 49
ci_051                -2.944027e-03 3 1  ON 50
ci_052                -2.708006e-03 3 1  ON 51
ci_053                -2.867690e-03 3 1  ON 52
ci_054                -2.408291e-03 3 1  ON 53
ci_055                -2.252696e-03 3 1  ON 54
ci_056                -1.804499e-03 3 1  ON 55
ci_057                -2.136458e-03 3 1  ON 56
ci_058                -2.041961e-03 3 1  ON 57
ci_059                -1.380467e-03 3 1  ON 58
ci_060                -2.022077e-03 3 1  ON 59
ci_061                -1.810598e-03 3 1  ON 60
ci_062                -1.416045e-03 3 1  ON 61
ci_063                -1.385091e-03 3 1  ON 62
ci_064                -1.516167e-03 3 1  ON 63
ci_065                -5.867505e-04 3 1  ON 64
ci_066                -8.910254e-04 3 1  ON 65
ci_067                -1.105286e-03 3 1  ON 66
ci_068                -1.808176e-03 3 1  ON 67
ci_069                 1.232090e-03 3 1  ON 68
ci_070                 1.210355e-03 3 1  ON 69
ci_071                -1.144135e-03 3 1  ON 70
ci_072                -4.305256e-04 3 1  ON 71
ci_073                 7.228052e-04 3 1  ON 72
ci_074                 1.194798e-03 3 1  ON 73
ci_075                -1.028282e-03 3 1  ON 74
ci_076                -9.330827e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.4172
    reference variance = 2.62134
====================================================
  Execution time = 2.3716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7675e+00
  Total weights = 1.9499e+06
  Execution time = 4.4105e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.821389500791
                                         uncertainty =       0.068317101026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.821389500791
                                         uncertainty =       0.068317101026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382087083
  error estimate for blocks of size 2^( 2) =       0.001451265907
  error estimate for blocks of size 2^( 3) =       0.001512603389
  error estimate for blocks of size 2^( 4) =       0.001553469828
  error estimate for blocks of size 2^( 5) =       0.001575100679
  error estimate for blocks of size 2^( 6) =       0.001588103089
  error estimate for blocks of size 2^( 7) =       0.001598153253

      target function =                  N/A
              le_mean =     -22.329070115362
             les_mean =     502.358512740441
             stat err =       0.001578706712
             autocorr =       1.304764387770
              std dev =       1.954597570433
             le_variance =       3.820451662344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823448717887
                                         uncertainty =       0.068358488550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823448717887
                                         uncertainty =       0.068358488550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382459766
  error estimate for blocks of size 2^( 2) =       0.001451619862
  error estimate for blocks of size 2^( 3) =       0.001513024679
  error estimate for blocks of size 2^( 4) =       0.001553869618
  error estimate for blocks of size 2^( 5) =       0.001575527224
  error estimate for blocks of size 2^( 6) =       0.001588535316
  error estimate for blocks of size 2^( 7) =       0.001598691830

      target function =                  N/A
              le_mean =     -22.329027480860
             les_mean =     504.087132897842
             stat err =       0.001579155997
             autocorr =       1.304803360649
              std dev =       1.955124631161
             le_variance =       3.822512323371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.821346809705
                                         uncertainty =       0.068317279377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.821346809705
                                         uncertainty =       0.068317279377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382079061
  error estimate for blocks of size 2^( 2) =       0.001451257645
  error estimate for blocks of size 2^( 3) =       0.001512602072
  error estimate for blocks of size 2^( 4) =       0.001553456673
  error estimate for blocks of size 2^( 5) =       0.001575107914
  error estimate for blocks of size 2^( 6) =       0.001588113481
  error estimate for blocks of size 2^( 7) =       0.001598202645

      target function =                  N/A
              le_mean =     -22.329071848661
             les_mean =     502.390013205161
             stat err =       0.001578720178
             autocorr =       1.304801793729
              std dev =       1.954586225218
             le_variance =       3.820407311812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.821340927829
                                         uncertainty =       0.068314111116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.821340927829
                                         uncertainty =       0.068314111116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382078258
  error estimate for blocks of size 2^( 2) =       0.001451258592
  error estimate for blocks of size 2^( 3) =       0.001512598234
  error estimate for blocks of size 2^( 4) =       0.001553464889
  error estimate for blocks of size 2^( 5) =       0.001575099512
  error estimate for blocks of size 2^( 6) =       0.001588103117
  error estimate for blocks of size 2^( 7) =       0.001598162839

      target function =                  N/A
              le_mean =     -22.329065504664
             les_mean =     502.356945109766
             stat err =       0.001578707589
             autocorr =       1.304782501414
              std dev =       1.954585088848
             le_variance =       3.820402869547


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329070115362        initial
     9.3132e-02     9.3132e-01             1.4220e-03       -22.329027480860
     3.7253e-01     3.7253e+00             7.1502e-04       -22.329071848661  <--
     1.4901e+00     1.4901e+01             2.3997e-04       -22.329065504664

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 4.5950e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -6.922491e-01 3 1  ON 0
ci_002                -7.084614e-01 3 1  ON 1
ci_003                -6.079297e-02 3 1  ON 2
ci_004                -6.231159e-02 3 1  ON 3
ci_005                 4.495581e-02 3 1  ON 4
ci_006                 4.574049e-02 3 1  ON 5
ci_007                 3.149602e-02 3 1  ON 6
ci_008                 3.273008e-02 3 1  ON 7
ci_009                -2.509107e-02 3 1  ON 8
ci_010                -2.553344e-02 3 1  ON 9
ci_011                -2.137987e-02 3 1  ON 10
ci_012                -2.229491e-02 3 1  ON 11
ci_013                 1.980110e-02 3 1  ON 12
ci_014                 2.075626e-02 3 1  ON 13
ci_015                 2.050048e-02 3 1  ON 14
ci_016                 2.122383e-02 3 1  ON 15
ci_017                 1.586971e-02 3 1  ON 16
ci_018                 1.540626e-02 3 1  ON 17
ci_019                 1.012821e-02 3 1  ON 18
ci_020                 9.197436e-03 3 1  ON 19
ci_021                -9.926268e-03 3 1  ON 20
ci_022                -1.054582e-02 3 1  ON 21
ci_023                 8.473367e-03 3 1  ON 22
ci_024                 9.359985e-03 3 1  ON 23
ci_025                 7.934821e-03 3 1  ON 24
ci_026                 8.484275e-03 3 1  ON 25
ci_027                 7.709689e-03 3 1  ON 26
ci_028                 8.104646e-03 3 1  ON 27
ci_029                -8.418537e-03 3 1  ON 28
ci_030                -7.839020e-03 3 1  ON 29
ci_031                -7.451685e-03 3 1  ON 30
ci_032                -6.860411e-03 3 1  ON 31
ci_033                 7.370745e-03 3 1  ON 32
ci_034                 6.391587e-03 3 1  ON 33
ci_035                 6.209776e-03 3 1  ON 34
ci_036                 6.498966e-03 3 1  ON 35
ci_037                 7.158000e-03 3 1  ON 36
ci_038                 6.060306e-03 3 1  ON 37
ci_039                 6.019448e-03 3 1  ON 38
ci_040                 5.447436e-03 3 1  ON 39
ci_041                 4.990970e-03 3 1  ON 40
ci_042                 5.296095e-03 3 1  ON 41
ci_043                 4.371453e-03 3 1  ON 42
ci_044                 5.332012e-03 3 1  ON 43
ci_045                 4.872646e-03 3 1  ON 44
ci_046                 4.730294e-03 3 1  ON 45
ci_047                -4.141745e-03 3 1  ON 46
ci_048                -4.187299e-03 3 1  ON 47
ci_049                 2.454555e-03 3 1  ON 48
ci_050                 3.438439e-03 3 1  ON 49
ci_051                -2.944027e-03 3 1  ON 50
ci_052                -2.708006e-03 3 1  ON 51
ci_053                -2.867690e-03 3 1  ON 52
ci_054                -2.408291e-03 3 1  ON 53
ci_055                -2.252696e-03 3 1  ON 54
ci_056                -1.804499e-03 3 1  ON 55
ci_057                -2.136458e-03 3 1  ON 56
ci_058                -2.041961e-03 3 1  ON 57
ci_059                -1.380467e-03 3 1  ON 58
ci_060                -2.022077e-03 3 1  ON 59
ci_061                -1.810598e-03 3 1  ON 60
ci_062                -1.416045e-03 3 1  ON 61
ci_063                -1.385091e-03 3 1  ON 62
ci_064                -1.516167e-03 3 1  ON 63
ci_065                -5.867505e-04 3 1  ON 64
ci_066                -8.910254e-04 3 1  ON 65
ci_067                -1.105286e-03 3 1  ON 66
ci_068                -1.808176e-03 3 1  ON 67
ci_069                 1.232090e-03 3 1  ON 68
ci_070                 1.210355e-03 3 1  ON 69
ci_071                -1.144135e-03 3 1  ON 70
ci_072                -4.305256e-04 3 1  ON 71
ci_073                 7.228052e-04 3 1  ON 72
ci_074                 1.194798e-03 3 1  ON 73
ci_075                -1.028282e-03 3 1  ON 74
ci_076                -9.330827e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6120e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2319e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.1626
    reference variance = 11.8062
====================================================
  Execution time = 2.6457e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0307e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7418e+00
  Total weights = 1.949827396e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8514e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794877463121
                                         uncertainty =       0.036208369784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794877463121
                                         uncertainty =       0.036208369784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377319763
  error estimate for blocks of size 2^( 2) =       0.001449910592
  error estimate for blocks of size 2^( 3) =       0.001512207066
  error estimate for blocks of size 2^( 4) =       0.001557901855
  error estimate for blocks of size 2^( 5) =       0.001583071834
  error estimate for blocks of size 2^( 6) =       0.001600293783
  error estimate for blocks of size 2^( 7) =       0.001605388135

      target function =                  N/A
              le_mean =     -22.325686643506
             les_mean =     502.178130957490
             stat err =       0.001586663902
             autocorr =       1.327089840005
              std dev =       1.947855452979
             le_variance =       3.794140865702


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232568664351e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325686642696       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325742852702       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325747007073       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325746609976       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325746689075       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-02 is 1.691778e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325686642696       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325714921751       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325715704376       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325715636368       residual = 1.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 7.563884e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325686642696       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325696108079       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325696179161       residual = 1.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+00 is 2.366440e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096766 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2319e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -6.923828e-01 3 1  ON 0
ci_002                -7.084095e-01 3 1  ON 1
ci_003                -6.032339e-02 3 1  ON 2
ci_004                -6.218857e-02 3 1  ON 3
ci_005                 4.494763e-02 3 1  ON 4
ci_006                 4.599982e-02 3 1  ON 5
ci_007                 3.108122e-02 3 1  ON 6
ci_008                 3.252219e-02 3 1  ON 7
ci_009                -2.480124e-02 3 1  ON 8
ci_010                -2.543506e-02 3 1  ON 9
ci_011                -2.156277e-02 3 1  ON 10
ci_012                -2.271121e-02 3 1  ON 11
ci_013                 1.959581e-02 3 1  ON 12
ci_014                 2.062479e-02 3 1  ON 13
ci_015                 2.045768e-02 3 1  ON 14
ci_016                 2.113606e-02 3 1  ON 15
ci_017                 1.537845e-02 3 1  ON 16
ci_018                 1.572166e-02 3 1  ON 17
ci_019                 9.464171e-03 3 1  ON 18
ci_020                 9.479593e-03 3 1  ON 19
ci_021                -1.068266e-02 3 1  ON 20
ci_022                -1.063285e-02 3 1  ON 21
ci_023                 8.537720e-03 3 1  ON 22
ci_024                 9.405130e-03 3 1  ON 23
ci_025                 7.643783e-03 3 1  ON 24
ci_026                 8.566879e-03 3 1  ON 25
ci_027                 7.490119e-03 3 1  ON 26
ci_028                 8.084854e-03 3 1  ON 27
ci_029                -8.433286e-03 3 1  ON 28
ci_030                -8.144620e-03 3 1  ON 29
ci_031                -7.373091e-03 3 1  ON 30
ci_032                -6.607902e-03 3 1  ON 31
ci_033                 7.239391e-03 3 1  ON 32
ci_034                 6.628432e-03 3 1  ON 33
ci_035                 6.099929e-03 3 1  ON 34
ci_036                 6.206931e-03 3 1  ON 35
ci_037                 6.888582e-03 3 1  ON 36
ci_038                 6.587148e-03 3 1  ON 37
ci_039                 5.888924e-03 3 1  ON 38
ci_040                 5.313754e-03 3 1  ON 39
ci_041                 5.150993e-03 3 1  ON 40
ci_042                 4.965238e-03 3 1  ON 41
ci_043                 4.353612e-03 3 1  ON 42
ci_044                 5.199341e-03 3 1  ON 43
ci_045                 5.027261e-03 3 1  ON 44
ci_046                 4.901334e-03 3 1  ON 45
ci_047                -3.929352e-03 3 1  ON 46
ci_048                -3.740431e-03 3 1  ON 47
ci_049                 2.730495e-03 3 1  ON 48
ci_050                 3.697573e-03 3 1  ON 49
ci_051                -2.793140e-03 3 1  ON 50
ci_052                -2.710433e-03 3 1  ON 51
ci_053                -3.087537e-03 3 1  ON 52
ci_054                -2.387024e-03 3 1  ON 53
ci_055                -2.306266e-03 3 1  ON 54
ci_056                -1.880982e-03 3 1  ON 55
ci_057                -2.092156e-03 3 1  ON 56
ci_058                -2.168160e-03 3 1  ON 57
ci_059                -1.428745e-03 3 1  ON 58
ci_060                -2.200012e-03 3 1  ON 59
ci_061                -1.283594e-03 3 1  ON 60
ci_062                -9.695454e-04 3 1  ON 61
ci_063                -1.354181e-03 3 1  ON 62
ci_064                -1.374291e-03 3 1  ON 63
ci_065                -1.100180e-03 3 1  ON 64
ci_066                -1.412489e-03 3 1  ON 65
ci_067                -7.636536e-04 3 1  ON 66
ci_068                -1.232394e-03 3 1  ON 67
ci_069                 1.543317e-03 3 1  ON 68
ci_070                 1.705234e-03 3 1  ON 69
ci_071                -1.510684e-03 3 1  ON 70
ci_072                -7.664738e-04 3 1  ON 71
ci_073                 8.863307e-04 3 1  ON 72
ci_074                 6.832197e-04 3 1  ON 73
ci_075                -9.490161e-04 3 1  ON 74
ci_076                -9.269400e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -21.9688
    reference variance = 3.81706
====================================================
  Execution time = 2.3786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.6798e+00
  Total weights = 1.9498e+06
  Execution time = 4.4079e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730120412717
                                         uncertainty =       0.029887890529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730120412717
                                         uncertainty =       0.029887890529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365742802
  error estimate for blocks of size 2^( 2) =       0.001435627506
  error estimate for blocks of size 2^( 3) =       0.001498272371
  error estimate for blocks of size 2^( 4) =       0.001541362078
  error estimate for blocks of size 2^( 5) =       0.001565017950
  error estimate for blocks of size 2^( 6) =       0.001577526212
  error estimate for blocks of size 2^( 7) =       0.001588020175

      target function =                  N/A
              le_mean =     -22.331009218340
             les_mean =     502.367585636189
             stat err =       0.001567981604
             autocorr =       1.318087027598
              std dev =       1.931482895799
             le_variance =       3.730626176766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730132375653
                                         uncertainty =       0.029889883655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730132375653
                                         uncertainty =       0.029889883655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365746734
  error estimate for blocks of size 2^( 2) =       0.001435644143
  error estimate for blocks of size 2^( 3) =       0.001498301864
  error estimate for blocks of size 2^( 4) =       0.001541401453
  error estimate for blocks of size 2^( 5) =       0.001565077489
  error estimate for blocks of size 2^( 6) =       0.001577566416
  error estimate for blocks of size 2^( 7) =       0.001588084667

      target function =                  N/A
              le_mean =     -22.331027918092
             les_mean =     502.360178142829
             stat err =       0.001568032506
             autocorr =       1.318165018339
              std dev =       1.931488457052
             le_variance =       3.730647659727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730234489933
                                         uncertainty =       0.029887969266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730234489933
                                         uncertainty =       0.029887969266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365765396
  error estimate for blocks of size 2^( 2) =       0.001435657830
  error estimate for blocks of size 2^( 3) =       0.001498307506
  error estimate for blocks of size 2^( 4) =       0.001541396506
  error estimate for blocks of size 2^( 5) =       0.001565077078
  error estimate for blocks of size 2^( 6) =       0.001577549544
  error estimate for blocks of size 2^( 7) =       0.001588071414

      target function =                  N/A
              le_mean =     -22.331018658695
             les_mean =     502.428748174667
             stat err =       0.001568023636
             autocorr =       1.318114081678
              std dev =       1.931514849379
             le_variance =       3.730749613373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730090926331
                                         uncertainty =       0.029889040538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730090926331
                                         uncertainty =       0.029889040538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365737687
  error estimate for blocks of size 2^( 2) =       0.001435623890
  error estimate for blocks of size 2^( 3) =       0.001498272216
  error estimate for blocks of size 2^( 4) =       0.001541361352
  error estimate for blocks of size 2^( 5) =       0.001565014808
  error estimate for blocks of size 2^( 6) =       0.001577509377
  error estimate for blocks of size 2^( 7) =       0.001587999241

      target function =                  N/A
              le_mean =     -22.331008845724
             les_mean =     502.361104966266
             stat err =       0.001567971195
             autocorr =       1.318079398775
              std dev =       1.931475663092
             le_variance =       3.730598237116


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.331009218340        initial
     9.3132e-02     9.3132e-01             1.6918e-03       -22.331027918092  <--
     3.7253e-01     3.7253e+00             7.5639e-04       -22.331018658695
     1.4901e+00     1.4901e+01             2.3664e-04       -22.331008845724

*****************************************************************************
Applying the update for shift_i =   9.3132e-02     and shift_s =   9.3132e-01
*****************************************************************************

  Execution time = 4.5910e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -6.926244e-01 3 1  ON 0
ci_002                -7.082968e-01 3 1  ON 1
ci_003                -5.945170e-02 3 1  ON 2
ci_004                -6.193610e-02 3 1  ON 3
ci_005                 4.494322e-02 3 1  ON 4
ci_006                 4.620961e-02 3 1  ON 5
ci_007                 3.064393e-02 3 1  ON 6
ci_008                 3.227551e-02 3 1  ON 7
ci_009                -2.455151e-02 3 1  ON 8
ci_010                -2.535552e-02 3 1  ON 9
ci_011                -2.178942e-02 3 1  ON 10
ci_012                -2.320178e-02 3 1  ON 11
ci_013                 1.935822e-02 3 1  ON 12
ci_014                 2.051049e-02 3 1  ON 13
ci_015                 2.035316e-02 3 1  ON 14
ci_016                 2.105584e-02 3 1  ON 15
ci_017                 1.480503e-02 3 1  ON 16
ci_018                 1.609585e-02 3 1  ON 17
ci_019                 8.698459e-03 3 1  ON 18
ci_020                 9.882800e-03 3 1  ON 19
ci_021                -1.161805e-02 3 1  ON 20
ci_022                -1.078743e-02 3 1  ON 21
ci_023                 8.595733e-03 3 1  ON 22
ci_024                 9.445643e-03 3 1  ON 23
ci_025                 7.347715e-03 3 1  ON 24
ci_026                 8.609028e-03 3 1  ON 25
ci_027                 7.326959e-03 3 1  ON 26
ci_028                 8.077285e-03 3 1  ON 27
ci_029                -8.397202e-03 3 1  ON 28
ci_030                -8.441046e-03 3 1  ON 29
ci_031                -7.194058e-03 3 1  ON 30
ci_032                -6.302404e-03 3 1  ON 31
ci_033                 7.070650e-03 3 1  ON 32
ci_034                 6.871227e-03 3 1  ON 33
ci_035                 5.979284e-03 3 1  ON 34
ci_036                 5.978021e-03 3 1  ON 35
ci_037                 6.608261e-03 3 1  ON 36
ci_038                 7.120022e-03 3 1  ON 37
ci_039                 5.792672e-03 3 1  ON 38
ci_040                 5.223865e-03 3 1  ON 39
ci_041                 5.298621e-03 3 1  ON 40
ci_042                 4.694560e-03 3 1  ON 41
ci_043                 4.367726e-03 3 1  ON 42
ci_044                 5.078725e-03 3 1  ON 43
ci_045                 5.219619e-03 3 1  ON 44
ci_046                 5.041145e-03 3 1  ON 45
ci_047                -3.789819e-03 3 1  ON 46
ci_048                -3.405660e-03 3 1  ON 47
ci_049                 3.033321e-03 3 1  ON 48
ci_050                 3.989857e-03 3 1  ON 49
ci_051                -2.549189e-03 3 1  ON 50
ci_052                -2.642312e-03 3 1  ON 51
ci_053                -3.335962e-03 3 1  ON 52
ci_054                -2.378731e-03 3 1  ON 53
ci_055                -2.409338e-03 3 1  ON 54
ci_056                -2.055568e-03 3 1  ON 55
ci_057                -2.050544e-03 3 1  ON 56
ci_058                -2.280506e-03 3 1  ON 57
ci_059                -1.452676e-03 3 1  ON 58
ci_060                -2.326839e-03 3 1  ON 59
ci_061                -7.241977e-04 3 1  ON 60
ci_062                -5.288518e-04 3 1  ON 61
ci_063                -1.349418e-03 3 1  ON 62
ci_064                -1.202269e-03 3 1  ON 63
ci_065                -1.606576e-03 3 1  ON 64
ci_066                -1.916922e-03 3 1  ON 65
ci_067                -3.587159e-04 3 1  ON 66
ci_068                -6.000785e-04 3 1  ON 67
ci_069                 1.886750e-03 3 1  ON 68
ci_070                 2.238025e-03 3 1  ON 69
ci_071                -1.884836e-03 3 1  ON 70
ci_072                -1.098983e-03 3 1  ON 71
ci_073                 9.944356e-04 3 1  ON 72
ci_074                 3.182434e-04 3 1  ON 73
ci_075                -8.727755e-04 3 1  ON 74
ci_076                -9.181644e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.5334
    reference variance = 2.44061
====================================================
  Execution time = 2.4311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0305e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.8385e+00
  Total weights = 1.949874123e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9496e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.892745534682
                                         uncertainty =       0.121593327627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.892745534682
                                         uncertainty =       0.121593327627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395099515
  error estimate for blocks of size 2^( 2) =       0.001464196230
  error estimate for blocks of size 2^( 3) =       0.001527849032
  error estimate for blocks of size 2^( 4) =       0.001570286763
  error estimate for blocks of size 2^( 5) =       0.001595824316
  error estimate for blocks of size 2^( 6) =       0.001610134119
  error estimate for blocks of size 2^( 7) =       0.001625276012

      target function =                  N/A
              le_mean =     -22.328951104457
             les_mean =     502.420539470784
             stat err =       0.001600380303
             autocorr =       1.315939791333
              std dev =       1.973000222489
             le_variance =       3.892729877940


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232895110446e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-02, overlap shift 2.3283e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328951103665       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329076645861       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329089267930       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329089222731       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329092958034       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329094523566       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329094935136       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.329095699778       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.329095580581       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e-02 is 4.458817e-03

solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328951103665       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329045126244       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329050179410       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329049733852       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329050334201       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329050390659       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-02 is 2.720865e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328951103665       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328998014157       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328998577009       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328998499377       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 1.195948e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101623 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0273e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -6.913882e-01 3 1  ON 0
ci_002                -7.092638e-01 3 1  ON 1
ci_003                -6.122717e-02 3 1  ON 2
ci_004                -6.177424e-02 3 1  ON 3
ci_005                 4.500279e-02 3 1  ON 4
ci_006                 4.676150e-02 3 1  ON 5
ci_007                 3.248768e-02 3 1  ON 6
ci_008                 3.219367e-02 3 1  ON 7
ci_009                -2.506166e-02 3 1  ON 8
ci_010                -2.543806e-02 3 1  ON 9
ci_011                -2.172813e-02 3 1  ON 10
ci_012                -2.314439e-02 3 1  ON 11
ci_013                 1.923579e-02 3 1  ON 12
ci_014                 1.891804e-02 3 1  ON 13
ci_015                 2.057859e-02 3 1  ON 14
ci_016                 2.046876e-02 3 1  ON 15
ci_017                 1.552759e-02 3 1  ON 16
ci_018                 1.631226e-02 3 1  ON 17
ci_019                 1.141932e-02 3 1  ON 18
ci_020                 1.019087e-02 3 1  ON 19
ci_021                -9.981530e-03 3 1  ON 20
ci_022                -1.046498e-02 3 1  ON 21
ci_023                 8.874101e-03 3 1  ON 22
ci_024                 9.469497e-03 3 1  ON 23
ci_025                 6.662629e-03 3 1  ON 24
ci_026                 8.638011e-03 3 1  ON 25
ci_027                 8.191370e-03 3 1  ON 26
ci_028                 8.087327e-03 3 1  ON 27
ci_029                -7.906022e-03 3 1  ON 28
ci_030                -8.647421e-03 3 1  ON 29
ci_031                -7.872595e-03 3 1  ON 30
ci_032                -8.489642e-03 3 1  ON 31
ci_033                 7.082230e-03 3 1  ON 32
ci_034                 6.522933e-03 3 1  ON 33
ci_035                 6.188302e-03 3 1  ON 34
ci_036                 6.175387e-03 3 1  ON 35
ci_037                 6.369812e-03 3 1  ON 36
ci_038                 6.040252e-03 3 1  ON 37
ci_039                 5.573225e-03 3 1  ON 38
ci_040                 5.483844e-03 3 1  ON 39
ci_041                 4.614458e-03 3 1  ON 40
ci_042                 4.819074e-03 3 1  ON 41
ci_043                 5.153002e-03 3 1  ON 42
ci_044                 5.752706e-03 3 1  ON 43
ci_045                 4.885916e-03 3 1  ON 44
ci_046                 5.447356e-03 3 1  ON 45
ci_047                -4.226258e-03 3 1  ON 46
ci_048                -3.396745e-03 3 1  ON 47
ci_049                 3.159733e-03 3 1  ON 48
ci_050                 3.640984e-03 3 1  ON 49
ci_051                -3.358094e-03 3 1  ON 50
ci_052                -2.172159e-03 3 1  ON 51
ci_053                -3.717991e-03 3 1  ON 52
ci_054                -1.879732e-03 3 1  ON 53
ci_055                -2.386142e-03 3 1  ON 54
ci_056                -2.142233e-03 3 1  ON 55
ci_057                -2.085376e-03 3 1  ON 56
ci_058                -1.858062e-03 3 1  ON 57
ci_059                -1.052281e-03 3 1  ON 58
ci_060                -1.652067e-03 3 1  ON 59
ci_061                -1.414720e-03 3 1  ON 60
ci_062                -1.160318e-03 3 1  ON 61
ci_063                -1.116230e-03 3 1  ON 62
ci_064                -1.250263e-03 3 1  ON 63
ci_065                -1.574077e-03 3 1  ON 64
ci_066                -1.131127e-03 3 1  ON 65
ci_067                -6.451335e-04 3 1  ON 66
ci_068                -1.543646e-03 3 1  ON 67
ci_069                 1.106794e-03 3 1  ON 68
ci_070                 1.265578e-03 3 1  ON 69
ci_071                -4.798203e-04 3 1  ON 70
ci_072                -6.342429e-04 3 1  ON 71
ci_073                 4.109536e-05 3 1  ON 72
ci_074                 1.508929e-03 3 1  ON 73
ci_075                -4.288591e-04 3 1  ON 74
ci_076                -9.911866e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.4177
    reference variance = 1.90757
====================================================
  Execution time = 2.3725e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7485e+00
  Total weights = 1.9499e+06
  Execution time = 4.3974e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0349755
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800394139552
                                         uncertainty =       0.040831852283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800394139552
                                         uncertainty =       0.040831852283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378491872
  error estimate for blocks of size 2^( 2) =       0.001448336583
  error estimate for blocks of size 2^( 3) =       0.001511639993
  error estimate for blocks of size 2^( 4) =       0.001555200988
  error estimate for blocks of size 2^( 5) =       0.001579639329
  error estimate for blocks of size 2^( 6) =       0.001593225415
  error estimate for blocks of size 2^( 7) =       0.001604000846

      target function =                  N/A
              le_mean =     -22.330206951962
             les_mean =     502.502225379989
             stat err =       0.001583016645
             autocorr =       1.318750213079
              std dev =       1.949513093022
             le_variance =       3.800601299866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799618486856
                                         uncertainty =       0.040860866971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799618486856
                                         uncertainty =       0.040860866971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378351493
  error estimate for blocks of size 2^( 2) =       0.001448164461
  error estimate for blocks of size 2^( 3) =       0.001511442928
  error estimate for blocks of size 2^( 4) =       0.001555049531
  error estimate for blocks of size 2^( 5) =       0.001579400556
  error estimate for blocks of size 2^( 6) =       0.001593016387
  error estimate for blocks of size 2^( 7) =       0.001603964942

      target function =                  N/A
              le_mean =     -22.330178014044
             les_mean =     502.389372707233
             stat err =       0.001582857854
             autocorr =       1.318754240194
              std dev =       1.949314562998
             le_variance =       3.799827265515

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0359758
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800109665140
                                         uncertainty =       0.040862982645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800109665140
                                         uncertainty =       0.040862982645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378440399
  error estimate for blocks of size 2^( 2) =       0.001448230305
  error estimate for blocks of size 2^( 3) =       0.001511481942
  error estimate for blocks of size 2^( 4) =       0.001555092226
  error estimate for blocks of size 2^( 5) =       0.001579432263
  error estimate for blocks of size 2^( 6) =       0.001593052481
  error estimate for blocks of size 2^( 7) =       0.001603998612

      target function =                  N/A
              le_mean =     -22.330241180869
             les_mean =     502.416734199586
             stat err =       0.001582893895
             autocorr =       1.318644180412
              std dev =       1.949440298173
             le_variance =       3.800317476142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799485587438
                                         uncertainty =       0.040862260474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799485587438
                                         uncertainty =       0.040862260474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378327368
  error estimate for blocks of size 2^( 2) =       0.001448163525
  error estimate for blocks of size 2^( 3) =       0.001511458954
  error estimate for blocks of size 2^( 4) =       0.001555034508
  error estimate for blocks of size 2^( 5) =       0.001579411192
  error estimate for blocks of size 2^( 6) =       0.001593010549
  error estimate for blocks of size 2^( 7) =       0.001603971008

      target function =                  N/A
              le_mean =     -22.330180809263
             les_mean =     502.422489964392
             stat err =       0.001582856814
             autocorr =       1.318798673578
              std dev =       1.949280444265
             le_variance =       3.799694250394


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330206951962        initial
     2.3283e-02     2.3283e-01             4.4588e-03       -22.330178014044
     9.3132e-02     9.3132e-01             2.7209e-03       -22.330241180869  <--
     3.7253e-01     3.7253e+00             1.1959e-03       -22.330180809263

*****************************************************************************
Applying the update for shift_i =   9.3132e-02     and shift_s =   9.3132e-01
*****************************************************************************

  Execution time = 4.5819e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -6.913882e-01 3 1  ON 0
ci_002                -7.092638e-01 3 1  ON 1
ci_003                -6.122717e-02 3 1  ON 2
ci_004                -6.177424e-02 3 1  ON 3
ci_005                 4.500279e-02 3 1  ON 4
ci_006                 4.676150e-02 3 1  ON 5
ci_007                 3.248768e-02 3 1  ON 6
ci_008                 3.219367e-02 3 1  ON 7
ci_009                -2.506166e-02 3 1  ON 8
ci_010                -2.543806e-02 3 1  ON 9
ci_011                -2.172813e-02 3 1  ON 10
ci_012                -2.314439e-02 3 1  ON 11
ci_013                 1.923579e-02 3 1  ON 12
ci_014                 1.891804e-02 3 1  ON 13
ci_015                 2.057859e-02 3 1  ON 14
ci_016                 2.046876e-02 3 1  ON 15
ci_017                 1.552759e-02 3 1  ON 16
ci_018                 1.631226e-02 3 1  ON 17
ci_019                 1.141932e-02 3 1  ON 18
ci_020                 1.019087e-02 3 1  ON 19
ci_021                -9.981530e-03 3 1  ON 20
ci_022                -1.046498e-02 3 1  ON 21
ci_023                 8.874101e-03 3 1  ON 22
ci_024                 9.469497e-03 3 1  ON 23
ci_025                 6.662629e-03 3 1  ON 24
ci_026                 8.638011e-03 3 1  ON 25
ci_027                 8.191370e-03 3 1  ON 26
ci_028                 8.087327e-03 3 1  ON 27
ci_029                -7.906022e-03 3 1  ON 28
ci_030                -8.647421e-03 3 1  ON 29
ci_031                -7.872595e-03 3 1  ON 30
ci_032                -8.489642e-03 3 1  ON 31
ci_033                 7.082230e-03 3 1  ON 32
ci_034                 6.522933e-03 3 1  ON 33
ci_035                 6.188302e-03 3 1  ON 34
ci_036                 6.175387e-03 3 1  ON 35
ci_037                 6.369812e-03 3 1  ON 36
ci_038                 6.040252e-03 3 1  ON 37
ci_039                 5.573225e-03 3 1  ON 38
ci_040                 5.483844e-03 3 1  ON 39
ci_041                 4.614458e-03 3 1  ON 40
ci_042                 4.819074e-03 3 1  ON 41
ci_043                 5.153002e-03 3 1  ON 42
ci_044                 5.752706e-03 3 1  ON 43
ci_045                 4.885916e-03 3 1  ON 44
ci_046                 5.447356e-03 3 1  ON 45
ci_047                -4.226258e-03 3 1  ON 46
ci_048                -3.396745e-03 3 1  ON 47
ci_049                 3.159733e-03 3 1  ON 48
ci_050                 3.640984e-03 3 1  ON 49
ci_051                -3.358094e-03 3 1  ON 50
ci_052                -2.172159e-03 3 1  ON 51
ci_053                -3.717991e-03 3 1  ON 52
ci_054                -1.879732e-03 3 1  ON 53
ci_055                -2.386142e-03 3 1  ON 54
ci_056                -2.142233e-03 3 1  ON 55
ci_057                -2.085376e-03 3 1  ON 56
ci_058                -1.858062e-03 3 1  ON 57
ci_059                -1.052281e-03 3 1  ON 58
ci_060                -1.652067e-03 3 1  ON 59
ci_061                -1.414720e-03 3 1  ON 60
ci_062                -1.160318e-03 3 1  ON 61
ci_063                -1.116230e-03 3 1  ON 62
ci_064                -1.250263e-03 3 1  ON 63
ci_065                -1.574077e-03 3 1  ON 64
ci_066                -1.131127e-03 3 1  ON 65
ci_067                -6.451335e-04 3 1  ON 66
ci_068                -1.543646e-03 3 1  ON 67
ci_069                 1.106794e-03 3 1  ON 68
ci_070                 1.265578e-03 3 1  ON 69
ci_071                -4.798203e-04 3 1  ON 70
ci_072                -6.342429e-04 3 1  ON 71
ci_073                 4.109536e-05 3 1  ON 72
ci_074                 1.508929e-03 3 1  ON 73
ci_075                -4.288591e-04 3 1  ON 74
ci_076                -9.911866e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6106e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2316e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.4744
    reference variance = 2.30611
====================================================
  Execution time = 2.4448e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0310e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7304e+00
  Total weights = 1.949896565e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9843e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781166345273
                                         uncertainty =       0.029925031417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.781166345273
                                         uncertainty =       0.029925031417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375173689
  error estimate for blocks of size 2^( 2) =       0.001446326043
  error estimate for blocks of size 2^( 3) =       0.001508549044
  error estimate for blocks of size 2^( 4) =       0.001552214689
  error estimate for blocks of size 2^( 5) =       0.001575029625
  error estimate for blocks of size 2^( 6) =       0.001590709406
  error estimate for blocks of size 2^( 7) =       0.001602650827

      target function =                  N/A
              le_mean =     -22.326960970881
             les_mean =     502.223608846019
             stat err =       0.001580151137
             autocorr =       1.320328953431
              std dev =       1.944820397938
             le_variance =       3.782326380237


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232696097088e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-02, overlap shift 2.3283e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326960970060       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327082139678       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327099356472       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327103022950       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327103325385       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327103447671       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327103202889       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327102977945       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.327103137735       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e-02 is 3.343348e-03

solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326960970060       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327051520787       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327059479828       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327060666186       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327060660934       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327060645829       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-02 is 2.137669e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326960970060       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327006002179       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327007395522       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327007506983       residual = 9.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 8.720505e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0444e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -6.910553e-01 3 1  ON 0
ci_002                -7.096264e-01 3 1  ON 1
ci_003                -6.101733e-02 3 1  ON 2
ci_004                -6.103869e-02 3 1  ON 3
ci_005                 4.549792e-02 3 1  ON 4
ci_006                 4.642680e-02 3 1  ON 5
ci_007                 3.156293e-02 3 1  ON 6
ci_008                 3.316631e-02 3 1  ON 7
ci_009                -2.581517e-02 3 1  ON 8
ci_010                -2.472853e-02 3 1  ON 9
ci_011                -2.214230e-02 3 1  ON 10
ci_012                -2.327346e-02 3 1  ON 11
ci_013                 2.038746e-02 3 1  ON 12
ci_014                 1.972264e-02 3 1  ON 13
ci_015                 2.049374e-02 3 1  ON 14
ci_016                 2.098149e-02 3 1  ON 15
ci_017                 1.610903e-02 3 1  ON 16
ci_018                 1.559058e-02 3 1  ON 17
ci_019                 9.281656e-03 3 1  ON 18
ci_020                 9.887857e-03 3 1  ON 19
ci_021                -9.829786e-03 3 1  ON 20
ci_022                -1.161715e-02 3 1  ON 21
ci_023                 8.138045e-03 3 1  ON 22
ci_024                 8.993415e-03 3 1  ON 23
ci_025                 8.424790e-03 3 1  ON 24
ci_026                 8.204636e-03 3 1  ON 25
ci_027                 7.910649e-03 3 1  ON 26
ci_028                 8.196116e-03 3 1  ON 27
ci_029                -7.779983e-03 3 1  ON 28
ci_030                -8.099317e-03 3 1  ON 29
ci_031                -7.347755e-03 3 1  ON 30
ci_032                -7.416698e-03 3 1  ON 31
ci_033                 6.929217e-03 3 1  ON 32
ci_034                 5.333327e-03 3 1  ON 33
ci_035                 6.710999e-03 3 1  ON 34
ci_036                 6.747607e-03 3 1  ON 35
ci_037                 6.585472e-03 3 1  ON 36
ci_038                 5.511185e-03 3 1  ON 37
ci_039                 5.649291e-03 3 1  ON 38
ci_040                 6.009963e-03 3 1  ON 39
ci_041                 5.091857e-03 3 1  ON 40
ci_042                 5.198950e-03 3 1  ON 41
ci_043                 5.702505e-03 3 1  ON 42
ci_044                 6.612917e-03 3 1  ON 43
ci_045                 4.797363e-03 3 1  ON 44
ci_046                 4.697776e-03 3 1  ON 45
ci_047                -4.156218e-03 3 1  ON 46
ci_048                -3.221701e-03 3 1  ON 47
ci_049                 4.641847e-03 3 1  ON 48
ci_050                 3.610306e-03 3 1  ON 49
ci_051                -2.624973e-03 3 1  ON 50
ci_052                -3.206519e-03 3 1  ON 51
ci_053                -2.763751e-03 3 1  ON 52
ci_054                -3.178606e-03 3 1  ON 53
ci_055                -3.201980e-03 3 1  ON 54
ci_056                -1.526231e-03 3 1  ON 55
ci_057                -1.742308e-03 3 1  ON 56
ci_058                -1.005428e-03 3 1  ON 57
ci_059                -7.191562e-04 3 1  ON 58
ci_060                -1.857482e-03 3 1  ON 59
ci_061                -1.582695e-03 3 1  ON 60
ci_062                -1.775833e-03 3 1  ON 61
ci_063                -1.158384e-03 3 1  ON 62
ci_064                -7.100013e-04 3 1  ON 63
ci_065                -8.904410e-04 3 1  ON 64
ci_066                -1.332613e-03 3 1  ON 65
ci_067                -4.816832e-04 3 1  ON 66
ci_068                -1.384787e-03 3 1  ON 67
ci_069                 6.196335e-04 3 1  ON 68
ci_070                 1.202512e-03 3 1  ON 69
ci_071                -9.412239e-04 3 1  ON 70
ci_072                -3.311616e-04 3 1  ON 71
ci_073                 1.069956e-03 3 1  ON 72
ci_074                 2.404044e-03 3 1  ON 73
ci_075                -6.890367e-04 3 1  ON 74
ci_076                -1.100416e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.5681
    reference variance = 2.52691
====================================================
  Execution time = 2.3746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6953e+00
  Total weights = 1.9493e+06
  Execution time = 4.4081e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745890566956
                                         uncertainty =       0.025786201471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745890566956
                                         uncertainty =       0.025786201471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368566752
  error estimate for blocks of size 2^( 2) =       0.001438997868
  error estimate for blocks of size 2^( 3) =       0.001501211282
  error estimate for blocks of size 2^( 4) =       0.001541751318
  error estimate for blocks of size 2^( 5) =       0.001568736033
  error estimate for blocks of size 2^( 6) =       0.001579882494
  error estimate for blocks of size 2^( 7) =       0.001585414382

      target function =                  N/A
              le_mean =     -22.327401854281
             les_mean =     502.242239578353
             stat err =       0.001568946057
             autocorr =       1.314268362714
              std dev =       1.935476629166
             le_variance =       3.746069782046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745281900291
                                         uncertainty =       0.025743836798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745281900291
                                         uncertainty =       0.025743836798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368455438
  error estimate for blocks of size 2^( 2) =       0.001438888786
  error estimate for blocks of size 2^( 3) =       0.001501103436
  error estimate for blocks of size 2^( 4) =       0.001541654358
  error estimate for blocks of size 2^( 5) =       0.001568574746
  error estimate for blocks of size 2^( 6) =       0.001579756060
  error estimate for blocks of size 2^( 7) =       0.001585162912

      target function =                  N/A
              le_mean =     -22.327349377191
             les_mean =     502.214063003188
             stat err =       0.001568787019
             autocorr =       1.314215711485
              std dev =       1.935319203903
             le_variance =       3.745460420997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746364307651
                                         uncertainty =       0.025672628608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746364307651
                                         uncertainty =       0.025672628608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368652911
  error estimate for blocks of size 2^( 2) =       0.001439079609
  error estimate for blocks of size 2^( 3) =       0.001501248594
  error estimate for blocks of size 2^( 4) =       0.001541795149
  error estimate for blocks of size 2^( 5) =       0.001568754785
  error estimate for blocks of size 2^( 6) =       0.001579964783
  error estimate for blocks of size 2^( 7) =       0.001585394352

      target function =                  N/A
              le_mean =     -22.327408399544
             les_mean =     502.434566565370
             stat err =       0.001568977267
             autocorr =       1.314155180381
              std dev =       1.935598478192
             le_variance =       3.746541468779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745174761860
                                         uncertainty =       0.025746754319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745174761860
                                         uncertainty =       0.025746754319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368436194
  error estimate for blocks of size 2^( 2) =       0.001438872408
  error estimate for blocks of size 2^( 3) =       0.001501095688
  error estimate for blocks of size 2^( 4) =       0.001541648189
  error estimate for blocks of size 2^( 5) =       0.001568589087
  error estimate for blocks of size 2^( 6) =       0.001579789895
  error estimate for blocks of size 2^( 7) =       0.001585235072

      target function =                  N/A
              le_mean =     -22.327352343334
             les_mean =     502.208865626178
             stat err =       0.001568815561
             autocorr =       1.314300496997
              std dev =       1.935291988561
             le_variance =       3.745355080987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327401854281        initial
     2.3283e-02     2.3283e-01             3.3433e-03       -22.327349377191
     9.3132e-02     9.3132e-01             2.1377e-03       -22.327408399544  <--
     3.7253e-01     3.7253e+00             8.7205e-04       -22.327352343334

*****************************************************************************
Applying the update for shift_i =   9.3132e-02     and shift_s =   9.3132e-01
*****************************************************************************

  Execution time = 4.5832e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -6.910553e-01 3 1  ON 0
ci_002                -7.096264e-01 3 1  ON 1
ci_003                -6.101733e-02 3 1  ON 2
ci_004                -6.103869e-02 3 1  ON 3
ci_005                 4.549792e-02 3 1  ON 4
ci_006                 4.642680e-02 3 1  ON 5
ci_007                 3.156293e-02 3 1  ON 6
ci_008                 3.316631e-02 3 1  ON 7
ci_009                -2.581517e-02 3 1  ON 8
ci_010                -2.472853e-02 3 1  ON 9
ci_011                -2.214230e-02 3 1  ON 10
ci_012                -2.327346e-02 3 1  ON 11
ci_013                 2.038746e-02 3 1  ON 12
ci_014                 1.972264e-02 3 1  ON 13
ci_015                 2.049374e-02 3 1  ON 14
ci_016                 2.098149e-02 3 1  ON 15
ci_017                 1.610903e-02 3 1  ON 16
ci_018                 1.559058e-02 3 1  ON 17
ci_019                 9.281656e-03 3 1  ON 18
ci_020                 9.887857e-03 3 1  ON 19
ci_021                -9.829786e-03 3 1  ON 20
ci_022                -1.161715e-02 3 1  ON 21
ci_023                 8.138045e-03 3 1  ON 22
ci_024                 8.993415e-03 3 1  ON 23
ci_025                 8.424790e-03 3 1  ON 24
ci_026                 8.204636e-03 3 1  ON 25
ci_027                 7.910649e-03 3 1  ON 26
ci_028                 8.196116e-03 3 1  ON 27
ci_029                -7.779983e-03 3 1  ON 28
ci_030                -8.099317e-03 3 1  ON 29
ci_031                -7.347755e-03 3 1  ON 30
ci_032                -7.416698e-03 3 1  ON 31
ci_033                 6.929217e-03 3 1  ON 32
ci_034                 5.333327e-03 3 1  ON 33
ci_035                 6.710999e-03 3 1  ON 34
ci_036                 6.747607e-03 3 1  ON 35
ci_037                 6.585472e-03 3 1  ON 36
ci_038                 5.511185e-03 3 1  ON 37
ci_039                 5.649291e-03 3 1  ON 38
ci_040                 6.009963e-03 3 1  ON 39
ci_041                 5.091857e-03 3 1  ON 40
ci_042                 5.198950e-03 3 1  ON 41
ci_043                 5.702505e-03 3 1  ON 42
ci_044                 6.612917e-03 3 1  ON 43
ci_045                 4.797363e-03 3 1  ON 44
ci_046                 4.697776e-03 3 1  ON 45
ci_047                -4.156218e-03 3 1  ON 46
ci_048                -3.221701e-03 3 1  ON 47
ci_049                 4.641847e-03 3 1  ON 48
ci_050                 3.610306e-03 3 1  ON 49
ci_051                -2.624973e-03 3 1  ON 50
ci_052                -3.206519e-03 3 1  ON 51
ci_053                -2.763751e-03 3 1  ON 52
ci_054                -3.178606e-03 3 1  ON 53
ci_055                -3.201980e-03 3 1  ON 54
ci_056                -1.526231e-03 3 1  ON 55
ci_057                -1.742308e-03 3 1  ON 56
ci_058                -1.005428e-03 3 1  ON 57
ci_059                -7.191562e-04 3 1  ON 58
ci_060                -1.857482e-03 3 1  ON 59
ci_061                -1.582695e-03 3 1  ON 60
ci_062                -1.775833e-03 3 1  ON 61
ci_063                -1.158384e-03 3 1  ON 62
ci_064                -7.100013e-04 3 1  ON 63
ci_065                -8.904410e-04 3 1  ON 64
ci_066                -1.332613e-03 3 1  ON 65
ci_067                -4.816832e-04 3 1  ON 66
ci_068                -1.384787e-03 3 1  ON 67
ci_069                 6.196335e-04 3 1  ON 68
ci_070                 1.202512e-03 3 1  ON 69
ci_071                -9.412239e-04 3 1  ON 70
ci_072                -3.311616e-04 3 1  ON 71
ci_073                 1.069956e-03 3 1  ON 72
ci_074                 2.404044e-03 3 1  ON 73
ci_075                -6.890367e-04 3 1  ON 74
ci_076                -1.100416e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6293e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2322e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -21.8343
    reference variance = 3.89885
====================================================
  Execution time = 2.4490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0323e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7044e+00
  Total weights = 1.949925707e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9349e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755276907169
                                         uncertainty =       0.037846213550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755276907169
                                         uncertainty =       0.037846213550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370089383
  error estimate for blocks of size 2^( 2) =       0.001441056364
  error estimate for blocks of size 2^( 3) =       0.001504563675
  error estimate for blocks of size 2^( 4) =       0.001548061011
  error estimate for blocks of size 2^( 5) =       0.001569213950
  error estimate for blocks of size 2^( 6) =       0.001585896504
  error estimate for blocks of size 2^( 7) =       0.001587326400

      target function =                  N/A
              le_mean =     -22.329212880621
             les_mean =     502.298128050649
             stat err =       0.001572624466
             autocorr =       1.317504944505
              std dev =       1.937629988922
             le_variance =       3.754409973971


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232921288062e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-02, overlap shift 2.3283e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329212879826       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329316182544       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329332623132       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329336998214       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329336621897       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329336785595       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329336981758       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e-02 is 4.487290e-03

solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329212879826       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329291695573       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329298977546       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329300172122       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329299968841       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329299990576       residual = 1.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-02 is 2.286778e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329212879826       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329253335875       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329254446681       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329254549077       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 9.563002e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110773 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0437e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -6.911377e-01 3 1  ON 0
ci_002                -7.099407e-01 3 1  ON 1
ci_003                -6.024363e-02 3 1  ON 2
ci_004                -5.875191e-02 3 1  ON 3
ci_005                 4.506909e-02 3 1  ON 4
ci_006                 4.628712e-02 3 1  ON 5
ci_007                 3.203368e-02 3 1  ON 6
ci_008                 3.313991e-02 3 1  ON 7
ci_009                -2.603490e-02 3 1  ON 8
ci_010                -2.481755e-02 3 1  ON 9
ci_011                -2.250364e-02 3 1  ON 10
ci_012                -2.383269e-02 3 1  ON 11
ci_013                 1.976758e-02 3 1  ON 12
ci_014                 2.016652e-02 3 1  ON 13
ci_015                 1.901686e-02 3 1  ON 14
ci_016                 1.937923e-02 3 1  ON 15
ci_017                 1.709545e-02 3 1  ON 16
ci_018                 1.536818e-02 3 1  ON 17
ci_019                 9.339118e-03 3 1  ON 18
ci_020                 8.679156e-03 3 1  ON 19
ci_021                -9.558423e-03 3 1  ON 20
ci_022                -1.101928e-02 3 1  ON 21
ci_023                 8.433921e-03 3 1  ON 22
ci_024                 8.588483e-03 3 1  ON 23
ci_025                 7.232658e-03 3 1  ON 24
ci_026                 8.621260e-03 3 1  ON 25
ci_027                 7.843564e-03 3 1  ON 26
ci_028                 7.492453e-03 3 1  ON 27
ci_029                -7.857986e-03 3 1  ON 28
ci_030                -7.646010e-03 3 1  ON 29
ci_031                -7.671123e-03 3 1  ON 30
ci_032                -7.512525e-03 3 1  ON 31
ci_033                 6.358428e-03 3 1  ON 32
ci_034                 7.020194e-03 3 1  ON 33
ci_035                 7.101874e-03 3 1  ON 34
ci_036                 6.221123e-03 3 1  ON 35
ci_037                 6.736664e-03 3 1  ON 36
ci_038                 5.895623e-03 3 1  ON 37
ci_039                 5.258905e-03 3 1  ON 38
ci_040                 5.387734e-03 3 1  ON 39
ci_041                 4.638914e-03 3 1  ON 40
ci_042                 5.486374e-03 3 1  ON 41
ci_043                 5.125349e-03 3 1  ON 42
ci_044                 6.010927e-03 3 1  ON 43
ci_045                 3.996939e-03 3 1  ON 44
ci_046                 4.217742e-03 3 1  ON 45
ci_047                -3.360526e-03 3 1  ON 46
ci_048                -3.708435e-03 3 1  ON 47
ci_049                 3.257180e-03 3 1  ON 48
ci_050                 4.278450e-03 3 1  ON 49
ci_051                -2.560048e-03 3 1  ON 50
ci_052                -2.328506e-03 3 1  ON 51
ci_053                -2.876755e-03 3 1  ON 52
ci_054                -3.356357e-03 3 1  ON 53
ci_055                -3.412207e-03 3 1  ON 54
ci_056                -2.150429e-03 3 1  ON 55
ci_057                -2.041482e-03 3 1  ON 56
ci_058                -2.899115e-03 3 1  ON 57
ci_059                -2.224948e-03 3 1  ON 58
ci_060                -9.950909e-04 3 1  ON 59
ci_061                -1.204356e-03 3 1  ON 60
ci_062                -1.148866e-03 3 1  ON 61
ci_063                -1.461256e-03 3 1  ON 62
ci_064                -6.491007e-04 3 1  ON 63
ci_065                -3.497215e-05 3 1  ON 64
ci_066                -1.378564e-03 3 1  ON 65
ci_067                -1.166836e-03 3 1  ON 66
ci_068                -2.241636e-03 3 1  ON 67
ci_069                 6.731467e-04 3 1  ON 68
ci_070                 9.677732e-04 3 1  ON 69
ci_071                -1.840631e-03 3 1  ON 70
ci_072                -1.374741e-03 3 1  ON 71
ci_073                 1.622656e-03 3 1  ON 72
ci_074                 1.205079e-03 3 1  ON 73
ci_075                -4.686637e-04 3 1  ON 74
ci_076                -9.032819e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.2429
    reference variance = 4.55424
====================================================
  Execution time = 2.3808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7232e+00
  Total weights = 1.9496e+06
  Execution time = 4.4091e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.11678
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772626519937
                                         uncertainty =       0.038916386910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772626519937
                                         uncertainty =       0.038916386910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373659758
  error estimate for blocks of size 2^( 2) =       0.001444021596
  error estimate for blocks of size 2^( 3) =       0.001506566744
  error estimate for blocks of size 2^( 4) =       0.001548531588
  error estimate for blocks of size 2^( 5) =       0.001574756553
  error estimate for blocks of size 2^( 6) =       0.001590392475
  error estimate for blocks of size 2^( 7) =       0.001598362931

      target function =                  N/A
              le_mean =     -22.329770896575
             les_mean =     502.379831301070
             stat err =       0.001578010887
             autocorr =       1.319658741792
              std dev =       1.942679342093
             le_variance =       3.774003026193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773134790926
                                         uncertainty =       0.038917235830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.773134790926
                                         uncertainty =       0.038917235830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373750904
  error estimate for blocks of size 2^( 2) =       0.001444136974
  error estimate for blocks of size 2^( 3) =       0.001506723751
  error estimate for blocks of size 2^( 4) =       0.001548735195
  error estimate for blocks of size 2^( 5) =       0.001574961752
  error estimate for blocks of size 2^( 6) =       0.001590437026
  error estimate for blocks of size 2^( 7) =       0.001598220700

      target function =                  N/A
              le_mean =     -22.329744879290
             les_mean =     502.450940836620
             stat err =       0.001578088668
             autocorr =       1.319613714555
              std dev =       1.942808243393
             le_variance =       3.774503870596

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.112473
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772739539005
                                         uncertainty =       0.038957282106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772739539005
                                         uncertainty =       0.038957282106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373679422
  error estimate for blocks of size 2^( 2) =       0.001444078166
  error estimate for blocks of size 2^( 3) =       0.001506660642
  error estimate for blocks of size 2^( 4) =       0.001548669670
  error estimate for blocks of size 2^( 5) =       0.001574904196
  error estimate for blocks of size 2^( 6) =       0.001590469306
  error estimate for blocks of size 2^( 7) =       0.001598284036

      target function =                  N/A
              le_mean =     -22.329791793547
             les_mean =     502.527530998130
             stat err =       0.001578081802
             autocorr =       1.319739570285
              std dev =       1.942707151268
             le_variance =       3.774111075589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775040224410
                                         uncertainty =       0.038905203152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775040224410
                                         uncertainty =       0.038905203152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374098360
  error estimate for blocks of size 2^( 2) =       0.001444449716
  error estimate for blocks of size 2^( 3) =       0.001507009292
  error estimate for blocks of size 2^( 4) =       0.001549077077
  error estimate for blocks of size 2^( 5) =       0.001575248009
  error estimate for blocks of size 2^( 6) =       0.001590892139
  error estimate for blocks of size 2^( 7) =       0.001598512444

      target function =                  N/A
              le_mean =     -22.329669312954
             les_mean =     503.297580857368
             stat err =       0.001578432417
             autocorr =       1.319521105218
              std dev =       1.943299628663
             le_variance =       3.776413446763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329770896575        initial
     2.3283e-02     2.3283e-01             4.4873e-03       -22.329744879290
     9.3132e-02     9.3132e-01             2.2868e-03       -22.329791793547  <--
     3.7253e-01     3.7253e+00             9.5630e-04       -22.329669312954

*****************************************************************************
Applying the update for shift_i =   9.3132e-02     and shift_s =   9.3132e-01
*****************************************************************************

  Execution time = 4.5914e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -6.911377e-01 3 1  ON 0
ci_002                -7.099407e-01 3 1  ON 1
ci_003                -6.024363e-02 3 1  ON 2
ci_004                -5.875191e-02 3 1  ON 3
ci_005                 4.506909e-02 3 1  ON 4
ci_006                 4.628712e-02 3 1  ON 5
ci_007                 3.203368e-02 3 1  ON 6
ci_008                 3.313991e-02 3 1  ON 7
ci_009                -2.603490e-02 3 1  ON 8
ci_010                -2.481755e-02 3 1  ON 9
ci_011                -2.250364e-02 3 1  ON 10
ci_012                -2.383269e-02 3 1  ON 11
ci_013                 1.976758e-02 3 1  ON 12
ci_014                 2.016652e-02 3 1  ON 13
ci_015                 1.901686e-02 3 1  ON 14
ci_016                 1.937923e-02 3 1  ON 15
ci_017                 1.709545e-02 3 1  ON 16
ci_018                 1.536818e-02 3 1  ON 17
ci_019                 9.339118e-03 3 1  ON 18
ci_020                 8.679156e-03 3 1  ON 19
ci_021                -9.558423e-03 3 1  ON 20
ci_022                -1.101928e-02 3 1  ON 21
ci_023                 8.433921e-03 3 1  ON 22
ci_024                 8.588483e-03 3 1  ON 23
ci_025                 7.232658e-03 3 1  ON 24
ci_026                 8.621260e-03 3 1  ON 25
ci_027                 7.843564e-03 3 1  ON 26
ci_028                 7.492453e-03 3 1  ON 27
ci_029                -7.857986e-03 3 1  ON 28
ci_030                -7.646010e-03 3 1  ON 29
ci_031                -7.671123e-03 3 1  ON 30
ci_032                -7.512525e-03 3 1  ON 31
ci_033                 6.358428e-03 3 1  ON 32
ci_034                 7.020194e-03 3 1  ON 33
ci_035                 7.101874e-03 3 1  ON 34
ci_036                 6.221123e-03 3 1  ON 35
ci_037                 6.736664e-03 3 1  ON 36
ci_038                 5.895623e-03 3 1  ON 37
ci_039                 5.258905e-03 3 1  ON 38
ci_040                 5.387734e-03 3 1  ON 39
ci_041                 4.638914e-03 3 1  ON 40
ci_042                 5.486374e-03 3 1  ON 41
ci_043                 5.125349e-03 3 1  ON 42
ci_044                 6.010927e-03 3 1  ON 43
ci_045                 3.996939e-03 3 1  ON 44
ci_046                 4.217742e-03 3 1  ON 45
ci_047                -3.360526e-03 3 1  ON 46
ci_048                -3.708435e-03 3 1  ON 47
ci_049                 3.257180e-03 3 1  ON 48
ci_050                 4.278450e-03 3 1  ON 49
ci_051                -2.560048e-03 3 1  ON 50
ci_052                -2.328506e-03 3 1  ON 51
ci_053                -2.876755e-03 3 1  ON 52
ci_054                -3.356357e-03 3 1  ON 53
ci_055                -3.412207e-03 3 1  ON 54
ci_056                -2.150429e-03 3 1  ON 55
ci_057                -2.041482e-03 3 1  ON 56
ci_058                -2.899115e-03 3 1  ON 57
ci_059                -2.224948e-03 3 1  ON 58
ci_060                -9.950909e-04 3 1  ON 59
ci_061                -1.204356e-03 3 1  ON 60
ci_062                -1.148866e-03 3 1  ON 61
ci_063                -1.461256e-03 3 1  ON 62
ci_064                -6.491007e-04 3 1  ON 63
ci_065                -3.497215e-05 3 1  ON 64
ci_066                -1.378564e-03 3 1  ON 65
ci_067                -1.166836e-03 3 1  ON 66
ci_068                -2.241636e-03 3 1  ON 67
ci_069                 6.731467e-04 3 1  ON 68
ci_070                 9.677732e-04 3 1  ON 69
ci_071                -1.840631e-03 3 1  ON 70
ci_072                -1.374741e-03 3 1  ON 71
ci_073                 1.622656e-03 3 1  ON 72
ci_074                 1.205079e-03 3 1  ON 73
ci_075                -4.686637e-04 3 1  ON 74
ci_076                -9.032819e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.1799
    reference variance = 4.09979
====================================================
  Execution time = 2.4406e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0358e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.8648e+00
  Total weights = 1.949776097e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8612e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.919324576859
                                         uncertainty =       0.148123176387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.919324576859
                                         uncertainty =       0.148123176387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001399766309
  error estimate for blocks of size 2^( 2) =       0.001468862919
  error estimate for blocks of size 2^( 3) =       0.001531590420
  error estimate for blocks of size 2^( 4) =       0.001576413895
  error estimate for blocks of size 2^( 5) =       0.001600401638
  error estimate for blocks of size 2^( 6) =       0.001612247650
  error estimate for blocks of size 2^( 7) =       0.001618626414

      target function =                  N/A
              le_mean =     -22.329114111830
             les_mean =     502.454146807657
             stat err =       0.001601922399
             autocorr =       1.309700145753
              std dev =       1.979600170578
             le_variance =       3.918816835352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232911411183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-02, overlap shift 2.3283e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329114111042       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329255705296       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329272764075       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329273889126       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329273997611       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329274025664       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329275037042       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.329274320559       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.329274871027       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.329274983264       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e-02 is 3.489878e-03

solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329114111042       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329220096741       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329227421848       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329227455126       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329227415811       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329227387843       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-02 is 2.496944e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329114111042       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329166946406       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329168025254       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329167962480       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 1.191301e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0280e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -6.905274e-01 3 1  ON 0
ci_002                -7.105366e-01 3 1  ON 1
ci_003                -6.138670e-02 3 1  ON 2
ci_004                -5.821260e-02 3 1  ON 3
ci_005                 4.574561e-02 3 1  ON 4
ci_006                 4.628769e-02 3 1  ON 5
ci_007                 3.171747e-02 3 1  ON 6
ci_008                 3.120337e-02 3 1  ON 7
ci_009                -2.522570e-02 3 1  ON 8
ci_010                -2.487996e-02 3 1  ON 9
ci_011                -2.118156e-02 3 1  ON 10
ci_012                -2.271490e-02 3 1  ON 11
ci_013                 1.942161e-02 3 1  ON 12
ci_014                 2.231920e-02 3 1  ON 13
ci_015                 1.978690e-02 3 1  ON 14
ci_016                 2.077083e-02 3 1  ON 15
ci_017                 1.559892e-02 3 1  ON 16
ci_018                 1.495125e-02 3 1  ON 17
ci_019                 9.304361e-03 3 1  ON 18
ci_020                 9.236504e-03 3 1  ON 19
ci_021                -9.743623e-03 3 1  ON 20
ci_022                -1.173695e-02 3 1  ON 21
ci_023                 8.955563e-03 3 1  ON 22
ci_024                 9.032735e-03 3 1  ON 23
ci_025                 7.000688e-03 3 1  ON 24
ci_026                 8.642282e-03 3 1  ON 25
ci_027                 8.163073e-03 3 1  ON 26
ci_028                 8.386254e-03 3 1  ON 27
ci_029                -7.598839e-03 3 1  ON 28
ci_030                -7.595395e-03 3 1  ON 29
ci_031                -7.559443e-03 3 1  ON 30
ci_032                -7.620529e-03 3 1  ON 31
ci_033                 7.370786e-03 3 1  ON 32
ci_034                 7.072280e-03 3 1  ON 33
ci_035                 5.782455e-03 3 1  ON 34
ci_036                 6.253240e-03 3 1  ON 35
ci_037                 6.508418e-03 3 1  ON 36
ci_038                 8.392567e-03 3 1  ON 37
ci_039                 5.569690e-03 3 1  ON 38
ci_040                 5.468613e-03 3 1  ON 39
ci_041                 5.012335e-03 3 1  ON 40
ci_042                 5.171915e-03 3 1  ON 41
ci_043                 4.418322e-03 3 1  ON 42
ci_044                 6.147103e-03 3 1  ON 43
ci_045                 3.752206e-03 3 1  ON 44
ci_046                 5.442277e-03 3 1  ON 45
ci_047                -3.606890e-03 3 1  ON 46
ci_048                -3.966700e-03 3 1  ON 47
ci_049                 1.936869e-03 3 1  ON 48
ci_050                 3.053497e-03 3 1  ON 49
ci_051                -2.542099e-03 3 1  ON 50
ci_052                -1.663885e-03 3 1  ON 51
ci_053                -3.236996e-03 3 1  ON 52
ci_054                -3.283168e-03 3 1  ON 53
ci_055                -1.979243e-03 3 1  ON 54
ci_056                -3.469591e-03 3 1  ON 55
ci_057                -2.177008e-03 3 1  ON 56
ci_058                -2.672619e-03 3 1  ON 57
ci_059                -2.704450e-03 3 1  ON 58
ci_060                -1.985576e-03 3 1  ON 59
ci_061                -7.764194e-04 3 1  ON 60
ci_062                -2.148623e-03 3 1  ON 61
ci_063                -2.483491e-03 3 1  ON 62
ci_064                -7.448249e-04 3 1  ON 63
ci_065                -8.887069e-04 3 1  ON 64
ci_066                -1.225481e-03 3 1  ON 65
ci_067                -2.308622e-03 3 1  ON 66
ci_068                -2.117482e-03 3 1  ON 67
ci_069                 1.055761e-03 3 1  ON 68
ci_070                 1.028123e-03 3 1  ON 69
ci_071                -1.841465e-03 3 1  ON 70
ci_072                -1.155821e-03 3 1  ON 71
ci_073                 7.742674e-04 3 1  ON 72
ci_074                 1.991255e-03 3 1  ON 73
ci_075                -1.129798e-03 3 1  ON 74
ci_076                -6.042335e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.4001
    reference variance = 2.89798
====================================================
  Execution time = 2.3822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6903e+00
  Total weights = 1.9496e+06
  Execution time = 4.4107e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0210974
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741904760922
                                         uncertainty =       0.026412469619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741904760922
                                         uncertainty =       0.026412469619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367773949
  error estimate for blocks of size 2^( 2) =       0.001438836104
  error estimate for blocks of size 2^( 3) =       0.001501398034
  error estimate for blocks of size 2^( 4) =       0.001546913841
  error estimate for blocks of size 2^( 5) =       0.001572488201
  error estimate for blocks of size 2^( 6) =       0.001585081034
  error estimate for blocks of size 2^( 7) =       0.001590580943

      target function =                  N/A
              le_mean =     -22.329154791401
             les_mean =     502.297180759892
             stat err =       0.001573766005
             autocorr =       1.323889274362
              std dev =       1.934355418445
             le_variance =       3.741730884867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746467925139
                                         uncertainty =       0.027033153744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.746467925139
                                         uncertainty =       0.027033153744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368608164
  error estimate for blocks of size 2^( 2) =       0.001439649989
  error estimate for blocks of size 2^( 3) =       0.001502222809
  error estimate for blocks of size 2^( 4) =       0.001547726674
  error estimate for blocks of size 2^( 5) =       0.001573239286
  error estimate for blocks of size 2^( 6) =       0.001586021351
  error estimate for blocks of size 2^( 7) =       0.001591690774

      target function =                  N/A
              le_mean =     -22.329166158670
             les_mean =     502.758367095448
             stat err =       0.001574669522
             autocorr =       1.323794554821
              std dev =       1.935535195377
             le_variance =       3.746296492542

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0216168
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742719080212
                                         uncertainty =       0.026429207383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742719080212
                                         uncertainty =       0.026429207383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367923609
  error estimate for blocks of size 2^( 2) =       0.001438966636
  error estimate for blocks of size 2^( 3) =       0.001501541551
  error estimate for blocks of size 2^( 4) =       0.001547019739
  error estimate for blocks of size 2^( 5) =       0.001572530574
  error estimate for blocks of size 2^( 6) =       0.001585156295
  error estimate for blocks of size 2^( 7) =       0.001590810427

      target function =                  N/A
              le_mean =     -22.329203889507
             les_mean =     502.339657234941
             stat err =       0.001573879259
             autocorr =       1.323790115562
              std dev =       1.934567072575
             le_variance =       3.742549758290

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.143621
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741644634200
                                         uncertainty =       0.026426432205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741644634200
                                         uncertainty =       0.026426432205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367726640
  error estimate for blocks of size 2^( 2) =       0.001438788330
  error estimate for blocks of size 2^( 3) =       0.001501348203
  error estimate for blocks of size 2^( 4) =       0.001546848258
  error estimate for blocks of size 2^( 5) =       0.001572418184
  error estimate for blocks of size 2^( 6) =       0.001585011776
  error estimate for blocks of size 2^( 7) =       0.001590536364

      target function =                  N/A
              le_mean =     -22.329105244616
             les_mean =     502.283426908871
             stat err =       0.001573703645
             autocorr =       1.323875939733
              std dev =       1.934288512230
             le_variance =       3.741472048544


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329154791401        initial
     2.3283e-02     2.3283e-01             3.4899e-03       -22.329166158670
     9.3132e-02     9.3132e-01             2.4969e-03       -22.329203889507  <--
     3.7253e-01     3.7253e+00             1.1913e-03       -22.329105244616

*****************************************************************************
Applying the update for shift_i =   9.3132e-02     and shift_s =   9.3132e-01
*****************************************************************************

  Execution time = 4.5945e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -6.905274e-01 3 1  ON 0
ci_002                -7.105366e-01 3 1  ON 1
ci_003                -6.138670e-02 3 1  ON 2
ci_004                -5.821260e-02 3 1  ON 3
ci_005                 4.574561e-02 3 1  ON 4
ci_006                 4.628769e-02 3 1  ON 5
ci_007                 3.171747e-02 3 1  ON 6
ci_008                 3.120337e-02 3 1  ON 7
ci_009                -2.522570e-02 3 1  ON 8
ci_010                -2.487996e-02 3 1  ON 9
ci_011                -2.118156e-02 3 1  ON 10
ci_012                -2.271490e-02 3 1  ON 11
ci_013                 1.942161e-02 3 1  ON 12
ci_014                 2.231920e-02 3 1  ON 13
ci_015                 1.978690e-02 3 1  ON 14
ci_016                 2.077083e-02 3 1  ON 15
ci_017                 1.559892e-02 3 1  ON 16
ci_018                 1.495125e-02 3 1  ON 17
ci_019                 9.304361e-03 3 1  ON 18
ci_020                 9.236504e-03 3 1  ON 19
ci_021                -9.743623e-03 3 1  ON 20
ci_022                -1.173695e-02 3 1  ON 21
ci_023                 8.955563e-03 3 1  ON 22
ci_024                 9.032735e-03 3 1  ON 23
ci_025                 7.000688e-03 3 1  ON 24
ci_026                 8.642282e-03 3 1  ON 25
ci_027                 8.163073e-03 3 1  ON 26
ci_028                 8.386254e-03 3 1  ON 27
ci_029                -7.598839e-03 3 1  ON 28
ci_030                -7.595395e-03 3 1  ON 29
ci_031                -7.559443e-03 3 1  ON 30
ci_032                -7.620529e-03 3 1  ON 31
ci_033                 7.370786e-03 3 1  ON 32
ci_034                 7.072280e-03 3 1  ON 33
ci_035                 5.782455e-03 3 1  ON 34
ci_036                 6.253240e-03 3 1  ON 35
ci_037                 6.508418e-03 3 1  ON 36
ci_038                 8.392567e-03 3 1  ON 37
ci_039                 5.569690e-03 3 1  ON 38
ci_040                 5.468613e-03 3 1  ON 39
ci_041                 5.012335e-03 3 1  ON 40
ci_042                 5.171915e-03 3 1  ON 41
ci_043                 4.418322e-03 3 1  ON 42
ci_044                 6.147103e-03 3 1  ON 43
ci_045                 3.752206e-03 3 1  ON 44
ci_046                 5.442277e-03 3 1  ON 45
ci_047                -3.606890e-03 3 1  ON 46
ci_048                -3.966700e-03 3 1  ON 47
ci_049                 1.936869e-03 3 1  ON 48
ci_050                 3.053497e-03 3 1  ON 49
ci_051                -2.542099e-03 3 1  ON 50
ci_052                -1.663885e-03 3 1  ON 51
ci_053                -3.236996e-03 3 1  ON 52
ci_054                -3.283168e-03 3 1  ON 53
ci_055                -1.979243e-03 3 1  ON 54
ci_056                -3.469591e-03 3 1  ON 55
ci_057                -2.177008e-03 3 1  ON 56
ci_058                -2.672619e-03 3 1  ON 57
ci_059                -2.704450e-03 3 1  ON 58
ci_060                -1.985576e-03 3 1  ON 59
ci_061                -7.764194e-04 3 1  ON 60
ci_062                -2.148623e-03 3 1  ON 61
ci_063                -2.483491e-03 3 1  ON 62
ci_064                -7.448249e-04 3 1  ON 63
ci_065                -8.887069e-04 3 1  ON 64
ci_066                -1.225481e-03 3 1  ON 65
ci_067                -2.308622e-03 3 1  ON 66
ci_068                -2.117482e-03 3 1  ON 67
ci_069                 1.055761e-03 3 1  ON 68
ci_070                 1.028123e-03 3 1  ON 69
ci_071                -1.841465e-03 3 1  ON 70
ci_072                -1.155821e-03 3 1  ON 71
ci_073                 7.742674e-04 3 1  ON 72
ci_074                 1.991255e-03 3 1  ON 73
ci_075                -1.129798e-03 3 1  ON 74
ci_076                -6.042335e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6239e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.738
    reference variance = 3.83282
====================================================
  Execution time = 2.4386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0304e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6791e+00
  Total weights = 1.950212137e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9214e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.728481917246
                                         uncertainty =       0.026038150083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.728481917246
                                         uncertainty =       0.026038150083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365433474
  error estimate for blocks of size 2^( 2) =       0.001437805361
  error estimate for blocks of size 2^( 3) =       0.001500964818
  error estimate for blocks of size 2^( 4) =       0.001541289374
  error estimate for blocks of size 2^( 5) =       0.001570805074
  error estimate for blocks of size 2^( 6) =       0.001585102913
  error estimate for blocks of size 2^( 7) =       0.001595192886

      target function =                  N/A
              le_mean =     -22.327200049805
             les_mean =     502.182955342049
             stat err =       0.001573097562
             autocorr =       1.327303455500
              std dev =       1.931045433278
             le_variance =       3.728936465382


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232720004980e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-02, overlap shift 2.3283e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327200048942       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327333279942       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327358293628       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327363869438       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327366742899       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327366266110       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327365881121       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327365507020       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.327365516343       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e-02 is 7.064080e-03

solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327200048942       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327300211817       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327311103334       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327311904157       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327312389633       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327312279977       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-02 is 3.724967e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327200048942       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327250310510       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327252094483       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327252056934       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e-01 is 1.284084e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120717 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0320e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -6.909172e-01 3 1  ON 0
ci_002                -7.096154e-01 3 1  ON 1
ci_003                -6.300011e-02 3 1  ON 2
ci_004                -6.193756e-02 3 1  ON 3
ci_005                 4.476231e-02 3 1  ON 4
ci_006                 4.709288e-02 3 1  ON 5
ci_007                 3.102388e-02 3 1  ON 6
ci_008                 3.238244e-02 3 1  ON 7
ci_009                -2.547045e-02 3 1  ON 8
ci_010                -2.486616e-02 3 1  ON 9
ci_011                -2.150707e-02 3 1  ON 10
ci_012                -2.351581e-02 3 1  ON 11
ci_013                 1.982543e-02 3 1  ON 12
ci_014                 2.198468e-02 3 1  ON 13
ci_015                 1.990892e-02 3 1  ON 14
ci_016                 2.125018e-02 3 1  ON 15
ci_017                 1.639641e-02 3 1  ON 16
ci_018                 1.543776e-02 3 1  ON 17
ci_019                 9.056839e-03 3 1  ON 18
ci_020                 9.303063e-03 3 1  ON 19
ci_021                -1.099747e-02 3 1  ON 20
ci_022                -1.176592e-02 3 1  ON 21
ci_023                 8.496586e-03 3 1  ON 22
ci_024                 9.636294e-03 3 1  ON 23
ci_025                 6.730525e-03 3 1  ON 24
ci_026                 8.128064e-03 3 1  ON 25
ci_027                 7.747370e-03 3 1  ON 26
ci_028                 8.156247e-03 3 1  ON 27
ci_029                -9.229912e-03 3 1  ON 28
ci_030                -8.012590e-03 3 1  ON 29
ci_031                -6.578746e-03 3 1  ON 30
ci_032                -7.887005e-03 3 1  ON 31
ci_033                 6.795919e-03 3 1  ON 32
ci_034                 7.600437e-03 3 1  ON 33
ci_035                 6.304542e-03 3 1  ON 34
ci_036                 6.355253e-03 3 1  ON 35
ci_037                 6.826974e-03 3 1  ON 36
ci_038                 6.916315e-03 3 1  ON 37
ci_039                 5.237446e-03 3 1  ON 38
ci_040                 5.852009e-03 3 1  ON 39
ci_041                 4.276340e-03 3 1  ON 40
ci_042                 5.503945e-03 3 1  ON 41
ci_043                 6.298722e-03 3 1  ON 42
ci_044                 5.477055e-03 3 1  ON 43
ci_045                 5.266524e-03 3 1  ON 44
ci_046                 4.900777e-03 3 1  ON 45
ci_047                -3.592461e-03 3 1  ON 46
ci_048                -3.633539e-03 3 1  ON 47
ci_049                 2.152624e-03 3 1  ON 48
ci_050                 3.470417e-03 3 1  ON 49
ci_051                -2.879209e-03 3 1  ON 50
ci_052                -1.724369e-03 3 1  ON 51
ci_053                -2.166780e-03 3 1  ON 52
ci_054                -2.588485e-03 3 1  ON 53
ci_055                -1.540967e-03 3 1  ON 54
ci_056                -3.659982e-03 3 1  ON 55
ci_057                -3.641675e-03 3 1  ON 56
ci_058                -2.138239e-03 3 1  ON 57
ci_059                -1.688324e-03 3 1  ON 58
ci_060                -1.456123e-03 3 1  ON 59
ci_061                -2.120180e-03 3 1  ON 60
ci_062                -1.593481e-03 3 1  ON 61
ci_063                -1.984932e-03 3 1  ON 62
ci_064                -1.155144e-03 3 1  ON 63
ci_065                -1.081027e-03 3 1  ON 64
ci_066                -1.443806e-03 3 1  ON 65
ci_067                -1.471781e-03 3 1  ON 66
ci_068                -1.219982e-03 3 1  ON 67
ci_069                 1.840168e-03 3 1  ON 68
ci_070                 1.160587e-03 3 1  ON 69
ci_071                -1.807265e-03 3 1  ON 70
ci_072                -1.598781e-03 3 1  ON 71
ci_073                 1.641921e-03 3 1  ON 72
ci_074                 1.731518e-03 3 1  ON 73
ci_075                -8.992471e-04 3 1  ON 74
ci_076                -1.255849e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.4944
    reference variance = 2.64228
====================================================
  Execution time = 2.3716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.8054e+00
  Total weights = 1.9496e+06
  Execution time = 4.3911e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00144006
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.861907040391
                                         uncertainty =       0.045578220535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.861907040391
                                         uncertainty =       0.045578220535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389559117
  error estimate for blocks of size 2^( 2) =       0.001459994633
  error estimate for blocks of size 2^( 3) =       0.001523713053
  error estimate for blocks of size 2^( 4) =       0.001569059089
  error estimate for blocks of size 2^( 5) =       0.001588771986
  error estimate for blocks of size 2^( 6) =       0.001601414557
  error estimate for blocks of size 2^( 7) =       0.001612729617

      target function =                  N/A
              le_mean =     -22.325920254429
             les_mean =     502.438094305688
             stat err =       0.001592993812
             autocorr =       1.314238307349
              std dev =       1.965164790435
             le_variance =       3.861872653566

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0185297
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860330255924
                                         uncertainty =       0.045665949320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860330255924
                                         uncertainty =       0.045665949320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389275548
  error estimate for blocks of size 2^( 2) =       0.001459705048
  error estimate for blocks of size 2^( 3) =       0.001523404410
  error estimate for blocks of size 2^( 4) =       0.001568766251
  error estimate for blocks of size 2^( 5) =       0.001588454552
  error estimate for blocks of size 2^( 6) =       0.001600969732
  error estimate for blocks of size 2^( 7) =       0.001612396977

      target function =                  N/A
              le_mean =     -22.325827528501
             les_mean =     502.293419789314
             stat err =       0.001592646878
             autocorr =       1.314202245933
              std dev =       1.964763757612
             le_variance =       3.860296623224

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00142646
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860539459970
                                         uncertainty =       0.045657289285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.860539459970
                                         uncertainty =       0.045657289285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389313070
  error estimate for blocks of size 2^( 2) =       0.001459734003
  error estimate for blocks of size 2^( 3) =       0.001523417809
  error estimate for blocks of size 2^( 4) =       0.001568761999
  error estimate for blocks of size 2^( 5) =       0.001588474960
  error estimate for blocks of size 2^( 6) =       0.001600953833
  error estimate for blocks of size 2^( 7) =       0.001612398672

      target function =                  N/A
              le_mean =     -22.325881794001
             les_mean =     502.260182258933
             stat err =       0.001592647366
             autocorr =       1.314132065924
              std dev =       1.964816822190
             le_variance =       3.860505144759

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0111947
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859727799798
                                         uncertainty =       0.045639714255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.859727799798
                                         uncertainty =       0.045639714255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001389167015
  error estimate for blocks of size 2^( 2) =       0.001459633551
  error estimate for blocks of size 2^( 3) =       0.001523373111
  error estimate for blocks of size 2^( 4) =       0.001568753994
  error estimate for blocks of size 2^( 5) =       0.001588486353
  error estimate for blocks of size 2^( 6) =       0.001601009839
  error estimate for blocks of size 2^( 7) =       0.001612468987

      target function =                  N/A
              le_mean =     -22.325839146243
             les_mean =     502.256872580917
             stat err =       0.001592679793
             autocorr =       1.314461936030
              std dev =       1.964610266619
             le_variance =       3.859693499706


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325920254429        initial  <--
     2.3283e-02     2.3283e-01             7.0641e-03       -22.325827528501
     9.3132e-02     9.3132e-01             3.7250e-03       -22.325881794001
     3.7253e-01     3.7253e+00             1.2841e-03       -22.325839146243

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7364
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -6.905274e-01 3 1  ON 0
ci_002                -7.105366e-01 3 1  ON 1
ci_003                -6.138670e-02 3 1  ON 2
ci_004                -5.821260e-02 3 1  ON 3
ci_005                 4.574561e-02 3 1  ON 4
ci_006                 4.628769e-02 3 1  ON 5
ci_007                 3.171747e-02 3 1  ON 6
ci_008                 3.120337e-02 3 1  ON 7
ci_009                -2.522570e-02 3 1  ON 8
ci_010                -2.487996e-02 3 1  ON 9
ci_011                -2.118156e-02 3 1  ON 10
ci_012                -2.271490e-02 3 1  ON 11
ci_013                 1.942161e-02 3 1  ON 12
ci_014                 2.231920e-02 3 1  ON 13
ci_015                 1.978690e-02 3 1  ON 14
ci_016                 2.077083e-02 3 1  ON 15
ci_017                 1.559892e-02 3 1  ON 16
ci_018                 1.495125e-02 3 1  ON 17
ci_019                 9.304361e-03 3 1  ON 18
ci_020                 9.236504e-03 3 1  ON 19
ci_021                -9.743623e-03 3 1  ON 20
ci_022                -1.173695e-02 3 1  ON 21
ci_023                 8.955563e-03 3 1  ON 22
ci_024                 9.032735e-03 3 1  ON 23
ci_025                 7.000688e-03 3 1  ON 24
ci_026                 8.642282e-03 3 1  ON 25
ci_027                 8.163073e-03 3 1  ON 26
ci_028                 8.386254e-03 3 1  ON 27
ci_029                -7.598839e-03 3 1  ON 28
ci_030                -7.595395e-03 3 1  ON 29
ci_031                -7.559443e-03 3 1  ON 30
ci_032                -7.620529e-03 3 1  ON 31
ci_033                 7.370786e-03 3 1  ON 32
ci_034                 7.072280e-03 3 1  ON 33
ci_035                 5.782455e-03 3 1  ON 34
ci_036                 6.253240e-03 3 1  ON 35
ci_037                 6.508418e-03 3 1  ON 36
ci_038                 8.392567e-03 3 1  ON 37
ci_039                 5.569690e-03 3 1  ON 38
ci_040                 5.468613e-03 3 1  ON 39
ci_041                 5.012335e-03 3 1  ON 40
ci_042                 5.171915e-03 3 1  ON 41
ci_043                 4.418322e-03 3 1  ON 42
ci_044                 6.147103e-03 3 1  ON 43
ci_045                 3.752206e-03 3 1  ON 44
ci_046                 5.442277e-03 3 1  ON 45
ci_047                -3.606890e-03 3 1  ON 46
ci_048                -3.966700e-03 3 1  ON 47
ci_049                 1.936869e-03 3 1  ON 48
ci_050                 3.053497e-03 3 1  ON 49
ci_051                -2.542099e-03 3 1  ON 50
ci_052                -1.663885e-03 3 1  ON 51
ci_053                -3.236996e-03 3 1  ON 52
ci_054                -3.283168e-03 3 1  ON 53
ci_055                -1.979243e-03 3 1  ON 54
ci_056                -3.469591e-03 3 1  ON 55
ci_057                -2.177008e-03 3 1  ON 56
ci_058                -2.672619e-03 3 1  ON 57
ci_059                -2.704450e-03 3 1  ON 58
ci_060                -1.985576e-03 3 1  ON 59
ci_061                -7.764194e-04 3 1  ON 60
ci_062                -2.148623e-03 3 1  ON 61
ci_063                -2.483491e-03 3 1  ON 62
ci_064                -7.448249e-04 3 1  ON 63
ci_065                -8.887069e-04 3 1  ON 64
ci_066                -1.225481e-03 3 1  ON 65
ci_067                -2.308622e-03 3 1  ON 66
ci_068                -2.117482e-03 3 1  ON 67
ci_069                 1.055761e-03 3 1  ON 68
ci_070                 1.028123e-03 3 1  ON 69
ci_071                -1.841465e-03 3 1  ON 70
ci_072                -1.155821e-03 3 1  ON 71
ci_073                 7.742674e-04 3 1  ON 72
ci_074                 1.991255e-03 3 1  ON 73
ci_075                -1.129798e-03 3 1  ON 74
ci_076                -6.042335e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6084e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2321e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.1162
    reference variance = 2.83063
====================================================
  Execution time = 2.4323e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0322e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7874e+00
  Total weights = 1.950212592e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9236e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841533885612
                                         uncertainty =       0.046468826614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841533885612
                                         uncertainty =       0.046468826614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385845441
  error estimate for blocks of size 2^( 2) =       0.001455830927
  error estimate for blocks of size 2^( 3) =       0.001518227198
  error estimate for blocks of size 2^( 4) =       0.001560052804
  error estimate for blocks of size 2^( 5) =       0.001582842519
  error estimate for blocks of size 2^( 6) =       0.001593999510
  error estimate for blocks of size 2^( 7) =       0.001597154619

      target function =                  N/A
              le_mean =     -22.325736944229
             les_mean =     502.225905678253
             stat err =       0.001583512363
             autocorr =       1.305609561153
              std dev =       1.959912775975
             le_variance =       3.841258089430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232573694423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325736943439       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325814755415       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325817186596       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325816853759       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325817056950       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e-01 is 1.531055e-03

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325736943439       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325766257063       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325766446459       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325766403592       residual = 9.99e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-01 is 5.612309e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325736943439       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325745335259       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325745347093       residual = 7.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+00 is 1.588490e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124199 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0257e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -6.904276e-01 3 1  ON 0
ci_002                -7.106554e-01 3 1  ON 1
ci_003                -6.126789e-02 3 1  ON 2
ci_004                -5.845617e-02 3 1  ON 3
ci_005                 4.569282e-02 3 1  ON 4
ci_006                 4.613308e-02 3 1  ON 5
ci_007                 3.148356e-02 3 1  ON 6
ci_008                 3.134143e-02 3 1  ON 7
ci_009                -2.506175e-02 3 1  ON 8
ci_010                -2.506319e-02 3 1  ON 9
ci_011                -2.113662e-02 3 1  ON 10
ci_012                -2.277045e-02 3 1  ON 11
ci_013                 1.955572e-02 3 1  ON 12
ci_014                 2.206100e-02 3 1  ON 13
ci_015                 1.992595e-02 3 1  ON 14
ci_016                 2.057014e-02 3 1  ON 15
ci_017                 1.567307e-02 3 1  ON 16
ci_018                 1.514501e-02 3 1  ON 17
ci_019                 9.201330e-03 3 1  ON 18
ci_020                 9.390262e-03 3 1  ON 19
ci_021                -9.591276e-03 3 1  ON 20
ci_022                -1.132385e-02 3 1  ON 21
ci_023                 8.850634e-03 3 1  ON 22
ci_024                 9.007999e-03 3 1  ON 23
ci_025                 7.037803e-03 3 1  ON 24
ci_026                 8.817184e-03 3 1  ON 25
ci_027                 8.183841e-03 3 1  ON 26
ci_028                 8.373795e-03 3 1  ON 27
ci_029                -7.816416e-03 3 1  ON 28
ci_030                -7.679312e-03 3 1  ON 29
ci_031                -7.697215e-03 3 1  ON 30
ci_032                -7.702491e-03 3 1  ON 31
ci_033                 7.421102e-03 3 1  ON 32
ci_034                 7.004126e-03 3 1  ON 33
ci_035                 5.874539e-03 3 1  ON 34
ci_036                 6.446150e-03 3 1  ON 35
ci_037                 6.129637e-03 3 1  ON 36
ci_038                 7.831336e-03 3 1  ON 37
ci_039                 5.428260e-03 3 1  ON 38
ci_040                 5.589513e-03 3 1  ON 39
ci_041                 4.740438e-03 3 1  ON 40
ci_042                 5.276455e-03 3 1  ON 41
ci_043                 4.664421e-03 3 1  ON 42
ci_044                 5.831333e-03 3 1  ON 43
ci_045                 3.916080e-03 3 1  ON 44
ci_046                 5.456172e-03 3 1  ON 45
ci_047                -3.640357e-03 3 1  ON 46
ci_048                -4.285882e-03 3 1  ON 47
ci_049                 2.200475e-03 3 1  ON 48
ci_050                 3.015207e-03 3 1  ON 49
ci_051                -2.612315e-03 3 1  ON 50
ci_052                -1.880685e-03 3 1  ON 51
ci_053                -3.316638e-03 3 1  ON 52
ci_054                -3.126914e-03 3 1  ON 53
ci_055                -1.881320e-03 3 1  ON 54
ci_056                -2.994379e-03 3 1  ON 55
ci_057                -1.929735e-03 3 1  ON 56
ci_058                -2.713443e-03 3 1  ON 57
ci_059                -2.370616e-03 3 1  ON 58
ci_060                -1.811999e-03 3 1  ON 59
ci_061                -1.112930e-03 3 1  ON 60
ci_062                -2.222939e-03 3 1  ON 61
ci_063                -2.410391e-03 3 1  ON 62
ci_064                -8.984204e-04 3 1  ON 63
ci_065                -8.773194e-04 3 1  ON 64
ci_066                -1.234363e-03 3 1  ON 65
ci_067                -2.311424e-03 3 1  ON 66
ci_068                -1.654007e-03 3 1  ON 67
ci_069                 1.149661e-03 3 1  ON 68
ci_070                 1.306111e-03 3 1  ON 69
ci_071                -1.794382e-03 3 1  ON 70
ci_072                -1.092838e-03 3 1  ON 71
ci_073                 1.027739e-03 3 1  ON 72
ci_074                 1.790798e-03 3 1  ON 73
ci_075                -1.071427e-03 3 1  ON 74
ci_076                -3.400820e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.5335
    reference variance = 6.50596
====================================================
  Execution time = 2.3822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7473e+00
  Total weights = 1.9497e+06
  Execution time = 4.4154e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799957151924
                                         uncertainty =       0.050162627767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799957151924
                                         uncertainty =       0.050162627767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378410412
  error estimate for blocks of size 2^( 2) =       0.001449279776
  error estimate for blocks of size 2^( 3) =       0.001511876089
  error estimate for blocks of size 2^( 4) =       0.001554436472
  error estimate for blocks of size 2^( 5) =       0.001581293037
  error estimate for blocks of size 2^( 6) =       0.001593557303
  error estimate for blocks of size 2^( 7) =       0.001595770265

      target function =                  N/A
              le_mean =     -22.326390054311
             les_mean =     502.237406150025
             stat err =       0.001581264269
             autocorr =       1.315987686122
              std dev =       1.949397888132
             le_variance =       3.800152126253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799923717228
                                         uncertainty =       0.050164951166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799923717228
                                         uncertainty =       0.050164951166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378404279
  error estimate for blocks of size 2^( 2) =       0.001449283589
  error estimate for blocks of size 2^( 3) =       0.001511893338
  error estimate for blocks of size 2^( 4) =       0.001554494286
  error estimate for blocks of size 2^( 5) =       0.001581352322
  error estimate for blocks of size 2^( 6) =       0.001593617237
  error estimate for blocks of size 2^( 7) =       0.001595830700

      target function =                  N/A
              le_mean =     -22.326387864924
             les_mean =     502.225606149622
             stat err =       0.001581323636
             autocorr =       1.316098213218
              std dev =       1.949389215359
             le_variance =       3.800118312959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799892774210
                                         uncertainty =       0.050164957930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.799892774210
                                         uncertainty =       0.050164957930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378398686
  error estimate for blocks of size 2^( 2) =       0.001449275742
  error estimate for blocks of size 2^( 3) =       0.001511880856
  error estimate for blocks of size 2^( 4) =       0.001554468282
  error estimate for blocks of size 2^( 5) =       0.001581332676
  error estimate for blocks of size 2^( 6) =       0.001593584812
  error estimate for blocks of size 2^( 7) =       0.001595799165

      target function =                  N/A
              le_mean =     -22.326385237061
             les_mean =     502.216125179991
             stat err =       0.001581296234
             autocorr =       1.316063280935
              std dev =       1.949381305593
             le_variance =       3.800087474594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800051287203
                                         uncertainty =       0.050163799585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800051287203
                                         uncertainty =       0.050163799585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378427405
  error estimate for blocks of size 2^( 2) =       0.001449294999
  error estimate for blocks of size 2^( 3) =       0.001511886865
  error estimate for blocks of size 2^( 4) =       0.001554459992
  error estimate for blocks of size 2^( 5) =       0.001581317168
  error estimate for blocks of size 2^( 6) =       0.001593589560
  error estimate for blocks of size 2^( 7) =       0.001595770526

      target function =                  N/A
              le_mean =     -22.326394678740
             les_mean =     502.432084775515
             stat err =       0.001581284311
             autocorr =       1.315988597520
              std dev =       1.949421921010
             le_variance =       3.800245826115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326390054311        initial
     2.3283e-01     2.3283e+00             1.5311e-03       -22.326387864924
     9.3132e-01     9.3132e+00             5.6123e-04       -22.326385237061
     3.7253e+00     3.7253e+01             1.5885e-04       -22.326394678740  <--

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 4.5963e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -6.905034e-01 3 1  ON 0
ci_002                -7.105666e-01 3 1  ON 1
ci_003                -6.135582e-02 3 1  ON 2
ci_004                -5.827530e-02 3 1  ON 3
ci_005                 4.572908e-02 3 1  ON 4
ci_006                 4.624143e-02 3 1  ON 5
ci_007                 3.165088e-02 3 1  ON 6
ci_008                 3.124035e-02 3 1  ON 7
ci_009                -2.517745e-02 3 1  ON 8
ci_010                -2.493005e-02 3 1  ON 9
ci_011                -2.116946e-02 3 1  ON 10
ci_012                -2.273043e-02 3 1  ON 11
ci_013                 1.946039e-02 3 1  ON 12
ci_014                 2.225059e-02 3 1  ON 13
ci_015                 1.982453e-02 3 1  ON 14
ci_016                 2.071629e-02 3 1  ON 15
ci_017                 1.561686e-02 3 1  ON 16
ci_018                 1.500621e-02 3 1  ON 17
ci_019                 9.277357e-03 3 1  ON 18
ci_020                 9.281329e-03 3 1  ON 19
ci_021                -9.701913e-03 3 1  ON 20
ci_022                -1.162250e-02 3 1  ON 21
ci_023                 8.925109e-03 3 1  ON 22
ci_024                 9.025581e-03 3 1  ON 23
ci_025                 7.010985e-03 3 1  ON 24
ci_026                 8.691803e-03 3 1  ON 25
ci_027                 8.168526e-03 3 1  ON 26
ci_028                 8.382002e-03 3 1  ON 27
ci_029                -7.661385e-03 3 1  ON 28
ci_030                -7.618047e-03 3 1  ON 29
ci_031                -7.597560e-03 3 1  ON 30
ci_032                -7.639701e-03 3 1  ON 31
ci_033                 7.385607e-03 3 1  ON 32
ci_034                 7.053613e-03 3 1  ON 33
ci_035                 5.810888e-03 3 1  ON 34
ci_036                 6.311628e-03 3 1  ON 35
ci_037                 6.400764e-03 3 1  ON 36
ci_038                 8.233718e-03 3 1  ON 37
ci_039                 5.526087e-03 3 1  ON 38
ci_040                 5.504985e-03 3 1  ON 39
ci_041                 4.931868e-03 3 1  ON 40
ci_042                 5.202870e-03 3 1  ON 41
ci_043                 4.487648e-03 3 1  ON 42
ci_044                 6.054518e-03 3 1  ON 43
ci_045                 3.798202e-03 3 1  ON 44
ci_046                 5.446456e-03 3 1  ON 45
ci_047                -3.619079e-03 3 1  ON 46
ci_048                -4.064517e-03 3 1  ON 47
ci_049                 2.011316e-03 3 1  ON 48
ci_050                 3.043266e-03 3 1  ON 49
ci_051                -2.562278e-03 3 1  ON 50
ci_052                -1.723074e-03 3 1  ON 51
ci_053                -3.259808e-03 3 1  ON 52
ci_054                -3.237621e-03 3 1  ON 53
ci_055                -1.952202e-03 3 1  ON 54
ci_056                -3.337626e-03 3 1  ON 55
ci_057                -2.106500e-03 3 1  ON 56
ci_058                -2.684312e-03 3 1  ON 57
ci_059                -2.602858e-03 3 1  ON 58
ci_060                -1.933631e-03 3 1  ON 59
ci_061                -8.727151e-04 3 1  ON 60
ci_062                -2.167715e-03 3 1  ON 61
ci_063                -2.463784e-03 3 1  ON 62
ci_064                -7.869535e-04 3 1  ON 63
ci_065                -8.859682e-04 3 1  ON 64
ci_066                -1.227590e-03 3 1  ON 65
ci_067                -2.309589e-03 3 1  ON 66
ci_068                -1.984249e-03 3 1  ON 67
ci_069                 1.082120e-03 3 1  ON 68
ci_070                 1.107669e-03 3 1  ON 69
ci_071                -1.828707e-03 3 1  ON 70
ci_072                -1.138910e-03 3 1  ON 71
ci_073                 8.513197e-04 3 1  ON 72
ci_074                 1.932942e-03 3 1  ON 73
ci_075                -1.112493e-03 3 1  ON 74
ci_076                -1.414597e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6257e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2322e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.2076
    reference variance = 3.54102
====================================================
  Execution time = 2.4361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0329e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 4.2044e+00
  Total weights = 1.949694806e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8435e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.261976585556
                                         uncertainty =       0.215790705965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.261976585556
                                         uncertainty =       0.215790705965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001459537013
  error estimate for blocks of size 2^( 2) =       0.001526984079
  error estimate for blocks of size 2^( 3) =       0.001587527521
  error estimate for blocks of size 2^( 4) =       0.001628102387
  error estimate for blocks of size 2^( 5) =       0.001656087168
  error estimate for blocks of size 2^( 6) =       0.001670497605
  error estimate for blocks of size 2^( 7) =       0.001676574565

      target function =                  N/A
              le_mean =     -22.326093755892
             les_mean =     502.658867727376
             stat err =       0.001657815431
             autocorr =       1.290155712719
              std dev =       2.064130063994
             le_variance =       4.260632921085


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232609375589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326093755058       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326121566919       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326121447197       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326121435162       residual = 8.86e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e-01 is 4.987045e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326093755058       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326101821643       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326101853494       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+00 is 1.540404e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326093755058       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326095855820       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326095870709       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+01 is 4.092468e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127303 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0215e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -6.905332e-01 3 1  ON 0
ci_002                -7.105423e-01 3 1  ON 1
ci_003                -6.134868e-02 3 1  ON 2
ci_004                -5.826835e-02 3 1  ON 3
ci_005                 4.569206e-02 3 1  ON 4
ci_006                 4.624429e-02 3 1  ON 5
ci_007                 3.158608e-02 3 1  ON 6
ci_008                 3.127803e-02 3 1  ON 7
ci_009                -2.514935e-02 3 1  ON 8
ci_010                -2.493084e-02 3 1  ON 9
ci_011                -2.115923e-02 3 1  ON 10
ci_012                -2.273524e-02 3 1  ON 11
ci_013                 1.950763e-02 3 1  ON 12
ci_014                 2.219271e-02 3 1  ON 13
ci_015                 1.988992e-02 3 1  ON 14
ci_016                 2.069578e-02 3 1  ON 15
ci_017                 1.566501e-02 3 1  ON 16
ci_018                 1.499443e-02 3 1  ON 17
ci_019                 9.244768e-03 3 1  ON 18
ci_020                 9.354237e-03 3 1  ON 19
ci_021                -9.736748e-03 3 1  ON 20
ci_022                -1.157631e-02 3 1  ON 21
ci_023                 8.887989e-03 3 1  ON 22
ci_024                 9.006755e-03 3 1  ON 23
ci_025                 7.068653e-03 3 1  ON 24
ci_026                 8.635921e-03 3 1  ON 25
ci_027                 8.210398e-03 3 1  ON 26
ci_028                 8.333038e-03 3 1  ON 27
ci_029                -7.671649e-03 3 1  ON 28
ci_030                -7.627477e-03 3 1  ON 29
ci_031                -7.624310e-03 3 1  ON 30
ci_032                -7.618994e-03 3 1  ON 31
ci_033                 7.385268e-03 3 1  ON 32
ci_034                 7.097347e-03 3 1  ON 33
ci_035                 5.887933e-03 3 1  ON 34
ci_036                 6.369449e-03 3 1  ON 35
ci_037                 6.303452e-03 3 1  ON 36
ci_038                 8.227334e-03 3 1  ON 37
ci_039                 5.504198e-03 3 1  ON 38
ci_040                 5.466668e-03 3 1  ON 39
ci_041                 4.929686e-03 3 1  ON 40
ci_042                 5.271922e-03 3 1  ON 41
ci_043                 4.529002e-03 3 1  ON 42
ci_044                 6.013370e-03 3 1  ON 43
ci_045                 3.829009e-03 3 1  ON 44
ci_046                 5.341576e-03 3 1  ON 45
ci_047                -3.773119e-03 3 1  ON 46
ci_048                -4.045668e-03 3 1  ON 47
ci_049                 2.097652e-03 3 1  ON 48
ci_050                 2.999325e-03 3 1  ON 49
ci_051                -2.469484e-03 3 1  ON 50
ci_052                -1.793725e-03 3 1  ON 51
ci_053                -3.287040e-03 3 1  ON 52
ci_054                -3.214789e-03 3 1  ON 53
ci_055                -1.964776e-03 3 1  ON 54
ci_056                -3.321412e-03 3 1  ON 55
ci_057                -2.146395e-03 3 1  ON 56
ci_058                -2.602541e-03 3 1  ON 57
ci_059                -2.566909e-03 3 1  ON 58
ci_060                -1.949888e-03 3 1  ON 59
ci_061                -8.905431e-04 3 1  ON 60
ci_062                -2.159229e-03 3 1  ON 61
ci_063                -2.519185e-03 3 1  ON 62
ci_064                -8.676056e-04 3 1  ON 63
ci_065                -9.074189e-04 3 1  ON 64
ci_066                -1.207072e-03 3 1  ON 65
ci_067                -2.355479e-03 3 1  ON 66
ci_068                -1.917425e-03 3 1  ON 67
ci_069                 1.100508e-03 3 1  ON 68
ci_070                 1.074137e-03 3 1  ON 69
ci_071                -1.780046e-03 3 1  ON 70
ci_072                -1.150766e-03 3 1  ON 71
ci_073                 8.342356e-04 3 1  ON 72
ci_074                 1.820637e-03 3 1  ON 73
ci_075                -1.136247e-03 3 1  ON 74
ci_076                -1.851803e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.4646
    reference variance = 2.61314
====================================================
  Execution time = 2.3688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8375e+00
  Total weights = 1.9499e+06
  Execution time = 4.3789e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.894334832357
                                         uncertainty =       0.118752559914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.894334832357
                                         uncertainty =       0.118752559914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395194673
  error estimate for blocks of size 2^( 2) =       0.001465809691
  error estimate for blocks of size 2^( 3) =       0.001527613347
  error estimate for blocks of size 2^( 4) =       0.001568788342
  error estimate for blocks of size 2^( 5) =       0.001592623051
  error estimate for blocks of size 2^( 6) =       0.001603692037
  error estimate for blocks of size 2^( 7) =       0.001613239579

      target function =                  N/A
              le_mean =     -22.327602696880
             les_mean =     502.359527509443
             stat err =       0.001594585752
             autocorr =       1.306249508702
              std dev =       1.973134797735
             le_variance =       3.893260930035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.894435610045
                                         uncertainty =       0.118753596965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.894435610045
                                         uncertainty =       0.118753596965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395212610
  error estimate for blocks of size 2^( 2) =       0.001465832091
  error estimate for blocks of size 2^( 3) =       0.001527642833
  error estimate for blocks of size 2^( 4) =       0.001568819818
  error estimate for blocks of size 2^( 5) =       0.001592656399
  error estimate for blocks of size 2^( 6) =       0.001603707235
  error estimate for blocks of size 2^( 7) =       0.001613281791

      target function =                  N/A
              le_mean =     -22.327595184420
             les_mean =     502.420036231593
             stat err =       0.001594616311
             autocorr =       1.306265986169
              std dev =       1.973160165482
             le_variance =       3.893361038646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.894373750564
                                         uncertainty =       0.118753497739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.894373750564
                                         uncertainty =       0.118753497739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395201580
  error estimate for blocks of size 2^( 2) =       0.001465819247
  error estimate for blocks of size 2^( 3) =       0.001527625830
  error estimate for blocks of size 2^( 4) =       0.001568801280
  error estimate for blocks of size 2^( 5) =       0.001592638064
  error estimate for blocks of size 2^( 6) =       0.001603700660
  error estimate for blocks of size 2^( 7) =       0.001613248338

      target function =                  N/A
              le_mean =     -22.327601200413
             les_mean =     502.359992324511
             stat err =       0.001594597086
             autocorr =       1.306255141969
              std dev =       1.973144566603
             le_variance =       3.893299480714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.894338862254
                                         uncertainty =       0.118752682501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.894338862254
                                         uncertainty =       0.118752682501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001395195386
  error estimate for blocks of size 2^( 2) =       0.001465810785
  error estimate for blocks of size 2^( 3) =       0.001527614834
  error estimate for blocks of size 2^( 4) =       0.001568789761
  error estimate for blocks of size 2^( 5) =       0.001592624646
  error estimate for blocks of size 2^( 6) =       0.001603692945
  error estimate for blocks of size 2^( 7) =       0.001613240601

      target function =                  N/A
              le_mean =     -22.327602453957
             les_mean =     502.359646722887
             stat err =       0.001594586988
             autocorr =       1.306250197102
              std dev =       1.973135806778
             le_variance =       3.893264911988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327602696880        initial  <--
     9.3132e-01     9.3132e+00             4.9870e-04       -22.327595184420
     3.7253e+00     3.7253e+01             1.5404e-04       -22.327601200413
     1.4901e+01     1.4901e+02             4.0925e-05       -22.327602453957

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6228
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -6.905034e-01 3 1  ON 0
ci_002                -7.105666e-01 3 1  ON 1
ci_003                -6.135582e-02 3 1  ON 2
ci_004                -5.827530e-02 3 1  ON 3
ci_005                 4.572908e-02 3 1  ON 4
ci_006                 4.624143e-02 3 1  ON 5
ci_007                 3.165088e-02 3 1  ON 6
ci_008                 3.124035e-02 3 1  ON 7
ci_009                -2.517745e-02 3 1  ON 8
ci_010                -2.493005e-02 3 1  ON 9
ci_011                -2.116946e-02 3 1  ON 10
ci_012                -2.273043e-02 3 1  ON 11
ci_013                 1.946039e-02 3 1  ON 12
ci_014                 2.225059e-02 3 1  ON 13
ci_015                 1.982453e-02 3 1  ON 14
ci_016                 2.071629e-02 3 1  ON 15
ci_017                 1.561686e-02 3 1  ON 16
ci_018                 1.500621e-02 3 1  ON 17
ci_019                 9.277357e-03 3 1  ON 18
ci_020                 9.281329e-03 3 1  ON 19
ci_021                -9.701913e-03 3 1  ON 20
ci_022                -1.162250e-02 3 1  ON 21
ci_023                 8.925109e-03 3 1  ON 22
ci_024                 9.025581e-03 3 1  ON 23
ci_025                 7.010985e-03 3 1  ON 24
ci_026                 8.691803e-03 3 1  ON 25
ci_027                 8.168526e-03 3 1  ON 26
ci_028                 8.382002e-03 3 1  ON 27
ci_029                -7.661385e-03 3 1  ON 28
ci_030                -7.618047e-03 3 1  ON 29
ci_031                -7.597560e-03 3 1  ON 30
ci_032                -7.639701e-03 3 1  ON 31
ci_033                 7.385607e-03 3 1  ON 32
ci_034                 7.053613e-03 3 1  ON 33
ci_035                 5.810888e-03 3 1  ON 34
ci_036                 6.311628e-03 3 1  ON 35
ci_037                 6.400764e-03 3 1  ON 36
ci_038                 8.233718e-03 3 1  ON 37
ci_039                 5.526087e-03 3 1  ON 38
ci_040                 5.504985e-03 3 1  ON 39
ci_041                 4.931868e-03 3 1  ON 40
ci_042                 5.202870e-03 3 1  ON 41
ci_043                 4.487648e-03 3 1  ON 42
ci_044                 6.054518e-03 3 1  ON 43
ci_045                 3.798202e-03 3 1  ON 44
ci_046                 5.446456e-03 3 1  ON 45
ci_047                -3.619079e-03 3 1  ON 46
ci_048                -4.064517e-03 3 1  ON 47
ci_049                 2.011316e-03 3 1  ON 48
ci_050                 3.043266e-03 3 1  ON 49
ci_051                -2.562278e-03 3 1  ON 50
ci_052                -1.723074e-03 3 1  ON 51
ci_053                -3.259808e-03 3 1  ON 52
ci_054                -3.237621e-03 3 1  ON 53
ci_055                -1.952202e-03 3 1  ON 54
ci_056                -3.337626e-03 3 1  ON 55
ci_057                -2.106500e-03 3 1  ON 56
ci_058                -2.684312e-03 3 1  ON 57
ci_059                -2.602858e-03 3 1  ON 58
ci_060                -1.933631e-03 3 1  ON 59
ci_061                -8.727151e-04 3 1  ON 60
ci_062                -2.167715e-03 3 1  ON 61
ci_063                -2.463784e-03 3 1  ON 62
ci_064                -7.869535e-04 3 1  ON 63
ci_065                -8.859682e-04 3 1  ON 64
ci_066                -1.227590e-03 3 1  ON 65
ci_067                -2.309589e-03 3 1  ON 66
ci_068                -1.984249e-03 3 1  ON 67
ci_069                 1.082120e-03 3 1  ON 68
ci_070                 1.107669e-03 3 1  ON 69
ci_071                -1.828707e-03 3 1  ON 70
ci_072                -1.138910e-03 3 1  ON 71
ci_073                 8.513197e-04 3 1  ON 72
ci_074                 1.932942e-03 3 1  ON 73
ci_075                -1.112493e-03 3 1  ON 74
ci_076                -1.414597e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5852e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2322e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.1097
    reference variance = 4.25087
====================================================
  Execution time = 2.6585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0323e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6544e+00
  Total weights = 1.950055597e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9199e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.706466456407
                                         uncertainty =       0.021733383484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.706466456407
                                         uncertainty =       0.021733383484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001361138623
  error estimate for blocks of size 2^( 2) =       0.001433245572
  error estimate for blocks of size 2^( 3) =       0.001496414405
  error estimate for blocks of size 2^( 4) =       0.001538990589
  error estimate for blocks of size 2^( 5) =       0.001565111001
  error estimate for blocks of size 2^( 6) =       0.001581776729
  error estimate for blocks of size 2^( 7) =       0.001591992356

      target function =                  N/A
              le_mean =     -22.327643667974
             les_mean =     502.178087200746
             stat err =       0.001569467669
             autocorr =       1.329535789440
              std dev =       1.924971499179
             le_variance =       3.705515272653


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232764366797e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327643667142       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327646859325       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327646870261       residual = 4.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+00 is 5.991802e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327643667142       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327644477901       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327644481043       residual = 4.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+01 is 1.523441e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327643667142       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327643870642       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327643871456       residual = 4.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+02 is 3.824920e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2515e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -6.905076e-01 3 1  ON 0
ci_002                -7.105631e-01 3 1  ON 1
ci_003                -6.135390e-02 3 1  ON 2
ci_004                -5.827692e-02 3 1  ON 3
ci_005                 4.571867e-02 3 1  ON 4
ci_006                 4.624863e-02 3 1  ON 5
ci_007                 3.164428e-02 3 1  ON 6
ci_008                 3.124686e-02 3 1  ON 7
ci_009                -2.516813e-02 3 1  ON 8
ci_010                -2.494334e-02 3 1  ON 9
ci_011                -2.117951e-02 3 1  ON 10
ci_012                -2.273191e-02 3 1  ON 11
ci_013                 1.947089e-02 3 1  ON 12
ci_014                 2.224299e-02 3 1  ON 13
ci_015                 1.982065e-02 3 1  ON 14
ci_016                 2.070956e-02 3 1  ON 15
ci_017                 1.561467e-02 3 1  ON 16
ci_018                 1.500509e-02 3 1  ON 17
ci_019                 9.286179e-03 3 1  ON 18
ci_020                 9.283167e-03 3 1  ON 19
ci_021                -9.707830e-03 3 1  ON 20
ci_022                -1.162123e-02 3 1  ON 21
ci_023                 8.924125e-03 3 1  ON 22
ci_024                 9.028405e-03 3 1  ON 23
ci_025                 7.008171e-03 3 1  ON 24
ci_026                 8.691908e-03 3 1  ON 25
ci_027                 8.165862e-03 3 1  ON 26
ci_028                 8.375504e-03 3 1  ON 27
ci_029                -7.661357e-03 3 1  ON 28
ci_030                -7.615296e-03 3 1  ON 29
ci_031                -7.599239e-03 3 1  ON 30
ci_032                -7.631444e-03 3 1  ON 31
ci_033                 7.385409e-03 3 1  ON 32
ci_034                 7.051265e-03 3 1  ON 33
ci_035                 5.818598e-03 3 1  ON 34
ci_036                 6.303650e-03 3 1  ON 35
ci_037                 6.408494e-03 3 1  ON 36
ci_038                 8.221785e-03 3 1  ON 37
ci_039                 5.518565e-03 3 1  ON 38
ci_040                 5.501910e-03 3 1  ON 39
ci_041                 4.933311e-03 3 1  ON 40
ci_042                 5.201581e-03 3 1  ON 41
ci_043                 4.489899e-03 3 1  ON 42
ci_044                 6.039283e-03 3 1  ON 43
ci_045                 3.800405e-03 3 1  ON 44
ci_046                 5.441676e-03 3 1  ON 45
ci_047                -3.627192e-03 3 1  ON 46
ci_048                -4.066723e-03 3 1  ON 47
ci_049                 2.016535e-03 3 1  ON 48
ci_050                 3.046688e-03 3 1  ON 49
ci_051                -2.559495e-03 3 1  ON 50
ci_052                -1.719435e-03 3 1  ON 51
ci_053                -3.258841e-03 3 1  ON 52
ci_054                -3.230077e-03 3 1  ON 53
ci_055                -1.950444e-03 3 1  ON 54
ci_056                -3.334492e-03 3 1  ON 55
ci_057                -2.101282e-03 3 1  ON 56
ci_058                -2.687684e-03 3 1  ON 57
ci_059                -2.594822e-03 3 1  ON 58
ci_060                -1.926171e-03 3 1  ON 59
ci_061                -8.712187e-04 3 1  ON 60
ci_062                -2.158120e-03 3 1  ON 61
ci_063                -2.459498e-03 3 1  ON 62
ci_064                -7.866472e-04 3 1  ON 63
ci_065                -8.816435e-04 3 1  ON 64
ci_066                -1.232977e-03 3 1  ON 65
ci_067                -2.307090e-03 3 1  ON 66
ci_068                -1.988613e-03 3 1  ON 67
ci_069                 1.083871e-03 3 1  ON 68
ci_070                 1.108878e-03 3 1  ON 69
ci_071                -1.823860e-03 3 1  ON 70
ci_072                -1.142548e-03 3 1  ON 71
ci_073                 8.512727e-04 3 1  ON 72
ci_074                 1.928147e-03 3 1  ON 73
ci_075                -1.110166e-03 3 1  ON 74
ci_076                -1.527355e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.022
    reference variance = 4.10602
====================================================
  Execution time = 2.3605e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7651e+00
  Total weights = 1.9503e+06
  Execution time = 4.3720e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817255919559
                                         uncertainty =       0.086460210931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817255919559
                                         uncertainty =       0.086460210931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381563801
  error estimate for blocks of size 2^( 2) =       0.001452311335
  error estimate for blocks of size 2^( 3) =       0.001513765596
  error estimate for blocks of size 2^( 4) =       0.001558725167
  error estimate for blocks of size 2^( 5) =       0.001584211665
  error estimate for blocks of size 2^( 6) =       0.001603449320
  error estimate for blocks of size 2^( 7) =       0.001617962593

      target function =                  N/A
              le_mean =     -22.327242269171
             les_mean =     502.270897050813
             stat err =       0.001591087186
             autocorr =       1.326313119122
              std dev =       1.953857525240
             le_variance =       3.817559228936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817256262524
                                         uncertainty =       0.086460931148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817256262524
                                         uncertainty =       0.086460931148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381563868
  error estimate for blocks of size 2^( 2) =       0.001452311527
  error estimate for blocks of size 2^( 3) =       0.001513765541
  error estimate for blocks of size 2^( 4) =       0.001558725820
  error estimate for blocks of size 2^( 5) =       0.001584212151
  error estimate for blocks of size 2^( 6) =       0.001603449640
  error estimate for blocks of size 2^( 7) =       0.001617962064

      target function =                  N/A
              le_mean =     -22.327242544895
             les_mean =     502.270921605067
             stat err =       0.001591087419
             autocorr =       1.326313376855
              std dev =       1.953857620844
             le_variance =       3.817559602532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817256011762
                                         uncertainty =       0.086460574743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817256011762
                                         uncertainty =       0.086460574743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381563820
  error estimate for blocks of size 2^( 2) =       0.001452311421
  error estimate for blocks of size 2^( 3) =       0.001513765564
  error estimate for blocks of size 2^( 4) =       0.001558725490
  error estimate for blocks of size 2^( 5) =       0.001584211916
  error estimate for blocks of size 2^( 6) =       0.001603449491
  error estimate for blocks of size 2^( 7) =       0.001617962314

      target function =                  N/A
              le_mean =     -22.327242391233
             les_mean =     502.270889732923
             stat err =       0.001591087303
             autocorr =       1.326313276002
              std dev =       1.953857552686
             le_variance =       3.817559336187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817255921400
                                         uncertainty =       0.086460256400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.817255921400
                                         uncertainty =       0.086460256400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381563801
  error estimate for blocks of size 2^( 2) =       0.001452311344
  error estimate for blocks of size 2^( 3) =       0.001513765591
  error estimate for blocks of size 2^( 4) =       0.001558725207
  error estimate for blocks of size 2^( 5) =       0.001584211696
  error estimate for blocks of size 2^( 6) =       0.001603449341
  error estimate for blocks of size 2^( 7) =       0.001617962557

      target function =                  N/A
              le_mean =     -22.327242282211
             les_mean =     502.270894250608
             stat err =       0.001591087200
             autocorr =       1.326313141030
              std dev =       1.953857526179
             le_variance =       3.817559232606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327242269171        initial
     9.3132e+00     9.3132e+01             5.9918e-05       -22.327242544895  <--
     3.7253e+01     3.7253e+02             1.5234e-05       -22.327242391233
     1.4901e+02     1.4901e+03             3.8249e-06       -22.327242282211

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 4.5564e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -6.905201e-01 3 1  ON 0
ci_002                -7.105525e-01 3 1  ON 1
ci_003                -6.134815e-02 3 1  ON 2
ci_004                -5.828167e-02 3 1  ON 3
ci_005                 4.568832e-02 3 1  ON 4
ci_006                 4.626963e-02 3 1  ON 5
ci_007                 3.162488e-02 3 1  ON 6
ci_008                 3.126597e-02 3 1  ON 7
ci_009                -2.514072e-02 3 1  ON 8
ci_010                -2.498247e-02 3 1  ON 9
ci_011                -2.120919e-02 3 1  ON 10
ci_012                -2.273618e-02 3 1  ON 11
ci_013                 1.950192e-02 3 1  ON 12
ci_014                 2.222036e-02 3 1  ON 13
ci_015                 1.980914e-02 3 1  ON 14
ci_016                 2.068962e-02 3 1  ON 15
ci_017                 1.560829e-02 3 1  ON 16
ci_018                 1.500178e-02 3 1  ON 17
ci_019                 9.312324e-03 3 1  ON 18
ci_020                 9.288604e-03 3 1  ON 19
ci_021                -9.725462e-03 3 1  ON 20
ci_022                -1.161754e-02 3 1  ON 21
ci_023                 8.921259e-03 3 1  ON 22
ci_024                 9.036724e-03 3 1  ON 23
ci_025                 6.999813e-03 3 1  ON 24
ci_026                 8.692127e-03 3 1  ON 25
ci_027                 8.158196e-03 3 1  ON 26
ci_028                 8.356626e-03 3 1  ON 27
ci_029                -7.661256e-03 3 1  ON 28
ci_030                -7.607271e-03 3 1  ON 29
ci_031                -7.604163e-03 3 1  ON 30
ci_032                -7.607144e-03 3 1  ON 31
ci_033                 7.384792e-03 3 1  ON 32
ci_034                 7.044376e-03 3 1  ON 33
ci_035                 5.841016e-03 3 1  ON 34
ci_036                 6.280503e-03 3 1  ON 35
ci_037                 6.431325e-03 3 1  ON 36
ci_038                 8.186678e-03 3 1  ON 37
ci_039                 5.496736e-03 3 1  ON 38
ci_040                 5.493004e-03 3 1  ON 39
ci_041                 4.937575e-03 3 1  ON 40
ci_042                 5.197861e-03 3 1  ON 41
ci_043                 4.496552e-03 3 1  ON 42
ci_044                 5.994600e-03 3 1  ON 43
ci_045                 3.806901e-03 3 1  ON 44
ci_046                 5.427601e-03 3 1  ON 45
ci_047                -3.650663e-03 3 1  ON 46
ci_048                -4.073214e-03 3 1  ON 47
ci_049                 2.031903e-03 3 1  ON 48
ci_050                 3.056763e-03 3 1  ON 49
ci_051                -2.551268e-03 3 1  ON 50
ci_052                -1.708735e-03 3 1  ON 51
ci_053                -3.255893e-03 3 1  ON 52
ci_054                -3.207943e-03 3 1  ON 53
ci_055                -1.945292e-03 3 1  ON 54
ci_056                -3.325186e-03 3 1  ON 55
ci_057                -2.085957e-03 3 1  ON 56
ci_058                -2.697561e-03 3 1  ON 57
ci_059                -2.571482e-03 3 1  ON 58
ci_060                -1.904423e-03 3 1  ON 59
ci_061                -8.667810e-04 3 1  ON 60
ci_062                -2.129926e-03 3 1  ON 61
ci_063                -2.446745e-03 3 1  ON 62
ci_064                -7.858487e-04 3 1  ON 63
ci_065                -8.689038e-04 3 1  ON 64
ci_066                -1.248848e-03 3 1  ON 65
ci_067                -2.299689e-03 3 1  ON 66
ci_068                -2.001543e-03 3 1  ON 67
ci_069                 1.089018e-03 3 1  ON 68
ci_070                 1.112425e-03 3 1  ON 69
ci_071                -1.809624e-03 3 1  ON 70
ci_072                -1.153325e-03 3 1  ON 71
ci_073                 8.511026e-04 3 1  ON 72
ci_074                 1.913986e-03 3 1  ON 73
ci_075                -1.103355e-03 3 1  ON 74
ci_076                -1.857838e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8094e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2315e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.4793
    reference variance = 2.86143
====================================================
  Execution time = 2.4167e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0317e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6886e+00
  Total weights = 1.949983093e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9227e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738779766992
                                         uncertainty =       0.028809629022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.738779766992
                                         uncertainty =       0.028809629022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367265567
  error estimate for blocks of size 2^( 2) =       0.001437549760
  error estimate for blocks of size 2^( 3) =       0.001500897173
  error estimate for blocks of size 2^( 4) =       0.001543529520
  error estimate for blocks of size 2^( 5) =       0.001570902944
  error estimate for blocks of size 2^( 6) =       0.001583449016
  error estimate for blocks of size 2^( 7) =       0.001589778407

      target function =                  N/A
              le_mean =     -22.329357641262
             les_mean =     502.288807244082
             stat err =       0.001571914972
             autocorr =       1.321759216743
              std dev =       1.933636445376
             le_variance =       3.738949902885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232935764126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329357640404       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329364115332       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329364240113       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+00 is 1.878621e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329357640404       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329359359002       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329359379268       residual = 7.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+00 is 4.951242e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329357640404       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329358076784       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329358081128       residual = 8.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+01 is 1.254996e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0100e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -6.905273e-01 3 1  ON 0
ci_002                -7.105486e-01 3 1  ON 1
ci_003                -6.133672e-02 3 1  ON 2
ci_004                -5.827849e-02 3 1  ON 3
ci_005                 4.566272e-02 3 1  ON 4
ci_006                 4.628721e-02 3 1  ON 5
ci_007                 3.163556e-02 3 1  ON 6
ci_008                 3.126785e-02 3 1  ON 7
ci_009                -2.514153e-02 3 1  ON 8
ci_010                -2.498817e-02 3 1  ON 9
ci_011                -2.123406e-02 3 1  ON 10
ci_012                -2.273377e-02 3 1  ON 11
ci_013                 1.948660e-02 3 1  ON 12
ci_014                 2.219281e-02 3 1  ON 13
ci_015                 1.979815e-02 3 1  ON 14
ci_016                 2.065222e-02 3 1  ON 15
ci_017                 1.560228e-02 3 1  ON 16
ci_018                 1.504055e-02 3 1  ON 17
ci_019                 9.310559e-03 3 1  ON 18
ci_020                 9.293471e-03 3 1  ON 19
ci_021                -9.722185e-03 3 1  ON 20
ci_022                -1.161812e-02 3 1  ON 21
ci_023                 8.899339e-03 3 1  ON 22
ci_024                 9.031022e-03 3 1  ON 23
ci_025                 7.011879e-03 3 1  ON 24
ci_026                 8.706613e-03 3 1  ON 25
ci_027                 8.130769e-03 3 1  ON 26
ci_028                 8.313786e-03 3 1  ON 27
ci_029                -7.666846e-03 3 1  ON 28
ci_030                -7.615963e-03 3 1  ON 29
ci_031                -7.588829e-03 3 1  ON 30
ci_032                -7.633847e-03 3 1  ON 31
ci_033                 7.381345e-03 3 1  ON 32
ci_034                 7.048776e-03 3 1  ON 33
ci_035                 5.889865e-03 3 1  ON 34
ci_036                 6.294030e-03 3 1  ON 35
ci_037                 6.428401e-03 3 1  ON 36
ci_038                 8.155571e-03 3 1  ON 37
ci_039                 5.487823e-03 3 1  ON 38
ci_040                 5.505845e-03 3 1  ON 39
ci_041                 4.937860e-03 3 1  ON 40
ci_042                 5.184374e-03 3 1  ON 41
ci_043                 4.526251e-03 3 1  ON 42
ci_044                 5.981054e-03 3 1  ON 43
ci_045                 3.816342e-03 3 1  ON 44
ci_046                 5.399720e-03 3 1  ON 45
ci_047                -3.668317e-03 3 1  ON 46
ci_048                -4.073973e-03 3 1  ON 47
ci_049                 2.081415e-03 3 1  ON 48
ci_050                 3.084366e-03 3 1  ON 49
ci_051                -2.548062e-03 3 1  ON 50
ci_052                -1.733786e-03 3 1  ON 51
ci_053                -3.264240e-03 3 1  ON 52
ci_054                -3.190562e-03 3 1  ON 53
ci_055                -1.945289e-03 3 1  ON 54
ci_056                -3.308004e-03 3 1  ON 55
ci_057                -2.081989e-03 3 1  ON 56
ci_058                -2.681961e-03 3 1  ON 57
ci_059                -2.553382e-03 3 1  ON 58
ci_060                -1.913567e-03 3 1  ON 59
ci_061                -8.662172e-04 3 1  ON 60
ci_062                -2.122777e-03 3 1  ON 61
ci_063                -2.432584e-03 3 1  ON 62
ci_064                -7.839543e-04 3 1  ON 63
ci_065                -8.689135e-04 3 1  ON 64
ci_066                -1.257352e-03 3 1  ON 65
ci_067                -2.252916e-03 3 1  ON 66
ci_068                -1.987390e-03 3 1  ON 67
ci_069                 1.108497e-03 3 1  ON 68
ci_070                 1.125651e-03 3 1  ON 69
ci_071                -1.783914e-03 3 1  ON 70
ci_072                -1.141722e-03 3 1  ON 71
ci_073                 8.472202e-04 3 1  ON 72
ci_074                 1.884620e-03 3 1  ON 73
ci_075                -1.084609e-03 3 1  ON 74
ci_076                -1.988322e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.2207
    reference variance = 2.42756
====================================================
  Execution time = 2.3643e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7905e+00
  Total weights = 1.9496e+06
  Execution time = 4.3823e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842915435853
                                         uncertainty =       0.064537896470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842915435853
                                         uncertainty =       0.064537896470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386415445
  error estimate for blocks of size 2^( 2) =       0.001456874116
  error estimate for blocks of size 2^( 3) =       0.001519826060
  error estimate for blocks of size 2^( 4) =       0.001563060994
  error estimate for blocks of size 2^( 5) =       0.001592342456
  error estimate for blocks of size 2^( 6) =       0.001603512490
  error estimate for blocks of size 2^( 7) =       0.001605516250

      target function =                  N/A
              le_mean =     -22.327039522245
             les_mean =     502.287207371412
             stat err =       0.001591108048
             autocorr =       1.317081254607
              std dev =       1.960718896802
             le_variance =       3.844418592275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842921471737
                                         uncertainty =       0.064538862275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842921471737
                                         uncertainty =       0.064538862275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386416601
  error estimate for blocks of size 2^( 2) =       0.001456876681
  error estimate for blocks of size 2^( 3) =       0.001519827660
  error estimate for blocks of size 2^( 4) =       0.001563062033
  error estimate for blocks of size 2^( 5) =       0.001592342946
  error estimate for blocks of size 2^( 6) =       0.001603514926
  error estimate for blocks of size 2^( 7) =       0.001605522155

      target function =                  N/A
              le_mean =     -22.327041801924
             les_mean =     502.287374715375
             stat err =       0.001591110515
             autocorr =       1.317083143096
              std dev =       1.960720531572
             le_variance =       3.844425002927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842917349876
                                         uncertainty =       0.064538363104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842917349876
                                         uncertainty =       0.064538363104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386415826
  error estimate for blocks of size 2^( 2) =       0.001456875311
  error estimate for blocks of size 2^( 3) =       0.001519826825
  error estimate for blocks of size 2^( 4) =       0.001563061496
  error estimate for blocks of size 2^( 5) =       0.001592342699
  error estimate for blocks of size 2^( 6) =       0.001603513820
  error estimate for blocks of size 2^( 7) =       0.001605519181

      target function =                  N/A
              le_mean =     -22.327040594231
             les_mean =     502.287246119801
             stat err =       0.001591109299
             autocorr =       1.317082602561
              std dev =       1.960719435613
             le_variance =       3.844420705191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842915559480
                                         uncertainty =       0.064537953649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.842915559480
                                         uncertainty =       0.064537953649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386415472
  error estimate for blocks of size 2^( 2) =       0.001456874251
  error estimate for blocks of size 2^( 3) =       0.001519826140
  error estimate for blocks of size 2^( 4) =       0.001563061044
  error estimate for blocks of size 2^( 5) =       0.001592342480
  error estimate for blocks of size 2^( 6) =       0.001603512637
  error estimate for blocks of size 2^( 7) =       0.001605516603

      target function =                  N/A
              le_mean =     -22.327039641160
             les_mean =     502.287182548085
             stat err =       0.001591108191
             autocorr =       1.317081440929
              std dev =       1.960718934781
             le_variance =       3.844418741207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327039522245        initial
     2.3283e+00     2.3283e+01             1.8786e-04       -22.327041801924  <--
     9.3132e+00     9.3132e+01             4.9512e-05       -22.327040594231
     3.7253e+01     3.7253e+02             1.2550e-05       -22.327039641160

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 4.5652e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -6.905481e-01 3 1  ON 0
ci_002                -7.105369e-01 3 1  ON 1
ci_003                -6.130399e-02 3 1  ON 2
ci_004                -5.826957e-02 3 1  ON 3
ci_005                 4.559394e-02 3 1  ON 4
ci_006                 4.633508e-02 3 1  ON 5
ci_007                 3.166615e-02 3 1  ON 6
ci_008                 3.127369e-02 3 1  ON 7
ci_009                -2.514458e-02 3 1  ON 8
ci_010                -2.500432e-02 3 1  ON 9
ci_011                -2.130543e-02 3 1  ON 10
ci_012                -2.272760e-02 3 1  ON 11
ci_013                 1.944373e-02 3 1  ON 12
ci_014                 2.211443e-02 3 1  ON 13
ci_015                 1.976569e-02 3 1  ON 14
ci_016                 2.054555e-02 3 1  ON 15
ci_017                 1.558636e-02 3 1  ON 16
ci_018                 1.515081e-02 3 1  ON 17
ci_019                 9.304579e-03 3 1  ON 18
ci_020                 9.306979e-03 3 1  ON 19
ci_021                -9.714065e-03 3 1  ON 20
ci_022                -1.161956e-02 3 1  ON 21
ci_023                 8.839197e-03 3 1  ON 22
ci_024                 9.015473e-03 3 1  ON 23
ci_025                 7.046000e-03 3 1  ON 24
ci_026                 8.747331e-03 3 1  ON 25
ci_027                 8.058669e-03 3 1  ON 26
ci_028                 8.199392e-03 3 1  ON 27
ci_029                -7.682553e-03 3 1  ON 28
ci_030                -7.640311e-03 3 1  ON 29
ci_031                -7.545379e-03 3 1  ON 30
ci_032                -7.709883e-03 3 1  ON 31
ci_033                 7.371077e-03 3 1  ON 32
ci_034                 7.062000e-03 3 1  ON 33
ci_035                 6.020130e-03 3 1  ON 34
ci_036                 6.329738e-03 3 1  ON 35
ci_037                 6.420254e-03 3 1  ON 36
ci_038                 8.068504e-03 3 1  ON 37
ci_039                 5.464949e-03 3 1  ON 38
ci_040                 5.541008e-03 3 1  ON 39
ci_041                 4.938760e-03 3 1  ON 40
ci_042                 5.147591e-03 3 1  ON 41
ci_043                 4.608992e-03 3 1  ON 42
ci_044                 5.942743e-03 3 1  ON 43
ci_045                 3.842897e-03 3 1  ON 44
ci_046                 5.321121e-03 3 1  ON 45
ci_047                -3.714707e-03 3 1  ON 46
ci_048                -4.075929e-03 3 1  ON 47
ci_049                 2.219765e-03 3 1  ON 48
ci_050                 3.161417e-03 3 1  ON 49
ci_051                -2.540055e-03 3 1  ON 50
ci_052                -1.804594e-03 3 1  ON 51
ci_053                -3.287194e-03 3 1  ON 52
ci_054                -3.142115e-03 3 1  ON 53
ci_055                -1.946942e-03 3 1  ON 54
ci_056                -3.259712e-03 3 1  ON 55
ci_057                -2.071085e-03 3 1  ON 56
ci_058                -2.638855e-03 3 1  ON 57
ci_059                -2.504133e-03 3 1  ON 58
ci_060                -1.936776e-03 3 1  ON 59
ci_061                -8.647745e-04 3 1  ON 60
ci_062                -2.103456e-03 3 1  ON 61
ci_063                -2.392891e-03 3 1  ON 62
ci_064                -7.791220e-04 3 1  ON 63
ci_065                -8.696154e-04 3 1  ON 64
ci_066                -1.281027e-03 3 1  ON 65
ci_067                -2.121494e-03 3 1  ON 66
ci_068                -1.947362e-03 3 1  ON 67
ci_069                 1.162909e-03 3 1  ON 68
ci_070                 1.162460e-03 3 1  ON 69
ci_071                -1.712279e-03 3 1  ON 70
ci_072                -1.108496e-03 3 1  ON 71
ci_073                 8.373304e-04 3 1  ON 72
ci_074                 1.806125e-03 3 1  ON 73
ci_075                -1.033224e-03 3 1  ON 74
ci_076                -2.352239e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5765e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2316e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.5426
    reference variance = 1.99754
====================================================
  Execution time = 2.4645e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0313e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7164e+00
  Total weights = 1.950090090e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9540e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763870922684
                                         uncertainty =       0.028180386655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763870922684
                                         uncertainty =       0.028180386655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372544949
  error estimate for blocks of size 2^( 2) =       0.001442992561
  error estimate for blocks of size 2^( 3) =       0.001504813108
  error estimate for blocks of size 2^( 4) =       0.001546319196
  error estimate for blocks of size 2^( 5) =       0.001572211494
  error estimate for blocks of size 2^( 6) =       0.001585605993
  error estimate for blocks of size 2^( 7) =       0.001585207560

      target function =                  N/A
              le_mean =     -22.329914770652
             les_mean =     502.341536503589
             stat err =       0.001572336061
             autocorr =       1.312313504795
              std dev =       1.941102738269
             le_variance =       3.767879840516


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232991477065e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329914769807       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329956104541       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329956650602       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329956665113       residual = 1.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e-01 is 6.919063e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329914769807       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329927288280       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329927321183       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+00 is 2.080403e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329914769807       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329918074072       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329918076639       residual = 1.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+00 is 5.477736e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0610e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -6.906147e-01 3 1  ON 0
ci_002                -7.104482e-01 3 1  ON 1
ci_003                -6.141437e-02 3 1  ON 2
ci_004                -5.839791e-02 3 1  ON 3
ci_005                 4.547703e-02 3 1  ON 4
ci_006                 4.639002e-02 3 1  ON 5
ci_007                 3.163632e-02 3 1  ON 6
ci_008                 3.148173e-02 3 1  ON 7
ci_009                -2.508943e-02 3 1  ON 8
ci_010                -2.506090e-02 3 1  ON 9
ci_011                -2.137593e-02 3 1  ON 10
ci_012                -2.270517e-02 3 1  ON 11
ci_013                 1.950155e-02 3 1  ON 12
ci_014                 2.203766e-02 3 1  ON 13
ci_015                 1.982570e-02 3 1  ON 14
ci_016                 2.057873e-02 3 1  ON 15
ci_017                 1.550893e-02 3 1  ON 16
ci_018                 1.533622e-02 3 1  ON 17
ci_019                 9.211315e-03 3 1  ON 18
ci_020                 9.362485e-03 3 1  ON 19
ci_021                -9.710664e-03 3 1  ON 20
ci_022                -1.160110e-02 3 1  ON 21
ci_023                 8.934789e-03 3 1  ON 22
ci_024                 8.968327e-03 3 1  ON 23
ci_025                 7.049066e-03 3 1  ON 24
ci_026                 8.684426e-03 3 1  ON 25
ci_027                 8.112079e-03 3 1  ON 26
ci_028                 8.131506e-03 3 1  ON 27
ci_029                -7.654550e-03 3 1  ON 28
ci_030                -7.694340e-03 3 1  ON 29
ci_031                -7.459959e-03 3 1  ON 30
ci_032                -7.640750e-03 3 1  ON 31
ci_033                 7.428165e-03 3 1  ON 32
ci_034                 7.102539e-03 3 1  ON 33
ci_035                 5.997768e-03 3 1  ON 34
ci_036                 6.379658e-03 3 1  ON 35
ci_037                 6.378648e-03 3 1  ON 36
ci_038                 7.923843e-03 3 1  ON 37
ci_039                 5.473775e-03 3 1  ON 38
ci_040                 5.598266e-03 3 1  ON 39
ci_041                 4.847397e-03 3 1  ON 40
ci_042                 5.153596e-03 3 1  ON 41
ci_043                 4.634872e-03 3 1  ON 42
ci_044                 5.872882e-03 3 1  ON 43
ci_045                 3.872047e-03 3 1  ON 44
ci_046                 5.268646e-03 3 1  ON 45
ci_047                -3.755154e-03 3 1  ON 46
ci_048                -4.067233e-03 3 1  ON 47
ci_049                 2.391219e-03 3 1  ON 48
ci_050                 3.203226e-03 3 1  ON 49
ci_051                -2.494520e-03 3 1  ON 50
ci_052                -1.857904e-03 3 1  ON 51
ci_053                -3.240464e-03 3 1  ON 52
ci_054                -3.147774e-03 3 1  ON 53
ci_055                -1.962191e-03 3 1  ON 54
ci_056                -3.179563e-03 3 1  ON 55
ci_057                -2.007329e-03 3 1  ON 56
ci_058                -2.590015e-03 3 1  ON 57
ci_059                -2.368484e-03 3 1  ON 58
ci_060                -1.961589e-03 3 1  ON 59
ci_061                -8.957883e-04 3 1  ON 60
ci_062                -2.036764e-03 3 1  ON 61
ci_063                -2.243860e-03 3 1  ON 62
ci_064                -8.276627e-04 3 1  ON 63
ci_065                -7.838029e-04 3 1  ON 64
ci_066                -1.365851e-03 3 1  ON 65
ci_067                -2.069905e-03 3 1  ON 66
ci_068                -1.911216e-03 3 1  ON 67
ci_069                 1.231918e-03 3 1  ON 68
ci_070                 1.154117e-03 3 1  ON 69
ci_071                -1.554197e-03 3 1  ON 70
ci_072                -1.186236e-03 3 1  ON 71
ci_073                 8.511258e-04 3 1  ON 72
ci_074                 1.675246e-03 3 1  ON 73
ci_075                -1.143470e-03 3 1  ON 74
ci_076                -3.915376e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.2086
    reference variance = 4.18262
====================================================
  Execution time = 2.3591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7719e+00
  Total weights = 1.9496e+06
  Execution time = 4.3715e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823781304284
                                         uncertainty =       0.048069790001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823781304284
                                         uncertainty =       0.048069790001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383073597
  error estimate for blocks of size 2^( 2) =       0.001454228456
  error estimate for blocks of size 2^( 3) =       0.001516858682
  error estimate for blocks of size 2^( 4) =       0.001560028847
  error estimate for blocks of size 2^( 5) =       0.001585796843
  error estimate for blocks of size 2^( 6) =       0.001598070865
  error estimate for blocks of size 2^( 7) =       0.001608605016

      target function =                  N/A
              le_mean =     -22.327550520881
             les_mean =     502.295237431276
             stat err =       0.001588125393
             autocorr =       1.318496550893
              std dev =       1.955992733926
             le_variance =       3.825907575171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823732006598
                                         uncertainty =       0.048071398251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823732006598
                                         uncertainty =       0.048071398251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383064615
  error estimate for blocks of size 2^( 2) =       0.001454209863
  error estimate for blocks of size 2^( 3) =       0.001516837744
  error estimate for blocks of size 2^( 4) =       0.001560007964
  error estimate for blocks of size 2^( 5) =       0.001585775512
  error estimate for blocks of size 2^( 6) =       0.001598047276
  error estimate for blocks of size 2^( 7) =       0.001608591821

      target function =                  N/A
              le_mean =     -22.327558875615
             les_mean =     502.292589703586
             stat err =       0.001588105643
             autocorr =       1.318480883440
              std dev =       1.955980031616
             le_variance =       3.825857884082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823744159578
                                         uncertainty =       0.048070839360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823744159578
                                         uncertainty =       0.048070839360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383066837
  error estimate for blocks of size 2^( 2) =       0.001454217485
  error estimate for blocks of size 2^( 3) =       0.001516847911
  error estimate for blocks of size 2^( 4) =       0.001560018198
  error estimate for blocks of size 2^( 5) =       0.001585785815
  error estimate for blocks of size 2^( 6) =       0.001598060461
  error estimate for blocks of size 2^( 7) =       0.001608597839

      target function =                  N/A
              le_mean =     -22.327552184997
             les_mean =     502.296745159609
             stat err =       0.001588115579
             autocorr =       1.318493144884
              std dev =       1.955983173100
             le_variance =       3.825870173450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823776434508
                                         uncertainty =       0.048069982935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823776434508
                                         uncertainty =       0.048069982935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001383072710
  error estimate for blocks of size 2^( 2) =       0.001454226429
  error estimate for blocks of size 2^( 3) =       0.001516855787
  error estimate for blocks of size 2^( 4) =       0.001560026276
  error estimate for blocks of size 2^( 5) =       0.001585796577
  error estimate for blocks of size 2^( 6) =       0.001598064395
  error estimate for blocks of size 2^( 7) =       0.001608604028

      target function =                  N/A
              le_mean =     -22.327551479324
             les_mean =     502.305552263302
             stat err =       0.001588122819
             autocorr =       1.318493969963
              std dev =       1.955991478664
             le_variance =       3.825902664605


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327550520881        initial
     5.8208e-01     5.8208e+00             6.9191e-04       -22.327558875615  <--
     2.3283e+00     2.3283e+01             2.0804e-04       -22.327552184997
     9.3132e+00     9.3132e+01             5.4777e-05       -22.327551479324

*****************************************************************************
Applying the update for shift_i =   5.8208e-01     and shift_s =   5.8208e+00
*****************************************************************************

  Execution time = 4.5497e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -6.908106e-01 3 1  ON 0
ci_002                -7.101934e-01 3 1  ON 1
ci_003                -6.171650e-02 3 1  ON 2
ci_004                -5.875221e-02 3 1  ON 3
ci_005                 4.523691e-02 3 1  ON 4
ci_006                 4.649953e-02 3 1  ON 5
ci_007                 3.156296e-02 3 1  ON 6
ci_008                 3.196560e-02 3 1  ON 7
ci_009                -2.496039e-02 3 1  ON 8
ci_010                -2.518646e-02 3 1  ON 9
ci_011                -2.154219e-02 3 1  ON 10
ci_012                -2.264493e-02 3 1  ON 11
ci_013                 1.963614e-02 3 1  ON 12
ci_014                 2.183057e-02 3 1  ON 13
ci_015                 1.996756e-02 3 1  ON 14
ci_016                 2.066950e-02 3 1  ON 15
ci_017                 1.532832e-02 3 1  ON 16
ci_018                 1.578095e-02 3 1  ON 17
ci_019                 8.972975e-03 3 1  ON 18
ci_020                 9.504030e-03 3 1  ON 19
ci_021                -9.706267e-03 3 1  ON 20
ci_022                -1.156191e-02 3 1  ON 21
ci_023                 9.151691e-03 3 1  ON 22
ci_024                 8.863672e-03 3 1  ON 23
ci_025                 7.062781e-03 3 1  ON 24
ci_026                 8.518434e-03 3 1  ON 25
ci_027                 8.219403e-03 3 1  ON 26
ci_028                 7.993987e-03 3 1  ON 27
ci_029                -7.595953e-03 3 1  ON 28
ci_030                -7.819643e-03 3 1  ON 29
ci_031                -7.249806e-03 3 1  ON 30
ci_032                -7.479604e-03 3 1  ON 31
ci_033                 7.557342e-03 3 1  ON 32
ci_034                 7.202329e-03 3 1  ON 33
ci_035                 5.964166e-03 3 1  ON 34
ci_036                 6.486041e-03 3 1  ON 35
ci_037                 6.289746e-03 3 1  ON 36
ci_038                 7.583770e-03 3 1  ON 37
ci_039                 5.492844e-03 3 1  ON 38
ci_040                 5.714777e-03 3 1  ON 39
ci_041                 4.652576e-03 3 1  ON 40
ci_042                 5.162263e-03 3 1  ON 41
ci_043                 4.707904e-03 3 1  ON 42
ci_044                 5.716813e-03 3 1  ON 43
ci_045                 3.938812e-03 3 1  ON 44
ci_046                 5.143656e-03 3 1  ON 45
ci_047                -3.830963e-03 3 1  ON 46
ci_048                -4.060524e-03 3 1  ON 47
ci_049                 2.795069e-03 3 1  ON 48
ci_050                 3.298972e-03 3 1  ON 49
ci_051                -2.392861e-03 3 1  ON 50
ci_052                -1.991021e-03 3 1  ON 51
ci_053                -3.127079e-03 3 1  ON 52
ci_054                -3.171411e-03 3 1  ON 53
ci_055                -2.007958e-03 3 1  ON 54
ci_056                -2.985946e-03 3 1  ON 55
ci_057                -1.862080e-03 3 1  ON 56
ci_058                -2.483922e-03 3 1  ON 57
ci_059                -2.095970e-03 3 1  ON 58
ci_060                -2.003392e-03 3 1  ON 59
ci_061                -9.652904e-04 3 1  ON 60
ci_062                -1.889783e-03 3 1  ON 61
ci_063                -1.886868e-03 3 1  ON 62
ci_064                -9.487450e-04 3 1  ON 63
ci_065                -5.861804e-04 3 1  ON 64
ci_066                -1.551739e-03 3 1  ON 65
ci_067                -1.939493e-03 3 1  ON 66
ci_068                -1.834050e-03 3 1  ON 67
ci_069                 1.385212e-03 3 1  ON 68
ci_070                 1.140833e-03 3 1  ON 69
ci_071                -1.195600e-03 3 1  ON 70
ci_072                -1.366851e-03 3 1  ON 71
ci_073                 8.706620e-04 3 1  ON 72
ci_074                 1.408362e-03 3 1  ON 73
ci_075                -1.396519e-03 3 1  ON 74
ci_076                -7.394695e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6123e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2318e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.0919
    reference variance = 4.82888
====================================================
  Execution time = 2.4166e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0297e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8242e+00
  Total weights = 1.949686206e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9242e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.879564321523
                                         uncertainty =       0.076500501211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.879564321523
                                         uncertainty =       0.076500501211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001392727915
  error estimate for blocks of size 2^( 2) =       0.001462199026
  error estimate for blocks of size 2^( 3) =       0.001523031089
  error estimate for blocks of size 2^( 4) =       0.001566024995
  error estimate for blocks of size 2^( 5) =       0.001592869329
  error estimate for blocks of size 2^( 6) =       0.001602681849
  error estimate for blocks of size 2^( 7) =       0.001617589891

      target function =                  N/A
              le_mean =     -22.327247363161
             les_mean =     502.330147117922
             stat err =       0.001594791516
             autocorr =       1.311219117459
              std dev =       1.969646219463
             le_variance =       3.879506229844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232724736316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327247362318       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327293374800       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327293638076       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327293680914       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327293722313       residual = 1.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e-01 is 1.117320e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327247362318       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327267142631       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327267016195       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327267030401       residual = 1.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e-01 is 4.811153e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327247362318       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327253392074       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327253364609       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+00 is 1.465914e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0100e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -6.908007e-01 3 1  ON 0
ci_002                -7.101803e-01 3 1  ON 1
ci_003                -6.189398e-02 3 1  ON 2
ci_004                -5.909414e-02 3 1  ON 3
ci_005                 4.517850e-02 3 1  ON 4
ci_006                 4.634440e-02 3 1  ON 5
ci_007                 3.185255e-02 3 1  ON 6
ci_008                 3.239653e-02 3 1  ON 7
ci_009                -2.478374e-02 3 1  ON 8
ci_010                -2.485179e-02 3 1  ON 9
ci_011                -2.146744e-02 3 1  ON 10
ci_012                -2.259886e-02 3 1  ON 11
ci_013                 1.945028e-02 3 1  ON 12
ci_014                 2.152894e-02 3 1  ON 13
ci_015                 2.029961e-02 3 1  ON 14
ci_016                 2.064353e-02 3 1  ON 15
ci_017                 1.518582e-02 3 1  ON 16
ci_018                 1.547620e-02 3 1  ON 17
ci_019                 8.914859e-03 3 1  ON 18
ci_020                 9.559596e-03 3 1  ON 19
ci_021                -9.722141e-03 3 1  ON 20
ci_022                -1.147518e-02 3 1  ON 21
ci_023                 8.795166e-03 3 1  ON 22
ci_024                 8.896436e-03 3 1  ON 23
ci_025                 7.023185e-03 3 1  ON 24
ci_026                 8.495274e-03 3 1  ON 25
ci_027                 8.087264e-03 3 1  ON 26
ci_028                 8.150770e-03 3 1  ON 27
ci_029                -7.756562e-03 3 1  ON 28
ci_030                -7.727955e-03 3 1  ON 29
ci_031                -7.318788e-03 3 1  ON 30
ci_032                -7.543458e-03 3 1  ON 31
ci_033                 7.851758e-03 3 1  ON 32
ci_034                 7.210921e-03 3 1  ON 33
ci_035                 6.272428e-03 3 1  ON 34
ci_036                 6.368773e-03 3 1  ON 35
ci_037                 6.408426e-03 3 1  ON 36
ci_038                 7.421161e-03 3 1  ON 37
ci_039                 5.502793e-03 3 1  ON 38
ci_040                 5.566677e-03 3 1  ON 39
ci_041                 4.990538e-03 3 1  ON 40
ci_042                 5.242390e-03 3 1  ON 41
ci_043                 4.549404e-03 3 1  ON 42
ci_044                 5.425458e-03 3 1  ON 43
ci_045                 4.115577e-03 3 1  ON 44
ci_046                 5.158514e-03 3 1  ON 45
ci_047                -4.020637e-03 3 1  ON 46
ci_048                -3.997538e-03 3 1  ON 47
ci_049                 3.074161e-03 3 1  ON 48
ci_050                 3.435479e-03 3 1  ON 49
ci_051                -2.028165e-03 3 1  ON 50
ci_052                -1.894313e-03 3 1  ON 51
ci_053                -3.157770e-03 3 1  ON 52
ci_054                -3.141329e-03 3 1  ON 53
ci_055                -1.993900e-03 3 1  ON 54
ci_056                -2.743614e-03 3 1  ON 55
ci_057                -2.010089e-03 3 1  ON 56
ci_058                -2.461985e-03 3 1  ON 57
ci_059                -2.023409e-03 3 1  ON 58
ci_060                -1.854808e-03 3 1  ON 59
ci_061                -1.376224e-03 3 1  ON 60
ci_062                -1.821535e-03 3 1  ON 61
ci_063                -1.641451e-03 3 1  ON 62
ci_064                -6.791341e-04 3 1  ON 63
ci_065                -4.791643e-04 3 1  ON 64
ci_066                -1.708418e-03 3 1  ON 65
ci_067                -1.562700e-03 3 1  ON 66
ci_068                -2.081239e-03 3 1  ON 67
ci_069                 1.464974e-03 3 1  ON 68
ci_070                 1.514885e-03 3 1  ON 69
ci_071                -1.297700e-03 3 1  ON 70
ci_072                -1.214914e-03 3 1  ON 71
ci_073                 9.998652e-04 3 1  ON 72
ci_074                 1.186318e-03 3 1  ON 73
ci_075                -9.154034e-04 3 1  ON 74
ci_076                -1.040748e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.3491
    reference variance = 3.24746
====================================================
  Execution time = 2.3614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.9122e+00
  Total weights = 1.9503e+06
  Execution time = 4.3569e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.962979344122
                                         uncertainty =       0.146389302088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.962979344122
                                         uncertainty =       0.146389302088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001407606353
  error estimate for blocks of size 2^( 2) =       0.001476026704
  error estimate for blocks of size 2^( 3) =       0.001537648912
  error estimate for blocks of size 2^( 4) =       0.001582385491
  error estimate for blocks of size 2^( 5) =       0.001608709168
  error estimate for blocks of size 2^( 6) =       0.001622676005
  error estimate for blocks of size 2^( 7) =       0.001634341840

      target function =                  N/A
              le_mean =     -22.326930040709
             les_mean =     502.405197837650
             stat err =       0.001612028126
             autocorr =       1.311543783336
              std dev =       1.990687845506
             le_variance =       3.962838098247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.963056090610
                                         uncertainty =       0.146362779447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.963056090610
                                         uncertainty =       0.146362779447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001407619830
  error estimate for blocks of size 2^( 2) =       0.001476039029
  error estimate for blocks of size 2^( 3) =       0.001537661992
  error estimate for blocks of size 2^( 4) =       0.001582392557
  error estimate for blocks of size 2^( 5) =       0.001608700403
  error estimate for blocks of size 2^( 6) =       0.001622703993
  error estimate for blocks of size 2^( 7) =       0.001634420161

      target function =                  N/A
              le_mean =     -22.326935580188
             les_mean =     502.421997861885
             stat err =       0.001612054279
             autocorr =       1.311561224755
              std dev =       1.990706904523
             le_variance =       3.962913979715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.962978238548
                                         uncertainty =       0.146365241747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.962978238548
                                         uncertainty =       0.146365241747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001407606046
  error estimate for blocks of size 2^( 2) =       0.001476026864
  error estimate for blocks of size 2^( 3) =       0.001537656126
  error estimate for blocks of size 2^( 4) =       0.001582398766
  error estimate for blocks of size 2^( 5) =       0.001608721850
  error estimate for blocks of size 2^( 6) =       0.001622718232
  error estimate for blocks of size 2^( 7) =       0.001634423356

      target function =                  N/A
              le_mean =     -22.326928516506
             les_mean =     502.419208501045
             stat err =       0.001612065551
             autocorr =       1.311605254025
              std dev =       1.990687411167
             le_variance =       3.962836368977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.962965572596
                                         uncertainty =       0.146385489117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.962965572596
                                         uncertainty =       0.146385489117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001407603892
  error estimate for blocks of size 2^( 2) =       0.001476024680
  error estimate for blocks of size 2^( 3) =       0.001537648229
  error estimate for blocks of size 2^( 4) =       0.001582385753
  error estimate for blocks of size 2^( 5) =       0.001608708047
  error estimate for blocks of size 2^( 6) =       0.001622678116
  error estimate for blocks of size 2^( 7) =       0.001634347317

      target function =                  N/A
              le_mean =     -22.326926052456
             les_mean =     502.404021091433
             stat err =       0.001612029808
             autocorr =       1.311551106680
              std dev =       1.990684365076
             le_variance =       3.962824241359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326930040709        initial
     1.4552e-01     1.4552e+00             1.1173e-03       -22.326935580188  <--
     5.8208e-01     5.8208e+00             4.8112e-04       -22.326928516506
     2.3283e+00     2.3283e+01             1.4659e-04       -22.326926052456

*****************************************************************************
Applying the update for shift_i =   1.4552e-01     and shift_s =   1.4552e+00
*****************************************************************************

  Execution time = 4.5477e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -6.907753e-01 3 1  ON 0
ci_002                -7.101307e-01 3 1  ON 1
ci_003                -6.231930e-02 3 1  ON 2
ci_004                -5.986953e-02 3 1  ON 3
ci_005                 4.513344e-02 3 1  ON 4
ci_006                 4.617661e-02 3 1  ON 5
ci_007                 3.224214e-02 3 1  ON 6
ci_008                 3.301534e-02 3 1  ON 7
ci_009                -2.452426e-02 3 1  ON 8
ci_010                -2.433186e-02 3 1  ON 9
ci_011                -2.136254e-02 3 1  ON 10
ci_012                -2.252187e-02 3 1  ON 11
ci_013                 1.920629e-02 3 1  ON 12
ci_014                 2.105509e-02 3 1  ON 13
ci_015                 2.089781e-02 3 1  ON 14
ci_016                 2.060415e-02 3 1  ON 15
ci_017                 1.496583e-02 3 1  ON 16
ci_018                 1.498570e-02 3 1  ON 17
ci_019                 8.813895e-03 3 1  ON 18
ci_020                 9.646842e-03 3 1  ON 19
ci_021                -9.741459e-03 3 1  ON 20
ci_022                -1.131365e-02 3 1  ON 21
ci_023                 8.346875e-03 3 1  ON 22
ci_024                 8.942988e-03 3 1  ON 23
ci_025                 6.959884e-03 3 1  ON 24
ci_026                 8.452704e-03 3 1  ON 25
ci_027                 7.967273e-03 3 1  ON 26
ci_028                 8.310206e-03 3 1  ON 27
ci_029                -7.975108e-03 3 1  ON 28
ci_030                -7.553407e-03 3 1  ON 29
ci_031                -7.423087e-03 3 1  ON 30
ci_032                -7.682182e-03 3 1  ON 31
ci_033                 8.254291e-03 3 1  ON 32
ci_034                 7.206121e-03 3 1  ON 33
ci_035                 6.579042e-03 3 1  ON 34
ci_036                 6.283694e-03 3 1  ON 35
ci_037                 6.567309e-03 3 1  ON 36
ci_038                 7.173476e-03 3 1  ON 37
ci_039                 5.513706e-03 3 1  ON 38
ci_040                 5.414238e-03 3 1  ON 39
ci_041                 5.377485e-03 3 1  ON 40
ci_042                 5.332569e-03 3 1  ON 41
ci_043                 4.307234e-03 3 1  ON 42
ci_044                 5.042415e-03 3 1  ON 43
ci_045                 4.349857e-03 3 1  ON 44
ci_046                 5.173404e-03 3 1  ON 45
ci_047                -4.207472e-03 3 1  ON 46
ci_048                -3.930913e-03 3 1  ON 47
ci_049                 3.470041e-03 3 1  ON 48
ci_050                 3.627359e-03 3 1  ON 49
ci_051                -1.536550e-03 3 1  ON 50
ci_052                -1.824941e-03 3 1  ON 51
ci_053                -3.226131e-03 3 1  ON 52
ci_054                -3.162462e-03 3 1  ON 53
ci_055                -2.021344e-03 3 1  ON 54
ci_056                -2.308784e-03 3 1  ON 55
ci_057                -2.204821e-03 3 1  ON 56
ci_058                -2.434981e-03 3 1  ON 57
ci_059                -1.941102e-03 3 1  ON 58
ci_060                -1.669525e-03 3 1  ON 59
ci_061                -1.933122e-03 3 1  ON 60
ci_062                -1.701914e-03 3 1  ON 61
ci_063                -1.322925e-03 3 1  ON 62
ci_064                -3.121227e-04 3 1  ON 63
ci_065                -3.303166e-04 3 1  ON 64
ci_066                -1.916361e-03 3 1  ON 65
ci_067                -1.051805e-03 3 1  ON 66
ci_068                -2.481907e-03 3 1  ON 67
ci_069                 1.561108e-03 3 1  ON 68
ci_070                 2.016496e-03 3 1  ON 69
ci_071                -1.487734e-03 3 1  ON 70
ci_072                -1.038475e-03 3 1  ON 71
ci_073                 1.122550e-03 3 1  ON 72
ci_074                 9.149829e-04 3 1  ON 73
ci_075                -2.829993e-04 3 1  ON 74
ci_076                -1.427089e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2315e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.3499
    reference variance = 3.13041
====================================================
  Execution time = 2.6199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0304e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.8225e+00
  Total weights = 1.949775234e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8907e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.878666678574
                                         uncertainty =       0.136104015244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.878666678574
                                         uncertainty =       0.136104015244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001392332234
  error estimate for blocks of size 2^( 2) =       0.001463427306
  error estimate for blocks of size 2^( 3) =       0.001526699871
  error estimate for blocks of size 2^( 4) =       0.001570288541
  error estimate for blocks of size 2^( 5) =       0.001592043966
  error estimate for blocks of size 2^( 6) =       0.001601497464
  error estimate for blocks of size 2^( 7) =       0.001608807086

      target function =                  N/A
              le_mean =     -22.329961681140
             les_mean =     502.449658861451
             stat err =       0.001593159264
             autocorr =       1.309280294134
              std dev =       1.969086632935
             le_variance =       3.877302168003


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232996168114e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329961680339       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330038260845       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330048170721       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330048028860       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330049991216       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.330049284914       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.330049284685       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.330049055074       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e-02 is 3.025644e-03

solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329961680339       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330013464387       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330016742354       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330016262016       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.330016477820       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e-01 is 1.146214e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329961680339       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329984242202       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329984617258       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329984555993       residual = 5.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e-01 is 4.466837e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142144 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2097e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -6.915111e-01 3 1  ON 0
ci_002                -7.094828e-01 3 1  ON 1
ci_003                -6.141088e-02 3 1  ON 2
ci_004                -5.872332e-02 3 1  ON 3
ci_005                 4.577237e-02 3 1  ON 4
ci_006                 4.677369e-02 3 1  ON 5
ci_007                 3.246961e-02 3 1  ON 6
ci_008                 3.268410e-02 3 1  ON 7
ci_009                -2.419584e-02 3 1  ON 8
ci_010                -2.448735e-02 3 1  ON 9
ci_011                -2.118124e-02 3 1  ON 10
ci_012                -2.233474e-02 3 1  ON 11
ci_013                 1.916252e-02 3 1  ON 12
ci_014                 2.179005e-02 3 1  ON 13
ci_015                 2.125426e-02 3 1  ON 14
ci_016                 1.971990e-02 3 1  ON 15
ci_017                 1.499790e-02 3 1  ON 16
ci_018                 1.607244e-02 3 1  ON 17
ci_019                 9.573065e-03 3 1  ON 18
ci_020                 1.014804e-02 3 1  ON 19
ci_021                -9.193839e-03 3 1  ON 20
ci_022                -1.091032e-02 3 1  ON 21
ci_023                 8.220647e-03 3 1  ON 22
ci_024                 9.498246e-03 3 1  ON 23
ci_025                 7.733119e-03 3 1  ON 24
ci_026                 9.273768e-03 3 1  ON 25
ci_027                 7.941150e-03 3 1  ON 26
ci_028                 8.267639e-03 3 1  ON 27
ci_029                -7.776331e-03 3 1  ON 28
ci_030                -8.065243e-03 3 1  ON 29
ci_031                -7.551496e-03 3 1  ON 30
ci_032                -6.983628e-03 3 1  ON 31
ci_033                 7.741499e-03 3 1  ON 32
ci_034                 7.061412e-03 3 1  ON 33
ci_035                 6.806849e-03 3 1  ON 34
ci_036                 6.336802e-03 3 1  ON 35
ci_037                 6.643334e-03 3 1  ON 36
ci_038                 6.473985e-03 3 1  ON 37
ci_039                 5.345601e-03 3 1  ON 38
ci_040                 5.841337e-03 3 1  ON 39
ci_041                 5.405669e-03 3 1  ON 40
ci_042                 5.170261e-03 3 1  ON 41
ci_043                 5.242694e-03 3 1  ON 42
ci_044                 5.508999e-03 3 1  ON 43
ci_045                 3.991507e-03 3 1  ON 44
ci_046                 4.796773e-03 3 1  ON 45
ci_047                -4.321402e-03 3 1  ON 46
ci_048                -4.807293e-03 3 1  ON 47
ci_049                 4.237655e-03 3 1  ON 48
ci_050                 4.093834e-03 3 1  ON 49
ci_051                -1.969581e-03 3 1  ON 50
ci_052                -2.818760e-03 3 1  ON 51
ci_053                -2.808279e-03 3 1  ON 52
ci_054                -3.125488e-03 3 1  ON 53
ci_055                -1.540121e-03 3 1  ON 54
ci_056                -2.601391e-03 3 1  ON 55
ci_057                -2.731484e-03 3 1  ON 56
ci_058                -2.124058e-03 3 1  ON 57
ci_059                -1.578124e-03 3 1  ON 58
ci_060                -2.051700e-03 3 1  ON 59
ci_061                -2.299353e-03 3 1  ON 60
ci_062                -1.558755e-03 3 1  ON 61
ci_063                -5.897668e-04 3 1  ON 62
ci_064                -2.484419e-04 3 1  ON 63
ci_065                -9.987300e-04 3 1  ON 64
ci_066                -9.946070e-04 3 1  ON 65
ci_067                -1.099057e-03 3 1  ON 66
ci_068                -2.055113e-03 3 1  ON 67
ci_069                 8.698878e-04 3 1  ON 68
ci_070                 2.325041e-03 3 1  ON 69
ci_071                -1.087234e-03 3 1  ON 70
ci_072                -1.128590e-03 3 1  ON 71
ci_073                 1.309497e-03 3 1  ON 72
ci_074                 1.225676e-03 3 1  ON 73
ci_075                -2.889152e-04 3 1  ON 74
ci_076                -9.956688e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.6017
    reference variance = 2.62139
====================================================
  Execution time = 2.3645e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7105e+00
  Total weights = 1.9499e+06
  Execution time = 4.3616e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763811440630
                                         uncertainty =       0.044605054399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763811440630
                                         uncertainty =       0.044605054399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371647541
  error estimate for blocks of size 2^( 2) =       0.001442228674
  error estimate for blocks of size 2^( 3) =       0.001506389868
  error estimate for blocks of size 2^( 4) =       0.001549088322
  error estimate for blocks of size 2^( 5) =       0.001573334247
  error estimate for blocks of size 2^( 6) =       0.001583922806
  error estimate for blocks of size 2^( 7) =       0.001588269635

      target function =                  N/A
              le_mean =     -22.328890167167
             les_mean =     502.292627753284
             stat err =       0.001573653752
             autocorr =       1.316234605766
              std dev =       1.939833591837
             le_variance =       3.762954364020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764603102272
                                         uncertainty =       0.044560278632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764603102272
                                         uncertainty =       0.044560278632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371791096
  error estimate for blocks of size 2^( 2) =       0.001442348057
  error estimate for blocks of size 2^( 3) =       0.001506471812
  error estimate for blocks of size 2^( 4) =       0.001549152335
  error estimate for blocks of size 2^( 5) =       0.001573475560
  error estimate for blocks of size 2^( 6) =       0.001583938782
  error estimate for blocks of size 2^( 7) =       0.001588378548

      target function =                  N/A
              le_mean =     -22.328846343125
             les_mean =     502.294690540099
             stat err =       0.001573736306
             autocorr =       1.316097210492
              std dev =       1.940036613239
             le_variance =       3.763742060706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766026964387
                                         uncertainty =       0.044514117679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766026964387
                                         uncertainty =       0.044514117679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372050332
  error estimate for blocks of size 2^( 2) =       0.001442589046
  error estimate for blocks of size 2^( 3) =       0.001506681842
  error estimate for blocks of size 2^( 4) =       0.001549363846
  error estimate for blocks of size 2^( 5) =       0.001573735072
  error estimate for blocks of size 2^( 6) =       0.001584150216
  error estimate for blocks of size 2^( 7) =       0.001588660565

      target function =                  N/A
              le_mean =     -22.328851782415
             les_mean =     502.304380510734
             stat err =       0.001573977425
             autocorr =       1.316003098146
              std dev =       1.940403233534
             le_variance =       3.765164708709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763790055887
                                         uncertainty =       0.044601907691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763790055887
                                         uncertainty =       0.044601907691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371643472
  error estimate for blocks of size 2^( 2) =       0.001442217344
  error estimate for blocks of size 2^( 3) =       0.001506367233
  error estimate for blocks of size 2^( 4) =       0.001549062503
  error estimate for blocks of size 2^( 5) =       0.001573320949
  error estimate for blocks of size 2^( 6) =       0.001583882766
  error estimate for blocks of size 2^( 7) =       0.001588248257

      target function =                  N/A
              le_mean =     -22.328865465933
             les_mean =     502.289889585471
             stat err =       0.001573628619
             autocorr =       1.316200371088
              std dev =       1.939827836963
             le_variance =       3.762932037055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328890167167        initial  <--
     3.6380e-02     3.6380e-01             3.0256e-03       -22.328846343125
     1.4552e-01     1.4552e+00             1.1462e-03       -22.328851782415
     5.8208e-01     5.8208e+00             4.4668e-04       -22.328865465933

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5321
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -6.907753e-01 3 1  ON 0
ci_002                -7.101307e-01 3 1  ON 1
ci_003                -6.231930e-02 3 1  ON 2
ci_004                -5.986953e-02 3 1  ON 3
ci_005                 4.513344e-02 3 1  ON 4
ci_006                 4.617661e-02 3 1  ON 5
ci_007                 3.224214e-02 3 1  ON 6
ci_008                 3.301534e-02 3 1  ON 7
ci_009                -2.452426e-02 3 1  ON 8
ci_010                -2.433186e-02 3 1  ON 9
ci_011                -2.136254e-02 3 1  ON 10
ci_012                -2.252187e-02 3 1  ON 11
ci_013                 1.920629e-02 3 1  ON 12
ci_014                 2.105509e-02 3 1  ON 13
ci_015                 2.089781e-02 3 1  ON 14
ci_016                 2.060415e-02 3 1  ON 15
ci_017                 1.496583e-02 3 1  ON 16
ci_018                 1.498570e-02 3 1  ON 17
ci_019                 8.813895e-03 3 1  ON 18
ci_020                 9.646842e-03 3 1  ON 19
ci_021                -9.741459e-03 3 1  ON 20
ci_022                -1.131365e-02 3 1  ON 21
ci_023                 8.346875e-03 3 1  ON 22
ci_024                 8.942988e-03 3 1  ON 23
ci_025                 6.959884e-03 3 1  ON 24
ci_026                 8.452704e-03 3 1  ON 25
ci_027                 7.967273e-03 3 1  ON 26
ci_028                 8.310206e-03 3 1  ON 27
ci_029                -7.975108e-03 3 1  ON 28
ci_030                -7.553407e-03 3 1  ON 29
ci_031                -7.423087e-03 3 1  ON 30
ci_032                -7.682182e-03 3 1  ON 31
ci_033                 8.254291e-03 3 1  ON 32
ci_034                 7.206121e-03 3 1  ON 33
ci_035                 6.579042e-03 3 1  ON 34
ci_036                 6.283694e-03 3 1  ON 35
ci_037                 6.567309e-03 3 1  ON 36
ci_038                 7.173476e-03 3 1  ON 37
ci_039                 5.513706e-03 3 1  ON 38
ci_040                 5.414238e-03 3 1  ON 39
ci_041                 5.377485e-03 3 1  ON 40
ci_042                 5.332569e-03 3 1  ON 41
ci_043                 4.307234e-03 3 1  ON 42
ci_044                 5.042415e-03 3 1  ON 43
ci_045                 4.349857e-03 3 1  ON 44
ci_046                 5.173404e-03 3 1  ON 45
ci_047                -4.207472e-03 3 1  ON 46
ci_048                -3.930913e-03 3 1  ON 47
ci_049                 3.470041e-03 3 1  ON 48
ci_050                 3.627359e-03 3 1  ON 49
ci_051                -1.536550e-03 3 1  ON 50
ci_052                -1.824941e-03 3 1  ON 51
ci_053                -3.226131e-03 3 1  ON 52
ci_054                -3.162462e-03 3 1  ON 53
ci_055                -2.021344e-03 3 1  ON 54
ci_056                -2.308784e-03 3 1  ON 55
ci_057                -2.204821e-03 3 1  ON 56
ci_058                -2.434981e-03 3 1  ON 57
ci_059                -1.941102e-03 3 1  ON 58
ci_060                -1.669525e-03 3 1  ON 59
ci_061                -1.933122e-03 3 1  ON 60
ci_062                -1.701914e-03 3 1  ON 61
ci_063                -1.322925e-03 3 1  ON 62
ci_064                -3.121227e-04 3 1  ON 63
ci_065                -3.303166e-04 3 1  ON 64
ci_066                -1.916361e-03 3 1  ON 65
ci_067                -1.051805e-03 3 1  ON 66
ci_068                -2.481907e-03 3 1  ON 67
ci_069                 1.561108e-03 3 1  ON 68
ci_070                 2.016496e-03 3 1  ON 69
ci_071                -1.487734e-03 3 1  ON 70
ci_072                -1.038475e-03 3 1  ON 71
ci_073                 1.122550e-03 3 1  ON 72
ci_074                 9.149829e-04 3 1  ON 73
ci_075                -2.829993e-04 3 1  ON 74
ci_076                -1.427089e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2319e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.3135
    reference variance = 2.9983
====================================================
  Execution time = 2.4213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0264e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7232e+00
  Total weights = 1.950140840e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8186e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772256185783
                                         uncertainty =       0.047994371394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772256185783
                                         uncertainty =       0.047994371394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373461157
  error estimate for blocks of size 2^( 2) =       0.001445003408
  error estimate for blocks of size 2^( 3) =       0.001509540287
  error estimate for blocks of size 2^( 4) =       0.001553100920
  error estimate for blocks of size 2^( 5) =       0.001575592887
  error estimate for blocks of size 2^( 6) =       0.001586564895
  error estimate for blocks of size 2^( 7) =       0.001599224293

      target function =                  N/A
              le_mean =     -22.325027051070
             les_mean =     502.130022423446
             stat err =       0.001578620749
             autocorr =       1.321060934716
              std dev =       1.942398473501
             le_variance =       3.772911829860


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232502705107e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325027050244       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325057714740       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325058158279       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325058142558       residual = 1.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e-01 is 1.060305e-03

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325027050244       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325037594118       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325037584989       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+00 is 3.532170e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325027050244       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325029959204       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325029948927       residual = 1.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+00 is 9.642991e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143451 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0039e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -6.907589e-01 3 1  ON 0
ci_002                -7.101047e-01 3 1  ON 1
ci_003                -6.241302e-02 3 1  ON 2
ci_004                -5.998417e-02 3 1  ON 3
ci_005                 4.513159e-02 3 1  ON 4
ci_006                 4.624975e-02 3 1  ON 5
ci_007                 3.226589e-02 3 1  ON 6
ci_008                 3.311736e-02 3 1  ON 7
ci_009                -2.454243e-02 3 1  ON 8
ci_010                -2.468508e-02 3 1  ON 9
ci_011                -2.141637e-02 3 1  ON 10
ci_012                -2.250581e-02 3 1  ON 11
ci_013                 1.937933e-02 3 1  ON 12
ci_014                 2.106250e-02 3 1  ON 13
ci_015                 2.089558e-02 3 1  ON 14
ci_016                 2.061257e-02 3 1  ON 15
ci_017                 1.498128e-02 3 1  ON 16
ci_018                 1.498584e-02 3 1  ON 17
ci_019                 8.882580e-03 3 1  ON 18
ci_020                 9.702424e-03 3 1  ON 19
ci_021                -9.796340e-03 3 1  ON 20
ci_022                -1.117477e-02 3 1  ON 21
ci_023                 8.198407e-03 3 1  ON 22
ci_024                 8.932218e-03 3 1  ON 23
ci_025                 7.023033e-03 3 1  ON 24
ci_026                 8.488471e-03 3 1  ON 25
ci_027                 7.891795e-03 3 1  ON 26
ci_028                 8.500447e-03 3 1  ON 27
ci_029                -7.990780e-03 3 1  ON 28
ci_030                -7.474828e-03 3 1  ON 29
ci_031                -7.553580e-03 3 1  ON 30
ci_032                -7.592972e-03 3 1  ON 31
ci_033                 8.002328e-03 3 1  ON 32
ci_034                 7.197914e-03 3 1  ON 33
ci_035                 6.643600e-03 3 1  ON 34
ci_036                 6.049794e-03 3 1  ON 35
ci_037                 6.511752e-03 3 1  ON 36
ci_038                 7.002595e-03 3 1  ON 37
ci_039                 5.644409e-03 3 1  ON 38
ci_040                 5.480921e-03 3 1  ON 39
ci_041                 5.350778e-03 3 1  ON 40
ci_042                 5.376475e-03 3 1  ON 41
ci_043                 4.376374e-03 3 1  ON 42
ci_044                 5.099446e-03 3 1  ON 43
ci_045                 4.240989e-03 3 1  ON 44
ci_046                 5.170238e-03 3 1  ON 45
ci_047                -4.021476e-03 3 1  ON 46
ci_048                -3.925271e-03 3 1  ON 47
ci_049                 3.349832e-03 3 1  ON 48
ci_050                 3.535222e-03 3 1  ON 49
ci_051                -1.564444e-03 3 1  ON 50
ci_052                -1.956481e-03 3 1  ON 51
ci_053                -3.288966e-03 3 1  ON 52
ci_054                -3.155068e-03 3 1  ON 53
ci_055                -2.197639e-03 3 1  ON 54
ci_056                -2.355593e-03 3 1  ON 55
ci_057                -2.196789e-03 3 1  ON 56
ci_058                -2.430121e-03 3 1  ON 57
ci_059                -1.923635e-03 3 1  ON 58
ci_060                -1.784569e-03 3 1  ON 59
ci_061                -1.952793e-03 3 1  ON 60
ci_062                -1.688721e-03 3 1  ON 61
ci_063                -1.293388e-03 3 1  ON 62
ci_064                -3.388715e-04 3 1  ON 63
ci_065                -3.549484e-04 3 1  ON 64
ci_066                -1.974033e-03 3 1  ON 65
ci_067                -9.761868e-04 3 1  ON 66
ci_068                -2.309462e-03 3 1  ON 67
ci_069                 1.575082e-03 3 1  ON 68
ci_070                 2.006337e-03 3 1  ON 69
ci_071                -1.520411e-03 3 1  ON 70
ci_072                -9.534451e-04 3 1  ON 71
ci_073                 1.252903e-03 3 1  ON 72
ci_074                 1.115190e-03 3 1  ON 73
ci_075                -2.783547e-04 3 1  ON 74
ci_076                -1.284379e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.2236
    reference variance = 5.43691
====================================================
  Execution time = 2.3557e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6612e+00
  Total weights = 1.9495e+06
  Execution time = 4.3595e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711349391139
                                         uncertainty =       0.022019985874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711349391139
                                         uncertainty =       0.022019985874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362272422
  error estimate for blocks of size 2^( 2) =       0.001434189388
  error estimate for blocks of size 2^( 3) =       0.001496956133
  error estimate for blocks of size 2^( 4) =       0.001539690352
  error estimate for blocks of size 2^( 5) =       0.001563056711
  error estimate for blocks of size 2^( 6) =       0.001577161785
  error estimate for blocks of size 2^( 7) =       0.001588452400

      target function =                  N/A
              le_mean =     -22.329324868243
             les_mean =     502.259983487274
             stat err =       0.001567090312
             autocorr =       1.323305512429
              std dev =       1.926574959875
             le_variance =       3.711691076018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711427564313
                                         uncertainty =       0.022017972551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711427564313
                                         uncertainty =       0.022017972551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362286617
  error estimate for blocks of size 2^( 2) =       0.001434181954
  error estimate for blocks of size 2^( 3) =       0.001496933792
  error estimate for blocks of size 2^( 4) =       0.001539649223
  error estimate for blocks of size 2^( 5) =       0.001562990540
  error estimate for blocks of size 2^( 6) =       0.001577113391
  error estimate for blocks of size 2^( 7) =       0.001588390289

      target function =                  N/A
              le_mean =     -22.329331393318
             les_mean =     502.263533694303
             stat err =       0.001567035861
             autocorr =       1.323185978818
              std dev =       1.926595033939
             le_variance =       3.711768424798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711382646595
                                         uncertainty =       0.022018739042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711382646595
                                         uncertainty =       0.022018739042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362278433
  error estimate for blocks of size 2^( 2) =       0.001434179870
  error estimate for blocks of size 2^( 3) =       0.001496934854
  error estimate for blocks of size 2^( 4) =       0.001539655140
  error estimate for blocks of size 2^( 5) =       0.001563003863
  error estimate for blocks of size 2^( 6) =       0.001577120712
  error estimate for blocks of size 2^( 7) =       0.001588399911

      target function =                  N/A
              le_mean =     -22.329326378637
             les_mean =     502.277746344018
             stat err =       0.001567044906
             autocorr =       1.323217153816
              std dev =       1.926583459656
             le_variance =       3.711723827021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711348693129
                                         uncertainty =       0.022019801080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.711348693129
                                         uncertainty =       0.022019801080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362272283
  error estimate for blocks of size 2^( 2) =       0.001434187236
  error estimate for blocks of size 2^( 3) =       0.001496952419
  error estimate for blocks of size 2^( 4) =       0.001539684815
  error estimate for blocks of size 2^( 5) =       0.001563048354
  error estimate for blocks of size 2^( 6) =       0.001577155063
  error estimate for blocks of size 2^( 7) =       0.001588443899

      target function =                  N/A
              le_mean =     -22.329324500274
             les_mean =     502.259955132065
             stat err =       0.001567083033
             autocorr =       1.323293489998
              std dev =       1.926574762466
             le_variance =       3.711690315373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329324868243        initial
     3.6380e-01     3.6380e+00             1.0603e-03       -22.329331393318  <--
     1.4552e+00     1.4552e+01             3.5322e-04       -22.329326378637
     5.8208e+00     5.8208e+01             9.6430e-05       -22.329324500274

*****************************************************************************
Applying the update for shift_i =   3.6380e-01     and shift_s =   3.6380e+00
*****************************************************************************

  Execution time = 4.5443e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -6.907219e-01 3 1  ON 0
ci_002                -7.100534e-01 3 1  ON 1
ci_003                -6.264831e-02 3 1  ON 2
ci_004                -6.025029e-02 3 1  ON 3
ci_005                 4.512281e-02 3 1  ON 4
ci_006                 4.636095e-02 3 1  ON 5
ci_007                 3.230253e-02 3 1  ON 6
ci_008                 3.330719e-02 3 1  ON 7
ci_009                -2.456456e-02 3 1  ON 8
ci_010                -2.539216e-02 3 1  ON 9
ci_011                -2.151246e-02 3 1  ON 10
ci_012                -2.245871e-02 3 1  ON 11
ci_013                 1.974238e-02 3 1  ON 12
ci_014                 2.105855e-02 3 1  ON 13
ci_015                 2.088775e-02 3 1  ON 14
ci_016                 2.063031e-02 3 1  ON 15
ci_017                 1.502076e-02 3 1  ON 16
ci_018                 1.498654e-02 3 1  ON 17
ci_019                 9.042378e-03 3 1  ON 18
ci_020                 9.820801e-03 3 1  ON 19
ci_021                -9.906282e-03 3 1  ON 20
ci_022                -1.086880e-02 3 1  ON 21
ci_023                 7.909360e-03 3 1  ON 22
ci_024                 8.913203e-03 3 1  ON 23
ci_025                 7.153271e-03 3 1  ON 24
ci_026                 8.563691e-03 3 1  ON 25
ci_027                 7.764890e-03 3 1  ON 26
ci_028                 8.815383e-03 3 1  ON 27
ci_029                -8.024752e-03 3 1  ON 28
ci_030                -7.334986e-03 3 1  ON 29
ci_031                -7.834250e-03 3 1  ON 30
ci_032                -7.418589e-03 3 1  ON 31
ci_033                 7.475151e-03 3 1  ON 32
ci_034                 7.188875e-03 3 1  ON 33
ci_035                 6.772258e-03 3 1  ON 34
ci_036                 5.679814e-03 3 1  ON 35
ci_037                 6.418476e-03 3 1  ON 36
ci_038                 6.656230e-03 3 1  ON 37
ci_039                 5.863305e-03 3 1  ON 38
ci_040                 5.587868e-03 3 1  ON 39
ci_041                 5.302190e-03 3 1  ON 40
ci_042                 5.454291e-03 3 1  ON 41
ci_043                 4.517500e-03 3 1  ON 42
ci_044                 5.221116e-03 3 1  ON 43
ci_045                 4.040835e-03 3 1  ON 44
ci_046                 5.165137e-03 3 1  ON 45
ci_047                -3.712995e-03 3 1  ON 46
ci_048                -3.936671e-03 3 1  ON 47
ci_049                 3.100784e-03 3 1  ON 48
ci_050                 3.347856e-03 3 1  ON 49
ci_051                -1.618179e-03 3 1  ON 50
ci_052                -2.255536e-03 3 1  ON 51
ci_053                -3.411491e-03 3 1  ON 52
ci_054                -3.150865e-03 3 1  ON 53
ci_055                -2.591082e-03 3 1  ON 54
ci_056                -2.463194e-03 3 1  ON 55
ci_057                -2.184967e-03 3 1  ON 56
ci_058                -2.423545e-03 3 1  ON 57
ci_059                -1.905579e-03 3 1  ON 58
ci_060                -1.998846e-03 3 1  ON 59
ci_061                -1.982023e-03 3 1  ON 60
ci_062                -1.660692e-03 3 1  ON 61
ci_063                -1.216353e-03 3 1  ON 62
ci_064                -3.964022e-04 3 1  ON 63
ci_065                -4.113185e-04 3 1  ON 64
ci_066                -2.121227e-03 3 1  ON 65
ci_067                -7.988285e-04 3 1  ON 66
ci_068                -1.952242e-03 3 1  ON 67
ci_069                 1.610564e-03 3 1  ON 68
ci_070                 1.982952e-03 3 1  ON 69
ci_071                -1.576458e-03 3 1  ON 70
ci_072                -7.756369e-04 3 1  ON 71
ci_073                 1.482684e-03 3 1  ON 72
ci_074                 1.457193e-03 3 1  ON 73
ci_075                -2.755152e-04 3 1  ON 74
ci_076                -1.003701e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5489e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2318e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.1737
    reference variance = 7.62837
====================================================
  Execution time = 2.4234e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0306e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6895e+00
  Total weights = 1.950157804e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9169e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741196951871
                                         uncertainty =       0.025561865839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741196951871
                                         uncertainty =       0.025561865839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367527976
  error estimate for blocks of size 2^( 2) =       0.001439302163
  error estimate for blocks of size 2^( 3) =       0.001503053999
  error estimate for blocks of size 2^( 4) =       0.001548500667
  error estimate for blocks of size 2^( 5) =       0.001566992459
  error estimate for blocks of size 2^( 6) =       0.001575104935
  error estimate for blocks of size 2^( 7) =       0.001587480231

      target function =                  N/A
              le_mean =     -22.326863487514
             les_mean =     502.178351738320
             stat err =       0.001569519573
             autocorr =       1.317228238875
              std dev =       1.934007554315
             le_variance =       3.740385220146


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232686348751e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-02, overlap shift 9.0949e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326863486713       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326920154946       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326924233280       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326925345917       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326925183026       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326925108902       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-02 is 1.776338e-03

solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326863486713       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326891926796       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326892640453       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326892737094       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e-01 is 8.250894e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326863486713       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326872990387       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326873046615       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+00 is 2.615115e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0157e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -6.909056e-01 3 1  ON 0
ci_002                -7.097827e-01 3 1  ON 1
ci_003                -6.242503e-02 3 1  ON 2
ci_004                -6.079285e-02 3 1  ON 3
ci_005                 4.545179e-02 3 1  ON 4
ci_006                 4.650421e-02 3 1  ON 5
ci_007                 3.177852e-02 3 1  ON 6
ci_008                 3.346054e-02 3 1  ON 7
ci_009                -2.478462e-02 3 1  ON 8
ci_010                -2.535941e-02 3 1  ON 9
ci_011                -2.137952e-02 3 1  ON 10
ci_012                -2.247445e-02 3 1  ON 11
ci_013                 1.952732e-02 3 1  ON 12
ci_014                 2.170180e-02 3 1  ON 13
ci_015                 2.078630e-02 3 1  ON 14
ci_016                 2.086576e-02 3 1  ON 15
ci_017                 1.584585e-02 3 1  ON 16
ci_018                 1.509961e-02 3 1  ON 17
ci_019                 9.057059e-03 3 1  ON 18
ci_020                 1.010208e-02 3 1  ON 19
ci_021                -1.009166e-02 3 1  ON 20
ci_022                -1.061649e-02 3 1  ON 21
ci_023                 8.624692e-03 3 1  ON 22
ci_024                 8.613545e-03 3 1  ON 23
ci_025                 7.487032e-03 3 1  ON 24
ci_026                 8.403500e-03 3 1  ON 25
ci_027                 7.434485e-03 3 1  ON 26
ci_028                 8.828985e-03 3 1  ON 27
ci_029                -7.939320e-03 3 1  ON 28
ci_030                -7.434220e-03 3 1  ON 29
ci_031                -7.666212e-03 3 1  ON 30
ci_032                -7.977249e-03 3 1  ON 31
ci_033                 7.234400e-03 3 1  ON 32
ci_034                 7.263349e-03 3 1  ON 33
ci_035                 6.854238e-03 3 1  ON 34
ci_036                 5.988107e-03 3 1  ON 35
ci_037                 6.364375e-03 3 1  ON 36
ci_038                 6.752838e-03 3 1  ON 37
ci_039                 5.804220e-03 3 1  ON 38
ci_040                 5.602898e-03 3 1  ON 39
ci_041                 5.314835e-03 3 1  ON 40
ci_042                 5.724285e-03 3 1  ON 41
ci_043                 5.199207e-03 3 1  ON 42
ci_044                 5.000746e-03 3 1  ON 43
ci_045                 4.027350e-03 3 1  ON 44
ci_046                 5.119639e-03 3 1  ON 45
ci_047                -3.884233e-03 3 1  ON 46
ci_048                -4.095187e-03 3 1  ON 47
ci_049                 3.325411e-03 3 1  ON 48
ci_050                 3.662856e-03 3 1  ON 49
ci_051                -1.843326e-03 3 1  ON 50
ci_052                -2.311106e-03 3 1  ON 51
ci_053                -3.210069e-03 3 1  ON 52
ci_054                -2.947382e-03 3 1  ON 53
ci_055                -2.653306e-03 3 1  ON 54
ci_056                -1.887865e-03 3 1  ON 55
ci_057                -1.954761e-03 3 1  ON 56
ci_058                -2.319918e-03 3 1  ON 57
ci_059                -2.025539e-03 3 1  ON 58
ci_060                -1.969424e-03 3 1  ON 59
ci_061                -1.669185e-03 3 1  ON 60
ci_062                -1.795906e-03 3 1  ON 61
ci_063                -1.286201e-03 3 1  ON 62
ci_064                -7.250681e-04 3 1  ON 63
ci_065                -1.501113e-04 3 1  ON 64
ci_066                -1.402989e-03 3 1  ON 65
ci_067                -1.039349e-03 3 1  ON 66
ci_068                -1.783305e-03 3 1  ON 67
ci_069                 1.945199e-03 3 1  ON 68
ci_070                 1.688969e-03 3 1  ON 69
ci_071                -1.564031e-03 3 1  ON 70
ci_072                -1.099517e-03 3 1  ON 71
ci_073                 1.166669e-03 3 1  ON 72
ci_074                 1.230375e-03 3 1  ON 73
ci_075                -6.124258e-04 3 1  ON 74
ci_076                -1.284691e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.2184
    reference variance = 5.18716
====================================================
  Execution time = 2.3634e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7483e+00
  Total weights = 1.9501e+06
  Execution time = 4.3662e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796254162647
                                         uncertainty =       0.047847267373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796254162647
                                         uncertainty =       0.047847267373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378285128
  error estimate for blocks of size 2^( 2) =       0.001449267631
  error estimate for blocks of size 2^( 3) =       0.001512627700
  error estimate for blocks of size 2^( 4) =       0.001556308867
  error estimate for blocks of size 2^( 5) =       0.001581654891
  error estimate for blocks of size 2^( 6) =       0.001599624511
  error estimate for blocks of size 2^( 7) =       0.001608064654

      target function =                  N/A
              le_mean =     -22.328893156527
             les_mean =     502.371864823372
             stat err =       0.001586413231
             autocorr =       1.324812773100
              std dev =       1.949220706933
             le_variance =       3.799461364338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796534547483
                                         uncertainty =       0.047846411802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796534547483
                                         uncertainty =       0.047846411802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378335893
  error estimate for blocks of size 2^( 2) =       0.001449286848
  error estimate for blocks of size 2^( 3) =       0.001512618824
  error estimate for blocks of size 2^( 4) =       0.001556288393
  error estimate for blocks of size 2^( 5) =       0.001581638747
  error estimate for blocks of size 2^( 6) =       0.001599579561
  error estimate for blocks of size 2^( 7) =       0.001608044781

      target function =                  N/A
              le_mean =     -22.328883945152
             les_mean =     502.330577372095
             stat err =       0.001586387870
             autocorr =       1.324672833480
              std dev =       1.949292501271
             le_variance =       3.799741255510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796547701198
                                         uncertainty =       0.047846863677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796547701198
                                         uncertainty =       0.047846863677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378338313
  error estimate for blocks of size 2^( 2) =       0.001449289038
  error estimate for blocks of size 2^( 3) =       0.001512620208
  error estimate for blocks of size 2^( 4) =       0.001556282890
  error estimate for blocks of size 2^( 5) =       0.001581625800
  error estimate for blocks of size 2^( 6) =       0.001599569167
  error estimate for blocks of size 2^( 7) =       0.001608025001

      target function =                  N/A
              le_mean =     -22.328884449816
             les_mean =     502.331738791974
             stat err =       0.001586375714
             autocorr =       1.324647880425
              std dev =       1.949295923918
             le_variance =       3.799754599002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796242371979
                                         uncertainty =       0.047848624234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796242371979
                                         uncertainty =       0.047848624234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378282992
  error estimate for blocks of size 2^( 2) =       0.001449260183
  error estimate for blocks of size 2^( 3) =       0.001512615330
  error estimate for blocks of size 2^( 4) =       0.001556291887
  error estimate for blocks of size 2^( 5) =       0.001581646641
  error estimate for blocks of size 2^( 6) =       0.001599617012
  error estimate for blocks of size 2^( 7) =       0.001608070299

      target function =                  N/A
              le_mean =     -22.328880974263
             les_mean =     502.329260183624
             stat err =       0.001586406460
             autocorr =       1.324805570350
              std dev =       1.949217686315
             le_variance =       3.799449588642


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328893156527        initial  <--
     9.0949e-02     9.0949e-01             1.7763e-03       -22.328883945152
     3.6380e-01     3.6380e+00             8.2509e-04       -22.328884449816
     1.4552e+00     1.4552e+01             2.6151e-04       -22.328880974263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5268
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -6.907219e-01 3 1  ON 0
ci_002                -7.100534e-01 3 1  ON 1
ci_003                -6.264831e-02 3 1  ON 2
ci_004                -6.025029e-02 3 1  ON 3
ci_005                 4.512281e-02 3 1  ON 4
ci_006                 4.636095e-02 3 1  ON 5
ci_007                 3.230253e-02 3 1  ON 6
ci_008                 3.330719e-02 3 1  ON 7
ci_009                -2.456456e-02 3 1  ON 8
ci_010                -2.539216e-02 3 1  ON 9
ci_011                -2.151246e-02 3 1  ON 10
ci_012                -2.245871e-02 3 1  ON 11
ci_013                 1.974238e-02 3 1  ON 12
ci_014                 2.105855e-02 3 1  ON 13
ci_015                 2.088775e-02 3 1  ON 14
ci_016                 2.063031e-02 3 1  ON 15
ci_017                 1.502076e-02 3 1  ON 16
ci_018                 1.498654e-02 3 1  ON 17
ci_019                 9.042378e-03 3 1  ON 18
ci_020                 9.820801e-03 3 1  ON 19
ci_021                -9.906282e-03 3 1  ON 20
ci_022                -1.086880e-02 3 1  ON 21
ci_023                 7.909360e-03 3 1  ON 22
ci_024                 8.913203e-03 3 1  ON 23
ci_025                 7.153271e-03 3 1  ON 24
ci_026                 8.563691e-03 3 1  ON 25
ci_027                 7.764890e-03 3 1  ON 26
ci_028                 8.815383e-03 3 1  ON 27
ci_029                -8.024752e-03 3 1  ON 28
ci_030                -7.334986e-03 3 1  ON 29
ci_031                -7.834250e-03 3 1  ON 30
ci_032                -7.418589e-03 3 1  ON 31
ci_033                 7.475151e-03 3 1  ON 32
ci_034                 7.188875e-03 3 1  ON 33
ci_035                 6.772258e-03 3 1  ON 34
ci_036                 5.679814e-03 3 1  ON 35
ci_037                 6.418476e-03 3 1  ON 36
ci_038                 6.656230e-03 3 1  ON 37
ci_039                 5.863305e-03 3 1  ON 38
ci_040                 5.587868e-03 3 1  ON 39
ci_041                 5.302190e-03 3 1  ON 40
ci_042                 5.454291e-03 3 1  ON 41
ci_043                 4.517500e-03 3 1  ON 42
ci_044                 5.221116e-03 3 1  ON 43
ci_045                 4.040835e-03 3 1  ON 44
ci_046                 5.165137e-03 3 1  ON 45
ci_047                -3.712995e-03 3 1  ON 46
ci_048                -3.936671e-03 3 1  ON 47
ci_049                 3.100784e-03 3 1  ON 48
ci_050                 3.347856e-03 3 1  ON 49
ci_051                -1.618179e-03 3 1  ON 50
ci_052                -2.255536e-03 3 1  ON 51
ci_053                -3.411491e-03 3 1  ON 52
ci_054                -3.150865e-03 3 1  ON 53
ci_055                -2.591082e-03 3 1  ON 54
ci_056                -2.463194e-03 3 1  ON 55
ci_057                -2.184967e-03 3 1  ON 56
ci_058                -2.423545e-03 3 1  ON 57
ci_059                -1.905579e-03 3 1  ON 58
ci_060                -1.998846e-03 3 1  ON 59
ci_061                -1.982023e-03 3 1  ON 60
ci_062                -1.660692e-03 3 1  ON 61
ci_063                -1.216353e-03 3 1  ON 62
ci_064                -3.964022e-04 3 1  ON 63
ci_065                -4.113185e-04 3 1  ON 64
ci_066                -2.121227e-03 3 1  ON 65
ci_067                -7.988285e-04 3 1  ON 66
ci_068                -1.952242e-03 3 1  ON 67
ci_069                 1.610564e-03 3 1  ON 68
ci_070                 1.982952e-03 3 1  ON 69
ci_071                -1.576458e-03 3 1  ON 70
ci_072                -7.756369e-04 3 1  ON 71
ci_073                 1.482684e-03 3 1  ON 72
ci_074                 1.457193e-03 3 1  ON 73
ci_075                -2.755152e-04 3 1  ON 74
ci_076                -1.003701e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5692e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2315e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.1982
    reference variance = 3.58518
====================================================
  Execution time = 2.4151e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0325e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7483e+00
  Total weights = 1.949385088e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9139e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801370210091
                                         uncertainty =       0.041554328782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801370210091
                                         uncertainty =       0.041554328782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378546482
  error estimate for blocks of size 2^( 2) =       0.001449251010
  error estimate for blocks of size 2^( 3) =       0.001512731687
  error estimate for blocks of size 2^( 4) =       0.001556716637
  error estimate for blocks of size 2^( 5) =       0.001582052903
  error estimate for blocks of size 2^( 6) =       0.001596392921
  error estimate for blocks of size 2^( 7) =       0.001604767296

      target function =                  N/A
              le_mean =     -22.328655616712
             les_mean =     502.317176777694
             stat err =       0.001584982439
             autocorr =       1.321922762613
              std dev =       1.949590324129
             le_variance =       3.800902431939


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232865561671e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328655615851       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328678731660       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328678529915       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328678523006       residual = 1.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-01 is 5.763693e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328655615851       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328662367472       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328662352465       residual = 6.89e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+00 is 1.765433e-04

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328655615851       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328657377899       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328657378982       residual = 5.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+01 is 4.680030e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0071e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -6.906904e-01 3 1  ON 0
ci_002                -7.100968e-01 3 1  ON 1
ci_003                -6.263700e-02 3 1  ON 2
ci_004                -6.025897e-02 3 1  ON 3
ci_005                 4.508659e-02 3 1  ON 4
ci_006                 4.631488e-02 3 1  ON 5
ci_007                 3.219908e-02 3 1  ON 6
ci_008                 3.327730e-02 3 1  ON 7
ci_009                -2.453712e-02 3 1  ON 8
ci_010                -2.536662e-02 3 1  ON 9
ci_011                -2.155317e-02 3 1  ON 10
ci_012                -2.249159e-02 3 1  ON 11
ci_013                 1.978811e-02 3 1  ON 12
ci_014                 2.109037e-02 3 1  ON 13
ci_015                 2.081290e-02 3 1  ON 14
ci_016                 2.066502e-02 3 1  ON 15
ci_017                 1.504126e-02 3 1  ON 16
ci_018                 1.502052e-02 3 1  ON 17
ci_019                 9.046437e-03 3 1  ON 18
ci_020                 9.825939e-03 3 1  ON 19
ci_021                -9.919560e-03 3 1  ON 20
ci_022                -1.082939e-02 3 1  ON 21
ci_023                 7.921186e-03 3 1  ON 22
ci_024                 8.922612e-03 3 1  ON 23
ci_025                 7.189411e-03 3 1  ON 24
ci_026                 8.570676e-03 3 1  ON 25
ci_027                 7.814132e-03 3 1  ON 26
ci_028                 8.730864e-03 3 1  ON 27
ci_029                -7.996263e-03 3 1  ON 28
ci_030                -7.355463e-03 3 1  ON 29
ci_031                -7.748410e-03 3 1  ON 30
ci_032                -7.315455e-03 3 1  ON 31
ci_033                 7.433687e-03 3 1  ON 32
ci_034                 7.174176e-03 3 1  ON 33
ci_035                 6.660343e-03 3 1  ON 34
ci_036                 5.856358e-03 3 1  ON 35
ci_037                 6.392477e-03 3 1  ON 36
ci_038                 6.623936e-03 3 1  ON 37
ci_039                 5.832951e-03 3 1  ON 38
ci_040                 5.626806e-03 3 1  ON 39
ci_041                 5.317431e-03 3 1  ON 40
ci_042                 5.434689e-03 3 1  ON 41
ci_043                 4.512632e-03 3 1  ON 42
ci_044                 5.234954e-03 3 1  ON 43
ci_045                 4.034425e-03 3 1  ON 44
ci_046                 5.151975e-03 3 1  ON 45
ci_047                -3.793763e-03 3 1  ON 46
ci_048                -3.953565e-03 3 1  ON 47
ci_049                 3.164777e-03 3 1  ON 48
ci_050                 3.325960e-03 3 1  ON 49
ci_051                -1.648314e-03 3 1  ON 50
ci_052                -2.323431e-03 3 1  ON 51
ci_053                -3.303246e-03 3 1  ON 52
ci_054                -3.066095e-03 3 1  ON 53
ci_055                -2.555159e-03 3 1  ON 54
ci_056                -2.481937e-03 3 1  ON 55
ci_057                -2.165024e-03 3 1  ON 56
ci_058                -2.351445e-03 3 1  ON 57
ci_059                -1.858699e-03 3 1  ON 58
ci_060                -1.966883e-03 3 1  ON 59
ci_061                -1.946730e-03 3 1  ON 60
ci_062                -1.694488e-03 3 1  ON 61
ci_063                -1.179361e-03 3 1  ON 62
ci_064                -4.964499e-04 3 1  ON 63
ci_065                -4.595928e-04 3 1  ON 64
ci_066                -2.127167e-03 3 1  ON 65
ci_067                -8.214556e-04 3 1  ON 66
ci_068                -1.931054e-03 3 1  ON 67
ci_069                 1.557941e-03 3 1  ON 68
ci_070                 1.977314e-03 3 1  ON 69
ci_071                -1.601891e-03 3 1  ON 70
ci_072                -8.415476e-04 3 1  ON 71
ci_073                 1.465701e-03 3 1  ON 72
ci_074                 1.455959e-03 3 1  ON 73
ci_075                -3.718501e-04 3 1  ON 74
ci_076                -9.834117e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.244
    reference variance = 2.64405
====================================================
  Execution time = 2.3710e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7005e+00
  Total weights = 1.9502e+06
  Execution time = 4.3792e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751096996428
                                         uncertainty =       0.029349222150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751096996428
                                         uncertainty =       0.029349222150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369409313
  error estimate for blocks of size 2^( 2) =       0.001440856861
  error estimate for blocks of size 2^( 3) =       0.001505854086
  error estimate for blocks of size 2^( 4) =       0.001547237381
  error estimate for blocks of size 2^( 5) =       0.001572285725
  error estimate for blocks of size 2^( 6) =       0.001581448833
  error estimate for blocks of size 2^( 7) =       0.001586394649

      target function =                  N/A
              le_mean =     -22.327457904303
             les_mean =     503.268361382713
             stat err =       0.001571841647
             autocorr =       1.317501229639
              std dev =       1.936668208460
             le_variance =       3.750683749660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750958688054
                                         uncertainty =       0.029313970650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750958688054
                                         uncertainty =       0.029313970650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369384017
  error estimate for blocks of size 2^( 2) =       0.001440833734
  error estimate for blocks of size 2^( 3) =       0.001505853946
  error estimate for blocks of size 2^( 4) =       0.001547240453
  error estimate for blocks of size 2^( 5) =       0.001572315509
  error estimate for blocks of size 2^( 6) =       0.001581496306
  error estimate for blocks of size 2^( 7) =       0.001586421605

      target function =                  N/A
              le_mean =     -22.327473851292
             les_mean =     503.380166153541
             stat err =       0.001571868468
             autocorr =       1.317594868600
              std dev =       1.936632434549
             le_variance =       3.750545186549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750858750962
                                         uncertainty =       0.029316986430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750858750962
                                         uncertainty =       0.029316986430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369365850
  error estimate for blocks of size 2^( 2) =       0.001440820793
  error estimate for blocks of size 2^( 3) =       0.001505833244
  error estimate for blocks of size 2^( 4) =       0.001547217681
  error estimate for blocks of size 2^( 5) =       0.001572292345
  error estimate for blocks of size 2^( 6) =       0.001581466451
  error estimate for blocks of size 2^( 7) =       0.001586372698

      target function =                  N/A
              le_mean =     -22.327465542592
             les_mean =     502.219781431376
             stat err =       0.001571837294
             autocorr =       1.317577566174
              std dev =       1.936606741571
             le_variance =       3.750445671499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750891929207
                                         uncertainty =       0.029316828032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750891929207
                                         uncertainty =       0.029316828032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369371947
  error estimate for blocks of size 2^( 2) =       0.001440822708
  error estimate for blocks of size 2^( 3) =       0.001505831296
  error estimate for blocks of size 2^( 4) =       0.001547208328
  error estimate for blocks of size 2^( 5) =       0.001572279034
  error estimate for blocks of size 2^( 6) =       0.001581446240
  error estimate for blocks of size 2^( 7) =       0.001586352528

      target function =                  N/A
              le_mean =     -22.327466193126
             les_mean =     502.216160475835
             stat err =       0.001571821533
             autocorr =       1.317539409457
              std dev =       1.936615364906
             le_variance =       3.750479071588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327457904303        initial
     9.0949e-01     9.0949e+00             5.7637e-04       -22.327473851292  <--
     3.6380e+00     3.6380e+01             1.7654e-04       -22.327465542592
     1.4552e+01     1.4552e+02             4.6800e-05       -22.327466193126

*****************************************************************************
Applying the update for shift_i =   9.0949e-01     and shift_s =   9.0949e+00
*****************************************************************************

  Execution time = 4.5705e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -6.905920e-01 3 1  ON 0
ci_002                -7.102224e-01 3 1  ON 1
ci_003                -6.259997e-02 3 1  ON 2
ci_004                -6.028951e-02 3 1  ON 3
ci_005                 4.499935e-02 3 1  ON 4
ci_006                 4.621134e-02 3 1  ON 5
ci_007                 3.194286e-02 3 1  ON 6
ci_008                 3.321207e-02 3 1  ON 7
ci_009                -2.447294e-02 3 1  ON 8
ci_010                -2.530818e-02 3 1  ON 9
ci_011                -2.165770e-02 3 1  ON 10
ci_012                -2.258502e-02 3 1  ON 11
ci_013                 1.990197e-02 3 1  ON 12
ci_014                 2.116593e-02 3 1  ON 13
ci_015                 2.061074e-02 3 1  ON 14
ci_016                 2.075780e-02 3 1  ON 15
ci_017                 1.509404e-02 3 1  ON 16
ci_018                 1.511649e-02 3 1  ON 17
ci_019                 9.052204e-03 3 1  ON 18
ci_020                 9.834864e-03 3 1  ON 19
ci_021                -9.961225e-03 3 1  ON 20
ci_022                -1.073305e-02 3 1  ON 21
ci_023                 7.949752e-03 3 1  ON 22
ci_024                 8.946852e-03 3 1  ON 23
ci_025                 7.279675e-03 3 1  ON 24
ci_026                 8.588775e-03 3 1  ON 25
ci_027                 7.928132e-03 3 1  ON 26
ci_028                 8.538915e-03 3 1  ON 27
ci_029                -7.919260e-03 3 1  ON 28
ci_030                -7.407029e-03 3 1  ON 29
ci_031                -7.529426e-03 3 1  ON 30
ci_032                -7.049725e-03 3 1  ON 31
ci_033                 7.329741e-03 3 1  ON 32
ci_034                 7.137339e-03 3 1  ON 33
ci_035                 6.404483e-03 3 1  ON 34
ci_036                 6.256184e-03 3 1  ON 35
ci_037                 6.331595e-03 3 1  ON 36
ci_038                 6.543730e-03 3 1  ON 37
ci_039                 5.761942e-03 3 1  ON 38
ci_040                 5.717865e-03 3 1  ON 39
ci_041                 5.354483e-03 3 1  ON 40
ci_042                 5.386263e-03 3 1  ON 41
ci_043                 4.510244e-03 3 1  ON 42
ci_044                 5.274079e-03 3 1  ON 43
ci_045                 4.017902e-03 3 1  ON 44
ci_046                 5.121082e-03 3 1  ON 45
ci_047                -3.972777e-03 3 1  ON 46
ci_048                -3.984547e-03 3 1  ON 47
ci_049                 3.328566e-03 3 1  ON 48
ci_050                 3.267363e-03 3 1  ON 49
ci_051                -1.717754e-03 3 1  ON 50
ci_052                -2.488804e-03 3 1  ON 51
ci_053                -3.028672e-03 3 1  ON 52
ci_054                -2.847986e-03 3 1  ON 53
ci_055                -2.458453e-03 3 1  ON 54
ci_056                -2.532216e-03 3 1  ON 55
ci_057                -2.117175e-03 3 1  ON 56
ci_058                -2.176342e-03 3 1  ON 57
ci_059                -1.757045e-03 3 1  ON 58
ci_060                -1.892206e-03 3 1  ON 59
ci_061                -1.859410e-03 3 1  ON 60
ci_062                -1.779219e-03 3 1  ON 61
ci_063                -1.084354e-03 3 1  ON 62
ci_064                -7.526388e-04 3 1  ON 63
ci_065                -5.765874e-04 3 1  ON 64
ci_066                -2.137685e-03 3 1  ON 65
ci_067                -8.834304e-04 3 1  ON 66
ci_068                -1.875002e-03 3 1  ON 67
ci_069                 1.425390e-03 3 1  ON 68
ci_070                 1.960958e-03 3 1  ON 69
ci_071                -1.658184e-03 3 1  ON 70
ci_072                -1.004057e-03 3 1  ON 71
ci_073                 1.421276e-03 3 1  ON 72
ci_074                 1.449522e-03 3 1  ON 73
ci_075                -6.054232e-04 3 1  ON 74
ci_076                -9.294822e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5784e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.419
    reference variance = 2.75781
====================================================
  Execution time = 2.6297e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0313e+04
  VMC Eavg = -2.2323e+01
  VMC Evar = 3.8551e+00
  Total weights = 1.950022756e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8602e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.911165523598
                                         uncertainty =       0.061382262868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.911165523598
                                         uncertainty =       0.061382262868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001398251187
  error estimate for blocks of size 2^( 2) =       0.001466887941
  error estimate for blocks of size 2^( 3) =       0.001529168072
  error estimate for blocks of size 2^( 4) =       0.001570187467
  error estimate for blocks of size 2^( 5) =       0.001592691327
  error estimate for blocks of size 2^( 6) =       0.001606433346
  error estimate for blocks of size 2^( 7) =       0.001619441837

      target function =                  N/A
              le_mean =     -22.322653019874
             les_mean =     502.155892111084
             stat err =       0.001597188494
             autocorr =       1.304794004944
              std dev =       1.977457430926
             le_variance =       3.910337891124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232265301987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.322653019073       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.322716249878       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.322716945664       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.322716981195       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.322716963423       residual = 6.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-01 is 1.077959e-03

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.322653019073       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.322677095946       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.322677001069       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-01 is 3.800060e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.322653019073       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.322659943881       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.322659920163       residual = 3.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+00 is 1.055743e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2164e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -6.906280e-01 3 1  ON 0
ci_002                -7.101337e-01 3 1  ON 1
ci_003                -6.231386e-02 3 1  ON 2
ci_004                -6.049478e-02 3 1  ON 3
ci_005                 4.525266e-02 3 1  ON 4
ci_006                 4.645739e-02 3 1  ON 5
ci_007                 3.217258e-02 3 1  ON 6
ci_008                 3.304623e-02 3 1  ON 7
ci_009                -2.451560e-02 3 1  ON 8
ci_010                -2.533137e-02 3 1  ON 9
ci_011                -2.164978e-02 3 1  ON 10
ci_012                -2.252440e-02 3 1  ON 11
ci_013                 1.997947e-02 3 1  ON 12
ci_014                 2.133232e-02 3 1  ON 13
ci_015                 2.062592e-02 3 1  ON 14
ci_016                 2.108037e-02 3 1  ON 15
ci_017                 1.531444e-02 3 1  ON 16
ci_018                 1.513962e-02 3 1  ON 17
ci_019                 9.350664e-03 3 1  ON 18
ci_020                 1.007212e-02 3 1  ON 19
ci_021                -9.750185e-03 3 1  ON 20
ci_022                -1.084375e-02 3 1  ON 21
ci_023                 8.155388e-03 3 1  ON 22
ci_024                 8.735209e-03 3 1  ON 23
ci_025                 7.376103e-03 3 1  ON 24
ci_026                 8.538621e-03 3 1  ON 25
ci_027                 7.907501e-03 3 1  ON 26
ci_028                 8.213293e-03 3 1  ON 27
ci_029                -7.833093e-03 3 1  ON 28
ci_030                -7.471239e-03 3 1  ON 29
ci_031                -7.582639e-03 3 1  ON 30
ci_032                -6.960528e-03 3 1  ON 31
ci_033                 7.348775e-03 3 1  ON 32
ci_034                 6.918381e-03 3 1  ON 33
ci_035                 6.507020e-03 3 1  ON 34
ci_036                 6.249814e-03 3 1  ON 35
ci_037                 6.337650e-03 3 1  ON 36
ci_038                 6.788302e-03 3 1  ON 37
ci_039                 5.576186e-03 3 1  ON 38
ci_040                 5.765491e-03 3 1  ON 39
ci_041                 5.261030e-03 3 1  ON 40
ci_042                 5.426491e-03 3 1  ON 41
ci_043                 4.599992e-03 3 1  ON 42
ci_044                 5.336836e-03 3 1  ON 43
ci_045                 3.853870e-03 3 1  ON 44
ci_046                 5.206520e-03 3 1  ON 45
ci_047                -3.940990e-03 3 1  ON 46
ci_048                -4.271304e-03 3 1  ON 47
ci_049                 3.486596e-03 3 1  ON 48
ci_050                 3.319638e-03 3 1  ON 49
ci_051                -2.097760e-03 3 1  ON 50
ci_052                -2.742931e-03 3 1  ON 51
ci_053                -3.130231e-03 3 1  ON 52
ci_054                -2.999514e-03 3 1  ON 53
ci_055                -2.443034e-03 3 1  ON 54
ci_056                -2.479105e-03 3 1  ON 55
ci_057                -2.063406e-03 3 1  ON 56
ci_058                -1.927733e-03 3 1  ON 57
ci_059                -1.851451e-03 3 1  ON 58
ci_060                -1.742058e-03 3 1  ON 59
ci_061                -2.035228e-03 3 1  ON 60
ci_062                -1.845183e-03 3 1  ON 61
ci_063                -1.234653e-03 3 1  ON 62
ci_064                -1.005607e-03 3 1  ON 63
ci_065                -6.243808e-04 3 1  ON 64
ci_066                -2.076873e-03 3 1  ON 65
ci_067                -8.347554e-04 3 1  ON 66
ci_068                -1.705368e-03 3 1  ON 67
ci_069                 1.354702e-03 3 1  ON 68
ci_070                 1.885623e-03 3 1  ON 69
ci_071                -1.508334e-03 3 1  ON 70
ci_072                -1.054573e-03 3 1  ON 71
ci_073                 1.349166e-03 3 1  ON 72
ci_074                 1.302215e-03 3 1  ON 73
ci_075                -6.718376e-04 3 1  ON 74
ci_076                -6.755803e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.0829
    reference variance = 4.59231
====================================================
  Execution time = 2.3634e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7100e+00
  Total weights = 1.9501e+06
  Execution time = 4.3867e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761072745445
                                         uncertainty =       0.025670016053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761072745445
                                         uncertainty =       0.025670016053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371210372
  error estimate for blocks of size 2^( 2) =       0.001442166465
  error estimate for blocks of size 2^( 3) =       0.001505700387
  error estimate for blocks of size 2^( 4) =       0.001549863273
  error estimate for blocks of size 2^( 5) =       0.001573640476
  error estimate for blocks of size 2^( 6) =       0.001586801355
  error estimate for blocks of size 2^( 7) =       0.001602756114

      target function =                  N/A
              le_mean =     -22.328628357903
             les_mean =     502.281239955018
             stat err =       0.001578265305
             autocorr =       1.324804636797
              std dev =       1.939215331917
             le_variance =       3.760556103544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761505866829
                                         uncertainty =       0.025656865289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761505866829
                                         uncertainty =       0.025656865289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371289296
  error estimate for blocks of size 2^( 2) =       0.001442220732
  error estimate for blocks of size 2^( 3) =       0.001505737776
  error estimate for blocks of size 2^( 4) =       0.001549865873
  error estimate for blocks of size 2^( 5) =       0.001573645533
  error estimate for blocks of size 2^( 6) =       0.001586775485
  error estimate for blocks of size 2^( 7) =       0.001602764627

      target function =                  N/A
              le_mean =     -22.328641703833
             les_mean =     502.376726796672
             stat err =       0.001578262879
             autocorr =       1.324648073085
              std dev =       1.939326948805
             le_variance =       3.760989014360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761355360530
                                         uncertainty =       0.025660700037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761355360530
                                         uncertainty =       0.025660700037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371261870
  error estimate for blocks of size 2^( 2) =       0.001442198670
  error estimate for blocks of size 2^( 3) =       0.001505715658
  error estimate for blocks of size 2^( 4) =       0.001549848348
  error estimate for blocks of size 2^( 5) =       0.001573622866
  error estimate for blocks of size 2^( 6) =       0.001586765806
  error estimate for blocks of size 2^( 7) =       0.001602746166

      target function =                  N/A
              le_mean =     -22.328634459683
             les_mean =     502.279175190866
             stat err =       0.001578245797
             autocorr =       1.324672385034
              std dev =       1.939288161826
             le_variance =       3.760838574600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761101586190
                                         uncertainty =       0.025668907180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761101586190
                                         uncertainty =       0.025668907180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371215628
  error estimate for blocks of size 2^( 2) =       0.001442169373
  error estimate for blocks of size 2^( 3) =       0.001505701165
  error estimate for blocks of size 2^( 4) =       0.001549859332
  error estimate for blocks of size 2^( 5) =       0.001573637624
  error estimate for blocks of size 2^( 6) =       0.001586794044
  error estimate for blocks of size 2^( 7) =       0.001602751698

      target function =                  N/A
              le_mean =     -22.328626817704
             les_mean =     502.278214610613
             stat err =       0.001578260674
             autocorr =       1.324786707388
              std dev =       1.939222765159
             le_variance =       3.760584932911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328628357903        initial
     2.2737e-01     2.2737e+00             1.0780e-03       -22.328641703833  <--
     9.0949e-01     9.0949e+00             3.8001e-04       -22.328634459683
     3.6380e+00     3.6380e+01             1.0557e-04       -22.328626817704

*****************************************************************************
Applying the update for shift_i =   2.2737e-01     and shift_s =   2.2737e+00
*****************************************************************************

  Execution time = 4.5661e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -6.907805e-01 3 1  ON 0
ci_002                -7.099041e-01 3 1  ON 1
ci_003                -6.159319e-02 3 1  ON 2
ci_004                -6.099017e-02 3 1  ON 3
ci_005                 4.562338e-02 3 1  ON 4
ci_006                 4.681935e-02 3 1  ON 5
ci_007                 3.260340e-02 3 1  ON 6
ci_008                 3.279270e-02 3 1  ON 7
ci_009                -2.457774e-02 3 1  ON 8
ci_010                -2.537302e-02 3 1  ON 9
ci_011                -2.164097e-02 3 1  ON 10
ci_012                -2.235173e-02 3 1  ON 11
ci_013                 2.011956e-02 3 1  ON 12
ci_014                 2.160590e-02 3 1  ON 13
ci_015                 2.065968e-02 3 1  ON 14
ci_016                 2.170917e-02 3 1  ON 15
ci_017                 1.568730e-02 3 1  ON 16
ci_018                 1.518092e-02 3 1  ON 17
ci_019                 9.916007e-03 3 1  ON 18
ci_020                 1.052734e-02 3 1  ON 19
ci_021                -9.351773e-03 3 1  ON 20
ci_022                -1.110870e-02 3 1  ON 21
ci_023                 8.488628e-03 3 1  ON 22
ci_024                 8.396268e-03 3 1  ON 23
ci_025                 7.526612e-03 3 1  ON 24
ci_026                 8.430552e-03 3 1  ON 25
ci_027                 7.892818e-03 3 1  ON 26
ci_028                 7.778371e-03 3 1  ON 27
ci_029                -7.657500e-03 3 1  ON 28
ci_030                -7.583185e-03 3 1  ON 29
ci_031                -7.711104e-03 3 1  ON 30
ci_032                -6.767533e-03 3 1  ON 31
ci_033                 7.418789e-03 3 1  ON 32
ci_034                 6.515791e-03 3 1  ON 33
ci_035                 6.627728e-03 3 1  ON 34
ci_036                 6.254022e-03 3 1  ON 35
ci_037                 6.342788e-03 3 1  ON 36
ci_038                 7.183449e-03 3 1  ON 37
ci_039                 5.325843e-03 3 1  ON 38
ci_040                 5.830089e-03 3 1  ON 39
ci_041                 5.128682e-03 3 1  ON 40
ci_042                 5.476833e-03 3 1  ON 41
ci_043                 4.745801e-03 3 1  ON 42
ci_044                 5.403637e-03 3 1  ON 43
ci_045                 3.560014e-03 3 1  ON 44
ci_046                 5.387463e-03 3 1  ON 45
ci_047                -3.900568e-03 3 1  ON 46
ci_048                -4.641284e-03 3 1  ON 47
ci_049                 3.754898e-03 3 1  ON 48
ci_050                 3.400229e-03 3 1  ON 49
ci_051                -2.795713e-03 3 1  ON 50
ci_052                -3.154828e-03 3 1  ON 51
ci_053                -3.289749e-03 3 1  ON 52
ci_054                -3.243596e-03 3 1  ON 53
ci_055                -2.408872e-03 3 1  ON 54
ci_056                -2.378406e-03 3 1  ON 55
ci_057                -1.978674e-03 3 1  ON 56
ci_058                -1.540384e-03 3 1  ON 57
ci_059                -1.990724e-03 3 1  ON 58
ci_060                -1.537852e-03 3 1  ON 59
ci_061                -2.313753e-03 3 1  ON 60
ci_062                -1.951069e-03 3 1  ON 61
ci_063                -1.474556e-03 3 1  ON 62
ci_064                -1.410143e-03 3 1  ON 63
ci_065                -7.225214e-04 3 1  ON 64
ci_066                -1.976288e-03 3 1  ON 65
ci_067                -7.553512e-04 3 1  ON 66
ci_068                -1.415518e-03 3 1  ON 67
ci_069                 1.246584e-03 3 1  ON 68
ci_070                 1.761054e-03 3 1  ON 69
ci_071                -1.219088e-03 3 1  ON 70
ci_072                -1.115016e-03 3 1  ON 71
ci_073                 1.275258e-03 3 1  ON 72
ci_074                 1.127942e-03 3 1  ON 73
ci_075                -7.848642e-04 3 1  ON 74
ci_076                -2.725890e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2312e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.4739
    reference variance = 2.4059
====================================================
  Execution time = 2.4159e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0267e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7028e+00
  Total weights = 1.949810394e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9204e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753363919161
                                         uncertainty =       0.030874258439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753363919161
                                         uncertainty =       0.030874258439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369850357
  error estimate for blocks of size 2^( 2) =       0.001440294014
  error estimate for blocks of size 2^( 3) =       0.001503186168
  error estimate for blocks of size 2^( 4) =       0.001545720030
  error estimate for blocks of size 2^( 5) =       0.001571921775
  error estimate for blocks of size 2^( 6) =       0.001583756181
  error estimate for blocks of size 2^( 7) =       0.001585181817

      target function =                  N/A
              le_mean =     -22.328358233503
             les_mean =     502.258373560972
             stat err =       0.001571644951
             autocorr =       1.316323481512
              std dev =       1.937291949547
             le_variance =       3.753100097779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232835823350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-02, overlap shift 5.6843e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328358232707       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328434731711       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328452528918       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328456401860       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328456394285       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328456902704       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328456935214       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.328457071043       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e-02 is 3.075505e-03

solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328358232707       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328404198415       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328409660598       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328410135129       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328410033288       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-01 is 1.156318e-03

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328358232707       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328375935295       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328376756790       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328376794463       residual = 5.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e-01 is 4.196469e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149942 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0087e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -6.903208e-01 3 1  ON 0
ci_002                -7.102819e-01 3 1  ON 1
ci_003                -6.206409e-02 3 1  ON 2
ci_004                -6.214649e-02 3 1  ON 3
ci_005                 4.560878e-02 3 1  ON 4
ci_006                 4.611099e-02 3 1  ON 5
ci_007                 3.245243e-02 3 1  ON 6
ci_008                 3.307324e-02 3 1  ON 7
ci_009                -2.496126e-02 3 1  ON 8
ci_010                -2.556504e-02 3 1  ON 9
ci_011                -2.162846e-02 3 1  ON 10
ci_012                -2.272538e-02 3 1  ON 11
ci_013                 2.018073e-02 3 1  ON 12
ci_014                 2.131131e-02 3 1  ON 13
ci_015                 1.986808e-02 3 1  ON 14
ci_016                 2.091822e-02 3 1  ON 15
ci_017                 1.577942e-02 3 1  ON 16
ci_018                 1.549668e-02 3 1  ON 17
ci_019                 1.033898e-02 3 1  ON 18
ci_020                 9.979651e-03 3 1  ON 19
ci_021                -9.548125e-03 3 1  ON 20
ci_022                -1.142960e-02 3 1  ON 21
ci_023                 8.306237e-03 3 1  ON 22
ci_024                 8.783316e-03 3 1  ON 23
ci_025                 7.658617e-03 3 1  ON 24
ci_026                 8.677424e-03 3 1  ON 25
ci_027                 7.595059e-03 3 1  ON 26
ci_028                 7.454882e-03 3 1  ON 27
ci_029                -6.875328e-03 3 1  ON 28
ci_030                -7.467730e-03 3 1  ON 29
ci_031                -7.264660e-03 3 1  ON 30
ci_032                -7.423248e-03 3 1  ON 31
ci_033                 6.995577e-03 3 1  ON 32
ci_034                 6.269478e-03 3 1  ON 33
ci_035                 7.061763e-03 3 1  ON 34
ci_036                 6.594922e-03 3 1  ON 35
ci_037                 5.922364e-03 3 1  ON 36
ci_038                 6.997324e-03 3 1  ON 37
ci_039                 4.993588e-03 3 1  ON 38
ci_040                 5.768493e-03 3 1  ON 39
ci_041                 5.181111e-03 3 1  ON 40
ci_042                 5.479795e-03 3 1  ON 41
ci_043                 4.728616e-03 3 1  ON 42
ci_044                 6.000710e-03 3 1  ON 43
ci_045                 4.335725e-03 3 1  ON 44
ci_046                 5.286559e-03 3 1  ON 45
ci_047                -4.150684e-03 3 1  ON 46
ci_048                -4.269930e-03 3 1  ON 47
ci_049                 3.736856e-03 3 1  ON 48
ci_050                 3.468517e-03 3 1  ON 49
ci_051                -3.015059e-03 3 1  ON 50
ci_052                -2.936455e-03 3 1  ON 51
ci_053                -2.208367e-03 3 1  ON 52
ci_054                -2.574429e-03 3 1  ON 53
ci_055                -1.961521e-03 3 1  ON 54
ci_056                -2.014837e-03 3 1  ON 55
ci_057                -2.121028e-03 3 1  ON 56
ci_058                -1.653485e-03 3 1  ON 57
ci_059                -2.387314e-03 3 1  ON 58
ci_060                -1.632835e-03 3 1  ON 59
ci_061                -2.081457e-03 3 1  ON 60
ci_062                -1.843100e-03 3 1  ON 61
ci_063                -8.213152e-04 3 1  ON 62
ci_064                -9.644509e-04 3 1  ON 63
ci_065                -1.549811e-03 3 1  ON 64
ci_066                -1.971639e-03 3 1  ON 65
ci_067                -2.296749e-04 3 1  ON 66
ci_068                -1.103535e-03 3 1  ON 67
ci_069                 1.881284e-03 3 1  ON 68
ci_070                 1.660763e-03 3 1  ON 69
ci_071                -1.426042e-03 3 1  ON 70
ci_072                -5.301502e-04 3 1  ON 71
ci_073                 1.381805e-03 3 1  ON 72
ci_074                 1.409834e-03 3 1  ON 73
ci_075                -1.488588e-03 3 1  ON 74
ci_076                -8.199062e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -21.7522
    reference variance = 9.82958
====================================================
  Execution time = 2.3606e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7523e+00
  Total weights = 1.9497e+06
  Execution time = 4.3732e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.115201
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805863030343
                                         uncertainty =       0.039559188440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805863030343
                                         uncertainty =       0.039559188440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379517033
  error estimate for blocks of size 2^( 2) =       0.001449119724
  error estimate for blocks of size 2^( 3) =       0.001512312324
  error estimate for blocks of size 2^( 4) =       0.001553874423
  error estimate for blocks of size 2^( 5) =       0.001576571274
  error estimate for blocks of size 2^( 6) =       0.001587816332
  error estimate for blocks of size 2^( 7) =       0.001600397044

      target function =                  N/A
              le_mean =     -22.327479038236
             les_mean =     502.397762876231
             stat err =       0.001579664768
             autocorr =       1.311220498475
              std dev =       1.950962911878
             le_variance =       3.806256283524

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.284716
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805671487955
                                         uncertainty =       0.039547391227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805671487955
                                         uncertainty =       0.039547391227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379481887
  error estimate for blocks of size 2^( 2) =       0.001449094763
  error estimate for blocks of size 2^( 3) =       0.001512300812
  error estimate for blocks of size 2^( 4) =       0.001553863512
  error estimate for blocks of size 2^( 5) =       0.001576570097
  error estimate for blocks of size 2^( 6) =       0.001587883794
  error estimate for blocks of size 2^( 7) =       0.001600476430

      target function =                  N/A
              le_mean =     -22.327492172435
             les_mean =     502.272735243373
             stat err =       0.001579698458
             autocorr =       1.311343246217
              std dev =       1.950913206969
             le_variance =       3.806062341125

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.119673
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807431481994
                                         uncertainty =       0.039466087104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807431481994
                                         uncertainty =       0.039466087104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379800018
  error estimate for blocks of size 2^( 2) =       0.001449429467
  error estimate for blocks of size 2^( 3) =       0.001512649017
  error estimate for blocks of size 2^( 4) =       0.001554201024
  error estimate for blocks of size 2^( 5) =       0.001576917583
  error estimate for blocks of size 2^( 6) =       0.001588300657
  error estimate for blocks of size 2^( 7) =       0.001600857405

      target function =                  N/A
              le_mean =     -22.327469989250
             les_mean =     502.715265515388
             stat err =       0.001580069167
             autocorr =       1.311353876194
              std dev =       1.951363120504
             le_variance =       3.807818028064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805740199703
                                         uncertainty =       0.039556612493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805740199703
                                         uncertainty =       0.039556612493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379494722
  error estimate for blocks of size 2^( 2) =       0.001449104948
  error estimate for blocks of size 2^( 3) =       0.001512306928
  error estimate for blocks of size 2^( 4) =       0.001553869075
  error estimate for blocks of size 2^( 5) =       0.001576581516
  error estimate for blocks of size 2^( 6) =       0.001587843835
  error estimate for blocks of size 2^( 7) =       0.001600462098

      target function =                  N/A
              le_mean =     -22.327469117959
             les_mean =     502.269748650283
             stat err =       0.001579689131
             autocorr =       1.311303358820
              std dev =       1.950931359360
             le_variance =       3.806133168935


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327479038236        initial
     5.6843e-02     5.6843e-01             3.0755e-03       -22.327492172435  <--
     2.2737e-01     2.2737e+00             1.1563e-03       -22.327469989250
     9.0949e-01     9.0949e+00             4.1965e-04       -22.327469117959

*****************************************************************************
Applying the update for shift_i =   5.6843e-02     and shift_s =   5.6843e-01
*****************************************************************************

  Execution time = 4.5561e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -6.888884e-01 3 1  ON 0
ci_002                -7.115054e-01 3 1  ON 1
ci_003                -6.275777e-02 3 1  ON 2
ci_004                -6.406568e-02 3 1  ON 3
ci_005                 4.551897e-02 3 1  ON 4
ci_006                 4.574053e-02 3 1  ON 5
ci_007                 3.229502e-02 3 1  ON 6
ci_008                 3.326105e-02 3 1  ON 7
ci_009                -2.519486e-02 3 1  ON 8
ci_010                -2.565833e-02 3 1  ON 9
ci_011                -2.167996e-02 3 1  ON 10
ci_012                -2.316192e-02 3 1  ON 11
ci_013                 2.021505e-02 3 1  ON 12
ci_014                 2.100706e-02 3 1  ON 13
ci_015                 1.902137e-02 3 1  ON 14
ci_016                 2.009561e-02 3 1  ON 15
ci_017                 1.587628e-02 3 1  ON 16
ci_018                 1.587189e-02 3 1  ON 17
ci_019                 1.076175e-02 3 1  ON 18
ci_020                 9.464335e-03 3 1  ON 19
ci_021                -9.805006e-03 3 1  ON 20
ci_022                -1.168199e-02 3 1  ON 21
ci_023                 8.178116e-03 3 1  ON 22
ci_024                 9.085346e-03 3 1  ON 23
ci_025                 7.685490e-03 3 1  ON 24
ci_026                 8.956002e-03 3 1  ON 25
ci_027                 7.480325e-03 3 1  ON 26
ci_028                 7.311459e-03 3 1  ON 27
ci_029                -6.227444e-03 3 1  ON 28
ci_030                -7.346376e-03 3 1  ON 29
ci_031                -6.918868e-03 3 1  ON 30
ci_032                -8.019847e-03 3 1  ON 31
ci_033                 6.572784e-03 3 1  ON 32
ci_034                 6.079860e-03 3 1  ON 33
ci_035                 7.288168e-03 3 1  ON 34
ci_036                 6.883454e-03 3 1  ON 35
ci_037                 5.637669e-03 3 1  ON 36
ci_038                 6.887168e-03 3 1  ON 37
ci_039                 4.857971e-03 3 1  ON 38
ci_040                 5.779218e-03 3 1  ON 39
ci_041                 5.201857e-03 3 1  ON 40
ci_042                 5.493706e-03 3 1  ON 41
ci_043                 4.845916e-03 3 1  ON 42
ci_044                 6.487540e-03 3 1  ON 43
ci_045                 4.972643e-03 3 1  ON 44
ci_046                 5.238652e-03 3 1  ON 45
ci_047                -4.264234e-03 3 1  ON 46
ci_048                -4.090920e-03 3 1  ON 47
ci_049                 3.724734e-03 3 1  ON 48
ci_050                 3.532473e-03 3 1  ON 49
ci_051                -3.178554e-03 3 1  ON 50
ci_052                -2.863185e-03 3 1  ON 51
ci_053                -1.480938e-03 3 1  ON 52
ci_054                -2.029468e-03 3 1  ON 53
ci_055                -1.607969e-03 3 1  ON 54
ci_056                -1.736006e-03 3 1  ON 55
ci_057                -2.200137e-03 3 1  ON 56
ci_058                -1.725370e-03 3 1  ON 57
ci_059                -2.572980e-03 3 1  ON 58
ci_060                -1.668303e-03 3 1  ON 59
ci_061                -1.987486e-03 3 1  ON 60
ci_062                -1.783413e-03 3 1  ON 61
ci_063                -3.466568e-04 3 1  ON 62
ci_064                -6.711005e-04 3 1  ON 63
ci_065                -2.203897e-03 3 1  ON 64
ci_066                -1.972356e-03 3 1  ON 65
ci_067                 1.034124e-04 3 1  ON 66
ci_068                -8.558189e-04 3 1  ON 67
ci_069                 2.281086e-03 3 1  ON 68
ci_070                 1.600378e-03 3 1  ON 69
ci_071                -1.541797e-03 3 1  ON 70
ci_072                -8.013345e-05 3 1  ON 71
ci_073                 1.372500e-03 3 1  ON 72
ci_074                 1.565523e-03 3 1  ON 73
ci_075                -1.894127e-03 3 1  ON 74
ci_076                -1.240068e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5658e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2307e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.5837
    reference variance = 2.36668
====================================================
  Execution time = 2.4194e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0270e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7179e+00
  Total weights = 1.949645054e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8461e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770138257570
                                         uncertainty =       0.029924246359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770138257570
                                         uncertainty =       0.029924246359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373009030
  error estimate for blocks of size 2^( 2) =       0.001443216023
  error estimate for blocks of size 2^( 3) =       0.001505718951
  error estimate for blocks of size 2^( 4) =       0.001547322288
  error estimate for blocks of size 2^( 5) =       0.001574001695
  error estimate for blocks of size 2^( 6) =       0.001590327544
  error estimate for blocks of size 2^( 7) =       0.001597956454

      target function =                  N/A
              le_mean =     -22.326505238073
             les_mean =     502.190698781658
             stat err =       0.001577401995
             autocorr =       1.319890748826
              std dev =       1.941759058268
             le_variance =       3.770428240367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232650523807e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e-02, overlap shift 1.4211e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326505237262       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326659767857       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326676116263       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326680766255       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326683023548       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326685137050       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.326688618786       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.326687845701       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.326688045496       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.326688153547       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e-02 is 5.907979e-03

solving harmonic davidson linear method for identity shift 5.6843e-02, overlap shift 5.6843e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326505237262       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326633654036       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326643193870       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326644940647       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326645247111       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326645376266       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.326645615809       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.326645469062       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e-02 is 2.153247e-03

solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326505237262       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326581859571       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326584270559       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326584409733       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326584401062       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e-01 is 1.213160e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0049e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -6.878464e-01 3 1  ON 0
ci_002                -7.129933e-01 3 1  ON 1
ci_003                -6.060452e-02 3 1  ON 2
ci_004                -6.328622e-02 3 1  ON 3
ci_005                 4.419170e-02 3 1  ON 4
ci_006                 4.580549e-02 3 1  ON 5
ci_007                 3.137130e-02 3 1  ON 6
ci_008                 3.170638e-02 3 1  ON 7
ci_009                -2.584185e-02 3 1  ON 8
ci_010                -2.451696e-02 3 1  ON 9
ci_011                -2.195373e-02 3 1  ON 10
ci_012                -2.283041e-02 3 1  ON 11
ci_013                 1.933023e-02 3 1  ON 12
ci_014                 2.148698e-02 3 1  ON 13
ci_015                 2.021559e-02 3 1  ON 14
ci_016                 2.073800e-02 3 1  ON 15
ci_017                 1.458965e-02 3 1  ON 16
ci_018                 1.533324e-02 3 1  ON 17
ci_019                 1.037652e-02 3 1  ON 18
ci_020                 1.064116e-02 3 1  ON 19
ci_021                -9.102806e-03 3 1  ON 20
ci_022                -1.180628e-02 3 1  ON 21
ci_023                 8.053632e-03 3 1  ON 22
ci_024                 9.522124e-03 3 1  ON 23
ci_025                 7.159415e-03 3 1  ON 24
ci_026                 8.306718e-03 3 1  ON 25
ci_027                 8.853757e-03 3 1  ON 26
ci_028                 8.491114e-03 3 1  ON 27
ci_029                -7.692623e-03 3 1  ON 28
ci_030                -7.895353e-03 3 1  ON 29
ci_031                -6.119685e-03 3 1  ON 30
ci_032                -7.486305e-03 3 1  ON 31
ci_033                 7.982884e-03 3 1  ON 32
ci_034                 6.545944e-03 3 1  ON 33
ci_035                 6.728670e-03 3 1  ON 34
ci_036                 7.136487e-03 3 1  ON 35
ci_037                 5.628813e-03 3 1  ON 36
ci_038                 6.059313e-03 3 1  ON 37
ci_039                 5.654777e-03 3 1  ON 38
ci_040                 5.277441e-03 3 1  ON 39
ci_041                 4.958770e-03 3 1  ON 40
ci_042                 5.709471e-03 3 1  ON 41
ci_043                 3.624978e-03 3 1  ON 42
ci_044                 4.422842e-03 3 1  ON 43
ci_045                 4.418177e-03 3 1  ON 44
ci_046                 4.770529e-03 3 1  ON 45
ci_047                -4.363228e-03 3 1  ON 46
ci_048                -4.235654e-03 3 1  ON 47
ci_049                 2.746330e-03 3 1  ON 48
ci_050                 2.970620e-03 3 1  ON 49
ci_051                -1.199463e-03 3 1  ON 50
ci_052                -3.973592e-03 3 1  ON 51
ci_053                -2.857798e-03 3 1  ON 52
ci_054                -3.465300e-03 3 1  ON 53
ci_055                -3.312280e-03 3 1  ON 54
ci_056                -2.415337e-03 3 1  ON 55
ci_057                -2.007585e-03 3 1  ON 56
ci_058                -2.414109e-03 3 1  ON 57
ci_059                -2.562639e-03 3 1  ON 58
ci_060                -2.311114e-03 3 1  ON 59
ci_061                -2.699044e-03 3 1  ON 60
ci_062                -1.832974e-03 3 1  ON 61
ci_063                -1.694840e-03 3 1  ON 62
ci_064                -2.872180e-04 3 1  ON 63
ci_065                -1.878243e-03 3 1  ON 64
ci_066                -1.425206e-03 3 1  ON 65
ci_067                -8.326799e-04 3 1  ON 66
ci_068                -2.071324e-03 3 1  ON 67
ci_069                 1.492313e-03 3 1  ON 68
ci_070                 2.143647e-03 3 1  ON 69
ci_071                -1.987949e-03 3 1  ON 70
ci_072                -6.932734e-04 3 1  ON 71
ci_073                 1.545518e-03 3 1  ON 72
ci_074                 1.495485e-03 3 1  ON 73
ci_075                -1.106373e-03 3 1  ON 74
ci_076                -9.057009e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.0982
    reference variance = 4.32449
====================================================
  Execution time = 2.3629e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7217e+00
  Total weights = 1.9500e+06
  Execution time = 4.3709e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0901159
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775243513039
                                         uncertainty =       0.036745166331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.775243513039
                                         uncertainty =       0.036745166331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373836430
  error estimate for blocks of size 2^( 2) =       0.001446775338
  error estimate for blocks of size 2^( 3) =       0.001509735109
  error estimate for blocks of size 2^( 4) =       0.001551910064
  error estimate for blocks of size 2^( 5) =       0.001575835799
  error estimate for blocks of size 2^( 6) =       0.001586611044
  error estimate for blocks of size 2^( 7) =       0.001595943021

      target function =                  N/A
              le_mean =     -22.327142278960
             les_mean =     502.232737575348
             stat err =       0.001577574982
             autocorr =       1.318590565920
              std dev =       1.942929197364
             le_variance =       3.774973865968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774588025301
                                         uncertainty =       0.036729683916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774588025301
                                         uncertainty =       0.036729683916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373718920
  error estimate for blocks of size 2^( 2) =       0.001446733737
  error estimate for blocks of size 2^( 3) =       0.001509754866
  error estimate for blocks of size 2^( 4) =       0.001551977460
  error estimate for blocks of size 2^( 5) =       0.001575932123
  error estimate for blocks of size 2^( 6) =       0.001586725030
  error estimate for blocks of size 2^( 7) =       0.001596145747

      target function =                  N/A
              le_mean =     -22.327044638982
             les_mean =     502.237133611621
             stat err =       0.001577695090
             autocorr =       1.319016985827
              std dev =       1.942763011150
             le_variance =       3.774328117491

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0934508
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794440044740
                                         uncertainty =       0.041182886784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794440044740
                                         uncertainty =       0.041182886784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377319885
  error estimate for blocks of size 2^( 2) =       0.001450113111
  error estimate for blocks of size 2^( 3) =       0.001513019265
  error estimate for blocks of size 2^( 4) =       0.001555029090
  error estimate for blocks of size 2^( 5) =       0.001579594082
  error estimate for blocks of size 2^( 6) =       0.001590549272
  error estimate for blocks of size 2^( 7) =       0.001599500753

      target function =                  N/A
              le_mean =     -22.327020873413
             les_mean =     504.638306760899
             stat err =       0.001581168299
             autocorr =       1.317912454552
              std dev =       1.947855625667
             le_variance =       3.794141538443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774713406418
                                         uncertainty =       0.036740734139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774713406418
                                         uncertainty =       0.036740734139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373740680
  error estimate for blocks of size 2^( 2) =       0.001446721981
  error estimate for blocks of size 2^( 3) =       0.001509716284
  error estimate for blocks of size 2^( 4) =       0.001551911216
  error estimate for blocks of size 2^( 5) =       0.001575857399
  error estimate for blocks of size 2^( 6) =       0.001586640487
  error estimate for blocks of size 2^( 7) =       0.001596032483

      target function =                  N/A
              le_mean =     -22.327059719090
             les_mean =     502.225230536398
             stat err =       0.001577610396
             autocorr =       1.318833593115
              std dev =       1.942793784969
             le_variance =       3.774447690916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327142278960        initial  <--
     1.4211e-02     1.4211e-01             5.9080e-03       -22.327044638982
     5.6843e-02     5.6843e-01             2.1532e-03       -22.327020873413
     2.2737e-01     2.2737e+00             1.2132e-03       -22.327059719090

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5851
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -6.888884e-01 3 1  ON 0
ci_002                -7.115054e-01 3 1  ON 1
ci_003                -6.275777e-02 3 1  ON 2
ci_004                -6.406568e-02 3 1  ON 3
ci_005                 4.551897e-02 3 1  ON 4
ci_006                 4.574053e-02 3 1  ON 5
ci_007                 3.229502e-02 3 1  ON 6
ci_008                 3.326105e-02 3 1  ON 7
ci_009                -2.519486e-02 3 1  ON 8
ci_010                -2.565833e-02 3 1  ON 9
ci_011                -2.167996e-02 3 1  ON 10
ci_012                -2.316192e-02 3 1  ON 11
ci_013                 2.021505e-02 3 1  ON 12
ci_014                 2.100706e-02 3 1  ON 13
ci_015                 1.902137e-02 3 1  ON 14
ci_016                 2.009561e-02 3 1  ON 15
ci_017                 1.587628e-02 3 1  ON 16
ci_018                 1.587189e-02 3 1  ON 17
ci_019                 1.076175e-02 3 1  ON 18
ci_020                 9.464335e-03 3 1  ON 19
ci_021                -9.805006e-03 3 1  ON 20
ci_022                -1.168199e-02 3 1  ON 21
ci_023                 8.178116e-03 3 1  ON 22
ci_024                 9.085346e-03 3 1  ON 23
ci_025                 7.685490e-03 3 1  ON 24
ci_026                 8.956002e-03 3 1  ON 25
ci_027                 7.480325e-03 3 1  ON 26
ci_028                 7.311459e-03 3 1  ON 27
ci_029                -6.227444e-03 3 1  ON 28
ci_030                -7.346376e-03 3 1  ON 29
ci_031                -6.918868e-03 3 1  ON 30
ci_032                -8.019847e-03 3 1  ON 31
ci_033                 6.572784e-03 3 1  ON 32
ci_034                 6.079860e-03 3 1  ON 33
ci_035                 7.288168e-03 3 1  ON 34
ci_036                 6.883454e-03 3 1  ON 35
ci_037                 5.637669e-03 3 1  ON 36
ci_038                 6.887168e-03 3 1  ON 37
ci_039                 4.857971e-03 3 1  ON 38
ci_040                 5.779218e-03 3 1  ON 39
ci_041                 5.201857e-03 3 1  ON 40
ci_042                 5.493706e-03 3 1  ON 41
ci_043                 4.845916e-03 3 1  ON 42
ci_044                 6.487540e-03 3 1  ON 43
ci_045                 4.972643e-03 3 1  ON 44
ci_046                 5.238652e-03 3 1  ON 45
ci_047                -4.264234e-03 3 1  ON 46
ci_048                -4.090920e-03 3 1  ON 47
ci_049                 3.724734e-03 3 1  ON 48
ci_050                 3.532473e-03 3 1  ON 49
ci_051                -3.178554e-03 3 1  ON 50
ci_052                -2.863185e-03 3 1  ON 51
ci_053                -1.480938e-03 3 1  ON 52
ci_054                -2.029468e-03 3 1  ON 53
ci_055                -1.607969e-03 3 1  ON 54
ci_056                -1.736006e-03 3 1  ON 55
ci_057                -2.200137e-03 3 1  ON 56
ci_058                -1.725370e-03 3 1  ON 57
ci_059                -2.572980e-03 3 1  ON 58
ci_060                -1.668303e-03 3 1  ON 59
ci_061                -1.987486e-03 3 1  ON 60
ci_062                -1.783413e-03 3 1  ON 61
ci_063                -3.466568e-04 3 1  ON 62
ci_064                -6.711005e-04 3 1  ON 63
ci_065                -2.203897e-03 3 1  ON 64
ci_066                -1.972356e-03 3 1  ON 65
ci_067                 1.034124e-04 3 1  ON 66
ci_068                -8.558189e-04 3 1  ON 67
ci_069                 2.281086e-03 3 1  ON 68
ci_070                 1.600378e-03 3 1  ON 69
ci_071                -1.541797e-03 3 1  ON 70
ci_072                -8.013345e-05 3 1  ON 71
ci_073                 1.372500e-03 3 1  ON 72
ci_074                 1.565523e-03 3 1  ON 73
ci_075                -1.894127e-03 3 1  ON 74
ci_076                -1.240068e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5644e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2308e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.1502
    reference variance = 4.55669
====================================================
  Execution time = 2.4216e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0311e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7401e+00
  Total weights = 1.949618779e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8817e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794365276403
                                         uncertainty =       0.053853639588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794365276403
                                         uncertainty =       0.053853639588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377218925
  error estimate for blocks of size 2^( 2) =       0.001448641734
  error estimate for blocks of size 2^( 3) =       0.001510771342
  error estimate for blocks of size 2^( 4) =       0.001553793421
  error estimate for blocks of size 2^( 5) =       0.001576990826
  error estimate for blocks of size 2^( 6) =       0.001591541940
  error estimate for blocks of size 2^( 7) =       0.001601044026

      target function =                  N/A
              le_mean =     -22.328527845980
             les_mean =     502.303290192342
             stat err =       0.001580842553
             autocorr =       1.317562640724
              std dev =       1.947712844356
             le_variance =       3.793585324067


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232852784598e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e-01, overlap shift 1.4211e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328527845154       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328606018611       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328609075519       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328609292202       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328609691079       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328609594080       residual = 5.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e-01 is 1.568579e-03

solving harmonic davidson linear method for identity shift 5.6843e-01, overlap shift 5.6843e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328527845154       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328562840808       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328563172523       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328563167000       residual = 5.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e-01 is 6.582724e-04

solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328527845154       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328538749433       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328538770178       residual = 9.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+00 is 1.991622e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154758 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0105e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -6.887388e-01 3 1  ON 0
ci_002                -7.116777e-01 3 1  ON 1
ci_003                -6.272677e-02 3 1  ON 2
ci_004                -6.395382e-02 3 1  ON 3
ci_005                 4.543604e-02 3 1  ON 4
ci_006                 4.605220e-02 3 1  ON 5
ci_007                 3.219838e-02 3 1  ON 6
ci_008                 3.312612e-02 3 1  ON 7
ci_009                -2.488391e-02 3 1  ON 8
ci_010                -2.545941e-02 3 1  ON 9
ci_011                -2.165836e-02 3 1  ON 10
ci_012                -2.272292e-02 3 1  ON 11
ci_013                 2.039434e-02 3 1  ON 12
ci_014                 2.124126e-02 3 1  ON 13
ci_015                 1.902875e-02 3 1  ON 14
ci_016                 2.012481e-02 3 1  ON 15
ci_017                 1.586140e-02 3 1  ON 16
ci_018                 1.588978e-02 3 1  ON 17
ci_019                 1.015813e-02 3 1  ON 18
ci_020                 9.401360e-03 3 1  ON 19
ci_021                -1.010138e-02 3 1  ON 20
ci_022                -1.131951e-02 3 1  ON 21
ci_023                 8.429560e-03 3 1  ON 22
ci_024                 9.312667e-03 3 1  ON 23
ci_025                 7.517676e-03 3 1  ON 24
ci_026                 8.806395e-03 3 1  ON 25
ci_027                 7.977511e-03 3 1  ON 26
ci_028                 7.731906e-03 3 1  ON 27
ci_029                -6.609630e-03 3 1  ON 28
ci_030                -7.600032e-03 3 1  ON 29
ci_031                -7.577140e-03 3 1  ON 30
ci_032                -7.603665e-03 3 1  ON 31
ci_033                 7.059798e-03 3 1  ON 32
ci_034                 6.013663e-03 3 1  ON 33
ci_035                 6.926084e-03 3 1  ON 34
ci_036                 6.868027e-03 3 1  ON 35
ci_037                 5.951383e-03 3 1  ON 36
ci_038                 6.519193e-03 3 1  ON 37
ci_039                 5.151579e-03 3 1  ON 38
ci_040                 5.699511e-03 3 1  ON 39
ci_041                 5.149686e-03 3 1  ON 40
ci_042                 5.420403e-03 3 1  ON 41
ci_043                 5.003117e-03 3 1  ON 42
ci_044                 6.358686e-03 3 1  ON 43
ci_045                 5.265735e-03 3 1  ON 44
ci_046                 4.978846e-03 3 1  ON 45
ci_047                -4.165255e-03 3 1  ON 46
ci_048                -3.982540e-03 3 1  ON 47
ci_049                 3.861393e-03 3 1  ON 48
ci_050                 3.280637e-03 3 1  ON 49
ci_051                -3.045707e-03 3 1  ON 50
ci_052                -3.114552e-03 3 1  ON 51
ci_053                -1.685153e-03 3 1  ON 52
ci_054                -2.265686e-03 3 1  ON 53
ci_055                -1.273360e-03 3 1  ON 54
ci_056                -1.920452e-03 3 1  ON 55
ci_057                -1.922655e-03 3 1  ON 56
ci_058                -2.049303e-03 3 1  ON 57
ci_059                -2.326943e-03 3 1  ON 58
ci_060                -1.600284e-03 3 1  ON 59
ci_061                -2.220123e-03 3 1  ON 60
ci_062                -1.897964e-03 3 1  ON 61
ci_063                -4.653282e-04 3 1  ON 62
ci_064                -5.875197e-04 3 1  ON 63
ci_065                -1.912517e-03 3 1  ON 64
ci_066                -1.930547e-03 3 1  ON 65
ci_067                -1.902372e-04 3 1  ON 66
ci_068                -1.213549e-03 3 1  ON 67
ci_069                 1.964377e-03 3 1  ON 68
ci_070                 1.511441e-03 3 1  ON 69
ci_071                -1.367204e-03 3 1  ON 70
ci_072                -1.695637e-04 3 1  ON 71
ci_073                 1.051286e-03 3 1  ON 72
ci_074                 1.562663e-03 3 1  ON 73
ci_075                -1.281255e-03 3 1  ON 74
ci_076                -1.043866e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.5281
    reference variance = 2.54718
====================================================
  Execution time = 2.3571e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7405e+00
  Total weights = 1.9499e+06
  Execution time = 4.3588e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794784717036
                                         uncertainty =       0.038602366616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794784717036
                                         uncertainty =       0.038602366616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377291819
  error estimate for blocks of size 2^( 2) =       0.001446192322
  error estimate for blocks of size 2^( 3) =       0.001510224772
  error estimate for blocks of size 2^( 4) =       0.001551274939
  error estimate for blocks of size 2^( 5) =       0.001573580358
  error estimate for blocks of size 2^( 6) =       0.001587258610
  error estimate for blocks of size 2^( 7) =       0.001594136144

      target function =                  N/A
              le_mean =     -22.327789930599
             les_mean =     502.274781443834
             stat err =       0.001576562513
             autocorr =       1.310299140452
              std dev =       1.947815933434
             le_variance =       3.793986910541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794723475461
                                         uncertainty =       0.038606415080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794723475461
                                         uncertainty =       0.038606415080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377280574
  error estimate for blocks of size 2^( 2) =       0.001446183061
  error estimate for blocks of size 2^( 3) =       0.001510219970
  error estimate for blocks of size 2^( 4) =       0.001551281281
  error estimate for blocks of size 2^( 5) =       0.001573564807
  error estimate for blocks of size 2^( 6) =       0.001587247775
  error estimate for blocks of size 2^( 7) =       0.001594137587

      target function =                  N/A
              le_mean =     -22.327781757665
             les_mean =     502.277840300065
             stat err =       0.001576557863
             autocorr =       1.310312805517
              std dev =       1.947800031576
             le_variance =       3.793924963008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794694297874
                                         uncertainty =       0.038606041733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794694297874
                                         uncertainty =       0.038606041733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377275315
  error estimate for blocks of size 2^( 2) =       0.001446177146
  error estimate for blocks of size 2^( 3) =       0.001510204937
  error estimate for blocks of size 2^( 4) =       0.001551264875
  error estimate for blocks of size 2^( 5) =       0.001573555522
  error estimate for blocks of size 2^( 6) =       0.001587256251
  error estimate for blocks of size 2^( 7) =       0.001594154696

      target function =                  N/A
              le_mean =     -22.327783265908
             les_mean =     502.272737686405
             stat err =       0.001576557836
             autocorr =       1.310322769326
              std dev =       1.947792592957
             le_variance =       3.793895985180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794742111304
                                         uncertainty =       0.038603047764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.794742111304
                                         uncertainty =       0.038603047764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377284076
  error estimate for blocks of size 2^( 2) =       0.001446185915
  error estimate for blocks of size 2^( 3) =       0.001510217676
  error estimate for blocks of size 2^( 4) =       0.001551271371
  error estimate for blocks of size 2^( 5) =       0.001573575157
  error estimate for blocks of size 2^( 6) =       0.001587260132
  error estimate for blocks of size 2^( 7) =       0.001594139148

      target function =                  N/A
              le_mean =     -22.327783278245
             les_mean =     502.271229640671
             stat err =       0.001576561452
             autocorr =       1.310312109718
              std dev =       1.947804983532
             le_variance =       3.793944253871


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327789930599        initial  <--
     1.4211e-01     1.4211e+00             1.5686e-03       -22.327781757665
     5.6843e-01     5.6843e+00             6.5827e-04       -22.327783265908
     2.2737e+00     2.2737e+01             1.9916e-04       -22.327783278245

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.2906
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -6.888884e-01 3 1  ON 0
ci_002                -7.115054e-01 3 1  ON 1
ci_003                -6.275777e-02 3 1  ON 2
ci_004                -6.406568e-02 3 1  ON 3
ci_005                 4.551897e-02 3 1  ON 4
ci_006                 4.574053e-02 3 1  ON 5
ci_007                 3.229502e-02 3 1  ON 6
ci_008                 3.326105e-02 3 1  ON 7
ci_009                -2.519486e-02 3 1  ON 8
ci_010                -2.565833e-02 3 1  ON 9
ci_011                -2.167996e-02 3 1  ON 10
ci_012                -2.316192e-02 3 1  ON 11
ci_013                 2.021505e-02 3 1  ON 12
ci_014                 2.100706e-02 3 1  ON 13
ci_015                 1.902137e-02 3 1  ON 14
ci_016                 2.009561e-02 3 1  ON 15
ci_017                 1.587628e-02 3 1  ON 16
ci_018                 1.587189e-02 3 1  ON 17
ci_019                 1.076175e-02 3 1  ON 18
ci_020                 9.464335e-03 3 1  ON 19
ci_021                -9.805006e-03 3 1  ON 20
ci_022                -1.168199e-02 3 1  ON 21
ci_023                 8.178116e-03 3 1  ON 22
ci_024                 9.085346e-03 3 1  ON 23
ci_025                 7.685490e-03 3 1  ON 24
ci_026                 8.956002e-03 3 1  ON 25
ci_027                 7.480325e-03 3 1  ON 26
ci_028                 7.311459e-03 3 1  ON 27
ci_029                -6.227444e-03 3 1  ON 28
ci_030                -7.346376e-03 3 1  ON 29
ci_031                -6.918868e-03 3 1  ON 30
ci_032                -8.019847e-03 3 1  ON 31
ci_033                 6.572784e-03 3 1  ON 32
ci_034                 6.079860e-03 3 1  ON 33
ci_035                 7.288168e-03 3 1  ON 34
ci_036                 6.883454e-03 3 1  ON 35
ci_037                 5.637669e-03 3 1  ON 36
ci_038                 6.887168e-03 3 1  ON 37
ci_039                 4.857971e-03 3 1  ON 38
ci_040                 5.779218e-03 3 1  ON 39
ci_041                 5.201857e-03 3 1  ON 40
ci_042                 5.493706e-03 3 1  ON 41
ci_043                 4.845916e-03 3 1  ON 42
ci_044                 6.487540e-03 3 1  ON 43
ci_045                 4.972643e-03 3 1  ON 44
ci_046                 5.238652e-03 3 1  ON 45
ci_047                -4.264234e-03 3 1  ON 46
ci_048                -4.090920e-03 3 1  ON 47
ci_049                 3.724734e-03 3 1  ON 48
ci_050                 3.532473e-03 3 1  ON 49
ci_051                -3.178554e-03 3 1  ON 50
ci_052                -2.863185e-03 3 1  ON 51
ci_053                -1.480938e-03 3 1  ON 52
ci_054                -2.029468e-03 3 1  ON 53
ci_055                -1.607969e-03 3 1  ON 54
ci_056                -1.736006e-03 3 1  ON 55
ci_057                -2.200137e-03 3 1  ON 56
ci_058                -1.725370e-03 3 1  ON 57
ci_059                -2.572980e-03 3 1  ON 58
ci_060                -1.668303e-03 3 1  ON 59
ci_061                -1.987486e-03 3 1  ON 60
ci_062                -1.783413e-03 3 1  ON 61
ci_063                -3.466568e-04 3 1  ON 62
ci_064                -6.711005e-04 3 1  ON 63
ci_065                -2.203897e-03 3 1  ON 64
ci_066                -1.972356e-03 3 1  ON 65
ci_067                 1.034124e-04 3 1  ON 66
ci_068                -8.558189e-04 3 1  ON 67
ci_069                 2.281086e-03 3 1  ON 68
ci_070                 1.600378e-03 3 1  ON 69
ci_071                -1.541797e-03 3 1  ON 70
ci_072                -8.013345e-05 3 1  ON 71
ci_073                 1.372500e-03 3 1  ON 72
ci_074                 1.565523e-03 3 1  ON 73
ci_075                -1.894127e-03 3 1  ON 74
ci_076                -1.240068e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8404e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2309e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.4861
    reference variance = 2.77461
====================================================
  Execution time = 2.4687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0325e+04
  VMC Eavg = -2.2332e+01
  VMC Evar = 3.6417e+00
  Total weights = 1.950285528e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9317e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.692355274330
                                         uncertainty =       0.027024399990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.692355274330
                                         uncertainty =       0.027024399990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001358677877
  error estimate for blocks of size 2^( 2) =       0.001430176390
  error estimate for blocks of size 2^( 3) =       0.001493574753
  error estimate for blocks of size 2^( 4) =       0.001537194067
  error estimate for blocks of size 2^( 5) =       0.001562990790
  error estimate for blocks of size 2^( 6) =       0.001572515297
  error estimate for blocks of size 2^( 7) =       0.001580069656

      target function =                  N/A
              le_mean =     -22.331939892602
             les_mean =     502.357257837750
             stat err =       0.001563192453
             autocorr =       1.323707078167
              std dev =       1.921491423897
             le_variance =       3.692129292109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233193989260e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331939891776       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331954985765       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331955178351       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+00 is 3.691213e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331939891776       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331944045655       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331944067464       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+00 is 1.011661e-04

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331939891776       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331940957093       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331940960734       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+01 is 2.592286e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155944 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0625e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -6.888998e-01 3 1  ON 0
ci_002                -7.115066e-01 3 1  ON 1
ci_003                -6.274441e-02 3 1  ON 2
ci_004                -6.402046e-02 3 1  ON 3
ci_005                 4.553251e-02 3 1  ON 4
ci_006                 4.570662e-02 3 1  ON 5
ci_007                 3.223863e-02 3 1  ON 6
ci_008                 3.322802e-02 3 1  ON 7
ci_009                -2.519833e-02 3 1  ON 8
ci_010                -2.560342e-02 3 1  ON 9
ci_011                -2.167846e-02 3 1  ON 10
ci_012                -2.312623e-02 3 1  ON 11
ci_013                 2.019963e-02 3 1  ON 12
ci_014                 2.101884e-02 3 1  ON 13
ci_015                 1.904087e-02 3 1  ON 14
ci_016                 2.008031e-02 3 1  ON 15
ci_017                 1.587368e-02 3 1  ON 16
ci_018                 1.588406e-02 3 1  ON 17
ci_019                 1.075845e-02 3 1  ON 18
ci_020                 9.453964e-03 3 1  ON 19
ci_021                -9.771226e-03 3 1  ON 20
ci_022                -1.170620e-02 3 1  ON 21
ci_023                 8.199327e-03 3 1  ON 22
ci_024                 9.097360e-03 3 1  ON 23
ci_025                 7.711774e-03 3 1  ON 24
ci_026                 8.946548e-03 3 1  ON 25
ci_027                 7.515963e-03 3 1  ON 26
ci_028                 7.317709e-03 3 1  ON 27
ci_029                -6.224726e-03 3 1  ON 28
ci_030                -7.315343e-03 3 1  ON 29
ci_031                -6.944519e-03 3 1  ON 30
ci_032                -8.016506e-03 3 1  ON 31
ci_033                 6.556274e-03 3 1  ON 32
ci_034                 6.120724e-03 3 1  ON 33
ci_035                 7.254579e-03 3 1  ON 34
ci_036                 6.935382e-03 3 1  ON 35
ci_037                 5.620570e-03 3 1  ON 36
ci_038                 6.890681e-03 3 1  ON 37
ci_039                 4.908051e-03 3 1  ON 38
ci_040                 5.818431e-03 3 1  ON 39
ci_041                 5.251537e-03 3 1  ON 40
ci_042                 5.484121e-03 3 1  ON 41
ci_043                 4.856744e-03 3 1  ON 42
ci_044                 6.386374e-03 3 1  ON 43
ci_045                 4.963638e-03 3 1  ON 44
ci_046                 5.259052e-03 3 1  ON 45
ci_047                -4.281915e-03 3 1  ON 46
ci_048                -4.120702e-03 3 1  ON 47
ci_049                 3.722291e-03 3 1  ON 48
ci_050                 3.583073e-03 3 1  ON 49
ci_051                -3.184561e-03 3 1  ON 50
ci_052                -2.872277e-03 3 1  ON 51
ci_053                -1.564070e-03 3 1  ON 52
ci_054                -2.057554e-03 3 1  ON 53
ci_055                -1.604993e-03 3 1  ON 54
ci_056                -1.763551e-03 3 1  ON 55
ci_057                -2.222015e-03 3 1  ON 56
ci_058                -1.720139e-03 3 1  ON 57
ci_059                -2.537530e-03 3 1  ON 58
ci_060                -1.659659e-03 3 1  ON 59
ci_061                -1.945194e-03 3 1  ON 60
ci_062                -1.801897e-03 3 1  ON 61
ci_063                -4.093093e-04 3 1  ON 62
ci_064                -6.797995e-04 3 1  ON 63
ci_065                -2.169441e-03 3 1  ON 64
ci_066                -1.928365e-03 3 1  ON 65
ci_067                 7.853999e-05 3 1  ON 66
ci_068                -8.506366e-04 3 1  ON 67
ci_069                 2.239736e-03 3 1  ON 68
ci_070                 1.596319e-03 3 1  ON 69
ci_071                -1.473426e-03 3 1  ON 70
ci_072                -1.259519e-04 3 1  ON 71
ci_073                 1.364577e-03 3 1  ON 72
ci_074                 1.581379e-03 3 1  ON 73
ci_075                -1.890063e-03 3 1  ON 74
ci_076                -1.232079e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.1263
    reference variance = 6.26558
====================================================
  Execution time = 2.3624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7601e+00
  Total weights = 1.9498e+06
  Execution time = 4.3822e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812523315154
                                         uncertainty =       0.048927823680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812523315154
                                         uncertainty =       0.048927823680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380617494
  error estimate for blocks of size 2^( 2) =       0.001450799905
  error estimate for blocks of size 2^( 3) =       0.001514406491
  error estimate for blocks of size 2^( 4) =       0.001557752642
  error estimate for blocks of size 2^( 5) =       0.001582929219
  error estimate for blocks of size 2^( 6) =       0.001601845671
  error estimate for blocks of size 2^( 7) =       0.001608661855

      target function =                  N/A
              le_mean =     -22.328264964419
             les_mean =     502.311553220576
             stat err =       0.001587797347
             autocorr =       1.322645319757
              std dev =       1.952519223987
             le_variance =       3.812331320039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812459939803
                                         uncertainty =       0.048928100491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812459939803
                                         uncertainty =       0.048928100491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380605994
  error estimate for blocks of size 2^( 2) =       0.001450794001
  error estimate for blocks of size 2^( 3) =       0.001514406635
  error estimate for blocks of size 2^( 4) =       0.001557756719
  error estimate for blocks of size 2^( 5) =       0.001582943034
  error estimate for blocks of size 2^( 6) =       0.001601869201
  error estimate for blocks of size 2^( 7) =       0.001608692253

      target function =                  N/A
              le_mean =     -22.328263320539
             les_mean =     502.315844465985
             stat err =       0.001587815302
             autocorr =       1.322697269283
              std dev =       1.952502959930
             le_variance =       3.812267808536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812486313279
                                         uncertainty =       0.048927955069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812486313279
                                         uncertainty =       0.048927955069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380610782
  error estimate for blocks of size 2^( 2) =       0.001450796182
  error estimate for blocks of size 2^( 3) =       0.001514405690
  error estimate for blocks of size 2^( 4) =       0.001557754106
  error estimate for blocks of size 2^( 5) =       0.001582935802
  error estimate for blocks of size 2^( 6) =       0.001601857714
  error estimate for blocks of size 2^( 7) =       0.001608677476

      target function =                  N/A
              le_mean =     -22.328263929234
             les_mean =     502.311447040418
             stat err =       0.001587806275
             autocorr =       1.322673053846
              std dev =       1.952509732143
             le_variance =       3.812294254113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812518220614
                                         uncertainty =       0.048927837865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812518220614
                                         uncertainty =       0.048927837865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380616570
  error estimate for blocks of size 2^( 2) =       0.001450799371
  error estimate for blocks of size 2^( 3) =       0.001514406338
  error estimate for blocks of size 2^( 4) =       0.001557752770
  error estimate for blocks of size 2^( 5) =       0.001582930007
  error estimate for blocks of size 2^( 6) =       0.001601847184
  error estimate for blocks of size 2^( 7) =       0.001608663799

      target function =                  N/A
              le_mean =     -22.328264766067
             les_mean =     502.311518601754
             stat err =       0.001587798440
             autocorr =       1.322648911756
              std dev =       1.952517917400
             le_variance =       3.812326217767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328264964419        initial  <--
     1.4211e+00     1.4211e+01             3.6912e-04       -22.328263320539
     5.6843e+00     5.6843e+01             1.0117e-04       -22.328263929234
     2.2737e+01     2.2737e+02             2.5923e-05       -22.328264766067

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6106
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -6.888884e-01 3 1  ON 0
ci_002                -7.115054e-01 3 1  ON 1
ci_003                -6.275777e-02 3 1  ON 2
ci_004                -6.406568e-02 3 1  ON 3
ci_005                 4.551897e-02 3 1  ON 4
ci_006                 4.574053e-02 3 1  ON 5
ci_007                 3.229502e-02 3 1  ON 6
ci_008                 3.326105e-02 3 1  ON 7
ci_009                -2.519486e-02 3 1  ON 8
ci_010                -2.565833e-02 3 1  ON 9
ci_011                -2.167996e-02 3 1  ON 10
ci_012                -2.316192e-02 3 1  ON 11
ci_013                 2.021505e-02 3 1  ON 12
ci_014                 2.100706e-02 3 1  ON 13
ci_015                 1.902137e-02 3 1  ON 14
ci_016                 2.009561e-02 3 1  ON 15
ci_017                 1.587628e-02 3 1  ON 16
ci_018                 1.587189e-02 3 1  ON 17
ci_019                 1.076175e-02 3 1  ON 18
ci_020                 9.464335e-03 3 1  ON 19
ci_021                -9.805006e-03 3 1  ON 20
ci_022                -1.168199e-02 3 1  ON 21
ci_023                 8.178116e-03 3 1  ON 22
ci_024                 9.085346e-03 3 1  ON 23
ci_025                 7.685490e-03 3 1  ON 24
ci_026                 8.956002e-03 3 1  ON 25
ci_027                 7.480325e-03 3 1  ON 26
ci_028                 7.311459e-03 3 1  ON 27
ci_029                -6.227444e-03 3 1  ON 28
ci_030                -7.346376e-03 3 1  ON 29
ci_031                -6.918868e-03 3 1  ON 30
ci_032                -8.019847e-03 3 1  ON 31
ci_033                 6.572784e-03 3 1  ON 32
ci_034                 6.079860e-03 3 1  ON 33
ci_035                 7.288168e-03 3 1  ON 34
ci_036                 6.883454e-03 3 1  ON 35
ci_037                 5.637669e-03 3 1  ON 36
ci_038                 6.887168e-03 3 1  ON 37
ci_039                 4.857971e-03 3 1  ON 38
ci_040                 5.779218e-03 3 1  ON 39
ci_041                 5.201857e-03 3 1  ON 40
ci_042                 5.493706e-03 3 1  ON 41
ci_043                 4.845916e-03 3 1  ON 42
ci_044                 6.487540e-03 3 1  ON 43
ci_045                 4.972643e-03 3 1  ON 44
ci_046                 5.238652e-03 3 1  ON 45
ci_047                -4.264234e-03 3 1  ON 46
ci_048                -4.090920e-03 3 1  ON 47
ci_049                 3.724734e-03 3 1  ON 48
ci_050                 3.532473e-03 3 1  ON 49
ci_051                -3.178554e-03 3 1  ON 50
ci_052                -2.863185e-03 3 1  ON 51
ci_053                -1.480938e-03 3 1  ON 52
ci_054                -2.029468e-03 3 1  ON 53
ci_055                -1.607969e-03 3 1  ON 54
ci_056                -1.736006e-03 3 1  ON 55
ci_057                -2.200137e-03 3 1  ON 56
ci_058                -1.725370e-03 3 1  ON 57
ci_059                -2.572980e-03 3 1  ON 58
ci_060                -1.668303e-03 3 1  ON 59
ci_061                -1.987486e-03 3 1  ON 60
ci_062                -1.783413e-03 3 1  ON 61
ci_063                -3.466568e-04 3 1  ON 62
ci_064                -6.711005e-04 3 1  ON 63
ci_065                -2.203897e-03 3 1  ON 64
ci_066                -1.972356e-03 3 1  ON 65
ci_067                 1.034124e-04 3 1  ON 66
ci_068                -8.558189e-04 3 1  ON 67
ci_069                 2.281086e-03 3 1  ON 68
ci_070                 1.600378e-03 3 1  ON 69
ci_071                -1.541797e-03 3 1  ON 70
ci_072                -8.013345e-05 3 1  ON 71
ci_073                 1.372500e-03 3 1  ON 72
ci_074                 1.565523e-03 3 1  ON 73
ci_075                -1.894127e-03 3 1  ON 74
ci_076                -1.240068e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6246e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2309e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -21.9715
    reference variance = 3.40878
====================================================
  Execution time = 2.4132e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0314e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7018e+00
  Total weights = 1.950048677e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9815e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751666292390
                                         uncertainty =       0.040292646825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751666292390
                                         uncertainty =       0.040292646825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369889876
  error estimate for blocks of size 2^( 2) =       0.001439738767
  error estimate for blocks of size 2^( 3) =       0.001501604670
  error estimate for blocks of size 2^( 4) =       0.001543619099
  error estimate for blocks of size 2^( 5) =       0.001567480582
  error estimate for blocks of size 2^( 6) =       0.001581503336
  error estimate for blocks of size 2^( 7) =       0.001587372516

      target function =                  N/A
              le_mean =     -22.326861906745
             les_mean =     502.190514349682
             stat err =       0.001569993883
             autocorr =       1.313483460913
              std dev =       1.937347838435
             le_variance =       3.753316647089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232686190675e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326861905929       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326863778443       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326863781015       residual = 1.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+01 is 2.946492e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326861905929       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326862378774       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326862379661       residual = 1.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+01 is 7.430149e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326861905929       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326862024439       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326862024676       residual = 1.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+02 is 1.861580e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0120e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -6.888879e-01 3 1  ON 0
ci_002                -7.115056e-01 3 1  ON 1
ci_003                -6.275904e-02 3 1  ON 2
ci_004                -6.406472e-02 3 1  ON 3
ci_005                 4.551612e-02 3 1  ON 4
ci_006                 4.574659e-02 3 1  ON 5
ci_007                 3.229589e-02 3 1  ON 6
ci_008                 3.325659e-02 3 1  ON 7
ci_009                -2.519258e-02 3 1  ON 8
ci_010                -2.565404e-02 3 1  ON 9
ci_011                -2.168430e-02 3 1  ON 10
ci_012                -2.316106e-02 3 1  ON 11
ci_013                 2.021875e-02 3 1  ON 12
ci_014                 2.100673e-02 3 1  ON 13
ci_015                 1.902657e-02 3 1  ON 14
ci_016                 2.009779e-02 3 1  ON 15
ci_017                 1.587666e-02 3 1  ON 16
ci_018                 1.587003e-02 3 1  ON 17
ci_019                 1.076326e-02 3 1  ON 18
ci_020                 9.459784e-03 3 1  ON 19
ci_021                -9.803139e-03 3 1  ON 20
ci_022                -1.167856e-02 3 1  ON 21
ci_023                 8.178963e-03 3 1  ON 22
ci_024                 9.086342e-03 3 1  ON 23
ci_025                 7.681387e-03 3 1  ON 24
ci_026                 8.960703e-03 3 1  ON 25
ci_027                 7.484882e-03 3 1  ON 26
ci_028                 7.316738e-03 3 1  ON 27
ci_029                -6.234875e-03 3 1  ON 28
ci_030                -7.347558e-03 3 1  ON 29
ci_031                -6.919172e-03 3 1  ON 30
ci_032                -8.017151e-03 3 1  ON 31
ci_033                 6.572023e-03 3 1  ON 32
ci_034                 6.082930e-03 3 1  ON 33
ci_035                 7.287396e-03 3 1  ON 34
ci_036                 6.883009e-03 3 1  ON 35
ci_037                 5.640647e-03 3 1  ON 36
ci_038                 6.884448e-03 3 1  ON 37
ci_039                 4.857713e-03 3 1  ON 38
ci_040                 5.777082e-03 3 1  ON 39
ci_041                 5.202069e-03 3 1  ON 40
ci_042                 5.490069e-03 3 1  ON 41
ci_043                 4.844418e-03 3 1  ON 42
ci_044                 6.482939e-03 3 1  ON 43
ci_045                 4.972355e-03 3 1  ON 44
ci_046                 5.243665e-03 3 1  ON 45
ci_047                -4.261216e-03 3 1  ON 46
ci_048                -4.094778e-03 3 1  ON 47
ci_049                 3.720409e-03 3 1  ON 48
ci_050                 3.532711e-03 3 1  ON 49
ci_051                -3.178095e-03 3 1  ON 50
ci_052                -2.864158e-03 3 1  ON 51
ci_053                -1.481471e-03 3 1  ON 52
ci_054                -2.031794e-03 3 1  ON 53
ci_055                -1.609658e-03 3 1  ON 54
ci_056                -1.738389e-03 3 1  ON 55
ci_057                -2.201125e-03 3 1  ON 56
ci_058                -1.730195e-03 3 1  ON 57
ci_059                -2.576383e-03 3 1  ON 58
ci_060                -1.669613e-03 3 1  ON 59
ci_061                -1.989636e-03 3 1  ON 60
ci_062                -1.786024e-03 3 1  ON 61
ci_063                -3.523245e-04 3 1  ON 62
ci_064                -6.759621e-04 3 1  ON 63
ci_065                -2.201191e-03 3 1  ON 64
ci_066                -1.969418e-03 3 1  ON 65
ci_067                 9.784463e-05 3 1  ON 66
ci_068                -8.600346e-04 3 1  ON 67
ci_069                 2.280478e-03 3 1  ON 68
ci_070                 1.599704e-03 3 1  ON 69
ci_071                -1.541358e-03 3 1  ON 70
ci_072                -8.370715e-05 3 1  ON 71
ci_073                 1.369443e-03 3 1  ON 72
ci_074                 1.568607e-03 3 1  ON 73
ci_075                -1.887883e-03 3 1  ON 74
ci_076                -1.241048e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.2642
    reference variance = 2.95145
====================================================
  Execution time = 2.3554e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.8902e+00
  Total weights = 1.9502e+06
  Execution time = 4.3535e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.946275169734
                                         uncertainty =       0.119177420369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.946275169734
                                         uncertainty =       0.119177420369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001404648823
  error estimate for blocks of size 2^( 2) =       0.001473249454
  error estimate for blocks of size 2^( 3) =       0.001536061833
  error estimate for blocks of size 2^( 4) =       0.001577345922
  error estimate for blocks of size 2^( 5) =       0.001604460936
  error estimate for blocks of size 2^( 6) =       0.001617241969
  error estimate for blocks of size 2^( 7) =       0.001614270801

      target function =                  N/A
              le_mean =     -22.330024202054
             les_mean =     502.520194731572
             stat err =       0.001603329907
             autocorr =       1.302897550552
              std dev =       1.986505199740
             le_variance =       3.946202908594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.946275110344
                                         uncertainty =       0.119177224328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.946275110344
                                         uncertainty =       0.119177224328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001404648816
  error estimate for blocks of size 2^( 2) =       0.001473248968
  error estimate for blocks of size 2^( 3) =       0.001536061139
  error estimate for blocks of size 2^( 4) =       0.001577345081
  error estimate for blocks of size 2^( 5) =       0.001604459802
  error estimate for blocks of size 2^( 6) =       0.001617240482
  error estimate for blocks of size 2^( 7) =       0.001614269685

      target function =                  N/A
              le_mean =     -22.330024193526
             les_mean =     502.520182271038
             stat err =       0.001603328763
             autocorr =       1.302895704553
              std dev =       1.986505189498
             le_variance =       3.946202867901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.946275125324
                                         uncertainty =       0.119177321684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.946275125324
                                         uncertainty =       0.119177321684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001404648817
  error estimate for blocks of size 2^( 2) =       0.001473249205
  error estimate for blocks of size 2^( 3) =       0.001536061479
  error estimate for blocks of size 2^( 4) =       0.001577345496
  error estimate for blocks of size 2^( 5) =       0.001604460364
  error estimate for blocks of size 2^( 6) =       0.001617241232
  error estimate for blocks of size 2^( 7) =       0.001614270254

      target function =                  N/A
              le_mean =     -22.330024193929
             les_mean =     502.520172945018
             stat err =       0.001603329337
             autocorr =       1.302896635055
              std dev =       1.986505190945
             le_variance =       3.946202873653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.946275163450
                                         uncertainty =       0.119177408279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.946275163450
                                         uncertainty =       0.119177408279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001404648822
  error estimate for blocks of size 2^( 2) =       0.001473249428
  error estimate for blocks of size 2^( 3) =       0.001536061808
  error estimate for blocks of size 2^( 4) =       0.001577345902
  error estimate for blocks of size 2^( 5) =       0.001604460887
  error estimate for blocks of size 2^( 6) =       0.001617241803
  error estimate for blocks of size 2^( 7) =       0.001614270675

      target function =                  N/A
              le_mean =     -22.330024227311
             les_mean =     502.526147563429
             stat err =       0.001603329817
             autocorr =       1.302897405889
              std dev =       1.986505198455
             le_variance =       3.946202903488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330024202054        initial
     1.4211e+01     1.4211e+02             2.9465e-05       -22.330024193526
     5.6843e+01     5.6843e+02             7.4301e-06       -22.330024193929
     2.2737e+02     2.2737e+03             1.8616e-06       -22.330024227311  <--

*****************************************************************************
Applying the update for shift_i =   2.2737e+02     and shift_s =   2.2737e+03
*****************************************************************************

  Execution time = 4.5416e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -6.888883e-01 3 1  ON 0
ci_002                -7.115054e-01 3 1  ON 1
ci_003                -6.275809e-02 3 1  ON 2
ci_004                -6.406544e-02 3 1  ON 3
ci_005                 4.551825e-02 3 1  ON 4
ci_006                 4.574205e-02 3 1  ON 5
ci_007                 3.229524e-02 3 1  ON 6
ci_008                 3.325993e-02 3 1  ON 7
ci_009                -2.519429e-02 3 1  ON 8
ci_010                -2.565725e-02 3 1  ON 9
ci_011                -2.168105e-02 3 1  ON 10
ci_012                -2.316171e-02 3 1  ON 11
ci_013                 2.021598e-02 3 1  ON 12
ci_014                 2.100698e-02 3 1  ON 13
ci_015                 1.902267e-02 3 1  ON 14
ci_016                 2.009616e-02 3 1  ON 15
ci_017                 1.587638e-02 3 1  ON 16
ci_018                 1.587143e-02 3 1  ON 17
ci_019                 1.076213e-02 3 1  ON 18
ci_020                 9.463196e-03 3 1  ON 19
ci_021                -9.804539e-03 3 1  ON 20
ci_022                -1.168113e-02 3 1  ON 21
ci_023                 8.178328e-03 3 1  ON 22
ci_024                 9.085596e-03 3 1  ON 23
ci_025                 7.684463e-03 3 1  ON 24
ci_026                 8.957179e-03 3 1  ON 25
ci_027                 7.481469e-03 3 1  ON 26
ci_028                 7.312784e-03 3 1  ON 27
ci_029                -6.229306e-03 3 1  ON 28
ci_030                -7.346672e-03 3 1  ON 29
ci_031                -6.918944e-03 3 1  ON 30
ci_032                -8.019171e-03 3 1  ON 31
ci_033                 6.572593e-03 3 1  ON 32
ci_034                 6.080629e-03 3 1  ON 33
ci_035                 7.287974e-03 3 1  ON 34
ci_036                 6.883343e-03 3 1  ON 35
ci_037                 5.638416e-03 3 1  ON 36
ci_038                 6.886486e-03 3 1  ON 37
ci_039                 4.857906e-03 3 1  ON 38
ci_040                 5.778683e-03 3 1  ON 39
ci_041                 5.201910e-03 3 1  ON 40
ci_042                 5.492794e-03 3 1  ON 41
ci_043                 4.845541e-03 3 1  ON 42
ci_044                 6.486386e-03 3 1  ON 43
ci_045                 4.972571e-03 3 1  ON 44
ci_046                 5.239908e-03 3 1  ON 45
ci_047                -4.263477e-03 3 1  ON 46
ci_048                -4.091889e-03 3 1  ON 47
ci_049                 3.723650e-03 3 1  ON 48
ci_050                 3.532533e-03 3 1  ON 49
ci_051                -3.178439e-03 3 1  ON 50
ci_052                -2.863430e-03 3 1  ON 51
ci_053                -1.481072e-03 3 1  ON 52
ci_054                -2.030051e-03 3 1  ON 53
ci_055                -1.608392e-03 3 1  ON 54
ci_056                -1.736604e-03 3 1  ON 55
ci_057                -2.200384e-03 3 1  ON 56
ci_058                -1.726580e-03 3 1  ON 57
ci_059                -2.573834e-03 3 1  ON 58
ci_060                -1.668632e-03 3 1  ON 59
ci_061                -1.988025e-03 3 1  ON 60
ci_062                -1.784068e-03 3 1  ON 61
ci_063                -3.480773e-04 3 1  ON 62
ci_064                -6.723183e-04 3 1  ON 63
ci_065                -2.203220e-03 3 1  ON 64
ci_066                -1.971620e-03 3 1  ON 65
ci_067                 1.020177e-04 3 1  ON 66
ci_068                -8.568751e-04 3 1  ON 67
ci_069                 2.280934e-03 3 1  ON 68
ci_070                 1.600209e-03 3 1  ON 69
ci_071                -1.541687e-03 3 1  ON 70
ci_072                -8.102922e-05 3 1  ON 71
ci_073                 1.371732e-03 3 1  ON 72
ci_074                 1.566298e-03 3 1  ON 73
ci_075                -1.892562e-03 3 1  ON 74
ci_076                -1.240314e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5545e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2305e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.4725
    reference variance = 3.06371
====================================================
  Execution time = 2.4077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0345e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6838e+00
  Total weights = 1.950219889e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9172e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734121630806
                                         uncertainty =       0.035203386071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734121630806
                                         uncertainty =       0.035203386071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366304652
  error estimate for blocks of size 2^( 2) =       0.001438769197
  error estimate for blocks of size 2^( 3) =       0.001499941374
  error estimate for blocks of size 2^( 4) =       0.001542053305
  error estimate for blocks of size 2^( 5) =       0.001566197404
  error estimate for blocks of size 2^( 6) =       0.001582842649
  error estimate for blocks of size 2^( 7) =       0.001581028438

      target function =                  N/A
              le_mean =     -22.329976952719
             les_mean =     502.311686810012
             stat err =       0.001568030449
             autocorr =       1.317085260643
              std dev =       1.932277484862
             le_variance =       3.733696278505


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232997695272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329976951881       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329977280449       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329977279949       residual = 9.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+01 is 8.914049e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329976951881       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329977034226       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329977034094       residual = 9.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+02 is 2.236716e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329976951881       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329976972480       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329976972446       residual = 9.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+02 is 5.596940e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158314 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0001e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -6.888883e-01 3 1  ON 0
ci_002                -7.115057e-01 3 1  ON 1
ci_003                -6.275839e-02 3 1  ON 2
ci_004                -6.406359e-02 3 1  ON 3
ci_005                 4.551735e-02 3 1  ON 4
ci_006                 4.574321e-02 3 1  ON 5
ci_007                 3.229468e-02 3 1  ON 6
ci_008                 3.325924e-02 3 1  ON 7
ci_009                -2.519441e-02 3 1  ON 8
ci_010                -2.565623e-02 3 1  ON 9
ci_011                -2.168154e-02 3 1  ON 10
ci_012                -2.316166e-02 3 1  ON 11
ci_013                 2.021516e-02 3 1  ON 12
ci_014                 2.100709e-02 3 1  ON 13
ci_015                 1.902376e-02 3 1  ON 14
ci_016                 2.009640e-02 3 1  ON 15
ci_017                 1.587648e-02 3 1  ON 16
ci_018                 1.587061e-02 3 1  ON 17
ci_019                 1.076165e-02 3 1  ON 18
ci_020                 9.462515e-03 3 1  ON 19
ci_021                -9.803993e-03 3 1  ON 20
ci_022                -1.167978e-02 3 1  ON 21
ci_023                 8.178423e-03 3 1  ON 22
ci_024                 9.085800e-03 3 1  ON 23
ci_025                 7.684810e-03 3 1  ON 24
ci_026                 8.956573e-03 3 1  ON 25
ci_027                 7.481619e-03 3 1  ON 26
ci_028                 7.314903e-03 3 1  ON 27
ci_029                -6.230059e-03 3 1  ON 28
ci_030                -7.346067e-03 3 1  ON 29
ci_031                -6.918717e-03 3 1  ON 30
ci_032                -8.020268e-03 3 1  ON 31
ci_033                 6.572603e-03 3 1  ON 32
ci_034                 6.081012e-03 3 1  ON 33
ci_035                 7.287697e-03 3 1  ON 34
ci_036                 6.882190e-03 3 1  ON 35
ci_037                 5.639241e-03 3 1  ON 36
ci_038                 6.886514e-03 3 1  ON 37
ci_039                 4.860143e-03 3 1  ON 38
ci_040                 5.779321e-03 3 1  ON 39
ci_041                 5.202781e-03 3 1  ON 40
ci_042                 5.491854e-03 3 1  ON 41
ci_043                 4.844904e-03 3 1  ON 42
ci_044                 6.485620e-03 3 1  ON 43
ci_045                 4.973714e-03 3 1  ON 44
ci_046                 5.238998e-03 3 1  ON 45
ci_047                -4.263394e-03 3 1  ON 46
ci_048                -4.092159e-03 3 1  ON 47
ci_049                 3.722678e-03 3 1  ON 48
ci_050                 3.532355e-03 3 1  ON 49
ci_051                -3.178793e-03 3 1  ON 50
ci_052                -2.863714e-03 3 1  ON 51
ci_053                -1.481338e-03 3 1  ON 52
ci_054                -2.030264e-03 3 1  ON 53
ci_055                -1.608434e-03 3 1  ON 54
ci_056                -1.737261e-03 3 1  ON 55
ci_057                -2.200471e-03 3 1  ON 56
ci_058                -1.727019e-03 3 1  ON 57
ci_059                -2.573014e-03 3 1  ON 58
ci_060                -1.668911e-03 3 1  ON 59
ci_061                -1.987808e-03 3 1  ON 60
ci_062                -1.782606e-03 3 1  ON 61
ci_063                -3.494428e-04 3 1  ON 62
ci_064                -6.729063e-04 3 1  ON 63
ci_065                -2.202185e-03 3 1  ON 64
ci_066                -1.970421e-03 3 1  ON 65
ci_067                 1.012512e-04 3 1  ON 66
ci_068                -8.570134e-04 3 1  ON 67
ci_069                 2.280046e-03 3 1  ON 68
ci_070                 1.600433e-03 3 1  ON 69
ci_071                -1.541771e-03 3 1  ON 70
ci_072                -8.194399e-05 3 1  ON 71
ci_073                 1.371499e-03 3 1  ON 72
ci_074                 1.565315e-03 3 1  ON 73
ci_075                -1.891730e-03 3 1  ON 74
ci_076                -1.239261e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6069
    reference variance = 2.13545
====================================================
  Execution time = 2.3616e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7270e+00
  Total weights = 1.9494e+06
  Execution time = 4.3737e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778788214580
                                         uncertainty =       0.039178255517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778788214580
                                         uncertainty =       0.039178255517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374633361
  error estimate for blocks of size 2^( 2) =       0.001445076561
  error estimate for blocks of size 2^( 3) =       0.001505556435
  error estimate for blocks of size 2^( 4) =       0.001547864464
  error estimate for blocks of size 2^( 5) =       0.001576361610
  error estimate for blocks of size 2^( 6) =       0.001583863069
  error estimate for blocks of size 2^( 7) =       0.001601477614

      target function =                  N/A
              le_mean =     -22.327028338966
             les_mean =     502.223237840932
             stat err =       0.001577391689
             autocorr =       1.316756094534
              std dev =       1.944056247098
             le_variance =       3.779354691880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778785784215
                                         uncertainty =       0.039178206444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778785784215
                                         uncertainty =       0.039178206444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374632919
  error estimate for blocks of size 2^( 2) =       0.001445076116
  error estimate for blocks of size 2^( 3) =       0.001505556112
  error estimate for blocks of size 2^( 4) =       0.001547864203
  error estimate for blocks of size 2^( 5) =       0.001576361393
  error estimate for blocks of size 2^( 6) =       0.001583862894
  error estimate for blocks of size 2^( 7) =       0.001601477621

      target function =                  N/A
              le_mean =     -22.327028351867
             les_mean =     502.223216883811
             stat err =       0.001577391528
             autocorr =       1.316756672743
              std dev =       1.944055621550
             le_variance =       3.779352259679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778786991231
                                         uncertainty =       0.039178230901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778786991231
                                         uncertainty =       0.039178230901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374633139
  error estimate for blocks of size 2^( 2) =       0.001445076337
  error estimate for blocks of size 2^( 3) =       0.001505556272
  error estimate for blocks of size 2^( 4) =       0.001547864332
  error estimate for blocks of size 2^( 5) =       0.001576361502
  error estimate for blocks of size 2^( 6) =       0.001583862982
  error estimate for blocks of size 2^( 7) =       0.001601477619

      target function =                  N/A
              le_mean =     -22.327028345139
             les_mean =     502.223221773564
             stat err =       0.001577391609
             autocorr =       1.316756387068
              std dev =       1.944055932224
             le_variance =       3.779353467617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778788061061
                                         uncertainty =       0.039178252439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.778788061061
                                         uncertainty =       0.039178252439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374633333
  error estimate for blocks of size 2^( 2) =       0.001445076533
  error estimate for blocks of size 2^( 3) =       0.001505556415
  error estimate for blocks of size 2^( 4) =       0.001547864447
  error estimate for blocks of size 2^( 5) =       0.001576361596
  error estimate for blocks of size 2^( 6) =       0.001583863058
  error estimate for blocks of size 2^( 7) =       0.001601477614

      target function =                  N/A
              le_mean =     -22.327028339580
             les_mean =     502.223230140127
             stat err =       0.001577391679
             autocorr =       1.316756131053
              std dev =       1.944056207584
             le_variance =       3.779354538247


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327028338966        initial
     5.6843e+01     5.6843e+02             8.9140e-06       -22.327028351867  <--
     2.2737e+02     2.2737e+03             2.2367e-06       -22.327028345139
     9.0949e+02     9.0949e+03             5.5969e-07       -22.327028339580

*****************************************************************************
Applying the update for shift_i =   5.6843e+01     and shift_s =   5.6843e+02
*****************************************************************************

  Execution time = 4.5599e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -6.888883e-01 3 1  ON 0
ci_002                -7.115063e-01 3 1  ON 1
ci_003                -6.275931e-02 3 1  ON 2
ci_004                -6.405806e-02 3 1  ON 3
ci_005                 4.551467e-02 3 1  ON 4
ci_006                 4.574668e-02 3 1  ON 5
ci_007                 3.229300e-02 3 1  ON 6
ci_008                 3.325719e-02 3 1  ON 7
ci_009                -2.519477e-02 3 1  ON 8
ci_010                -2.565315e-02 3 1  ON 9
ci_011                -2.168300e-02 3 1  ON 10
ci_012                -2.316153e-02 3 1  ON 11
ci_013                 2.021271e-02 3 1  ON 12
ci_014                 2.100744e-02 3 1  ON 13
ci_015                 1.902702e-02 3 1  ON 14
ci_016                 2.009712e-02 3 1  ON 15
ci_017                 1.587680e-02 3 1  ON 16
ci_018                 1.586816e-02 3 1  ON 17
ci_019                 1.076023e-02 3 1  ON 18
ci_020                 9.460476e-03 3 1  ON 19
ci_021                -9.802359e-03 3 1  ON 20
ci_022                -1.167574e-02 3 1  ON 21
ci_023                 8.178707e-03 3 1  ON 22
ci_024                 9.086410e-03 3 1  ON 23
ci_025                 7.685852e-03 3 1  ON 24
ci_026                 8.954761e-03 3 1  ON 25
ci_027                 7.482067e-03 3 1  ON 26
ci_028                 7.321230e-03 3 1  ON 27
ci_029                -6.232312e-03 3 1  ON 28
ci_030                -7.344256e-03 3 1  ON 29
ci_031                -6.918036e-03 3 1  ON 30
ci_032                -8.023550e-03 3 1  ON 31
ci_033                 6.572631e-03 3 1  ON 32
ci_034                 6.082159e-03 3 1  ON 33
ci_035                 7.286871e-03 3 1  ON 34
ci_036                 6.878747e-03 3 1  ON 35
ci_037                 5.641708e-03 3 1  ON 36
ci_038                 6.886598e-03 3 1  ON 37
ci_039                 4.866820e-03 3 1  ON 38
ci_040                 5.781226e-03 3 1  ON 39
ci_041                 5.205384e-03 3 1  ON 40
ci_042                 5.489044e-03 3 1  ON 41
ci_043                 4.842998e-03 3 1  ON 42
ci_044                 6.483326e-03 3 1  ON 43
ci_045                 4.977134e-03 3 1  ON 44
ci_046                 5.236273e-03 3 1  ON 45
ci_047                -4.263147e-03 3 1  ON 46
ci_048                -4.092964e-03 3 1  ON 47
ci_049                 3.719770e-03 3 1  ON 48
ci_050                 3.531822e-03 3 1  ON 49
ci_051                -3.179854e-03 3 1  ON 50
ci_052                -2.864561e-03 3 1  ON 51
ci_053                -1.482132e-03 3 1  ON 52
ci_054                -2.030902e-03 3 1  ON 53
ci_055                -1.608559e-03 3 1  ON 54
ci_056                -1.739230e-03 3 1  ON 55
ci_057                -2.200731e-03 3 1  ON 56
ci_058                -1.728334e-03 3 1  ON 57
ci_059                -2.570565e-03 3 1  ON 58
ci_060                -1.669743e-03 3 1  ON 59
ci_061                -1.987156e-03 3 1  ON 60
ci_062                -1.778237e-03 3 1  ON 61
ci_063                -3.535280e-04 3 1  ON 62
ci_064                -6.746652e-04 3 1  ON 63
ci_065                -2.199091e-03 3 1  ON 64
ci_066                -1.966837e-03 3 1  ON 65
ci_067                 9.895931e-05 3 1  ON 66
ci_068                -8.574266e-04 3 1  ON 67
ci_069                 2.277389e-03 3 1  ON 68
ci_070                 1.601101e-03 3 1  ON 69
ci_071                -1.542024e-03 3 1  ON 70
ci_072                -8.467940e-05 3 1  ON 71
ci_073                 1.370800e-03 3 1  ON 72
ci_074                 1.562381e-03 3 1  ON 73
ci_075                -1.889244e-03 3 1  ON 74
ci_076                -1.236113e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5607e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2309e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.2662
    reference variance = 2.82447
====================================================
  Execution time = 2.4258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0305e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.8153e+00
  Total weights = 1.949677178e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8817e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.868511174735
                                         uncertainty =       0.074854068264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.868511174735
                                         uncertainty =       0.074854068264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001390771433
  error estimate for blocks of size 2^( 2) =       0.001461151933
  error estimate for blocks of size 2^( 3) =       0.001523165238
  error estimate for blocks of size 2^( 4) =       0.001564205111
  error estimate for blocks of size 2^( 5) =       0.001590502694
  error estimate for blocks of size 2^( 6) =       0.001604436703
  error estimate for blocks of size 2^( 7) =       0.001607900719

      target function =                  N/A
              le_mean =     -22.326266748027
             les_mean =     502.277448086646
             stat err =       0.001591761307
             autocorr =       1.309918765213
              std dev =       1.966879292442
             le_variance =       3.868614151039


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232626674803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326266747208       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326268420304       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326268416415       residual = 2.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+01 is 3.040032e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326266747208       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326267169330       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326267168355       residual = 1.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+01 is 7.662115e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326266747208       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326266852982       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326266852739       residual = 1.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+02 is 1.919451e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0147e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -6.888844e-01 3 1  ON 0
ci_002                -7.115104e-01 3 1  ON 1
ci_003                -6.275756e-02 3 1  ON 2
ci_004                -6.406114e-02 3 1  ON 3
ci_005                 4.551427e-02 3 1  ON 4
ci_006                 4.574730e-02 3 1  ON 5
ci_007                 3.228751e-02 3 1  ON 6
ci_008                 3.324980e-02 3 1  ON 7
ci_009                -2.519041e-02 3 1  ON 8
ci_010                -2.565537e-02 3 1  ON 9
ci_011                -2.168669e-02 3 1  ON 10
ci_012                -2.316091e-02 3 1  ON 11
ci_013                 2.020958e-02 3 1  ON 12
ci_014                 2.100565e-02 3 1  ON 13
ci_015                 1.903059e-02 3 1  ON 14
ci_016                 2.009616e-02 3 1  ON 15
ci_017                 1.587503e-02 3 1  ON 16
ci_018                 1.586974e-02 3 1  ON 17
ci_019                 1.075829e-02 3 1  ON 18
ci_020                 9.467601e-03 3 1  ON 19
ci_021                -9.804242e-03 3 1  ON 20
ci_022                -1.167471e-02 3 1  ON 21
ci_023                 8.180252e-03 3 1  ON 22
ci_024                 9.086304e-03 3 1  ON 23
ci_025                 7.687153e-03 3 1  ON 24
ci_026                 8.953334e-03 3 1  ON 25
ci_027                 7.481917e-03 3 1  ON 26
ci_028                 7.323735e-03 3 1  ON 27
ci_029                -6.239974e-03 3 1  ON 28
ci_030                -7.347596e-03 3 1  ON 29
ci_031                -6.919848e-03 3 1  ON 30
ci_032                -8.024195e-03 3 1  ON 31
ci_033                 6.579431e-03 3 1  ON 32
ci_034                 6.084560e-03 3 1  ON 33
ci_035                 7.280349e-03 3 1  ON 34
ci_036                 6.879792e-03 3 1  ON 35
ci_037                 5.641356e-03 3 1  ON 36
ci_038                 6.888970e-03 3 1  ON 37
ci_039                 4.869454e-03 3 1  ON 38
ci_040                 5.784300e-03 3 1  ON 39
ci_041                 5.205795e-03 3 1  ON 40
ci_042                 5.489491e-03 3 1  ON 41
ci_043                 4.842680e-03 3 1  ON 42
ci_044                 6.479251e-03 3 1  ON 43
ci_045                 4.980720e-03 3 1  ON 44
ci_046                 5.236456e-03 3 1  ON 45
ci_047                -4.266094e-03 3 1  ON 46
ci_048                -4.092824e-03 3 1  ON 47
ci_049                 3.718733e-03 3 1  ON 48
ci_050                 3.531762e-03 3 1  ON 49
ci_051                -3.178673e-03 3 1  ON 50
ci_052                -2.862837e-03 3 1  ON 51
ci_053                -1.485203e-03 3 1  ON 52
ci_054                -2.036302e-03 3 1  ON 53
ci_055                -1.611686e-03 3 1  ON 54
ci_056                -1.745393e-03 3 1  ON 55
ci_057                -2.203802e-03 3 1  ON 56
ci_058                -1.726185e-03 3 1  ON 57
ci_059                -2.563912e-03 3 1  ON 58
ci_060                -1.668922e-03 3 1  ON 59
ci_061                -1.981582e-03 3 1  ON 60
ci_062                -1.778392e-03 3 1  ON 61
ci_063                -3.583946e-04 3 1  ON 62
ci_064                -6.721743e-04 3 1  ON 63
ci_065                -2.192692e-03 3 1  ON 64
ci_066                -1.963160e-03 3 1  ON 65
ci_067                 9.806453e-05 3 1  ON 66
ci_068                -8.620614e-04 3 1  ON 67
ci_069                 2.276854e-03 3 1  ON 68
ci_070                 1.600683e-03 3 1  ON 69
ci_071                -1.535880e-03 3 1  ON 70
ci_072                -8.492314e-05 3 1  ON 71
ci_073                 1.369531e-03 3 1  ON 72
ci_074                 1.559780e-03 3 1  ON 73
ci_075                -1.884375e-03 3 1  ON 74
ci_076                -1.232058e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.2763
    reference variance = 2.79804
====================================================
  Execution time = 2.3623e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6913e+00
  Total weights = 1.9499e+06
  Execution time = 4.3974e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742207460944
                                         uncertainty =       0.026755263171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742207460944
                                         uncertainty =       0.026755263171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367701860
  error estimate for blocks of size 2^( 2) =       0.001439096126
  error estimate for blocks of size 2^( 3) =       0.001501925179
  error estimate for blocks of size 2^( 4) =       0.001546044465
  error estimate for blocks of size 2^( 5) =       0.001572755004
  error estimate for blocks of size 2^( 6) =       0.001579405731
  error estimate for blocks of size 2^( 7) =       0.001592971482

      target function =                  N/A
              le_mean =     -22.329683526450
             les_mean =     502.306062374971
             stat err =       0.001572794170
             autocorr =       1.322394111256
              std dev =       1.934253466752
             le_variance =       3.741336473642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742203479053
                                         uncertainty =       0.026755199713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742203479053
                                         uncertainty =       0.026755199713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367701130
  error estimate for blocks of size 2^( 2) =       0.001439095645
  error estimate for blocks of size 2^( 3) =       0.001501924888
  error estimate for blocks of size 2^( 4) =       0.001546044294
  error estimate for blocks of size 2^( 5) =       0.001572754798
  error estimate for blocks of size 2^( 6) =       0.001579405612
  error estimate for blocks of size 2^( 7) =       0.001592971445

      target function =                  N/A
              le_mean =     -22.329683798809
             les_mean =     502.306124873421
             stat err =       0.001572794037
             autocorr =       1.322395298592
              std dev =       1.934252434551
             le_variance =       3.741332480565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742205424112
                                         uncertainty =       0.026755230813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742205424112
                                         uncertainty =       0.026755230813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367701486
  error estimate for blocks of size 2^( 2) =       0.001439095881
  error estimate for blocks of size 2^( 3) =       0.001501925030
  error estimate for blocks of size 2^( 4) =       0.001546044381
  error estimate for blocks of size 2^( 5) =       0.001572754903
  error estimate for blocks of size 2^( 6) =       0.001579405670
  error estimate for blocks of size 2^( 7) =       0.001592971466

      target function =                  N/A
              le_mean =     -22.329683653720
             les_mean =     502.306040199681
             stat err =       0.001572794105
             autocorr =       1.322394722704
              std dev =       1.934252938787
             le_variance =       3.741334431204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742207202849
                                         uncertainty =       0.026755259109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742207202849
                                         uncertainty =       0.026755259109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367701813
  error estimate for blocks of size 2^( 2) =       0.001439096095
  error estimate for blocks of size 2^( 3) =       0.001501925160
  error estimate for blocks of size 2^( 4) =       0.001546044454
  error estimate for blocks of size 2^( 5) =       0.001572754991
  error estimate for blocks of size 2^( 6) =       0.001579405722
  error estimate for blocks of size 2^( 7) =       0.001592971478

      target function =                  N/A
              le_mean =     -22.329683541725
             les_mean =     502.306058674162
             stat err =       0.001572794161
             autocorr =       1.322394187145
              std dev =       1.934253399854
             le_variance =       3.741336214847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329683526450        initial
     1.4211e+01     1.4211e+02             3.0400e-05       -22.329683798809  <--
     5.6843e+01     5.6843e+02             7.6621e-06       -22.329683653720
     2.2737e+02     2.2737e+03             1.9195e-06       -22.329683541725

*****************************************************************************
Applying the update for shift_i =   1.4211e+01     and shift_s =   1.4211e+02
*****************************************************************************

  Execution time = 4.8411e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -6.888727e-01 3 1  ON 0
ci_002                -7.115225e-01 3 1  ON 1
ci_003                -6.275230e-02 3 1  ON 2
ci_004                -6.407037e-02 3 1  ON 3
ci_005                 4.551312e-02 3 1  ON 4
ci_006                 4.574914e-02 3 1  ON 5
ci_007                 3.227121e-02 3 1  ON 6
ci_008                 3.322787e-02 3 1  ON 7
ci_009                -2.517752e-02 3 1  ON 8
ci_010                -2.566198e-02 3 1  ON 9
ci_011                -2.169759e-02 3 1  ON 10
ci_012                -2.315902e-02 3 1  ON 11
ci_013                 2.020023e-02 3 1  ON 12
ci_014                 2.100037e-02 3 1  ON 13
ci_015                 1.904119e-02 3 1  ON 14
ci_016                 2.009330e-02 3 1  ON 15
ci_017                 1.586974e-02 3 1  ON 16
ci_018                 1.587440e-02 3 1  ON 17
ci_019                 1.075250e-02 3 1  ON 18
ci_020                 9.488791e-03 3 1  ON 19
ci_021                -9.809847e-03 3 1  ON 20
ci_022                -1.167167e-02 3 1  ON 21
ci_023                 8.184815e-03 3 1  ON 22
ci_024                 9.085985e-03 3 1  ON 23
ci_025                 7.691048e-03 3 1  ON 24
ci_026                 8.949066e-03 3 1  ON 25
ci_027                 7.481469e-03 3 1  ON 26
ci_028                 7.331099e-03 3 1  ON 27
ci_029                -6.262712e-03 3 1  ON 28
ci_030                -7.357530e-03 3 1  ON 29
ci_031                -6.925195e-03 3 1  ON 30
ci_032                -8.026091e-03 3 1  ON 31
ci_033                 6.599590e-03 3 1  ON 32
ci_034                 6.091702e-03 3 1  ON 33
ci_035                 7.261181e-03 3 1  ON 34
ci_036                 6.882865e-03 3 1  ON 35
ci_037                 5.640303e-03 3 1  ON 36
ci_038                 6.895990e-03 3 1  ON 37
ci_039                 4.877198e-03 3 1  ON 38
ci_040                 5.793318e-03 3 1  ON 39
ci_041                 5.207006e-03 3 1  ON 40
ci_042                 5.490797e-03 3 1  ON 41
ci_043                 4.841706e-03 3 1  ON 42
ci_044                 6.467126e-03 3 1  ON 43
ci_045                 4.991304e-03 3 1  ON 44
ci_046                 5.236979e-03 3 1  ON 45
ci_047                -4.274723e-03 3 1  ON 46
ci_048                -4.092375e-03 3 1  ON 47
ci_049                 3.715647e-03 3 1  ON 48
ci_050                 3.531586e-03 3 1  ON 49
ci_051                -3.175188e-03 3 1  ON 50
ci_052                -2.857687e-03 3 1  ON 51
ci_053                -1.494256e-03 3 1  ON 52
ci_054                -2.052294e-03 3 1  ON 53
ci_055                -1.620975e-03 3 1  ON 54
ci_056                -1.763710e-03 3 1  ON 55
ci_057                -2.212892e-03 3 1  ON 56
ci_058                -1.719829e-03 3 1  ON 57
ci_059                -2.544347e-03 3 1  ON 58
ci_060                -1.666496e-03 3 1  ON 59
ci_061                -1.965054e-03 3 1  ON 60
ci_062                -1.778842e-03 3 1  ON 61
ci_063                -3.728357e-04 3 1  ON 62
ci_064                -6.647875e-04 3 1  ON 63
ci_065                -2.173704e-03 3 1  ON 64
ci_066                -1.952276e-03 3 1  ON 65
ci_067                 9.542995e-05 3 1  ON 66
ci_068                -8.757916e-04 3 1  ON 67
ci_069                 2.275271e-03 3 1  ON 68
ci_070                 1.599452e-03 3 1  ON 69
ci_071                -1.517703e-03 3 1  ON 70
ci_072                -8.564141e-05 3 1  ON 71
ci_073                 1.365787e-03 3 1  ON 72
ci_074                 1.552133e-03 3 1  ON 73
ci_075                -1.869968e-03 3 1  ON 74
ci_076                -1.220058e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8564e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2309e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.5134
    reference variance = 2.36485
====================================================
  Execution time = 2.4124e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0273e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6789e+00
  Total weights = 1.950163597e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9838e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730093169834
                                         uncertainty =       0.029325537721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.730093169834
                                         uncertainty =       0.029325537721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001365558840
  error estimate for blocks of size 2^( 2) =       0.001435984025
  error estimate for blocks of size 2^( 3) =       0.001498480554
  error estimate for blocks of size 2^( 4) =       0.001543732562
  error estimate for blocks of size 2^( 5) =       0.001566392313
  error estimate for blocks of size 2^( 6) =       0.001581585574
  error estimate for blocks of size 2^( 7) =       0.001590572053

      target function =                  N/A
              le_mean =     -22.328145951640
             les_mean =     502.225008137326
             stat err =       0.001570570625
             autocorr =       1.322799752191
              std dev =       1.931222730886
             le_variance =       3.729621236290


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232814595164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328145950823       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328153061949       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328153228254       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+00 is 1.234048e-04

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328145950823       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328147800976       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328147840208       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+01 is 3.275812e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328145950823       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328146418117       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328146427787       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+01 is 8.324214e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160663 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0114e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -6.888721e-01 3 1  ON 0
ci_002                -7.115245e-01 3 1  ON 1
ci_003                -6.275285e-02 3 1  ON 2
ci_004                -6.406507e-02 3 1  ON 3
ci_005                 4.550517e-02 3 1  ON 4
ci_006                 4.573351e-02 3 1  ON 5
ci_007                 3.225674e-02 3 1  ON 6
ci_008                 3.322051e-02 3 1  ON 7
ci_009                -2.515855e-02 3 1  ON 8
ci_010                -2.565861e-02 3 1  ON 9
ci_011                -2.169547e-02 3 1  ON 10
ci_012                -2.316635e-02 3 1  ON 11
ci_013                 2.020072e-02 3 1  ON 12
ci_014                 2.100068e-02 3 1  ON 13
ci_015                 1.905843e-02 3 1  ON 14
ci_016                 2.012496e-02 3 1  ON 15
ci_017                 1.586502e-02 3 1  ON 16
ci_018                 1.586708e-02 3 1  ON 17
ci_019                 1.076491e-02 3 1  ON 18
ci_020                 9.486970e-03 3 1  ON 19
ci_021                -9.835878e-03 3 1  ON 20
ci_022                -1.168166e-02 3 1  ON 21
ci_023                 8.180862e-03 3 1  ON 22
ci_024                 9.068610e-03 3 1  ON 23
ci_025                 7.680049e-03 3 1  ON 24
ci_026                 8.945613e-03 3 1  ON 25
ci_027                 7.472375e-03 3 1  ON 26
ci_028                 7.331520e-03 3 1  ON 27
ci_029                -6.292752e-03 3 1  ON 28
ci_030                -7.372839e-03 3 1  ON 29
ci_031                -6.944966e-03 3 1  ON 30
ci_032                -8.001167e-03 3 1  ON 31
ci_033                 6.613374e-03 3 1  ON 32
ci_034                 6.113276e-03 3 1  ON 33
ci_035                 7.258849e-03 3 1  ON 34
ci_036                 6.881171e-03 3 1  ON 35
ci_037                 5.646929e-03 3 1  ON 36
ci_038                 6.913532e-03 3 1  ON 37
ci_039                 4.898854e-03 3 1  ON 38
ci_040                 5.779629e-03 3 1  ON 39
ci_041                 5.195934e-03 3 1  ON 40
ci_042                 5.476898e-03 3 1  ON 41
ci_043                 4.838097e-03 3 1  ON 42
ci_044                 6.456854e-03 3 1  ON 43
ci_045                 4.992749e-03 3 1  ON 44
ci_046                 5.228511e-03 3 1  ON 45
ci_047                -4.307481e-03 3 1  ON 46
ci_048                -4.105394e-03 3 1  ON 47
ci_049                 3.686727e-03 3 1  ON 48
ci_050                 3.541438e-03 3 1  ON 49
ci_051                -3.182195e-03 3 1  ON 50
ci_052                -2.868359e-03 3 1  ON 51
ci_053                -1.517357e-03 3 1  ON 52
ci_054                -2.077729e-03 3 1  ON 53
ci_055                -1.631573e-03 3 1  ON 54
ci_056                -1.772636e-03 3 1  ON 55
ci_057                -2.212505e-03 3 1  ON 56
ci_058                -1.745069e-03 3 1  ON 57
ci_059                -2.521665e-03 3 1  ON 58
ci_060                -1.666481e-03 3 1  ON 59
ci_061                -1.961259e-03 3 1  ON 60
ci_062                -1.783958e-03 3 1  ON 61
ci_063                -4.012036e-04 3 1  ON 62
ci_064                -6.912497e-04 3 1  ON 63
ci_065                -2.166794e-03 3 1  ON 64
ci_066                -1.948636e-03 3 1  ON 65
ci_067                 7.115769e-05 3 1  ON 66
ci_068                -8.702432e-04 3 1  ON 67
ci_069                 2.273192e-03 3 1  ON 68
ci_070                 1.617332e-03 3 1  ON 69
ci_071                -1.504440e-03 3 1  ON 70
ci_072                -9.679313e-05 3 1  ON 71
ci_073                 1.351784e-03 3 1  ON 72
ci_074                 1.551190e-03 3 1  ON 73
ci_075                -1.867670e-03 3 1  ON 74
ci_076                -1.224045e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.3367
    reference variance = 3.3535
====================================================
  Execution time = 2.3607e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7064e+00
  Total weights = 1.9497e+06
  Execution time = 4.3633e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756845317485
                                         uncertainty =       0.047376719516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756845317485
                                         uncertainty =       0.047376719516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370533120
  error estimate for blocks of size 2^( 2) =       0.001441735834
  error estimate for blocks of size 2^( 3) =       0.001503687605
  error estimate for blocks of size 2^( 4) =       0.001547036629
  error estimate for blocks of size 2^( 5) =       0.001575590183
  error estimate for blocks of size 2^( 6) =       0.001589607799
  error estimate for blocks of size 2^( 7) =       0.001596022527

      target function =                  N/A
              le_mean =     -22.327367734256
             les_mean =     502.217760667168
             stat err =       0.001577064284
             autocorr =       1.324096758643
              std dev =       1.938257537984
             le_variance =       3.756842283550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756841427614
                                         uncertainty =       0.047377053652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756841427614
                                         uncertainty =       0.047377053652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370532423
  error estimate for blocks of size 2^( 2) =       0.001441737998
  error estimate for blocks of size 2^( 3) =       0.001503692098
  error estimate for blocks of size 2^( 4) =       0.001547043161
  error estimate for blocks of size 2^( 5) =       0.001575597401
  error estimate for blocks of size 2^( 6) =       0.001589619066
  error estimate for blocks of size 2^( 7) =       0.001596027213

      target function =                  N/A
              le_mean =     -22.327368871460
             les_mean =     502.226889010192
             stat err =       0.001577071710
             autocorr =       1.324110575602
              std dev =       1.938256551573
             le_variance =       3.756838459717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756842244246
                                         uncertainty =       0.047376899104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756842244246
                                         uncertainty =       0.047376899104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370532566
  error estimate for blocks of size 2^( 2) =       0.001441736800
  error estimate for blocks of size 2^( 3) =       0.001503689558
  error estimate for blocks of size 2^( 4) =       0.001547039697
  error estimate for blocks of size 2^( 5) =       0.001575592742
  error estimate for blocks of size 2^( 6) =       0.001589612615
  error estimate for blocks of size 2^( 7) =       0.001596023890

      target function =                  N/A
              le_mean =     -22.327368362200
             les_mean =     502.217760366784
             stat err =       0.001577067236
             autocorr =       1.324102786550
              std dev =       1.938256753677
             le_variance =       3.756839243173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756844836718
                                         uncertainty =       0.047376742566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.756844836718
                                         uncertainty =       0.047376742566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370533034
  error estimate for blocks of size 2^( 2) =       0.001441735940
  error estimate for blocks of size 2^( 3) =       0.001503687834
  error estimate for blocks of size 2^( 4) =       0.001547037011
  error estimate for blocks of size 2^( 5) =       0.001575590500
  error estimate for blocks of size 2^( 6) =       0.001589608397
  error estimate for blocks of size 2^( 7) =       0.001596022682

      target function =                  N/A
              le_mean =     -22.327367802050
             les_mean =     502.217775846303
             stat err =       0.001577064647
             autocorr =       1.324097536230
              std dev =       1.938257415032
             le_variance =       3.756841806928


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327367734256        initial
     3.5527e+00     3.5527e+01             1.2340e-04       -22.327368871460  <--
     1.4211e+01     1.4211e+02             3.2758e-05       -22.327368362200
     5.6843e+01     5.6843e+02             8.3242e-06       -22.327367802050

*****************************************************************************
Applying the update for shift_i =   3.5527e+00     and shift_s =   3.5527e+01
*****************************************************************************

  Execution time = 4.5567e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -6.888702e-01 3 1  ON 0
ci_002                -7.115301e-01 3 1  ON 1
ci_003                -6.275445e-02 3 1  ON 2
ci_004                -6.404957e-02 3 1  ON 3
ci_005                 4.548328e-02 3 1  ON 4
ci_006                 4.568993e-02 3 1  ON 5
ci_007                 3.221607e-02 3 1  ON 6
ci_008                 3.319989e-02 3 1  ON 7
ci_009                -2.510523e-02 3 1  ON 8
ci_010                -2.564966e-02 3 1  ON 9
ci_011                -2.168891e-02 3 1  ON 10
ci_012                -2.318710e-02 3 1  ON 11
ci_013                 2.020160e-02 3 1  ON 12
ci_014                 2.100155e-02 3 1  ON 13
ci_015                 1.910854e-02 3 1  ON 14
ci_016                 2.021670e-02 3 1  ON 15
ci_017                 1.585105e-02 3 1  ON 16
ci_018                 1.584561e-02 3 1  ON 17
ci_019                 1.080090e-02 3 1  ON 18
ci_020                 9.481573e-03 3 1  ON 19
ci_021                -9.911252e-03 3 1  ON 20
ci_022                -1.171096e-02 3 1  ON 21
ci_023                 8.169498e-03 3 1  ON 22
ci_024                 9.019244e-03 3 1  ON 23
ci_025                 7.648511e-03 3 1  ON 24
ci_026                 8.935600e-03 3 1  ON 25
ci_027                 7.446841e-03 3 1  ON 26
ci_028                 7.333102e-03 3 1  ON 27
ci_029                -6.378562e-03 3 1  ON 28
ci_030                -7.416928e-03 3 1  ON 29
ci_031                -7.001167e-03 3 1  ON 30
ci_032                -7.929146e-03 3 1  ON 31
ci_033                 6.653077e-03 3 1  ON 32
ci_034                 6.175532e-03 3 1  ON 33
ci_035                 7.251954e-03 3 1  ON 34
ci_036                 6.876154e-03 3 1  ON 35
ci_037                 5.665488e-03 3 1  ON 36
ci_038                 6.963628e-03 3 1  ON 37
ci_039                 4.958969e-03 3 1  ON 38
ci_040                 5.741887e-03 3 1  ON 39
ci_041                 5.164658e-03 3 1  ON 40
ci_042                 5.438137e-03 3 1  ON 41
ci_043                 4.826940e-03 3 1  ON 42
ci_044                 6.427890e-03 3 1  ON 43
ci_045                 4.996721e-03 3 1  ON 44
ci_046                 5.203926e-03 3 1  ON 45
ci_047                -4.397723e-03 3 1  ON 46
ci_048                -4.141482e-03 3 1  ON 47
ci_049                 3.603779e-03 3 1  ON 48
ci_050                 3.569808e-03 3 1  ON 49
ci_051                -3.202088e-03 3 1  ON 50
ci_052                -2.898520e-03 3 1  ON 51
ci_053                -1.583072e-03 3 1  ON 52
ci_054                -2.150758e-03 3 1  ON 53
ci_055                -1.661638e-03 3 1  ON 54
ci_056                -1.798614e-03 3 1  ON 55
ci_057                -2.211433e-03 3 1  ON 56
ci_058                -1.816975e-03 3 1  ON 57
ci_059                -2.458320e-03 3 1  ON 58
ci_060                -1.666705e-03 3 1  ON 59
ci_061                -1.950121e-03 3 1  ON 60
ci_062                -1.798586e-03 3 1  ON 61
ci_063                -4.822303e-04 3 1  ON 62
ci_064                -7.670659e-04 3 1  ON 63
ci_065                -2.146556e-03 3 1  ON 64
ci_066                -1.938013e-03 3 1  ON 65
ci_067                 1.923467e-06 3 1  ON 66
ci_068                -8.545807e-04 3 1  ON 67
ci_069                 2.267793e-03 3 1  ON 68
ci_070                 1.668647e-03 3 1  ON 69
ci_071                -1.466524e-03 3 1  ON 70
ci_072                -1.285068e-04 3 1  ON 71
ci_073                 1.313296e-03 3 1  ON 72
ci_074                 1.548743e-03 3 1  ON 73
ci_075                -1.861686e-03 3 1  ON 74
ci_076                -1.235373e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5688e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2311e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.2834
    reference variance = 4.91159
====================================================
  Execution time = 2.4211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0320e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6895e+00
  Total weights = 1.950113320e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9408e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742131227447
                                         uncertainty =       0.029372148296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742131227447
                                         uncertainty =       0.029372148296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367747412
  error estimate for blocks of size 2^( 2) =       0.001440438915
  error estimate for blocks of size 2^( 3) =       0.001504835925
  error estimate for blocks of size 2^( 4) =       0.001547899134
  error estimate for blocks of size 2^( 5) =       0.001571248651
  error estimate for blocks of size 2^( 6) =       0.001581858613
  error estimate for blocks of size 2^( 7) =       0.001592816585

      target function =                  N/A
              le_mean =     -22.328922057356
             les_mean =     502.270270382961
             stat err =       0.001573455746
             autocorr =       1.323418684047
              std dev =       1.934317888606
             le_variance =       3.741585694180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232892205736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328922056527       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328940862290       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328941211374       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-01 is 4.239534e-04

solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328922056527       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328927425646       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328927474004       residual = 5.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+00 is 1.194982e-04

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328922056527       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328923448217       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328923457935       residual = 3.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+01 is 3.088518e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0158e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -6.889204e-01 3 1  ON 0
ci_002                -7.114923e-01 3 1  ON 1
ci_003                -6.272964e-02 3 1  ON 2
ci_004                -6.401765e-02 3 1  ON 3
ci_005                 4.550277e-02 3 1  ON 4
ci_006                 4.567860e-02 3 1  ON 5
ci_007                 3.220382e-02 3 1  ON 6
ci_008                 3.316001e-02 3 1  ON 7
ci_009                -2.511731e-02 3 1  ON 8
ci_010                -2.562841e-02 3 1  ON 9
ci_011                -2.171595e-02 3 1  ON 10
ci_012                -2.318528e-02 3 1  ON 11
ci_013                 2.009811e-02 3 1  ON 12
ci_014                 2.102333e-02 3 1  ON 13
ci_015                 1.912662e-02 3 1  ON 14
ci_016                 2.018560e-02 3 1  ON 15
ci_017                 1.578932e-02 3 1  ON 16
ci_018                 1.583604e-02 3 1  ON 17
ci_019                 1.071591e-02 3 1  ON 18
ci_020                 9.527942e-03 3 1  ON 19
ci_021                -9.945231e-03 3 1  ON 20
ci_022                -1.162758e-02 3 1  ON 21
ci_023                 8.193426e-03 3 1  ON 22
ci_024                 9.012671e-03 3 1  ON 23
ci_025                 7.686629e-03 3 1  ON 24
ci_026                 8.977019e-03 3 1  ON 25
ci_027                 7.432034e-03 3 1  ON 26
ci_028                 7.422511e-03 3 1  ON 27
ci_029                -6.495849e-03 3 1  ON 28
ci_030                -7.431664e-03 3 1  ON 29
ci_031                -7.059939e-03 3 1  ON 30
ci_032                -7.925213e-03 3 1  ON 31
ci_033                 6.579138e-03 3 1  ON 32
ci_034                 6.198876e-03 3 1  ON 33
ci_035                 7.181903e-03 3 1  ON 34
ci_036                 6.905285e-03 3 1  ON 35
ci_037                 5.694241e-03 3 1  ON 36
ci_038                 6.889952e-03 3 1  ON 37
ci_039                 4.956039e-03 3 1  ON 38
ci_040                 5.742828e-03 3 1  ON 39
ci_041                 5.211278e-03 3 1  ON 40
ci_042                 5.423361e-03 3 1  ON 41
ci_043                 4.861641e-03 3 1  ON 42
ci_044                 6.407574e-03 3 1  ON 43
ci_045                 5.086575e-03 3 1  ON 44
ci_046                 5.148807e-03 3 1  ON 45
ci_047                -4.339521e-03 3 1  ON 46
ci_048                -4.097622e-03 3 1  ON 47
ci_049                 3.584849e-03 3 1  ON 48
ci_050                 3.538362e-03 3 1  ON 49
ci_051                -3.226503e-03 3 1  ON 50
ci_052                -2.893072e-03 3 1  ON 51
ci_053                -1.644912e-03 3 1  ON 52
ci_054                -2.177152e-03 3 1  ON 53
ci_055                -1.700664e-03 3 1  ON 54
ci_056                -1.827991e-03 3 1  ON 55
ci_057                -2.179914e-03 3 1  ON 56
ci_058                -1.819811e-03 3 1  ON 57
ci_059                -2.402915e-03 3 1  ON 58
ci_060                -1.628083e-03 3 1  ON 59
ci_061                -1.916094e-03 3 1  ON 60
ci_062                -1.734546e-03 3 1  ON 61
ci_063                -5.149759e-04 3 1  ON 62
ci_064                -8.865640e-04 3 1  ON 63
ci_065                -2.122990e-03 3 1  ON 64
ci_066                -1.929391e-03 3 1  ON 65
ci_067                -3.661540e-05 3 1  ON 66
ci_068                -8.650797e-04 3 1  ON 67
ci_069                 2.266020e-03 3 1  ON 68
ci_070                 1.609714e-03 3 1  ON 69
ci_071                -1.506070e-03 3 1  ON 70
ci_072                -1.813812e-04 3 1  ON 71
ci_073                 1.284792e-03 3 1  ON 72
ci_074                 1.550219e-03 3 1  ON 73
ci_075                -1.839067e-03 3 1  ON 74
ci_076                -1.229608e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.5769
    reference variance = 2.4701
====================================================
  Execution time = 2.3559e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7140e+00
  Total weights = 1.9499e+06
  Execution time = 4.3492e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766344465233
                                         uncertainty =       0.050910488492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766344465233
                                         uncertainty =       0.050910488492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372192737
  error estimate for blocks of size 2^( 2) =       0.001442416188
  error estimate for blocks of size 2^( 3) =       0.001504254992
  error estimate for blocks of size 2^( 4) =       0.001544330954
  error estimate for blocks of size 2^( 5) =       0.001568832267
  error estimate for blocks of size 2^( 6) =       0.001577358798
  error estimate for blocks of size 2^( 7) =       0.001585140162

      target function =                  N/A
              le_mean =     -22.328392099728
             les_mean =     502.271267817068
             stat err =       0.001568915545
             autocorr =       1.307280852102
              std dev =       1.940604627106
             le_variance =       3.765946318746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766257998063
                                         uncertainty =       0.050909960937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766257998063
                                         uncertainty =       0.050909960937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372177020
  error estimate for blocks of size 2^( 2) =       0.001442401276
  error estimate for blocks of size 2^( 3) =       0.001504245780
  error estimate for blocks of size 2^( 4) =       0.001544316032
  error estimate for blocks of size 2^( 5) =       0.001568819280
  error estimate for blocks of size 2^( 6) =       0.001577338325
  error estimate for blocks of size 2^( 7) =       0.001585112611

      target function =                  N/A
              le_mean =     -22.328395047360
             les_mean =     502.307302437740
             stat err =       0.001568896562
             autocorr =       1.307279162894
              std dev =       1.940582399969
             le_variance =       3.765860051070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766288575039
                                         uncertainty =       0.050910308946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766288575039
                                         uncertainty =       0.050910308946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372182576
  error estimate for blocks of size 2^( 2) =       0.001442407383
  error estimate for blocks of size 2^( 3) =       0.001504248395
  error estimate for blocks of size 2^( 4) =       0.001544322697
  error estimate for blocks of size 2^( 5) =       0.001568824731
  error estimate for blocks of size 2^( 6) =       0.001577347124
  error estimate for blocks of size 2^( 7) =       0.001585124172

      target function =                  N/A
              le_mean =     -22.328392158970
             les_mean =     502.275754974777
             stat err =       0.001568904681
             autocorr =       1.307282106871
              std dev =       1.940590257803
             le_variance =       3.765890548681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766336694317
                                         uncertainty =       0.050910468915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766336694317
                                         uncertainty =       0.050910468915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372191324
  error estimate for blocks of size 2^( 2) =       0.001442414975
  error estimate for blocks of size 2^( 3) =       0.001504254078
  error estimate for blocks of size 2^( 4) =       0.001544329707
  error estimate for blocks of size 2^( 5) =       0.001568831295
  error estimate for blocks of size 2^( 6) =       0.001577357951
  error estimate for blocks of size 2^( 7) =       0.001585139144

      target function =                  N/A
              le_mean =     -22.328391802539
             les_mean =     502.272004932758
             stat err =       0.001568914524
             autocorr =       1.307281842409
              std dev =       1.940602629088
             le_variance =       3.765938564022


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328392099728        initial
     8.8818e-01     8.8818e+00             4.2395e-04       -22.328395047360  <--
     3.5527e+00     3.5527e+01             1.1950e-04       -22.328392158970
     1.4211e+01     1.4211e+02             3.0885e-05       -22.328391802539

*****************************************************************************
Applying the update for shift_i =   8.8818e-01     and shift_s =   8.8818e+00
*****************************************************************************

  Execution time = 4.5385e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -6.890664e-01 3 1  ON 0
ci_002                -7.113805e-01 3 1  ON 1
ci_003                -6.265901e-02 3 1  ON 2
ci_004                -6.393006e-02 3 1  ON 3
ci_005                 4.554840e-02 3 1  ON 4
ci_006                 4.565169e-02 3 1  ON 5
ci_007                 3.217387e-02 3 1  ON 6
ci_008                 3.306011e-02 3 1  ON 7
ci_009                -2.515100e-02 3 1  ON 8
ci_010                -2.557609e-02 3 1  ON 9
ci_011                -2.178500e-02 3 1  ON 10
ci_012                -2.317639e-02 3 1  ON 11
ci_013                 1.982762e-02 3 1  ON 12
ci_014                 2.107122e-02 3 1  ON 13
ci_015                 1.917556e-02 3 1  ON 14
ci_016                 2.010391e-02 3 1  ON 15
ci_017                 1.562710e-02 3 1  ON 16
ci_018                 1.580645e-02 3 1  ON 17
ci_019                 1.049066e-02 3 1  ON 18
ci_020                 9.645595e-03 3 1  ON 19
ci_021                -1.002972e-02 3 1  ON 20
ci_022                -1.140885e-02 3 1  ON 21
ci_023                 8.252788e-03 3 1  ON 22
ci_024                 8.993748e-03 3 1  ON 23
ci_025                 7.792235e-03 3 1  ON 24
ci_026                 9.080708e-03 3 1  ON 25
ci_027                 7.396994e-03 3 1  ON 26
ci_028                 7.624761e-03 3 1  ON 27
ci_029                -6.795251e-03 3 1  ON 28
ci_030                -7.467003e-03 3 1  ON 29
ci_031                -7.206431e-03 3 1  ON 30
ci_032                -7.918830e-03 3 1  ON 31
ci_033                 6.386926e-03 3 1  ON 32
ci_034                 6.262073e-03 3 1  ON 33
ci_035                 7.026729e-03 3 1  ON 34
ci_036                 6.971874e-03 3 1  ON 35
ci_037                 5.762074e-03 3 1  ON 36
ci_038                 6.706988e-03 3 1  ON 37
ci_039                 4.948227e-03 3 1  ON 38
ci_040                 5.743160e-03 3 1  ON 39
ci_041                 5.323746e-03 3 1  ON 40
ci_042                 5.387861e-03 3 1  ON 41
ci_043                 4.941577e-03 3 1  ON 42
ci_044                 6.355286e-03 3 1  ON 43
ci_045                 5.318200e-03 3 1  ON 44
ci_046                 5.006957e-03 3 1  ON 45
ci_047                -4.213449e-03 3 1  ON 46
ci_048                -3.992669e-03 3 1  ON 47
ci_049                 3.535856e-03 3 1  ON 48
ci_050                 3.457583e-03 3 1  ON 49
ci_051                -3.284675e-03 3 1  ON 50
ci_052                -2.875087e-03 3 1  ON 51
ci_053                -1.796981e-03 3 1  ON 52
ci_054                -2.240944e-03 3 1  ON 53
ci_055                -1.802327e-03 3 1  ON 54
ci_056                -1.905330e-03 3 1  ON 55
ci_057                -2.100901e-03 3 1  ON 56
ci_058                -1.829567e-03 3 1  ON 57
ci_059                -2.272359e-03 3 1  ON 58
ci_060                -1.541929e-03 3 1  ON 59
ci_061                -1.831653e-03 3 1  ON 60
ci_062                -1.575471e-03 3 1  ON 61
ci_063                -6.026913e-04 3 1  ON 62
ci_064                -1.191019e-03 3 1  ON 63
ci_065                -2.059278e-03 3 1  ON 64
ci_066                -1.904827e-03 3 1  ON 65
ci_067                -1.304554e-04 3 1  ON 66
ci_068                -8.927347e-04 3 1  ON 67
ci_069                 2.264654e-03 3 1  ON 68
ci_070                 1.463373e-03 3 1  ON 69
ci_071                -1.604409e-03 3 1  ON 70
ci_072                -3.130436e-04 3 1  ON 71
ci_073                 1.224360e-03 3 1  ON 72
ci_074                 1.552572e-03 3 1  ON 73
ci_075                -1.785152e-03 3 1  ON 74
ci_076                -1.215002e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.473
    reference variance = 2.94797
====================================================
  Execution time = 2.4015e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0340e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7974e+00
  Total weights = 1.949762144e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8775e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.851134112030
                                         uncertainty =       0.069645431397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.851134112030
                                         uncertainty =       0.069645431397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387529708
  error estimate for blocks of size 2^( 2) =       0.001457911664
  error estimate for blocks of size 2^( 3) =       0.001518013568
  error estimate for blocks of size 2^( 4) =       0.001562193517
  error estimate for blocks of size 2^( 5) =       0.001587588974
  error estimate for blocks of size 2^( 6) =       0.001608900815
  error estimate for blocks of size 2^( 7) =       0.001614856028

      target function =                  N/A
              le_mean =     -22.326509397464
             les_mean =     502.270463542692
             stat err =       0.001593384834
             autocorr =       1.318732705033
              std dev =       1.962294727896
             le_variance =       3.850600599129


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232650939746e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326509396660       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326566633927       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326567215875       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326567114141       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e-01 is 1.066978e-03

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326509396660       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326532128843       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326532029190       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-01 is 4.671554e-04

solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326509396660       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326516060289       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326516024100       residual = 6.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+00 is 1.431600e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163107 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9900e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -6.891182e-01 3 1  ON 0
ci_002                -7.113267e-01 3 1  ON 1
ci_003                -6.267987e-02 3 1  ON 2
ci_004                -6.395070e-02 3 1  ON 3
ci_005                 4.553388e-02 3 1  ON 4
ci_006                 4.572459e-02 3 1  ON 5
ci_007                 3.190631e-02 3 1  ON 6
ci_008                 3.313359e-02 3 1  ON 7
ci_009                -2.505496e-02 3 1  ON 8
ci_010                -2.576876e-02 3 1  ON 9
ci_011                -2.196179e-02 3 1  ON 10
ci_012                -2.283792e-02 3 1  ON 11
ci_013                 1.953291e-02 3 1  ON 12
ci_014                 2.110522e-02 3 1  ON 13
ci_015                 1.936856e-02 3 1  ON 14
ci_016                 2.027862e-02 3 1  ON 15
ci_017                 1.547864e-02 3 1  ON 16
ci_018                 1.601925e-02 3 1  ON 17
ci_019                 1.038442e-02 3 1  ON 18
ci_020                 9.525588e-03 3 1  ON 19
ci_021                -1.016408e-02 3 1  ON 20
ci_022                -1.147281e-02 3 1  ON 21
ci_023                 8.267817e-03 3 1  ON 22
ci_024                 8.938320e-03 3 1  ON 23
ci_025                 7.701249e-03 3 1  ON 24
ci_026                 9.023269e-03 3 1  ON 25
ci_027                 7.864149e-03 3 1  ON 26
ci_028                 7.580641e-03 3 1  ON 27
ci_029                -6.900153e-03 3 1  ON 28
ci_030                -7.670610e-03 3 1  ON 29
ci_031                -7.251798e-03 3 1  ON 30
ci_032                -7.970559e-03 3 1  ON 31
ci_033                 6.256918e-03 3 1  ON 32
ci_034                 6.308803e-03 3 1  ON 33
ci_035                 6.893387e-03 3 1  ON 34
ci_036                 6.908450e-03 3 1  ON 35
ci_037                 5.926822e-03 3 1  ON 36
ci_038                 6.579076e-03 3 1  ON 37
ci_039                 5.053125e-03 3 1  ON 38
ci_040                 5.551769e-03 3 1  ON 39
ci_041                 5.298284e-03 3 1  ON 40
ci_042                 5.514738e-03 3 1  ON 41
ci_043                 4.936414e-03 3 1  ON 42
ci_044                 6.107025e-03 3 1  ON 43
ci_045                 5.432325e-03 3 1  ON 44
ci_046                 4.959497e-03 3 1  ON 45
ci_047                -4.616079e-03 3 1  ON 46
ci_048                -4.033604e-03 3 1  ON 47
ci_049                 3.488913e-03 3 1  ON 48
ci_050                 3.472433e-03 3 1  ON 49
ci_051                -3.122347e-03 3 1  ON 50
ci_052                -2.780233e-03 3 1  ON 51
ci_053                -1.935895e-03 3 1  ON 52
ci_054                -1.890496e-03 3 1  ON 53
ci_055                -2.044391e-03 3 1  ON 54
ci_056                -1.930059e-03 3 1  ON 55
ci_057                -2.220491e-03 3 1  ON 56
ci_058                -1.750662e-03 3 1  ON 57
ci_059                -2.307189e-03 3 1  ON 58
ci_060                -1.921329e-03 3 1  ON 59
ci_061                -1.896679e-03 3 1  ON 60
ci_062                -1.701220e-03 3 1  ON 61
ci_063                -5.590315e-04 3 1  ON 62
ci_064                -1.199895e-03 3 1  ON 63
ci_065                -1.824553e-03 3 1  ON 64
ci_066                -1.884641e-03 3 1  ON 65
ci_067                -3.334168e-04 3 1  ON 66
ci_068                -1.068205e-03 3 1  ON 67
ci_069                 2.083756e-03 3 1  ON 68
ci_070                 1.630007e-03 3 1  ON 69
ci_071                -1.247420e-03 3 1  ON 70
ci_072                -5.444581e-04 3 1  ON 71
ci_073                 1.031774e-03 3 1  ON 72
ci_074                 1.572558e-03 3 1  ON 73
ci_075                -1.702275e-03 3 1  ON 74
ci_076                -1.194578e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.1056
    reference variance = 6.80004
====================================================
  Execution time = 2.3585e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7392e+00
  Total weights = 1.9502e+06
  Execution time = 4.3557e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792079701010
                                         uncertainty =       0.033007051934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792079701010
                                         uncertainty =       0.033007051934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376909157
  error estimate for blocks of size 2^( 2) =       0.001447348888
  error estimate for blocks of size 2^( 3) =       0.001509228090
  error estimate for blocks of size 2^( 4) =       0.001554589300
  error estimate for blocks of size 2^( 5) =       0.001578941212
  error estimate for blocks of size 2^( 6) =       0.001590134702
  error estimate for blocks of size 2^( 7) =       0.001603450835

      target function =                  N/A
              le_mean =     -22.326303354528
             les_mean =     502.203546409610
             stat err =       0.001581779012
             autocorr =       1.319717699145
              std dev =       1.947274760096
             le_variance =       3.791878991307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792165769155
                                         uncertainty =       0.033015013017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792165769155
                                         uncertainty =       0.033015013017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376925199
  error estimate for blocks of size 2^( 2) =       0.001447370858
  error estimate for blocks of size 2^( 3) =       0.001509246116
  error estimate for blocks of size 2^( 4) =       0.001554622597
  error estimate for blocks of size 2^( 5) =       0.001578989930
  error estimate for blocks of size 2^( 6) =       0.001590169029
  error estimate for blocks of size 2^( 7) =       0.001603454735

      target function =                  N/A
              le_mean =     -22.326303752991
             les_mean =     502.215349418032
             stat err =       0.001581809073
             autocorr =       1.319737107763
              std dev =       1.947297447397
             le_variance =       3.791967348641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792125571192
                                         uncertainty =       0.033013405773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792125571192
                                         uncertainty =       0.033013405773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376917848
  error estimate for blocks of size 2^( 2) =       0.001447360754
  error estimate for blocks of size 2^( 3) =       0.001509238486
  error estimate for blocks of size 2^( 4) =       0.001554610331
  error estimate for blocks of size 2^( 5) =       0.001578966873
  error estimate for blocks of size 2^( 6) =       0.001590151033
  error estimate for blocks of size 2^( 7) =       0.001603451442

      target function =                  N/A
              le_mean =     -22.326301016881
             les_mean =     502.217457123754
             stat err =       0.001581794920
             autocorr =       1.319727583248
              std dev =       1.947287050790
             le_variance =       3.791926858174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792076285512
                                         uncertainty =       0.033007999700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.792076285512
                                         uncertainty =       0.033007999700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376908594
  error estimate for blocks of size 2^( 2) =       0.001447349324
  error estimate for blocks of size 2^( 3) =       0.001509227980
  error estimate for blocks of size 2^( 4) =       0.001554591233
  error estimate for blocks of size 2^( 5) =       0.001578942084
  error estimate for blocks of size 2^( 6) =       0.001590128266
  error estimate for blocks of size 2^( 7) =       0.001603441446

      target function =                  N/A
              le_mean =     -22.326301626416
             les_mean =     502.230476778460
             stat err =       0.001581775757
             autocorr =       1.319713346413
              std dev =       1.947273963837
             le_variance =       3.791875890239


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326303354528        initial
     2.2204e-01     2.2204e+00             1.0670e-03       -22.326303752991  <--
     8.8818e-01     8.8818e+00             4.6716e-04       -22.326301016881
     3.5527e+00     3.5527e+01             1.4316e-04       -22.326301626416

*****************************************************************************
Applying the update for shift_i =   2.2204e-01     and shift_s =   2.2204e+00
*****************************************************************************

  Execution time = 4.5506e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -6.892534e-01 3 1  ON 0
ci_002                -7.111870e-01 3 1  ON 1
ci_003                -6.273988e-02 3 1  ON 2
ci_004                -6.399434e-02 3 1  ON 3
ci_005                 4.552720e-02 3 1  ON 4
ci_006                 4.581849e-02 3 1  ON 5
ci_007                 3.143993e-02 3 1  ON 6
ci_008                 3.324372e-02 3 1  ON 7
ci_009                -2.492461e-02 3 1  ON 8
ci_010                -2.612666e-02 3 1  ON 9
ci_011                -2.227642e-02 3 1  ON 10
ci_012                -2.224833e-02 3 1  ON 11
ci_013                 1.902418e-02 3 1  ON 12
ci_014                 2.118373e-02 3 1  ON 13
ci_015                 1.972919e-02 3 1  ON 14
ci_016                 2.065829e-02 3 1  ON 15
ci_017                 1.518935e-02 3 1  ON 16
ci_018                 1.637568e-02 3 1  ON 17
ci_019                 1.018786e-02 3 1  ON 18
ci_020                 9.306613e-03 3 1  ON 19
ci_021                -1.040805e-02 3 1  ON 20
ci_022                -1.156212e-02 3 1  ON 21
ci_023                 8.271387e-03 3 1  ON 22
ci_024                 8.854519e-03 3 1  ON 23
ci_025                 7.571247e-03 3 1  ON 24
ci_026                 8.906160e-03 3 1  ON 25
ci_027                 8.463972e-03 3 1  ON 26
ci_028                 7.528462e-03 3 1  ON 27
ci_029                -7.108694e-03 3 1  ON 28
ci_030                -8.053349e-03 3 1  ON 29
ci_031                -7.294587e-03 3 1  ON 30
ci_032                -8.067730e-03 3 1  ON 31
ci_033                 6.015655e-03 3 1  ON 32
ci_034                 6.417009e-03 3 1  ON 33
ci_035                 6.708142e-03 3 1  ON 34
ci_036                 6.821384e-03 3 1  ON 35
ci_037                 6.170509e-03 3 1  ON 36
ci_038                 6.358583e-03 3 1  ON 37
ci_039                 5.178726e-03 3 1  ON 38
ci_040                 5.304949e-03 3 1  ON 39
ci_041                 5.266121e-03 3 1  ON 40
ci_042                 5.700524e-03 3 1  ON 41
ci_043                 4.905957e-03 3 1  ON 42
ci_044                 5.677181e-03 3 1  ON 43
ci_045                 5.641550e-03 3 1  ON 44
ci_046                 4.858598e-03 3 1  ON 45
ci_047                -5.124609e-03 3 1  ON 46
ci_048                -4.115024e-03 3 1  ON 47
ci_049                 3.409628e-03 3 1  ON 48
ci_050                 3.506330e-03 3 1  ON 49
ci_051                -2.848175e-03 3 1  ON 50
ci_052                -2.594479e-03 3 1  ON 51
ci_053                -2.122961e-03 3 1  ON 52
ci_054                -1.330901e-03 3 1  ON 53
ci_055                -2.473948e-03 3 1  ON 54
ci_056                -1.942765e-03 3 1  ON 55
ci_057                -2.399076e-03 3 1  ON 56
ci_058                -1.626249e-03 3 1  ON 57
ci_059                -2.335340e-03 3 1  ON 58
ci_060                -2.405618e-03 3 1  ON 59
ci_061                -1.983813e-03 3 1  ON 60
ci_062                -1.900536e-03 3 1  ON 61
ci_063                -5.078589e-04 3 1  ON 62
ci_064                -1.223107e-03 3 1  ON 63
ci_065                -1.429301e-03 3 1  ON 64
ci_066                -1.850365e-03 3 1  ON 65
ci_067                -6.665119e-04 3 1  ON 66
ci_068                -1.390112e-03 3 1  ON 67
ci_069                 1.781178e-03 3 1  ON 68
ci_070                 1.890471e-03 3 1  ON 69
ci_071                -6.623962e-04 3 1  ON 70
ci_072                -9.513517e-04 3 1  ON 71
ci_073                 7.818114e-04 3 1  ON 72
ci_074                 1.584272e-03 3 1  ON 73
ci_075                -1.584870e-03 3 1  ON 74
ci_076                -1.134585e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5414e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.2298
    reference variance = 4.07994
====================================================
  Execution time = 2.4178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0332e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7357e+00
  Total weights = 1.949671783e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8534e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789029399499
                                         uncertainty =       0.036055249667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789029399499
                                         uncertainty =       0.036055249667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376323406
  error estimate for blocks of size 2^( 2) =       0.001448119198
  error estimate for blocks of size 2^( 3) =       0.001512781869
  error estimate for blocks of size 2^( 4) =       0.001556107200
  error estimate for blocks of size 2^( 5) =       0.001582830097
  error estimate for blocks of size 2^( 6) =       0.001596529600
  error estimate for blocks of size 2^( 7) =       0.001602884372

      target function =                  N/A
              le_mean =     -22.327630942905
             les_mean =     502.258836380424
             stat err =       0.001584587817
             autocorr =       1.325536325726
              std dev =       1.946446369554
             le_variance =       3.788653469551


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232763094291e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-02, overlap shift 5.5511e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327630942116       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327694739457       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327703779426       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327704034506       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327705475488       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327705375826       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327705262003       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327705372649       residual = 1.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e-02 is 2.699315e-03

solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327630942116       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327668390094       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327670493133       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327670323916       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327670417806       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e-01 is 1.241869e-03

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327630942116       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327645062319       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327645239716       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-01 is 4.288497e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165163 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0039e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -6.889846e-01 3 1  ON 0
ci_002                -7.116203e-01 3 1  ON 1
ci_003                -6.173963e-02 3 1  ON 2
ci_004                -6.336199e-02 3 1  ON 3
ci_005                 4.454475e-02 3 1  ON 4
ci_006                 4.636790e-02 3 1  ON 5
ci_007                 3.138531e-02 3 1  ON 6
ci_008                 3.341388e-02 3 1  ON 7
ci_009                -2.496762e-02 3 1  ON 8
ci_010                -2.566426e-02 3 1  ON 9
ci_011                -2.267656e-02 3 1  ON 10
ci_012                -2.311281e-02 3 1  ON 11
ci_013                 1.920238e-02 3 1  ON 12
ci_014                 2.105486e-02 3 1  ON 13
ci_015                 1.891124e-02 3 1  ON 14
ci_016                 2.088616e-02 3 1  ON 15
ci_017                 1.519227e-02 3 1  ON 16
ci_018                 1.652864e-02 3 1  ON 17
ci_019                 1.022958e-02 3 1  ON 18
ci_020                 9.698182e-03 3 1  ON 19
ci_021                -9.903461e-03 3 1  ON 20
ci_022                -1.032025e-02 3 1  ON 21
ci_023                 8.574717e-03 3 1  ON 22
ci_024                 9.250210e-03 3 1  ON 23
ci_025                 7.747232e-03 3 1  ON 24
ci_026                 9.423904e-03 3 1  ON 25
ci_027                 8.482824e-03 3 1  ON 26
ci_028                 7.621265e-03 3 1  ON 27
ci_029                -6.937621e-03 3 1  ON 28
ci_030                -8.109697e-03 3 1  ON 29
ci_031                -7.315744e-03 3 1  ON 30
ci_032                -8.163217e-03 3 1  ON 31
ci_033                 6.160068e-03 3 1  ON 32
ci_034                 6.476824e-03 3 1  ON 33
ci_035                 6.603808e-03 3 1  ON 34
ci_036                 7.263974e-03 3 1  ON 35
ci_037                 6.038560e-03 3 1  ON 36
ci_038                 5.745998e-03 3 1  ON 37
ci_039                 5.432757e-03 3 1  ON 38
ci_040                 5.692514e-03 3 1  ON 39
ci_041                 5.250252e-03 3 1  ON 40
ci_042                 5.379877e-03 3 1  ON 41
ci_043                 4.695015e-03 3 1  ON 42
ci_044                 5.708021e-03 3 1  ON 43
ci_045                 5.261832e-03 3 1  ON 44
ci_046                 4.760461e-03 3 1  ON 45
ci_047                -4.528816e-03 3 1  ON 46
ci_048                -4.196832e-03 3 1  ON 47
ci_049                 3.525660e-03 3 1  ON 48
ci_050                 3.180477e-03 3 1  ON 49
ci_051                -2.685923e-03 3 1  ON 50
ci_052                -2.539465e-03 3 1  ON 51
ci_053                -1.939731e-03 3 1  ON 52
ci_054                -1.663767e-03 3 1  ON 53
ci_055                -2.239434e-03 3 1  ON 54
ci_056                -1.808477e-03 3 1  ON 55
ci_057                -2.601102e-03 3 1  ON 56
ci_058                -1.669518e-03 3 1  ON 57
ci_059                -2.421446e-03 3 1  ON 58
ci_060                -2.583772e-03 3 1  ON 59
ci_061                -1.235080e-03 3 1  ON 60
ci_062                -2.015573e-03 3 1  ON 61
ci_063                -3.586841e-04 3 1  ON 62
ci_064                -5.455414e-04 3 1  ON 63
ci_065                -1.662401e-03 3 1  ON 64
ci_066                -1.656171e-03 3 1  ON 65
ci_067                -3.635632e-04 3 1  ON 66
ci_068                -1.041373e-03 3 1  ON 67
ci_069                 1.725247e-03 3 1  ON 68
ci_070                 2.035592e-03 3 1  ON 69
ci_071                -1.147988e-03 3 1  ON 70
ci_072                -7.728882e-04 3 1  ON 71
ci_073                 9.075962e-04 3 1  ON 72
ci_074                 1.744974e-03 3 1  ON 73
ci_075                -5.274931e-04 3 1  ON 74
ci_076                -1.428520e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.3027
    reference variance = 2.83425
====================================================
  Execution time = 2.3605e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7858e+00
  Total weights = 1.9496e+06
  Execution time = 4.3711e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841486860400
                                         uncertainty =       0.078313878854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.841486860400
                                         uncertainty =       0.078313878854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385877720
  error estimate for blocks of size 2^( 2) =       0.001455787732
  error estimate for blocks of size 2^( 3) =       0.001518440301
  error estimate for blocks of size 2^( 4) =       0.001560888530
  error estimate for blocks of size 2^( 5) =       0.001587582536
  error estimate for blocks of size 2^( 6) =       0.001599016752
  error estimate for blocks of size 2^( 7) =       0.001604850088

      target function =                  N/A
              le_mean =     -22.329867844645
             les_mean =     507.960336293832
             stat err =       0.001588084476
             autocorr =       1.313098712133
              std dev =       1.959958425720
             le_variance =       3.841437030551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837317406001
                                         uncertainty =       0.077754587850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837317406001
                                         uncertainty =       0.077754587850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385127224
  error estimate for blocks of size 2^( 2) =       0.001455065747
  error estimate for blocks of size 2^( 3) =       0.001517786129
  error estimate for blocks of size 2^( 4) =       0.001560328485
  error estimate for blocks of size 2^( 5) =       0.001586971385
  error estimate for blocks of size 2^( 6) =       0.001598443113
  error estimate for blocks of size 2^( 7) =       0.001604424976

      target function =                  N/A
              le_mean =     -22.329904113840
             les_mean =     502.411056043814
             stat err =       0.001587541990
             autocorr =       1.313624111841
              std dev =       1.958897047679
             le_variance =       3.837277643406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837394486150
                                         uncertainty =       0.077763522235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837394486150
                                         uncertainty =       0.077763522235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385140919
  error estimate for blocks of size 2^( 2) =       0.001455080285
  error estimate for blocks of size 2^( 3) =       0.001517811003
  error estimate for blocks of size 2^( 4) =       0.001560349008
  error estimate for blocks of size 2^( 5) =       0.001586993666
  error estimate for blocks of size 2^( 6) =       0.001598472547
  error estimate for blocks of size 2^( 7) =       0.001604442133

      target function =                  N/A
              le_mean =     -22.329905226398
             les_mean =     502.415691977939
             stat err =       0.001587564339
             autocorr =       1.313635121472
              std dev =       1.958916415616
             le_variance =       3.837353523371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837303489006
                                         uncertainty =       0.077725661972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.837303489006
                                         uncertainty =       0.077725661972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001385125233
  error estimate for blocks of size 2^( 2) =       0.001455053885
  error estimate for blocks of size 2^( 3) =       0.001517751129
  error estimate for blocks of size 2^( 4) =       0.001560277091
  error estimate for blocks of size 2^( 5) =       0.001586933754
  error estimate for blocks of size 2^( 6) =       0.001598402115
  error estimate for blocks of size 2^( 7) =       0.001604345724

      target function =                  N/A
              le_mean =     -22.329898610418
             les_mean =     502.420024691501
             stat err =       0.001587489671
             autocorr =       1.313541306305
              std dev =       1.958894232320
             le_variance =       3.837266613415


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329867844645        initial
     5.5511e-02     5.5511e-01             2.6993e-03       -22.329904113840
     2.2204e-01     2.2204e+00             1.2419e-03       -22.329905226398  <--
     8.8818e-01     8.8818e+00             4.2885e-04       -22.329898610418

*****************************************************************************
Applying the update for shift_i =   2.2204e-01     and shift_s =   2.2204e+00
*****************************************************************************

  Execution time = 4.8545e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -6.889846e-01 3 1  ON 0
ci_002                -7.116203e-01 3 1  ON 1
ci_003                -6.173963e-02 3 1  ON 2
ci_004                -6.336199e-02 3 1  ON 3
ci_005                 4.454475e-02 3 1  ON 4
ci_006                 4.636790e-02 3 1  ON 5
ci_007                 3.138531e-02 3 1  ON 6
ci_008                 3.341388e-02 3 1  ON 7
ci_009                -2.496762e-02 3 1  ON 8
ci_010                -2.566426e-02 3 1  ON 9
ci_011                -2.267656e-02 3 1  ON 10
ci_012                -2.311281e-02 3 1  ON 11
ci_013                 1.920238e-02 3 1  ON 12
ci_014                 2.105486e-02 3 1  ON 13
ci_015                 1.891124e-02 3 1  ON 14
ci_016                 2.088616e-02 3 1  ON 15
ci_017                 1.519227e-02 3 1  ON 16
ci_018                 1.652864e-02 3 1  ON 17
ci_019                 1.022958e-02 3 1  ON 18
ci_020                 9.698182e-03 3 1  ON 19
ci_021                -9.903461e-03 3 1  ON 20
ci_022                -1.032025e-02 3 1  ON 21
ci_023                 8.574717e-03 3 1  ON 22
ci_024                 9.250210e-03 3 1  ON 23
ci_025                 7.747232e-03 3 1  ON 24
ci_026                 9.423904e-03 3 1  ON 25
ci_027                 8.482824e-03 3 1  ON 26
ci_028                 7.621265e-03 3 1  ON 27
ci_029                -6.937621e-03 3 1  ON 28
ci_030                -8.109697e-03 3 1  ON 29
ci_031                -7.315744e-03 3 1  ON 30
ci_032                -8.163217e-03 3 1  ON 31
ci_033                 6.160068e-03 3 1  ON 32
ci_034                 6.476824e-03 3 1  ON 33
ci_035                 6.603808e-03 3 1  ON 34
ci_036                 7.263974e-03 3 1  ON 35
ci_037                 6.038560e-03 3 1  ON 36
ci_038                 5.745998e-03 3 1  ON 37
ci_039                 5.432757e-03 3 1  ON 38
ci_040                 5.692514e-03 3 1  ON 39
ci_041                 5.250252e-03 3 1  ON 40
ci_042                 5.379877e-03 3 1  ON 41
ci_043                 4.695015e-03 3 1  ON 42
ci_044                 5.708021e-03 3 1  ON 43
ci_045                 5.261832e-03 3 1  ON 44
ci_046                 4.760461e-03 3 1  ON 45
ci_047                -4.528816e-03 3 1  ON 46
ci_048                -4.196832e-03 3 1  ON 47
ci_049                 3.525660e-03 3 1  ON 48
ci_050                 3.180477e-03 3 1  ON 49
ci_051                -2.685923e-03 3 1  ON 50
ci_052                -2.539465e-03 3 1  ON 51
ci_053                -1.939731e-03 3 1  ON 52
ci_054                -1.663767e-03 3 1  ON 53
ci_055                -2.239434e-03 3 1  ON 54
ci_056                -1.808477e-03 3 1  ON 55
ci_057                -2.601102e-03 3 1  ON 56
ci_058                -1.669518e-03 3 1  ON 57
ci_059                -2.421446e-03 3 1  ON 58
ci_060                -2.583772e-03 3 1  ON 59
ci_061                -1.235080e-03 3 1  ON 60
ci_062                -2.015573e-03 3 1  ON 61
ci_063                -3.586841e-04 3 1  ON 62
ci_064                -5.455414e-04 3 1  ON 63
ci_065                -1.662401e-03 3 1  ON 64
ci_066                -1.656171e-03 3 1  ON 65
ci_067                -3.635632e-04 3 1  ON 66
ci_068                -1.041373e-03 3 1  ON 67
ci_069                 1.725247e-03 3 1  ON 68
ci_070                 2.035592e-03 3 1  ON 69
ci_071                -1.147988e-03 3 1  ON 70
ci_072                -7.728882e-04 3 1  ON 71
ci_073                 9.075962e-04 3 1  ON 72
ci_074                 1.744974e-03 3 1  ON 73
ci_075                -5.274931e-04 3 1  ON 74
ci_076                -1.428520e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2312e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7276
    reference variance = 2.54179
====================================================
  Execution time = 2.4224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0330e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7535e+00
  Total weights = 1.949418965e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9378e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807797140039
                                         uncertainty =       0.044422520467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.807797140039
                                         uncertainty =       0.044422520467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379713198
  error estimate for blocks of size 2^( 2) =       0.001450553983
  error estimate for blocks of size 2^( 3) =       0.001513524640
  error estimate for blocks of size 2^( 4) =       0.001555609054
  error estimate for blocks of size 2^( 5) =       0.001578254112
  error estimate for blocks of size 2^( 6) =       0.001590577382
  error estimate for blocks of size 2^( 7) =       0.001597810585

      target function =                  N/A
              le_mean =     -22.328854540407
             les_mean =     502.331270300772
             stat err =       0.001580562784
             autocorr =       1.312338488080
              std dev =       1.951240336116
             le_variance =       3.807338849287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232885454041e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-02, overlap shift 5.5511e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328854539636       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328915627888       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328920045714       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328918728995       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328919122454       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328918881620       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328919032796       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e-02 is 1.806286e-03

solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328854539636       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328891041872       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328892223626       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328891879609       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e-01 is 9.594725e-04

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328854539636       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328868525781       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328868698228       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-01 is 3.554745e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0169e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -6.891112e-01 3 1  ON 0
ci_002                -7.115985e-01 3 1  ON 1
ci_003                -6.185683e-02 3 1  ON 2
ci_004                -6.267631e-02 3 1  ON 3
ci_005                 4.500831e-02 3 1  ON 4
ci_006                 4.640454e-02 3 1  ON 5
ci_007                 3.164867e-02 3 1  ON 6
ci_008                 3.286246e-02 3 1  ON 7
ci_009                -2.464311e-02 3 1  ON 8
ci_010                -2.517856e-02 3 1  ON 9
ci_011                -2.241576e-02 3 1  ON 10
ci_012                -2.277967e-02 3 1  ON 11
ci_013                 1.869996e-02 3 1  ON 12
ci_014                 2.142054e-02 3 1  ON 13
ci_015                 1.884301e-02 3 1  ON 14
ci_016                 2.085206e-02 3 1  ON 15
ci_017                 1.507011e-02 3 1  ON 16
ci_018                 1.644609e-02 3 1  ON 17
ci_019                 1.009109e-02 3 1  ON 18
ci_020                 9.734074e-03 3 1  ON 19
ci_021                -9.429066e-03 3 1  ON 20
ci_022                -1.083798e-02 3 1  ON 21
ci_023                 8.754631e-03 3 1  ON 22
ci_024                 8.632525e-03 3 1  ON 23
ci_025                 7.896976e-03 3 1  ON 24
ci_026                 9.180423e-03 3 1  ON 25
ci_027                 8.191576e-03 3 1  ON 26
ci_028                 7.407881e-03 3 1  ON 27
ci_029                -7.391463e-03 3 1  ON 28
ci_030                -8.172673e-03 3 1  ON 29
ci_031                -8.054769e-03 3 1  ON 30
ci_032                -7.544805e-03 3 1  ON 31
ci_033                 6.764473e-03 3 1  ON 32
ci_034                 6.849655e-03 3 1  ON 33
ci_035                 6.757267e-03 3 1  ON 34
ci_036                 7.279644e-03 3 1  ON 35
ci_037                 6.318428e-03 3 1  ON 36
ci_038                 5.809280e-03 3 1  ON 37
ci_039                 5.857876e-03 3 1  ON 38
ci_040                 5.658792e-03 3 1  ON 39
ci_041                 5.643200e-03 3 1  ON 40
ci_042                 5.211031e-03 3 1  ON 41
ci_043                 4.479469e-03 3 1  ON 42
ci_044                 5.203089e-03 3 1  ON 43
ci_045                 4.875555e-03 3 1  ON 44
ci_046                 5.042700e-03 3 1  ON 45
ci_047                -3.974666e-03 3 1  ON 46
ci_048                -3.778612e-03 3 1  ON 47
ci_049                 3.239521e-03 3 1  ON 48
ci_050                 3.057127e-03 3 1  ON 49
ci_051                -2.478225e-03 3 1  ON 50
ci_052                -3.277966e-03 3 1  ON 51
ci_053                -2.899203e-03 3 1  ON 52
ci_054                -1.087352e-03 3 1  ON 53
ci_055                -1.879245e-03 3 1  ON 54
ci_056                -1.241191e-03 3 1  ON 55
ci_057                -2.534963e-03 3 1  ON 56
ci_058                -2.403396e-03 3 1  ON 57
ci_059                -2.088351e-03 3 1  ON 58
ci_060                -2.424673e-03 3 1  ON 59
ci_061                -1.181403e-03 3 1  ON 60
ci_062                -1.428306e-03 3 1  ON 61
ci_063                -4.297252e-04 3 1  ON 62
ci_064                -7.620700e-04 3 1  ON 63
ci_065                -1.439427e-03 3 1  ON 64
ci_066                -1.627395e-03 3 1  ON 65
ci_067                -1.013109e-03 3 1  ON 66
ci_068                -9.628313e-04 3 1  ON 67
ci_069                 1.278778e-03 3 1  ON 68
ci_070                 1.553891e-03 3 1  ON 69
ci_071                -7.512972e-04 3 1  ON 70
ci_072                -1.196258e-03 3 1  ON 71
ci_073                 7.252830e-04 3 1  ON 72
ci_074                 1.874670e-03 3 1  ON 73
ci_075                -7.507192e-04 3 1  ON 74
ci_076                -1.435514e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.3687
    reference variance = 3.24166
====================================================
  Execution time = 2.3731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7148e+00
  Total weights = 1.9502e+06
  Execution time = 4.4610e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763015561857
                                         uncertainty =       0.027882271571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763015561857
                                         uncertainty =       0.027882271571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371671188
  error estimate for blocks of size 2^( 2) =       0.001442735993
  error estimate for blocks of size 2^( 3) =       0.001504694832
  error estimate for blocks of size 2^( 4) =       0.001545441936
  error estimate for blocks of size 2^( 5) =       0.001568024841
  error estimate for blocks of size 2^( 6) =       0.001577953469
  error estimate for blocks of size 2^( 7) =       0.001586663050

      target function =                  N/A
              le_mean =     -22.327132385960
             les_mean =     502.217844656721
             stat err =       0.001569520824
             autocorr =       1.309284817806
              std dev =       1.939867033751
             le_variance =       3.763084108633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763098258807
                                         uncertainty =       0.027964451813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763098258807
                                         uncertainty =       0.027964451813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371685804
  error estimate for blocks of size 2^( 2) =       0.001442754339
  error estimate for blocks of size 2^( 3) =       0.001504705100
  error estimate for blocks of size 2^( 4) =       0.001545457171
  error estimate for blocks of size 2^( 5) =       0.001568023459
  error estimate for blocks of size 2^( 6) =       0.001577861149
  error estimate for blocks of size 2^( 7) =       0.001586544582

      target function =                  N/A
              le_mean =     -22.327127491804
             les_mean =     502.391704943345
             stat err =       0.001569471590
             autocorr =       1.309174776530
              std dev =       1.939887704844
             le_variance =       3.763164307405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762839241221
                                         uncertainty =       0.027901273797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.762839241221
                                         uncertainty =       0.027901273797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371638622
  error estimate for blocks of size 2^( 2) =       0.001442701861
  error estimate for blocks of size 2^( 3) =       0.001504658992
  error estimate for blocks of size 2^( 4) =       0.001545412959
  error estimate for blocks of size 2^( 5) =       0.001567984443
  error estimate for blocks of size 2^( 6) =       0.001577914397
  error estimate for blocks of size 2^( 7) =       0.001586598661

      target function =                  N/A
              le_mean =     -22.327122350861
             les_mean =     502.224072082390
             stat err =       0.001569477615
             autocorr =       1.309274897487
              std dev =       1.939820977730
             le_variance =       3.762905425642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763787408359
                                         uncertainty =       0.027982704985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763787408359
                                         uncertainty =       0.027982704985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371811424
  error estimate for blocks of size 2^( 2) =       0.001442865620
  error estimate for blocks of size 2^( 3) =       0.001504831360
  error estimate for blocks of size 2^( 4) =       0.001545585196
  error estimate for blocks of size 2^( 5) =       0.001568134105
  error estimate for blocks of size 2^( 6) =       0.001578022564
  error estimate for blocks of size 2^( 7) =       0.001586776376

      target function =                  N/A
              le_mean =     -22.327141998280
             les_mean =     502.719906705198
             stat err =       0.001569629560
             autocorr =       1.309198526281
              std dev =       1.940065360660
             le_variance =       3.763853603633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327132385960        initial
     5.5511e-02     5.5511e-01             1.8063e-03       -22.327127491804
     2.2204e-01     2.2204e+00             9.5947e-04       -22.327122350861
     8.8818e-01     8.8818e+00             3.5547e-04       -22.327141998280  <--

*****************************************************************************
Applying the update for shift_i =   8.8818e-01     and shift_s =   8.8818e+00
*****************************************************************************

  Execution time = 4.6129e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -6.890136e-01 3 1  ON 0
ci_002                -7.116257e-01 3 1  ON 1
ci_003                -6.176588e-02 3 1  ON 2
ci_004                -6.315881e-02 3 1  ON 3
ci_005                 4.473209e-02 3 1  ON 4
ci_006                 4.638080e-02 3 1  ON 5
ci_007                 3.149125e-02 3 1  ON 6
ci_008                 3.319624e-02 3 1  ON 7
ci_009                -2.485076e-02 3 1  ON 8
ci_010                -2.547865e-02 3 1  ON 9
ci_011                -2.259774e-02 3 1  ON 10
ci_012                -2.298944e-02 3 1  ON 11
ci_013                 1.902248e-02 3 1  ON 12
ci_014                 2.117713e-02 3 1  ON 13
ci_015                 1.888468e-02 3 1  ON 14
ci_016                 2.087308e-02 3 1  ON 15
ci_017                 1.514442e-02 3 1  ON 16
ci_018                 1.650880e-02 3 1  ON 17
ci_019                 1.018757e-02 3 1  ON 18
ci_020                 9.700015e-03 3 1  ON 19
ci_021                -9.753769e-03 3 1  ON 20
ci_022                -1.048904e-02 3 1  ON 21
ci_023                 8.644394e-03 3 1  ON 22
ci_024                 9.012257e-03 3 1  ON 23
ci_025                 7.789422e-03 3 1  ON 24
ci_026                 9.340808e-03 3 1  ON 25
ci_027                 8.358688e-03 3 1  ON 26
ci_028                 7.527237e-03 3 1  ON 27
ci_029                -7.107572e-03 3 1  ON 28
ci_030                -8.138250e-03 3 1  ON 29
ci_031                -7.570765e-03 3 1  ON 30
ci_032                -7.948982e-03 3 1  ON 31
ci_033                 6.371008e-03 3 1  ON 32
ci_034                 6.616731e-03 3 1  ON 33
ci_035                 6.668520e-03 3 1  ON 34
ci_036                 7.277308e-03 3 1  ON 35
ci_037                 6.148877e-03 3 1  ON 36
ci_038                 5.766508e-03 3 1  ON 37
ci_039                 5.616869e-03 3 1  ON 38
ci_040                 5.672278e-03 3 1  ON 39
ci_041                 5.411993e-03 3 1  ON 40
ci_042                 5.304410e-03 3 1  ON 41
ci_043                 4.634855e-03 3 1  ON 42
ci_044                 5.513793e-03 3 1  ON 43
ci_045                 5.132440e-03 3 1  ON 44
ci_046                 4.870792e-03 3 1  ON 45
ci_047                -4.290236e-03 3 1  ON 46
ci_048                -4.017866e-03 3 1  ON 47
ci_049                 3.426597e-03 3 1  ON 48
ci_050                 3.140303e-03 3 1  ON 49
ci_051                -2.604554e-03 3 1  ON 50
ci_052                -2.824678e-03 3 1  ON 51
ci_053                -2.295205e-03 3 1  ON 52
ci_054                -1.447872e-03 3 1  ON 53
ci_055                -2.115279e-03 3 1  ON 54
ci_056                -1.607640e-03 3 1  ON 55
ci_057                -2.576823e-03 3 1  ON 56
ci_058                -1.954535e-03 3 1  ON 57
ci_059                -2.286244e-03 3 1  ON 58
ci_060                -2.514634e-03 3 1  ON 59
ci_061                -1.215995e-03 3 1  ON 60
ci_062                -1.777905e-03 3 1  ON 61
ci_063                -3.803138e-04 3 1  ON 62
ci_064                -6.251202e-04 3 1  ON 63
ci_065                -1.589206e-03 3 1  ON 64
ci_066                -1.657516e-03 3 1  ON 65
ci_067                -6.006992e-04 3 1  ON 66
ci_068                -1.002064e-03 3 1  ON 67
ci_069                 1.549140e-03 3 1  ON 68
ci_070                 1.863689e-03 3 1  ON 69
ci_071                -9.912416e-04 3 1  ON 70
ci_072                -9.446099e-04 3 1  ON 71
ci_073                 8.264368e-04 3 1  ON 72
ci_074                 1.809476e-03 3 1  ON 73
ci_075                -6.125272e-04 3 1  ON 74
ci_076                -1.444795e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6306e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2316e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.3095
    reference variance = 2.33716
====================================================
  Execution time = 2.4469e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0329e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7068e+00
  Total weights = 1.949995724e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9643e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758528273134
                                         uncertainty =       0.026659222856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758528273134
                                         uncertainty =       0.026659222856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370802190
  error estimate for blocks of size 2^( 2) =       0.001440647231
  error estimate for blocks of size 2^( 3) =       0.001504762786
  error estimate for blocks of size 2^( 4) =       0.001550240587
  error estimate for blocks of size 2^( 5) =       0.001573194475
  error estimate for blocks of size 2^( 6) =       0.001582525014
  error estimate for blocks of size 2^( 7) =       0.001590430050

      target function =                  N/A
              le_mean =     -22.326766952260
             les_mean =     502.191303661550
             stat err =       0.001574097531
             autocorr =       1.318601898316
              std dev =       1.938638065633
             le_variance =       3.758317549523


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232676695226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326766951452       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326817292862       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326818233541       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326818222896       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e-01 is 1.262607e-03

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326766951452       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326786439313       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326786405995       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-01 is 4.453500e-04

solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326766951452       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326772597565       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326772564089       residual = 5.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+00 is 1.243147e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0441e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -6.889494e-01 3 1  ON 0
ci_002                -7.116480e-01 3 1  ON 1
ci_003                -6.179630e-02 3 1  ON 2
ci_004                -6.317316e-02 3 1  ON 3
ci_005                 4.482854e-02 3 1  ON 4
ci_006                 4.655273e-02 3 1  ON 5
ci_007                 3.135131e-02 3 1  ON 6
ci_008                 3.317886e-02 3 1  ON 7
ci_009                -2.463971e-02 3 1  ON 8
ci_010                -2.561355e-02 3 1  ON 9
ci_011                -2.259519e-02 3 1  ON 10
ci_012                -2.333951e-02 3 1  ON 11
ci_013                 1.922705e-02 3 1  ON 12
ci_014                 2.116276e-02 3 1  ON 13
ci_015                 1.911605e-02 3 1  ON 14
ci_016                 2.074852e-02 3 1  ON 15
ci_017                 1.509864e-02 3 1  ON 16
ci_018                 1.663285e-02 3 1  ON 17
ci_019                 1.015306e-02 3 1  ON 18
ci_020                 9.598023e-03 3 1  ON 19
ci_021                -9.867329e-03 3 1  ON 20
ci_022                -1.051042e-02 3 1  ON 21
ci_023                 8.828513e-03 3 1  ON 22
ci_024                 8.958886e-03 3 1  ON 23
ci_025                 7.404098e-03 3 1  ON 24
ci_026                 9.398285e-03 3 1  ON 25
ci_027                 8.184102e-03 3 1  ON 26
ci_028                 7.819392e-03 3 1  ON 27
ci_029                -6.878456e-03 3 1  ON 28
ci_030                -7.969529e-03 3 1  ON 29
ci_031                -7.816612e-03 3 1  ON 30
ci_032                -8.073291e-03 3 1  ON 31
ci_033                 6.333491e-03 3 1  ON 32
ci_034                 7.062081e-03 3 1  ON 33
ci_035                 6.745180e-03 3 1  ON 34
ci_036                 7.132704e-03 3 1  ON 35
ci_037                 6.372782e-03 3 1  ON 36
ci_038                 5.928155e-03 3 1  ON 37
ci_039                 5.778291e-03 3 1  ON 38
ci_040                 5.867850e-03 3 1  ON 39
ci_041                 5.354356e-03 3 1  ON 40
ci_042                 5.457899e-03 3 1  ON 41
ci_043                 4.719201e-03 3 1  ON 42
ci_044                 5.589143e-03 3 1  ON 43
ci_045                 5.164184e-03 3 1  ON 44
ci_046                 4.650204e-03 3 1  ON 45
ci_047                -4.113891e-03 3 1  ON 46
ci_048                -4.110116e-03 3 1  ON 47
ci_049                 3.543329e-03 3 1  ON 48
ci_050                 3.172838e-03 3 1  ON 49
ci_051                -2.708678e-03 3 1  ON 50
ci_052                -2.700473e-03 3 1  ON 51
ci_053                -2.402308e-03 3 1  ON 52
ci_054                -1.761059e-03 3 1  ON 53
ci_055                -2.090722e-03 3 1  ON 54
ci_056                -1.535471e-03 3 1  ON 55
ci_057                -2.333896e-03 3 1  ON 56
ci_058                -2.112732e-03 3 1  ON 57
ci_059                -2.125752e-03 3 1  ON 58
ci_060                -2.349731e-03 3 1  ON 59
ci_061                -1.249026e-03 3 1  ON 60
ci_062                -1.632533e-03 3 1  ON 61
ci_063                -5.736064e-04 3 1  ON 62
ci_064                -9.179793e-04 3 1  ON 63
ci_065                -1.419457e-03 3 1  ON 64
ci_066                -1.633779e-03 3 1  ON 65
ci_067                -7.655381e-04 3 1  ON 66
ci_068                -1.274671e-03 3 1  ON 67
ci_069                 1.332526e-03 3 1  ON 68
ci_070                 1.910022e-03 3 1  ON 69
ci_071                -9.329177e-04 3 1  ON 70
ci_072                -8.758447e-04 3 1  ON 71
ci_073                 9.666545e-04 3 1  ON 72
ci_074                 1.925246e-03 3 1  ON 73
ci_075                -6.054274e-04 3 1  ON 74
ci_076                -1.245378e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.1289
    reference variance = 4.17763
====================================================
  Execution time = 2.3803e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7449e+00
  Total weights = 1.9496e+06
  Execution time = 4.4938e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797245780137
                                         uncertainty =       0.036333630521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797245780137
                                         uncertainty =       0.036333630521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378108538
  error estimate for blocks of size 2^( 2) =       0.001449480821
  error estimate for blocks of size 2^( 3) =       0.001512235346
  error estimate for blocks of size 2^( 4) =       0.001552596712
  error estimate for blocks of size 2^( 5) =       0.001579430587
  error estimate for blocks of size 2^( 6) =       0.001596404584
  error estimate for blocks of size 2^( 7) =       0.001603040027

      target function =                  N/A
              le_mean =     -22.327039387228
             les_mean =     502.241750968669
             stat err =       0.001582867977
             autocorr =       1.319236137867
              std dev =       1.948970967695
             le_variance =       3.798487832918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797629978207
                                         uncertainty =       0.036370035589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797629978207
                                         uncertainty =       0.036370035589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378177720
  error estimate for blocks of size 2^( 2) =       0.001449524840
  error estimate for blocks of size 2^( 3) =       0.001512277136
  error estimate for blocks of size 2^( 4) =       0.001552614962
  error estimate for blocks of size 2^( 5) =       0.001579448943
  error estimate for blocks of size 2^( 6) =       0.001596424238
  error estimate for blocks of size 2^( 7) =       0.001602947165

      target function =                  N/A
              le_mean =     -22.327039557469
             les_mean =     502.518557114888
             stat err =       0.001582858827
             autocorr =       1.319088442904
              std dev =       1.949068807854
             le_variance =       3.798869217749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797374521490
                                         uncertainty =       0.036343259273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797374521490
                                         uncertainty =       0.036343259273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378131570
  error estimate for blocks of size 2^( 2) =       0.001449482482
  error estimate for blocks of size 2^( 3) =       0.001512228443
  error estimate for blocks of size 2^( 4) =       0.001552575124
  error estimate for blocks of size 2^( 5) =       0.001579419384
  error estimate for blocks of size 2^( 6) =       0.001596406384
  error estimate for blocks of size 2^( 7) =       0.001603016608

      target function =                  N/A
              le_mean =     -22.327040508432
             les_mean =     502.244129772624
             stat err =       0.001582854375
             autocorr =       1.319169368980
              std dev =       1.949003540970
             le_variance =       3.798614802712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797256725085
                                         uncertainty =       0.036334982203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797256725085
                                         uncertainty =       0.036334982203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378110478
  error estimate for blocks of size 2^( 2) =       0.001449479675
  error estimate for blocks of size 2^( 3) =       0.001512232703
  error estimate for blocks of size 2^( 4) =       0.001552592066
  error estimate for blocks of size 2^( 5) =       0.001579427041
  error estimate for blocks of size 2^( 6) =       0.001596403499
  error estimate for blocks of size 2^( 7) =       0.001603035705

      target function =                  N/A
              le_mean =     -22.327037422819
             les_mean =     502.242113023090
             stat err =       0.001582864578
             autocorr =       1.319226756759
              std dev =       1.948973711119
             le_variance =       3.798498526632


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327039387228        initial
     2.2204e-01     2.2204e+00             1.2626e-03       -22.327039557469
     8.8818e-01     8.8818e+00             4.4535e-04       -22.327040508432  <--
     3.5527e+00     3.5527e+01             1.2431e-04       -22.327037422819

*****************************************************************************
Applying the update for shift_i =   8.8818e-01     and shift_s =   8.8818e+00
*****************************************************************************

  Execution time = 4.6344e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -6.889494e-01 3 1  ON 0
ci_002                -7.116480e-01 3 1  ON 1
ci_003                -6.179630e-02 3 1  ON 2
ci_004                -6.317316e-02 3 1  ON 3
ci_005                 4.482854e-02 3 1  ON 4
ci_006                 4.655273e-02 3 1  ON 5
ci_007                 3.135131e-02 3 1  ON 6
ci_008                 3.317886e-02 3 1  ON 7
ci_009                -2.463971e-02 3 1  ON 8
ci_010                -2.561355e-02 3 1  ON 9
ci_011                -2.259519e-02 3 1  ON 10
ci_012                -2.333951e-02 3 1  ON 11
ci_013                 1.922705e-02 3 1  ON 12
ci_014                 2.116276e-02 3 1  ON 13
ci_015                 1.911605e-02 3 1  ON 14
ci_016                 2.074852e-02 3 1  ON 15
ci_017                 1.509864e-02 3 1  ON 16
ci_018                 1.663285e-02 3 1  ON 17
ci_019                 1.015306e-02 3 1  ON 18
ci_020                 9.598023e-03 3 1  ON 19
ci_021                -9.867329e-03 3 1  ON 20
ci_022                -1.051042e-02 3 1  ON 21
ci_023                 8.828513e-03 3 1  ON 22
ci_024                 8.958886e-03 3 1  ON 23
ci_025                 7.404098e-03 3 1  ON 24
ci_026                 9.398285e-03 3 1  ON 25
ci_027                 8.184102e-03 3 1  ON 26
ci_028                 7.819392e-03 3 1  ON 27
ci_029                -6.878456e-03 3 1  ON 28
ci_030                -7.969529e-03 3 1  ON 29
ci_031                -7.816612e-03 3 1  ON 30
ci_032                -8.073291e-03 3 1  ON 31
ci_033                 6.333491e-03 3 1  ON 32
ci_034                 7.062081e-03 3 1  ON 33
ci_035                 6.745180e-03 3 1  ON 34
ci_036                 7.132704e-03 3 1  ON 35
ci_037                 6.372782e-03 3 1  ON 36
ci_038                 5.928155e-03 3 1  ON 37
ci_039                 5.778291e-03 3 1  ON 38
ci_040                 5.867850e-03 3 1  ON 39
ci_041                 5.354356e-03 3 1  ON 40
ci_042                 5.457899e-03 3 1  ON 41
ci_043                 4.719201e-03 3 1  ON 42
ci_044                 5.589143e-03 3 1  ON 43
ci_045                 5.164184e-03 3 1  ON 44
ci_046                 4.650204e-03 3 1  ON 45
ci_047                -4.113891e-03 3 1  ON 46
ci_048                -4.110116e-03 3 1  ON 47
ci_049                 3.543329e-03 3 1  ON 48
ci_050                 3.172838e-03 3 1  ON 49
ci_051                -2.708678e-03 3 1  ON 50
ci_052                -2.700473e-03 3 1  ON 51
ci_053                -2.402308e-03 3 1  ON 52
ci_054                -1.761059e-03 3 1  ON 53
ci_055                -2.090722e-03 3 1  ON 54
ci_056                -1.535471e-03 3 1  ON 55
ci_057                -2.333896e-03 3 1  ON 56
ci_058                -2.112732e-03 3 1  ON 57
ci_059                -2.125752e-03 3 1  ON 58
ci_060                -2.349731e-03 3 1  ON 59
ci_061                -1.249026e-03 3 1  ON 60
ci_062                -1.632533e-03 3 1  ON 61
ci_063                -5.736064e-04 3 1  ON 62
ci_064                -9.179793e-04 3 1  ON 63
ci_065                -1.419457e-03 3 1  ON 64
ci_066                -1.633779e-03 3 1  ON 65
ci_067                -7.655381e-04 3 1  ON 66
ci_068                -1.274671e-03 3 1  ON 67
ci_069                 1.332526e-03 3 1  ON 68
ci_070                 1.910022e-03 3 1  ON 69
ci_071                -9.329177e-04 3 1  ON 70
ci_072                -8.758447e-04 3 1  ON 71
ci_073                 9.666545e-04 3 1  ON 72
ci_074                 1.925246e-03 3 1  ON 73
ci_075                -6.054274e-04 3 1  ON 74
ci_076                -1.245378e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6793e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2314e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.2353
    reference variance = 3.51548
====================================================
  Execution time = 2.4321e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0264e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7096e+00
  Total weights = 1.949751164e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0896e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761138381309
                                         uncertainty =       0.035657065126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.761138381309
                                         uncertainty =       0.035657065126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371242871
  error estimate for blocks of size 2^( 2) =       0.001441564087
  error estimate for blocks of size 2^( 3) =       0.001505865358
  error estimate for blocks of size 2^( 4) =       0.001548641904
  error estimate for blocks of size 2^( 5) =       0.001572431640
  error estimate for blocks of size 2^( 6) =       0.001587460320
  error estimate for blocks of size 2^( 7) =       0.001594255036

      target function =                  N/A
              le_mean =     -22.329055983328
             les_mean =     502.296291534661
             stat err =       0.001575697225
             autocorr =       1.320434232773
              std dev =       1.939261292649
             le_variance =       3.760734361166


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232905598333e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329055982499       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329096095663       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329096018861       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329096081288       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329096202739       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e-01 is 9.158103e-04

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329055982499       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329071901667       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329071737824       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-01 is 3.501686e-04

solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329055982499       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329060647346       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329060613938       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+00 is 1.093315e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0418e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -6.888502e-01 3 1  ON 0
ci_002                -7.117632e-01 3 1  ON 1
ci_003                -6.171352e-02 3 1  ON 2
ci_004                -6.332738e-02 3 1  ON 3
ci_005                 4.476369e-02 3 1  ON 4
ci_006                 4.658506e-02 3 1  ON 5
ci_007                 3.134299e-02 3 1  ON 6
ci_008                 3.294915e-02 3 1  ON 7
ci_009                -2.478772e-02 3 1  ON 8
ci_010                -2.538982e-02 3 1  ON 9
ci_011                -2.267648e-02 3 1  ON 10
ci_012                -2.329422e-02 3 1  ON 11
ci_013                 1.957009e-02 3 1  ON 12
ci_014                 2.130394e-02 3 1  ON 13
ci_015                 1.909885e-02 3 1  ON 14
ci_016                 2.057950e-02 3 1  ON 15
ci_017                 1.479903e-02 3 1  ON 16
ci_018                 1.648831e-02 3 1  ON 17
ci_019                 1.009238e-02 3 1  ON 18
ci_020                 9.891417e-03 3 1  ON 19
ci_021                -9.807547e-03 3 1  ON 20
ci_022                -1.047315e-02 3 1  ON 21
ci_023                 8.704556e-03 3 1  ON 22
ci_024                 8.851950e-03 3 1  ON 23
ci_025                 7.489064e-03 3 1  ON 24
ci_026                 9.295249e-03 3 1  ON 25
ci_027                 7.855133e-03 3 1  ON 26
ci_028                 7.808159e-03 3 1  ON 27
ci_029                -6.905875e-03 3 1  ON 28
ci_030                -7.922574e-03 3 1  ON 29
ci_031                -7.893951e-03 3 1  ON 30
ci_032                -7.904147e-03 3 1  ON 31
ci_033                 6.477579e-03 3 1  ON 32
ci_034                 7.078337e-03 3 1  ON 33
ci_035                 6.672926e-03 3 1  ON 34
ci_036                 6.981313e-03 3 1  ON 35
ci_037                 6.401915e-03 3 1  ON 36
ci_038                 6.037153e-03 3 1  ON 37
ci_039                 5.672685e-03 3 1  ON 38
ci_040                 5.704537e-03 3 1  ON 39
ci_041                 5.268543e-03 3 1  ON 40
ci_042                 5.564415e-03 3 1  ON 41
ci_043                 4.670116e-03 3 1  ON 42
ci_044                 5.492563e-03 3 1  ON 43
ci_045                 5.103096e-03 3 1  ON 44
ci_046                 4.763308e-03 3 1  ON 45
ci_047                -4.119380e-03 3 1  ON 46
ci_048                -4.456692e-03 3 1  ON 47
ci_049                 3.479335e-03 3 1  ON 48
ci_050                 3.109791e-03 3 1  ON 49
ci_051                -2.646049e-03 3 1  ON 50
ci_052                -2.900995e-03 3 1  ON 51
ci_053                -2.543278e-03 3 1  ON 52
ci_054                -1.926461e-03 3 1  ON 53
ci_055                -2.137113e-03 3 1  ON 54
ci_056                -1.572742e-03 3 1  ON 55
ci_057                -2.206626e-03 3 1  ON 56
ci_058                -1.833326e-03 3 1  ON 57
ci_059                -1.929380e-03 3 1  ON 58
ci_060                -2.258531e-03 3 1  ON 59
ci_061                -1.321986e-03 3 1  ON 60
ci_062                -1.358971e-03 3 1  ON 61
ci_063                -9.237749e-04 3 1  ON 62
ci_064                -9.504741e-04 3 1  ON 63
ci_065                -1.401102e-03 3 1  ON 64
ci_066                -1.628316e-03 3 1  ON 65
ci_067                -6.490762e-04 3 1  ON 66
ci_068                -1.160177e-03 3 1  ON 67
ci_069                 1.234876e-03 3 1  ON 68
ci_070                 2.139981e-03 3 1  ON 69
ci_071                -9.660667e-04 3 1  ON 70
ci_072                -9.472036e-04 3 1  ON 71
ci_073                 1.002423e-03 3 1  ON 72
ci_074                 1.600598e-03 3 1  ON 73
ci_075                -5.499475e-04 3 1  ON 74
ci_076                -1.345056e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.4168
    reference variance = 2.60264
====================================================
  Execution time = 2.3687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7042e+00
  Total weights = 1.9501e+06
  Execution time = 4.4670e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757229275959
                                         uncertainty =       0.022431811961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757229275959
                                         uncertainty =       0.022431811961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370690060
  error estimate for blocks of size 2^( 2) =       0.001441289534
  error estimate for blocks of size 2^( 3) =       0.001504846738
  error estimate for blocks of size 2^( 4) =       0.001546748907
  error estimate for blocks of size 2^( 5) =       0.001573313107
  error estimate for blocks of size 2^( 6) =       0.001585218635
  error estimate for blocks of size 2^( 7) =       0.001598873114

      target function =                  N/A
              le_mean =     -22.327507243862
             les_mean =     502.222361844828
             stat err =       0.001576038441
             autocorr =       1.322071932552
              std dev =       1.938479487930
             le_variance =       3.757702725126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757190714220
                                         uncertainty =       0.022433533472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757190714220
                                         uncertainty =       0.022433533472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370682760
  error estimate for blocks of size 2^( 2) =       0.001441288222
  error estimate for blocks of size 2^( 3) =       0.001504864949
  error estimate for blocks of size 2^( 4) =       0.001546757795
  error estimate for blocks of size 2^( 5) =       0.001573337225
  error estimate for blocks of size 2^( 6) =       0.001585222310
  error estimate for blocks of size 2^( 7) =       0.001598901959

      target function =                  N/A
              le_mean =     -22.327522749923
             les_mean =     502.225282697459
             stat err =       0.001576054822
             autocorr =       1.322113497837
              std dev =       1.938469164277
             le_variance =       3.757662700851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757205416581
                                         uncertainty =       0.022433298950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757205416581
                                         uncertainty =       0.022433298950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370685497
  error estimate for blocks of size 2^( 2) =       0.001441290989
  error estimate for blocks of size 2^( 3) =       0.001504864751
  error estimate for blocks of size 2^( 4) =       0.001546759947
  error estimate for blocks of size 2^( 5) =       0.001573341899
  error estimate for blocks of size 2^( 6) =       0.001585228824
  error estimate for blocks of size 2^( 7) =       0.001598904664

      target function =                  N/A
              le_mean =     -22.327520295679
             les_mean =     502.242730221649
             stat err =       0.001576058833
             autocorr =       1.322114948207
              std dev =       1.938473034571
             le_variance =       3.757677705760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757254953782
                                         uncertainty =       0.022429534283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757254953782
                                         uncertainty =       0.022429534283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370694688
  error estimate for blocks of size 2^( 2) =       0.001441291767
  error estimate for blocks of size 2^( 3) =       0.001504849006
  error estimate for blocks of size 2^( 4) =       0.001546748256
  error estimate for blocks of size 2^( 5) =       0.001573309346
  error estimate for blocks of size 2^( 6) =       0.001585218344
  error estimate for blocks of size 2^( 7) =       0.001598878957

      target function =                  N/A
              le_mean =     -22.327513283850
             les_mean =     502.315037709342
             stat err =       0.001576038726
             autocorr =       1.322063484064
              std dev =       1.938486032262
             le_variance =       3.757728097273


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327507243862        initial
     2.2204e-01     2.2204e+00             9.1581e-04       -22.327522749923  <--
     8.8818e-01     8.8818e+00             3.5017e-04       -22.327520295679
     3.5527e+00     3.5527e+01             1.0933e-04       -22.327513283850

*****************************************************************************
Applying the update for shift_i =   2.2204e-01     and shift_s =   2.2204e+00
*****************************************************************************

  Execution time = 4.6214e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -6.885449e-01 3 1  ON 0
ci_002                -7.120849e-01 3 1  ON 1
ci_003                -6.146709e-02 3 1  ON 2
ci_004                -6.371028e-02 3 1  ON 3
ci_005                 4.465591e-02 3 1  ON 4
ci_006                 4.666198e-02 3 1  ON 5
ci_007                 3.129321e-02 3 1  ON 6
ci_008                 3.261332e-02 3 1  ON 7
ci_009                -2.505636e-02 3 1  ON 8
ci_010                -2.503630e-02 3 1  ON 9
ci_011                -2.274946e-02 3 1  ON 10
ci_012                -2.316987e-02 3 1  ON 11
ci_013                 2.014286e-02 3 1  ON 12
ci_014                 2.155150e-02 3 1  ON 13
ci_015                 1.908286e-02 3 1  ON 14
ci_016                 2.027179e-02 3 1  ON 15
ci_017                 1.428645e-02 3 1  ON 16
ci_018                 1.621869e-02 3 1  ON 17
ci_019                 9.940707e-03 3 1  ON 18
ci_020                 1.046721e-02 3 1  ON 19
ci_021                -9.686990e-03 3 1  ON 20
ci_022                -1.047214e-02 3 1  ON 21
ci_023                 8.520959e-03 3 1  ON 22
ci_024                 8.689535e-03 3 1  ON 23
ci_025                 7.668550e-03 3 1  ON 24
ci_026                 9.082235e-03 3 1  ON 25
ci_027                 7.427378e-03 3 1  ON 26
ci_028                 7.799129e-03 3 1  ON 27
ci_029                -6.968202e-03 3 1  ON 28
ci_030                -7.838323e-03 3 1  ON 29
ci_031                -8.043832e-03 3 1  ON 30
ci_032                -7.597262e-03 3 1  ON 31
ci_033                 6.747366e-03 3 1  ON 32
ci_034                 7.098656e-03 3 1  ON 33
ci_035                 6.584406e-03 3 1  ON 34
ci_036                 6.783593e-03 3 1  ON 35
ci_037                 6.474848e-03 3 1  ON 36
ci_038                 6.212867e-03 3 1  ON 37
ci_039                 5.550802e-03 3 1  ON 38
ci_040                 5.493570e-03 3 1  ON 39
ci_041                 5.142474e-03 3 1  ON 40
ci_042                 5.717200e-03 3 1  ON 41
ci_043                 4.577696e-03 3 1  ON 42
ci_044                 5.321301e-03 3 1  ON 43
ci_045                 5.004079e-03 3 1  ON 44
ci_046                 4.956270e-03 3 1  ON 45
ci_047                -4.131407e-03 3 1  ON 46
ci_048                -4.879280e-03 3 1  ON 47
ci_049                 3.355947e-03 3 1  ON 48
ci_050                 2.999039e-03 3 1  ON 49
ci_051                -2.533369e-03 3 1  ON 50
ci_052                -3.215421e-03 3 1  ON 51
ci_053                -2.763190e-03 3 1  ON 52
ci_054                -2.233824e-03 3 1  ON 53
ci_055                -2.269464e-03 3 1  ON 54
ci_056                -1.648021e-03 3 1  ON 55
ci_057                -2.014580e-03 3 1  ON 56
ci_058                -1.402498e-03 3 1  ON 57
ci_059                -1.689166e-03 3 1  ON 58
ci_060                -2.131309e-03 3 1  ON 59
ci_061                -1.414311e-03 3 1  ON 60
ci_062                -9.122742e-04 3 1  ON 61
ci_063                -1.484905e-03 3 1  ON 62
ci_064                -9.730708e-04 3 1  ON 63
ci_065                -1.376782e-03 3 1  ON 64
ci_066                -1.618276e-03 3 1  ON 65
ci_067                -4.481252e-04 3 1  ON 66
ci_068                -9.778011e-04 3 1  ON 67
ci_069                 1.080602e-03 3 1  ON 68
ci_070                 2.534355e-03 3 1  ON 69
ci_071                -1.040052e-03 3 1  ON 70
ci_072                -1.055767e-03 3 1  ON 71
ci_073                 1.049451e-03 3 1  ON 72
ci_074                 1.173997e-03 3 1  ON 73
ci_075                -4.654171e-04 3 1  ON 74
ci_076                -1.507531e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6639e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2314e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.359
    reference variance = 4.58111
====================================================
  Execution time = 2.4515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0319e+04
  VMC Eavg = -2.2324e+01
  VMC Evar = 3.7809e+00
  Total weights = 1.949816542e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9721e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.833320023199
                                         uncertainty =       0.031441576216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.833320023199
                                         uncertainty =       0.031441576216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384573364
  error estimate for blocks of size 2^( 2) =       0.001455755989
  error estimate for blocks of size 2^( 3) =       0.001518797600
  error estimate for blocks of size 2^( 4) =       0.001559339321
  error estimate for blocks of size 2^( 5) =       0.001587059824
  error estimate for blocks of size 2^( 6) =       0.001607218013
  error estimate for blocks of size 2^( 7) =       0.001620604217

      target function =                  N/A
              le_mean =     -22.324411337816
             les_mean =     502.160259052668
             stat err =       0.001593555344
             autocorr =       1.324653700794
              std dev =       1.958113758161
             le_variance =       3.834209489898


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232441133782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-02, overlap shift 5.5511e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324411337034       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324492617774       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324498735255       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.324499535597       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.324499965520       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.324500210209       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e-02 is 3.139641e-03

solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324411337034       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324460479887       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324462011199       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.324462019468       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.324462082933       residual = 4.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e-01 is 1.744227e-03

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.324411337034       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.324430372878       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.324430557841       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.324430543482       residual = 1.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e-01 is 6.302504e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171535 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0494e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -6.884628e-01 3 1  ON 0
ci_002                -7.119168e-01 3 1  ON 1
ci_003                -6.231675e-02 3 1  ON 2
ci_004                -6.420400e-02 3 1  ON 3
ci_005                 4.409219e-02 3 1  ON 4
ci_006                 4.703987e-02 3 1  ON 5
ci_007                 3.155008e-02 3 1  ON 6
ci_008                 3.273726e-02 3 1  ON 7
ci_009                -2.461326e-02 3 1  ON 8
ci_010                -2.510254e-02 3 1  ON 9
ci_011                -2.257351e-02 3 1  ON 10
ci_012                -2.356585e-02 3 1  ON 11
ci_013                 2.022259e-02 3 1  ON 12
ci_014                 2.121491e-02 3 1  ON 13
ci_015                 1.934427e-02 3 1  ON 14
ci_016                 2.110417e-02 3 1  ON 15
ci_017                 1.603067e-02 3 1  ON 16
ci_018                 1.672022e-02 3 1  ON 17
ci_019                 1.068635e-02 3 1  ON 18
ci_020                 1.039587e-02 3 1  ON 19
ci_021                -1.047905e-02 3 1  ON 20
ci_022                -1.081936e-02 3 1  ON 21
ci_023                 9.127863e-03 3 1  ON 22
ci_024                 8.946020e-03 3 1  ON 23
ci_025                 8.120066e-03 3 1  ON 24
ci_026                 8.196040e-03 3 1  ON 25
ci_027                 7.985460e-03 3 1  ON 26
ci_028                 8.429464e-03 3 1  ON 27
ci_029                -7.698575e-03 3 1  ON 28
ci_030                -8.381213e-03 3 1  ON 29
ci_031                -7.726302e-03 3 1  ON 30
ci_032                -7.372342e-03 3 1  ON 31
ci_033                 6.938727e-03 3 1  ON 32
ci_034                 7.335910e-03 3 1  ON 33
ci_035                 6.562670e-03 3 1  ON 34
ci_036                 6.750563e-03 3 1  ON 35
ci_037                 6.416856e-03 3 1  ON 36
ci_038                 6.585056e-03 3 1  ON 37
ci_039                 5.936377e-03 3 1  ON 38
ci_040                 5.546464e-03 3 1  ON 39
ci_041                 5.299641e-03 3 1  ON 40
ci_042                 5.832770e-03 3 1  ON 41
ci_043                 4.499819e-03 3 1  ON 42
ci_044                 5.919152e-03 3 1  ON 43
ci_045                 5.060864e-03 3 1  ON 44
ci_046                 4.396057e-03 3 1  ON 45
ci_047                -4.975197e-03 3 1  ON 46
ci_048                -4.110444e-03 3 1  ON 47
ci_049                 3.930809e-03 3 1  ON 48
ci_050                 3.247888e-03 3 1  ON 49
ci_051                -2.080708e-03 3 1  ON 50
ci_052                -2.970763e-03 3 1  ON 51
ci_053                -2.574186e-03 3 1  ON 52
ci_054                -3.052920e-03 3 1  ON 53
ci_055                -2.824891e-03 3 1  ON 54
ci_056                -1.413287e-03 3 1  ON 55
ci_057                -1.780740e-03 3 1  ON 56
ci_058                -2.154794e-03 3 1  ON 57
ci_059                -1.952164e-03 3 1  ON 58
ci_060                -1.797518e-03 3 1  ON 59
ci_061                -2.020944e-03 3 1  ON 60
ci_062                -8.228350e-04 3 1  ON 61
ci_063                -1.365386e-03 3 1  ON 62
ci_064                -6.142533e-04 3 1  ON 63
ci_065                -1.128738e-03 3 1  ON 64
ci_066                -7.934370e-04 3 1  ON 65
ci_067                -6.893699e-04 3 1  ON 66
ci_068                -6.454737e-04 3 1  ON 67
ci_069                 1.133741e-03 3 1  ON 68
ci_070                 2.098506e-03 3 1  ON 69
ci_071                -1.923632e-03 3 1  ON 70
ci_072                -7.869451e-04 3 1  ON 71
ci_073                 7.423491e-04 3 1  ON 72
ci_074                 1.246026e-03 3 1  ON 73
ci_075                -8.907934e-04 3 1  ON 74
ci_076                -5.043458e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -21.8112
    reference variance = 9.16211
====================================================
  Execution time = 2.3892e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7321e+00
  Total weights = 1.9500e+06
  Execution time = 4.7776e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784212872807
                                         uncertainty =       0.033446753290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784212872807
                                         uncertainty =       0.033446753290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375450650
  error estimate for blocks of size 2^( 2) =       0.001446614038
  error estimate for blocks of size 2^( 3) =       0.001509676823
  error estimate for blocks of size 2^( 4) =       0.001554094882
  error estimate for blocks of size 2^( 5) =       0.001577790501
  error estimate for blocks of size 2^( 6) =       0.001595161843
  error estimate for blocks of size 2^( 7) =       0.001593657635

      target function =                  N/A
              le_mean =     -22.326716218906
             les_mean =     502.233220817649
             stat err =       0.001580176215
             autocorr =       1.319839176799
              std dev =       1.945212086293
             le_variance =       3.783850060661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784673514852
                                         uncertainty =       0.033447644297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784673514852
                                         uncertainty =       0.033447644297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375533395
  error estimate for blocks of size 2^( 2) =       0.001446676395
  error estimate for blocks of size 2^( 3) =       0.001509717622
  error estimate for blocks of size 2^( 4) =       0.001554085311
  error estimate for blocks of size 2^( 5) =       0.001577763133
  error estimate for blocks of size 2^( 6) =       0.001595090562
  error estimate for blocks of size 2^( 7) =       0.001593532538

      target function =                  N/A
              le_mean =     -22.326700077073
             les_mean =     502.218779787153
             stat err =       0.001580117886
             autocorr =       1.319582966156
              std dev =       1.945329107335
             le_variance =       3.784305335844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785014635788
                                         uncertainty =       0.033429809194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785014635788
                                         uncertainty =       0.033429809194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375595160
  error estimate for blocks of size 2^( 2) =       0.001446739458
  error estimate for blocks of size 2^( 3) =       0.001509777950
  error estimate for blocks of size 2^( 4) =       0.001554143963
  error estimate for blocks of size 2^( 5) =       0.001577803225
  error estimate for blocks of size 2^( 6) =       0.001595095723
  error estimate for blocks of size 2^( 7) =       0.001593454772

      target function =                  N/A
              le_mean =     -22.326706882345
             les_mean =     502.247640511302
             stat err =       0.001580124421
             autocorr =       1.319475382378
              std dev =       1.945416457932
             le_variance =       3.784645194793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784169038131
                                         uncertainty =       0.033446838170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.784169038131
                                         uncertainty =       0.033446838170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375442477
  error estimate for blocks of size 2^( 2) =       0.001446602610
  error estimate for blocks of size 2^( 3) =       0.001509660136
  error estimate for blocks of size 2^( 4) =       0.001554073702
  error estimate for blocks of size 2^( 5) =       0.001577767956
  error estimate for blocks of size 2^( 6) =       0.001595129852
  error estimate for blocks of size 2^( 7) =       0.001593646550

      target function =                  N/A
              le_mean =     -22.326701327238
             les_mean =     502.226394381118
             stat err =       0.001580154515
             autocorr =       1.319818611306
              std dev =       1.945200527894
             le_variance =       3.783805093720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326716218906        initial  <--
     5.5511e-02     5.5511e-01             3.1396e-03       -22.326700077073
     2.2204e-01     2.2204e+00             1.7442e-03       -22.326706882345
     8.8818e-01     8.8818e+00             6.3025e-04       -22.326701327238

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.8575
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -6.885449e-01 3 1  ON 0
ci_002                -7.120849e-01 3 1  ON 1
ci_003                -6.146709e-02 3 1  ON 2
ci_004                -6.371028e-02 3 1  ON 3
ci_005                 4.465591e-02 3 1  ON 4
ci_006                 4.666198e-02 3 1  ON 5
ci_007                 3.129321e-02 3 1  ON 6
ci_008                 3.261332e-02 3 1  ON 7
ci_009                -2.505636e-02 3 1  ON 8
ci_010                -2.503630e-02 3 1  ON 9
ci_011                -2.274946e-02 3 1  ON 10
ci_012                -2.316987e-02 3 1  ON 11
ci_013                 2.014286e-02 3 1  ON 12
ci_014                 2.155150e-02 3 1  ON 13
ci_015                 1.908286e-02 3 1  ON 14
ci_016                 2.027179e-02 3 1  ON 15
ci_017                 1.428645e-02 3 1  ON 16
ci_018                 1.621869e-02 3 1  ON 17
ci_019                 9.940707e-03 3 1  ON 18
ci_020                 1.046721e-02 3 1  ON 19
ci_021                -9.686990e-03 3 1  ON 20
ci_022                -1.047214e-02 3 1  ON 21
ci_023                 8.520959e-03 3 1  ON 22
ci_024                 8.689535e-03 3 1  ON 23
ci_025                 7.668550e-03 3 1  ON 24
ci_026                 9.082235e-03 3 1  ON 25
ci_027                 7.427378e-03 3 1  ON 26
ci_028                 7.799129e-03 3 1  ON 27
ci_029                -6.968202e-03 3 1  ON 28
ci_030                -7.838323e-03 3 1  ON 29
ci_031                -8.043832e-03 3 1  ON 30
ci_032                -7.597262e-03 3 1  ON 31
ci_033                 6.747366e-03 3 1  ON 32
ci_034                 7.098656e-03 3 1  ON 33
ci_035                 6.584406e-03 3 1  ON 34
ci_036                 6.783593e-03 3 1  ON 35
ci_037                 6.474848e-03 3 1  ON 36
ci_038                 6.212867e-03 3 1  ON 37
ci_039                 5.550802e-03 3 1  ON 38
ci_040                 5.493570e-03 3 1  ON 39
ci_041                 5.142474e-03 3 1  ON 40
ci_042                 5.717200e-03 3 1  ON 41
ci_043                 4.577696e-03 3 1  ON 42
ci_044                 5.321301e-03 3 1  ON 43
ci_045                 5.004079e-03 3 1  ON 44
ci_046                 4.956270e-03 3 1  ON 45
ci_047                -4.131407e-03 3 1  ON 46
ci_048                -4.879280e-03 3 1  ON 47
ci_049                 3.355947e-03 3 1  ON 48
ci_050                 2.999039e-03 3 1  ON 49
ci_051                -2.533369e-03 3 1  ON 50
ci_052                -3.215421e-03 3 1  ON 51
ci_053                -2.763190e-03 3 1  ON 52
ci_054                -2.233824e-03 3 1  ON 53
ci_055                -2.269464e-03 3 1  ON 54
ci_056                -1.648021e-03 3 1  ON 55
ci_057                -2.014580e-03 3 1  ON 56
ci_058                -1.402498e-03 3 1  ON 57
ci_059                -1.689166e-03 3 1  ON 58
ci_060                -2.131309e-03 3 1  ON 59
ci_061                -1.414311e-03 3 1  ON 60
ci_062                -9.122742e-04 3 1  ON 61
ci_063                -1.484905e-03 3 1  ON 62
ci_064                -9.730708e-04 3 1  ON 63
ci_065                -1.376782e-03 3 1  ON 64
ci_066                -1.618276e-03 3 1  ON 65
ci_067                -4.481252e-04 3 1  ON 66
ci_068                -9.778011e-04 3 1  ON 67
ci_069                 1.080602e-03 3 1  ON 68
ci_070                 2.534355e-03 3 1  ON 69
ci_071                -1.040052e-03 3 1  ON 70
ci_072                -1.055767e-03 3 1  ON 71
ci_073                 1.049451e-03 3 1  ON 72
ci_074                 1.173997e-03 3 1  ON 73
ci_075                -4.654171e-04 3 1  ON 74
ci_076                -1.507531e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2311e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.5084
    reference variance = 5.04539
====================================================
  Execution time = 2.4591e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0358e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7229e+00
  Total weights = 1.949949457e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9877e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772030887647
                                         uncertainty =       0.039436384572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.772030887647
                                         uncertainty =       0.039436384572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373414370
  error estimate for blocks of size 2^( 2) =       0.001443010409
  error estimate for blocks of size 2^( 3) =       0.001504634793
  error estimate for blocks of size 2^( 4) =       0.001547850322
  error estimate for blocks of size 2^( 5) =       0.001573713632
  error estimate for blocks of size 2^( 6) =       0.001586955235
  error estimate for blocks of size 2^( 7) =       0.001600093330

      target function =                  N/A
              le_mean =     -22.329921313828
             les_mean =     502.348320395287
             stat err =       0.001577153130
             autocorr =       1.318695579274
              std dev =       1.942332305135
             le_variance =       3.772654783571


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232992131383e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329921313016       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329951660885       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329951714190       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329951604636       residual = 2.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e-01 is 7.293413e-04

solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329921313016       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329930681017       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329930715153       residual = 1.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+00 is 2.131043e-04

solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329921313016       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329923801029       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329923815968       residual = 4.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+00 is 5.568649e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0586e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -6.885551e-01 3 1  ON 0
ci_002                -7.120831e-01 3 1  ON 1
ci_003                -6.136573e-02 3 1  ON 2
ci_004                -6.375171e-02 3 1  ON 3
ci_005                 4.473724e-02 3 1  ON 4
ci_006                 4.667267e-02 3 1  ON 5
ci_007                 3.126724e-02 3 1  ON 6
ci_008                 3.259337e-02 3 1  ON 7
ci_009                -2.485272e-02 3 1  ON 8
ci_010                -2.517708e-02 3 1  ON 9
ci_011                -2.272259e-02 3 1  ON 10
ci_012                -2.310686e-02 3 1  ON 11
ci_013                 2.001960e-02 3 1  ON 12
ci_014                 2.148677e-02 3 1  ON 13
ci_015                 1.915914e-02 3 1  ON 14
ci_016                 2.045907e-02 3 1  ON 15
ci_017                 1.432405e-02 3 1  ON 16
ci_018                 1.617292e-02 3 1  ON 17
ci_019                 9.946504e-03 3 1  ON 18
ci_020                 1.025410e-02 3 1  ON 19
ci_021                -9.747334e-03 3 1  ON 20
ci_022                -1.051181e-02 3 1  ON 21
ci_023                 8.649464e-03 3 1  ON 22
ci_024                 8.670454e-03 3 1  ON 23
ci_025                 7.709825e-03 3 1  ON 24
ci_026                 9.024430e-03 3 1  ON 25
ci_027                 7.505952e-03 3 1  ON 26
ci_028                 7.826014e-03 3 1  ON 27
ci_029                -6.993403e-03 3 1  ON 28
ci_030                -7.804456e-03 3 1  ON 29
ci_031                -7.840647e-03 3 1  ON 30
ci_032                -7.607389e-03 3 1  ON 31
ci_033                 6.824099e-03 3 1  ON 32
ci_034                 7.126279e-03 3 1  ON 33
ci_035                 6.609901e-03 3 1  ON 34
ci_036                 6.699125e-03 3 1  ON 35
ci_037                 6.506547e-03 3 1  ON 36
ci_038                 6.164512e-03 3 1  ON 37
ci_039                 5.562936e-03 3 1  ON 38
ci_040                 5.531533e-03 3 1  ON 39
ci_041                 5.087669e-03 3 1  ON 40
ci_042                 5.531119e-03 3 1  ON 41
ci_043                 4.609575e-03 3 1  ON 42
ci_044                 5.282942e-03 3 1  ON 43
ci_045                 5.036079e-03 3 1  ON 44
ci_046                 4.938461e-03 3 1  ON 45
ci_047                -4.178178e-03 3 1  ON 46
ci_048                -4.754896e-03 3 1  ON 47
ci_049                 3.407399e-03 3 1  ON 48
ci_050                 3.018535e-03 3 1  ON 49
ci_051                -2.557226e-03 3 1  ON 50
ci_052                -3.263391e-03 3 1  ON 51
ci_053                -2.792080e-03 3 1  ON 52
ci_054                -2.223832e-03 3 1  ON 53
ci_055                -2.220529e-03 3 1  ON 54
ci_056                -1.698439e-03 3 1  ON 55
ci_057                -1.995317e-03 3 1  ON 56
ci_058                -1.488019e-03 3 1  ON 57
ci_059                -1.719964e-03 3 1  ON 58
ci_060                -2.235380e-03 3 1  ON 59
ci_061                -1.406700e-03 3 1  ON 60
ci_062                -8.758847e-04 3 1  ON 61
ci_063                -1.451708e-03 3 1  ON 62
ci_064                -1.013199e-03 3 1  ON 63
ci_065                -1.400415e-03 3 1  ON 64
ci_066                -1.595946e-03 3 1  ON 65
ci_067                -3.695263e-04 3 1  ON 66
ci_068                -9.552592e-04 3 1  ON 67
ci_069                 1.037490e-03 3 1  ON 68
ci_070                 2.361752e-03 3 1  ON 69
ci_071                -1.012576e-03 3 1  ON 70
ci_072                -1.045475e-03 3 1  ON 71
ci_073                 1.042096e-03 3 1  ON 72
ci_074                 1.181904e-03 3 1  ON 73
ci_075                -5.484118e-04 3 1  ON 74
ci_076                -1.509617e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.5347
    reference variance = 1.95574
====================================================
  Execution time = 2.4056e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7394e+00
  Total weights = 1.9498e+06
  Execution time = 4.4963e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790460018568
                                         uncertainty =       0.040045587212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790460018568
                                         uncertainty =       0.040045587212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376528811
  error estimate for blocks of size 2^( 2) =       0.001447406232
  error estimate for blocks of size 2^( 3) =       0.001511285404
  error estimate for blocks of size 2^( 4) =       0.001555044294
  error estimate for blocks of size 2^( 5) =       0.001580962205
  error estimate for blocks of size 2^( 6) =       0.001585316011
  error estimate for blocks of size 2^( 7) =       0.001593404956

      target function =                  N/A
              le_mean =     -22.328131074633
             les_mean =     502.299625937310
             stat err =       0.001578681866
             autocorr =       1.315281251289
              std dev =       1.946736860584
             le_variance =       3.789784404357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790315867297
                                         uncertainty =       0.040037492074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790315867297
                                         uncertainty =       0.040037492074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376500945
  error estimate for blocks of size 2^( 2) =       0.001447376826
  error estimate for blocks of size 2^( 3) =       0.001511259499
  error estimate for blocks of size 2^( 4) =       0.001555018223
  error estimate for blocks of size 2^( 5) =       0.001580948129
  error estimate for blocks of size 2^( 6) =       0.001585326624
  error estimate for blocks of size 2^( 7) =       0.001593400860

      target function =                  N/A
              le_mean =     -22.328133934183
             les_mean =     502.285405726391
             stat err =       0.001578673459
             autocorr =       1.315320496211
              std dev =       1.946697451207
             le_variance =       3.789630966535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790361930373
                                         uncertainty =       0.040040584224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790361930373
                                         uncertainty =       0.040040584224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376509995
  error estimate for blocks of size 2^( 2) =       0.001447386587
  error estimate for blocks of size 2^( 3) =       0.001511267351
  error estimate for blocks of size 2^( 4) =       0.001555026126
  error estimate for blocks of size 2^( 5) =       0.001580950155
  error estimate for blocks of size 2^( 6) =       0.001585320791
  error estimate for blocks of size 2^( 7) =       0.001593401456

      target function =                  N/A
              le_mean =     -22.328131442508
             les_mean =     502.285203653620
             stat err =       0.001578674632
             autocorr =       1.315305154943
              std dev =       1.946710250266
             le_variance =       3.789680798491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790444497627
                                         uncertainty =       0.040044867993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.790444497627
                                         uncertainty =       0.040044867993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376525861
  error estimate for blocks of size 2^( 2) =       0.001447403048
  error estimate for blocks of size 2^( 3) =       0.001511281939
  error estimate for blocks of size 2^( 4) =       0.001555041408
  error estimate for blocks of size 2^( 5) =       0.001580957720
  error estimate for blocks of size 2^( 6) =       0.001585318356
  error estimate for blocks of size 2^( 7) =       0.001593405998

      target function =                  N/A
              le_mean =     -22.328131481173
             les_mean =     502.284990727495
             stat err =       0.001578680870
             autocorr =       1.315285229913
              std dev =       1.946732688032
             le_variance =       3.789768158653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328131074633        initial
     5.5511e-01     5.5511e+00             7.2934e-04       -22.328133934183  <--
     2.2204e+00     2.2204e+01             2.1310e-04       -22.328131442508
     8.8818e+00     8.8818e+01             5.5686e-05       -22.328131481173

*****************************************************************************
Applying the update for shift_i =   5.5511e-01     and shift_s =   5.5511e+00
*****************************************************************************

  Execution time = 4.6649e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -6.885816e-01 3 1  ON 0
ci_002                -7.120776e-01 3 1  ON 1
ci_003                -6.109991e-02 3 1  ON 2
ci_004                -6.386441e-02 3 1  ON 3
ci_005                 4.491175e-02 3 1  ON 4
ci_006                 4.668964e-02 3 1  ON 5
ci_007                 3.122221e-02 3 1  ON 6
ci_008                 3.253409e-02 3 1  ON 7
ci_009                -2.439063e-02 3 1  ON 8
ci_010                -2.549624e-02 3 1  ON 9
ci_011                -2.267260e-02 3 1  ON 10
ci_012                -2.295477e-02 3 1  ON 11
ci_013                 1.973838e-02 3 1  ON 12
ci_014                 2.133169e-02 3 1  ON 13
ci_015                 1.935308e-02 3 1  ON 14
ci_016                 2.092681e-02 3 1  ON 15
ci_017                 1.440722e-02 3 1  ON 16
ci_018                 1.606390e-02 3 1  ON 17
ci_019                 9.963049e-03 3 1  ON 18
ci_020                 9.737864e-03 3 1  ON 19
ci_021                -9.906741e-03 3 1  ON 20
ci_022                -1.058546e-02 3 1  ON 21
ci_023                 8.931343e-03 3 1  ON 22
ci_024                 8.624330e-03 3 1  ON 23
ci_025                 7.808194e-03 3 1  ON 24
ci_026                 8.904304e-03 3 1  ON 25
ci_027                 7.656819e-03 3 1  ON 26
ci_028                 7.877203e-03 3 1  ON 27
ci_029                -7.037249e-03 3 1  ON 28
ci_030                -7.732096e-03 3 1  ON 29
ci_031                -7.349515e-03 3 1  ON 30
ci_032                -7.627204e-03 3 1  ON 31
ci_033                 7.004881e-03 3 1  ON 32
ci_034                 7.192229e-03 3 1  ON 33
ci_035                 6.647746e-03 3 1  ON 34
ci_036                 6.538971e-03 3 1  ON 35
ci_037                 6.570456e-03 3 1  ON 36
ci_038                 6.052156e-03 3 1  ON 37
ci_039                 5.583148e-03 3 1  ON 38
ci_040                 5.607290e-03 3 1  ON 39
ci_041                 4.971239e-03 3 1  ON 40
ci_042                 5.150368e-03 3 1  ON 41
ci_043                 4.691254e-03 3 1  ON 42
ci_044                 5.192363e-03 3 1  ON 43
ci_045                 5.098928e-03 3 1  ON 44
ci_046                 4.899266e-03 3 1  ON 45
ci_047                -4.264026e-03 3 1  ON 46
ci_048                -4.524929e-03 3 1  ON 47
ci_049                 3.524903e-03 3 1  ON 48
ci_050                 3.065188e-03 3 1  ON 49
ci_051                -2.610799e-03 3 1  ON 50
ci_052                -3.376594e-03 3 1  ON 51
ci_053                -2.867240e-03 3 1  ON 52
ci_054                -2.200168e-03 3 1  ON 53
ci_055                -2.112973e-03 3 1  ON 54
ci_056                -1.821976e-03 3 1  ON 55
ci_057                -1.946862e-03 3 1  ON 56
ci_058                -1.672110e-03 3 1  ON 57
ci_059                -1.775757e-03 3 1  ON 58
ci_060                -2.437763e-03 3 1  ON 59
ci_061                -1.383728e-03 3 1  ON 60
ci_062                -7.934554e-04 3 1  ON 61
ci_063                -1.381958e-03 3 1  ON 62
ci_064                -1.110408e-03 3 1  ON 63
ci_065                -1.436450e-03 3 1  ON 64
ci_066                -1.548036e-03 3 1  ON 65
ci_067                -1.942751e-04 3 1  ON 66
ci_068                -8.993819e-04 3 1  ON 67
ci_069                 9.433371e-04 3 1  ON 68
ci_070                 1.971614e-03 3 1  ON 69
ci_071                -9.419466e-04 3 1  ON 70
ci_072                -1.019203e-03 3 1  ON 71
ci_073                 1.026500e-03 3 1  ON 72
ci_074                 1.199861e-03 3 1  ON 73
ci_075                -7.314029e-04 3 1  ON 74
ci_076                -1.508891e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7243e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2314e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.0122
    reference variance = 4.42335
====================================================
  Execution time = 2.4317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0348e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.8607e+00
  Total weights = 1.950277661e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9414e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.915394218585
                                         uncertainty =       0.093761913600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.915394218585
                                         uncertainty =       0.093761913600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001398894419
  error estimate for blocks of size 2^( 2) =       0.001468764024
  error estimate for blocks of size 2^( 3) =       0.001532141116
  error estimate for blocks of size 2^( 4) =       0.001574226295
  error estimate for blocks of size 2^( 5) =       0.001601090730
  error estimate for blocks of size 2^( 6) =       0.001618674472
  error estimate for blocks of size 2^( 7) =       0.001628530774

      target function =                  N/A
              le_mean =     -22.327478764877
             les_mean =     502.377016099234
             stat err =       0.001605630568
             autocorr =       1.317411288111
              std dev =       1.978367112577
             le_variance =       3.913936432128


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232747876488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e-01, overlap shift 1.3878e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327478764038       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327533255477       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327536949648       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327538440128       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327538167426       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327538242070       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e-01 is 1.490554e-03

solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327478764038       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327503057044       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327503362929       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327503440786       residual = 8.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e-01 is 5.687163e-04

solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327478764038       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327486316050       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327486310849       residual = 8.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+00 is 1.742586e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174517 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0272e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -6.881925e-01 3 1  ON 0
ci_002                -7.124192e-01 3 1  ON 1
ci_003                -6.140868e-02 3 1  ON 2
ci_004                -6.364466e-02 3 1  ON 3
ci_005                 4.510989e-02 3 1  ON 4
ci_006                 4.698952e-02 3 1  ON 5
ci_007                 3.178546e-02 3 1  ON 6
ci_008                 3.253389e-02 3 1  ON 7
ci_009                -2.444546e-02 3 1  ON 8
ci_010                -2.540343e-02 3 1  ON 9
ci_011                -2.264350e-02 3 1  ON 10
ci_012                -2.277357e-02 3 1  ON 11
ci_013                 1.976016e-02 3 1  ON 12
ci_014                 2.172842e-02 3 1  ON 13
ci_015                 1.911180e-02 3 1  ON 14
ci_016                 2.069057e-02 3 1  ON 15
ci_017                 1.411577e-02 3 1  ON 16
ci_018                 1.578333e-02 3 1  ON 17
ci_019                 9.919677e-03 3 1  ON 18
ci_020                 9.791427e-03 3 1  ON 19
ci_021                -9.767320e-03 3 1  ON 20
ci_022                -1.047136e-02 3 1  ON 21
ci_023                 8.859584e-03 3 1  ON 22
ci_024                 8.669415e-03 3 1  ON 23
ci_025                 8.041668e-03 3 1  ON 24
ci_026                 8.842873e-03 3 1  ON 25
ci_027                 7.585705e-03 3 1  ON 26
ci_028                 8.188027e-03 3 1  ON 27
ci_029                -6.706024e-03 3 1  ON 28
ci_030                -7.552721e-03 3 1  ON 29
ci_031                -7.249529e-03 3 1  ON 30
ci_032                -7.586473e-03 3 1  ON 31
ci_033                 6.924451e-03 3 1  ON 32
ci_034                 7.394736e-03 3 1  ON 33
ci_035                 6.146805e-03 3 1  ON 34
ci_036                 6.491442e-03 3 1  ON 35
ci_037                 6.627368e-03 3 1  ON 36
ci_038                 6.020968e-03 3 1  ON 37
ci_039                 5.835350e-03 3 1  ON 38
ci_040                 5.674661e-03 3 1  ON 39
ci_041                 5.000543e-03 3 1  ON 40
ci_042                 5.125008e-03 3 1  ON 41
ci_043                 5.017186e-03 3 1  ON 42
ci_044                 5.019252e-03 3 1  ON 43
ci_045                 5.101915e-03 3 1  ON 44
ci_046                 5.226549e-03 3 1  ON 45
ci_047                -4.159989e-03 3 1  ON 46
ci_048                -4.447975e-03 3 1  ON 47
ci_049                 3.375882e-03 3 1  ON 48
ci_050                 2.915628e-03 3 1  ON 49
ci_051                -2.610400e-03 3 1  ON 50
ci_052                -3.200896e-03 3 1  ON 51
ci_053                -2.977147e-03 3 1  ON 52
ci_054                -2.052962e-03 3 1  ON 53
ci_055                -1.974667e-03 3 1  ON 54
ci_056                -1.512423e-03 3 1  ON 55
ci_057                -2.027539e-03 3 1  ON 56
ci_058                -1.505916e-03 3 1  ON 57
ci_059                -1.881855e-03 3 1  ON 58
ci_060                -2.325639e-03 3 1  ON 59
ci_061                -1.403012e-03 3 1  ON 60
ci_062                -1.198758e-03 3 1  ON 61
ci_063                -1.000223e-03 3 1  ON 62
ci_064                -1.148743e-03 3 1  ON 63
ci_065                -1.404814e-03 3 1  ON 64
ci_066                -2.116752e-03 3 1  ON 65
ci_067                -3.836567e-04 3 1  ON 66
ci_068                -1.045746e-03 3 1  ON 67
ci_069                 1.118385e-03 3 1  ON 68
ci_070                 2.105686e-03 3 1  ON 69
ci_071                -1.310711e-03 3 1  ON 70
ci_072                -9.078471e-04 3 1  ON 71
ci_073                 8.266884e-04 3 1  ON 72
ci_074                 1.177100e-03 3 1  ON 73
ci_075                -7.610969e-04 3 1  ON 74
ci_076                -1.314476e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.449
    reference variance = 2.86427
====================================================
  Execution time = 2.3673e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6497e+00
  Total weights = 1.9493e+06
  Execution time = 4.4347e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.699574850920
                                         uncertainty =       0.028642916824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.699574850920
                                         uncertainty =       0.028642916824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001360000873
  error estimate for blocks of size 2^( 2) =       0.001430378021
  error estimate for blocks of size 2^( 3) =       0.001493330347
  error estimate for blocks of size 2^( 4) =       0.001537015489
  error estimate for blocks of size 2^( 5) =       0.001562271392
  error estimate for blocks of size 2^( 6) =       0.001576037847
  error estimate for blocks of size 2^( 7) =       0.001586487664

      target function =                  N/A
              le_mean =     -22.328225569628
             les_mean =     502.202968464423
             stat err =       0.001565453098
             autocorr =       1.324956885818
              std dev =       1.923362452177
             le_variance =       3.699323122446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.699582157291
                                         uncertainty =       0.028667344022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.699582157291
                                         uncertainty =       0.028667344022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001360001979
  error estimate for blocks of size 2^( 2) =       0.001430359663
  error estimate for blocks of size 2^( 3) =       0.001493289797
  error estimate for blocks of size 2^( 4) =       0.001536969191
  error estimate for blocks of size 2^( 5) =       0.001562205898
  error estimate for blocks of size 2^( 6) =       0.001575960442
  error estimate for blocks of size 2^( 7) =       0.001586428815

      target function =                  N/A
              le_mean =     -22.328222447498
             les_mean =     502.200200461773
             stat err =       0.001565391087
             autocorr =       1.324849764161
              std dev =       1.923364016082
             le_variance =       3.699329138358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.699601348261
                                         uncertainty =       0.028668654535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.699601348261
                                         uncertainty =       0.028668654535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001360005538
  error estimate for blocks of size 2^( 2) =       0.001430360904
  error estimate for blocks of size 2^( 3) =       0.001493291332
  error estimate for blocks of size 2^( 4) =       0.001536970557
  error estimate for blocks of size 2^( 5) =       0.001562215058
  error estimate for blocks of size 2^( 6) =       0.001575967836
  error estimate for blocks of size 2^( 7) =       0.001586429972

      target function =                  N/A
              le_mean =     -22.328219507036
             les_mean =     502.201111016043
             stat err =       0.001565395856
             autocorr =       1.324850902134
              std dev =       1.923369049568
             le_variance =       3.699348500837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.699565102220
                                         uncertainty =       0.028646554931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.699565102220
                                         uncertainty =       0.028646554931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359999049
  error estimate for blocks of size 2^( 2) =       0.001430372908
  error estimate for blocks of size 2^( 3) =       0.001493319901
  error estimate for blocks of size 2^( 4) =       0.001537004214
  error estimate for blocks of size 2^( 5) =       0.001562261576
  error estimate for blocks of size 2^( 6) =       0.001576022588
  error estimate for blocks of size 2^( 7) =       0.001586473837

      target function =                  N/A
              le_mean =     -22.328220787667
             les_mean =     502.213123702098
             stat err =       0.001565440554
             autocorr =       1.324939205124
              std dev =       1.923359873130
             le_variance =       3.699313201567


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328225569628        initial  <--
     1.3878e-01     1.3878e+00             1.4906e-03       -22.328222447498
     5.5511e-01     5.5511e+00             5.6872e-04       -22.328219507036
     2.2204e+00     2.2204e+01             1.7426e-04       -22.328220787667

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.9638
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -6.885816e-01 3 1  ON 0
ci_002                -7.120776e-01 3 1  ON 1
ci_003                -6.109991e-02 3 1  ON 2
ci_004                -6.386441e-02 3 1  ON 3
ci_005                 4.491175e-02 3 1  ON 4
ci_006                 4.668964e-02 3 1  ON 5
ci_007                 3.122221e-02 3 1  ON 6
ci_008                 3.253409e-02 3 1  ON 7
ci_009                -2.439063e-02 3 1  ON 8
ci_010                -2.549624e-02 3 1  ON 9
ci_011                -2.267260e-02 3 1  ON 10
ci_012                -2.295477e-02 3 1  ON 11
ci_013                 1.973838e-02 3 1  ON 12
ci_014                 2.133169e-02 3 1  ON 13
ci_015                 1.935308e-02 3 1  ON 14
ci_016                 2.092681e-02 3 1  ON 15
ci_017                 1.440722e-02 3 1  ON 16
ci_018                 1.606390e-02 3 1  ON 17
ci_019                 9.963049e-03 3 1  ON 18
ci_020                 9.737864e-03 3 1  ON 19
ci_021                -9.906741e-03 3 1  ON 20
ci_022                -1.058546e-02 3 1  ON 21
ci_023                 8.931343e-03 3 1  ON 22
ci_024                 8.624330e-03 3 1  ON 23
ci_025                 7.808194e-03 3 1  ON 24
ci_026                 8.904304e-03 3 1  ON 25
ci_027                 7.656819e-03 3 1  ON 26
ci_028                 7.877203e-03 3 1  ON 27
ci_029                -7.037249e-03 3 1  ON 28
ci_030                -7.732096e-03 3 1  ON 29
ci_031                -7.349515e-03 3 1  ON 30
ci_032                -7.627204e-03 3 1  ON 31
ci_033                 7.004881e-03 3 1  ON 32
ci_034                 7.192229e-03 3 1  ON 33
ci_035                 6.647746e-03 3 1  ON 34
ci_036                 6.538971e-03 3 1  ON 35
ci_037                 6.570456e-03 3 1  ON 36
ci_038                 6.052156e-03 3 1  ON 37
ci_039                 5.583148e-03 3 1  ON 38
ci_040                 5.607290e-03 3 1  ON 39
ci_041                 4.971239e-03 3 1  ON 40
ci_042                 5.150368e-03 3 1  ON 41
ci_043                 4.691254e-03 3 1  ON 42
ci_044                 5.192363e-03 3 1  ON 43
ci_045                 5.098928e-03 3 1  ON 44
ci_046                 4.899266e-03 3 1  ON 45
ci_047                -4.264026e-03 3 1  ON 46
ci_048                -4.524929e-03 3 1  ON 47
ci_049                 3.524903e-03 3 1  ON 48
ci_050                 3.065188e-03 3 1  ON 49
ci_051                -2.610799e-03 3 1  ON 50
ci_052                -3.376594e-03 3 1  ON 51
ci_053                -2.867240e-03 3 1  ON 52
ci_054                -2.200168e-03 3 1  ON 53
ci_055                -2.112973e-03 3 1  ON 54
ci_056                -1.821976e-03 3 1  ON 55
ci_057                -1.946862e-03 3 1  ON 56
ci_058                -1.672110e-03 3 1  ON 57
ci_059                -1.775757e-03 3 1  ON 58
ci_060                -2.437763e-03 3 1  ON 59
ci_061                -1.383728e-03 3 1  ON 60
ci_062                -7.934554e-04 3 1  ON 61
ci_063                -1.381958e-03 3 1  ON 62
ci_064                -1.110408e-03 3 1  ON 63
ci_065                -1.436450e-03 3 1  ON 64
ci_066                -1.548036e-03 3 1  ON 65
ci_067                -1.942751e-04 3 1  ON 66
ci_068                -8.993819e-04 3 1  ON 67
ci_069                 9.433371e-04 3 1  ON 68
ci_070                 1.971614e-03 3 1  ON 69
ci_071                -9.419466e-04 3 1  ON 70
ci_072                -1.019203e-03 3 1  ON 71
ci_073                 1.026500e-03 3 1  ON 72
ci_074                 1.199861e-03 3 1  ON 73
ci_075                -7.314029e-04 3 1  ON 74
ci_076                -1.508891e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6245e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.0993
    reference variance = 2.59115
====================================================
  Execution time = 2.4179e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0317e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7328e+00
  Total weights = 1.950101158e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0192e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783451544073
                                         uncertainty =       0.041432623717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783451544073
                                         uncertainty =       0.041432623717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375278315
  error estimate for blocks of size 2^( 2) =       0.001445615464
  error estimate for blocks of size 2^( 3) =       0.001509242479
  error estimate for blocks of size 2^( 4) =       0.001552568421
  error estimate for blocks of size 2^( 5) =       0.001577696543
  error estimate for blocks of size 2^( 6) =       0.001584883198
  error estimate for blocks of size 2^( 7) =       0.001592989763

      target function =                  N/A
              le_mean =     -22.328483167841
             les_mean =     502.293957331877
             stat err =       0.001577034481
             autocorr =       1.314925620746
              std dev =       1.944968364517
             le_variance =       3.782901938972


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232848316784e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+00, overlap shift 1.3878e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328483167060       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328497500018       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328497693029       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328497696736       residual = 5.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+00 is 2.961586e-04

solving harmonic davidson linear method for identity shift 5.5511e+00, overlap shift 5.5511e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328483167060       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328487114038       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328487167316       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328487174983       residual = 7.05e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+00 is 8.514147e-05

solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328483167060       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328484179498       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328484193644       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328484196051       residual = 6.17e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+01 is 2.211256e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176052 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0206e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -6.886072e-01 3 1  ON 0
ci_002                -7.120554e-01 3 1  ON 1
ci_003                -6.105436e-02 3 1  ON 2
ci_004                -6.388636e-02 3 1  ON 3
ci_005                 4.494304e-02 3 1  ON 4
ci_006                 4.671157e-02 3 1  ON 5
ci_007                 3.121266e-02 3 1  ON 6
ci_008                 3.250177e-02 3 1  ON 7
ci_009                -2.434809e-02 3 1  ON 8
ci_010                -2.548354e-02 3 1  ON 9
ci_011                -2.260778e-02 3 1  ON 10
ci_012                -2.297391e-02 3 1  ON 11
ci_013                 1.972704e-02 3 1  ON 12
ci_014                 2.133580e-02 3 1  ON 13
ci_015                 1.941102e-02 3 1  ON 14
ci_016                 2.090617e-02 3 1  ON 15
ci_017                 1.444109e-02 3 1  ON 16
ci_018                 1.604456e-02 3 1  ON 17
ci_019                 9.949850e-03 3 1  ON 18
ci_020                 9.716232e-03 3 1  ON 19
ci_021                -9.914690e-03 3 1  ON 20
ci_022                -1.057379e-02 3 1  ON 21
ci_023                 8.894690e-03 3 1  ON 22
ci_024                 8.644126e-03 3 1  ON 23
ci_025                 7.791926e-03 3 1  ON 24
ci_026                 8.899393e-03 3 1  ON 25
ci_027                 7.622947e-03 3 1  ON 26
ci_028                 7.962344e-03 3 1  ON 27
ci_029                -7.081320e-03 3 1  ON 28
ci_030                -7.726737e-03 3 1  ON 29
ci_031                -7.376646e-03 3 1  ON 30
ci_032                -7.647998e-03 3 1  ON 31
ci_033                 6.997236e-03 3 1  ON 32
ci_034                 7.213992e-03 3 1  ON 33
ci_035                 6.665707e-03 3 1  ON 34
ci_036                 6.560994e-03 3 1  ON 35
ci_037                 6.517306e-03 3 1  ON 36
ci_038                 6.089483e-03 3 1  ON 37
ci_039                 5.591899e-03 3 1  ON 38
ci_040                 5.611880e-03 3 1  ON 39
ci_041                 4.972634e-03 3 1  ON 40
ci_042                 5.193652e-03 3 1  ON 41
ci_043                 4.695008e-03 3 1  ON 42
ci_044                 5.183531e-03 3 1  ON 43
ci_045                 5.108382e-03 3 1  ON 44
ci_046                 4.865184e-03 3 1  ON 45
ci_047                -4.267645e-03 3 1  ON 46
ci_048                -4.492238e-03 3 1  ON 47
ci_049                 3.569245e-03 3 1  ON 48
ci_050                 3.062894e-03 3 1  ON 49
ci_051                -2.599819e-03 3 1  ON 50
ci_052                -3.327258e-03 3 1  ON 51
ci_053                -2.852223e-03 3 1  ON 52
ci_054                -2.213486e-03 3 1  ON 53
ci_055                -2.126799e-03 3 1  ON 54
ci_056                -1.808187e-03 3 1  ON 55
ci_057                -1.944455e-03 3 1  ON 56
ci_058                -1.609401e-03 3 1  ON 57
ci_059                -1.835292e-03 3 1  ON 58
ci_060                -2.382886e-03 3 1  ON 59
ci_061                -1.411268e-03 3 1  ON 60
ci_062                -8.336537e-04 3 1  ON 61
ci_063                -1.377883e-03 3 1  ON 62
ci_064                -1.140672e-03 3 1  ON 63
ci_065                -1.367649e-03 3 1  ON 64
ci_066                -1.548401e-03 3 1  ON 65
ci_067                -2.315702e-04 3 1  ON 66
ci_068                -9.079264e-04 3 1  ON 67
ci_069                 9.423928e-04 3 1  ON 68
ci_070                 1.915419e-03 3 1  ON 69
ci_071                -9.614328e-04 3 1  ON 70
ci_072                -1.036383e-03 3 1  ON 71
ci_073                 9.962411e-04 3 1  ON 72
ci_074                 1.162103e-03 3 1  ON 73
ci_075                -7.373368e-04 3 1  ON 74
ci_076                -1.459052e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.1437
    reference variance = 5.17761
====================================================
  Execution time = 2.3706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6618e+00
  Total weights = 1.9499e+06
  Execution time = 4.4687e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.713068247591
                                         uncertainty =       0.039676548327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.713068247591
                                         uncertainty =       0.039676548327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362439579
  error estimate for blocks of size 2^( 2) =       0.001433361713
  error estimate for blocks of size 2^( 3) =       0.001497511886
  error estimate for blocks of size 2^( 4) =       0.001542481777
  error estimate for blocks of size 2^( 5) =       0.001569478782
  error estimate for blocks of size 2^( 6) =       0.001585028643
  error estimate for blocks of size 2^( 7) =       0.001591667826

      target function =                  N/A
              le_mean =     -22.330037296943
             les_mean =     502.292367708110
             stat err =       0.001572164257
             autocorr =       1.331561819434
              std dev =       1.926811358883
             le_variance =       3.712602012720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.713049437197
                                         uncertainty =       0.039677570619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.713049437197
                                         uncertainty =       0.039677570619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362436378
  error estimate for blocks of size 2^( 2) =       0.001433358006
  error estimate for blocks of size 2^( 3) =       0.001497507641
  error estimate for blocks of size 2^( 4) =       0.001542478654
  error estimate for blocks of size 2^( 5) =       0.001569474271
  error estimate for blocks of size 2^( 6) =       0.001585026098
  error estimate for blocks of size 2^( 7) =       0.001591671609

      target function =                  N/A
              le_mean =     -22.330033753982
             les_mean =     502.295675960923
             stat err =       0.001572162658
             autocorr =       1.331565368453
              std dev =       1.926806831206
             le_variance =       3.712584564780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.713056768393
                                         uncertainty =       0.039677085686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.713056768393
                                         uncertainty =       0.039677085686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362437612
  error estimate for blocks of size 2^( 2) =       0.001433359587
  error estimate for blocks of size 2^( 3) =       0.001497509438
  error estimate for blocks of size 2^( 4) =       0.001542479819
  error estimate for blocks of size 2^( 5) =       0.001569476264
  error estimate for blocks of size 2^( 6) =       0.001585026622
  error estimate for blocks of size 2^( 7) =       0.001591668205

      target function =                  N/A
              le_mean =     -22.330034593893
             les_mean =     502.293345191328
             stat err =       0.001572162728
             autocorr =       1.331563074138
              std dev =       1.926808576777
             le_variance =       3.712591291541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.713066561987
                                         uncertainty =       0.039676616508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.713066561987
                                         uncertainty =       0.039676616508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001362439288
  error estimate for blocks of size 2^( 2) =       0.001433361404
  error estimate for blocks of size 2^( 3) =       0.001497511538
  error estimate for blocks of size 2^( 4) =       0.001542481488
  error estimate for blocks of size 2^( 5) =       0.001569478381
  error estimate for blocks of size 2^( 6) =       0.001585028308
  error estimate for blocks of size 2^( 7) =       0.001591667824

      target function =                  N/A
              le_mean =     -22.330036891522
             les_mean =     502.292332164821
             stat err =       0.001572164000
             autocorr =       1.331561954367
              std dev =       1.926810946669
             le_variance =       3.712600424205


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330037296943        initial  <--
     1.3878e+00     1.3878e+01             2.9616e-04       -22.330033753982
     5.5511e+00     5.5511e+01             8.5141e-05       -22.330034593893
     2.2204e+01     2.2204e+02             2.2113e-05       -22.330036891522

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.1771
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -6.885816e-01 3 1  ON 0
ci_002                -7.120776e-01 3 1  ON 1
ci_003                -6.109991e-02 3 1  ON 2
ci_004                -6.386441e-02 3 1  ON 3
ci_005                 4.491175e-02 3 1  ON 4
ci_006                 4.668964e-02 3 1  ON 5
ci_007                 3.122221e-02 3 1  ON 6
ci_008                 3.253409e-02 3 1  ON 7
ci_009                -2.439063e-02 3 1  ON 8
ci_010                -2.549624e-02 3 1  ON 9
ci_011                -2.267260e-02 3 1  ON 10
ci_012                -2.295477e-02 3 1  ON 11
ci_013                 1.973838e-02 3 1  ON 12
ci_014                 2.133169e-02 3 1  ON 13
ci_015                 1.935308e-02 3 1  ON 14
ci_016                 2.092681e-02 3 1  ON 15
ci_017                 1.440722e-02 3 1  ON 16
ci_018                 1.606390e-02 3 1  ON 17
ci_019                 9.963049e-03 3 1  ON 18
ci_020                 9.737864e-03 3 1  ON 19
ci_021                -9.906741e-03 3 1  ON 20
ci_022                -1.058546e-02 3 1  ON 21
ci_023                 8.931343e-03 3 1  ON 22
ci_024                 8.624330e-03 3 1  ON 23
ci_025                 7.808194e-03 3 1  ON 24
ci_026                 8.904304e-03 3 1  ON 25
ci_027                 7.656819e-03 3 1  ON 26
ci_028                 7.877203e-03 3 1  ON 27
ci_029                -7.037249e-03 3 1  ON 28
ci_030                -7.732096e-03 3 1  ON 29
ci_031                -7.349515e-03 3 1  ON 30
ci_032                -7.627204e-03 3 1  ON 31
ci_033                 7.004881e-03 3 1  ON 32
ci_034                 7.192229e-03 3 1  ON 33
ci_035                 6.647746e-03 3 1  ON 34
ci_036                 6.538971e-03 3 1  ON 35
ci_037                 6.570456e-03 3 1  ON 36
ci_038                 6.052156e-03 3 1  ON 37
ci_039                 5.583148e-03 3 1  ON 38
ci_040                 5.607290e-03 3 1  ON 39
ci_041                 4.971239e-03 3 1  ON 40
ci_042                 5.150368e-03 3 1  ON 41
ci_043                 4.691254e-03 3 1  ON 42
ci_044                 5.192363e-03 3 1  ON 43
ci_045                 5.098928e-03 3 1  ON 44
ci_046                 4.899266e-03 3 1  ON 45
ci_047                -4.264026e-03 3 1  ON 46
ci_048                -4.524929e-03 3 1  ON 47
ci_049                 3.524903e-03 3 1  ON 48
ci_050                 3.065188e-03 3 1  ON 49
ci_051                -2.610799e-03 3 1  ON 50
ci_052                -3.376594e-03 3 1  ON 51
ci_053                -2.867240e-03 3 1  ON 52
ci_054                -2.200168e-03 3 1  ON 53
ci_055                -2.112973e-03 3 1  ON 54
ci_056                -1.821976e-03 3 1  ON 55
ci_057                -1.946862e-03 3 1  ON 56
ci_058                -1.672110e-03 3 1  ON 57
ci_059                -1.775757e-03 3 1  ON 58
ci_060                -2.437763e-03 3 1  ON 59
ci_061                -1.383728e-03 3 1  ON 60
ci_062                -7.934554e-04 3 1  ON 61
ci_063                -1.381958e-03 3 1  ON 62
ci_064                -1.110408e-03 3 1  ON 63
ci_065                -1.436450e-03 3 1  ON 64
ci_066                -1.548036e-03 3 1  ON 65
ci_067                -1.942751e-04 3 1  ON 66
ci_068                -8.993819e-04 3 1  ON 67
ci_069                 9.433371e-04 3 1  ON 68
ci_070                 1.971614e-03 3 1  ON 69
ci_071                -9.419466e-04 3 1  ON 70
ci_072                -1.019203e-03 3 1  ON 71
ci_073                 1.026500e-03 3 1  ON 72
ci_074                 1.199861e-03 3 1  ON 73
ci_075                -7.314029e-04 3 1  ON 74
ci_076                -1.508891e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.2181
    reference variance = 3.56875
====================================================
  Execution time = 2.4422e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0321e+04
  VMC Eavg = -2.2332e+01
  VMC Evar = 3.6829e+00
  Total weights = 1.950090946e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9701e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734650576274
                                         uncertainty =       0.026137199062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734650576274
                                         uncertainty =       0.026137199062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366459605
  error estimate for blocks of size 2^( 2) =       0.001436738028
  error estimate for blocks of size 2^( 3) =       0.001500274811
  error estimate for blocks of size 2^( 4) =       0.001544193002
  error estimate for blocks of size 2^( 5) =       0.001571191122
  error estimate for blocks of size 2^( 6) =       0.001585484025
  error estimate for blocks of size 2^( 7) =       0.001600684046

      target function =                  N/A
              le_mean =     -22.331779998676
             les_mean =     502.391289589386
             stat err =       0.001575388049
             autocorr =       1.329172960447
              std dev =       1.932496624909
             le_variance =       3.734543205286


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233177999868e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+01, overlap shift 1.3878e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331779997882       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331781177558       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331781209284       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+01 is 2.608378e-05

solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331779997882       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331780295754       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331780303831       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+01 is 6.578668e-06

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.331779997882       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.331780072537       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.331780074566       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+02 is 1.648324e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177240 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0398e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -6.885818e-01 3 1  ON 0
ci_002                -7.120772e-01 3 1  ON 1
ci_003                -6.110013e-02 3 1  ON 2
ci_004                -6.386616e-02 3 1  ON 3
ci_005                 4.491138e-02 3 1  ON 4
ci_006                 4.668568e-02 3 1  ON 5
ci_007                 3.122722e-02 3 1  ON 6
ci_008                 3.253301e-02 3 1  ON 7
ci_009                -2.439472e-02 3 1  ON 8
ci_010                -2.549419e-02 3 1  ON 9
ci_011                -2.267627e-02 3 1  ON 10
ci_012                -2.295602e-02 3 1  ON 11
ci_013                 1.974392e-02 3 1  ON 12
ci_014                 2.132927e-02 3 1  ON 13
ci_015                 1.935693e-02 3 1  ON 14
ci_016                 2.092231e-02 3 1  ON 15
ci_017                 1.440573e-02 3 1  ON 16
ci_018                 1.606284e-02 3 1  ON 17
ci_019                 9.965011e-03 3 1  ON 18
ci_020                 9.741634e-03 3 1  ON 19
ci_021                -9.904668e-03 3 1  ON 20
ci_022                -1.058165e-02 3 1  ON 21
ci_023                 8.932609e-03 3 1  ON 22
ci_024                 8.626915e-03 3 1  ON 23
ci_025                 7.808595e-03 3 1  ON 24
ci_026                 8.904936e-03 3 1  ON 25
ci_027                 7.658089e-03 3 1  ON 26
ci_028                 7.877269e-03 3 1  ON 27
ci_029                -7.040740e-03 3 1  ON 28
ci_030                -7.735631e-03 3 1  ON 29
ci_031                -7.350661e-03 3 1  ON 30
ci_032                -7.628393e-03 3 1  ON 31
ci_033                 7.002977e-03 3 1  ON 32
ci_034                 7.188068e-03 3 1  ON 33
ci_035                 6.644705e-03 3 1  ON 34
ci_036                 6.538371e-03 3 1  ON 35
ci_037                 6.565898e-03 3 1  ON 36
ci_038                 6.052564e-03 3 1  ON 37
ci_039                 5.582667e-03 3 1  ON 38
ci_040                 5.609991e-03 3 1  ON 39
ci_041                 4.975362e-03 3 1  ON 40
ci_042                 5.150631e-03 3 1  ON 41
ci_043                 4.687076e-03 3 1  ON 42
ci_044                 5.188269e-03 3 1  ON 43
ci_045                 5.100636e-03 3 1  ON 44
ci_046                 4.900773e-03 3 1  ON 45
ci_047                -4.259099e-03 3 1  ON 46
ci_048                -4.521431e-03 3 1  ON 47
ci_049                 3.520941e-03 3 1  ON 48
ci_050                 3.063722e-03 3 1  ON 49
ci_051                -2.606770e-03 3 1  ON 50
ci_052                -3.370015e-03 3 1  ON 51
ci_053                -2.872355e-03 3 1  ON 52
ci_054                -2.200241e-03 3 1  ON 53
ci_055                -2.112818e-03 3 1  ON 54
ci_056                -1.820639e-03 3 1  ON 55
ci_057                -1.951459e-03 3 1  ON 56
ci_058                -1.677879e-03 3 1  ON 57
ci_059                -1.779880e-03 3 1  ON 58
ci_060                -2.433745e-03 3 1  ON 59
ci_061                -1.380854e-03 3 1  ON 60
ci_062                -7.945184e-04 3 1  ON 61
ci_063                -1.382687e-03 3 1  ON 62
ci_064                -1.108262e-03 3 1  ON 63
ci_065                -1.434919e-03 3 1  ON 64
ci_066                -1.546849e-03 3 1  ON 65
ci_067                -1.958496e-04 3 1  ON 66
ci_068                -9.012298e-04 3 1  ON 67
ci_069                 9.475260e-04 3 1  ON 68
ci_070                 1.970801e-03 3 1  ON 69
ci_071                -9.412546e-04 3 1  ON 70
ci_072                -1.017753e-03 3 1  ON 71
ci_073                 1.029137e-03 3 1  ON 72
ci_074                 1.198737e-03 3 1  ON 73
ci_075                -7.336910e-04 3 1  ON 74
ci_076                -1.507358e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.4692
    reference variance = 3.63751
====================================================
  Execution time = 2.5910e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7626e+00
  Total weights = 1.9499e+06
  Execution time = 4.4633e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812323962456
                                         uncertainty =       0.060711509772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812323962456
                                         uncertainty =       0.060711509772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380541320
  error estimate for blocks of size 2^( 2) =       0.001451818909
  error estimate for blocks of size 2^( 3) =       0.001514923489
  error estimate for blocks of size 2^( 4) =       0.001557648738
  error estimate for blocks of size 2^( 5) =       0.001581121702
  error estimate for blocks of size 2^( 6) =       0.001593355107
  error estimate for blocks of size 2^( 7) =       0.001595286401

      target function =                  N/A
              le_mean =     -22.325840563417
             les_mean =     502.205802744574
             stat err =       0.001581852987
             autocorr =       1.312905350809
              std dev =       1.952411495995
             le_variance =       3.811910649692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812323048238
                                         uncertainty =       0.060711502087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812323048238
                                         uncertainty =       0.060711502087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380541161
  error estimate for blocks of size 2^( 2) =       0.001451818572
  error estimate for blocks of size 2^( 3) =       0.001514923073
  error estimate for blocks of size 2^( 4) =       0.001557648582
  error estimate for blocks of size 2^( 5) =       0.001581121630
  error estimate for blocks of size 2^( 6) =       0.001593355102
  error estimate for blocks of size 2^( 7) =       0.001595286491

      target function =                  N/A
              le_mean =     -22.325840780839
             les_mean =     502.205828167561
             stat err =       0.001581852951
             autocorr =       1.312905593811
              std dev =       1.952411271240
             le_variance =       3.811909772064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812323474552
                                         uncertainty =       0.060711506012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812323474552
                                         uncertainty =       0.060711506012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380541235
  error estimate for blocks of size 2^( 2) =       0.001451818734
  error estimate for blocks of size 2^( 3) =       0.001514923274
  error estimate for blocks of size 2^( 4) =       0.001557648654
  error estimate for blocks of size 2^( 5) =       0.001581121660
  error estimate for blocks of size 2^( 6) =       0.001593355100
  error estimate for blocks of size 2^( 7) =       0.001595286445

      target function =                  N/A
              le_mean =     -22.325840669016
             les_mean =     502.205813528710
             stat err =       0.001581852965
             autocorr =       1.312905475552
              std dev =       1.952411375792
             le_variance =       3.811910180323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812323898652
                                         uncertainty =       0.060711509307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.812323898652
                                         uncertainty =       0.060711509307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380541309
  error estimate for blocks of size 2^( 2) =       0.001451818886
  error estimate for blocks of size 2^( 3) =       0.001514923462
  error estimate for blocks of size 2^( 4) =       0.001557648727
  error estimate for blocks of size 2^( 5) =       0.001581121696
  error estimate for blocks of size 2^( 6) =       0.001593355105
  error estimate for blocks of size 2^( 7) =       0.001595286407

      target function =                  N/A
              le_mean =     -22.325840576121
             les_mean =     502.205803911947
             stat err =       0.001581852984
             autocorr =       1.312905366747
              std dev =       1.952411480250
             le_variance =       3.811910588214


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325840563417        initial
     1.3878e+01     1.3878e+02             2.6084e-05       -22.325840780839  <--
     5.5511e+01     5.5511e+02             6.5787e-06       -22.325840669016
     2.2204e+02     2.2204e+03             1.6483e-06       -22.325840576121

*****************************************************************************
Applying the update for shift_i =   1.3878e+01     and shift_s =   1.3878e+02
*****************************************************************************

  Execution time = 4.8343e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -6.885825e-01 3 1  ON 0
ci_002                -7.120758e-01 3 1  ON 1
ci_003                -6.110077e-02 3 1  ON 2
ci_004                -6.387140e-02 3 1  ON 3
ci_005                 4.491024e-02 3 1  ON 4
ci_006                 4.667399e-02 3 1  ON 5
ci_007                 3.124205e-02 3 1  ON 6
ci_008                 3.252979e-02 3 1  ON 7
ci_009                -2.440682e-02 3 1  ON 8
ci_010                -2.548809e-02 3 1  ON 9
ci_011                -2.268714e-02 3 1  ON 10
ci_012                -2.295971e-02 3 1  ON 11
ci_013                 1.976034e-02 3 1  ON 12
ci_014                 2.132207e-02 3 1  ON 13
ci_015                 1.936838e-02 3 1  ON 14
ci_016                 2.090890e-02 3 1  ON 15
ci_017                 1.440131e-02 3 1  ON 16
ci_018                 1.605969e-02 3 1  ON 17
ci_019                 9.970858e-03 3 1  ON 18
ci_020                 9.752828e-03 3 1  ON 19
ci_021                -9.898474e-03 3 1  ON 20
ci_022                -1.057035e-02 3 1  ON 21
ci_023                 8.936352e-03 3 1  ON 22
ci_024                 8.634562e-03 3 1  ON 23
ci_025                 7.809761e-03 3 1  ON 24
ci_026                 8.906806e-03 3 1  ON 25
ci_027                 7.661801e-03 3 1  ON 26
ci_028                 7.877472e-03 3 1  ON 27
ci_029                -7.051119e-03 3 1  ON 28
ci_030                -7.746121e-03 3 1  ON 29
ci_031                -7.354077e-03 3 1  ON 30
ci_032                -7.631931e-03 3 1  ON 31
ci_033                 6.997280e-03 3 1  ON 32
ci_034                 7.175714e-03 3 1  ON 33
ci_035                 6.635804e-03 3 1  ON 34
ci_036                 6.536604e-03 3 1  ON 35
ci_037                 6.552433e-03 3 1  ON 36
ci_038                 6.053775e-03 3 1  ON 37
ci_039                 5.581261e-03 3 1  ON 38
ci_040                 5.617929e-03 3 1  ON 39
ci_041                 4.987552e-03 3 1  ON 40
ci_042                 5.151397e-03 3 1  ON 41
ci_043                 4.674767e-03 3 1  ON 42
ci_044                 5.176123e-03 3 1  ON 43
ci_045                 5.105682e-03 3 1  ON 44
ci_046                 4.905262e-03 3 1  ON 45
ci_047                -4.244635e-03 3 1  ON 46
ci_048                -4.511117e-03 3 1  ON 47
ci_049                 3.509190e-03 3 1  ON 48
ci_050                 3.059382e-03 3 1  ON 49
ci_051                -2.594868e-03 3 1  ON 50
ci_052                -3.350510e-03 3 1  ON 51
ci_053                -2.887481e-03 3 1  ON 52
ci_054                -2.200443e-03 3 1  ON 53
ci_055                -2.112345e-03 3 1  ON 54
ci_056                -1.816646e-03 3 1  ON 55
ci_057                -1.965109e-03 3 1  ON 56
ci_058                -1.694940e-03 3 1  ON 57
ci_059                -1.792095e-03 3 1  ON 58
ci_060                -2.421909e-03 3 1  ON 59
ci_061                -1.372353e-03 3 1  ON 60
ci_062                -7.976584e-04 3 1  ON 61
ci_063                -1.384800e-03 3 1  ON 62
ci_064                -1.101909e-03 3 1  ON 63
ci_065                -1.430380e-03 3 1  ON 64
ci_066                -1.543301e-03 3 1  ON 65
ci_067                -2.005131e-04 3 1  ON 66
ci_068                -9.067212e-04 3 1  ON 67
ci_069                 9.598766e-04 3 1  ON 68
ci_070                 1.968395e-03 3 1  ON 69
ci_071                -9.392369e-04 3 1  ON 70
ci_072                -1.013482e-03 3 1  ON 71
ci_073                 1.036884e-03 3 1  ON 72
ci_074                 1.195405e-03 3 1  ON 73
ci_075                -7.404986e-04 3 1  ON 74
ci_076                -1.502814e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.5245
    reference variance = 2.35131
====================================================
  Execution time = 2.4307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0306e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7084e+00
  Total weights = 1.950284250e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0552e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758931313639
                                         uncertainty =       0.043549645716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758931313639
                                         uncertainty =       0.043549645716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370948099
  error estimate for blocks of size 2^( 2) =       0.001443223210
  error estimate for blocks of size 2^( 3) =       0.001506811548
  error estimate for blocks of size 2^( 4) =       0.001551877000
  error estimate for blocks of size 2^( 5) =       0.001577021397
  error estimate for blocks of size 2^( 6) =       0.001585406892
  error estimate for blocks of size 2^( 7) =       0.001587615502

      target function =                  N/A
              le_mean =     -22.328357344610
             les_mean =     502.263968407200
             stat err =       0.001575480198
             autocorr =       1.320638246163
              std dev =       1.938844415490
             le_variance =       3.759117667477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232835734461e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+00, overlap shift 3.4694e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328357343821       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328361087302       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328361073114       residual = 4.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+00 is 1.156870e-04

solving harmonic davidson linear method for identity shift 1.3878e+01, overlap shift 1.3878e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328357343821       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328358314137       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328358309942       residual = 2.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+01 is 3.051154e-05

solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328357343821       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328357588653       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328357587575       residual = 2.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+01 is 7.734245e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178437 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0369e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -6.885754e-01 3 1  ON 0
ci_002                -7.120863e-01 3 1  ON 1
ci_003                -6.108839e-02 3 1  ON 2
ci_004                -6.385024e-02 3 1  ON 3
ci_005                 4.491142e-02 3 1  ON 4
ci_006                 4.664348e-02 3 1  ON 5
ci_007                 3.125867e-02 3 1  ON 6
ci_008                 3.253775e-02 3 1  ON 7
ci_009                -2.441723e-02 3 1  ON 8
ci_010                -2.547599e-02 3 1  ON 9
ci_011                -2.267788e-02 3 1  ON 10
ci_012                -2.295963e-02 3 1  ON 11
ci_013                 1.974448e-02 3 1  ON 12
ci_014                 2.133060e-02 3 1  ON 13
ci_015                 1.939233e-02 3 1  ON 14
ci_016                 2.090488e-02 3 1  ON 15
ci_017                 1.442112e-02 3 1  ON 16
ci_018                 1.604642e-02 3 1  ON 17
ci_019                 9.956205e-03 3 1  ON 18
ci_020                 9.748643e-03 3 1  ON 19
ci_021                -9.899426e-03 3 1  ON 20
ci_022                -1.057297e-02 3 1  ON 21
ci_023                 8.942948e-03 3 1  ON 22
ci_024                 8.628610e-03 3 1  ON 23
ci_025                 7.809535e-03 3 1  ON 24
ci_026                 8.891735e-03 3 1  ON 25
ci_027                 7.671116e-03 3 1  ON 26
ci_028                 7.890605e-03 3 1  ON 27
ci_029                -7.059424e-03 3 1  ON 28
ci_030                -7.749140e-03 3 1  ON 29
ci_031                -7.343545e-03 3 1  ON 30
ci_032                -7.632382e-03 3 1  ON 31
ci_033                 6.989108e-03 3 1  ON 32
ci_034                 7.197085e-03 3 1  ON 33
ci_035                 6.636232e-03 3 1  ON 34
ci_036                 6.541006e-03 3 1  ON 35
ci_037                 6.551076e-03 3 1  ON 36
ci_038                 6.042177e-03 3 1  ON 37
ci_039                 5.581448e-03 3 1  ON 38
ci_040                 5.613895e-03 3 1  ON 39
ci_041                 4.994286e-03 3 1  ON 40
ci_042                 5.162225e-03 3 1  ON 41
ci_043                 4.679264e-03 3 1  ON 42
ci_044                 5.184827e-03 3 1  ON 43
ci_045                 5.103851e-03 3 1  ON 44
ci_046                 4.909710e-03 3 1  ON 45
ci_047                -4.230010e-03 3 1  ON 46
ci_048                -4.509819e-03 3 1  ON 47
ci_049                 3.481877e-03 3 1  ON 48
ci_050                 3.070403e-03 3 1  ON 49
ci_051                -2.594323e-03 3 1  ON 50
ci_052                -3.340477e-03 3 1  ON 51
ci_053                -2.897979e-03 3 1  ON 52
ci_054                -2.201648e-03 3 1  ON 53
ci_055                -2.109663e-03 3 1  ON 54
ci_056                -1.827279e-03 3 1  ON 55
ci_057                -1.979723e-03 3 1  ON 56
ci_058                -1.707119e-03 3 1  ON 57
ci_059                -1.796263e-03 3 1  ON 58
ci_060                -2.411243e-03 3 1  ON 59
ci_061                -1.381478e-03 3 1  ON 60
ci_062                -8.005126e-04 3 1  ON 61
ci_063                -1.395619e-03 3 1  ON 62
ci_064                -1.107494e-03 3 1  ON 63
ci_065                -1.441635e-03 3 1  ON 64
ci_066                -1.536877e-03 3 1  ON 65
ci_067                -2.267159e-04 3 1  ON 66
ci_068                -9.136870e-04 3 1  ON 67
ci_069                 9.681744e-04 3 1  ON 68
ci_070                 1.972859e-03 3 1  ON 69
ci_071                -9.333058e-04 3 1  ON 70
ci_072                -1.000479e-03 3 1  ON 71
ci_073                 1.034430e-03 3 1  ON 72
ci_074                 1.194792e-03 3 1  ON 73
ci_075                -7.355941e-04 3 1  ON 74
ci_076                -1.497555e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.5117
    reference variance = 2.10952
====================================================
  Execution time = 2.3752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.6998e+00
  Total weights = 1.9495e+06
  Execution time = 4.4586e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753249030657
                                         uncertainty =       0.028770357617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753249030657
                                         uncertainty =       0.028770357617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369815608
  error estimate for blocks of size 2^( 2) =       0.001440327586
  error estimate for blocks of size 2^( 3) =       0.001503317352
  error estimate for blocks of size 2^( 4) =       0.001545720770
  error estimate for blocks of size 2^( 5) =       0.001570103670
  error estimate for blocks of size 2^( 6) =       0.001579622080
  error estimate for blocks of size 2^( 7) =       0.001588409525

      target function =                  N/A
              le_mean =     -22.330212149069
             les_mean =     502.338141684910
             stat err =       0.001570964011
             autocorr =       1.315249820275
              std dev =       1.937242806332
             le_variance =       3.752909690687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753245503969
                                         uncertainty =       0.028770206678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753245503969
                                         uncertainty =       0.028770206678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369814969
  error estimate for blocks of size 2^( 2) =       0.001440327523
  error estimate for blocks of size 2^( 3) =       0.001503319248
  error estimate for blocks of size 2^( 4) =       0.001545723825
  error estimate for blocks of size 2^( 5) =       0.001570107024
  error estimate for blocks of size 2^( 6) =       0.001579627002
  error estimate for blocks of size 2^( 7) =       0.001588413944

      target function =                  N/A
              le_mean =     -22.330213534617
             les_mean =     502.338378447331
             stat err =       0.001570967949
             autocorr =       1.315257640813
              std dev =       1.937241902812
             le_variance =       3.752906190012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753246927792
                                         uncertainty =       0.028770277721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753246927792
                                         uncertainty =       0.028770277721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369815227
  error estimate for blocks of size 2^( 2) =       0.001440327517
  error estimate for blocks of size 2^( 3) =       0.001503318307
  error estimate for blocks of size 2^( 4) =       0.001545722318
  error estimate for blocks of size 2^( 5) =       0.001570105323
  error estimate for blocks of size 2^( 6) =       0.001579624572
  error estimate for blocks of size 2^( 7) =       0.001588411799

      target function =                  N/A
              le_mean =     -22.330212812316
             les_mean =     502.338203935582
             stat err =       0.001570966003
             autocorr =       1.315253887618
              std dev =       1.937242267224
             le_variance =       3.752907601918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753248734403
                                         uncertainty =       0.028770347342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.753248734403
                                         uncertainty =       0.028770347342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369815555
  error estimate for blocks of size 2^( 2) =       0.001440327572
  error estimate for blocks of size 2^( 3) =       0.001503317467
  error estimate for blocks of size 2^( 4) =       0.001545720960
  error estimate for blocks of size 2^( 5) =       0.001570103872
  error estimate for blocks of size 2^( 6) =       0.001579622391
  error estimate for blocks of size 2^( 7) =       0.001588409808

      target function =                  N/A
              le_mean =     -22.330212226958
             les_mean =     502.338146745949
             stat err =       0.001570964258
             autocorr =       1.315250336078
              std dev =       1.937242730337
             le_variance =       3.752909396243


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330212149069        initial
     3.4694e+00     3.4694e+01             1.1569e-04       -22.330213534617  <--
     1.3878e+01     1.3878e+02             3.0512e-05       -22.330212812316
     5.5511e+01     5.5511e+02             7.7342e-06       -22.330212226958

*****************************************************************************
Applying the update for shift_i =   3.4694e+00     and shift_s =   3.4694e+01
*****************************************************************************

  Execution time = 4.6181e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -6.885542e-01 3 1  ON 0
ci_002                -7.121175e-01 3 1  ON 1
ci_003                -6.105192e-02 3 1  ON 2
ci_004                -6.378783e-02 3 1  ON 3
ci_005                 4.491444e-02 3 1  ON 4
ci_006                 4.655830e-02 3 1  ON 5
ci_007                 3.130595e-02 3 1  ON 6
ci_008                 3.256067e-02 3 1  ON 7
ci_009                -2.444693e-02 3 1  ON 8
ci_010                -2.544151e-02 3 1  ON 9
ci_011                -2.265144e-02 3 1  ON 10
ci_012                -2.295964e-02 3 1  ON 11
ci_013                 1.969891e-02 3 1  ON 12
ci_014                 2.135511e-02 3 1  ON 13
ci_015                 1.946212e-02 3 1  ON 14
ci_016                 2.089279e-02 3 1  ON 15
ci_017                 1.447843e-02 3 1  ON 16
ci_018                 1.600769e-02 3 1  ON 17
ci_019                 9.913824e-03 3 1  ON 18
ci_020                 9.736598e-03 3 1  ON 19
ci_021                -9.901819e-03 3 1  ON 20
ci_022                -1.058049e-02 3 1  ON 21
ci_023                 8.961338e-03 3 1  ON 22
ci_024                 8.611855e-03 3 1  ON 23
ci_025                 7.809168e-03 3 1  ON 24
ci_026                 8.848298e-03 3 1  ON 25
ci_027                 7.696596e-03 3 1  ON 26
ci_028                 7.927110e-03 3 1  ON 27
ci_029                -7.083320e-03 3 1  ON 28
ci_030                -7.757821e-03 3 1  ON 29
ci_031                -7.312804e-03 3 1  ON 30
ci_032                -7.633328e-03 3 1  ON 31
ci_033                 6.965549e-03 3 1  ON 32
ci_034                 7.258188e-03 3 1  ON 33
ci_035                 6.637341e-03 3 1  ON 34
ci_036                 6.552935e-03 3 1  ON 35
ci_037                 6.546857e-03 3 1  ON 36
ci_038                 6.009160e-03 3 1  ON 37
ci_039                 5.581760e-03 3 1  ON 38
ci_040                 5.602595e-03 3 1  ON 39
ci_041                 5.013343e-03 3 1  ON 40
ci_042                 5.192732e-03 3 1  ON 41
ci_043                 4.691826e-03 3 1  ON 42
ci_044                 5.209639e-03 3 1  ON 43
ci_045                 5.098640e-03 3 1  ON 44
ci_046                 4.922108e-03 3 1  ON 45
ci_047                -4.189921e-03 3 1  ON 46
ci_048                -4.505932e-03 3 1  ON 47
ci_049                 3.403659e-03 3 1  ON 48
ci_050                 3.102139e-03 3 1  ON 49
ci_051                -2.593156e-03 3 1  ON 50
ci_052                -3.312015e-03 3 1  ON 51
ci_053                -2.928296e-03 3 1  ON 52
ci_054                -2.204931e-03 3 1  ON 53
ci_055                -2.101473e-03 3 1  ON 54
ci_056                -1.857644e-03 3 1  ON 55
ci_057                -2.021193e-03 3 1  ON 56
ci_058                -1.741758e-03 3 1  ON 57
ci_059                -1.807375e-03 3 1  ON 58
ci_060                -2.381693e-03 3 1  ON 59
ci_061                -1.407528e-03 3 1  ON 60
ci_062                -8.087872e-04 3 1  ON 61
ci_063                -1.426944e-03 3 1  ON 62
ci_064                -1.123460e-03 3 1  ON 63
ci_065                -1.473612e-03 3 1  ON 64
ci_066                -1.518438e-03 3 1  ON 65
ci_067                -3.019433e-04 3 1  ON 66
ci_068                -9.334822e-04 3 1  ON 67
ci_069                 9.921557e-04 3 1  ON 68
ci_070                 1.985689e-03 3 1  ON 69
ci_071                -9.165255e-04 3 1  ON 70
ci_072                -9.637810e-04 3 1  ON 71
ci_073                 1.027734e-03 3 1  ON 72
ci_074                 1.193093e-03 3 1  ON 73
ci_075                -7.217395e-04 3 1  ON 74
ci_076                -1.482725e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.1305
    reference variance = 3.8314
====================================================
  Execution time = 2.4432e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0270e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7585e+00
  Total weights = 1.949885348e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9723e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.809540400450
                                         uncertainty =       0.065831857988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.809540400450
                                         uncertainty =       0.065831857988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380772451
  error estimate for blocks of size 2^( 2) =       0.001451527366
  error estimate for blocks of size 2^( 3) =       0.001514052367
  error estimate for blocks of size 2^( 4) =       0.001557379485
  error estimate for blocks of size 2^( 5) =       0.001581651423
  error estimate for blocks of size 2^( 6) =       0.001593197418
  error estimate for blocks of size 2^( 7) =       0.001600370100

      target function =                  N/A
              le_mean =     -22.326738862547
             les_mean =     502.241745220861
             stat err =       0.001583149606
             autocorr =       1.314618342790
              std dev =       1.952738369656
             le_variance =       3.813187140328


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232673886255e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e-01, overlap shift 8.6736e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326738861713       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326751741881       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326751623439       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e-01 is 2.753793e-04

solving harmonic davidson linear method for identity shift 3.4694e+00, overlap shift 3.4694e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326738861713       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326742561948       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326742553665       residual = 3.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+00 is 7.972410e-05

solving harmonic davidson linear method for identity shift 1.3878e+01, overlap shift 1.3878e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326738861713       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326739822595       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326739823183       residual = 1.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+01 is 2.076691e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0411e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -6.885084e-01 3 1  ON 0
ci_002                -7.121619e-01 3 1  ON 1
ci_003                -6.109409e-02 3 1  ON 2
ci_004                -6.378993e-02 3 1  ON 3
ci_005                 4.487883e-02 3 1  ON 4
ci_006                 4.648519e-02 3 1  ON 5
ci_007                 3.132352e-02 3 1  ON 6
ci_008                 3.255787e-02 3 1  ON 7
ci_009                -2.441494e-02 3 1  ON 8
ci_010                -2.537265e-02 3 1  ON 9
ci_011                -2.265588e-02 3 1  ON 10
ci_012                -2.297564e-02 3 1  ON 11
ci_013                 1.972068e-02 3 1  ON 12
ci_014                 2.136234e-02 3 1  ON 13
ci_015                 1.951990e-02 3 1  ON 14
ci_016                 2.091671e-02 3 1  ON 15
ci_017                 1.450489e-02 3 1  ON 16
ci_018                 1.601330e-02 3 1  ON 17
ci_019                 9.951137e-03 3 1  ON 18
ci_020                 9.785377e-03 3 1  ON 19
ci_021                -9.967958e-03 3 1  ON 20
ci_022                -1.053844e-02 3 1  ON 21
ci_023                 8.940928e-03 3 1  ON 22
ci_024                 8.568340e-03 3 1  ON 23
ci_025                 7.785091e-03 3 1  ON 24
ci_026                 8.831260e-03 3 1  ON 25
ci_027                 7.736912e-03 3 1  ON 26
ci_028                 7.949682e-03 3 1  ON 27
ci_029                -7.141882e-03 3 1  ON 28
ci_030                -7.729908e-03 3 1  ON 29
ci_031                -7.311959e-03 3 1  ON 30
ci_032                -7.614594e-03 3 1  ON 31
ci_033                 6.993708e-03 3 1  ON 32
ci_034                 7.184864e-03 3 1  ON 33
ci_035                 6.669102e-03 3 1  ON 34
ci_036                 6.573787e-03 3 1  ON 35
ci_037                 6.597384e-03 3 1  ON 36
ci_038                 6.032503e-03 3 1  ON 37
ci_039                 5.548535e-03 3 1  ON 38
ci_040                 5.637141e-03 3 1  ON 39
ci_041                 4.974396e-03 3 1  ON 40
ci_042                 5.132119e-03 3 1  ON 41
ci_043                 4.728558e-03 3 1  ON 42
ci_044                 5.187534e-03 3 1  ON 43
ci_045                 5.062937e-03 3 1  ON 44
ci_046                 4.924912e-03 3 1  ON 45
ci_047                -4.197168e-03 3 1  ON 46
ci_048                -4.510280e-03 3 1  ON 47
ci_049                 3.421435e-03 3 1  ON 48
ci_050                 3.121577e-03 3 1  ON 49
ci_051                -2.648706e-03 3 1  ON 50
ci_052                -3.296076e-03 3 1  ON 51
ci_053                -2.992206e-03 3 1  ON 52
ci_054                -2.187812e-03 3 1  ON 53
ci_055                -2.139129e-03 3 1  ON 54
ci_056                -1.908905e-03 3 1  ON 55
ci_057                -1.980663e-03 3 1  ON 56
ci_058                -1.742717e-03 3 1  ON 57
ci_059                -1.809753e-03 3 1  ON 58
ci_060                -2.350790e-03 3 1  ON 59
ci_061                -1.415987e-03 3 1  ON 60
ci_062                -8.181219e-04 3 1  ON 61
ci_063                -1.424574e-03 3 1  ON 62
ci_064                -1.123490e-03 3 1  ON 63
ci_065                -1.487362e-03 3 1  ON 64
ci_066                -1.513724e-03 3 1  ON 65
ci_067                -3.650708e-04 3 1  ON 66
ci_068                -9.681956e-04 3 1  ON 67
ci_069                 9.836630e-04 3 1  ON 68
ci_070                 2.027818e-03 3 1  ON 69
ci_071                -9.962497e-04 3 1  ON 70
ci_072                -9.756221e-04 3 1  ON 71
ci_073                 1.054246e-03 3 1  ON 72
ci_074                 1.152455e-03 3 1  ON 73
ci_075                -7.292685e-04 3 1  ON 74
ci_076                -1.410685e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.2769
    reference variance = 3.14824
====================================================
  Execution time = 2.3860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7688e+00
  Total weights = 1.9498e+06
  Execution time = 4.5000e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823579055793
                                         uncertainty =       0.048215199535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823579055793
                                         uncertainty =       0.048215199535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382513644
  error estimate for blocks of size 2^( 2) =       0.001451996402
  error estimate for blocks of size 2^( 3) =       0.001514432794
  error estimate for blocks of size 2^( 4) =       0.001558064267
  error estimate for blocks of size 2^( 5) =       0.001582534993
  error estimate for blocks of size 2^( 6) =       0.001589705786
  error estimate for blocks of size 2^( 7) =       0.001592474965

      target function =                  N/A
              le_mean =     -22.328946433079
             les_mean =     502.631848495435
             stat err =       0.001580695003
             autocorr =       1.307245962015
              std dev =       1.955200827298
             le_variance =       3.822810275066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823581653788
                                         uncertainty =       0.048216461945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823581653788
                                         uncertainty =       0.048216461945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382514158
  error estimate for blocks of size 2^( 2) =       0.001452003530
  error estimate for blocks of size 2^( 3) =       0.001514445454
  error estimate for blocks of size 2^( 4) =       0.001558079130
  error estimate for blocks of size 2^( 5) =       0.001582550262
  error estimate for blocks of size 2^( 6) =       0.001589713197
  error estimate for blocks of size 2^( 7) =       0.001592483892

      target function =                  N/A
              le_mean =     -22.328947818382
             les_mean =     502.350880496739
             stat err =       0.001580706620
             autocorr =       1.307264204074
              std dev =       1.955201554711
             le_variance =       3.822813119544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823576416725
                                         uncertainty =       0.048215895193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823576416725
                                         uncertainty =       0.048215895193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382513191
  error estimate for blocks of size 2^( 2) =       0.001452000055
  error estimate for blocks of size 2^( 3) =       0.001514440174
  error estimate for blocks of size 2^( 4) =       0.001558073050
  error estimate for blocks of size 2^( 5) =       0.001582544446
  error estimate for blocks of size 2^( 6) =       0.001589710904
  error estimate for blocks of size 2^( 7) =       0.001592479240

      target function =                  N/A
              le_mean =     -22.328946285357
             les_mean =     502.353483677561
             stat err =       0.001580701910
             autocorr =       1.307258241356
              std dev =       1.955200187943
             le_variance =       3.822807774931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823576891582
                                         uncertainty =       0.048215258209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.823576891582
                                         uncertainty =       0.048215258209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382513256
  error estimate for blocks of size 2^( 2) =       0.001451996384
  error estimate for blocks of size 2^( 3) =       0.001514434164
  error estimate for blocks of size 2^( 4) =       0.001558065100
  error estimate for blocks of size 2^( 5) =       0.001582535865
  error estimate for blocks of size 2^( 6) =       0.001589705953
  error estimate for blocks of size 2^( 7) =       0.001592472952

      target function =                  N/A
              le_mean =     -22.328945616873
             les_mean =     502.351142248186
             stat err =       0.001580694968
             autocorr =       1.307246636294
              std dev =       1.955200279327
             le_variance =       3.822808132279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328946433079        initial
     8.6736e-01     8.6736e+00             2.7538e-04       -22.328947818382  <--
     3.4694e+00     3.4694e+01             7.9724e-05       -22.328946285357
     1.3878e+01     1.3878e+02             2.0767e-05       -22.328945616873

*****************************************************************************
Applying the update for shift_i =   8.6736e-01     and shift_s =   8.6736e+00
*****************************************************************************

  Execution time = 4.6367e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -6.883759e-01 3 1  ON 0
ci_002                -7.122868e-01 3 1  ON 1
ci_003                -6.121177e-02 3 1  ON 2
ci_004                -6.379813e-02 3 1  ON 3
ci_005                 4.479577e-02 3 1  ON 4
ci_006                 4.631917e-02 3 1  ON 5
ci_007                 3.137508e-02 3 1  ON 6
ci_008                 3.255638e-02 3 1  ON 7
ci_009                -2.433767e-02 3 1  ON 8
ci_010                -2.519990e-02 3 1  ON 9
ci_011                -2.266450e-02 3 1  ON 10
ci_012                -2.301741e-02 3 1  ON 11
ci_013                 1.977825e-02 3 1  ON 12
ci_014                 2.138253e-02 3 1  ON 13
ci_015                 1.967183e-02 3 1  ON 14
ci_016                 2.097792e-02 3 1  ON 15
ci_017                 1.457186e-02 3 1  ON 16
ci_018                 1.602245e-02 3 1  ON 17
ci_019                 1.005282e-02 3 1  ON 18
ci_020                 9.911563e-03 3 1  ON 19
ci_021                -1.014211e-02 3 1  ON 20
ci_022                -1.043070e-02 3 1  ON 21
ci_023                 8.890787e-03 3 1  ON 22
ci_024                 8.460982e-03 3 1  ON 23
ci_025                 7.719586e-03 3 1  ON 24
ci_026                 8.784193e-03 3 1  ON 25
ci_027                 7.829554e-03 3 1  ON 26
ci_028                 8.003508e-03 3 1  ON 27
ci_029                -7.286308e-03 3 1  ON 28
ci_030                -7.657585e-03 3 1  ON 29
ci_031                -7.303232e-03 3 1  ON 30
ci_032                -7.567110e-03 3 1  ON 31
ci_033                 7.067912e-03 3 1  ON 32
ci_034                 6.995692e-03 3 1  ON 33
ci_035                 6.740792e-03 3 1  ON 34
ci_036                 6.618235e-03 3 1  ON 35
ci_037                 6.722905e-03 3 1  ON 36
ci_038                 6.090380e-03 3 1  ON 37
ci_039                 5.475734e-03 3 1  ON 38
ci_040                 5.717082e-03 3 1  ON 39
ci_041                 4.883320e-03 3 1  ON 40
ci_042                 4.989612e-03 3 1  ON 41
ci_043                 4.819453e-03 3 1  ON 42
ci_044                 5.129224e-03 3 1  ON 43
ci_045                 4.971153e-03 3 1  ON 44
ci_046                 4.936582e-03 3 1  ON 45
ci_047                -4.210841e-03 3 1  ON 46
ci_048                -4.511928e-03 3 1  ON 47
ci_049                 3.467170e-03 3 1  ON 48
ci_050                 3.171443e-03 3 1  ON 49
ci_051                -2.784869e-03 3 1  ON 50
ci_052                -3.253793e-03 3 1  ON 51
ci_053                -3.151935e-03 3 1  ON 52
ci_054                -2.142898e-03 3 1  ON 53
ci_055                -2.232741e-03 3 1  ON 54
ci_056                -2.039219e-03 3 1  ON 55
ci_057                -1.880778e-03 3 1  ON 56
ci_058                -1.745653e-03 3 1  ON 57
ci_059                -1.817648e-03 3 1  ON 58
ci_060                -2.279187e-03 3 1  ON 59
ci_061                -1.434676e-03 3 1  ON 60
ci_062                -8.437396e-04 3 1  ON 61
ci_063                -1.416646e-03 3 1  ON 62
ci_064                -1.123364e-03 3 1  ON 63
ci_065                -1.516293e-03 3 1  ON 64
ci_066                -1.503873e-03 3 1  ON 65
ci_067                -5.217402e-04 3 1  ON 66
ci_068                -1.052987e-03 3 1  ON 67
ci_069                 9.662550e-04 3 1  ON 68
ci_070                 2.130481e-03 3 1  ON 69
ci_071                -1.191905e-03 3 1  ON 70
ci_072                -1.006322e-03 3 1  ON 71
ci_073                 1.117031e-03 3 1  ON 72
ci_074                 1.060818e-03 3 1  ON 73
ci_075                -7.490447e-04 3 1  ON 74
ci_076                -1.232192e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6787e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2312e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.4159
    reference variance = 2.64442
====================================================
  Execution time = 2.4358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0316e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.6759e+00
  Total weights = 1.949855619e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0385e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.721395470479
                                         uncertainty =       0.026854724111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.721395470479
                                         uncertainty =       0.026854724111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364537082
  error estimate for blocks of size 2^( 2) =       0.001436401402
  error estimate for blocks of size 2^( 3) =       0.001502751045
  error estimate for blocks of size 2^( 4) =       0.001548353824
  error estimate for blocks of size 2^( 5) =       0.001572756842
  error estimate for blocks of size 2^( 6) =       0.001587375409
  error estimate for blocks of size 2^( 7) =       0.001592346086

      target function =                  N/A
              le_mean =     -22.326023300198
             les_mean =     502.127230383438
             stat err =       0.001575208040
             autocorr =       1.332616405251
              std dev =       1.929777722824
             le_variance =       3.724042059509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232602330020e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e-01, overlap shift 2.1684e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326023299378       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326066907006       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326068364541       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326068193908       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326068334360       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e-01 is 1.181204e-03

solving harmonic davidson linear method for identity shift 8.6736e-01, overlap shift 8.6736e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326023299378       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326040191448       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326040330457       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e-01 is 4.773030e-04

solving harmonic davidson linear method for identity shift 3.4694e+00, overlap shift 3.4694e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326023299378       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326028194853       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326028208180       residual = 1.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+00 is 1.405159e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181054 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0403e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -6.883013e-01 3 1  ON 0
ci_002                -7.124125e-01 3 1  ON 1
ci_003                -6.136854e-02 3 1  ON 2
ci_004                -6.354615e-02 3 1  ON 3
ci_005                 4.467549e-02 3 1  ON 4
ci_006                 4.634244e-02 3 1  ON 5
ci_007                 3.134047e-02 3 1  ON 6
ci_008                 3.263621e-02 3 1  ON 7
ci_009                -2.436183e-02 3 1  ON 8
ci_010                -2.507176e-02 3 1  ON 9
ci_011                -2.261912e-02 3 1  ON 10
ci_012                -2.274514e-02 3 1  ON 11
ci_013                 1.986907e-02 3 1  ON 12
ci_014                 2.109649e-02 3 1  ON 13
ci_015                 1.960825e-02 3 1  ON 14
ci_016                 2.069338e-02 3 1  ON 15
ci_017                 1.440166e-02 3 1  ON 16
ci_018                 1.565542e-02 3 1  ON 17
ci_019                 1.000629e-02 3 1  ON 18
ci_020                 9.909427e-03 3 1  ON 19
ci_021                -1.006899e-02 3 1  ON 20
ci_022                -1.063351e-02 3 1  ON 21
ci_023                 8.563641e-03 3 1  ON 22
ci_024                 8.570370e-03 3 1  ON 23
ci_025                 7.859845e-03 3 1  ON 24
ci_026                 8.933495e-03 3 1  ON 25
ci_027                 7.820483e-03 3 1  ON 26
ci_028                 8.214175e-03 3 1  ON 27
ci_029                -7.281162e-03 3 1  ON 28
ci_030                -7.580687e-03 3 1  ON 29
ci_031                -7.493137e-03 3 1  ON 30
ci_032                -7.531941e-03 3 1  ON 31
ci_033                 6.856174e-03 3 1  ON 32
ci_034                 7.017400e-03 3 1  ON 33
ci_035                 6.523210e-03 3 1  ON 34
ci_036                 6.834581e-03 3 1  ON 35
ci_037                 6.692683e-03 3 1  ON 36
ci_038                 6.198108e-03 3 1  ON 37
ci_039                 5.269461e-03 3 1  ON 38
ci_040                 5.589976e-03 3 1  ON 39
ci_041                 5.102581e-03 3 1  ON 40
ci_042                 4.811020e-03 3 1  ON 41
ci_043                 4.805556e-03 3 1  ON 42
ci_044                 5.065625e-03 3 1  ON 43
ci_045                 5.100769e-03 3 1  ON 44
ci_046                 5.071682e-03 3 1  ON 45
ci_047                -4.253915e-03 3 1  ON 46
ci_048                -4.544020e-03 3 1  ON 47
ci_049                 3.390422e-03 3 1  ON 48
ci_050                 3.225718e-03 3 1  ON 49
ci_051                -2.608497e-03 3 1  ON 50
ci_052                -3.223512e-03 3 1  ON 51
ci_053                -3.012655e-03 3 1  ON 52
ci_054                -2.224764e-03 3 1  ON 53
ci_055                -2.226736e-03 3 1  ON 54
ci_056                -1.879880e-03 3 1  ON 55
ci_057                -2.194703e-03 3 1  ON 56
ci_058                -1.767977e-03 3 1  ON 57
ci_059                -1.725238e-03 3 1  ON 58
ci_060                -2.219004e-03 3 1  ON 59
ci_061                -1.408474e-03 3 1  ON 60
ci_062                -1.321043e-03 3 1  ON 61
ci_063                -1.396907e-03 3 1  ON 62
ci_064                -1.252797e-03 3 1  ON 63
ci_065                -1.346902e-03 3 1  ON 64
ci_066                -1.575787e-03 3 1  ON 65
ci_067                -2.552762e-04 3 1  ON 66
ci_068                -1.274918e-03 3 1  ON 67
ci_069                 1.230583e-03 3 1  ON 68
ci_070                 1.736765e-03 3 1  ON 69
ci_071                -1.262483e-03 3 1  ON 70
ci_072                -1.013971e-03 3 1  ON 71
ci_073                 1.017095e-03 3 1  ON 72
ci_074                 9.208417e-04 3 1  ON 73
ci_075                -8.480988e-04 3 1  ON 74
ci_076                -1.313520e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.2162
    reference variance = 2.70825
====================================================
  Execution time = 2.3800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7703e+00
  Total weights = 1.9502e+06
  Execution time = 4.4907e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824120084369
                                         uncertainty =       0.049948785847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824120084369
                                         uncertainty =       0.049948785847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382653600
  error estimate for blocks of size 2^( 2) =       0.001453243849
  error estimate for blocks of size 2^( 3) =       0.001514621117
  error estimate for blocks of size 2^( 4) =       0.001557651119
  error estimate for blocks of size 2^( 5) =       0.001585850922
  error estimate for blocks of size 2^( 6) =       0.001604495978
  error estimate for blocks of size 2^( 7) =       0.001621087748

      target function =                  N/A
              le_mean =     -22.327040191796
             les_mean =     502.268152631243
             stat err =       0.001592271442
             autocorr =       1.326195146854
              std dev =       1.955398758860
             le_variance =       3.823584306151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824022310820
                                         uncertainty =       0.049950765090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824022310820
                                         uncertainty =       0.049950765090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382635729
  error estimate for blocks of size 2^( 2) =       0.001453245227
  error estimate for blocks of size 2^( 3) =       0.001514641145
  error estimate for blocks of size 2^( 4) =       0.001557690858
  error estimate for blocks of size 2^( 5) =       0.001585909565
  error estimate for blocks of size 2^( 6) =       0.001604538361
  error estimate for blocks of size 2^( 7) =       0.001621136819

      target function =                  N/A
              le_mean =     -22.327053487358
             les_mean =     502.274401497528
             stat err =       0.001592318901
             autocorr =       1.326308488696
              std dev =       1.955373485641
             le_variance =       3.823485468349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824107430530
                                         uncertainty =       0.049955017457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824107430530
                                         uncertainty =       0.049955017457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382651140
  error estimate for blocks of size 2^( 2) =       0.001453252795
  error estimate for blocks of size 2^( 3) =       0.001514642468
  error estimate for blocks of size 2^( 4) =       0.001557691128
  error estimate for blocks of size 2^( 5) =       0.001585891952
  error estimate for blocks of size 2^( 6) =       0.001604519338
  error estimate for blocks of size 2^( 7) =       0.001621132417

      target function =                  N/A
              le_mean =     -22.327047876538
             les_mean =     502.433812318662
             stat err =       0.001592308708
             autocorr =       1.326261944374
              std dev =       1.955395280378
             le_variance =       3.823570702526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824101268877
                                         uncertainty =       0.049948896942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.824101268877
                                         uncertainty =       0.049948896942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382650180
  error estimate for blocks of size 2^( 2) =       0.001453242890
  error estimate for blocks of size 2^( 3) =       0.001514622573
  error estimate for blocks of size 2^( 4) =       0.001557654986
  error estimate for blocks of size 2^( 5) =       0.001585855807
  error estimate for blocks of size 2^( 6) =       0.001604496830
  error estimate for blocks of size 2^( 7) =       0.001621087068

      target function =                  N/A
              le_mean =     -22.327040317134
             les_mean =     502.267459185345
             stat err =       0.001592273673
             autocorr =       1.326205424269
              std dev =       1.955393921686
             le_variance =       3.823565388968


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327040191796        initial
     2.1684e-01     2.1684e+00             1.1812e-03       -22.327053487358  <--
     8.6736e-01     8.6736e+00             4.7730e-04       -22.327047876538
     3.4694e+00     3.4694e+01             1.4052e-04       -22.327040317134

*****************************************************************************
Applying the update for shift_i =   2.1684e-01     and shift_s =   2.1684e+00
*****************************************************************************

  Execution time = 4.6373e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -6.880535e-01 3 1  ON 0
ci_002                -7.127447e-01 3 1  ON 1
ci_003                -6.173204e-02 3 1  ON 2
ci_004                -6.297704e-02 3 1  ON 3
ci_005                 4.449103e-02 3 1  ON 4
ci_006                 4.639475e-02 3 1  ON 5
ci_007                 3.125804e-02 3 1  ON 6
ci_008                 3.281715e-02 3 1  ON 7
ci_009                -2.438966e-02 3 1  ON 8
ci_010                -2.485771e-02 3 1  ON 9
ci_011                -2.254132e-02 3 1  ON 10
ci_012                -2.228930e-02 3 1  ON 11
ci_013                 2.002242e-02 3 1  ON 12
ci_014                 2.062099e-02 3 1  ON 13
ci_015                 1.953032e-02 3 1  ON 14
ci_016                 2.012969e-02 3 1  ON 15
ci_017                 1.411197e-02 3 1  ON 16
ci_018                 1.502591e-02 3 1  ON 17
ci_019                 9.890398e-03 3 1  ON 18
ci_020                 9.915240e-03 3 1  ON 19
ci_021                -9.906171e-03 3 1  ON 20
ci_022                -1.103727e-02 3 1  ON 21
ci_023                 8.053628e-03 3 1  ON 22
ci_024                 8.740187e-03 3 1  ON 23
ci_025                 8.116435e-03 3 1  ON 24
ci_026                 9.229408e-03 3 1  ON 25
ci_027                 7.818614e-03 3 1  ON 26
ci_028                 8.485503e-03 3 1  ON 27
ci_029                -7.294032e-03 3 1  ON 28
ci_030                -7.419241e-03 3 1  ON 29
ci_031                -7.880086e-03 3 1  ON 30
ci_032                -7.454809e-03 3 1  ON 31
ci_033                 6.458225e-03 3 1  ON 32
ci_034                 7.027875e-03 3 1  ON 33
ci_035                 6.254938e-03 3 1  ON 34
ci_036                 7.089562e-03 3 1  ON 35
ci_037                 6.656285e-03 3 1  ON 36
ci_038                 6.343976e-03 3 1  ON 37
ci_039                 5.017407e-03 3 1  ON 38
ci_040                 5.426866e-03 3 1  ON 39
ci_041                 5.419119e-03 3 1  ON 40
ci_042                 4.566035e-03 3 1  ON 41
ci_043                 4.796182e-03 3 1  ON 42
ci_044                 4.932572e-03 3 1  ON 43
ci_045                 5.338173e-03 3 1  ON 44
ci_046                 5.326504e-03 3 1  ON 45
ci_047                -4.304187e-03 3 1  ON 46
ci_048                -4.582817e-03 3 1  ON 47
ci_049                 3.252076e-03 3 1  ON 48
ci_050                 3.317354e-03 3 1  ON 49
ci_051                -2.300742e-03 3 1  ON 50
ci_052                -3.200190e-03 3 1  ON 51
ci_053                -2.797885e-03 3 1  ON 52
ci_054                -2.380488e-03 3 1  ON 53
ci_055                -2.209380e-03 3 1  ON 54
ci_056                -1.559809e-03 3 1  ON 55
ci_057                -2.685858e-03 3 1  ON 56
ci_058                -1.793389e-03 3 1  ON 57
ci_059                -1.613836e-03 3 1  ON 58
ci_060                -2.095957e-03 3 1  ON 59
ci_061                -1.388261e-03 3 1  ON 60
ci_062                -2.024944e-03 3 1  ON 61
ci_063                -1.365021e-03 3 1  ON 62
ci_064                -1.497889e-03 3 1  ON 63
ci_065                -1.089646e-03 3 1  ON 64
ci_066                -1.668157e-03 3 1  ON 65
ci_067                 1.528720e-04 3 1  ON 66
ci_068                -1.662732e-03 3 1  ON 67
ci_069                 1.646958e-03 3 1  ON 68
ci_070                 1.102329e-03 3 1  ON 69
ci_071                -1.398013e-03 3 1  ON 70
ci_072                -1.040424e-03 3 1  ON 71
ci_073                 8.891394e-04 3 1  ON 72
ci_074                 7.310121e-04 3 1  ON 73
ci_075                -1.008769e-03 3 1  ON 74
ci_076                -1.433928e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6783e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2312e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.031
    reference variance = 2.46943
====================================================
  Execution time = 2.4464e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0307e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8435e+00
  Total weights = 1.949822174e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9577e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.899397598958
                                         uncertainty =       0.128089498653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.899397598958
                                         uncertainty =       0.128089498653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001396168369
  error estimate for blocks of size 2^( 2) =       0.001465182317
  error estimate for blocks of size 2^( 3) =       0.001527786646
  error estimate for blocks of size 2^( 4) =       0.001568273599
  error estimate for blocks of size 2^( 5) =       0.001591509779
  error estimate for blocks of size 2^( 6) =       0.001603659868
  error estimate for blocks of size 2^( 7) =       0.001604442050

      target function =                  N/A
              le_mean =     -22.327714999766
             les_mean =     502.370307853145
             stat err =       0.001591971324
             autocorr =       1.300154284717
              std dev =       1.974511834874
             le_variance =       3.898696986057


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232771499977e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e-02, overlap shift 5.4210e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327714998951       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327794121395       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327802393926       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327803109406       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327803449655       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327803681484       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327803587108       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327803573354       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e-02 is 2.474159e-03

solving harmonic davidson linear method for identity shift 2.1684e-01, overlap shift 2.1684e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327714998951       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327762301517       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327764479840       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327764515252       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327764532035       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e-01 is 1.337549e-03

solving harmonic davidson linear method for identity shift 8.6736e-01, overlap shift 8.6736e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327714998951       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327733131837       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327733349052       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e-01 is 4.722097e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183152 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0429e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -6.882752e-01 3 1  ON 0
ci_002                -7.125530e-01 3 1  ON 1
ci_003                -6.168541e-02 3 1  ON 2
ci_004                -6.216498e-02 3 1  ON 3
ci_005                 4.489441e-02 3 1  ON 4
ci_006                 4.656992e-02 3 1  ON 5
ci_007                 3.144575e-02 3 1  ON 6
ci_008                 3.232092e-02 3 1  ON 7
ci_009                -2.457738e-02 3 1  ON 8
ci_010                -2.519331e-02 3 1  ON 9
ci_011                -2.143190e-02 3 1  ON 10
ci_012                -2.220002e-02 3 1  ON 11
ci_013                 1.979247e-02 3 1  ON 12
ci_014                 2.120816e-02 3 1  ON 13
ci_015                 1.980493e-02 3 1  ON 14
ci_016                 2.051382e-02 3 1  ON 15
ci_017                 1.460484e-02 3 1  ON 16
ci_018                 1.636345e-02 3 1  ON 17
ci_019                 9.981392e-03 3 1  ON 18
ci_020                 1.012346e-02 3 1  ON 19
ci_021                -9.507965e-03 3 1  ON 20
ci_022                -1.023021e-02 3 1  ON 21
ci_023                 8.608388e-03 3 1  ON 22
ci_024                 8.670857e-03 3 1  ON 23
ci_025                 8.001396e-03 3 1  ON 24
ci_026                 8.908875e-03 3 1  ON 25
ci_027                 8.317772e-03 3 1  ON 26
ci_028                 8.259744e-03 3 1  ON 27
ci_029                -7.146290e-03 3 1  ON 28
ci_030                -7.201636e-03 3 1  ON 29
ci_031                -7.657033e-03 3 1  ON 30
ci_032                -7.509390e-03 3 1  ON 31
ci_033                 6.607795e-03 3 1  ON 32
ci_034                 7.523885e-03 3 1  ON 33
ci_035                 6.353680e-03 3 1  ON 34
ci_036                 7.080799e-03 3 1  ON 35
ci_037                 6.075326e-03 3 1  ON 36
ci_038                 6.458209e-03 3 1  ON 37
ci_039                 5.558034e-03 3 1  ON 38
ci_040                 5.380407e-03 3 1  ON 39
ci_041                 5.130970e-03 3 1  ON 40
ci_042                 5.245988e-03 3 1  ON 41
ci_043                 4.934093e-03 3 1  ON 42
ci_044                 4.881660e-03 3 1  ON 43
ci_045                 4.972903e-03 3 1  ON 44
ci_046                 4.930741e-03 3 1  ON 45
ci_047                -4.393491e-03 3 1  ON 46
ci_048                -4.741998e-03 3 1  ON 47
ci_049                 2.909847e-03 3 1  ON 48
ci_050                 3.139045e-03 3 1  ON 49
ci_051                -2.709385e-03 3 1  ON 50
ci_052                -3.659222e-03 3 1  ON 51
ci_053                -2.325752e-03 3 1  ON 52
ci_054                -2.732599e-03 3 1  ON 53
ci_055                -2.707698e-03 3 1  ON 54
ci_056                -2.512616e-03 3 1  ON 55
ci_057                -2.078276e-03 3 1  ON 56
ci_058                -1.523870e-03 3 1  ON 57
ci_059                -1.727344e-03 3 1  ON 58
ci_060                -1.936549e-03 3 1  ON 59
ci_061                -8.832967e-04 3 1  ON 60
ci_062                -2.063330e-03 3 1  ON 61
ci_063                -1.695751e-03 3 1  ON 62
ci_064                -1.916871e-03 3 1  ON 63
ci_065                -7.516923e-04 3 1  ON 64
ci_066                -1.167789e-03 3 1  ON 65
ci_067                -1.081939e-04 3 1  ON 66
ci_068                -1.416553e-03 3 1  ON 67
ci_069                 1.313411e-03 3 1  ON 68
ci_070                 1.070168e-03 3 1  ON 69
ci_071                -9.931032e-04 3 1  ON 70
ci_072                -7.521165e-04 3 1  ON 71
ci_073                 9.101089e-04 3 1  ON 72
ci_074                 1.286383e-03 3 1  ON 73
ci_075                -1.120613e-03 3 1  ON 74
ci_076                -8.118805e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.1135
    reference variance = 3.20679
====================================================
  Execution time = 2.5774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7059e+00
  Total weights = 1.9498e+06
  Execution time = 4.4565e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755497772211
                                         uncertainty =       0.029377864096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755497772211
                                         uncertainty =       0.029377864096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370442736
  error estimate for blocks of size 2^( 2) =       0.001440970069
  error estimate for blocks of size 2^( 3) =       0.001502608571
  error estimate for blocks of size 2^( 4) =       0.001545346489
  error estimate for blocks of size 2^( 5) =       0.001570096562
  error estimate for blocks of size 2^( 6) =       0.001580324255
  error estimate for blocks of size 2^( 7) =       0.001584554406

      target function =                  N/A
              le_mean =     -22.327153383739
             les_mean =     502.232803101590
             stat err =       0.001570080428
             autocorr =       1.312568606982
              std dev =       1.938129713684
             le_variance =       3.756346787064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755714707017
                                         uncertainty =       0.029367240530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755714707017
                                         uncertainty =       0.029367240530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370482596
  error estimate for blocks of size 2^( 2) =       0.001440971187
  error estimate for blocks of size 2^( 3) =       0.001502589379
  error estimate for blocks of size 2^( 4) =       0.001545339344
  error estimate for blocks of size 2^( 5) =       0.001570101647
  error estimate for blocks of size 2^( 6) =       0.001580338338
  error estimate for blocks of size 2^( 7) =       0.001584580983

      target function =                  N/A
              le_mean =     -22.327142658960
             les_mean =     502.225807961738
             stat err =       0.001570090078
             autocorr =       1.312508391052
              std dev =       1.938186084891
             le_variance =       3.756565299664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757433770573
                                         uncertainty =       0.029714490810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757433770573
                                         uncertainty =       0.029714490810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370794947
  error estimate for blocks of size 2^( 2) =       0.001441262626
  error estimate for blocks of size 2^( 3) =       0.001502866510
  error estimate for blocks of size 2^( 4) =       0.001545606652
  error estimate for blocks of size 2^( 5) =       0.001570343666
  error estimate for blocks of size 2^( 6) =       0.001580530371
  error estimate for blocks of size 2^( 7) =       0.001584620400

      target function =                  N/A
              le_mean =     -22.327122257055
             les_mean =     502.500218113417
             stat err =       0.001570275272
             autocorr =       1.312219821647
              std dev =       1.938627822841
             le_variance =       3.758277835495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755384824491
                                         uncertainty =       0.029376754559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.755384824491
                                         uncertainty =       0.029376754559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370422249
  error estimate for blocks of size 2^( 2) =       0.001440940145
  error estimate for blocks of size 2^( 3) =       0.001502576621
  error estimate for blocks of size 2^( 4) =       0.001545327555
  error estimate for blocks of size 2^( 5) =       0.001570095896
  error estimate for blocks of size 2^( 6) =       0.001580317346
  error estimate for blocks of size 2^( 7) =       0.001584566082

      target function =                  N/A
              le_mean =     -22.327142272076
             les_mean =     502.218936201547
             stat err =       0.001570076720
             autocorr =       1.312601652469
              std dev =       1.938100739426
             le_variance =       3.756234476162


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327153383739        initial  <--
     5.4210e-02     5.4210e-01             2.4742e-03       -22.327142658960
     2.1684e-01     2.1684e+00             1.3375e-03       -22.327122257055
     8.6736e-01     8.6736e+00             4.7221e-04       -22.327142272076

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.1988
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -6.880535e-01 3 1  ON 0
ci_002                -7.127447e-01 3 1  ON 1
ci_003                -6.173204e-02 3 1  ON 2
ci_004                -6.297704e-02 3 1  ON 3
ci_005                 4.449103e-02 3 1  ON 4
ci_006                 4.639475e-02 3 1  ON 5
ci_007                 3.125804e-02 3 1  ON 6
ci_008                 3.281715e-02 3 1  ON 7
ci_009                -2.438966e-02 3 1  ON 8
ci_010                -2.485771e-02 3 1  ON 9
ci_011                -2.254132e-02 3 1  ON 10
ci_012                -2.228930e-02 3 1  ON 11
ci_013                 2.002242e-02 3 1  ON 12
ci_014                 2.062099e-02 3 1  ON 13
ci_015                 1.953032e-02 3 1  ON 14
ci_016                 2.012969e-02 3 1  ON 15
ci_017                 1.411197e-02 3 1  ON 16
ci_018                 1.502591e-02 3 1  ON 17
ci_019                 9.890398e-03 3 1  ON 18
ci_020                 9.915240e-03 3 1  ON 19
ci_021                -9.906171e-03 3 1  ON 20
ci_022                -1.103727e-02 3 1  ON 21
ci_023                 8.053628e-03 3 1  ON 22
ci_024                 8.740187e-03 3 1  ON 23
ci_025                 8.116435e-03 3 1  ON 24
ci_026                 9.229408e-03 3 1  ON 25
ci_027                 7.818614e-03 3 1  ON 26
ci_028                 8.485503e-03 3 1  ON 27
ci_029                -7.294032e-03 3 1  ON 28
ci_030                -7.419241e-03 3 1  ON 29
ci_031                -7.880086e-03 3 1  ON 30
ci_032                -7.454809e-03 3 1  ON 31
ci_033                 6.458225e-03 3 1  ON 32
ci_034                 7.027875e-03 3 1  ON 33
ci_035                 6.254938e-03 3 1  ON 34
ci_036                 7.089562e-03 3 1  ON 35
ci_037                 6.656285e-03 3 1  ON 36
ci_038                 6.343976e-03 3 1  ON 37
ci_039                 5.017407e-03 3 1  ON 38
ci_040                 5.426866e-03 3 1  ON 39
ci_041                 5.419119e-03 3 1  ON 40
ci_042                 4.566035e-03 3 1  ON 41
ci_043                 4.796182e-03 3 1  ON 42
ci_044                 4.932572e-03 3 1  ON 43
ci_045                 5.338173e-03 3 1  ON 44
ci_046                 5.326504e-03 3 1  ON 45
ci_047                -4.304187e-03 3 1  ON 46
ci_048                -4.582817e-03 3 1  ON 47
ci_049                 3.252076e-03 3 1  ON 48
ci_050                 3.317354e-03 3 1  ON 49
ci_051                -2.300742e-03 3 1  ON 50
ci_052                -3.200190e-03 3 1  ON 51
ci_053                -2.797885e-03 3 1  ON 52
ci_054                -2.380488e-03 3 1  ON 53
ci_055                -2.209380e-03 3 1  ON 54
ci_056                -1.559809e-03 3 1  ON 55
ci_057                -2.685858e-03 3 1  ON 56
ci_058                -1.793389e-03 3 1  ON 57
ci_059                -1.613836e-03 3 1  ON 58
ci_060                -2.095957e-03 3 1  ON 59
ci_061                -1.388261e-03 3 1  ON 60
ci_062                -2.024944e-03 3 1  ON 61
ci_063                -1.365021e-03 3 1  ON 62
ci_064                -1.497889e-03 3 1  ON 63
ci_065                -1.089646e-03 3 1  ON 64
ci_066                -1.668157e-03 3 1  ON 65
ci_067                 1.528720e-04 3 1  ON 66
ci_068                -1.662732e-03 3 1  ON 67
ci_069                 1.646958e-03 3 1  ON 68
ci_070                 1.102329e-03 3 1  ON 69
ci_071                -1.398013e-03 3 1  ON 70
ci_072                -1.040424e-03 3 1  ON 71
ci_073                 8.891394e-04 3 1  ON 72
ci_074                 7.310121e-04 3 1  ON 73
ci_075                -1.008769e-03 3 1  ON 74
ci_076                -1.433928e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8642e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2308e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.1687
    reference variance = 3.87798
====================================================
  Execution time = 2.4427e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0271e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7000e+00
  Total weights = 1.950121261e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1172e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750054335791
                                         uncertainty =       0.024780943453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.750054335791
                                         uncertainty =       0.024780943453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369463249
  error estimate for blocks of size 2^( 2) =       0.001439291463
  error estimate for blocks of size 2^( 3) =       0.001502445876
  error estimate for blocks of size 2^( 4) =       0.001547127431
  error estimate for blocks of size 2^( 5) =       0.001575640204
  error estimate for blocks of size 2^( 6) =       0.001584034220
  error estimate for blocks of size 2^( 7) =       0.001596827641

      target function =                  N/A
              le_mean =     -22.326431953002
             les_mean =     502.169602228884
             stat err =       0.001575907374
             autocorr =       1.324221429157
              std dev =       1.936744486693
             le_variance =       3.750979206737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232643195300e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e-01, overlap shift 5.4210e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326431952169       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326453454329       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326455672548       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326455442826       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e-01 is 5.685611e-04

solving harmonic davidson linear method for identity shift 2.1684e+00, overlap shift 2.1684e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326431952169       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326438650036       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326439120738       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326439099109       residual = 6.49e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+00 is 1.757902e-04

solving harmonic davidson linear method for identity shift 8.6736e+00, overlap shift 8.6736e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326431952169       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326433736358       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326433848748       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326433844481       residual = 1.63e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+00 is 4.674574e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0551e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -6.879361e-01 3 1  ON 0
ci_002                -7.128419e-01 3 1  ON 1
ci_003                -6.172327e-02 3 1  ON 2
ci_004                -6.302010e-02 3 1  ON 3
ci_005                 4.456798e-02 3 1  ON 4
ci_006                 4.646238e-02 3 1  ON 5
ci_007                 3.123095e-02 3 1  ON 6
ci_008                 3.276084e-02 3 1  ON 7
ci_009                -2.433701e-02 3 1  ON 8
ci_010                -2.478589e-02 3 1  ON 9
ci_011                -2.271711e-02 3 1  ON 10
ci_012                -2.237822e-02 3 1  ON 11
ci_013                 2.014497e-02 3 1  ON 12
ci_014                 2.063842e-02 3 1  ON 13
ci_015                 1.951292e-02 3 1  ON 14
ci_016                 2.011973e-02 3 1  ON 15
ci_017                 1.423740e-02 3 1  ON 16
ci_018                 1.499242e-02 3 1  ON 17
ci_019                 9.867378e-03 3 1  ON 18
ci_020                 1.000949e-02 3 1  ON 19
ci_021                -9.838860e-03 3 1  ON 20
ci_022                -1.103402e-02 3 1  ON 21
ci_023                 8.099112e-03 3 1  ON 22
ci_024                 8.837397e-03 3 1  ON 23
ci_025                 8.245795e-03 3 1  ON 24
ci_026                 9.272923e-03 3 1  ON 25
ci_027                 7.721306e-03 3 1  ON 26
ci_028                 8.380391e-03 3 1  ON 27
ci_029                -7.184874e-03 3 1  ON 28
ci_030                -7.441398e-03 3 1  ON 29
ci_031                -7.810469e-03 3 1  ON 30
ci_032                -7.399620e-03 3 1  ON 31
ci_033                 6.432947e-03 3 1  ON 32
ci_034                 6.984137e-03 3 1  ON 33
ci_035                 6.227741e-03 3 1  ON 34
ci_036                 7.118736e-03 3 1  ON 35
ci_037                 6.742511e-03 3 1  ON 36
ci_038                 6.294290e-03 3 1  ON 37
ci_039                 5.062801e-03 3 1  ON 38
ci_040                 5.432420e-03 3 1  ON 39
ci_041                 5.338938e-03 3 1  ON 40
ci_042                 4.610551e-03 3 1  ON 41
ci_043                 4.762713e-03 3 1  ON 42
ci_044                 4.964916e-03 3 1  ON 43
ci_045                 5.323321e-03 3 1  ON 44
ci_046                 5.429076e-03 3 1  ON 45
ci_047                -4.251590e-03 3 1  ON 46
ci_048                -4.502635e-03 3 1  ON 47
ci_049                 3.146940e-03 3 1  ON 48
ci_050                 3.261571e-03 3 1  ON 49
ci_051                -2.400808e-03 3 1  ON 50
ci_052                -3.144925e-03 3 1  ON 51
ci_053                -2.879338e-03 3 1  ON 52
ci_054                -2.434586e-03 3 1  ON 53
ci_055                -2.223517e-03 3 1  ON 54
ci_056                -1.592621e-03 3 1  ON 55
ci_057                -2.738813e-03 3 1  ON 56
ci_058                -1.890291e-03 3 1  ON 57
ci_059                -1.671096e-03 3 1  ON 58
ci_060                -1.942346e-03 3 1  ON 59
ci_061                -1.400584e-03 3 1  ON 60
ci_062                -1.962291e-03 3 1  ON 61
ci_063                -1.441464e-03 3 1  ON 62
ci_064                -1.404274e-03 3 1  ON 63
ci_065                -1.170739e-03 3 1  ON 64
ci_066                -1.551157e-03 3 1  ON 65
ci_067                 2.709007e-05 3 1  ON 66
ci_068                -1.639786e-03 3 1  ON 67
ci_069                 1.622708e-03 3 1  ON 68
ci_070                 1.205495e-03 3 1  ON 69
ci_071                -1.537614e-03 3 1  ON 70
ci_072                -9.738895e-04 3 1  ON 71
ci_073                 8.595509e-04 3 1  ON 72
ci_074                 8.069508e-04 3 1  ON 73
ci_075                -9.996588e-04 3 1  ON 74
ci_076                -1.402596e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.5149
    reference variance = 2.18489
====================================================
  Execution time = 2.3764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.6652e+00
  Total weights = 1.9499e+06
  Execution time = 4.4787e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715862032006
                                         uncertainty =       0.025596235979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715862032006
                                         uncertainty =       0.025596235979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363340458
  error estimate for blocks of size 2^( 2) =       0.001435399963
  error estimate for blocks of size 2^( 3) =       0.001498512114
  error estimate for blocks of size 2^( 4) =       0.001541487026
  error estimate for blocks of size 2^( 5) =       0.001567121312
  error estimate for blocks of size 2^( 6) =       0.001580022324
  error estimate for blocks of size 2^( 7) =       0.001592373107

      target function =                  N/A
              le_mean =     -22.330940751856
             les_mean =     502.336341194481
             stat err =       0.001570250942
             autocorr =       1.326567885890
              std dev =       1.928085414798
             le_variance =       3.717513366756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715879326480
                                         uncertainty =       0.025596819934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715879326480
                                         uncertainty =       0.025596819934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363343523
  error estimate for blocks of size 2^( 2) =       0.001435391329
  error estimate for blocks of size 2^( 3) =       0.001498496203
  error estimate for blocks of size 2^( 4) =       0.001541457914
  error estimate for blocks of size 2^( 5) =       0.001567097566
  error estimate for blocks of size 2^( 6) =       0.001580004637
  error estimate for blocks of size 2^( 7) =       0.001592353504

      target function =                  N/A
              le_mean =     -22.330936213969
             les_mean =     502.337170654269
             stat err =       0.001570228405
             autocorr =       1.326523843262
              std dev =       1.928089748745
             le_variance =       3.717530079217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715867154370
                                         uncertainty =       0.025596871342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715867154370
                                         uncertainty =       0.025596871342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363341333
  error estimate for blocks of size 2^( 2) =       0.001435393590
  error estimate for blocks of size 2^( 3) =       0.001498499922
  error estimate for blocks of size 2^( 4) =       0.001541466590
  error estimate for blocks of size 2^( 5) =       0.001567104437
  error estimate for blocks of size 2^( 6) =       0.001580009867
  error estimate for blocks of size 2^( 7) =       0.001592359159

      target function =                  N/A
              le_mean =     -22.330936641166
             les_mean =     502.374295501318
             stat err =       0.001570235014
             autocorr =       1.326539269579
              std dev =       1.928086652228
             le_variance =       3.717518138500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715861194405
                                         uncertainty =       0.025596291574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715861194405
                                         uncertainty =       0.025596291574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363340296
  error estimate for blocks of size 2^( 2) =       0.001435399078
  error estimate for blocks of size 2^( 3) =       0.001498510461
  error estimate for blocks of size 2^( 4) =       0.001541484077
  error estimate for blocks of size 2^( 5) =       0.001567118237
  error estimate for blocks of size 2^( 6) =       0.001580019993
  error estimate for blocks of size 2^( 7) =       0.001592371219

      target function =                  N/A
              le_mean =     -22.330939629185
             les_mean =     502.337483737157
             stat err =       0.001570248382
             autocorr =       1.326563874330
              std dev =       1.928085185749
             le_variance =       3.717512483504


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330940751856        initial  <--
     5.4210e-01     5.4210e+00             5.6856e-04       -22.330936213969
     2.1684e+00     2.1684e+01             1.7579e-04       -22.330936641166
     8.6736e+00     8.6736e+01             4.6746e-05       -22.330939629185

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.2943
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -6.880535e-01 3 1  ON 0
ci_002                -7.127447e-01 3 1  ON 1
ci_003                -6.173204e-02 3 1  ON 2
ci_004                -6.297704e-02 3 1  ON 3
ci_005                 4.449103e-02 3 1  ON 4
ci_006                 4.639475e-02 3 1  ON 5
ci_007                 3.125804e-02 3 1  ON 6
ci_008                 3.281715e-02 3 1  ON 7
ci_009                -2.438966e-02 3 1  ON 8
ci_010                -2.485771e-02 3 1  ON 9
ci_011                -2.254132e-02 3 1  ON 10
ci_012                -2.228930e-02 3 1  ON 11
ci_013                 2.002242e-02 3 1  ON 12
ci_014                 2.062099e-02 3 1  ON 13
ci_015                 1.953032e-02 3 1  ON 14
ci_016                 2.012969e-02 3 1  ON 15
ci_017                 1.411197e-02 3 1  ON 16
ci_018                 1.502591e-02 3 1  ON 17
ci_019                 9.890398e-03 3 1  ON 18
ci_020                 9.915240e-03 3 1  ON 19
ci_021                -9.906171e-03 3 1  ON 20
ci_022                -1.103727e-02 3 1  ON 21
ci_023                 8.053628e-03 3 1  ON 22
ci_024                 8.740187e-03 3 1  ON 23
ci_025                 8.116435e-03 3 1  ON 24
ci_026                 9.229408e-03 3 1  ON 25
ci_027                 7.818614e-03 3 1  ON 26
ci_028                 8.485503e-03 3 1  ON 27
ci_029                -7.294032e-03 3 1  ON 28
ci_030                -7.419241e-03 3 1  ON 29
ci_031                -7.880086e-03 3 1  ON 30
ci_032                -7.454809e-03 3 1  ON 31
ci_033                 6.458225e-03 3 1  ON 32
ci_034                 7.027875e-03 3 1  ON 33
ci_035                 6.254938e-03 3 1  ON 34
ci_036                 7.089562e-03 3 1  ON 35
ci_037                 6.656285e-03 3 1  ON 36
ci_038                 6.343976e-03 3 1  ON 37
ci_039                 5.017407e-03 3 1  ON 38
ci_040                 5.426866e-03 3 1  ON 39
ci_041                 5.419119e-03 3 1  ON 40
ci_042                 4.566035e-03 3 1  ON 41
ci_043                 4.796182e-03 3 1  ON 42
ci_044                 4.932572e-03 3 1  ON 43
ci_045                 5.338173e-03 3 1  ON 44
ci_046                 5.326504e-03 3 1  ON 45
ci_047                -4.304187e-03 3 1  ON 46
ci_048                -4.582817e-03 3 1  ON 47
ci_049                 3.252076e-03 3 1  ON 48
ci_050                 3.317354e-03 3 1  ON 49
ci_051                -2.300742e-03 3 1  ON 50
ci_052                -3.200190e-03 3 1  ON 51
ci_053                -2.797885e-03 3 1  ON 52
ci_054                -2.380488e-03 3 1  ON 53
ci_055                -2.209380e-03 3 1  ON 54
ci_056                -1.559809e-03 3 1  ON 55
ci_057                -2.685858e-03 3 1  ON 56
ci_058                -1.793389e-03 3 1  ON 57
ci_059                -1.613836e-03 3 1  ON 58
ci_060                -2.095957e-03 3 1  ON 59
ci_061                -1.388261e-03 3 1  ON 60
ci_062                -2.024944e-03 3 1  ON 61
ci_063                -1.365021e-03 3 1  ON 62
ci_064                -1.497889e-03 3 1  ON 63
ci_065                -1.089646e-03 3 1  ON 64
ci_066                -1.668157e-03 3 1  ON 65
ci_067                 1.528720e-04 3 1  ON 66
ci_068                -1.662732e-03 3 1  ON 67
ci_069                 1.646958e-03 3 1  ON 68
ci_070                 1.102329e-03 3 1  ON 69
ci_071                -1.398013e-03 3 1  ON 70
ci_072                -1.040424e-03 3 1  ON 71
ci_073                 8.891394e-04 3 1  ON 72
ci_074                 7.310121e-04 3 1  ON 73
ci_075                -1.008769e-03 3 1  ON 74
ci_076                -1.433928e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6852e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2309e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.0638
    reference variance = 18.0962
====================================================
  Execution time = 2.4415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0332e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.8053e+00
  Total weights = 1.949869178e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9862e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.852018829739
                                         uncertainty =       0.078952835059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.852018829739
                                         uncertainty =       0.078952835059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001388357629
  error estimate for blocks of size 2^( 2) =       0.001458588651
  error estimate for blocks of size 2^( 3) =       0.001519082033
  error estimate for blocks of size 2^( 4) =       0.001561824277
  error estimate for blocks of size 2^( 5) =       0.001583578528
  error estimate for blocks of size 2^( 6) =       0.001588854117
  error estimate for blocks of size 2^( 7) =       0.001588409929

      target function =                  N/A
              le_mean =     -22.329226626986
             les_mean =     502.399704255506
             stat err =       0.001580666713
             autocorr =       1.296217596495
              std dev =       1.963465603451
             le_variance =       3.855197175933


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232922662699e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+00, overlap shift 5.4210e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329226626219       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329229200883       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329229206440       residual = 3.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+00 is 7.618306e-05

solving harmonic davidson linear method for identity shift 2.1684e+01, overlap shift 2.1684e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329226626219       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329227286686       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329227285402       residual = 1.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+01 is 1.963459e-05

solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329226626219       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329226792420       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329226791925       residual = 1.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+01 is 4.962031e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185861 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0407e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -6.880531e-01 3 1  ON 0
ci_002                -7.127446e-01 3 1  ON 1
ci_003                -6.173908e-02 3 1  ON 2
ci_004                -6.297240e-02 3 1  ON 3
ci_005                 4.448885e-02 3 1  ON 4
ci_006                 4.638315e-02 3 1  ON 5
ci_007                 3.125693e-02 3 1  ON 6
ci_008                 3.281738e-02 3 1  ON 7
ci_009                -2.439269e-02 3 1  ON 8
ci_010                -2.485721e-02 3 1  ON 9
ci_011                -2.253787e-02 3 1  ON 10
ci_012                -2.228782e-02 3 1  ON 11
ci_013                 2.001058e-02 3 1  ON 12
ci_014                 2.061772e-02 3 1  ON 13
ci_015                 1.953461e-02 3 1  ON 14
ci_016                 2.014908e-02 3 1  ON 15
ci_017                 1.412865e-02 3 1  ON 16
ci_018                 1.504094e-02 3 1  ON 17
ci_019                 9.896257e-03 3 1  ON 18
ci_020                 9.909485e-03 3 1  ON 19
ci_021                -9.895926e-03 3 1  ON 20
ci_022                -1.104248e-02 3 1  ON 21
ci_023                 8.061213e-03 3 1  ON 22
ci_024                 8.745548e-03 3 1  ON 23
ci_025                 8.123478e-03 3 1  ON 24
ci_026                 9.228736e-03 3 1  ON 25
ci_027                 7.816454e-03 3 1  ON 26
ci_028                 8.483551e-03 3 1  ON 27
ci_029                -7.294561e-03 3 1  ON 28
ci_030                -7.432902e-03 3 1  ON 29
ci_031                -7.881711e-03 3 1  ON 30
ci_032                -7.458861e-03 3 1  ON 31
ci_033                 6.456553e-03 3 1  ON 32
ci_034                 7.034349e-03 3 1  ON 33
ci_035                 6.259048e-03 3 1  ON 34
ci_036                 7.077480e-03 3 1  ON 35
ci_037                 6.652373e-03 3 1  ON 36
ci_038                 6.341342e-03 3 1  ON 37
ci_039                 5.019802e-03 3 1  ON 38
ci_040                 5.424328e-03 3 1  ON 39
ci_041                 5.412153e-03 3 1  ON 40
ci_042                 4.578726e-03 3 1  ON 41
ci_043                 4.795486e-03 3 1  ON 42
ci_044                 4.939372e-03 3 1  ON 43
ci_045                 5.340046e-03 3 1  ON 44
ci_046                 5.322449e-03 3 1  ON 45
ci_047                -4.311706e-03 3 1  ON 46
ci_048                -4.579702e-03 3 1  ON 47
ci_049                 3.261747e-03 3 1  ON 48
ci_050                 3.333836e-03 3 1  ON 49
ci_051                -2.296957e-03 3 1  ON 50
ci_052                -3.212168e-03 3 1  ON 51
ci_053                -2.800020e-03 3 1  ON 52
ci_054                -2.378722e-03 3 1  ON 53
ci_055                -2.206801e-03 3 1  ON 54
ci_056                -1.567050e-03 3 1  ON 55
ci_057                -2.676798e-03 3 1  ON 56
ci_058                -1.805067e-03 3 1  ON 57
ci_059                -1.613624e-03 3 1  ON 58
ci_060                -2.091203e-03 3 1  ON 59
ci_061                -1.392439e-03 3 1  ON 60
ci_062                -2.014399e-03 3 1  ON 61
ci_063                -1.364384e-03 3 1  ON 62
ci_064                -1.501334e-03 3 1  ON 63
ci_065                -1.095757e-03 3 1  ON 64
ci_066                -1.666828e-03 3 1  ON 65
ci_067                 1.452752e-04 3 1  ON 66
ci_068                -1.653004e-03 3 1  ON 67
ci_069                 1.646671e-03 3 1  ON 68
ci_070                 1.099503e-03 3 1  ON 69
ci_071                -1.396931e-03 3 1  ON 70
ci_072                -1.042968e-03 3 1  ON 71
ci_073                 8.874810e-04 3 1  ON 72
ci_074                 7.506467e-04 3 1  ON 73
ci_075                -1.016030e-03 3 1  ON 74
ci_076                -1.432597e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.1742
    reference variance = 4.96455
====================================================
  Execution time = 2.3759e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6983e+00
  Total weights = 1.9502e+06
  Execution time = 4.4630e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745971686374
                                         uncertainty =       0.027717011697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745971686374
                                         uncertainty =       0.027717011697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368461941
  error estimate for blocks of size 2^( 2) =       0.001439234708
  error estimate for blocks of size 2^( 3) =       0.001502959213
  error estimate for blocks of size 2^( 4) =       0.001548498181
  error estimate for blocks of size 2^( 5) =       0.001573140020
  error estimate for blocks of size 2^( 6) =       0.001583724399
  error estimate for blocks of size 2^( 7) =       0.001589229450

      target function =                  N/A
              le_mean =     -22.328389874254
             les_mean =     502.255354673443
             stat err =       0.001573648013
             autocorr =       1.322360135284
              std dev =       1.935328401084
             le_variance =       3.745496020042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745970167088
                                         uncertainty =       0.027716766244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745970167088
                                         uncertainty =       0.027716766244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368461663
  error estimate for blocks of size 2^( 2) =       0.001439233839
  error estimate for blocks of size 2^( 3) =       0.001502959144
  error estimate for blocks of size 2^( 4) =       0.001548497545
  error estimate for blocks of size 2^( 5) =       0.001573141340
  error estimate for blocks of size 2^( 6) =       0.001583725099
  error estimate for blocks of size 2^( 7) =       0.001589230276

      target function =                  N/A
              le_mean =     -22.328390023476
             les_mean =     502.255211170518
             stat err =       0.001573648565
             autocorr =       1.322361599989
              std dev =       1.935328008517
             le_variance =       3.745494500549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745970738443
                                         uncertainty =       0.027716887402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745970738443
                                         uncertainty =       0.027716887402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368461768
  error estimate for blocks of size 2^( 2) =       0.001439234237
  error estimate for blocks of size 2^( 3) =       0.001502959166
  error estimate for blocks of size 2^( 4) =       0.001548497848
  error estimate for blocks of size 2^( 5) =       0.001573140702
  error estimate for blocks of size 2^( 6) =       0.001583724773
  error estimate for blocks of size 2^( 7) =       0.001589229890

      target function =                  N/A
              le_mean =     -22.328389929324
             les_mean =     502.255255248241
             stat err =       0.001573648303
             autocorr =       1.322360958058
              std dev =       1.935328156162
             le_variance =       3.745495072035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745971550310
                                         uncertainty =       0.027716996171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745971550310
                                         uncertainty =       0.027716996171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368461916
  error estimate for blocks of size 2^( 2) =       0.001439234646
  error estimate for blocks of size 2^( 3) =       0.001502959205
  error estimate for blocks of size 2^( 4) =       0.001548498137
  error estimate for blocks of size 2^( 5) =       0.001573140106
  error estimate for blocks of size 2^( 6) =       0.001583724447
  error estimate for blocks of size 2^( 7) =       0.001589229505

      target function =                  N/A
              le_mean =     -22.328389877886
             les_mean =     502.255338517976
             stat err =       0.001573648049
             autocorr =       1.322360243896
              std dev =       1.935328365931
             le_variance =       3.745495883976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328389874254        initial
     5.4210e+00     5.4210e+01             7.6183e-05       -22.328390023476  <--
     2.1684e+01     2.1684e+02             1.9635e-05       -22.328389929324
     8.6736e+01     8.6736e+02             4.9620e-06       -22.328389877886

*****************************************************************************
Applying the update for shift_i =   5.4210e+00     and shift_s =   5.4210e+01
*****************************************************************************

  Execution time = 4.6196e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -6.880516e-01 3 1  ON 0
ci_002                -7.127443e-01 3 1  ON 1
ci_003                -6.176009e-02 3 1  ON 2
ci_004                -6.295850e-02 3 1  ON 3
ci_005                 4.448272e-02 3 1  ON 4
ci_006                 4.634989e-02 3 1  ON 5
ci_007                 3.125373e-02 3 1  ON 6
ci_008                 3.281820e-02 3 1  ON 7
ci_009                -2.440170e-02 3 1  ON 8
ci_010                -2.485593e-02 3 1  ON 9
ci_011                -2.252784e-02 3 1  ON 10
ci_012                -2.228359e-02 3 1  ON 11
ci_013                 1.997597e-02 3 1  ON 12
ci_014                 2.060818e-02 3 1  ON 13
ci_015                 1.954708e-02 3 1  ON 14
ci_016                 2.020587e-02 3 1  ON 15
ci_017                 1.417723e-02 3 1  ON 16
ci_018                 1.508479e-02 3 1  ON 17
ci_019                 9.913233e-03 3 1  ON 18
ci_020                 9.892575e-03 3 1  ON 19
ci_021                -9.865907e-03 3 1  ON 20
ci_022                -1.105766e-02 3 1  ON 21
ci_023                 8.083214e-03 3 1  ON 22
ci_024                 8.761059e-03 3 1  ON 23
ci_025                 8.143910e-03 3 1  ON 24
ci_026                 9.226768e-03 3 1  ON 25
ci_027                 7.810347e-03 3 1  ON 26
ci_028                 8.477988e-03 3 1  ON 27
ci_029                -7.296014e-03 3 1  ON 28
ci_030                -7.472633e-03 3 1  ON 29
ci_031                -7.886560e-03 3 1  ON 30
ci_032                -7.470611e-03 3 1  ON 31
ci_033                 6.451621e-03 3 1  ON 32
ci_034                 7.053321e-03 3 1  ON 33
ci_035                 6.270684e-03 3 1  ON 34
ci_036                 7.043065e-03 3 1  ON 35
ci_037                 6.640921e-03 3 1  ON 36
ci_038                 6.333667e-03 3 1  ON 37
ci_039                 5.026624e-03 3 1  ON 38
ci_040                 5.417082e-03 3 1  ON 39
ci_041                 5.392105e-03 3 1  ON 40
ci_042                 4.615339e-03 3 1  ON 41
ci_043                 4.793408e-03 3 1  ON 42
ci_044                 4.959360e-03 3 1  ON 43
ci_045                 5.345450e-03 3 1  ON 44
ci_046                 5.310502e-03 3 1  ON 45
ci_047                -4.333017e-03 3 1  ON 46
ci_048                -4.570934e-03 3 1  ON 47
ci_049                 3.289875e-03 3 1  ON 48
ci_050                 3.381884e-03 3 1  ON 49
ci_051                -2.285918e-03 3 1  ON 50
ci_052                -3.246992e-03 3 1  ON 51
ci_053                -2.806271e-03 3 1  ON 52
ci_054                -2.373660e-03 3 1  ON 53
ci_055                -2.199225e-03 3 1  ON 54
ci_056                -1.588284e-03 3 1  ON 55
ci_057                -2.650551e-03 3 1  ON 56
ci_058                -1.838981e-03 3 1  ON 57
ci_059                -1.612949e-03 3 1  ON 58
ci_060                -2.077907e-03 3 1  ON 59
ci_061                -1.404603e-03 3 1  ON 60
ci_062                -1.983928e-03 3 1  ON 61
ci_063                -1.362632e-03 3 1  ON 62
ci_064                -1.511498e-03 3 1  ON 63
ci_065                -1.113520e-03 3 1  ON 64
ci_066                -1.662792e-03 3 1  ON 65
ci_067                 1.232540e-04 3 1  ON 66
ci_068                -1.624525e-03 3 1  ON 67
ci_069                 1.645850e-03 3 1  ON 68
ci_070                 1.091376e-03 3 1  ON 69
ci_071                -1.393778e-03 3 1  ON 70
ci_072                -1.050176e-03 3 1  ON 71
ci_073                 8.827530e-04 3 1  ON 72
ci_074                 8.063034e-04 3 1  ON 73
ci_075                -1.037045e-03 3 1  ON 74
ci_076                -1.428673e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2306e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.3901
    reference variance = 2.78263
====================================================
  Execution time = 2.4217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0337e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6818e+00
  Total weights = 1.950146621e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9948e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732835090871
                                         uncertainty =       0.030238690849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.732835090871
                                         uncertainty =       0.030238690849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366198506
  error estimate for blocks of size 2^( 2) =       0.001435754906
  error estimate for blocks of size 2^( 3) =       0.001501035114
  error estimate for blocks of size 2^( 4) =       0.001546016134
  error estimate for blocks of size 2^( 5) =       0.001571276126
  error estimate for blocks of size 2^( 6) =       0.001580906974
  error estimate for blocks of size 2^( 7) =       0.001593503193

      target function =                  N/A
              le_mean =     -22.328423042410
             les_mean =     502.240274711919
             stat err =       0.001572925606
             autocorr =       1.325527533173
              std dev =       1.932127369193
             le_variance =       3.733116170786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232842304241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+00, overlap shift 1.3553e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328423041587       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328432268553       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328432230478       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+00 is 2.141714e-04

solving harmonic davidson linear method for identity shift 5.4210e+00, overlap shift 5.4210e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328423041587       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328425601059       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328425578048       residual = 5.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+00 is 6.192718e-05

solving harmonic davidson linear method for identity shift 2.1684e+01, overlap shift 2.1684e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328423041587       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328423699474       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328423692854       residual = 4.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+01 is 1.611091e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187044 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0219e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -6.880525e-01 3 1  ON 0
ci_002                -7.127415e-01 3 1  ON 1
ci_003                -6.175913e-02 3 1  ON 2
ci_004                -6.293581e-02 3 1  ON 3
ci_005                 4.448663e-02 3 1  ON 4
ci_006                 4.637554e-02 3 1  ON 5
ci_007                 3.127553e-02 3 1  ON 6
ci_008                 3.280529e-02 3 1  ON 7
ci_009                -2.443949e-02 3 1  ON 8
ci_010                -2.485210e-02 3 1  ON 9
ci_011                -2.252490e-02 3 1  ON 10
ci_012                -2.229992e-02 3 1  ON 11
ci_013                 2.001399e-02 3 1  ON 12
ci_014                 2.063566e-02 3 1  ON 13
ci_015                 1.950009e-02 3 1  ON 14
ci_016                 2.020153e-02 3 1  ON 15
ci_017                 1.417441e-02 3 1  ON 16
ci_018                 1.510507e-02 3 1  ON 17
ci_019                 9.898653e-03 3 1  ON 18
ci_020                 9.856155e-03 3 1  ON 19
ci_021                -9.825761e-03 3 1  ON 20
ci_022                -1.103380e-02 3 1  ON 21
ci_023                 8.068397e-03 3 1  ON 22
ci_024                 8.793648e-03 3 1  ON 23
ci_025                 8.140092e-03 3 1  ON 24
ci_026                 9.196052e-03 3 1  ON 25
ci_027                 7.780073e-03 3 1  ON 26
ci_028                 8.472174e-03 3 1  ON 27
ci_029                -7.289069e-03 3 1  ON 28
ci_030                -7.516866e-03 3 1  ON 29
ci_031                -7.887097e-03 3 1  ON 30
ci_032                -7.478284e-03 3 1  ON 31
ci_033                 6.489844e-03 3 1  ON 32
ci_034                 7.080462e-03 3 1  ON 33
ci_035                 6.287839e-03 3 1  ON 34
ci_036                 6.981138e-03 3 1  ON 35
ci_037                 6.667396e-03 3 1  ON 36
ci_038                 6.319493e-03 3 1  ON 37
ci_039                 5.007321e-03 3 1  ON 38
ci_040                 5.475623e-03 3 1  ON 39
ci_041                 5.335888e-03 3 1  ON 40
ci_042                 4.641278e-03 3 1  ON 41
ci_043                 4.848881e-03 3 1  ON 42
ci_044                 4.974485e-03 3 1  ON 43
ci_045                 5.374662e-03 3 1  ON 44
ci_046                 5.305396e-03 3 1  ON 45
ci_047                -4.325185e-03 3 1  ON 46
ci_048                -4.555624e-03 3 1  ON 47
ci_049                 3.320142e-03 3 1  ON 48
ci_050                 3.398227e-03 3 1  ON 49
ci_051                -2.270584e-03 3 1  ON 50
ci_052                -3.259325e-03 3 1  ON 51
ci_053                -2.825660e-03 3 1  ON 52
ci_054                -2.395814e-03 3 1  ON 53
ci_055                -2.218605e-03 3 1  ON 54
ci_056                -1.597795e-03 3 1  ON 55
ci_057                -2.663779e-03 3 1  ON 56
ci_058                -1.885141e-03 3 1  ON 57
ci_059                -1.613739e-03 3 1  ON 58
ci_060                -2.080879e-03 3 1  ON 59
ci_061                -1.411081e-03 3 1  ON 60
ci_062                -1.963483e-03 3 1  ON 61
ci_063                -1.375932e-03 3 1  ON 62
ci_064                -1.525972e-03 3 1  ON 63
ci_065                -1.059420e-03 3 1  ON 64
ci_066                -1.628965e-03 3 1  ON 65
ci_067                 6.495524e-05 3 1  ON 66
ci_068                -1.595827e-03 3 1  ON 67
ci_069                 1.662084e-03 3 1  ON 68
ci_070                 1.071289e-03 3 1  ON 69
ci_071                -1.421211e-03 3 1  ON 70
ci_072                -1.037789e-03 3 1  ON 71
ci_073                 8.973802e-04 3 1  ON 72
ci_074                 8.383251e-04 3 1  ON 73
ci_075                -1.012858e-03 3 1  ON 74
ci_076                -1.399559e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.3231
    reference variance = 3.54149
====================================================
  Execution time = 2.3876e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.9456e+00
  Total weights = 1.9503e+06
  Execution time = 4.5010e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.000876348000
                                         uncertainty =       0.222054881776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.000876348000
                                         uncertainty =       0.222054881776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001414427925
  error estimate for blocks of size 2^( 2) =       0.001483382848
  error estimate for blocks of size 2^( 3) =       0.001546602864
  error estimate for blocks of size 2^( 4) =       0.001587471226
  error estimate for blocks of size 2^( 5) =       0.001611229586
  error estimate for blocks of size 2^( 6) =       0.001623565268
  error estimate for blocks of size 2^( 7) =       0.001627820499

      target function =                  N/A
              le_mean =     -22.326720674497
             les_mean =     502.428145198161
             stat err =       0.001612521645
             autocorr =       1.299718981403
              std dev =       2.000335159404
             le_variance =       4.001340749948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.000930671757
                                         uncertainty =       0.222053381046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.000930671757
                                         uncertainty =       0.222053381046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001414437460
  error estimate for blocks of size 2^( 2) =       0.001483385870
  error estimate for blocks of size 2^( 3) =       0.001546601135
  error estimate for blocks of size 2^( 4) =       0.001587467876
  error estimate for blocks of size 2^( 5) =       0.001611222233
  error estimate for blocks of size 2^( 6) =       0.001623558784
  error estimate for blocks of size 2^( 7) =       0.001627810579

      target function =                  N/A
              le_mean =     -22.326721082918
             les_mean =     502.428196987089
             stat err =       0.001612514868
             autocorr =       1.299690534723
              std dev =       2.000348643829
             le_variance =       4.001394696867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.000902105310
                                         uncertainty =       0.222054097853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.000902105310
                                         uncertainty =       0.222054097853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001414432440
  error estimate for blocks of size 2^( 2) =       0.001483383805
  error estimate for blocks of size 2^( 3) =       0.001546601066
  error estimate for blocks of size 2^( 4) =       0.001587468625
  error estimate for blocks of size 2^( 5) =       0.001611224579
  error estimate for blocks of size 2^( 6) =       0.001623560853
  error estimate for blocks of size 2^( 7) =       0.001627814047

      target function =                  N/A
              le_mean =     -22.326720707285
             les_mean =     502.428327957571
             stat err =       0.001612517026
             autocorr =       1.299703239313
              std dev =       2.000341544101
             le_variance =       4.001366293055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.000879241484
                                         uncertainty =       0.222054784763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.000879241484
                                         uncertainty =       0.222054784763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001414428432
  error estimate for blocks of size 2^( 2) =       0.001483382901
  error estimate for blocks of size 2^( 3) =       0.001546602565
  error estimate for blocks of size 2^( 4) =       0.001587470838
  error estimate for blocks of size 2^( 5) =       0.001611228840
  error estimate for blocks of size 2^( 6) =       0.001623564608
  error estimate for blocks of size 2^( 7) =       0.001627819577

      target function =                  N/A
              le_mean =     -22.326720630696
             les_mean =     502.428051538934
             stat err =       0.001612520966
             autocorr =       1.299716955826
              std dev =       2.000335875754
             le_variance =       4.001343615827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326720674497        initial
     1.3553e+00     1.3553e+01             2.1417e-04       -22.326721082918  <--
     5.4210e+00     5.4210e+01             6.1927e-05       -22.326720707285
     2.1684e+01     2.1684e+02             1.6111e-05       -22.326720630696

*****************************************************************************
Applying the update for shift_i =   1.3553e+00     and shift_s =   1.3553e+01
*****************************************************************************

  Execution time = 4.6487e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -6.880560e-01 3 1  ON 0
ci_002                -7.127338e-01 3 1  ON 1
ci_003                -6.175535e-02 3 1  ON 2
ci_004                -6.286935e-02 3 1  ON 3
ci_005                 4.449617e-02 3 1  ON 4
ci_006                 4.643889e-02 3 1  ON 5
ci_007                 3.133176e-02 3 1  ON 6
ci_008                 3.276928e-02 3 1  ON 7
ci_009                -2.453929e-02 3 1  ON 8
ci_010                -2.484228e-02 3 1  ON 9
ci_011                -2.251668e-02 3 1  ON 10
ci_012                -2.234179e-02 3 1  ON 11
ci_013                 2.011652e-02 3 1  ON 12
ci_014                 2.070781e-02 3 1  ON 13
ci_015                 1.937047e-02 3 1  ON 14
ci_016                 2.019048e-02 3 1  ON 15
ci_017                 1.416715e-02 3 1  ON 16
ci_018                 1.516066e-02 3 1  ON 17
ci_019                 9.857516e-03 3 1  ON 18
ci_020                 9.756576e-03 3 1  ON 19
ci_021                -9.715883e-03 3 1  ON 20
ci_022                -1.096689e-02 3 1  ON 21
ci_023                 8.030687e-03 3 1  ON 22
ci_024                 8.878068e-03 3 1  ON 23
ci_025                 8.130140e-03 3 1  ON 24
ci_026                 9.114150e-03 3 1  ON 25
ci_027                 7.708023e-03 3 1  ON 26
ci_028                 8.455159e-03 3 1  ON 27
ci_029                -7.273939e-03 3 1  ON 28
ci_030                -7.635601e-03 3 1  ON 29
ci_031                -7.886637e-03 3 1  ON 30
ci_032                -7.499357e-03 3 1  ON 31
ci_033                 6.591534e-03 3 1  ON 32
ci_034                 7.154459e-03 3 1  ON 33
ci_035                 6.331923e-03 3 1  ON 34
ci_036                 6.828894e-03 3 1  ON 35
ci_037                 6.738238e-03 3 1  ON 36
ci_038                 6.282996e-03 3 1  ON 37
ci_039                 4.962538e-03 3 1  ON 38
ci_040                 5.618756e-03 3 1  ON 39
ci_041                 5.193763e-03 3 1  ON 40
ci_042                 4.707684e-03 3 1  ON 41
ci_043                 4.993103e-03 3 1  ON 42
ci_044                 5.015947e-03 3 1  ON 43
ci_045                 5.451003e-03 3 1  ON 44
ci_046                 5.291194e-03 3 1  ON 45
ci_047                -4.306769e-03 3 1  ON 46
ci_048                -4.518855e-03 3 1  ON 47
ci_049                 3.400769e-03 3 1  ON 48
ci_050                 3.441210e-03 3 1  ON 49
ci_051                -2.229521e-03 3 1  ON 50
ci_052                -3.291884e-03 3 1  ON 51
ci_053                -2.875551e-03 3 1  ON 52
ci_054                -2.453675e-03 3 1  ON 53
ci_055                -2.269969e-03 3 1  ON 54
ci_056                -1.624970e-03 3 1  ON 55
ci_057                -2.697461e-03 3 1  ON 56
ci_058                -2.006862e-03 3 1  ON 57
ci_059                -1.617028e-03 3 1  ON 58
ci_060                -2.091026e-03 3 1  ON 59
ci_061                -1.428412e-03 3 1  ON 60
ci_062                -1.911751e-03 3 1  ON 61
ci_063                -1.410384e-03 3 1  ON 62
ci_064                -1.564952e-03 3 1  ON 63
ci_065                -9.184697e-04 3 1  ON 64
ci_066                -1.537505e-03 3 1  ON 65
ci_067                -8.876237e-05 3 1  ON 66
ci_068                -1.519394e-03 3 1  ON 67
ci_069                 1.704556e-03 3 1  ON 68
ci_070                 1.019010e-03 3 1  ON 69
ci_071                -1.496412e-03 3 1  ON 70
ci_072                -1.004695e-03 3 1  ON 71
ci_073                 9.348222e-04 3 1  ON 72
ci_074                 9.189916e-04 3 1  ON 73
ci_075                -9.520844e-04 3 1  ON 74
ci_076                -1.323431e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2307e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.3942
    reference variance = 2.89464
====================================================
  Execution time = 2.4392e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0297e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7263e+00
  Total weights = 1.949979427e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0018e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779068880310
                                         uncertainty =       0.036222015027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779068880310
                                         uncertainty =       0.036222015027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374480409
  error estimate for blocks of size 2^( 2) =       0.001444853974
  error estimate for blocks of size 2^( 3) =       0.001508514973
  error estimate for blocks of size 2^( 4) =       0.001548179488
  error estimate for blocks of size 2^( 5) =       0.001574204281
  error estimate for blocks of size 2^( 6) =       0.001582099177
  error estimate for blocks of size 2^( 7) =       0.001589134499

      target function =                  N/A
              le_mean =     -22.328830444609
             les_mean =     502.302966063466
             stat err =       0.001573404361
             autocorr =       1.310399114746
              std dev =       1.943839936632
             le_variance =       3.778513699244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232883044461e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e-01, overlap shift 3.3881e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328830443795       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328866711266       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328866871148       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328866958087       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e-01 is 1.119893e-03

solving harmonic davidson linear method for identity shift 1.3553e+00, overlap shift 1.3553e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328830443795       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328842726093       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328842731730       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+00 is 3.668923e-04

solving harmonic davidson linear method for identity shift 5.4210e+00, overlap shift 5.4210e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328830443795       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328833813082       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328833819410       residual = 2.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+00 is 9.940831e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188350 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0401e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -6.880814e-01 3 1  ON 0
ci_002                -7.127154e-01 3 1  ON 1
ci_003                -6.159304e-02 3 1  ON 2
ci_004                -6.277585e-02 3 1  ON 3
ci_005                 4.446440e-02 3 1  ON 4
ci_006                 4.646296e-02 3 1  ON 5
ci_007                 3.136850e-02 3 1  ON 6
ci_008                 3.270868e-02 3 1  ON 7
ci_009                -2.455003e-02 3 1  ON 8
ci_010                -2.512024e-02 3 1  ON 9
ci_011                -2.251522e-02 3 1  ON 10
ci_012                -2.244136e-02 3 1  ON 11
ci_013                 1.995850e-02 3 1  ON 12
ci_014                 2.053989e-02 3 1  ON 13
ci_015                 1.956843e-02 3 1  ON 14
ci_016                 2.032778e-02 3 1  ON 15
ci_017                 1.430345e-02 3 1  ON 16
ci_018                 1.529013e-02 3 1  ON 17
ci_019                 9.851076e-03 3 1  ON 18
ci_020                 9.619523e-03 3 1  ON 19
ci_021                -9.804925e-03 3 1  ON 20
ci_022                -1.090305e-02 3 1  ON 21
ci_023                 8.201869e-03 3 1  ON 22
ci_024                 8.985247e-03 3 1  ON 23
ci_025                 8.190980e-03 3 1  ON 24
ci_026                 9.081546e-03 3 1  ON 25
ci_027                 7.793562e-03 3 1  ON 26
ci_028                 8.301962e-03 3 1  ON 27
ci_029                -7.394532e-03 3 1  ON 28
ci_030                -7.536606e-03 3 1  ON 29
ci_031                -7.977789e-03 3 1  ON 30
ci_032                -7.453297e-03 3 1  ON 31
ci_033                 6.517241e-03 3 1  ON 32
ci_034                 7.103334e-03 3 1  ON 33
ci_035                 6.276059e-03 3 1  ON 34
ci_036                 6.824967e-03 3 1  ON 35
ci_037                 6.734873e-03 3 1  ON 36
ci_038                 6.401534e-03 3 1  ON 37
ci_039                 5.037063e-03 3 1  ON 38
ci_040                 5.727101e-03 3 1  ON 39
ci_041                 5.291363e-03 3 1  ON 40
ci_042                 4.766553e-03 3 1  ON 41
ci_043                 5.019577e-03 3 1  ON 42
ci_044                 4.934260e-03 3 1  ON 43
ci_045                 5.597949e-03 3 1  ON 44
ci_046                 5.341386e-03 3 1  ON 45
ci_047                -4.150370e-03 3 1  ON 46
ci_048                -4.394416e-03 3 1  ON 47
ci_049                 3.433684e-03 3 1  ON 48
ci_050                 3.305511e-03 3 1  ON 49
ci_051                -2.177886e-03 3 1  ON 50
ci_052                -2.924991e-03 3 1  ON 51
ci_053                -2.807356e-03 3 1  ON 52
ci_054                -2.489064e-03 3 1  ON 53
ci_055                -2.159883e-03 3 1  ON 54
ci_056                -1.700686e-03 3 1  ON 55
ci_057                -2.569305e-03 3 1  ON 56
ci_058                -1.974448e-03 3 1  ON 57
ci_059                -1.628084e-03 3 1  ON 58
ci_060                -2.159616e-03 3 1  ON 59
ci_061                -1.169050e-03 3 1  ON 60
ci_062                -1.758112e-03 3 1  ON 61
ci_063                -1.393100e-03 3 1  ON 62
ci_064                -1.599335e-03 3 1  ON 63
ci_065                -1.064228e-03 3 1  ON 64
ci_066                -1.566648e-03 3 1  ON 65
ci_067                -2.761323e-04 3 1  ON 66
ci_068                -1.451729e-03 3 1  ON 67
ci_069                 1.658827e-03 3 1  ON 68
ci_070                 1.092067e-03 3 1  ON 69
ci_071                -1.481333e-03 3 1  ON 70
ci_072                -1.087786e-03 3 1  ON 71
ci_073                 9.466273e-04 3 1  ON 72
ci_074                 9.290691e-04 3 1  ON 73
ci_075                -1.086456e-03 3 1  ON 74
ci_076                -1.364599e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.0811
    reference variance = 2.9988
====================================================
  Execution time = 2.6174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7650e+00
  Total weights = 1.9499e+06
  Execution time = 4.4818e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.816658859109
                                         uncertainty =       0.041173622664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.816658859109
                                         uncertainty =       0.041173622664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381551695
  error estimate for blocks of size 2^( 2) =       0.001452546577
  error estimate for blocks of size 2^( 3) =       0.001514633525
  error estimate for blocks of size 2^( 4) =       0.001561256740
  error estimate for blocks of size 2^( 5) =       0.001586259489
  error estimate for blocks of size 2^( 6) =       0.001598976342
  error estimate for blocks of size 2^( 7) =       0.001619858610

      target function =                  N/A
              le_mean =     -22.326706752928
             les_mean =     502.247028851806
             stat err =       0.001591587795
             autocorr =       1.327171112248
              std dev =       1.953840405588
             le_variance =       3.817492330509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.816674911120
                                         uncertainty =       0.041178424445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.816674911120
                                         uncertainty =       0.041178424445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381554797
  error estimate for blocks of size 2^( 2) =       0.001452539622
  error estimate for blocks of size 2^( 3) =       0.001514613907
  error estimate for blocks of size 2^( 4) =       0.001561233743
  error estimate for blocks of size 2^( 5) =       0.001586221823
  error estimate for blocks of size 2^( 6) =       0.001598926699
  error estimate for blocks of size 2^( 7) =       0.001619860694

      target function =                  N/A
              le_mean =     -22.326715976749
             les_mean =     502.256650112661
             stat err =       0.001591560740
             autocorr =       1.327120031483
              std dev =       1.953844792494
             le_variance =       3.817509473158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.816643108179
                                         uncertainty =       0.041176770204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.816643108179
                                         uncertainty =       0.041176770204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381548987
  error estimate for blocks of size 2^( 2) =       0.001452536688
  error estimate for blocks of size 2^( 3) =       0.001514618256
  error estimate for blocks of size 2^( 4) =       0.001561238486
  error estimate for blocks of size 2^( 5) =       0.001586234460
  error estimate for blocks of size 2^( 6) =       0.001598946806
  error estimate for blocks of size 2^( 7) =       0.001619855996

      target function =                  N/A
              le_mean =     -22.326708834346
             les_mean =     502.247302756515
             stat err =       0.001591568937
             autocorr =       1.327144865936
              std dev =       1.953836574642
             le_variance =       3.817477360407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.816652777594
                                         uncertainty =       0.041174083305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.816652777594
                                         uncertainty =       0.041174083305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381550615
  error estimate for blocks of size 2^( 2) =       0.001452544815
  error estimate for blocks of size 2^( 3) =       0.001514631082
  error estimate for blocks of size 2^( 4) =       0.001561253995
  error estimate for blocks of size 2^( 5) =       0.001586255834
  error estimate for blocks of size 2^( 6) =       0.001598972005
  error estimate for blocks of size 2^( 7) =       0.001619858491

      target function =                  N/A
              le_mean =     -22.326706063398
             les_mean =     502.246975547810
             stat err =       0.001591585081
             autocorr =       1.327168661381
              std dev =       1.953838877769
             le_variance =       3.817486360283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326706752928        initial
     3.3881e-01     3.3881e+00             1.1199e-03       -22.326715976749  <--
     1.3553e+00     1.3553e+01             3.6689e-04       -22.326708834346
     5.4210e+00     5.4210e+01             9.9408e-05       -22.326706063398

*****************************************************************************
Applying the update for shift_i =   3.3881e-01     and shift_s =   3.3881e+00
*****************************************************************************

  Execution time = 4.8690e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -6.881593e-01 3 1  ON 0
ci_002                -7.126679e-01 3 1  ON 1
ci_003                -6.117226e-02 3 1  ON 2
ci_004                -6.253236e-02 3 1  ON 3
ci_005                 4.440682e-02 3 1  ON 4
ci_006                 4.649448e-02 3 1  ON 5
ci_007                 3.143629e-02 3 1  ON 6
ci_008                 3.253541e-02 3 1  ON 7
ci_009                -2.458763e-02 3 1  ON 8
ci_010                -2.567137e-02 3 1  ON 9
ci_011                -2.253566e-02 3 1  ON 10
ci_012                -2.265014e-02 3 1  ON 11
ci_013                 1.963215e-02 3 1  ON 12
ci_014                 2.019695e-02 3 1  ON 13
ci_015                 2.001027e-02 3 1  ON 14
ci_016                 2.062389e-02 3 1  ON 15
ci_017                 1.456790e-02 3 1  ON 16
ci_018                 1.552781e-02 3 1  ON 17
ci_019                 9.840749e-03 3 1  ON 18
ci_020                 9.312271e-03 3 1  ON 19
ci_021                -9.976387e-03 3 1  ON 20
ci_022                -1.073834e-02 3 1  ON 21
ci_023                 8.525608e-03 3 1  ON 22
ci_024                 9.194245e-03 3 1  ON 23
ci_025                 8.318042e-03 3 1  ON 24
ci_026                 9.020512e-03 3 1  ON 25
ci_027                 7.929795e-03 3 1  ON 26
ci_028                 8.048668e-03 3 1  ON 27
ci_029                -7.623311e-03 3 1  ON 28
ci_030                -7.365438e-03 3 1  ON 29
ci_031                -8.160245e-03 3 1  ON 30
ci_032                -7.357454e-03 3 1  ON 31
ci_033                 6.355376e-03 3 1  ON 32
ci_034                 6.995135e-03 3 1  ON 33
ci_035                 6.177789e-03 3 1  ON 34
ci_036                 6.815870e-03 3 1  ON 35
ci_037                 6.726764e-03 3 1  ON 36
ci_038                 6.627270e-03 3 1  ON 37
ci_039                 5.154026e-03 3 1  ON 38
ci_040                 5.906870e-03 3 1  ON 39
ci_041                 5.457472e-03 3 1  ON 40
ci_042                 4.867323e-03 3 1  ON 41
ci_043                 5.071840e-03 3 1  ON 42
ci_044                 4.775468e-03 3 1  ON 43
ci_045                 5.892059e-03 3 1  ON 44
ci_046                 5.435060e-03 3 1  ON 45
ci_047                -3.903770e-03 3 1  ON 46
ci_048                -4.207078e-03 3 1  ON 47
ci_049                 3.499290e-03 3 1  ON 48
ci_050                 3.034588e-03 3 1  ON 49
ci_051                -2.080319e-03 3 1  ON 50
ci_052                -2.171991e-03 3 1  ON 51
ci_053                -2.664090e-03 3 1  ON 52
ci_054                -2.551694e-03 3 1  ON 53
ci_055                -1.905511e-03 3 1  ON 54
ci_056                -1.883567e-03 3 1  ON 55
ci_057                -2.326513e-03 3 1  ON 56
ci_058                -1.915864e-03 3 1  ON 57
ci_059                -1.638923e-03 3 1  ON 58
ci_060                -2.266295e-03 3 1  ON 59
ci_061                -6.608758e-04 3 1  ON 60
ci_062                -1.482126e-03 3 1  ON 61
ci_063                -1.377020e-03 3 1  ON 62
ci_064                -1.687239e-03 3 1  ON 63
ci_065                -1.330992e-03 3 1  ON 64
ci_066                -1.644279e-03 3 1  ON 65
ci_067                -6.487603e-04 3 1  ON 66
ci_068                -1.299951e-03 3 1  ON 67
ci_069                 1.582803e-03 3 1  ON 68
ci_070                 1.237975e-03 3 1  ON 69
ci_071                -1.452781e-03 3 1  ON 70
ci_072                -1.280885e-03 3 1  ON 71
ci_073                 9.624041e-04 3 1  ON 72
ci_074                 9.412747e-04 3 1  ON 73
ci_075                -1.345099e-03 3 1  ON 74
ci_076                -1.444250e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9097e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2306e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.1735
    reference variance = 2.06475
====================================================
  Execution time = 2.4470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0319e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7146e+00
  Total weights = 1.949947289e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1143e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.765979380250
                                         uncertainty =       0.031187483916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.765979380250
                                         uncertainty =       0.031187483916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372366015
  error estimate for blocks of size 2^( 2) =       0.001443244181
  error estimate for blocks of size 2^( 3) =       0.001506045342
  error estimate for blocks of size 2^( 4) =       0.001549473603
  error estimate for blocks of size 2^( 5) =       0.001569919481
  error estimate for blocks of size 2^( 6) =       0.001579014520
  error estimate for blocks of size 2^( 7) =       0.001583672111

      target function =                  N/A
              le_mean =     -22.329110896523
             les_mean =     502.303822047015
             stat err =       0.001570519929
             autocorr =       1.309625111045
              std dev =       1.940849684242
             le_variance =       3.766897496824


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232911089652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e-02, overlap shift 8.4703e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329110895680       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329161642091       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329164478614       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329164168219       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329164091973       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329164061174       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e-02 is 1.896301e-03

solving harmonic davidson linear method for identity shift 3.3881e-01, overlap shift 3.3881e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329110895680       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329137359555       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329137792258       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329137757940       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e-01 is 7.791099e-04

solving harmonic davidson linear method for identity shift 1.3553e+00, overlap shift 1.3553e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329110895680       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329119977176       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329120015877       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+00 is 2.637277e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0591e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -6.882259e-01 3 1  ON 0
ci_002                -7.125557e-01 3 1  ON 1
ci_003                -6.148696e-02 3 1  ON 2
ci_004                -6.242495e-02 3 1  ON 3
ci_005                 4.495331e-02 3 1  ON 4
ci_006                 4.660847e-02 3 1  ON 5
ci_007                 3.141339e-02 3 1  ON 6
ci_008                 3.260144e-02 3 1  ON 7
ci_009                -2.463826e-02 3 1  ON 8
ci_010                -2.570266e-02 3 1  ON 9
ci_011                -2.218643e-02 3 1  ON 10
ci_012                -2.260867e-02 3 1  ON 11
ci_013                 1.978319e-02 3 1  ON 12
ci_014                 2.047527e-02 3 1  ON 13
ci_015                 2.013487e-02 3 1  ON 14
ci_016                 1.984478e-02 3 1  ON 15
ci_017                 1.499342e-02 3 1  ON 16
ci_018                 1.571109e-02 3 1  ON 17
ci_019                 9.996494e-03 3 1  ON 18
ci_020                 9.707882e-03 3 1  ON 19
ci_021                -9.589791e-03 3 1  ON 20
ci_022                -1.063143e-02 3 1  ON 21
ci_023                 8.410008e-03 3 1  ON 22
ci_024                 9.103277e-03 3 1  ON 23
ci_025                 7.894580e-03 3 1  ON 24
ci_026                 9.189704e-03 3 1  ON 25
ci_027                 7.589174e-03 3 1  ON 26
ci_028                 7.947682e-03 3 1  ON 27
ci_029                -7.691383e-03 3 1  ON 28
ci_030                -7.611875e-03 3 1  ON 29
ci_031                -7.764349e-03 3 1  ON 30
ci_032                -7.488882e-03 3 1  ON 31
ci_033                 6.133911e-03 3 1  ON 32
ci_034                 6.904456e-03 3 1  ON 33
ci_035                 6.153277e-03 3 1  ON 34
ci_036                 7.018180e-03 3 1  ON 35
ci_037                 6.732899e-03 3 1  ON 36
ci_038                 6.692065e-03 3 1  ON 37
ci_039                 5.796817e-03 3 1  ON 38
ci_040                 6.141373e-03 3 1  ON 39
ci_041                 4.910195e-03 3 1  ON 40
ci_042                 5.201667e-03 3 1  ON 41
ci_043                 5.107775e-03 3 1  ON 42
ci_044                 4.617636e-03 3 1  ON 43
ci_045                 5.644817e-03 3 1  ON 44
ci_046                 5.638863e-03 3 1  ON 45
ci_047                -3.868223e-03 3 1  ON 46
ci_048                -4.231008e-03 3 1  ON 47
ci_049                 3.180364e-03 3 1  ON 48
ci_050                 3.098682e-03 3 1  ON 49
ci_051                -2.139234e-03 3 1  ON 50
ci_052                -2.875432e-03 3 1  ON 51
ci_053                -2.746366e-03 3 1  ON 52
ci_054                -2.768608e-03 3 1  ON 53
ci_055                -2.132364e-03 3 1  ON 54
ci_056                -1.865903e-03 3 1  ON 55
ci_057                -2.150208e-03 3 1  ON 56
ci_058                -2.316787e-03 3 1  ON 57
ci_059                -1.585258e-03 3 1  ON 58
ci_060                -1.961611e-03 3 1  ON 59
ci_061                -3.586230e-04 3 1  ON 60
ci_062                -1.625303e-03 3 1  ON 61
ci_063                -1.051926e-03 3 1  ON 62
ci_064                -1.477567e-03 3 1  ON 63
ci_065                -1.108063e-03 3 1  ON 64
ci_066                -1.661611e-03 3 1  ON 65
ci_067                -1.380599e-03 3 1  ON 66
ci_068                -7.961792e-04 3 1  ON 67
ci_069                 1.624750e-03 3 1  ON 68
ci_070                 1.135891e-03 3 1  ON 69
ci_071                -9.913409e-04 3 1  ON 70
ci_072                -1.369735e-03 3 1  ON 71
ci_073                 8.671629e-04 3 1  ON 72
ci_074                 1.266677e-03 3 1  ON 73
ci_075                -5.736968e-04 3 1  ON 74
ci_076                -1.113671e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.2856
    reference variance = 3.02576
====================================================
  Execution time = 2.3807e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7435e+00
  Total weights = 1.9500e+06
  Execution time = 4.4816e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797207203421
                                         uncertainty =       0.045226081681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797207203421
                                         uncertainty =       0.045226081681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377822348
  error estimate for blocks of size 2^( 2) =       0.001447694372
  error estimate for blocks of size 2^( 3) =       0.001512550373
  error estimate for blocks of size 2^( 4) =       0.001556355777
  error estimate for blocks of size 2^( 5) =       0.001582407563
  error estimate for blocks of size 2^( 6) =       0.001599725331
  error estimate for blocks of size 2^( 7) =       0.001613464587

      target function =                  N/A
              le_mean =     -22.326058706510
             les_mean =     502.575543565811
             stat err =       0.001587988314
             autocorr =       1.328336648309
              std dev =       1.948566228097
             le_variance =       3.796910345281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797542652898
                                         uncertainty =       0.045218504558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797542652898
                                         uncertainty =       0.045218504558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377883688
  error estimate for blocks of size 2^( 2) =       0.001447738649
  error estimate for blocks of size 2^( 3) =       0.001512593214
  error estimate for blocks of size 2^( 4) =       0.001556383745
  error estimate for blocks of size 2^( 5) =       0.001582431251
  error estimate for blocks of size 2^( 6) =       0.001599673142
  error estimate for blocks of size 2^( 7) =       0.001613379106

      target function =                  N/A
              le_mean =     -22.326082382153
             les_mean =     502.376186887008
             stat err =       0.001587966811
             autocorr =       1.328182411044
              std dev =       1.948652977309
             le_variance =       3.797248425976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797021235852
                                         uncertainty =       0.045235540564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797021235852
                                         uncertainty =       0.045235540564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377789248
  error estimate for blocks of size 2^( 2) =       0.001447639205
  error estimate for blocks of size 2^( 3) =       0.001512481963
  error estimate for blocks of size 2^( 4) =       0.001556265891
  error estimate for blocks of size 2^( 5) =       0.001582291364
  error estimate for blocks of size 2^( 6) =       0.001599581899
  error estimate for blocks of size 2^( 7) =       0.001613333022

      target function =                  N/A
              le_mean =     -22.326060459783
             les_mean =     502.203343035838
             stat err =       0.001587868044
             autocorr =       1.328199261582
              std dev =       1.948519416585
             le_variance =       3.796727916809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797053978228
                                         uncertainty =       0.045230329897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797053978228
                                         uncertainty =       0.045230329897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377794660
  error estimate for blocks of size 2^( 2) =       0.001447659345
  error estimate for blocks of size 2^( 3) =       0.001512518027
  error estimate for blocks of size 2^( 4) =       0.001556318557
  error estimate for blocks of size 2^( 5) =       0.001582362149
  error estimate for blocks of size 2^( 6) =       0.001599674229
  error estimate for blocks of size 2^( 7) =       0.001613470952

      target function =                  N/A
              le_mean =     -22.326038206861
             les_mean =     502.417540339015
             stat err =       0.001587956472
             autocorr =       1.328336764239
              std dev =       1.948527070080
             le_variance =       3.796757742833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326058706510        initial
     8.4703e-02     8.4703e-01             1.8963e-03       -22.326082382153  <--
     3.3881e-01     3.3881e+00             7.7911e-04       -22.326060459783
     1.3553e+00     1.3553e+01             2.6373e-04       -22.326038206861

*****************************************************************************
Applying the update for shift_i =   8.4703e-02     and shift_s =   8.4703e-01
*****************************************************************************

  Execution time = 4.6347e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -6.884724e-01 3 1  ON 0
ci_002                -7.122685e-01 3 1  ON 1
ci_003                -6.212091e-02 3 1  ON 2
ci_004                -6.219251e-02 3 1  ON 3
ci_005                 4.538977e-02 3 1  ON 4
ci_006                 4.667446e-02 3 1  ON 5
ci_007                 3.136089e-02 3 1  ON 6
ci_008                 3.273777e-02 3 1  ON 7
ci_009                -2.466383e-02 3 1  ON 8
ci_010                -2.575095e-02 3 1  ON 9
ci_011                -2.175501e-02 3 1  ON 10
ci_012                -2.249890e-02 3 1  ON 11
ci_013                 1.997667e-02 3 1  ON 12
ci_014                 2.080594e-02 3 1  ON 13
ci_015                 2.029347e-02 3 1  ON 14
ci_016                 1.872759e-02 3 1  ON 15
ci_017                 1.561300e-02 3 1  ON 16
ci_018                 1.588722e-02 3 1  ON 17
ci_019                 1.021214e-02 3 1  ON 18
ci_020                 1.017743e-02 3 1  ON 19
ci_021                -9.201611e-03 3 1  ON 20
ci_022                -1.055398e-02 3 1  ON 21
ci_023                 8.312925e-03 3 1  ON 22
ci_024                 9.011690e-03 3 1  ON 23
ci_025                 7.408656e-03 3 1  ON 24
ci_026                 9.340234e-03 3 1  ON 25
ci_027                 7.375866e-03 3 1  ON 26
ci_028                 7.869161e-03 3 1  ON 27
ci_029                -7.799141e-03 3 1  ON 28
ci_030                -7.864117e-03 3 1  ON 29
ci_031                -7.298241e-03 3 1  ON 30
ci_032                -7.636283e-03 3 1  ON 31
ci_033                 5.907902e-03 3 1  ON 32
ci_034                 6.800388e-03 3 1  ON 33
ci_035                 6.170641e-03 3 1  ON 34
ci_036                 7.156301e-03 3 1  ON 35
ci_037                 6.743970e-03 3 1  ON 36
ci_038                 6.787289e-03 3 1  ON 37
ci_039                 6.254130e-03 3 1  ON 38
ci_040                 6.290452e-03 3 1  ON 39
ci_041                 4.472299e-03 3 1  ON 40
ci_042                 5.465682e-03 3 1  ON 41
ci_043                 5.042931e-03 3 1  ON 42
ci_044                 4.446633e-03 3 1  ON 43
ci_045                 5.389569e-03 3 1  ON 44
ci_046                 5.847332e-03 3 1  ON 45
ci_047                -3.828780e-03 3 1  ON 46
ci_048                -4.240776e-03 3 1  ON 47
ci_049                 2.830543e-03 3 1  ON 48
ci_050                 3.152589e-03 3 1  ON 49
ci_051                -2.185176e-03 3 1  ON 50
ci_052                -3.609541e-03 3 1  ON 51
ci_053                -2.849426e-03 3 1  ON 52
ci_054                -2.983097e-03 3 1  ON 53
ci_055                -2.335994e-03 3 1  ON 54
ci_056                -1.924116e-03 3 1  ON 55
ci_057                -1.968921e-03 3 1  ON 56
ci_058                -2.697827e-03 3 1  ON 57
ci_059                -1.534770e-03 3 1  ON 58
ci_060                -1.775370e-03 3 1  ON 59
ci_061                -8.237154e-05 3 1  ON 60
ci_062                -1.760852e-03 3 1  ON 61
ci_063                -6.925046e-04 3 1  ON 62
ci_064                -1.239614e-03 3 1  ON 63
ci_065                -9.048995e-04 3 1  ON 64
ci_066                -1.682367e-03 3 1  ON 65
ci_067                -2.099295e-03 3 1  ON 66
ci_068                -2.355216e-04 3 1  ON 67
ci_069                 1.663684e-03 3 1  ON 68
ci_070                 1.036445e-03 3 1  ON 69
ci_071                -5.480387e-04 3 1  ON 70
ci_072                -1.394148e-03 3 1  ON 71
ci_073                 8.048395e-04 3 1  ON 72
ci_074                 1.479876e-03 3 1  ON 73
ci_075                 1.532764e-04 3 1  ON 74
ci_076                -7.852273e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6945e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2305e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.57
    reference variance = 2.58199
====================================================
  Execution time = 2.4523e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0299e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7783e+00
  Total weights = 1.949815343e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0128e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.832300715408
                                         uncertainty =       0.065545010696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.832300715408
                                         uncertainty =       0.065545010696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001384076002
  error estimate for blocks of size 2^( 2) =       0.001453921734
  error estimate for blocks of size 2^( 3) =       0.001517705618
  error estimate for blocks of size 2^( 4) =       0.001560842267
  error estimate for blocks of size 2^( 5) =       0.001584826933
  error estimate for blocks of size 2^( 6) =       0.001599378649
  error estimate for blocks of size 2^( 7) =       0.001598972365

      target function =                  N/A
              le_mean =     -22.327459256326
             les_mean =     502.293767366786
             stat err =       0.001586005054
             autocorr =       1.313074164553
              std dev =       1.957410371017
             le_variance =       3.831455360566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232745925633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e-02, overlap shift 2.1176e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327459255500       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327522578974       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327526960958       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327531598622       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327531761414       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327531104986       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327530957517       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e-02 is 4.590158e-03

solving harmonic davidson linear method for identity shift 8.4703e-02, overlap shift 8.4703e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327459255500       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327507300935       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327509021067       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327510576830       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327510539602       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327510401022       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e-02 is 2.399129e-03

solving harmonic davidson linear method for identity shift 3.3881e-01, overlap shift 3.3881e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327459255500       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327483704958       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327483941176       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327484075676       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e-01 is 8.156675e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0544e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -6.883131e-01 3 1  ON 0
ci_002                -7.122775e-01 3 1  ON 1
ci_003                -6.218130e-02 3 1  ON 2
ci_004                -6.459164e-02 3 1  ON 3
ci_005                 4.521152e-02 3 1  ON 4
ci_006                 4.717247e-02 3 1  ON 5
ci_007                 3.207389e-02 3 1  ON 6
ci_008                 3.237451e-02 3 1  ON 7
ci_009                -2.538963e-02 3 1  ON 8
ci_010                -2.543484e-02 3 1  ON 9
ci_011                -2.142040e-02 3 1  ON 10
ci_012                -2.223235e-02 3 1  ON 11
ci_013                 1.874871e-02 3 1  ON 12
ci_014                 1.974748e-02 3 1  ON 13
ci_015                 1.917215e-02 3 1  ON 14
ci_016                 1.917287e-02 3 1  ON 15
ci_017                 1.542125e-02 3 1  ON 16
ci_018                 1.635775e-02 3 1  ON 17
ci_019                 8.718327e-03 3 1  ON 18
ci_020                 1.032962e-02 3 1  ON 19
ci_021                -9.845536e-03 3 1  ON 20
ci_022                -9.807652e-03 3 1  ON 21
ci_023                 7.684866e-03 3 1  ON 22
ci_024                 8.787900e-03 3 1  ON 23
ci_025                 8.583173e-03 3 1  ON 24
ci_026                 8.127708e-03 3 1  ON 25
ci_027                 7.591092e-03 3 1  ON 26
ci_028                 8.156628e-03 3 1  ON 27
ci_029                -8.111030e-03 3 1  ON 28
ci_030                -7.518623e-03 3 1  ON 29
ci_031                -7.235106e-03 3 1  ON 30
ci_032                -8.786733e-03 3 1  ON 31
ci_033                 5.999002e-03 3 1  ON 32
ci_034                 6.294637e-03 3 1  ON 33
ci_035                 5.380998e-03 3 1  ON 34
ci_036                 7.391339e-03 3 1  ON 35
ci_037                 7.536176e-03 3 1  ON 36
ci_038                 6.178427e-03 3 1  ON 37
ci_039                 6.355101e-03 3 1  ON 38
ci_040                 6.094920e-03 3 1  ON 39
ci_041                 4.836844e-03 3 1  ON 40
ci_042                 5.308287e-03 3 1  ON 41
ci_043                 4.413433e-03 3 1  ON 42
ci_044                 4.789693e-03 3 1  ON 43
ci_045                 6.522350e-03 3 1  ON 44
ci_046                 6.057126e-03 3 1  ON 45
ci_047                -3.717298e-03 3 1  ON 46
ci_048                -3.976311e-03 3 1  ON 47
ci_049                 3.406187e-03 3 1  ON 48
ci_050                 3.931198e-03 3 1  ON 49
ci_051                -3.499453e-03 3 1  ON 50
ci_052                -3.296359e-03 3 1  ON 51
ci_053                -3.290249e-03 3 1  ON 52
ci_054                -3.350016e-03 3 1  ON 53
ci_055                -1.468357e-03 3 1  ON 54
ci_056                -7.087709e-04 3 1  ON 55
ci_057                -2.323070e-03 3 1  ON 56
ci_058                -2.560246e-03 3 1  ON 57
ci_059                -8.701546e-04 3 1  ON 58
ci_060                -1.666842e-03 3 1  ON 59
ci_061                -4.710996e-04 3 1  ON 60
ci_062                -1.448913e-03 3 1  ON 61
ci_063                -1.405514e-03 3 1  ON 62
ci_064                -1.958504e-04 3 1  ON 63
ci_065                -1.443516e-03 3 1  ON 64
ci_066                -7.361611e-04 3 1  ON 65
ci_067                -1.617606e-03 3 1  ON 66
ci_068                -5.717547e-04 3 1  ON 67
ci_069                 1.691998e-03 3 1  ON 68
ci_070                 2.410062e-03 3 1  ON 69
ci_071                -9.793554e-04 3 1  ON 70
ci_072                -4.513897e-04 3 1  ON 71
ci_073                 7.095420e-04 3 1  ON 72
ci_074                 8.321806e-04 3 1  ON 73
ci_075                -8.266572e-04 3 1  ON 74
ci_076                -8.398944e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -21.9418
    reference variance = 5.39362
====================================================
  Execution time = 2.3908e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7990e+00
  Total weights = 1.9496e+06
  Execution time = 4.4906e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850740014871
                                         uncertainty =       0.069518122951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850740014871
                                         uncertainty =       0.069518122951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387654852
  error estimate for blocks of size 2^( 2) =       0.001456475192
  error estimate for blocks of size 2^( 3) =       0.001517606916
  error estimate for blocks of size 2^( 4) =       0.001559564017
  error estimate for blocks of size 2^( 5) =       0.001583551621
  error estimate for blocks of size 2^( 6) =       0.001592691715
  error estimate for blocks of size 2^( 7) =       0.001603457200

      target function =                  N/A
              le_mean =     -22.329644473667
             les_mean =     502.481311107333
             stat err =       0.001584816138
             autocorr =       1.304352132298
              std dev =       1.962471710989
             le_variance =       3.851295216434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850452482553
                                         uncertainty =       0.069519284101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850452482553
                                         uncertainty =       0.069519284101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387603088
  error estimate for blocks of size 2^( 2) =       0.001456407598
  error estimate for blocks of size 2^( 3) =       0.001517535087
  error estimate for blocks of size 2^( 4) =       0.001559530238
  error estimate for blocks of size 2^( 5) =       0.001583497659
  error estimate for blocks of size 2^( 6) =       0.001592580757
  error estimate for blocks of size 2^( 7) =       0.001603284546

      target function =                  N/A
              le_mean =     -22.329589677668
             les_mean =     502.414027579181
             stat err =       0.001584723300
             autocorr =       1.304296628353
              std dev =       1.962398503473
             le_variance =       3.851007886434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850981954820
                                         uncertainty =       0.069545152148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850981954820
                                         uncertainty =       0.069545152148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387698382
  error estimate for blocks of size 2^( 2) =       0.001456494782
  error estimate for blocks of size 2^( 3) =       0.001517620879
  error estimate for blocks of size 2^( 4) =       0.001559627179
  error estimate for blocks of size 2^( 5) =       0.001583612193
  error estimate for blocks of size 2^( 6) =       0.001592669740
  error estimate for blocks of size 2^( 7) =       0.001603345176

      target function =                  N/A
              le_mean =     -22.329629822109
             les_mean =     502.446215625975
             stat err =       0.001584813572
             autocorr =       1.304266079977
              std dev =       1.962533271882
             le_variance =       3.851536843242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850448020091
                                         uncertainty =       0.069518525171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.850448020091
                                         uncertainty =       0.069518525171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001387602289
  error estimate for blocks of size 2^( 2) =       0.001456416280
  error estimate for blocks of size 2^( 3) =       0.001517552519
  error estimate for blocks of size 2^( 4) =       0.001559530859
  error estimate for blocks of size 2^( 5) =       0.001583517771
  error estimate for blocks of size 2^( 6) =       0.001592620624
  error estimate for blocks of size 2^( 7) =       0.001603342801

      target function =                  N/A
              le_mean =     -22.329591977914
             les_mean =     502.427478290303
             stat err =       0.001584753014
             autocorr =       1.304347041169
              std dev =       1.962397374099
             le_variance =       3.851003453871


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329644473667        initial  <--
     2.1176e-02     2.1176e-01             4.5902e-03       -22.329589677668
     8.4703e-02     8.4703e-01             2.3991e-03       -22.329629822109
     3.3881e-01     3.3881e+00             8.1567e-04       -22.329591977914

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.4684
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -6.884724e-01 3 1  ON 0
ci_002                -7.122685e-01 3 1  ON 1
ci_003                -6.212091e-02 3 1  ON 2
ci_004                -6.219251e-02 3 1  ON 3
ci_005                 4.538977e-02 3 1  ON 4
ci_006                 4.667446e-02 3 1  ON 5
ci_007                 3.136089e-02 3 1  ON 6
ci_008                 3.273777e-02 3 1  ON 7
ci_009                -2.466383e-02 3 1  ON 8
ci_010                -2.575095e-02 3 1  ON 9
ci_011                -2.175501e-02 3 1  ON 10
ci_012                -2.249890e-02 3 1  ON 11
ci_013                 1.997667e-02 3 1  ON 12
ci_014                 2.080594e-02 3 1  ON 13
ci_015                 2.029347e-02 3 1  ON 14
ci_016                 1.872759e-02 3 1  ON 15
ci_017                 1.561300e-02 3 1  ON 16
ci_018                 1.588722e-02 3 1  ON 17
ci_019                 1.021214e-02 3 1  ON 18
ci_020                 1.017743e-02 3 1  ON 19
ci_021                -9.201611e-03 3 1  ON 20
ci_022                -1.055398e-02 3 1  ON 21
ci_023                 8.312925e-03 3 1  ON 22
ci_024                 9.011690e-03 3 1  ON 23
ci_025                 7.408656e-03 3 1  ON 24
ci_026                 9.340234e-03 3 1  ON 25
ci_027                 7.375866e-03 3 1  ON 26
ci_028                 7.869161e-03 3 1  ON 27
ci_029                -7.799141e-03 3 1  ON 28
ci_030                -7.864117e-03 3 1  ON 29
ci_031                -7.298241e-03 3 1  ON 30
ci_032                -7.636283e-03 3 1  ON 31
ci_033                 5.907902e-03 3 1  ON 32
ci_034                 6.800388e-03 3 1  ON 33
ci_035                 6.170641e-03 3 1  ON 34
ci_036                 7.156301e-03 3 1  ON 35
ci_037                 6.743970e-03 3 1  ON 36
ci_038                 6.787289e-03 3 1  ON 37
ci_039                 6.254130e-03 3 1  ON 38
ci_040                 6.290452e-03 3 1  ON 39
ci_041                 4.472299e-03 3 1  ON 40
ci_042                 5.465682e-03 3 1  ON 41
ci_043                 5.042931e-03 3 1  ON 42
ci_044                 4.446633e-03 3 1  ON 43
ci_045                 5.389569e-03 3 1  ON 44
ci_046                 5.847332e-03 3 1  ON 45
ci_047                -3.828780e-03 3 1  ON 46
ci_048                -4.240776e-03 3 1  ON 47
ci_049                 2.830543e-03 3 1  ON 48
ci_050                 3.152589e-03 3 1  ON 49
ci_051                -2.185176e-03 3 1  ON 50
ci_052                -3.609541e-03 3 1  ON 51
ci_053                -2.849426e-03 3 1  ON 52
ci_054                -2.983097e-03 3 1  ON 53
ci_055                -2.335994e-03 3 1  ON 54
ci_056                -1.924116e-03 3 1  ON 55
ci_057                -1.968921e-03 3 1  ON 56
ci_058                -2.697827e-03 3 1  ON 57
ci_059                -1.534770e-03 3 1  ON 58
ci_060                -1.775370e-03 3 1  ON 59
ci_061                -8.237154e-05 3 1  ON 60
ci_062                -1.760852e-03 3 1  ON 61
ci_063                -6.925046e-04 3 1  ON 62
ci_064                -1.239614e-03 3 1  ON 63
ci_065                -9.048995e-04 3 1  ON 64
ci_066                -1.682367e-03 3 1  ON 65
ci_067                -2.099295e-03 3 1  ON 66
ci_068                -2.355216e-04 3 1  ON 67
ci_069                 1.663684e-03 3 1  ON 68
ci_070                 1.036445e-03 3 1  ON 69
ci_071                -5.480387e-04 3 1  ON 70
ci_072                -1.394148e-03 3 1  ON 71
ci_073                 8.048395e-04 3 1  ON 72
ci_074                 1.479876e-03 3 1  ON 73
ci_075                 1.532764e-04 3 1  ON 74
ci_076                -7.852273e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7019e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2304e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.4335
    reference variance = 2.21296
====================================================
  Execution time = 2.4534e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0293e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.8802e+00
  Total weights = 1.949799065e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9925e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.936855692309
                                         uncertainty =       0.130270630262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.936855692309
                                         uncertainty =       0.130270630262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001402834352
  error estimate for blocks of size 2^( 2) =       0.001473413693
  error estimate for blocks of size 2^( 3) =       0.001537235874
  error estimate for blocks of size 2^( 4) =       0.001578003999
  error estimate for blocks of size 2^( 5) =       0.001600083017
  error estimate for blocks of size 2^( 6) =       0.001605190929
  error estimate for blocks of size 2^( 7) =       0.001615120733

      target function =                  N/A
              le_mean =     -22.325712567651
             les_mean =     502.317641212813
             stat err =       0.001599599670
             autocorr =       1.300198998093
              std dev =       1.983939108967
             le_variance =       3.936014388090


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232571256765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e-01, overlap shift 2.1176e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325712566811       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325770762613       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325770785799       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325771400811       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325771434519       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e-01 is 1.194340e-03

solving harmonic davidson linear method for identity shift 8.4703e-01, overlap shift 8.4703e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325712566811       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325735030722       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325734819221       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325734837911       residual = 1.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e-01 is 4.100330e-04

solving harmonic davidson linear method for identity shift 3.3881e+00, overlap shift 3.3881e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325712566811       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325719066807       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325719050495       residual = 1.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+00 is 1.131853e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193728 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0533e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -6.881986e-01 3 1  ON 0
ci_002                -7.125757e-01 3 1  ON 1
ci_003                -6.198623e-02 3 1  ON 2
ci_004                -6.224557e-02 3 1  ON 3
ci_005                 4.519262e-02 3 1  ON 4
ci_006                 4.650617e-02 3 1  ON 5
ci_007                 3.132691e-02 3 1  ON 6
ci_008                 3.248220e-02 3 1  ON 7
ci_009                -2.472831e-02 3 1  ON 8
ci_010                -2.568168e-02 3 1  ON 9
ci_011                -2.165980e-02 3 1  ON 10
ci_012                -2.252595e-02 3 1  ON 11
ci_013                 2.007403e-02 3 1  ON 12
ci_014                 2.065418e-02 3 1  ON 13
ci_015                 2.039822e-02 3 1  ON 14
ci_016                 1.895426e-02 3 1  ON 15
ci_017                 1.549054e-02 3 1  ON 16
ci_018                 1.573545e-02 3 1  ON 17
ci_019                 1.016079e-02 3 1  ON 18
ci_020                 1.028563e-02 3 1  ON 19
ci_021                -9.009773e-03 3 1  ON 20
ci_022                -1.035452e-02 3 1  ON 21
ci_023                 8.356652e-03 3 1  ON 22
ci_024                 9.086102e-03 3 1  ON 23
ci_025                 7.698099e-03 3 1  ON 24
ci_026                 9.372991e-03 3 1  ON 25
ci_027                 7.671945e-03 3 1  ON 26
ci_028                 8.068849e-03 3 1  ON 27
ci_029                -7.836064e-03 3 1  ON 28
ci_030                -7.860524e-03 3 1  ON 29
ci_031                -7.339135e-03 3 1  ON 30
ci_032                -8.046316e-03 3 1  ON 31
ci_033                 5.875930e-03 3 1  ON 32
ci_034                 6.729011e-03 3 1  ON 33
ci_035                 6.316075e-03 3 1  ON 34
ci_036                 7.071767e-03 3 1  ON 35
ci_037                 6.734952e-03 3 1  ON 36
ci_038                 6.650859e-03 3 1  ON 37
ci_039                 5.996116e-03 3 1  ON 38
ci_040                 6.141863e-03 3 1  ON 39
ci_041                 4.616391e-03 3 1  ON 40
ci_042                 5.506679e-03 3 1  ON 41
ci_043                 4.792326e-03 3 1  ON 42
ci_044                 4.621050e-03 3 1  ON 43
ci_045                 5.641193e-03 3 1  ON 44
ci_046                 5.612643e-03 3 1  ON 45
ci_047                -3.616503e-03 3 1  ON 46
ci_048                -4.224418e-03 3 1  ON 47
ci_049                 2.719869e-03 3 1  ON 48
ci_050                 3.276372e-03 3 1  ON 49
ci_051                -2.130093e-03 3 1  ON 50
ci_052                -3.585140e-03 3 1  ON 51
ci_053                -2.649658e-03 3 1  ON 52
ci_054                -2.865664e-03 3 1  ON 53
ci_055                -2.515838e-03 3 1  ON 54
ci_056                -1.797353e-03 3 1  ON 55
ci_057                -1.785697e-03 3 1  ON 56
ci_058                -2.656281e-03 3 1  ON 57
ci_059                -1.878725e-03 3 1  ON 58
ci_060                -1.980573e-03 3 1  ON 59
ci_061                -9.241272e-05 3 1  ON 60
ci_062                -1.634775e-03 3 1  ON 61
ci_063                -8.245538e-04 3 1  ON 62
ci_064                -1.255983e-03 3 1  ON 63
ci_065                -1.103370e-03 3 1  ON 64
ci_066                -1.662050e-03 3 1  ON 65
ci_067                -1.853525e-03 3 1  ON 66
ci_068                -4.202640e-04 3 1  ON 67
ci_069                 1.679214e-03 3 1  ON 68
ci_070                 8.043632e-04 3 1  ON 69
ci_071                -7.836177e-04 3 1  ON 70
ci_072                -1.259964e-03 3 1  ON 71
ci_073                 7.848321e-04 3 1  ON 72
ci_074                 1.309166e-03 3 1  ON 73
ci_075                 1.158674e-04 3 1  ON 74
ci_076                -8.296561e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.1362
    reference variance = 4.59977
====================================================
  Execution time = 2.3931e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2331e+01
  VMC Evar = 3.6467e+00
  Total weights = 1.9503e+06
  Execution time = 4.4702e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.697905323052
                                         uncertainty =       0.024261554228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.697905323052
                                         uncertainty =       0.024261554228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359637031
  error estimate for blocks of size 2^( 2) =       0.001431148706
  error estimate for blocks of size 2^( 3) =       0.001493576169
  error estimate for blocks of size 2^( 4) =       0.001537200252
  error estimate for blocks of size 2^( 5) =       0.001557929117
  error estimate for blocks of size 2^( 6) =       0.001572977708
  error estimate for blocks of size 2^( 7) =       0.001591421333

      target function =                  N/A
              le_mean =     -22.330739345454
             les_mean =     502.406693749520
             stat err =       0.001564882103
             autocorr =       1.324699213243
              std dev =       1.922847893584
             le_variance =       3.697344021860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.697833904112
                                         uncertainty =       0.024257067213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.697833904112
                                         uncertainty =       0.024257067213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359623897
  error estimate for blocks of size 2^( 2) =       0.001431146962
  error estimate for blocks of size 2^( 3) =       0.001493597528
  error estimate for blocks of size 2^( 4) =       0.001537230298
  error estimate for blocks of size 2^( 5) =       0.001557982265
  error estimate for blocks of size 2^( 6) =       0.001573040810
  error estimate for blocks of size 2^( 7) =       0.001591492045

      target function =                  N/A
              le_mean =     -22.330753276297
             les_mean =     502.310668874081
             stat err =       0.001564936354
             autocorr =       1.324816659780
              std dev =       1.922829319187
             le_variance =       3.697272590726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.697804290663
                                         uncertainty =       0.024257701213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.697804290663
                                         uncertainty =       0.024257701213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359618470
  error estimate for blocks of size 2^( 2) =       0.001431140131
  error estimate for blocks of size 2^( 3) =       0.001493588160
  error estimate for blocks of size 2^( 4) =       0.001537221697
  error estimate for blocks of size 2^( 5) =       0.001557973173
  error estimate for blocks of size 2^( 6) =       0.001573025652
  error estimate for blocks of size 2^( 7) =       0.001591463598

      target function =                  N/A
              le_mean =     -22.330748953972
             les_mean =     502.328999236074
             stat err =       0.001564921030
             autocorr =       1.324801290254
              std dev =       1.922821643704
             le_variance =       3.697243073495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.697828710493
                                         uncertainty =       0.024261298099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.697828710493
                                         uncertainty =       0.024261298099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359622992
  error estimate for blocks of size 2^( 2) =       0.001431134919
  error estimate for blocks of size 2^( 3) =       0.001493567796
  error estimate for blocks of size 2^( 4) =       0.001537204200
  error estimate for blocks of size 2^( 5) =       0.001557950478
  error estimate for blocks of size 2^( 6) =       0.001573002130
  error estimate for blocks of size 2^( 7) =       0.001591446862

      target function =                  N/A
              le_mean =     -22.330744556385
             les_mean =     502.310036977852
             stat err =       0.001564900918
             autocorr =       1.324758425755
              std dev =       1.922828038847
             le_variance =       3.697267666977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.330739345454        initial
     2.1176e-01     2.1176e+00             1.1943e-03       -22.330753276297  <--
     8.4703e-01     8.4703e+00             4.1003e-04       -22.330748953972
     3.3881e+00     3.3881e+01             1.1319e-04       -22.330744556385

*****************************************************************************
Applying the update for shift_i =   2.1176e-01     and shift_s =   2.1176e+00
*****************************************************************************

  Execution time = 4.6413e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -6.873567e-01 3 1  ON 0
ci_002                -7.134557e-01 3 1  ON 1
ci_003                -6.164804e-02 3 1  ON 2
ci_004                -6.239742e-02 3 1  ON 3
ci_005                 4.488515e-02 3 1  ON 4
ci_006                 4.631467e-02 3 1  ON 5
ci_007                 3.124847e-02 3 1  ON 6
ci_008                 3.207773e-02 3 1  ON 7
ci_009                -2.484544e-02 3 1  ON 8
ci_010                -2.559225e-02 3 1  ON 9
ci_011                -2.150064e-02 3 1  ON 10
ci_012                -2.262178e-02 3 1  ON 11
ci_013                 2.025350e-02 3 1  ON 12
ci_014                 2.039723e-02 3 1  ON 13
ci_015                 2.063761e-02 3 1  ON 14
ci_016                 1.942105e-02 3 1  ON 15
ci_017                 1.520670e-02 3 1  ON 16
ci_018                 1.544401e-02 3 1  ON 17
ci_019                 1.001076e-02 3 1  ON 18
ci_020                 1.046753e-02 3 1  ON 19
ci_021                -8.598628e-03 3 1  ON 20
ci_022                -9.930371e-03 3 1  ON 21
ci_023                 8.421748e-03 3 1  ON 22
ci_024                 9.200823e-03 3 1  ON 23
ci_025                 8.219217e-03 3 1  ON 24
ci_026                 9.433431e-03 3 1  ON 25
ci_027                 8.044792e-03 3 1  ON 26
ci_028                 8.345209e-03 3 1  ON 27
ci_029                -7.884736e-03 3 1  ON 28
ci_030                -7.827446e-03 3 1  ON 29
ci_031                -7.473638e-03 3 1  ON 30
ci_032                -8.830624e-03 3 1  ON 31
ci_033                 5.792535e-03 3 1  ON 32
ci_034                 6.641643e-03 3 1  ON 33
ci_035                 6.480714e-03 3 1  ON 34
ci_036                 6.957115e-03 3 1  ON 35
ci_037                 6.739007e-03 3 1  ON 36
ci_038                 6.427219e-03 3 1  ON 37
ci_039                 5.657618e-03 3 1  ON 38
ci_040                 5.946642e-03 3 1  ON 39
ci_041                 4.815986e-03 3 1  ON 40
ci_042                 5.575994e-03 3 1  ON 41
ci_043                 4.400821e-03 3 1  ON 42
ci_044                 4.879607e-03 3 1  ON 43
ci_045                 6.059930e-03 3 1  ON 44
ci_046                 5.217986e-03 3 1  ON 45
ci_047                -3.345044e-03 3 1  ON 46
ci_048                -4.186603e-03 3 1  ON 47
ci_049                 2.540175e-03 3 1  ON 48
ci_050                 3.479621e-03 3 1  ON 49
ci_051                -2.021234e-03 3 1  ON 50
ci_052                -3.532299e-03 3 1  ON 51
ci_053                -2.324401e-03 3 1  ON 52
ci_054                -2.634238e-03 3 1  ON 53
ci_055                -2.881804e-03 3 1  ON 54
ci_056                -1.541541e-03 3 1  ON 55
ci_057                -1.512212e-03 3 1  ON 56
ci_058                -2.597142e-03 3 1  ON 57
ci_059                -2.328557e-03 3 1  ON 58
ci_060                -2.243365e-03 3 1  ON 59
ci_061                -1.267011e-04 3 1  ON 60
ci_062                -1.382151e-03 3 1  ON 61
ci_063                -1.048299e-03 3 1  ON 62
ci_064                -1.304737e-03 3 1  ON 63
ci_065                -1.412397e-03 3 1  ON 64
ci_066                -1.622881e-03 3 1  ON 65
ci_067                -1.441290e-03 3 1  ON 66
ci_068                -7.541017e-04 3 1  ON 67
ci_069                 1.692695e-03 3 1  ON 68
ci_070                 4.282724e-04 3 1  ON 69
ci_071                -1.159204e-03 3 1  ON 70
ci_072                -1.024675e-03 3 1  ON 71
ci_073                 7.697824e-04 3 1  ON 72
ci_074                 1.124278e-03 3 1  ON 73
ci_075                 8.883003e-05 3 1  ON 74
ci_076                -9.254252e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6954e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2304e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.5402
    reference variance = 2.55871
====================================================
  Execution time = 2.6582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0309e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7157e+00
  Total weights = 1.949981589e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0023e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766636700753
                                         uncertainty =       0.027120335385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766636700753
                                         uncertainty =       0.027120335385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372500836
  error estimate for blocks of size 2^( 2) =       0.001443531227
  error estimate for blocks of size 2^( 3) =       0.001506074208
  error estimate for blocks of size 2^( 4) =       0.001548099875
  error estimate for blocks of size 2^( 5) =       0.001578482597
  error estimate for blocks of size 2^( 6) =       0.001586698106
  error estimate for blocks of size 2^( 7) =       0.001593682780

      target function =                  N/A
              le_mean =     -22.327202657722
             les_mean =     502.219637908812
             stat err =       0.001576740839
             autocorr =       1.319761325979
              std dev =       1.941040352490
             le_variance =       3.767637649996


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232720265772e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e-02, overlap shift 5.2940e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327202656879       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327273584518       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327280907324       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327284019712       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327283554579       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327283542077       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327283538837       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327283622148       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e-02 is 2.301512e-03

solving harmonic davidson linear method for identity shift 2.1176e-01, overlap shift 2.1176e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327202656879       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327245889007       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327247697081       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327248185849       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327248101251       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e-01 is 1.239392e-03

solving harmonic davidson linear method for identity shift 8.4703e-01, overlap shift 8.4703e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327202656879       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327219531766       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327219694767       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327219723365       residual = 8.25e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e-01 is 4.373313e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195938 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2592e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -6.870519e-01 3 1  ON 0
ci_002                -7.136082e-01 3 1  ON 1
ci_003                -6.093434e-02 3 1  ON 2
ci_004                -6.317537e-02 3 1  ON 3
ci_005                 4.508719e-02 3 1  ON 4
ci_006                 4.640037e-02 3 1  ON 5
ci_007                 3.152159e-02 3 1  ON 6
ci_008                 3.290056e-02 3 1  ON 7
ci_009                -2.484060e-02 3 1  ON 8
ci_010                -2.600484e-02 3 1  ON 9
ci_011                -2.192386e-02 3 1  ON 10
ci_012                -2.201209e-02 3 1  ON 11
ci_013                 2.003730e-02 3 1  ON 12
ci_014                 2.070599e-02 3 1  ON 13
ci_015                 2.149269e-02 3 1  ON 14
ci_016                 1.958748e-02 3 1  ON 15
ci_017                 1.644609e-02 3 1  ON 16
ci_018                 1.589129e-02 3 1  ON 17
ci_019                 1.092105e-02 3 1  ON 18
ci_020                 1.057214e-02 3 1  ON 19
ci_021                -8.884341e-03 3 1  ON 20
ci_022                -9.849384e-03 3 1  ON 21
ci_023                 8.625042e-03 3 1  ON 22
ci_024                 9.369809e-03 3 1  ON 23
ci_025                 8.084115e-03 3 1  ON 24
ci_026                 8.531952e-03 3 1  ON 25
ci_027                 7.489585e-03 3 1  ON 26
ci_028                 7.569506e-03 3 1  ON 27
ci_029                -8.111623e-03 3 1  ON 28
ci_030                -7.753061e-03 3 1  ON 29
ci_031                -7.335087e-03 3 1  ON 30
ci_032                -8.349531e-03 3 1  ON 31
ci_033                 6.161110e-03 3 1  ON 32
ci_034                 7.054668e-03 3 1  ON 33
ci_035                 6.516567e-03 3 1  ON 34
ci_036                 6.765264e-03 3 1  ON 35
ci_037                 6.672958e-03 3 1  ON 36
ci_038                 5.915775e-03 3 1  ON 37
ci_039                 6.206863e-03 3 1  ON 38
ci_040                 5.319541e-03 3 1  ON 39
ci_041                 5.016009e-03 3 1  ON 40
ci_042                 5.527248e-03 3 1  ON 41
ci_043                 4.261244e-03 3 1  ON 42
ci_044                 5.141990e-03 3 1  ON 43
ci_045                 6.069038e-03 3 1  ON 44
ci_046                 4.891811e-03 3 1  ON 45
ci_047                -3.860403e-03 3 1  ON 46
ci_048                -4.092104e-03 3 1  ON 47
ci_049                 2.894964e-03 3 1  ON 48
ci_050                 2.974518e-03 3 1  ON 49
ci_051                -2.658719e-03 3 1  ON 50
ci_052                -3.496599e-03 3 1  ON 51
ci_053                -2.559432e-03 3 1  ON 52
ci_054                -3.053529e-03 3 1  ON 53
ci_055                -2.895789e-03 3 1  ON 54
ci_056                -2.081475e-03 3 1  ON 55
ci_057                -1.622159e-03 3 1  ON 56
ci_058                -2.091502e-03 3 1  ON 57
ci_059                -2.709264e-03 3 1  ON 58
ci_060                -2.138094e-03 3 1  ON 59
ci_061                -9.818914e-04 3 1  ON 60
ci_062                -1.274090e-03 3 1  ON 61
ci_063                -4.802284e-04 3 1  ON 62
ci_064                -1.574045e-03 3 1  ON 63
ci_065                -1.812631e-03 3 1  ON 64
ci_066                -1.950073e-03 3 1  ON 65
ci_067                -1.115493e-03 3 1  ON 66
ci_068                -1.049191e-03 3 1  ON 67
ci_069                 1.982820e-03 3 1  ON 68
ci_070                 7.490905e-04 3 1  ON 69
ci_071                -8.704902e-04 3 1  ON 70
ci_072                -3.868787e-04 3 1  ON 71
ci_073                 7.610651e-04 3 1  ON 72
ci_074                 1.114064e-03 3 1  ON 73
ci_075                -3.550382e-04 3 1  ON 74
ci_076                -1.421576e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.3492
    reference variance = 3.09349
====================================================
  Execution time = 2.3954e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7645e+00
  Total weights = 1.9497e+06
  Execution time = 4.4748e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.819683100384
                                         uncertainty =       0.044683592200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.819683100384
                                         uncertainty =       0.044683592200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381956125
  error estimate for blocks of size 2^( 2) =       0.001453177171
  error estimate for blocks of size 2^( 3) =       0.001517362894
  error estimate for blocks of size 2^( 4) =       0.001560192508
  error estimate for blocks of size 2^( 5) =       0.001586326563
  error estimate for blocks of size 2^( 6) =       0.001594948888
  error estimate for blocks of size 2^( 7) =       0.001603557743

      target function =                  N/A
              le_mean =     -22.326322890994
             les_mean =     502.233666129517
             stat err =       0.001586256425
             autocorr =       1.317523221113
              std dev =       1.954412364700
             le_variance =       3.819727691292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820296816989
                                         uncertainty =       0.044675710963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820296816989
                                         uncertainty =       0.044675710963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382066759
  error estimate for blocks of size 2^( 2) =       0.001453243799
  error estimate for blocks of size 2^( 3) =       0.001517405811
  error estimate for blocks of size 2^( 4) =       0.001560256718
  error estimate for blocks of size 2^( 5) =       0.001586329413
  error estimate for blocks of size 2^( 6) =       0.001594950292
  error estimate for blocks of size 2^( 7) =       0.001603586617

      target function =                  N/A
              le_mean =     -22.326323596080
             les_mean =     502.243375042241
             stat err =       0.001586280760
             autocorr =       1.317352712307
              std dev =       1.954568827594
             le_variance =       3.820339301801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820418996180
                                         uncertainty =       0.044678979993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.820418996180
                                         uncertainty =       0.044678979993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001382088795
  error estimate for blocks of size 2^( 2) =       0.001453265203
  error estimate for blocks of size 2^( 3) =       0.001517428093
  error estimate for blocks of size 2^( 4) =       0.001560279083
  error estimate for blocks of size 2^( 5) =       0.001586366179
  error estimate for blocks of size 2^( 6) =       0.001594979102
  error estimate for blocks of size 2^( 7) =       0.001603620265

      target function =                  N/A
              le_mean =     -22.326332994660
             les_mean =     502.232653993754
             stat err =       0.001586311157
             autocorr =       1.317361192784
              std dev =       1.954599991084
             le_variance =       3.820461125144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.819754742545
                                         uncertainty =       0.044683271745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.819754742545
                                         uncertainty =       0.044683271745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381968995
  error estimate for blocks of size 2^( 2) =       0.001453180873
  error estimate for blocks of size 2^( 3) =       0.001517361779
  error estimate for blocks of size 2^( 4) =       0.001560196376
  error estimate for blocks of size 2^( 5) =       0.001586319352
  error estimate for blocks of size 2^( 6) =       0.001594949013
  error estimate for blocks of size 2^( 7) =       0.001603565485

      target function =                  N/A
              le_mean =     -22.326312909878
             les_mean =     502.230584093242
             stat err =       0.001586257557
             autocorr =       1.317500560079
              std dev =       1.954430566293
             le_variance =       3.819798838459


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326322890994        initial
     5.2940e-02     5.2940e-01             2.3015e-03       -22.326323596080
     2.1176e-01     2.1176e+00             1.2394e-03       -22.326332994660  <--
     8.4703e-01     8.4703e+00             4.3733e-04       -22.326312909878

*****************************************************************************
Applying the update for shift_i =   2.1176e-01     and shift_s =   2.1176e+00
*****************************************************************************

  Execution time = 4.6479e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -6.870519e-01 3 1  ON 0
ci_002                -7.136082e-01 3 1  ON 1
ci_003                -6.093434e-02 3 1  ON 2
ci_004                -6.317537e-02 3 1  ON 3
ci_005                 4.508719e-02 3 1  ON 4
ci_006                 4.640037e-02 3 1  ON 5
ci_007                 3.152159e-02 3 1  ON 6
ci_008                 3.290056e-02 3 1  ON 7
ci_009                -2.484060e-02 3 1  ON 8
ci_010                -2.600484e-02 3 1  ON 9
ci_011                -2.192386e-02 3 1  ON 10
ci_012                -2.201209e-02 3 1  ON 11
ci_013                 2.003730e-02 3 1  ON 12
ci_014                 2.070599e-02 3 1  ON 13
ci_015                 2.149269e-02 3 1  ON 14
ci_016                 1.958748e-02 3 1  ON 15
ci_017                 1.644609e-02 3 1  ON 16
ci_018                 1.589129e-02 3 1  ON 17
ci_019                 1.092105e-02 3 1  ON 18
ci_020                 1.057214e-02 3 1  ON 19
ci_021                -8.884341e-03 3 1  ON 20
ci_022                -9.849384e-03 3 1  ON 21
ci_023                 8.625042e-03 3 1  ON 22
ci_024                 9.369809e-03 3 1  ON 23
ci_025                 8.084115e-03 3 1  ON 24
ci_026                 8.531952e-03 3 1  ON 25
ci_027                 7.489585e-03 3 1  ON 26
ci_028                 7.569506e-03 3 1  ON 27
ci_029                -8.111623e-03 3 1  ON 28
ci_030                -7.753061e-03 3 1  ON 29
ci_031                -7.335087e-03 3 1  ON 30
ci_032                -8.349531e-03 3 1  ON 31
ci_033                 6.161110e-03 3 1  ON 32
ci_034                 7.054668e-03 3 1  ON 33
ci_035                 6.516567e-03 3 1  ON 34
ci_036                 6.765264e-03 3 1  ON 35
ci_037                 6.672958e-03 3 1  ON 36
ci_038                 5.915775e-03 3 1  ON 37
ci_039                 6.206863e-03 3 1  ON 38
ci_040                 5.319541e-03 3 1  ON 39
ci_041                 5.016009e-03 3 1  ON 40
ci_042                 5.527248e-03 3 1  ON 41
ci_043                 4.261244e-03 3 1  ON 42
ci_044                 5.141990e-03 3 1  ON 43
ci_045                 6.069038e-03 3 1  ON 44
ci_046                 4.891811e-03 3 1  ON 45
ci_047                -3.860403e-03 3 1  ON 46
ci_048                -4.092104e-03 3 1  ON 47
ci_049                 2.894964e-03 3 1  ON 48
ci_050                 2.974518e-03 3 1  ON 49
ci_051                -2.658719e-03 3 1  ON 50
ci_052                -3.496599e-03 3 1  ON 51
ci_053                -2.559432e-03 3 1  ON 52
ci_054                -3.053529e-03 3 1  ON 53
ci_055                -2.895789e-03 3 1  ON 54
ci_056                -2.081475e-03 3 1  ON 55
ci_057                -1.622159e-03 3 1  ON 56
ci_058                -2.091502e-03 3 1  ON 57
ci_059                -2.709264e-03 3 1  ON 58
ci_060                -2.138094e-03 3 1  ON 59
ci_061                -9.818914e-04 3 1  ON 60
ci_062                -1.274090e-03 3 1  ON 61
ci_063                -4.802284e-04 3 1  ON 62
ci_064                -1.574045e-03 3 1  ON 63
ci_065                -1.812631e-03 3 1  ON 64
ci_066                -1.950073e-03 3 1  ON 65
ci_067                -1.115493e-03 3 1  ON 66
ci_068                -1.049191e-03 3 1  ON 67
ci_069                 1.982820e-03 3 1  ON 68
ci_070                 7.490905e-04 3 1  ON 69
ci_071                -8.704902e-04 3 1  ON 70
ci_072                -3.868787e-04 3 1  ON 71
ci_073                 7.610651e-04 3 1  ON 72
ci_074                 1.114064e-03 3 1  ON 73
ci_075                -3.550382e-04 3 1  ON 74
ci_076                -1.421576e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9077e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2306e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.184
    reference variance = 4.21386
====================================================
  Execution time = 2.4430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0292e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7511e+00
  Total weights = 1.950488688e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0782e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800603219539
                                         uncertainty =       0.060400907089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.800603219539
                                         uncertainty =       0.060400907089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378355777
  error estimate for blocks of size 2^( 2) =       0.001449087264
  error estimate for blocks of size 2^( 3) =       0.001513624991
  error estimate for blocks of size 2^( 4) =       0.001558049121
  error estimate for blocks of size 2^( 5) =       0.001580057989
  error estimate for blocks of size 2^( 6) =       0.001589577963
  error estimate for blocks of size 2^( 7) =       0.001598339311

      target function =                  N/A
              le_mean =     -22.327805083666
             les_mean =     502.282000897654
             stat err =       0.001581506096
             autocorr =       1.316494590495
              std dev =       1.949320622087
             le_variance =       3.799850887694


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232780508367e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e-02, overlap shift 5.2940e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327805082814       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327899079838       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327901694649       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327904928357       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327905913989       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327905854670       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327905658855       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327905804388       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e-02 is 2.865318e-03

solving harmonic davidson linear method for identity shift 2.1176e-01, overlap shift 2.1176e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327805082814       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327862051212       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327861749811       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327862188646       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327862190338       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e-01 is 1.101294e-03

solving harmonic davidson linear method for identity shift 8.4703e-01, overlap shift 8.4703e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327805082814       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327827199922       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327826993230       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327827022186       residual = 1.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e-01 is 4.337804e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0516e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -6.863252e-01 3 1  ON 0
ci_002                -7.141490e-01 3 1  ON 1
ci_003                -6.105775e-02 3 1  ON 2
ci_004                -6.413707e-02 3 1  ON 3
ci_005                 4.524669e-02 3 1  ON 4
ci_006                 4.651352e-02 3 1  ON 5
ci_007                 3.182130e-02 3 1  ON 6
ci_008                 3.290588e-02 3 1  ON 7
ci_009                -2.453329e-02 3 1  ON 8
ci_010                -2.615602e-02 3 1  ON 9
ci_011                -2.213274e-02 3 1  ON 10
ci_012                -2.206181e-02 3 1  ON 11
ci_013                 1.941698e-02 3 1  ON 12
ci_014                 2.090707e-02 3 1  ON 13
ci_015                 2.074734e-02 3 1  ON 14
ci_016                 2.047762e-02 3 1  ON 15
ci_017                 1.621400e-02 3 1  ON 16
ci_018                 1.566677e-02 3 1  ON 17
ci_019                 1.074445e-02 3 1  ON 18
ci_020                 1.068567e-02 3 1  ON 19
ci_021                -9.604676e-03 3 1  ON 20
ci_022                -1.088409e-02 3 1  ON 21
ci_023                 9.085246e-03 3 1  ON 22
ci_024                 8.268515e-03 3 1  ON 23
ci_025                 8.262411e-03 3 1  ON 24
ci_026                 8.596916e-03 3 1  ON 25
ci_027                 7.301744e-03 3 1  ON 26
ci_028                 8.359898e-03 3 1  ON 27
ci_029                -8.903799e-03 3 1  ON 28
ci_030                -8.208282e-03 3 1  ON 29
ci_031                -8.244396e-03 3 1  ON 30
ci_032                -8.251728e-03 3 1  ON 31
ci_033                 6.245508e-03 3 1  ON 32
ci_034                 7.442002e-03 3 1  ON 33
ci_035                 6.618100e-03 3 1  ON 34
ci_036                 6.888168e-03 3 1  ON 35
ci_037                 6.459643e-03 3 1  ON 36
ci_038                 6.286193e-03 3 1  ON 37
ci_039                 6.744133e-03 3 1  ON 38
ci_040                 5.864855e-03 3 1  ON 39
ci_041                 5.312200e-03 3 1  ON 40
ci_042                 5.125482e-03 3 1  ON 41
ci_043                 4.891080e-03 3 1  ON 42
ci_044                 4.175508e-03 3 1  ON 43
ci_045                 5.467950e-03 3 1  ON 44
ci_046                 4.623150e-03 3 1  ON 45
ci_047                -4.004790e-03 3 1  ON 46
ci_048                -3.800362e-03 3 1  ON 47
ci_049                 3.752157e-03 3 1  ON 48
ci_050                 2.798793e-03 3 1  ON 49
ci_051                -3.067283e-03 3 1  ON 50
ci_052                -3.115439e-03 3 1  ON 51
ci_053                -2.255025e-03 3 1  ON 52
ci_054                -2.210164e-03 3 1  ON 53
ci_055                -3.547019e-03 3 1  ON 54
ci_056                -2.112301e-03 3 1  ON 55
ci_057                -2.009342e-03 3 1  ON 56
ci_058                -2.365323e-03 3 1  ON 57
ci_059                -2.067439e-03 3 1  ON 58
ci_060                -2.218438e-03 3 1  ON 59
ci_061                -1.417265e-03 3 1  ON 60
ci_062                -1.005074e-03 3 1  ON 61
ci_063                -2.547518e-04 3 1  ON 62
ci_064                -1.768995e-03 3 1  ON 63
ci_065                -2.143842e-03 3 1  ON 64
ci_066                -1.482513e-03 3 1  ON 65
ci_067                -9.891583e-04 3 1  ON 66
ci_068                -1.336479e-03 3 1  ON 67
ci_069                 1.834819e-03 3 1  ON 68
ci_070                 9.566993e-04 3 1  ON 69
ci_071                -9.102838e-04 3 1  ON 70
ci_072                -1.117164e-03 3 1  ON 71
ci_073                 1.988178e-04 3 1  ON 72
ci_074                 1.524349e-03 3 1  ON 73
ci_075                -2.656176e-04 3 1  ON 74
ci_076                -1.409056e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.1691
    reference variance = 4.81971
====================================================
  Execution time = 2.3819e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6855e+00
  Total weights = 1.9497e+06
  Execution time = 4.4859e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737040263113
                                         uncertainty =       0.024635272012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737040263113
                                         uncertainty =       0.024635272012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366749395
  error estimate for blocks of size 2^( 2) =       0.001438627355
  error estimate for blocks of size 2^( 3) =       0.001501788970
  error estimate for blocks of size 2^( 4) =       0.001547053881
  error estimate for blocks of size 2^( 5) =       0.001573218470
  error estimate for blocks of size 2^( 6) =       0.001584164470
  error estimate for blocks of size 2^( 7) =       0.001589038803

      target function =                  N/A
              le_mean =     -22.329048893585
             les_mean =     502.275639634357
             stat err =       0.001573368906
             autocorr =       1.325205853444
              std dev =       1.932906456733
             le_variance =       3.736127370478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737168242545
                                         uncertainty =       0.024595693709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737168242545
                                         uncertainty =       0.024595693709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366772752
  error estimate for blocks of size 2^( 2) =       0.001438619137
  error estimate for blocks of size 2^( 3) =       0.001501767614
  error estimate for blocks of size 2^( 4) =       0.001547013678
  error estimate for blocks of size 2^( 5) =       0.001573192838
  error estimate for blocks of size 2^( 6) =       0.001584169734
  error estimate for blocks of size 2^( 7) =       0.001589086808

      target function =                  N/A
              le_mean =     -22.329005095094
             les_mean =     502.281864834694
             stat err =       0.001573365764
             autocorr =       1.325155268613
              std dev =       1.932939488775
             le_variance =       3.736255067267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.743834056023
                                         uncertainty =       0.026896634272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.743834056023
                                         uncertainty =       0.026896634272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367982664
  error estimate for blocks of size 2^( 2) =       0.001439740178
  error estimate for blocks of size 2^( 3) =       0.001502829592
  error estimate for blocks of size 2^( 4) =       0.001547942288
  error estimate for blocks of size 2^( 5) =       0.001574105732
  error estimate for blocks of size 2^( 6) =       0.001584933907
  error estimate for blocks of size 2^( 7) =       0.001589930973

      target function =                  N/A
              le_mean =     -22.328961173377
             les_mean =     504.410307646610
             stat err =       0.001574228225
             autocorr =       1.324262868567
              std dev =       1.934650590452
             le_variance =       3.742872907137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737023832934
                                         uncertainty =       0.024631718258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.737023832934
                                         uncertainty =       0.024631718258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366746423
  error estimate for blocks of size 2^( 2) =       0.001438621450
  error estimate for blocks of size 2^( 3) =       0.001501793450
  error estimate for blocks of size 2^( 4) =       0.001547055019
  error estimate for blocks of size 2^( 5) =       0.001573234493
  error estimate for blocks of size 2^( 6) =       0.001584210009
  error estimate for blocks of size 2^( 7) =       0.001589050425

      target function =                  N/A
              le_mean =     -22.329027936079
             les_mean =     502.455358699974
             stat err =       0.001573387486
             autocorr =       1.325242917235
              std dev =       1.932902253028
             le_variance =       3.736111119760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329048893585        initial  <--
     5.2940e-02     5.2940e-01             2.8653e-03       -22.329005095094
     2.1176e-01     2.1176e+00             1.1013e-03       -22.328961173377
     8.4703e-01     8.4703e+00             4.3378e-04       -22.329027936079

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.3812
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -6.870519e-01 3 1  ON 0
ci_002                -7.136082e-01 3 1  ON 1
ci_003                -6.093434e-02 3 1  ON 2
ci_004                -6.317537e-02 3 1  ON 3
ci_005                 4.508719e-02 3 1  ON 4
ci_006                 4.640037e-02 3 1  ON 5
ci_007                 3.152159e-02 3 1  ON 6
ci_008                 3.290056e-02 3 1  ON 7
ci_009                -2.484060e-02 3 1  ON 8
ci_010                -2.600484e-02 3 1  ON 9
ci_011                -2.192386e-02 3 1  ON 10
ci_012                -2.201209e-02 3 1  ON 11
ci_013                 2.003730e-02 3 1  ON 12
ci_014                 2.070599e-02 3 1  ON 13
ci_015                 2.149269e-02 3 1  ON 14
ci_016                 1.958748e-02 3 1  ON 15
ci_017                 1.644609e-02 3 1  ON 16
ci_018                 1.589129e-02 3 1  ON 17
ci_019                 1.092105e-02 3 1  ON 18
ci_020                 1.057214e-02 3 1  ON 19
ci_021                -8.884341e-03 3 1  ON 20
ci_022                -9.849384e-03 3 1  ON 21
ci_023                 8.625042e-03 3 1  ON 22
ci_024                 9.369809e-03 3 1  ON 23
ci_025                 8.084115e-03 3 1  ON 24
ci_026                 8.531952e-03 3 1  ON 25
ci_027                 7.489585e-03 3 1  ON 26
ci_028                 7.569506e-03 3 1  ON 27
ci_029                -8.111623e-03 3 1  ON 28
ci_030                -7.753061e-03 3 1  ON 29
ci_031                -7.335087e-03 3 1  ON 30
ci_032                -8.349531e-03 3 1  ON 31
ci_033                 6.161110e-03 3 1  ON 32
ci_034                 7.054668e-03 3 1  ON 33
ci_035                 6.516567e-03 3 1  ON 34
ci_036                 6.765264e-03 3 1  ON 35
ci_037                 6.672958e-03 3 1  ON 36
ci_038                 5.915775e-03 3 1  ON 37
ci_039                 6.206863e-03 3 1  ON 38
ci_040                 5.319541e-03 3 1  ON 39
ci_041                 5.016009e-03 3 1  ON 40
ci_042                 5.527248e-03 3 1  ON 41
ci_043                 4.261244e-03 3 1  ON 42
ci_044                 5.141990e-03 3 1  ON 43
ci_045                 6.069038e-03 3 1  ON 44
ci_046                 4.891811e-03 3 1  ON 45
ci_047                -3.860403e-03 3 1  ON 46
ci_048                -4.092104e-03 3 1  ON 47
ci_049                 2.894964e-03 3 1  ON 48
ci_050                 2.974518e-03 3 1  ON 49
ci_051                -2.658719e-03 3 1  ON 50
ci_052                -3.496599e-03 3 1  ON 51
ci_053                -2.559432e-03 3 1  ON 52
ci_054                -3.053529e-03 3 1  ON 53
ci_055                -2.895789e-03 3 1  ON 54
ci_056                -2.081475e-03 3 1  ON 55
ci_057                -1.622159e-03 3 1  ON 56
ci_058                -2.091502e-03 3 1  ON 57
ci_059                -2.709264e-03 3 1  ON 58
ci_060                -2.138094e-03 3 1  ON 59
ci_061                -9.818914e-04 3 1  ON 60
ci_062                -1.274090e-03 3 1  ON 61
ci_063                -4.802284e-04 3 1  ON 62
ci_064                -1.574045e-03 3 1  ON 63
ci_065                -1.812631e-03 3 1  ON 64
ci_066                -1.950073e-03 3 1  ON 65
ci_067                -1.115493e-03 3 1  ON 66
ci_068                -1.049191e-03 3 1  ON 67
ci_069                 1.982820e-03 3 1  ON 68
ci_070                 7.490905e-04 3 1  ON 69
ci_071                -8.704902e-04 3 1  ON 70
ci_072                -3.868787e-04 3 1  ON 71
ci_073                 7.610651e-04 3 1  ON 72
ci_074                 1.114064e-03 3 1  ON 73
ci_075                -3.550382e-04 3 1  ON 74
ci_076                -1.421576e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6907e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2304e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.5039
    reference variance = 2.93087
====================================================
  Execution time = 2.4424e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0299e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7581e+00
  Total weights = 1.949964347e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0761e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.808988597911
                                         uncertainty =       0.102803339293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.808988597911
                                         uncertainty =       0.102803339293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379846007
  error estimate for blocks of size 2^( 2) =       0.001450757636
  error estimate for blocks of size 2^( 3) =       0.001514465572
  error estimate for blocks of size 2^( 4) =       0.001557708862
  error estimate for blocks of size 2^( 5) =       0.001577699518
  error estimate for blocks of size 2^( 6) =       0.001588415620
  error estimate for blocks of size 2^( 7) =       0.001600300128

      target function =                  N/A
              le_mean =     -22.328102204789
             les_mean =     502.302240378028
             stat err =       0.001581031032
             autocorr =       1.312863413972
              std dev =       1.951428159658
             le_variance =       3.808071862307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232810220479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e-01, overlap shift 5.2940e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328102203983       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328127288223       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328127686888       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328127655107       residual = 1.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e-01 is 8.150772e-04

solving harmonic davidson linear method for identity shift 2.1176e+00, overlap shift 2.1176e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328102203983       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328109913928       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328109968892       residual = 6.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+00 is 2.431008e-04

solving harmonic davidson linear method for identity shift 8.4703e+00, overlap shift 8.4703e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328102203983       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328104248760       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328104260305       residual = 1.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+00 is 6.389516e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0507e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -6.870453e-01 3 1  ON 0
ci_002                -7.136270e-01 3 1  ON 1
ci_003                -6.094749e-02 3 1  ON 2
ci_004                -6.317068e-02 3 1  ON 3
ci_005                 4.521485e-02 3 1  ON 4
ci_006                 4.633648e-02 3 1  ON 5
ci_007                 3.151619e-02 3 1  ON 6
ci_008                 3.282394e-02 3 1  ON 7
ci_009                -2.487929e-02 3 1  ON 8
ci_010                -2.587742e-02 3 1  ON 9
ci_011                -2.186646e-02 3 1  ON 10
ci_012                -2.207551e-02 3 1  ON 11
ci_013                 2.001160e-02 3 1  ON 12
ci_014                 2.067208e-02 3 1  ON 13
ci_015                 2.146451e-02 3 1  ON 14
ci_016                 1.957527e-02 3 1  ON 15
ci_017                 1.620299e-02 3 1  ON 16
ci_018                 1.595082e-02 3 1  ON 17
ci_019                 1.073155e-02 3 1  ON 18
ci_020                 1.036780e-02 3 1  ON 19
ci_021                -8.907352e-03 3 1  ON 20
ci_022                -1.004310e-02 3 1  ON 21
ci_023                 8.601267e-03 3 1  ON 22
ci_024                 9.415424e-03 3 1  ON 23
ci_025                 8.109366e-03 3 1  ON 24
ci_026                 8.622291e-03 3 1  ON 25
ci_027                 7.530505e-03 3 1  ON 26
ci_028                 7.647415e-03 3 1  ON 27
ci_029                -7.961181e-03 3 1  ON 28
ci_030                -7.699192e-03 3 1  ON 29
ci_031                -7.398039e-03 3 1  ON 30
ci_032                -8.324689e-03 3 1  ON 31
ci_033                 6.220747e-03 3 1  ON 32
ci_034                 7.082954e-03 3 1  ON 33
ci_035                 6.417450e-03 3 1  ON 34
ci_036                 6.680216e-03 3 1  ON 35
ci_037                 6.613704e-03 3 1  ON 36
ci_038                 6.045191e-03 3 1  ON 37
ci_039                 6.155795e-03 3 1  ON 38
ci_040                 5.249974e-03 3 1  ON 39
ci_041                 5.074344e-03 3 1  ON 40
ci_042                 5.514921e-03 3 1  ON 41
ci_043                 4.381447e-03 3 1  ON 42
ci_044                 5.130198e-03 3 1  ON 43
ci_045                 5.970155e-03 3 1  ON 44
ci_046                 4.999708e-03 3 1  ON 45
ci_047                -3.998759e-03 3 1  ON 46
ci_048                -4.096977e-03 3 1  ON 47
ci_049                 2.860654e-03 3 1  ON 48
ci_050                 2.916830e-03 3 1  ON 49
ci_051                -2.521696e-03 3 1  ON 50
ci_052                -3.419095e-03 3 1  ON 51
ci_053                -2.589560e-03 3 1  ON 52
ci_054                -2.986939e-03 3 1  ON 53
ci_055                -2.859551e-03 3 1  ON 54
ci_056                -2.063166e-03 3 1  ON 55
ci_057                -1.612436e-03 3 1  ON 56
ci_058                -2.104891e-03 3 1  ON 57
ci_059                -2.620615e-03 3 1  ON 58
ci_060                -2.138213e-03 3 1  ON 59
ci_061                -1.071435e-03 3 1  ON 60
ci_062                -1.269411e-03 3 1  ON 61
ci_063                -5.352890e-04 3 1  ON 62
ci_064                -1.613383e-03 3 1  ON 63
ci_065                -1.873617e-03 3 1  ON 64
ci_066                -1.932758e-03 3 1  ON 65
ci_067                -1.148214e-03 3 1  ON 66
ci_068                -1.058103e-03 3 1  ON 67
ci_069                 1.984601e-03 3 1  ON 68
ci_070                 8.014986e-04 3 1  ON 69
ci_071                -9.392143e-04 3 1  ON 70
ci_072                -4.382855e-04 3 1  ON 71
ci_073                 8.146396e-04 3 1  ON 72
ci_074                 1.168417e-03 3 1  ON 73
ci_075                -3.611569e-04 3 1  ON 74
ci_076                -1.390450e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.0934
    reference variance = 4.11795
====================================================
  Execution time = 2.3837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7315e+00
  Total weights = 1.9499e+06
  Execution time = 4.5042e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.782689535158
                                         uncertainty =       0.032783342164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.782689535158
                                         uncertainty =       0.032783342164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375308501
  error estimate for blocks of size 2^( 2) =       0.001446432911
  error estimate for blocks of size 2^( 3) =       0.001509316714
  error estimate for blocks of size 2^( 4) =       0.001552409802
  error estimate for blocks of size 2^( 5) =       0.001575098021
  error estimate for blocks of size 2^( 6) =       0.001589988208
  error estimate for blocks of size 2^( 7) =       0.001597641083

      target function =                  N/A
              le_mean =     -22.327042588760
             les_mean =     502.228883682978
             stat err =       0.001578784279
             autocorr =       1.317787341118
              std dev =       1.945011053782
             le_variance =       3.783067999333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.782369435078
                                         uncertainty =       0.032775629182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.782369435078
                                         uncertainty =       0.032775629182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375250225
  error estimate for blocks of size 2^( 2) =       0.001446378907
  error estimate for blocks of size 2^( 3) =       0.001509268043
  error estimate for blocks of size 2^( 4) =       0.001552362937
  error estimate for blocks of size 2^( 5) =       0.001575049152
  error estimate for blocks of size 2^( 6) =       0.001589926296
  error estimate for blocks of size 2^( 7) =       0.001597588235

      target function =                  N/A
              le_mean =     -22.327047124300
             les_mean =     502.228614441061
             stat err =       0.001578731655
             autocorr =       1.317811171496
              std dev =       1.944928637819
             le_variance =       3.782747406207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.782461715682
                                         uncertainty =       0.032776807406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.782461715682
                                         uncertainty =       0.032776807406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375267037
  error estimate for blocks of size 2^( 2) =       0.001446394233
  error estimate for blocks of size 2^( 3) =       0.001509281028
  error estimate for blocks of size 2^( 4) =       0.001552375571
  error estimate for blocks of size 2^( 5) =       0.001575062493
  error estimate for blocks of size 2^( 6) =       0.001589944754
  error estimate for blocks of size 2^( 7) =       0.001597603335

      target function =                  N/A
              le_mean =     -22.327043944792
             les_mean =     502.228421120380
             stat err =       0.001578746538
             autocorr =       1.317803798789
              std dev =       1.944952413990
             le_variance =       3.782839892684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.782656083056
                                         uncertainty =       0.032782326497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.782656083056
                                         uncertainty =       0.032782326497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375302414
  error estimate for blocks of size 2^( 2) =       0.001446427190
  error estimate for blocks of size 2^( 3) =       0.001509311476
  error estimate for blocks of size 2^( 4) =       0.001552404590
  error estimate for blocks of size 2^( 5) =       0.001575092620
  error estimate for blocks of size 2^( 6) =       0.001589982579
  error estimate for blocks of size 2^( 7) =       0.001597635477

      target function =                  N/A
              le_mean =     -22.327042352873
             les_mean =     502.229250206821
             stat err =       0.001578778817
             autocorr =       1.317789888589
              std dev =       1.945002444890
             le_variance =       3.783034510626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327042588760        initial
     5.2940e-01     5.2940e+00             8.1508e-04       -22.327047124300  <--
     2.1176e+00     2.1176e+01             2.4310e-04       -22.327043944792
     8.4703e+00     8.4703e+01             6.3895e-05       -22.327042352873

*****************************************************************************
Applying the update for shift_i =   5.2940e-01     and shift_s =   5.2940e+00
*****************************************************************************

  Execution time = 4.6410e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -6.870285e-01 3 1  ON 0
ci_002                -7.136733e-01 3 1  ON 1
ci_003                -6.098191e-02 3 1  ON 2
ci_004                -6.315939e-02 3 1  ON 3
ci_005                 4.547219e-02 3 1  ON 4
ci_006                 4.620308e-02 3 1  ON 5
ci_007                 3.149733e-02 3 1  ON 6
ci_008                 3.264914e-02 3 1  ON 7
ci_009                -2.496123e-02 3 1  ON 8
ci_010                -2.558480e-02 3 1  ON 9
ci_011                -2.173010e-02 3 1  ON 10
ci_012                -2.223748e-02 3 1  ON 11
ci_013                 1.994116e-02 3 1  ON 12
ci_014                 2.059618e-02 3 1  ON 13
ci_015                 2.139080e-02 3 1  ON 14
ci_016                 1.956268e-02 3 1  ON 15
ci_017                 1.563101e-02 3 1  ON 16
ci_018                 1.608703e-02 3 1  ON 17
ci_019                 1.026800e-02 3 1  ON 18
ci_020                 9.872915e-03 3 1  ON 19
ci_021                -8.950726e-03 3 1  ON 20
ci_022                -1.050353e-02 3 1  ON 21
ci_023                 8.547180e-03 3 1  ON 22
ci_024                 9.514470e-03 3 1  ON 23
ci_025                 8.184646e-03 3 1  ON 24
ci_026                 8.858015e-03 3 1  ON 25
ci_027                 7.607929e-03 3 1  ON 26
ci_028                 7.795267e-03 3 1  ON 27
ci_029                -7.611173e-03 3 1  ON 28
ci_030                -7.572418e-03 3 1  ON 29
ci_031                -7.549702e-03 3 1  ON 30
ci_032                -8.256708e-03 3 1  ON 31
ci_033                 6.365985e-03 3 1  ON 32
ci_034                 7.141882e-03 3 1  ON 33
ci_035                 6.226803e-03 3 1  ON 34
ci_036                 6.513170e-03 3 1  ON 35
ci_037                 6.480011e-03 3 1  ON 36
ci_038                 6.337603e-03 3 1  ON 37
ci_039                 6.053617e-03 3 1  ON 38
ci_040                 5.117158e-03 3 1  ON 39
ci_041                 5.200220e-03 3 1  ON 40
ci_042                 5.492562e-03 3 1  ON 41
ci_043                 4.649270e-03 3 1  ON 42
ci_044                 5.123699e-03 3 1  ON 43
ci_045                 5.750370e-03 3 1  ON 44
ci_046                 5.246679e-03 3 1  ON 45
ci_047                -4.272756e-03 3 1  ON 46
ci_048                -4.106894e-03 3 1  ON 47
ci_049                 2.785219e-03 3 1  ON 48
ci_050                 2.789150e-03 3 1  ON 49
ci_051                -2.205431e-03 3 1  ON 50
ci_052                -3.234442e-03 3 1  ON 51
ci_053                -2.659042e-03 3 1  ON 52
ci_054                -2.838131e-03 3 1  ON 53
ci_055                -2.768544e-03 3 1  ON 54
ci_056                -2.017528e-03 3 1  ON 55
ci_057                -1.589112e-03 3 1  ON 56
ci_058                -2.127381e-03 3 1  ON 57
ci_059                -2.443474e-03 3 1  ON 58
ci_060                -2.136628e-03 3 1  ON 59
ci_061                -1.255256e-03 3 1  ON 60
ci_062                -1.270351e-03 3 1  ON 61
ci_063                -6.696799e-04 3 1  ON 62
ci_064                -1.709384e-03 3 1  ON 63
ci_065                -2.022592e-03 3 1  ON 64
ci_066                -1.889919e-03 3 1  ON 65
ci_067                -1.222227e-03 3 1  ON 66
ci_068                -1.089242e-03 3 1  ON 67
ci_069                 1.993601e-03 3 1  ON 68
ci_070                 9.121487e-04 3 1  ON 69
ci_071                -1.104438e-03 3 1  ON 70
ci_072                -5.523998e-04 3 1  ON 71
ci_073                 9.223739e-04 3 1  ON 72
ci_074                 1.268970e-03 3 1  ON 73
ci_075                -3.848708e-04 3 1  ON 74
ci_076                -1.317908e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6924e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2304e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.3174
    reference variance = 3.83268
====================================================
  Execution time = 2.4528e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0321e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6690e+00
  Total weights = 1.949681956e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1009e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715331104072
                                         uncertainty =       0.029503876320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.715331104072
                                         uncertainty =       0.029503876320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001363421532
  error estimate for blocks of size 2^( 2) =       0.001435412176
  error estimate for blocks of size 2^( 3) =       0.001498743476
  error estimate for blocks of size 2^( 4) =       0.001544452577
  error estimate for blocks of size 2^( 5) =       0.001565154347
  error estimate for blocks of size 2^( 6) =       0.001579623869
  error estimate for blocks of size 2^( 7) =       0.001591808422

      target function =                  N/A
              le_mean =     -22.328278871065
             les_mean =     502.221003116098
             stat err =       0.001570259804
             autocorr =       1.326425095961
              std dev =       1.928200072513
             le_variance =       3.717955519638


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232827887106e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e-01, overlap shift 1.3235e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328278870211       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328310161571       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328310760166       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328311144070       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328311264585       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e-01 is 1.306075e-03

solving harmonic davidson linear method for identity shift 5.2940e-01, overlap shift 5.2940e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328278870211       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328293055842       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328293072737       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328293105170       residual = 3.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e-01 is 5.891384e-04

solving harmonic davidson linear method for identity shift 2.1176e+00, overlap shift 2.1176e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328278870211       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328283321797       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328283332131       residual = 5.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+00 is 2.008918e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201020 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0636e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -6.869867e-01 3 1  ON 0
ci_002                -7.137061e-01 3 1  ON 1
ci_003                -6.113265e-02 3 1  ON 2
ci_004                -6.286587e-02 3 1  ON 3
ci_005                 4.531125e-02 3 1  ON 4
ci_006                 4.648688e-02 3 1  ON 5
ci_007                 3.150531e-02 3 1  ON 6
ci_008                 3.273179e-02 3 1  ON 7
ci_009                -2.494786e-02 3 1  ON 8
ci_010                -2.519638e-02 3 1  ON 9
ci_011                -2.223458e-02 3 1  ON 10
ci_012                -2.240628e-02 3 1  ON 11
ci_013                 1.963254e-02 3 1  ON 12
ci_014                 2.083085e-02 3 1  ON 13
ci_015                 2.127060e-02 3 1  ON 14
ci_016                 2.004868e-02 3 1  ON 15
ci_017                 1.567389e-02 3 1  ON 16
ci_018                 1.573192e-02 3 1  ON 17
ci_019                 1.037615e-02 3 1  ON 18
ci_020                 9.702749e-03 3 1  ON 19
ci_021                -8.810371e-03 3 1  ON 20
ci_022                -1.052334e-02 3 1  ON 21
ci_023                 8.809609e-03 3 1  ON 22
ci_024                 9.529083e-03 3 1  ON 23
ci_025                 8.015475e-03 3 1  ON 24
ci_026                 8.929242e-03 3 1  ON 25
ci_027                 7.749916e-03 3 1  ON 26
ci_028                 7.654938e-03 3 1  ON 27
ci_029                -7.678072e-03 3 1  ON 28
ci_030                -7.632375e-03 3 1  ON 29
ci_031                -7.399779e-03 3 1  ON 30
ci_032                -8.106735e-03 3 1  ON 31
ci_033                 6.501169e-03 3 1  ON 32
ci_034                 7.026618e-03 3 1  ON 33
ci_035                 5.987174e-03 3 1  ON 34
ci_036                 6.481966e-03 3 1  ON 35
ci_037                 6.561499e-03 3 1  ON 36
ci_038                 6.490292e-03 3 1  ON 37
ci_039                 6.113578e-03 3 1  ON 38
ci_040                 5.706297e-03 3 1  ON 39
ci_041                 4.936677e-03 3 1  ON 40
ci_042                 5.595835e-03 3 1  ON 41
ci_043                 4.675166e-03 3 1  ON 42
ci_044                 5.414196e-03 3 1  ON 43
ci_045                 5.707245e-03 3 1  ON 44
ci_046                 5.394413e-03 3 1  ON 45
ci_047                -4.450582e-03 3 1  ON 46
ci_048                -3.996915e-03 3 1  ON 47
ci_049                 2.752872e-03 3 1  ON 48
ci_050                 2.984659e-03 3 1  ON 49
ci_051                -2.057065e-03 3 1  ON 50
ci_052                -3.007545e-03 3 1  ON 51
ci_053                -3.064454e-03 3 1  ON 52
ci_054                -2.786123e-03 3 1  ON 53
ci_055                -2.425828e-03 3 1  ON 54
ci_056                -1.937829e-03 3 1  ON 55
ci_057                -1.923048e-03 3 1  ON 56
ci_058                -2.185306e-03 3 1  ON 57
ci_059                -2.337533e-03 3 1  ON 58
ci_060                -1.794764e-03 3 1  ON 59
ci_061                -1.277802e-03 3 1  ON 60
ci_062                -1.150489e-03 3 1  ON 61
ci_063                -4.877949e-04 3 1  ON 62
ci_064                -1.517501e-03 3 1  ON 63
ci_065                -1.809675e-03 3 1  ON 64
ci_066                -1.709731e-03 3 1  ON 65
ci_067                -1.069888e-03 3 1  ON 66
ci_068                -8.976073e-04 3 1  ON 67
ci_069                 2.214839e-03 3 1  ON 68
ci_070                 1.120273e-03 3 1  ON 69
ci_071                -8.549211e-04 3 1  ON 70
ci_072                -6.432849e-04 3 1  ON 71
ci_073                 1.033583e-03 3 1  ON 72
ci_074                 1.335551e-03 3 1  ON 73
ci_075                -5.324253e-04 3 1  ON 74
ci_076                -1.092443e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.1643
    reference variance = 3.03849
====================================================
  Execution time = 2.4016e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7147e+00
  Total weights = 1.9498e+06
  Execution time = 4.4775e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.765926113479
                                         uncertainty =       0.030161912723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.765926113479
                                         uncertainty =       0.030161912723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372149339
  error estimate for blocks of size 2^( 2) =       0.001442937440
  error estimate for blocks of size 2^( 3) =       0.001506193049
  error estimate for blocks of size 2^( 4) =       0.001547183670
  error estimate for blocks of size 2^( 5) =       0.001572571137
  error estimate for blocks of size 2^( 6) =       0.001585610678
  error estimate for blocks of size 2^( 7) =       0.001592532562

      target function =                  N/A
              le_mean =     -22.329466701382
             les_mean =     502.346022555270
             stat err =       0.001574474512
             autocorr =       1.316644434851
              std dev =       1.940543252215
             le_variance =       3.765708113718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766015803378
                                         uncertainty =       0.030165735252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766015803378
                                         uncertainty =       0.030165735252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372165805
  error estimate for blocks of size 2^( 2) =       0.001442948419
  error estimate for blocks of size 2^( 3) =       0.001506192894
  error estimate for blocks of size 2^( 4) =       0.001547190994
  error estimate for blocks of size 2^( 5) =       0.001572582621
  error estimate for blocks of size 2^( 6) =       0.001585631075
  error estimate for blocks of size 2^( 7) =       0.001592522286

      target function =                  N/A
              le_mean =     -22.329471779192
             les_mean =     502.340487057354
             stat err =       0.001574481744
             autocorr =       1.316624930419
              std dev =       1.940566539389
             le_variance =       3.765798493795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766019533513
                                         uncertainty =       0.030164873656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.766019533513
                                         uncertainty =       0.030164873656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372166434
  error estimate for blocks of size 2^( 2) =       0.001442948078
  error estimate for blocks of size 2^( 3) =       0.001506193650
  error estimate for blocks of size 2^( 4) =       0.001547199372
  error estimate for blocks of size 2^( 5) =       0.001572582674
  error estimate for blocks of size 2^( 6) =       0.001585626249
  error estimate for blocks of size 2^( 7) =       0.001592487564

      target function =                  N/A
              le_mean =     -22.329461253361
             les_mean =     502.363859435288
             stat err =       0.001574473965
             autocorr =       1.316610713815
              std dev =       1.940567428493
             le_variance =       3.765801944527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.765915029714
                                         uncertainty =       0.030158741109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.765915029714
                                         uncertainty =       0.030158741109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372147334
  error estimate for blocks of size 2^( 2) =       0.001442930902
  error estimate for blocks of size 2^( 3) =       0.001506173401
  error estimate for blocks of size 2^( 4) =       0.001547157615
  error estimate for blocks of size 2^( 5) =       0.001572549923
  error estimate for blocks of size 2^( 6) =       0.001585571596
  error estimate for blocks of size 2^( 7) =       0.001592453620

      target function =                  N/A
              le_mean =     -22.329463203470
             les_mean =     502.481657556071
             stat err =       0.001574433188
             autocorr =       1.316579169575
              std dev =       1.940540417367
             le_variance =       3.765697111437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329466701382        initial
     1.3235e-01     1.3235e+00             1.3061e-03       -22.329471779192  <--
     5.2940e-01     5.2940e+00             5.8914e-04       -22.329461253361
     2.1176e+00     2.1176e+01             2.0089e-04       -22.329463203470

*****************************************************************************
Applying the update for shift_i =   1.3235e-01     and shift_s =   1.3235e+00
*****************************************************************************

  Execution time = 4.6521e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -6.868667e-01 3 1  ON 0
ci_002                -7.138254e-01 3 1  ON 1
ci_003                -6.143501e-02 3 1  ON 2
ci_004                -6.221733e-02 3 1  ON 3
ci_005                 4.513758e-02 3 1  ON 4
ci_006                 4.678345e-02 3 1  ON 5
ci_007                 3.151573e-02 3 1  ON 6
ci_008                 3.284972e-02 3 1  ON 7
ci_009                -2.492473e-02 3 1  ON 8
ci_010                -2.467177e-02 3 1  ON 9
ci_011                -2.293803e-02 3 1  ON 10
ci_012                -2.266408e-02 3 1  ON 11
ci_013                 1.916369e-02 3 1  ON 12
ci_014                 2.117874e-02 3 1  ON 13
ci_015                 2.112588e-02 3 1  ON 14
ci_016                 2.086876e-02 3 1  ON 15
ci_017                 1.569846e-02 3 1  ON 16
ci_018                 1.522584e-02 3 1  ON 17
ci_019                 1.054173e-02 3 1  ON 18
ci_020                 9.421153e-03 3 1  ON 19
ci_021                -8.619704e-03 3 1  ON 20
ci_022                -1.056738e-02 3 1  ON 21
ci_023                 9.119421e-03 3 1  ON 22
ci_024                 9.539201e-03 3 1  ON 23
ci_025                 7.760612e-03 3 1  ON 24
ci_026                 9.067572e-03 3 1  ON 25
ci_027                 7.886184e-03 3 1  ON 26
ci_028                 7.499307e-03 3 1  ON 27
ci_029                -7.806990e-03 3 1  ON 28
ci_030                -7.704255e-03 3 1  ON 29
ci_031                -7.176190e-03 3 1  ON 30
ci_032                -7.882992e-03 3 1  ON 31
ci_033                 6.676775e-03 3 1  ON 32
ci_034                 6.842322e-03 3 1  ON 33
ci_035                 5.765582e-03 3 1  ON 34
ci_036                 6.444416e-03 3 1  ON 35
ci_037                 6.632567e-03 3 1  ON 36
ci_038                 6.716387e-03 3 1  ON 37
ci_039                 6.153133e-03 3 1  ON 38
ci_040                 6.259575e-03 3 1  ON 39
ci_041                 4.652890e-03 3 1  ON 40
ci_042                 5.691049e-03 3 1  ON 41
ci_043                 4.761120e-03 3 1  ON 42
ci_044                 5.800099e-03 3 1  ON 43
ci_045                 5.635626e-03 3 1  ON 44
ci_046                 5.610505e-03 3 1  ON 45
ci_047                -4.617263e-03 3 1  ON 46
ci_048                -3.886980e-03 3 1  ON 47
ci_049                 2.703087e-03 3 1  ON 48
ci_050                 3.236416e-03 3 1  ON 49
ci_051                -1.886817e-03 3 1  ON 50
ci_052                -2.685602e-03 3 1  ON 51
ci_053                -3.586741e-03 3 1  ON 52
ci_054                -2.698481e-03 3 1  ON 53
ci_055                -1.909468e-03 3 1  ON 54
ci_056                -1.828198e-03 3 1  ON 55
ci_057                -2.314713e-03 3 1  ON 56
ci_058                -2.255620e-03 3 1  ON 57
ci_059                -2.267242e-03 3 1  ON 58
ci_060                -1.478018e-03 3 1  ON 59
ci_061                -1.304808e-03 3 1  ON 60
ci_062                -1.033119e-03 3 1  ON 61
ci_063                -2.515164e-04 3 1  ON 62
ci_064                -1.249399e-03 3 1  ON 63
ci_065                -1.544066e-03 3 1  ON 64
ci_066                -1.455948e-03 3 1  ON 65
ci_067                -9.046156e-04 3 1  ON 66
ci_068                -6.454493e-04 3 1  ON 67
ci_069                 2.520710e-03 3 1  ON 68
ci_070                 1.377783e-03 3 1  ON 69
ci_071                -5.615868e-04 3 1  ON 70
ci_072                -7.984256e-04 3 1  ON 71
ci_073                 1.131519e-03 3 1  ON 72
ci_074                 1.410716e-03 3 1  ON 73
ci_075                -7.312690e-04 3 1  ON 74
ci_076                -8.493335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7163e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2303e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.228
    reference variance = 4.73389
====================================================
  Execution time = 2.6541e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0322e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7034e+00
  Total weights = 1.950259557e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9266e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.754502607651
                                         uncertainty =       0.034828480709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.754502607651
                                         uncertainty =       0.034828480709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370353268
  error estimate for blocks of size 2^( 2) =       0.001441201992
  error estimate for blocks of size 2^( 3) =       0.001505042617
  error estimate for blocks of size 2^( 4) =       0.001547054909
  error estimate for blocks of size 2^( 5) =       0.001571580002
  error estimate for blocks of size 2^( 6) =       0.001581401197
  error estimate for blocks of size 2^( 7) =       0.001590662207

      target function =                  N/A
              le_mean =     -22.326910854505
             les_mean =     502.194369997546
             stat err =       0.001572674579
             autocorr =       1.317081511944
              std dev =       1.938003184565
             le_variance =       3.755856343385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232691085451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e-02, overlap shift 3.3087e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326910853662       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327008550459       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327014830362       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327016308325       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327015468556       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327015639412       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327015634839       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e-02 is 2.395898e-03

solving harmonic davidson linear method for identity shift 1.3235e-01, overlap shift 1.3235e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326910853662       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326978442671       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326980354658       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326980656041       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326980486748       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e-01 is 1.520213e-03

solving harmonic davidson linear method for identity shift 5.2940e-01, overlap shift 5.2940e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326910853662       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326941125622       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326941220804       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326941228507       residual = 1.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e-01 is 6.196408e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2475e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -6.867250e-01 3 1  ON 0
ci_002                -7.138401e-01 3 1  ON 1
ci_003                -6.197264e-02 3 1  ON 2
ci_004                -6.247580e-02 3 1  ON 3
ci_005                 4.560543e-02 3 1  ON 4
ci_006                 4.664812e-02 3 1  ON 5
ci_007                 3.196620e-02 3 1  ON 6
ci_008                 3.263955e-02 3 1  ON 7
ci_009                -2.499172e-02 3 1  ON 8
ci_010                -2.549638e-02 3 1  ON 9
ci_011                -2.220586e-02 3 1  ON 10
ci_012                -2.246185e-02 3 1  ON 11
ci_013                 1.909907e-02 3 1  ON 12
ci_014                 2.171846e-02 3 1  ON 13
ci_015                 2.121403e-02 3 1  ON 14
ci_016                 1.996374e-02 3 1  ON 15
ci_017                 1.614647e-02 3 1  ON 16
ci_018                 1.530998e-02 3 1  ON 17
ci_019                 9.021513e-03 3 1  ON 18
ci_020                 1.072138e-02 3 1  ON 19
ci_021                -9.631364e-03 3 1  ON 20
ci_022                -1.024022e-02 3 1  ON 21
ci_023                 9.153244e-03 3 1  ON 22
ci_024                 9.471788e-03 3 1  ON 23
ci_025                 7.106071e-03 3 1  ON 24
ci_026                 8.497992e-03 3 1  ON 25
ci_027                 7.501102e-03 3 1  ON 26
ci_028                 8.255621e-03 3 1  ON 27
ci_029                -7.631558e-03 3 1  ON 28
ci_030                -7.875567e-03 3 1  ON 29
ci_031                -7.383366e-03 3 1  ON 30
ci_032                -7.637918e-03 3 1  ON 31
ci_033                 6.987082e-03 3 1  ON 32
ci_034                 8.222006e-03 3 1  ON 33
ci_035                 6.448803e-03 3 1  ON 34
ci_036                 7.263127e-03 3 1  ON 35
ci_037                 6.251741e-03 3 1  ON 36
ci_038                 6.517189e-03 3 1  ON 37
ci_039                 5.816136e-03 3 1  ON 38
ci_040                 6.193832e-03 3 1  ON 39
ci_041                 4.614148e-03 3 1  ON 40
ci_042                 5.703150e-03 3 1  ON 41
ci_043                 5.221391e-03 3 1  ON 42
ci_044                 6.057265e-03 3 1  ON 43
ci_045                 5.017891e-03 3 1  ON 44
ci_046                 5.402013e-03 3 1  ON 45
ci_047                -5.212730e-03 3 1  ON 46
ci_048                -3.897929e-03 3 1  ON 47
ci_049                 2.704800e-03 3 1  ON 48
ci_050                 3.192837e-03 3 1  ON 49
ci_051                -3.243316e-03 3 1  ON 50
ci_052                -2.795932e-03 3 1  ON 51
ci_053                -3.722755e-03 3 1  ON 52
ci_054                -3.026213e-03 3 1  ON 53
ci_055                -2.098792e-03 3 1  ON 54
ci_056                -2.383212e-03 3 1  ON 55
ci_057                -2.307615e-03 3 1  ON 56
ci_058                -2.799036e-03 3 1  ON 57
ci_059                -1.805236e-03 3 1  ON 58
ci_060                -2.237561e-03 3 1  ON 59
ci_061                -2.572314e-03 3 1  ON 60
ci_062                -1.759634e-03 3 1  ON 61
ci_063                -1.053324e-03 3 1  ON 62
ci_064                -5.625435e-04 3 1  ON 63
ci_065                -6.072682e-04 3 1  ON 64
ci_066                -6.633250e-04 3 1  ON 65
ci_067                -1.352770e-03 3 1  ON 66
ci_068                -7.007372e-04 3 1  ON 67
ci_069                 1.637832e-03 3 1  ON 68
ci_070                 1.264448e-03 3 1  ON 69
ci_071                -9.299827e-04 3 1  ON 70
ci_072                -7.393012e-04 3 1  ON 71
ci_073                 1.338285e-03 3 1  ON 72
ci_074                 9.734266e-04 3 1  ON 73
ci_075                -1.042045e-03 3 1  ON 74
ci_076                -1.398915e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.2031
    reference variance = 3.59347
====================================================
  Execution time = 2.3808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7399e+00
  Total weights = 1.9499e+06
  Execution time = 4.4136e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793625323526
                                         uncertainty =       0.039113502000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793625323526
                                         uncertainty =       0.039113502000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377109441
  error estimate for blocks of size 2^( 2) =       0.001447247803
  error estimate for blocks of size 2^( 3) =       0.001509129251
  error estimate for blocks of size 2^( 4) =       0.001553058099
  error estimate for blocks of size 2^( 5) =       0.001577306396
  error estimate for blocks of size 2^( 6) =       0.001584118208
  error estimate for blocks of size 2^( 7) =       0.001589332959

      target function =                  N/A
              le_mean =     -22.327892358091
             les_mean =     502.280869955892
             stat err =       0.001575953916
             autocorr =       1.309634525294
              std dev =       1.947558009209
             le_variance =       3.792982199235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805467481410
                                         uncertainty =       0.041780066778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805467481410
                                         uncertainty =       0.041780066778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379253789
  error estimate for blocks of size 2^( 2) =       0.001449237980
  error estimate for blocks of size 2^( 3) =       0.001510990329
  error estimate for blocks of size 2^( 4) =       0.001554792568
  error estimate for blocks of size 2^( 5) =       0.001578940183
  error estimate for blocks of size 2^( 6) =       0.001585850737
  error estimate for blocks of size 2^( 7) =       0.001591474566

      target function =                  N/A
              le_mean =     -22.327786593022
             les_mean =     507.180930121063
             stat err =       0.001577764514
             autocorr =       1.308567098337
              std dev =       1.950590622620
             le_variance =       3.804803777053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796904506771
                                         uncertainty =       0.039166491776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796904506771
                                         uncertainty =       0.039166491776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377710384
  error estimate for blocks of size 2^( 2) =       0.001447789684
  error estimate for blocks of size 2^( 3) =       0.001509583691
  error estimate for blocks of size 2^( 4) =       0.001553438833
  error estimate for blocks of size 2^( 5) =       0.001577632275
  error estimate for blocks of size 2^( 6) =       0.001584428337
  error estimate for blocks of size 2^( 7) =       0.001589877984

      target function =                  N/A
              le_mean =     -22.327859474399
             les_mean =     503.113634491623
             stat err =       0.001576344358
             autocorr =       1.309140713903
              std dev =       1.948407884161
             le_variance =       3.796293283062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793590778738
                                         uncertainty =       0.039115200693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.793590778738
                                         uncertainty =       0.039115200693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377103047
  error estimate for blocks of size 2^( 2) =       0.001447238969
  error estimate for blocks of size 2^( 3) =       0.001509114044
  error estimate for blocks of size 2^( 4) =       0.001553034944
  error estimate for blocks of size 2^( 5) =       0.001577260655
  error estimate for blocks of size 2^( 6) =       0.001584076317
  error estimate for blocks of size 2^( 7) =       0.001589318633

      target function =                  N/A
              le_mean =     -22.327858787675
             les_mean =     502.277703347700
             stat err =       0.001575922637
             autocorr =       1.309594702595
              std dev =       1.947548965727
             le_variance =       3.792946973903


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327892358091        initial  <--
     3.3087e-02     3.3087e-01             2.3959e-03       -22.327786593022
     1.3235e-01     1.3235e+00             1.5202e-03       -22.327859474399
     5.2940e-01     5.2940e+00             6.1964e-04       -22.327858787675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8731
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -6.868667e-01 3 1  ON 0
ci_002                -7.138254e-01 3 1  ON 1
ci_003                -6.143501e-02 3 1  ON 2
ci_004                -6.221733e-02 3 1  ON 3
ci_005                 4.513758e-02 3 1  ON 4
ci_006                 4.678345e-02 3 1  ON 5
ci_007                 3.151573e-02 3 1  ON 6
ci_008                 3.284972e-02 3 1  ON 7
ci_009                -2.492473e-02 3 1  ON 8
ci_010                -2.467177e-02 3 1  ON 9
ci_011                -2.293803e-02 3 1  ON 10
ci_012                -2.266408e-02 3 1  ON 11
ci_013                 1.916369e-02 3 1  ON 12
ci_014                 2.117874e-02 3 1  ON 13
ci_015                 2.112588e-02 3 1  ON 14
ci_016                 2.086876e-02 3 1  ON 15
ci_017                 1.569846e-02 3 1  ON 16
ci_018                 1.522584e-02 3 1  ON 17
ci_019                 1.054173e-02 3 1  ON 18
ci_020                 9.421153e-03 3 1  ON 19
ci_021                -8.619704e-03 3 1  ON 20
ci_022                -1.056738e-02 3 1  ON 21
ci_023                 9.119421e-03 3 1  ON 22
ci_024                 9.539201e-03 3 1  ON 23
ci_025                 7.760612e-03 3 1  ON 24
ci_026                 9.067572e-03 3 1  ON 25
ci_027                 7.886184e-03 3 1  ON 26
ci_028                 7.499307e-03 3 1  ON 27
ci_029                -7.806990e-03 3 1  ON 28
ci_030                -7.704255e-03 3 1  ON 29
ci_031                -7.176190e-03 3 1  ON 30
ci_032                -7.882992e-03 3 1  ON 31
ci_033                 6.676775e-03 3 1  ON 32
ci_034                 6.842322e-03 3 1  ON 33
ci_035                 5.765582e-03 3 1  ON 34
ci_036                 6.444416e-03 3 1  ON 35
ci_037                 6.632567e-03 3 1  ON 36
ci_038                 6.716387e-03 3 1  ON 37
ci_039                 6.153133e-03 3 1  ON 38
ci_040                 6.259575e-03 3 1  ON 39
ci_041                 4.652890e-03 3 1  ON 40
ci_042                 5.691049e-03 3 1  ON 41
ci_043                 4.761120e-03 3 1  ON 42
ci_044                 5.800099e-03 3 1  ON 43
ci_045                 5.635626e-03 3 1  ON 44
ci_046                 5.610505e-03 3 1  ON 45
ci_047                -4.617263e-03 3 1  ON 46
ci_048                -3.886980e-03 3 1  ON 47
ci_049                 2.703087e-03 3 1  ON 48
ci_050                 3.236416e-03 3 1  ON 49
ci_051                -1.886817e-03 3 1  ON 50
ci_052                -2.685602e-03 3 1  ON 51
ci_053                -3.586741e-03 3 1  ON 52
ci_054                -2.698481e-03 3 1  ON 53
ci_055                -1.909468e-03 3 1  ON 54
ci_056                -1.828198e-03 3 1  ON 55
ci_057                -2.314713e-03 3 1  ON 56
ci_058                -2.255620e-03 3 1  ON 57
ci_059                -2.267242e-03 3 1  ON 58
ci_060                -1.478018e-03 3 1  ON 59
ci_061                -1.304808e-03 3 1  ON 60
ci_062                -1.033119e-03 3 1  ON 61
ci_063                -2.515164e-04 3 1  ON 62
ci_064                -1.249399e-03 3 1  ON 63
ci_065                -1.544066e-03 3 1  ON 64
ci_066                -1.455948e-03 3 1  ON 65
ci_067                -9.046156e-04 3 1  ON 66
ci_068                -6.454493e-04 3 1  ON 67
ci_069                 2.520710e-03 3 1  ON 68
ci_070                 1.377783e-03 3 1  ON 69
ci_071                -5.615868e-04 3 1  ON 70
ci_072                -7.984256e-04 3 1  ON 71
ci_073                 1.131519e-03 3 1  ON 72
ci_074                 1.410716e-03 3 1  ON 73
ci_075                -7.312690e-04 3 1  ON 74
ci_076                -8.493335e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2302e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.4374
    reference variance = 2.73327
====================================================
  Execution time = 2.4239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0307e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.9069e+00
  Total weights = 1.949774796e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9019e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.962073382801
                                         uncertainty =       0.121160585244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.962073382801
                                         uncertainty =       0.121160585244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001407457962
  error estimate for blocks of size 2^( 2) =       0.001476473797
  error estimate for blocks of size 2^( 3) =       0.001538157213
  error estimate for blocks of size 2^( 4) =       0.001579014552
  error estimate for blocks of size 2^( 5) =       0.001606284710
  error estimate for blocks of size 2^( 6) =       0.001616440267
  error estimate for blocks of size 2^( 7) =       0.001619058104

      target function =                  N/A
              le_mean =     -22.327449475186
             les_mean =     502.421895835463
             stat err =       0.001605199408
             autocorr =       1.300729882385
              std dev =       1.990477985194
             le_variance =       3.962002609543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232744947519e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e-01, overlap shift 3.3087e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327449474407       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327483716516       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327484915083       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327485002544       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e-01 is 8.150233e-04

solving harmonic davidson linear method for identity shift 1.3235e+00, overlap shift 1.3235e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327449474407       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327461177260       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327461317689       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+00 is 2.807223e-04

solving harmonic davidson linear method for identity shift 5.2940e+00, overlap shift 5.2940e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327449474407       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327452695730       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327452715761       residual = 6.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+00 is 7.793377e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204391 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0148e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -6.868772e-01 3 1  ON 0
ci_002                -7.138667e-01 3 1  ON 1
ci_003                -6.133428e-02 3 1  ON 2
ci_004                -6.207366e-02 3 1  ON 3
ci_005                 4.519798e-02 3 1  ON 4
ci_006                 4.657464e-02 3 1  ON 5
ci_007                 3.147404e-02 3 1  ON 6
ci_008                 3.278374e-02 3 1  ON 7
ci_009                -2.484459e-02 3 1  ON 8
ci_010                -2.480111e-02 3 1  ON 9
ci_011                -2.277128e-02 3 1  ON 10
ci_012                -2.267703e-02 3 1  ON 11
ci_013                 1.913070e-02 3 1  ON 12
ci_014                 2.121652e-02 3 1  ON 13
ci_015                 2.094094e-02 3 1  ON 14
ci_016                 2.087085e-02 3 1  ON 15
ci_017                 1.568979e-02 3 1  ON 16
ci_018                 1.523515e-02 3 1  ON 17
ci_019                 1.048706e-02 3 1  ON 18
ci_020                 9.346118e-03 3 1  ON 19
ci_021                -8.615345e-03 3 1  ON 20
ci_022                -1.044112e-02 3 1  ON 21
ci_023                 9.191031e-03 3 1  ON 22
ci_024                 9.258479e-03 3 1  ON 23
ci_025                 7.698923e-03 3 1  ON 24
ci_026                 8.806096e-03 3 1  ON 25
ci_027                 7.970060e-03 3 1  ON 26
ci_028                 7.560199e-03 3 1  ON 27
ci_029                -7.746020e-03 3 1  ON 28
ci_030                -7.809222e-03 3 1  ON 29
ci_031                -7.132069e-03 3 1  ON 30
ci_032                -7.876716e-03 3 1  ON 31
ci_033                 6.784924e-03 3 1  ON 32
ci_034                 7.036008e-03 3 1  ON 33
ci_035                 5.775025e-03 3 1  ON 34
ci_036                 6.657891e-03 3 1  ON 35
ci_037                 6.451065e-03 3 1  ON 36
ci_038                 6.722598e-03 3 1  ON 37
ci_039                 6.057919e-03 3 1  ON 38
ci_040                 6.244808e-03 3 1  ON 39
ci_041                 4.661005e-03 3 1  ON 40
ci_042                 5.675521e-03 3 1  ON 41
ci_043                 4.821541e-03 3 1  ON 42
ci_044                 5.715123e-03 3 1  ON 43
ci_045                 5.677216e-03 3 1  ON 44
ci_046                 5.548102e-03 3 1  ON 45
ci_047                -4.671384e-03 3 1  ON 46
ci_048                -3.933384e-03 3 1  ON 47
ci_049                 2.711743e-03 3 1  ON 48
ci_050                 3.298499e-03 3 1  ON 49
ci_051                -2.126592e-03 3 1  ON 50
ci_052                -2.691437e-03 3 1  ON 51
ci_053                -3.544697e-03 3 1  ON 52
ci_054                -2.619664e-03 3 1  ON 53
ci_055                -2.014471e-03 3 1  ON 54
ci_056                -1.749992e-03 3 1  ON 55
ci_057                -2.158398e-03 3 1  ON 56
ci_058                -2.186384e-03 3 1  ON 57
ci_059                -2.243019e-03 3 1  ON 58
ci_060                -1.564096e-03 3 1  ON 59
ci_061                -1.485380e-03 3 1  ON 60
ci_062                -9.608523e-04 3 1  ON 61
ci_063                -4.262175e-04 3 1  ON 62
ci_064                -1.227117e-03 3 1  ON 63
ci_065                -1.302648e-03 3 1  ON 64
ci_066                -1.366853e-03 3 1  ON 65
ci_067                -7.519259e-04 3 1  ON 66
ci_068                -6.850266e-04 3 1  ON 67
ci_069                 2.546286e-03 3 1  ON 68
ci_070                 1.355613e-03 3 1  ON 69
ci_071                -5.146942e-04 3 1  ON 70
ci_072                -9.369462e-04 3 1  ON 71
ci_073                 1.301059e-03 3 1  ON 72
ci_074                 1.394048e-03 3 1  ON 73
ci_075                -7.375747e-04 3 1  ON 74
ci_076                -7.970775e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.5954
    reference variance = 2.36187
====================================================
  Execution time = 2.3588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8815e+00
  Total weights = 1.9498e+06
  Execution time = 4.3783e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.933016858086
                                         uncertainty =       0.075426369584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.933016858086
                                         uncertainty =       0.075426369584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001402314506
  error estimate for blocks of size 2^( 2) =       0.001471704302
  error estimate for blocks of size 2^( 3) =       0.001532945785
  error estimate for blocks of size 2^( 4) =       0.001575660666
  error estimate for blocks of size 2^( 5) =       0.001601017389
  error estimate for blocks of size 2^( 6) =       0.001610647615
  error estimate for blocks of size 2^( 7) =       0.001616101589

      target function =                  N/A
              le_mean =     -22.328078599528
             les_mean =     502.425185158096
             stat err =       0.001600856814
             autocorr =       1.303209163649
              std dev =       1.983203923310
             le_variance =       3.933097801434

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0382717
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.932822951326
                                         uncertainty =       0.075426145874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.932822951326
                                         uncertainty =       0.075426145874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001402278902
  error estimate for blocks of size 2^( 2) =       0.001471682851
  error estimate for blocks of size 2^( 3) =       0.001532932178
  error estimate for blocks of size 2^( 4) =       0.001575657568
  error estimate for blocks of size 2^( 5) =       0.001601003782
  error estimate for blocks of size 2^( 6) =       0.001610597711
  error estimate for blocks of size 2^( 7) =       0.001616076216

      target function =                  N/A
              le_mean =     -22.328084890849
             les_mean =     502.425444104656
             stat err =       0.001600833819
             autocorr =       1.303237899756
              std dev =       1.983153571533
             le_variance =       3.932898088284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.932847859790
                                         uncertainty =       0.075426006742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.932847859790
                                         uncertainty =       0.075426006742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001402283673
  error estimate for blocks of size 2^( 2) =       0.001471684241
  error estimate for blocks of size 2^( 3) =       0.001532931031
  error estimate for blocks of size 2^( 4) =       0.001575654678
  error estimate for blocks of size 2^( 5) =       0.001601003156
  error estimate for blocks of size 2^( 6) =       0.001610610602
  error estimate for blocks of size 2^( 7) =       0.001616081422

      target function =                  N/A
              le_mean =     -22.328079505769
             les_mean =     502.426210296998
             stat err =       0.001600837464
             autocorr =       1.303234967299
              std dev =       1.983160318392
             le_variance =       3.932924848445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.933078762080
                                         uncertainty =       0.075425198098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.933078762080
                                         uncertainty =       0.075425198098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001402325442
  error estimate for blocks of size 2^( 2) =       0.001471717307
  error estimate for blocks of size 2^( 3) =       0.001532960509
  error estimate for blocks of size 2^( 4) =       0.001575674494
  error estimate for blocks of size 2^( 5) =       0.001601023534
  error estimate for blocks of size 2^( 6) =       0.001610649028
  error estimate for blocks of size 2^( 7) =       0.001616147365

      target function =                  N/A
              le_mean =     -22.328070983147
             les_mean =     503.254285679369
             stat err =       0.001600873605
             autocorr =       1.303216174187
              std dev =       1.983219389954
             le_variance =       3.933159148691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328078599528        initial
     3.3087e-01     3.3087e+00             8.1502e-04       -22.328084890849  <--
     1.3235e+00     1.3235e+01             2.8072e-04       -22.328079505769
     5.2940e+00     5.2940e+01             7.7934e-05       -22.328070983147

*****************************************************************************
Applying the update for shift_i =   3.3087e-01     and shift_s =   3.3087e+00
*****************************************************************************

  Execution time = 4.5615e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -6.868924e-01 3 1  ON 0
ci_002                -7.139603e-01 3 1  ON 1
ci_003                -6.108412e-02 3 1  ON 2
ci_004                -6.171391e-02 3 1  ON 3
ci_005                 4.530930e-02 3 1  ON 4
ci_006                 4.622177e-02 3 1  ON 5
ci_007                 3.141192e-02 3 1  ON 6
ci_008                 3.265922e-02 3 1  ON 7
ci_009                -2.467762e-02 3 1  ON 8
ci_010                -2.508629e-02 3 1  ON 9
ci_011                -2.244053e-02 3 1  ON 10
ci_012                -2.271271e-02 3 1  ON 11
ci_013                 1.905213e-02 3 1  ON 12
ci_014                 2.131701e-02 3 1  ON 13
ci_015                 2.053130e-02 3 1  ON 14
ci_016                 2.088676e-02 3 1  ON 15
ci_017                 1.568449e-02 3 1  ON 16
ci_018                 1.528538e-02 3 1  ON 17
ci_019                 1.037423e-02 3 1  ON 18
ci_020                 9.197141e-03 3 1  ON 19
ci_021                -8.614358e-03 3 1  ON 20
ci_022                -1.015699e-02 3 1  ON 21
ci_023                 9.322997e-03 3 1  ON 22
ci_024                 8.742410e-03 3 1  ON 23
ci_025                 7.573417e-03 3 1  ON 24
ci_026                 8.252549e-03 3 1  ON 25
ci_027                 8.099959e-03 3 1  ON 26
ci_028                 7.666006e-03 3 1  ON 27
ci_029                -7.638406e-03 3 1  ON 28
ci_030                -8.037907e-03 3 1  ON 29
ci_031                -7.040334e-03 3 1  ON 30
ci_032                -7.876489e-03 3 1  ON 31
ci_033                 7.006957e-03 3 1  ON 32
ci_034                 7.442209e-03 3 1  ON 33
ci_035                 5.777955e-03 3 1  ON 34
ci_036                 6.985709e-03 3 1  ON 35
ci_037                 6.084715e-03 3 1  ON 36
ci_038                 6.722042e-03 3 1  ON 37
ci_039                 5.902072e-03 3 1  ON 38
ci_040                 6.223485e-03 3 1  ON 39
ci_041                 4.670144e-03 3 1  ON 40
ci_042                 5.649655e-03 3 1  ON 41
ci_043                 4.950442e-03 3 1  ON 42
ci_044                 5.551906e-03 3 1  ON 43
ci_045                 5.758228e-03 3 1  ON 44
ci_046                 5.416424e-03 3 1  ON 45
ci_047                -4.755465e-03 3 1  ON 46
ci_048                -4.007184e-03 3 1  ON 47
ci_049                 2.724663e-03 3 1  ON 48
ci_050                 3.427830e-03 3 1  ON 49
ci_051                -2.612852e-03 3 1  ON 50
ci_052                -2.681312e-03 3 1  ON 51
ci_053                -3.474052e-03 3 1  ON 52
ci_054                -2.452146e-03 3 1  ON 53
ci_055                -2.252279e-03 3 1  ON 54
ci_056                -1.562771e-03 3 1  ON 55
ci_057                -1.866259e-03 3 1  ON 56
ci_058                -2.056647e-03 3 1  ON 57
ci_059                -2.200077e-03 3 1  ON 58
ci_060                -1.701250e-03 3 1  ON 59
ci_061                -1.839916e-03 3 1  ON 60
ci_062                -8.118155e-04 3 1  ON 61
ci_063                -7.776712e-04 3 1  ON 62
ci_064                -1.172591e-03 3 1  ON 63
ci_065                -8.276876e-04 3 1  ON 64
ci_066                -1.183628e-03 3 1  ON 65
ci_067                -4.347935e-04 3 1  ON 66
ci_068                -7.807106e-04 3 1  ON 67
ci_069                 2.580130e-03 3 1  ON 68
ci_070                 1.307733e-03 3 1  ON 69
ci_071                -4.072563e-04 3 1  ON 70
ci_072                -1.216938e-03 3 1  ON 71
ci_073                 1.570129e-03 3 1  ON 72
ci_074                 1.366018e-03 3 1  ON 73
ci_075                -7.550514e-04 3 1  ON 74
ci_076                -6.945310e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2305e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.2577
    reference variance = 2.54152
====================================================
  Execution time = 2.4267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0295e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7350e+00
  Total weights = 1.949986679e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8299e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789139365680
                                         uncertainty =       0.038518229204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.789139365680
                                         uncertainty =       0.038518229204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001376265876
  error estimate for blocks of size 2^( 2) =       0.001445839693
  error estimate for blocks of size 2^( 3) =       0.001506715717
  error estimate for blocks of size 2^( 4) =       0.001549981530
  error estimate for blocks of size 2^( 5) =       0.001578767240
  error estimate for blocks of size 2^( 6) =       0.001590158136
  error estimate for blocks of size 2^( 7) =       0.001593173637

      target function =                  N/A
              le_mean =     -22.329237456627
             les_mean =     502.329877337380
             stat err =       0.001578020136
             autocorr =       1.314681033937
              std dev =       1.946365007844
             le_variance =       3.788336743759


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232923745663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e-02, overlap shift 8.2718e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329237455844       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329326673007       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329337650508       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329337731435       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329339764005       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329340117350       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329340243694       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e-02 is 2.429395e-03

solving harmonic davidson linear method for identity shift 3.3087e-01, overlap shift 3.3087e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329237455844       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329285361984       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329287350586       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329287130529       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329287224097       residual = 6.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e-01 is 1.121869e-03

solving harmonic davidson linear method for identity shift 1.3235e+00, overlap shift 1.3235e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329237455844       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329254252176       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329254462120       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329254441097       residual = 8.22e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+00 is 4.333023e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208646 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0109e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -6.864381e-01 3 1  ON 0
ci_002                -7.144234e-01 3 1  ON 1
ci_003                -6.020667e-02 3 1  ON 2
ci_004                -6.229279e-02 3 1  ON 3
ci_005                 4.504662e-02 3 1  ON 4
ci_006                 4.656848e-02 3 1  ON 5
ci_007                 3.152861e-02 3 1  ON 6
ci_008                 3.256626e-02 3 1  ON 7
ci_009                -2.453678e-02 3 1  ON 8
ci_010                -2.557654e-02 3 1  ON 9
ci_011                -2.171783e-02 3 1  ON 10
ci_012                -2.215682e-02 3 1  ON 11
ci_013                 1.906136e-02 3 1  ON 12
ci_014                 2.176173e-02 3 1  ON 13
ci_015                 2.076345e-02 3 1  ON 14
ci_016                 2.075418e-02 3 1  ON 15
ci_017                 1.599961e-02 3 1  ON 16
ci_018                 1.517395e-02 3 1  ON 17
ci_019                 9.607812e-03 3 1  ON 18
ci_020                 9.519621e-03 3 1  ON 19
ci_021                -8.663597e-03 3 1  ON 20
ci_022                -1.005695e-02 3 1  ON 21
ci_023                 9.408214e-03 3 1  ON 22
ci_024                 8.769399e-03 3 1  ON 23
ci_025                 7.576008e-03 3 1  ON 24
ci_026                 8.637288e-03 3 1  ON 25
ci_027                 7.918651e-03 3 1  ON 26
ci_028                 7.390598e-03 3 1  ON 27
ci_029                -7.488566e-03 3 1  ON 28
ci_030                -8.236647e-03 3 1  ON 29
ci_031                -7.282891e-03 3 1  ON 30
ci_032                -8.345498e-03 3 1  ON 31
ci_033                 6.699077e-03 3 1  ON 32
ci_034                 7.330747e-03 3 1  ON 33
ci_035                 6.303957e-03 3 1  ON 34
ci_036                 7.037850e-03 3 1  ON 35
ci_037                 6.307662e-03 3 1  ON 36
ci_038                 7.517781e-03 3 1  ON 37
ci_039                 5.688826e-03 3 1  ON 38
ci_040                 5.983863e-03 3 1  ON 39
ci_041                 4.661214e-03 3 1  ON 40
ci_042                 5.604411e-03 3 1  ON 41
ci_043                 5.065375e-03 3 1  ON 42
ci_044                 5.393072e-03 3 1  ON 43
ci_045                 5.276023e-03 3 1  ON 44
ci_046                 5.564898e-03 3 1  ON 45
ci_047                -3.633596e-03 3 1  ON 46
ci_048                -4.410345e-03 3 1  ON 47
ci_049                 2.971895e-03 3 1  ON 48
ci_050                 3.502701e-03 3 1  ON 49
ci_051                -2.743415e-03 3 1  ON 50
ci_052                -2.734400e-03 3 1  ON 51
ci_053                -2.828412e-03 3 1  ON 52
ci_054                -2.477078e-03 3 1  ON 53
ci_055                -2.130955e-03 3 1  ON 54
ci_056                -1.934424e-03 3 1  ON 55
ci_057                -1.784379e-03 3 1  ON 56
ci_058                -1.820406e-03 3 1  ON 57
ci_059                -2.143311e-03 3 1  ON 58
ci_060                -1.893825e-03 3 1  ON 59
ci_061                -1.834232e-03 3 1  ON 60
ci_062                -1.106158e-03 3 1  ON 61
ci_063                -1.268515e-03 3 1  ON 62
ci_064                -1.903028e-03 3 1  ON 63
ci_065                -9.636103e-04 3 1  ON 64
ci_066                -9.467798e-04 3 1  ON 65
ci_067                -1.205412e-03 3 1  ON 66
ci_068                -1.146860e-03 3 1  ON 67
ci_069                 2.827083e-03 3 1  ON 68
ci_070                 1.323362e-03 3 1  ON 69
ci_071                -5.061434e-04 3 1  ON 70
ci_072                -7.069927e-04 3 1  ON 71
ci_073                 1.165798e-03 3 1  ON 72
ci_074                 1.308477e-03 3 1  ON 73
ci_075                -8.465758e-04 3 1  ON 74
ci_076                -9.498236e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.5473
    reference variance = 2.25216
====================================================
  Execution time = 2.3739e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6921e+00
  Total weights = 1.9499e+06
  Execution time = 4.4214e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742115774249
                                         uncertainty =       0.026903860474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742115774249
                                         uncertainty =       0.026903860474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367923810
  error estimate for blocks of size 2^( 2) =       0.001438012791
  error estimate for blocks of size 2^( 3) =       0.001499695981
  error estimate for blocks of size 2^( 4) =       0.001543743119
  error estimate for blocks of size 2^( 5) =       0.001568602051
  error estimate for blocks of size 2^( 6) =       0.001582435503
  error estimate for blocks of size 2^( 7) =       0.001594224237

      target function =                  N/A
              le_mean =     -22.329404310937
             les_mean =     502.587812611876
             stat err =       0.001572251227
             autocorr =       1.321052468958
              std dev =       1.934567356382
             le_variance =       3.742550856378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742072195198
                                         uncertainty =       0.026912661109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742072195198
                                         uncertainty =       0.026912661109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367915999
  error estimate for blocks of size 2^( 2) =       0.001438005147
  error estimate for blocks of size 2^( 3) =       0.001499699703
  error estimate for blocks of size 2^( 4) =       0.001543689138
  error estimate for blocks of size 2^( 5) =       0.001568545662
  error estimate for blocks of size 2^( 6) =       0.001582384132
  error estimate for blocks of size 2^( 7) =       0.001594211176

      target function =                  N/A
              le_mean =     -22.329383055011
             les_mean =     502.295885715679
             stat err =       0.001572207527
             autocorr =       1.320994119727
              std dev =       1.934556309935
             le_variance =       3.742508116310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742148669199
                                         uncertainty =       0.026916225228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.742148669199
                                         uncertainty =       0.026916225228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367929931
  error estimate for blocks of size 2^( 2) =       0.001438022522
  error estimate for blocks of size 2^( 3) =       0.001499719029
  error estimate for blocks of size 2^( 4) =       0.001543703159
  error estimate for blocks of size 2^( 5) =       0.001568557727
  error estimate for blocks of size 2^( 6) =       0.001582404381
  error estimate for blocks of size 2^( 7) =       0.001594227256

      target function =                  N/A
              le_mean =     -22.329384834640
             les_mean =     502.297242035938
             stat err =       0.001572223131
             autocorr =       1.320993431706
              std dev =       1.934576013495
             le_variance =       3.742584351991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741940766457
                                         uncertainty =       0.026905099199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741940766457
                                         uncertainty =       0.026905099199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367891844
  error estimate for blocks of size 2^( 2) =       0.001437988950
  error estimate for blocks of size 2^( 3) =       0.001499683225
  error estimate for blocks of size 2^( 4) =       0.001543715404
  error estimate for blocks of size 2^( 5) =       0.001568563889
  error estimate for blocks of size 2^( 6) =       0.001582418166
  error estimate for blocks of size 2^( 7) =       0.001594237145

      target function =                  N/A
              le_mean =     -22.329388040611
             les_mean =     502.295717671209
             stat err =       0.001572233651
             autocorr =       1.321084675527
              std dev =       1.934522148795
             le_variance =       3.742375944177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329404310937        initial  <--
     8.2718e-02     8.2718e-01             2.4294e-03       -22.329383055011
     3.3087e-01     3.3087e+00             1.1219e-03       -22.329384834640
     1.3235e+00     1.3235e+01             4.3330e-04       -22.329388040611

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.9159
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -6.868924e-01 3 1  ON 0
ci_002                -7.139603e-01 3 1  ON 1
ci_003                -6.108412e-02 3 1  ON 2
ci_004                -6.171391e-02 3 1  ON 3
ci_005                 4.530930e-02 3 1  ON 4
ci_006                 4.622177e-02 3 1  ON 5
ci_007                 3.141192e-02 3 1  ON 6
ci_008                 3.265922e-02 3 1  ON 7
ci_009                -2.467762e-02 3 1  ON 8
ci_010                -2.508629e-02 3 1  ON 9
ci_011                -2.244053e-02 3 1  ON 10
ci_012                -2.271271e-02 3 1  ON 11
ci_013                 1.905213e-02 3 1  ON 12
ci_014                 2.131701e-02 3 1  ON 13
ci_015                 2.053130e-02 3 1  ON 14
ci_016                 2.088676e-02 3 1  ON 15
ci_017                 1.568449e-02 3 1  ON 16
ci_018                 1.528538e-02 3 1  ON 17
ci_019                 1.037423e-02 3 1  ON 18
ci_020                 9.197141e-03 3 1  ON 19
ci_021                -8.614358e-03 3 1  ON 20
ci_022                -1.015699e-02 3 1  ON 21
ci_023                 9.322997e-03 3 1  ON 22
ci_024                 8.742410e-03 3 1  ON 23
ci_025                 7.573417e-03 3 1  ON 24
ci_026                 8.252549e-03 3 1  ON 25
ci_027                 8.099959e-03 3 1  ON 26
ci_028                 7.666006e-03 3 1  ON 27
ci_029                -7.638406e-03 3 1  ON 28
ci_030                -8.037907e-03 3 1  ON 29
ci_031                -7.040334e-03 3 1  ON 30
ci_032                -7.876489e-03 3 1  ON 31
ci_033                 7.006957e-03 3 1  ON 32
ci_034                 7.442209e-03 3 1  ON 33
ci_035                 5.777955e-03 3 1  ON 34
ci_036                 6.985709e-03 3 1  ON 35
ci_037                 6.084715e-03 3 1  ON 36
ci_038                 6.722042e-03 3 1  ON 37
ci_039                 5.902072e-03 3 1  ON 38
ci_040                 6.223485e-03 3 1  ON 39
ci_041                 4.670144e-03 3 1  ON 40
ci_042                 5.649655e-03 3 1  ON 41
ci_043                 4.950442e-03 3 1  ON 42
ci_044                 5.551906e-03 3 1  ON 43
ci_045                 5.758228e-03 3 1  ON 44
ci_046                 5.416424e-03 3 1  ON 45
ci_047                -4.755465e-03 3 1  ON 46
ci_048                -4.007184e-03 3 1  ON 47
ci_049                 2.724663e-03 3 1  ON 48
ci_050                 3.427830e-03 3 1  ON 49
ci_051                -2.612852e-03 3 1  ON 50
ci_052                -2.681312e-03 3 1  ON 51
ci_053                -3.474052e-03 3 1  ON 52
ci_054                -2.452146e-03 3 1  ON 53
ci_055                -2.252279e-03 3 1  ON 54
ci_056                -1.562771e-03 3 1  ON 55
ci_057                -1.866259e-03 3 1  ON 56
ci_058                -2.056647e-03 3 1  ON 57
ci_059                -2.200077e-03 3 1  ON 58
ci_060                -1.701250e-03 3 1  ON 59
ci_061                -1.839916e-03 3 1  ON 60
ci_062                -8.118155e-04 3 1  ON 61
ci_063                -7.776712e-04 3 1  ON 62
ci_064                -1.172591e-03 3 1  ON 63
ci_065                -8.276876e-04 3 1  ON 64
ci_066                -1.183628e-03 3 1  ON 65
ci_067                -4.347935e-04 3 1  ON 66
ci_068                -7.807106e-04 3 1  ON 67
ci_069                 2.580130e-03 3 1  ON 68
ci_070                 1.307733e-03 3 1  ON 69
ci_071                -4.072563e-04 3 1  ON 70
ci_072                -1.216938e-03 3 1  ON 71
ci_073                 1.570129e-03 3 1  ON 72
ci_074                 1.366018e-03 3 1  ON 73
ci_075                -7.550514e-04 3 1  ON 74
ci_076                -6.945310e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6039e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2306e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.3951
    reference variance = 1.92498
====================================================
  Execution time = 2.4313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0326e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.6969e+00
  Total weights = 1.950116260e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8912e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745706902054
                                         uncertainty =       0.024295918231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.745706902054
                                         uncertainty =       0.024295918231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001368450452
  error estimate for blocks of size 2^( 2) =       0.001440489387
  error estimate for blocks of size 2^( 3) =       0.001501474191
  error estimate for blocks of size 2^( 4) =       0.001541626286
  error estimate for blocks of size 2^( 5) =       0.001565238932
  error estimate for blocks of size 2^( 6) =       0.001580116626
  error estimate for blocks of size 2^( 7) =       0.001589841871

      target function =                  N/A
              le_mean =     -22.326840609846
             les_mean =     502.184703609933
             stat err =       0.001569205929
             autocorr =       1.314927251041
              std dev =       1.935312152816
             le_variance =       3.745433128836


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232684060985e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e-01, overlap shift 8.2718e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326840609018       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326866754132       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326866880639       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326866862411       residual = 7.57e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e-01 is 3.896427e-04

solving harmonic davidson linear method for identity shift 3.3087e+00, overlap shift 3.3087e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326840609018       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326848290228       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326848299674       residual = 6.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+00 is 1.135027e-04

solving harmonic davidson linear method for identity shift 1.3235e+01, overlap shift 1.3235e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326840609018       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326842617264       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326842618843       residual = 3.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+01 is 2.962034e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0215e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -6.868985e-01 3 1  ON 0
ci_002                -7.139633e-01 3 1  ON 1
ci_003                -6.114048e-02 3 1  ON 2
ci_004                -6.173432e-02 3 1  ON 3
ci_005                 4.529272e-02 3 1  ON 4
ci_006                 4.622387e-02 3 1  ON 5
ci_007                 3.138748e-02 3 1  ON 6
ci_008                 3.255675e-02 3 1  ON 7
ci_009                -2.462913e-02 3 1  ON 8
ci_010                -2.517317e-02 3 1  ON 9
ci_011                -2.244469e-02 3 1  ON 10
ci_012                -2.271444e-02 3 1  ON 11
ci_013                 1.907609e-02 3 1  ON 12
ci_014                 2.132258e-02 3 1  ON 13
ci_015                 2.054043e-02 3 1  ON 14
ci_016                 2.081325e-02 3 1  ON 15
ci_017                 1.562497e-02 3 1  ON 16
ci_018                 1.522939e-02 3 1  ON 17
ci_019                 1.027327e-02 3 1  ON 18
ci_020                 9.184637e-03 3 1  ON 19
ci_021                -8.659980e-03 3 1  ON 20
ci_022                -1.015768e-02 3 1  ON 21
ci_023                 9.251431e-03 3 1  ON 22
ci_024                 8.734030e-03 3 1  ON 23
ci_025                 7.567220e-03 3 1  ON 24
ci_026                 8.210200e-03 3 1  ON 25
ci_027                 8.070070e-03 3 1  ON 26
ci_028                 7.597517e-03 3 1  ON 27
ci_029                -7.717944e-03 3 1  ON 28
ci_030                -7.998477e-03 3 1  ON 29
ci_031                -7.084988e-03 3 1  ON 30
ci_032                -7.872095e-03 3 1  ON 31
ci_033                 6.894554e-03 3 1  ON 32
ci_034                 7.450864e-03 3 1  ON 33
ci_035                 5.788454e-03 3 1  ON 34
ci_036                 6.977321e-03 3 1  ON 35
ci_037                 6.123409e-03 3 1  ON 36
ci_038                 6.714435e-03 3 1  ON 37
ci_039                 5.852744e-03 3 1  ON 38
ci_040                 6.167822e-03 3 1  ON 39
ci_041                 4.646036e-03 3 1  ON 40
ci_042                 5.583426e-03 3 1  ON 41
ci_043                 4.961178e-03 3 1  ON 42
ci_044                 5.461748e-03 3 1  ON 43
ci_045                 5.644725e-03 3 1  ON 44
ci_046                 5.405305e-03 3 1  ON 45
ci_047                -4.660486e-03 3 1  ON 46
ci_048                -4.069754e-03 3 1  ON 47
ci_049                 2.778028e-03 3 1  ON 48
ci_050                 3.439054e-03 3 1  ON 49
ci_051                -2.649926e-03 3 1  ON 50
ci_052                -2.667532e-03 3 1  ON 51
ci_053                -3.375684e-03 3 1  ON 52
ci_054                -2.530024e-03 3 1  ON 53
ci_055                -2.289076e-03 3 1  ON 54
ci_056                -1.600448e-03 3 1  ON 55
ci_057                -1.911362e-03 3 1  ON 56
ci_058                -2.104184e-03 3 1  ON 57
ci_059                -2.214268e-03 3 1  ON 58
ci_060                -1.707617e-03 3 1  ON 59
ci_061                -1.824866e-03 3 1  ON 60
ci_062                -8.911834e-04 3 1  ON 61
ci_063                -8.445260e-04 3 1  ON 62
ci_064                -1.172081e-03 3 1  ON 63
ci_065                -9.286268e-04 3 1  ON 64
ci_066                -1.153432e-03 3 1  ON 65
ci_067                -3.681311e-04 3 1  ON 66
ci_068                -8.316054e-04 3 1  ON 67
ci_069                 2.504685e-03 3 1  ON 68
ci_070                 1.300127e-03 3 1  ON 69
ci_071                -4.901111e-04 3 1  ON 70
ci_072                -1.181676e-03 3 1  ON 71
ci_073                 1.482384e-03 3 1  ON 72
ci_074                 1.327690e-03 3 1  ON 73
ci_075                -8.051940e-04 3 1  ON 74
ci_076                -7.722860e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.3711
    reference variance = 2.87339
====================================================
  Execution time = 2.3770e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.8966e+00
  Total weights = 1.9501e+06
  Execution time = 4.3829e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.948977620837
                                         uncertainty =       0.095124716417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.948977620837
                                         uncertainty =       0.095124716417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001405189499
  error estimate for blocks of size 2^( 2) =       0.001474317761
  error estimate for blocks of size 2^( 3) =       0.001536934998
  error estimate for blocks of size 2^( 4) =       0.001577840258
  error estimate for blocks of size 2^( 5) =       0.001602735335
  error estimate for blocks of size 2^( 6) =       0.001614161196
  error estimate for blocks of size 2^( 7) =       0.001617729296

      target function =                  N/A
              le_mean =     -22.328013545055
             les_mean =     502.446686255245
             stat err =       0.001603116521
             autocorr =       1.301548596845
              std dev =       1.987269842847
             le_variance =       3.949241428291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.948966527773
                                         uncertainty =       0.095125085866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.948966527773
                                         uncertainty =       0.095125085866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001405187540
  error estimate for blocks of size 2^( 2) =       0.001474324246
  error estimate for blocks of size 2^( 3) =       0.001536946117
  error estimate for blocks of size 2^( 4) =       0.001577852480
  error estimate for blocks of size 2^( 5) =       0.001602745096
  error estimate for blocks of size 2^( 6) =       0.001614180120
  error estimate for blocks of size 2^( 7) =       0.001617738300

      target function =                  N/A
              le_mean =     -22.328016227358
             les_mean =     502.437665058306
             stat err =       0.001603128999
             autocorr =       1.301572487445
              std dev =       1.987267072143
             le_variance =       3.949230416023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.948967647769
                                         uncertainty =       0.095124898090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.948967647769
                                         uncertainty =       0.095124898090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001405187731
  error estimate for blocks of size 2^( 2) =       0.001474320711
  error estimate for blocks of size 2^( 3) =       0.001536940540
  error estimate for blocks of size 2^( 4) =       0.001577846531
  error estimate for blocks of size 2^( 5) =       0.001602740551
  error estimate for blocks of size 2^( 6) =       0.001614171591
  error estimate for blocks of size 2^( 7) =       0.001617733426

      target function =                  N/A
              le_mean =     -22.328013774220
             les_mean =     502.436922933319
             stat err =       0.001603123025
             autocorr =       1.301562431788
              std dev =       1.987267343004
             le_variance =       3.949231492570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.948975597242
                                         uncertainty =       0.095124743719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.948975597242
                                         uncertainty =       0.095124743719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001405189140
  error estimate for blocks of size 2^( 2) =       0.001474318059
  error estimate for blocks of size 2^( 3) =       0.001536935743
  error estimate for blocks of size 2^( 4) =       0.001577841113
  error estimate for blocks of size 2^( 5) =       0.001602735457
  error estimate for blocks of size 2^( 6) =       0.001614161588
  error estimate for blocks of size 2^( 7) =       0.001617728895

      target function =                  N/A
              le_mean =     -22.328013526094
             les_mean =     502.437100367004
             stat err =       0.001603116763
             autocorr =       1.301549655896
              std dev =       1.987269334508
             le_variance =       3.949239407878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328013545055        initial
     8.2718e-01     8.2718e+00             3.8964e-04       -22.328016227358  <--
     3.3087e+00     3.3087e+01             1.1350e-04       -22.328013774220
     1.3235e+01     1.3235e+02             2.9620e-05       -22.328013526094

*****************************************************************************
Applying the update for shift_i =   8.2718e-01     and shift_s =   8.2718e+00
*****************************************************************************

  Execution time = 4.5810e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -6.869126e-01 3 1  ON 0
ci_002                -7.139685e-01 3 1  ON 1
ci_003                -6.130078e-02 3 1  ON 2
ci_004                -6.179260e-02 3 1  ON 3
ci_005                 4.525370e-02 3 1  ON 4
ci_006                 4.623009e-02 3 1  ON 5
ci_007                 3.132853e-02 3 1  ON 6
ci_008                 3.229867e-02 3 1  ON 7
ci_009                -2.451121e-02 3 1  ON 8
ci_010                -2.539243e-02 3 1  ON 9
ci_011                -2.246014e-02 3 1  ON 10
ci_012                -2.270801e-02 3 1  ON 11
ci_013                 1.913416e-02 3 1  ON 12
ci_014                 2.133764e-02 3 1  ON 13
ci_015                 2.056784e-02 3 1  ON 14
ci_016                 2.062165e-02 3 1  ON 15
ci_017                 1.547576e-02 3 1  ON 16
ci_018                 1.509037e-02 3 1  ON 17
ci_019                 1.001376e-02 3 1  ON 18
ci_020                 9.152669e-03 3 1  ON 19
ci_021                -8.768790e-03 3 1  ON 20
ci_022                -1.015986e-02 3 1  ON 21
ci_023                 9.077737e-03 3 1  ON 22
ci_024                 8.714316e-03 3 1  ON 23
ci_025                 7.557708e-03 3 1  ON 24
ci_026                 8.103599e-03 3 1  ON 25
ci_027                 8.002870e-03 3 1  ON 26
ci_028                 7.450396e-03 3 1  ON 27
ci_029                -7.906022e-03 3 1  ON 28
ci_030                -7.909916e-03 3 1  ON 29
ci_031                -7.202610e-03 3 1  ON 30
ci_032                -7.861998e-03 3 1  ON 31
ci_033                 6.617315e-03 3 1  ON 32
ci_034                 7.473427e-03 3 1  ON 33
ci_035                 5.815554e-03 3 1  ON 34
ci_036                 6.957521e-03 3 1  ON 35
ci_037                 6.220105e-03 3 1  ON 36
ci_038                 6.694942e-03 3 1  ON 37
ci_039                 5.745566e-03 3 1  ON 38
ci_040                 6.049202e-03 3 1  ON 39
ci_041                 4.593306e-03 3 1  ON 40
ci_042                 5.431957e-03 3 1  ON 41
ci_043                 4.985007e-03 3 1  ON 42
ci_044                 5.244497e-03 3 1  ON 43
ci_045                 5.370735e-03 3 1  ON 44
ci_046                 5.376006e-03 3 1  ON 45
ci_047                -4.451029e-03 3 1  ON 46
ci_048                -4.206784e-03 3 1  ON 47
ci_049                 2.912890e-03 3 1  ON 48
ci_050                 3.468247e-03 3 1  ON 49
ci_051                -2.732046e-03 3 1  ON 50
ci_052                -2.629427e-03 3 1  ON 51
ci_053                -3.127044e-03 3 1  ON 52
ci_054                -2.725668e-03 3 1  ON 53
ci_055                -2.384068e-03 3 1  ON 54
ci_056                -1.695604e-03 3 1  ON 55
ci_057                -2.018227e-03 3 1  ON 56
ci_058                -2.218897e-03 3 1  ON 57
ci_059                -2.239793e-03 3 1  ON 58
ci_060                -1.720774e-03 3 1  ON 59
ci_061                -1.784842e-03 3 1  ON 60
ci_062                -1.075971e-03 3 1  ON 61
ci_063                -1.013125e-03 3 1  ON 62
ci_064                -1.169174e-03 3 1  ON 63
ci_065                -1.166757e-03 3 1  ON 64
ci_066                -1.085927e-03 3 1  ON 65
ci_067                -2.037372e-04 3 1  ON 66
ci_068                -9.582223e-04 3 1  ON 67
ci_069                 2.323122e-03 3 1  ON 68
ci_070                 1.279993e-03 3 1  ON 69
ci_071                -6.897893e-04 3 1  ON 70
ci_072                -1.095027e-03 3 1  ON 71
ci_073                 1.290230e-03 3 1  ON 72
ci_074                 1.238993e-03 3 1  ON 73
ci_075                -9.258822e-04 3 1  ON 74
ci_076                -9.601228e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6039e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2307e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.3134
    reference variance = 3.91204
====================================================
  Execution time = 2.6378e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0327e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7352e+00
  Total weights = 1.949990693e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9508e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780762376227
                                         uncertainty =       0.036964102402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.780762376227
                                         uncertainty =       0.036964102402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375346011
  error estimate for blocks of size 2^( 2) =       0.001446292698
  error estimate for blocks of size 2^( 3) =       0.001509170724
  error estimate for blocks of size 2^( 4) =       0.001551835476
  error estimate for blocks of size 2^( 5) =       0.001574530700
  error estimate for blocks of size 2^( 6) =       0.001583886073
  error estimate for blocks of size 2^( 7) =       0.001593655922

      target function =                  N/A
              le_mean =     -22.328668779329
             les_mean =     502.304604162870
             stat err =       0.001575977043
             autocorr =       1.313033568969
              std dev =       1.945064102092
             le_variance =       3.783274361246


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232866877933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e-01, overlap shift 2.0680e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328668778490       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328712232967       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328713520792       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328713066249       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328713049135       residual = 6.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e-01 is 1.128161e-03

solving harmonic davidson linear method for identity shift 8.2718e-01, overlap shift 8.2718e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328668778490       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328685630960       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328685722721       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e-01 is 4.218045e-04

solving harmonic davidson linear method for identity shift 3.3087e+00, overlap shift 3.3087e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328668778490       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328673665059       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328673660194       residual = 5.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+00 is 1.279988e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215292 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2341e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -6.868836e-01 3 1  ON 0
ci_002                -7.139268e-01 3 1  ON 1
ci_003                -6.119082e-02 3 1  ON 2
ci_004                -6.201359e-02 3 1  ON 3
ci_005                 4.517213e-02 3 1  ON 4
ci_006                 4.665189e-02 3 1  ON 5
ci_007                 3.127006e-02 3 1  ON 6
ci_008                 3.234498e-02 3 1  ON 7
ci_009                -2.492221e-02 3 1  ON 8
ci_010                -2.556454e-02 3 1  ON 9
ci_011                -2.230041e-02 3 1  ON 10
ci_012                -2.291840e-02 3 1  ON 11
ci_013                 1.922992e-02 3 1  ON 12
ci_014                 2.136193e-02 3 1  ON 13
ci_015                 2.077428e-02 3 1  ON 14
ci_016                 2.057436e-02 3 1  ON 15
ci_017                 1.525077e-02 3 1  ON 16
ci_018                 1.539197e-02 3 1  ON 17
ci_019                 9.973343e-03 3 1  ON 18
ci_020                 9.343222e-03 3 1  ON 19
ci_021                -8.922878e-03 3 1  ON 20
ci_022                -1.031809e-02 3 1  ON 21
ci_023                 9.121310e-03 3 1  ON 22
ci_024                 8.656976e-03 3 1  ON 23
ci_025                 7.576633e-03 3 1  ON 24
ci_026                 8.131190e-03 3 1  ON 25
ci_027                 7.899190e-03 3 1  ON 26
ci_028                 7.634558e-03 3 1  ON 27
ci_029                -8.054183e-03 3 1  ON 28
ci_030                -7.920981e-03 3 1  ON 29
ci_031                -7.304066e-03 3 1  ON 30
ci_032                -7.931229e-03 3 1  ON 31
ci_033                 6.491185e-03 3 1  ON 32
ci_034                 7.355600e-03 3 1  ON 33
ci_035                 5.888918e-03 3 1  ON 34
ci_036                 6.956210e-03 3 1  ON 35
ci_037                 6.366469e-03 3 1  ON 36
ci_038                 6.521428e-03 3 1  ON 37
ci_039                 5.624040e-03 3 1  ON 38
ci_040                 6.044583e-03 3 1  ON 39
ci_041                 4.721712e-03 3 1  ON 40
ci_042                 5.246700e-03 3 1  ON 41
ci_043                 4.894059e-03 3 1  ON 42
ci_044                 5.267434e-03 3 1  ON 43
ci_045                 5.394443e-03 3 1  ON 44
ci_046                 5.326783e-03 3 1  ON 45
ci_047                -4.475696e-03 3 1  ON 46
ci_048                -4.285195e-03 3 1  ON 47
ci_049                 2.681280e-03 3 1  ON 48
ci_050                 3.633575e-03 3 1  ON 49
ci_051                -2.816091e-03 3 1  ON 50
ci_052                -2.741221e-03 3 1  ON 51
ci_053                -3.171533e-03 3 1  ON 52
ci_054                -2.519098e-03 3 1  ON 53
ci_055                -2.687666e-03 3 1  ON 54
ci_056                -1.505500e-03 3 1  ON 55
ci_057                -1.774421e-03 3 1  ON 56
ci_058                -1.890324e-03 3 1  ON 57
ci_059                -2.298029e-03 3 1  ON 58
ci_060                -1.740239e-03 3 1  ON 59
ci_061                -2.013805e-03 3 1  ON 60
ci_062                -1.147964e-03 3 1  ON 61
ci_063                -8.676272e-04 3 1  ON 62
ci_064                -1.100809e-03 3 1  ON 63
ci_065                -1.191679e-03 3 1  ON 64
ci_066                -1.250788e-03 3 1  ON 65
ci_067                -5.955358e-04 3 1  ON 66
ci_068                -1.109083e-03 3 1  ON 67
ci_069                 2.232976e-03 3 1  ON 68
ci_070                 1.314115e-03 3 1  ON 69
ci_071                -9.763076e-04 3 1  ON 70
ci_072                -1.029054e-03 3 1  ON 71
ci_073                 1.393424e-03 3 1  ON 72
ci_074                 1.391942e-03 3 1  ON 73
ci_075                -8.493823e-04 3 1  ON 74
ci_076                -7.292700e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.1133
    reference variance = 3.22495
====================================================
  Execution time = 2.3622e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7277e+00
  Total weights = 1.9499e+06
  Execution time = 4.3753e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764012968610
                                         uncertainty =       0.028679099947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764012968610
                                         uncertainty =       0.028679099947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371773976
  error estimate for blocks of size 2^( 2) =       0.001442162477
  error estimate for blocks of size 2^( 3) =       0.001505958754
  error estimate for blocks of size 2^( 4) =       0.001550389125
  error estimate for blocks of size 2^( 5) =       0.001570887500
  error estimate for blocks of size 2^( 6) =       0.001580544241
  error estimate for blocks of size 2^( 7) =       0.001581501762

      target function =                  N/A
              le_mean =     -22.328479267964
             les_mean =     502.537425479720
             stat err =       0.001570830657
             autocorr =       1.311274507653
              std dev =       1.940012400352
             le_variance =       3.763648113518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764980080245
                                         uncertainty =       0.028996920450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764980080245
                                         uncertainty =       0.028996920450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371949805
  error estimate for blocks of size 2^( 2) =       0.001442307154
  error estimate for blocks of size 2^( 3) =       0.001505995143
  error estimate for blocks of size 2^( 4) =       0.001550422711
  error estimate for blocks of size 2^( 5) =       0.001570982517
  error estimate for blocks of size 2^( 6) =       0.001580650429
  error estimate for blocks of size 2^( 7) =       0.001581594020

      target function =                  N/A
              le_mean =     -22.328509683357
             les_mean =     503.052257188661
             stat err =       0.001570912419
             autocorr =       1.311074895346
              std dev =       1.940261065001
             le_variance =       3.764613000358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764059306360
                                         uncertainty =       0.028736570583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764059306360
                                         uncertainty =       0.028736570583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371782511
  error estimate for blocks of size 2^( 2) =       0.001442155033
  error estimate for blocks of size 2^( 3) =       0.001505863437
  error estimate for blocks of size 2^( 4) =       0.001550297845
  error estimate for blocks of size 2^( 5) =       0.001570748128
  error estimate for blocks of size 2^( 6) =       0.001580410724
  error estimate for blocks of size 2^( 7) =       0.001581359652

      target function =                  N/A
              le_mean =     -22.328498778339
             les_mean =     502.468326497231
             stat err =       0.001570704087
             autocorr =       1.311046888086
              std dev =       1.940024471949
             le_variance =       3.763694951761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763756438603
                                         uncertainty =       0.028704260124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.763756438603
                                         uncertainty =       0.028704260124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371727279
  error estimate for blocks of size 2^( 2) =       0.001442117157
  error estimate for blocks of size 2^( 3) =       0.001505851167
  error estimate for blocks of size 2^( 4) =       0.001550303295
  error estimate for blocks of size 2^( 5) =       0.001570814510
  error estimate for blocks of size 2^( 6) =       0.001580465795
  error estimate for blocks of size 2^( 7) =       0.001581409434

      target function =                  N/A
              le_mean =     -22.328489629676
             les_mean =     502.291172242995
             stat err =       0.001570748259
             autocorr =       1.311226214240
              std dev =       1.939946360063
             le_variance =       3.763391879922


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328479267964        initial
     2.0680e-01     2.0680e+00             1.1282e-03       -22.328509683357  <--
     8.2718e-01     8.2718e+00             4.2180e-04       -22.328498778339
     3.3087e+00     3.3087e+01             1.2800e-04       -22.328489629676

*****************************************************************************
Applying the update for shift_i =   2.0680e-01     and shift_s =   2.0680e+00
*****************************************************************************

  Execution time = 4.5542e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -6.868076e-01 3 1  ON 0
ci_002                -7.138869e-01 3 1  ON 1
ci_003                -6.090215e-02 3 1  ON 2
ci_004                -6.254088e-02 3 1  ON 3
ci_005                 4.504650e-02 3 1  ON 4
ci_006                 4.722396e-02 3 1  ON 5
ci_007                 3.116572e-02 3 1  ON 6
ci_008                 3.240940e-02 3 1  ON 7
ci_009                -2.563937e-02 3 1  ON 8
ci_010                -2.582466e-02 3 1  ON 9
ci_011                -2.199917e-02 3 1  ON 10
ci_012                -2.327846e-02 3 1  ON 11
ci_013                 1.944341e-02 3 1  ON 12
ci_014                 2.135510e-02 3 1  ON 13
ci_015                 2.113963e-02 3 1  ON 14
ci_016                 2.049874e-02 3 1  ON 15
ci_017                 1.485651e-02 3 1  ON 16
ci_018                 1.588962e-02 3 1  ON 17
ci_019                 9.902694e-03 3 1  ON 18
ci_020                 9.730893e-03 3 1  ON 19
ci_021                -9.185121e-03 3 1  ON 20
ci_022                -1.062187e-02 3 1  ON 21
ci_023                 9.191724e-03 3 1  ON 22
ci_024                 8.559908e-03 3 1  ON 23
ci_025                 7.613018e-03 3 1  ON 24
ci_026                 8.152674e-03 3 1  ON 25
ci_027                 7.763847e-03 3 1  ON 26
ci_028                 7.865261e-03 3 1  ON 27
ci_029                -8.335359e-03 3 1  ON 28
ci_030                -7.926868e-03 3 1  ON 29
ci_031                -7.447845e-03 3 1  ON 30
ci_032                -8.045946e-03 3 1  ON 31
ci_033                 6.271587e-03 3 1  ON 32
ci_034                 7.171373e-03 3 1  ON 33
ci_035                 5.971737e-03 3 1  ON 34
ci_036                 6.979799e-03 3 1  ON 35
ci_037                 6.613104e-03 3 1  ON 36
ci_038                 6.249904e-03 3 1  ON 37
ci_039                 5.468870e-03 3 1  ON 38
ci_040                 6.034421e-03 3 1  ON 39
ci_041                 4.916694e-03 3 1  ON 40
ci_042                 4.968869e-03 3 1  ON 41
ci_043                 4.740299e-03 3 1  ON 42
ci_044                 5.324724e-03 3 1  ON 43
ci_045                 5.464508e-03 3 1  ON 44
ci_046                 5.249201e-03 3 1  ON 45
ci_047                -4.532331e-03 3 1  ON 46
ci_048                -4.400048e-03 3 1  ON 47
ci_049                 2.301774e-03 3 1  ON 48
ci_050                 3.912557e-03 3 1  ON 49
ci_051                -2.906136e-03 3 1  ON 50
ci_052                -2.943574e-03 3 1  ON 51
ci_053                -3.250931e-03 3 1  ON 52
ci_054                -2.162612e-03 3 1  ON 53
ci_055                -3.199925e-03 3 1  ON 54
ci_056                -1.110670e-03 3 1  ON 55
ci_057                -1.412003e-03 3 1  ON 56
ci_058                -1.388334e-03 3 1  ON 57
ci_059                -2.368980e-03 3 1  ON 58
ci_060                -1.783877e-03 3 1  ON 59
ci_061                -2.377044e-03 3 1  ON 60
ci_062                -1.261901e-03 3 1  ON 61
ci_063                -6.257134e-04 3 1  ON 62
ci_064                -1.003197e-03 3 1  ON 63
ci_065                -1.231165e-03 3 1  ON 64
ci_066                -1.521326e-03 3 1  ON 65
ci_067                -1.191128e-03 3 1  ON 66
ci_068                -1.398598e-03 3 1  ON 67
ci_069                 2.090668e-03 3 1  ON 68
ci_070                 1.377939e-03 3 1  ON 69
ci_071                -1.413306e-03 3 1  ON 70
ci_072                -9.042201e-04 3 1  ON 71
ci_073                 1.514319e-03 3 1  ON 72
ci_074                 1.580754e-03 3 1  ON 73
ci_075                -7.221142e-04 3 1  ON 74
ci_076                -3.733560e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7900e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2306e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.0287
    reference variance = 4.44108
====================================================
  Execution time = 2.4269e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0299e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7368e+00
  Total weights = 1.950039843e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8518e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785149281856
                                         uncertainty =       0.027535675715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.785149281856
                                         uncertainty =       0.027535675715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375616239
  error estimate for blocks of size 2^( 2) =       0.001445466105
  error estimate for blocks of size 2^( 3) =       0.001507447180
  error estimate for blocks of size 2^( 4) =       0.001548624419
  error estimate for blocks of size 2^( 5) =       0.001574891157
  error estimate for blocks of size 2^( 6) =       0.001582819225
  error estimate for blocks of size 2^( 7) =       0.001592010345

      target function =                  N/A
              le_mean =     -22.326999288181
             les_mean =     502.231679680402
             stat err =       0.001574586287
             autocorr =       1.310202252187
              std dev =       1.945446268168
             le_variance =       3.784761182327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232699928818e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e-02, overlap shift 5.1699e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326999287390       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327073907623       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327081062531       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327083071592       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327086002082       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.327085921791       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.327086103684       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.327086030644       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e-02 is 3.155554e-03

solving harmonic davidson linear method for identity shift 2.0680e-01, overlap shift 2.0680e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326999287390       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327044904775       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327046744755       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327046869016       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.327046997669       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e-01 is 1.262168e-03

solving harmonic davidson linear method for identity shift 8.2718e-01, overlap shift 8.2718e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326999287390       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327017143573       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327017368497       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327017374919       residual = 1.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e-01 is 5.029839e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0132e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -6.876433e-01 3 1  ON 0
ci_002                -7.132247e-01 3 1  ON 1
ci_003                -6.030749e-02 3 1  ON 2
ci_004                -6.254125e-02 3 1  ON 3
ci_005                 4.454361e-02 3 1  ON 4
ci_006                 4.664189e-02 3 1  ON 5
ci_007                 3.074931e-02 3 1  ON 6
ci_008                 3.319405e-02 3 1  ON 7
ci_009                -2.486933e-02 3 1  ON 8
ci_010                -2.490293e-02 3 1  ON 9
ci_011                -2.173087e-02 3 1  ON 10
ci_012                -2.346904e-02 3 1  ON 11
ci_013                 2.002307e-02 3 1  ON 12
ci_014                 2.151976e-02 3 1  ON 13
ci_015                 2.031100e-02 3 1  ON 14
ci_016                 2.097604e-02 3 1  ON 15
ci_017                 1.427467e-02 3 1  ON 16
ci_018                 1.560565e-02 3 1  ON 17
ci_019                 1.062499e-02 3 1  ON 18
ci_020                 9.871418e-03 3 1  ON 19
ci_021                -9.713180e-03 3 1  ON 20
ci_022                -1.008794e-02 3 1  ON 21
ci_023                 8.998929e-03 3 1  ON 22
ci_024                 9.822076e-03 3 1  ON 23
ci_025                 7.747410e-03 3 1  ON 24
ci_026                 8.181929e-03 3 1  ON 25
ci_027                 8.080259e-03 3 1  ON 26
ci_028                 8.203806e-03 3 1  ON 27
ci_029                -7.939509e-03 3 1  ON 28
ci_030                -8.064421e-03 3 1  ON 29
ci_031                -7.481609e-03 3 1  ON 30
ci_032                -6.870010e-03 3 1  ON 31
ci_033                 6.346075e-03 3 1  ON 32
ci_034                 6.754443e-03 3 1  ON 33
ci_035                 5.839989e-03 3 1  ON 34
ci_036                 6.827282e-03 3 1  ON 35
ci_037                 7.003099e-03 3 1  ON 36
ci_038                 6.165390e-03 3 1  ON 37
ci_039                 5.667336e-03 3 1  ON 38
ci_040                 6.481534e-03 3 1  ON 39
ci_041                 5.117147e-03 3 1  ON 40
ci_042                 4.539364e-03 3 1  ON 41
ci_043                 5.571861e-03 3 1  ON 42
ci_044                 5.297237e-03 3 1  ON 43
ci_045                 5.411459e-03 3 1  ON 44
ci_046                 5.679436e-03 3 1  ON 45
ci_047                -4.909798e-03 3 1  ON 46
ci_048                -4.993752e-03 3 1  ON 47
ci_049                 3.072902e-03 3 1  ON 48
ci_050                 4.753593e-03 3 1  ON 49
ci_051                -2.516387e-03 3 1  ON 50
ci_052                -3.259042e-03 3 1  ON 51
ci_053                -3.260480e-03 3 1  ON 52
ci_054                -1.899710e-03 3 1  ON 53
ci_055                -3.058473e-03 3 1  ON 54
ci_056                -1.408865e-03 3 1  ON 55
ci_057                -2.149391e-03 3 1  ON 56
ci_058                -1.713688e-03 3 1  ON 57
ci_059                -2.079140e-03 3 1  ON 58
ci_060                -1.575851e-03 3 1  ON 59
ci_061                -1.756302e-03 3 1  ON 60
ci_062                -1.070209e-03 3 1  ON 61
ci_063                -1.033447e-03 3 1  ON 62
ci_064                -5.460600e-04 3 1  ON 63
ci_065                -1.645103e-03 3 1  ON 64
ci_066                -1.120700e-03 3 1  ON 65
ci_067                -1.558938e-03 3 1  ON 66
ci_068                -9.475357e-04 3 1  ON 67
ci_069                 1.728264e-03 3 1  ON 68
ci_070                 1.295605e-03 3 1  ON 69
ci_071                -1.305402e-03 3 1  ON 70
ci_072                -1.703617e-03 3 1  ON 71
ci_073                 1.277951e-03 3 1  ON 72
ci_074                 1.429630e-03 3 1  ON 73
ci_075                -6.699063e-04 3 1  ON 74
ci_076                -8.233286e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.3916
    reference variance = 3.32869
====================================================
  Execution time = 2.3702e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 4.3847e+00
  Total weights = 1.9497e+06
  Execution time = 4.3999e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.455760723341
                                         uncertainty =       0.728980399128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.455760723341
                                         uncertainty =       0.728980399128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001492286470
  error estimate for blocks of size 2^( 2) =       0.001558315447
  error estimate for blocks of size 2^( 3) =       0.001616574066
  error estimate for blocks of size 2^( 4) =       0.001658408581
  error estimate for blocks of size 2^( 5) =       0.001666127696
  error estimate for blocks of size 2^( 6) =       0.001694533750
  error estimate for blocks of size 2^( 7) =       0.001688715076

      target function =                  N/A
              le_mean =     -22.329849070551
             les_mean =     503.044597543216
             stat err =       0.001676946276
             autocorr =       1.262798030026
              std dev =       2.110445531562
             le_variance =       4.453980341689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.455723204926
                                         uncertainty =       0.728973932718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.455723204926
                                         uncertainty =       0.728973932718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001492280819
  error estimate for blocks of size 2^( 2) =       0.001558331330
  error estimate for blocks of size 2^( 3) =       0.001616625451
  error estimate for blocks of size 2^( 4) =       0.001658499637
  error estimate for blocks of size 2^( 5) =       0.001666215240
  error estimate for blocks of size 2^( 6) =       0.001694673486
  error estimate for blocks of size 2^( 7) =       0.001688917503

      target function =                  N/A
              le_mean =     -22.329837008992
             les_mean =     503.025121164432
             stat err =       0.001677076467
             autocorr =       1.263003680469
              std dev =       2.110437538723
             le_variance =       4.453946604851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.455793545626
                                         uncertainty =       0.728971207507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.455793545626
                                         uncertainty =       0.728971207507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001492292476
  error estimate for blocks of size 2^( 2) =       0.001558353300
  error estimate for blocks of size 2^( 3) =       0.001616654282
  error estimate for blocks of size 2^( 4) =       0.001658547921
  error estimate for blocks of size 2^( 5) =       0.001666273640
  error estimate for blocks of size 2^( 6) =       0.001694728205
  error estimate for blocks of size 2^( 7) =       0.001688941485

      target function =                  N/A
              le_mean =     -22.329859376021
             les_mean =     503.017018763016
             stat err =       0.001677122813
             autocorr =       1.263053754478
              std dev =       2.110454024945
             le_variance =       4.454016191407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.455581973744
                                         uncertainty =       0.728978917857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       4.455581973744
                                         uncertainty =       0.728978917857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001492256614
  error estimate for blocks of size 2^( 2) =       0.001558290584
  error estimate for blocks of size 2^( 3) =       0.001616561349
  error estimate for blocks of size 2^( 4) =       0.001658408130
  error estimate for blocks of size 2^( 5) =       0.001666140993
  error estimate for blocks of size 2^( 6) =       0.001694560633
  error estimate for blocks of size 2^( 7) =       0.001688766414

      target function =                  N/A
              le_mean =     -22.329828566707
             les_mean =     503.009442028025
             stat err =       0.001676969042
             autocorr =       1.262882850975
              std dev =       2.110403307612
             le_variance =       4.453802120778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329849070551        initial
     5.1699e-02     5.1699e-01             3.1556e-03       -22.329837008992
     2.0680e-01     2.0680e+00             1.2622e-03       -22.329859376021  <--
     8.2718e-01     8.2718e+00             5.0298e-04       -22.329828566707

*****************************************************************************
Applying the update for shift_i =   2.0680e-01     and shift_s =   2.0680e+00
*****************************************************************************

  Execution time = 4.5782e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -6.876433e-01 3 1  ON 0
ci_002                -7.132247e-01 3 1  ON 1
ci_003                -6.030749e-02 3 1  ON 2
ci_004                -6.254125e-02 3 1  ON 3
ci_005                 4.454361e-02 3 1  ON 4
ci_006                 4.664189e-02 3 1  ON 5
ci_007                 3.074931e-02 3 1  ON 6
ci_008                 3.319405e-02 3 1  ON 7
ci_009                -2.486933e-02 3 1  ON 8
ci_010                -2.490293e-02 3 1  ON 9
ci_011                -2.173087e-02 3 1  ON 10
ci_012                -2.346904e-02 3 1  ON 11
ci_013                 2.002307e-02 3 1  ON 12
ci_014                 2.151976e-02 3 1  ON 13
ci_015                 2.031100e-02 3 1  ON 14
ci_016                 2.097604e-02 3 1  ON 15
ci_017                 1.427467e-02 3 1  ON 16
ci_018                 1.560565e-02 3 1  ON 17
ci_019                 1.062499e-02 3 1  ON 18
ci_020                 9.871418e-03 3 1  ON 19
ci_021                -9.713180e-03 3 1  ON 20
ci_022                -1.008794e-02 3 1  ON 21
ci_023                 8.998929e-03 3 1  ON 22
ci_024                 9.822076e-03 3 1  ON 23
ci_025                 7.747410e-03 3 1  ON 24
ci_026                 8.181929e-03 3 1  ON 25
ci_027                 8.080259e-03 3 1  ON 26
ci_028                 8.203806e-03 3 1  ON 27
ci_029                -7.939509e-03 3 1  ON 28
ci_030                -8.064421e-03 3 1  ON 29
ci_031                -7.481609e-03 3 1  ON 30
ci_032                -6.870010e-03 3 1  ON 31
ci_033                 6.346075e-03 3 1  ON 32
ci_034                 6.754443e-03 3 1  ON 33
ci_035                 5.839989e-03 3 1  ON 34
ci_036                 6.827282e-03 3 1  ON 35
ci_037                 7.003099e-03 3 1  ON 36
ci_038                 6.165390e-03 3 1  ON 37
ci_039                 5.667336e-03 3 1  ON 38
ci_040                 6.481534e-03 3 1  ON 39
ci_041                 5.117147e-03 3 1  ON 40
ci_042                 4.539364e-03 3 1  ON 41
ci_043                 5.571861e-03 3 1  ON 42
ci_044                 5.297237e-03 3 1  ON 43
ci_045                 5.411459e-03 3 1  ON 44
ci_046                 5.679436e-03 3 1  ON 45
ci_047                -4.909798e-03 3 1  ON 46
ci_048                -4.993752e-03 3 1  ON 47
ci_049                 3.072902e-03 3 1  ON 48
ci_050                 4.753593e-03 3 1  ON 49
ci_051                -2.516387e-03 3 1  ON 50
ci_052                -3.259042e-03 3 1  ON 51
ci_053                -3.260480e-03 3 1  ON 52
ci_054                -1.899710e-03 3 1  ON 53
ci_055                -3.058473e-03 3 1  ON 54
ci_056                -1.408865e-03 3 1  ON 55
ci_057                -2.149391e-03 3 1  ON 56
ci_058                -1.713688e-03 3 1  ON 57
ci_059                -2.079140e-03 3 1  ON 58
ci_060                -1.575851e-03 3 1  ON 59
ci_061                -1.756302e-03 3 1  ON 60
ci_062                -1.070209e-03 3 1  ON 61
ci_063                -1.033447e-03 3 1  ON 62
ci_064                -5.460600e-04 3 1  ON 63
ci_065                -1.645103e-03 3 1  ON 64
ci_066                -1.120700e-03 3 1  ON 65
ci_067                -1.558938e-03 3 1  ON 66
ci_068                -9.475357e-04 3 1  ON 67
ci_069                 1.728264e-03 3 1  ON 68
ci_070                 1.295605e-03 3 1  ON 69
ci_071                -1.305402e-03 3 1  ON 70
ci_072                -1.703617e-03 3 1  ON 71
ci_073                 1.277951e-03 3 1  ON 72
ci_074                 1.429630e-03 3 1  ON 73
ci_075                -6.699063e-04 3 1  ON 74
ci_076                -8.233286e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5932e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2305e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.1722
    reference variance = 9.01363
====================================================
  Execution time = 2.4420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0308e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7070e+00
  Total weights = 1.949776227e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8929e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759959977491
                                         uncertainty =       0.030340686826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759959977491
                                         uncertainty =       0.030340686826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370994976
  error estimate for blocks of size 2^( 2) =       0.001442926286
  error estimate for blocks of size 2^( 3) =       0.001506532713
  error estimate for blocks of size 2^( 4) =       0.001549377705
  error estimate for blocks of size 2^( 5) =       0.001574145521
  error estimate for blocks of size 2^( 6) =       0.001589676875
  error estimate for blocks of size 2^( 7) =       0.001600885770

      target function =                  N/A
              le_mean =     -22.326156163255
             les_mean =     502.164274536350
             stat err =       0.001578521468
             autocorr =       1.325651167918
              std dev =       1.938910710427
             le_variance =       3.759374743009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232615616326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e-02, overlap shift 5.1699e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326156162443       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326242126076       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326251197489       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326253054452       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326256306680       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326256802430       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.326256811248       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.326256814606       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e-02 is 3.575114e-03

solving harmonic davidson linear method for identity shift 2.0680e-01, overlap shift 2.0680e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326156162443       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326207912924       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326209818447       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326209717182       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326209892868       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e-01 is 1.321412e-03

solving harmonic davidson linear method for identity shift 8.2718e-01, overlap shift 8.2718e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326156162443       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326176127852       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326176220339       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326176203384       residual = 1.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e-01 is 4.911860e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224341 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0325e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -6.867414e-01 3 1  ON 0
ci_002                -7.140987e-01 3 1  ON 1
ci_003                -5.965232e-02 3 1  ON 2
ci_004                -6.206752e-02 3 1  ON 3
ci_005                 4.476479e-02 3 1  ON 4
ci_006                 4.660617e-02 3 1  ON 5
ci_007                 3.083872e-02 3 1  ON 6
ci_008                 3.330426e-02 3 1  ON 7
ci_009                -2.456517e-02 3 1  ON 8
ci_010                -2.535955e-02 3 1  ON 9
ci_011                -2.294684e-02 3 1  ON 10
ci_012                -2.323595e-02 3 1  ON 11
ci_013                 2.049813e-02 3 1  ON 12
ci_014                 2.146453e-02 3 1  ON 13
ci_015                 2.102370e-02 3 1  ON 14
ci_016                 2.173745e-02 3 1  ON 15
ci_017                 1.454788e-02 3 1  ON 16
ci_018                 1.525782e-02 3 1  ON 17
ci_019                 1.015889e-02 3 1  ON 18
ci_020                 1.021272e-02 3 1  ON 19
ci_021                -9.667705e-03 3 1  ON 20
ci_022                -1.038514e-02 3 1  ON 21
ci_023                 8.783973e-03 3 1  ON 22
ci_024                 9.273467e-03 3 1  ON 23
ci_025                 8.077377e-03 3 1  ON 24
ci_026                 8.491017e-03 3 1  ON 25
ci_027                 7.962453e-03 3 1  ON 26
ci_028                 7.928468e-03 3 1  ON 27
ci_029                -7.572956e-03 3 1  ON 28
ci_030                -7.452040e-03 3 1  ON 29
ci_031                -7.899582e-03 3 1  ON 30
ci_032                -7.439773e-03 3 1  ON 31
ci_033                 6.494131e-03 3 1  ON 32
ci_034                 7.133318e-03 3 1  ON 33
ci_035                 6.306814e-03 3 1  ON 34
ci_036                 6.992081e-03 3 1  ON 35
ci_037                 6.704617e-03 3 1  ON 36
ci_038                 6.087670e-03 3 1  ON 37
ci_039                 5.542835e-03 3 1  ON 38
ci_040                 5.922293e-03 3 1  ON 39
ci_041                 5.306922e-03 3 1  ON 40
ci_042                 5.147985e-03 3 1  ON 41
ci_043                 5.351719e-03 3 1  ON 42
ci_044                 4.906099e-03 3 1  ON 43
ci_045                 5.645565e-03 3 1  ON 44
ci_046                 4.854833e-03 3 1  ON 45
ci_047                -4.889097e-03 3 1  ON 46
ci_048                -5.086514e-03 3 1  ON 47
ci_049                 2.604509e-03 3 1  ON 48
ci_050                 4.202346e-03 3 1  ON 49
ci_051                -2.350660e-03 3 1  ON 50
ci_052                -2.758607e-03 3 1  ON 51
ci_053                -2.798250e-03 3 1  ON 52
ci_054                -2.424276e-03 3 1  ON 53
ci_055                -3.214823e-03 3 1  ON 54
ci_056                -1.173378e-03 3 1  ON 55
ci_057                -2.106260e-03 3 1  ON 56
ci_058                -2.585649e-03 3 1  ON 57
ci_059                -1.555422e-03 3 1  ON 58
ci_060                -1.581888e-03 3 1  ON 59
ci_061                -2.116569e-03 3 1  ON 60
ci_062                -1.695585e-03 3 1  ON 61
ci_063                -8.941323e-04 3 1  ON 62
ci_064                -1.867472e-03 3 1  ON 63
ci_065                -9.511486e-04 3 1  ON 64
ci_066                -1.791281e-03 3 1  ON 65
ci_067                -1.472234e-03 3 1  ON 66
ci_068                -1.457320e-03 3 1  ON 67
ci_069                 1.449795e-03 3 1  ON 68
ci_070                 1.709900e-03 3 1  ON 69
ci_071                -1.648372e-03 3 1  ON 70
ci_072                -1.779542e-03 3 1  ON 71
ci_073                 1.712221e-03 3 1  ON 72
ci_074                 1.325655e-03 3 1  ON 73
ci_075                -7.041696e-04 3 1  ON 74
ci_076                -9.287160e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -21.8974
    reference variance = 9.80737
====================================================
  Execution time = 2.3705e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7638e+00
  Total weights = 1.9500e+06
  Execution time = 4.3604e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815920588919
                                         uncertainty =       0.047556036677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815920588919
                                         uncertainty =       0.047556036677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381152855
  error estimate for blocks of size 2^( 2) =       0.001450720680
  error estimate for blocks of size 2^( 3) =       0.001512046651
  error estimate for blocks of size 2^( 4) =       0.001555397991
  error estimate for blocks of size 2^( 5) =       0.001582883470
  error estimate for blocks of size 2^( 6) =       0.001596855880
  error estimate for blocks of size 2^( 7) =       0.001601818514

      target function =                  N/A
              le_mean =     -22.325892930177
             les_mean =     502.212980778726
             stat err =       0.001584238964
             autocorr =       1.315703075739
              std dev =       1.953276350624
             le_variance =       3.815288501907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.816461132780
                                         uncertainty =       0.047541571990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.816461132780
                                         uncertainty =       0.047541571990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381250475
  error estimate for blocks of size 2^( 2) =       0.001450793916
  error estimate for blocks of size 2^( 3) =       0.001512112186
  error estimate for blocks of size 2^( 4) =       0.001555424420
  error estimate for blocks of size 2^( 5) =       0.001582887243
  error estimate for blocks of size 2^( 6) =       0.001596893513
  error estimate for blocks of size 2^( 7) =       0.001601893145

      target function =                  N/A
              le_mean =     -22.325885182709
             les_mean =     502.438596622100
             stat err =       0.001584274580
             autocorr =       1.315576257686
              std dev =       1.953414409170
             le_variance =       3.815827853955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818870433504
                                         uncertainty =       0.047532672434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.818870433504
                                         uncertainty =       0.047532672434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381684046
  error estimate for blocks of size 2^( 2) =       0.001451179484
  error estimate for blocks of size 2^( 3) =       0.001512480710
  error estimate for blocks of size 2^( 4) =       0.001555772646
  error estimate for blocks of size 2^( 5) =       0.001583271039
  error estimate for blocks of size 2^( 6) =       0.001597228427
  error estimate for blocks of size 2^( 7) =       0.001602406284

      target function =                  N/A
              le_mean =     -22.325904344168
             les_mean =     503.085862776539
             stat err =       0.001584669599
             autocorr =       1.315406448659
              std dev =       1.954027580787
             le_variance =       3.818223786476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815905193129
                                         uncertainty =       0.047559151154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815905193129
                                         uncertainty =       0.047559151154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381150055
  error estimate for blocks of size 2^( 2) =       0.001450712397
  error estimate for blocks of size 2^( 3) =       0.001512035039
  error estimate for blocks of size 2^( 4) =       0.001555385828
  error estimate for blocks of size 2^( 5) =       0.001582854569
  error estimate for blocks of size 2^( 6) =       0.001596819502
  error estimate for blocks of size 2^( 7) =       0.001601795144

      target function =                  N/A
              le_mean =     -22.325871557692
             les_mean =     502.539823121449
             stat err =       0.001584213761
             autocorr =       1.315666548739
              std dev =       1.953272390728
             le_variance =       3.815273032379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325892930177        initial
     5.1699e-02     5.1699e-01             3.5751e-03       -22.325885182709
     2.0680e-01     2.0680e+00             1.3214e-03       -22.325904344168  <--
     8.2718e-01     8.2718e+00             4.9119e-04       -22.325871557692

*****************************************************************************
Applying the update for shift_i =   2.0680e-01     and shift_s =   2.0680e+00
*****************************************************************************

  Execution time = 4.5700e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -6.867414e-01 3 1  ON 0
ci_002                -7.140987e-01 3 1  ON 1
ci_003                -5.965232e-02 3 1  ON 2
ci_004                -6.206752e-02 3 1  ON 3
ci_005                 4.476479e-02 3 1  ON 4
ci_006                 4.660617e-02 3 1  ON 5
ci_007                 3.083872e-02 3 1  ON 6
ci_008                 3.330426e-02 3 1  ON 7
ci_009                -2.456517e-02 3 1  ON 8
ci_010                -2.535955e-02 3 1  ON 9
ci_011                -2.294684e-02 3 1  ON 10
ci_012                -2.323595e-02 3 1  ON 11
ci_013                 2.049813e-02 3 1  ON 12
ci_014                 2.146453e-02 3 1  ON 13
ci_015                 2.102370e-02 3 1  ON 14
ci_016                 2.173745e-02 3 1  ON 15
ci_017                 1.454788e-02 3 1  ON 16
ci_018                 1.525782e-02 3 1  ON 17
ci_019                 1.015889e-02 3 1  ON 18
ci_020                 1.021272e-02 3 1  ON 19
ci_021                -9.667705e-03 3 1  ON 20
ci_022                -1.038514e-02 3 1  ON 21
ci_023                 8.783973e-03 3 1  ON 22
ci_024                 9.273467e-03 3 1  ON 23
ci_025                 8.077377e-03 3 1  ON 24
ci_026                 8.491017e-03 3 1  ON 25
ci_027                 7.962453e-03 3 1  ON 26
ci_028                 7.928468e-03 3 1  ON 27
ci_029                -7.572956e-03 3 1  ON 28
ci_030                -7.452040e-03 3 1  ON 29
ci_031                -7.899582e-03 3 1  ON 30
ci_032                -7.439773e-03 3 1  ON 31
ci_033                 6.494131e-03 3 1  ON 32
ci_034                 7.133318e-03 3 1  ON 33
ci_035                 6.306814e-03 3 1  ON 34
ci_036                 6.992081e-03 3 1  ON 35
ci_037                 6.704617e-03 3 1  ON 36
ci_038                 6.087670e-03 3 1  ON 37
ci_039                 5.542835e-03 3 1  ON 38
ci_040                 5.922293e-03 3 1  ON 39
ci_041                 5.306922e-03 3 1  ON 40
ci_042                 5.147985e-03 3 1  ON 41
ci_043                 5.351719e-03 3 1  ON 42
ci_044                 4.906099e-03 3 1  ON 43
ci_045                 5.645565e-03 3 1  ON 44
ci_046                 4.854833e-03 3 1  ON 45
ci_047                -4.889097e-03 3 1  ON 46
ci_048                -5.086514e-03 3 1  ON 47
ci_049                 2.604509e-03 3 1  ON 48
ci_050                 4.202346e-03 3 1  ON 49
ci_051                -2.350660e-03 3 1  ON 50
ci_052                -2.758607e-03 3 1  ON 51
ci_053                -2.798250e-03 3 1  ON 52
ci_054                -2.424276e-03 3 1  ON 53
ci_055                -3.214823e-03 3 1  ON 54
ci_056                -1.173378e-03 3 1  ON 55
ci_057                -2.106260e-03 3 1  ON 56
ci_058                -2.585649e-03 3 1  ON 57
ci_059                -1.555422e-03 3 1  ON 58
ci_060                -1.581888e-03 3 1  ON 59
ci_061                -2.116569e-03 3 1  ON 60
ci_062                -1.695585e-03 3 1  ON 61
ci_063                -8.941323e-04 3 1  ON 62
ci_064                -1.867472e-03 3 1  ON 63
ci_065                -9.511486e-04 3 1  ON 64
ci_066                -1.791281e-03 3 1  ON 65
ci_067                -1.472234e-03 3 1  ON 66
ci_068                -1.457320e-03 3 1  ON 67
ci_069                 1.449795e-03 3 1  ON 68
ci_070                 1.709900e-03 3 1  ON 69
ci_071                -1.648372e-03 3 1  ON 70
ci_072                -1.779542e-03 3 1  ON 71
ci_073                 1.712221e-03 3 1  ON 72
ci_074                 1.325655e-03 3 1  ON 73
ci_075                -7.041696e-04 3 1  ON 74
ci_076                -9.287160e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6040e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2302e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.5765
    reference variance = 2.54162
====================================================
  Execution time = 2.4275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0286e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6715e+00
  Total weights = 1.949704340e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9151e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.720464633124
                                         uncertainty =       0.029007026833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.720464633124
                                         uncertainty =       0.029007026833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364044880
  error estimate for blocks of size 2^( 2) =       0.001436359400
  error estimate for blocks of size 2^( 3) =       0.001500266936
  error estimate for blocks of size 2^( 4) =       0.001545346291
  error estimate for blocks of size 2^( 5) =       0.001571006127
  error estimate for blocks of size 2^( 6) =       0.001582886707
  error estimate for blocks of size 2^( 7) =       0.001586482795

      target function =                  N/A
              le_mean =     -22.328163627669
             les_mean =     502.218410494656
             stat err =       0.001571430480
             autocorr =       1.327189771149
              std dev =       1.929081632890
             le_variance =       3.721355946353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232816362767e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e-02, overlap shift 5.1699e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328163626816       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328247286537       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328258289175       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328259770246       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328259600581       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328259838397       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328259807288       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.328259659267       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e-02 is 2.118602e-03

solving harmonic davidson linear method for identity shift 2.0680e-01, overlap shift 2.0680e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328163626816       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328214218519       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328217245141       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328217380916       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328217345003       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e-01 is 1.056992e-03

solving harmonic davidson linear method for identity shift 8.2718e-01, overlap shift 8.2718e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328163626816       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328183227678       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328183497050       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328183500954       residual = 6.40e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e-01 is 3.953827e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228858 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0202e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -6.865566e-01 3 1  ON 0
ci_002                -7.144345e-01 3 1  ON 1
ci_003                -5.929831e-02 3 1  ON 2
ci_004                -6.121918e-02 3 1  ON 3
ci_005                 4.479987e-02 3 1  ON 4
ci_006                 4.652120e-02 3 1  ON 5
ci_007                 3.166479e-02 3 1  ON 6
ci_008                 3.270753e-02 3 1  ON 7
ci_009                -2.483759e-02 3 1  ON 8
ci_010                -2.560286e-02 3 1  ON 9
ci_011                -2.222546e-02 3 1  ON 10
ci_012                -2.316012e-02 3 1  ON 11
ci_013                 2.014996e-02 3 1  ON 12
ci_014                 2.198966e-02 3 1  ON 13
ci_015                 2.052726e-02 3 1  ON 14
ci_016                 2.159864e-02 3 1  ON 15
ci_017                 1.428165e-02 3 1  ON 16
ci_018                 1.547941e-02 3 1  ON 17
ci_019                 9.746326e-03 3 1  ON 18
ci_020                 1.102136e-02 3 1  ON 19
ci_021                -9.120609e-03 3 1  ON 20
ci_022                -9.742312e-03 3 1  ON 21
ci_023                 8.423973e-03 3 1  ON 22
ci_024                 9.326694e-03 3 1  ON 23
ci_025                 7.663077e-03 3 1  ON 24
ci_026                 8.207970e-03 3 1  ON 25
ci_027                 7.636316e-03 3 1  ON 26
ci_028                 7.931384e-03 3 1  ON 27
ci_029                -7.549368e-03 3 1  ON 28
ci_030                -7.853449e-03 3 1  ON 29
ci_031                -8.882649e-03 3 1  ON 30
ci_032                -7.681001e-03 3 1  ON 31
ci_033                 6.672755e-03 3 1  ON 32
ci_034                 6.766958e-03 3 1  ON 33
ci_035                 6.299171e-03 3 1  ON 34
ci_036                 6.654656e-03 3 1  ON 35
ci_037                 5.837668e-03 3 1  ON 36
ci_038                 6.472024e-03 3 1  ON 37
ci_039                 5.139594e-03 3 1  ON 38
ci_040                 5.496989e-03 3 1  ON 39
ci_041                 5.623173e-03 3 1  ON 40
ci_042                 5.015457e-03 3 1  ON 41
ci_043                 5.110626e-03 3 1  ON 42
ci_044                 5.168502e-03 3 1  ON 43
ci_045                 5.028721e-03 3 1  ON 44
ci_046                 4.727352e-03 3 1  ON 45
ci_047                -4.415784e-03 3 1  ON 46
ci_048                -4.537821e-03 3 1  ON 47
ci_049                 3.661501e-03 3 1  ON 48
ci_050                 4.278602e-03 3 1  ON 49
ci_051                -2.109313e-03 3 1  ON 50
ci_052                -3.383316e-03 3 1  ON 51
ci_053                -2.427078e-03 3 1  ON 52
ci_054                -2.493634e-03 3 1  ON 53
ci_055                -3.602162e-03 3 1  ON 54
ci_056                -1.593851e-03 3 1  ON 55
ci_057                -2.402492e-03 3 1  ON 56
ci_058                -1.846503e-03 3 1  ON 57
ci_059                -2.306089e-03 3 1  ON 58
ci_060                -1.252226e-03 3 1  ON 59
ci_061                -1.771963e-03 3 1  ON 60
ci_062                -1.585964e-03 3 1  ON 61
ci_063                -1.919337e-03 3 1  ON 62
ci_064                -2.138668e-03 3 1  ON 63
ci_065                -9.598423e-04 3 1  ON 64
ci_066                -7.961255e-04 3 1  ON 65
ci_067                -1.076073e-03 3 1  ON 66
ci_068                -1.106300e-03 3 1  ON 67
ci_069                 1.329743e-03 3 1  ON 68
ci_070                 1.049815e-03 3 1  ON 69
ci_071                -1.490184e-03 3 1  ON 70
ci_072                -1.427432e-03 3 1  ON 71
ci_073                 1.830007e-03 3 1  ON 72
ci_074                 1.207692e-03 3 1  ON 73
ci_075                -5.057958e-04 3 1  ON 74
ci_076                -8.710547e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.4026
    reference variance = 3.98461
====================================================
  Execution time = 2.3673e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7509e+00
  Total weights = 1.9499e+06
  Execution time = 4.3748e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805237226618
                                         uncertainty =       0.027885086423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.805237226618
                                         uncertainty =       0.027885086423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001379485705
  error estimate for blocks of size 2^( 2) =       0.001449025762
  error estimate for blocks of size 2^( 3) =       0.001512217144
  error estimate for blocks of size 2^( 4) =       0.001555067136
  error estimate for blocks of size 2^( 5) =       0.001581095534
  error estimate for blocks of size 2^( 6) =       0.001596633418
  error estimate for blocks of size 2^( 7) =       0.001599822720

      target function =                  N/A
              le_mean =     -22.329253450569
             les_mean =     502.633991243441
             stat err =       0.001583154702
             autocorr =       1.317080443762
              std dev =       1.950918607006
             le_variance =       3.806083411161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801927449248
                                         uncertainty =       0.027656396967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801927449248
                                         uncertainty =       0.027656396967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378886134
  error estimate for blocks of size 2^( 2) =       0.001448477414
  error estimate for blocks of size 2^( 3) =       0.001511731043
  error estimate for blocks of size 2^( 4) =       0.001554619791
  error estimate for blocks of size 2^( 5) =       0.001580589174
  error estimate for blocks of size 2^( 6) =       0.001596227918
  error estimate for blocks of size 2^( 7) =       0.001599215168

      target function =                  N/A
              le_mean =     -22.329291148130
             les_mean =     502.351843314340
             stat err =       0.001582663013
             autocorr =       1.317407395229
              std dev =       1.950070672082
             le_variance =       3.802775626112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801992559647
                                         uncertainty =       0.027656892987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.801992559647
                                         uncertainty =       0.027656892987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378898144
  error estimate for blocks of size 2^( 2) =       0.001448490018
  error estimate for blocks of size 2^( 3) =       0.001511740490
  error estimate for blocks of size 2^( 4) =       0.001554626988
  error estimate for blocks of size 2^( 5) =       0.001580595659
  error estimate for blocks of size 2^( 6) =       0.001596239192
  error estimate for blocks of size 2^( 7) =       0.001599247194

      target function =                  N/A
              le_mean =     -22.329312615903
             les_mean =     502.386105057023
             stat err =       0.001582677258
             autocorr =       1.317408162443
              std dev =       1.950087656608
             le_variance =       3.802841868455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.802000161749
                                         uncertainty =       0.027685553729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.802000161749
                                         uncertainty =       0.027685553729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001378899707
  error estimate for blocks of size 2^( 2) =       0.001448489886
  error estimate for blocks of size 2^( 3) =       0.001511734784
  error estimate for blocks of size 2^( 4) =       0.001554622347
  error estimate for blocks of size 2^( 5) =       0.001580591885
  error estimate for blocks of size 2^( 6) =       0.001596201468
  error estimate for blocks of size 2^( 7) =       0.001599039388

      target function =                  N/A
              le_mean =     -22.329289334950
             les_mean =     502.408551855552
             stat err =       0.001582613772
             autocorr =       1.317299486457
              std dev =       1.950089868042
             le_variance =       3.802850493440


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329253450569        initial
     5.1699e-02     5.1699e-01             2.1186e-03       -22.329291148130
     2.0680e-01     2.0680e+00             1.0570e-03       -22.329312615903  <--
     8.2718e-01     8.2718e+00             3.9538e-04       -22.329289334950

*****************************************************************************
Applying the update for shift_i =   2.0680e-01     and shift_s =   2.0680e+00
*****************************************************************************

  Execution time = 4.8569e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -6.865566e-01 3 1  ON 0
ci_002                -7.144345e-01 3 1  ON 1
ci_003                -5.929831e-02 3 1  ON 2
ci_004                -6.121918e-02 3 1  ON 3
ci_005                 4.479987e-02 3 1  ON 4
ci_006                 4.652120e-02 3 1  ON 5
ci_007                 3.166479e-02 3 1  ON 6
ci_008                 3.270753e-02 3 1  ON 7
ci_009                -2.483759e-02 3 1  ON 8
ci_010                -2.560286e-02 3 1  ON 9
ci_011                -2.222546e-02 3 1  ON 10
ci_012                -2.316012e-02 3 1  ON 11
ci_013                 2.014996e-02 3 1  ON 12
ci_014                 2.198966e-02 3 1  ON 13
ci_015                 2.052726e-02 3 1  ON 14
ci_016                 2.159864e-02 3 1  ON 15
ci_017                 1.428165e-02 3 1  ON 16
ci_018                 1.547941e-02 3 1  ON 17
ci_019                 9.746326e-03 3 1  ON 18
ci_020                 1.102136e-02 3 1  ON 19
ci_021                -9.120609e-03 3 1  ON 20
ci_022                -9.742312e-03 3 1  ON 21
ci_023                 8.423973e-03 3 1  ON 22
ci_024                 9.326694e-03 3 1  ON 23
ci_025                 7.663077e-03 3 1  ON 24
ci_026                 8.207970e-03 3 1  ON 25
ci_027                 7.636316e-03 3 1  ON 26
ci_028                 7.931384e-03 3 1  ON 27
ci_029                -7.549368e-03 3 1  ON 28
ci_030                -7.853449e-03 3 1  ON 29
ci_031                -8.882649e-03 3 1  ON 30
ci_032                -7.681001e-03 3 1  ON 31
ci_033                 6.672755e-03 3 1  ON 32
ci_034                 6.766958e-03 3 1  ON 33
ci_035                 6.299171e-03 3 1  ON 34
ci_036                 6.654656e-03 3 1  ON 35
ci_037                 5.837668e-03 3 1  ON 36
ci_038                 6.472024e-03 3 1  ON 37
ci_039                 5.139594e-03 3 1  ON 38
ci_040                 5.496989e-03 3 1  ON 39
ci_041                 5.623173e-03 3 1  ON 40
ci_042                 5.015457e-03 3 1  ON 41
ci_043                 5.110626e-03 3 1  ON 42
ci_044                 5.168502e-03 3 1  ON 43
ci_045                 5.028721e-03 3 1  ON 44
ci_046                 4.727352e-03 3 1  ON 45
ci_047                -4.415784e-03 3 1  ON 46
ci_048                -4.537821e-03 3 1  ON 47
ci_049                 3.661501e-03 3 1  ON 48
ci_050                 4.278602e-03 3 1  ON 49
ci_051                -2.109313e-03 3 1  ON 50
ci_052                -3.383316e-03 3 1  ON 51
ci_053                -2.427078e-03 3 1  ON 52
ci_054                -2.493634e-03 3 1  ON 53
ci_055                -3.602162e-03 3 1  ON 54
ci_056                -1.593851e-03 3 1  ON 55
ci_057                -2.402492e-03 3 1  ON 56
ci_058                -1.846503e-03 3 1  ON 57
ci_059                -2.306089e-03 3 1  ON 58
ci_060                -1.252226e-03 3 1  ON 59
ci_061                -1.771963e-03 3 1  ON 60
ci_062                -1.585964e-03 3 1  ON 61
ci_063                -1.919337e-03 3 1  ON 62
ci_064                -2.138668e-03 3 1  ON 63
ci_065                -9.598423e-04 3 1  ON 64
ci_066                -7.961255e-04 3 1  ON 65
ci_067                -1.076073e-03 3 1  ON 66
ci_068                -1.106300e-03 3 1  ON 67
ci_069                 1.329743e-03 3 1  ON 68
ci_070                 1.049815e-03 3 1  ON 69
ci_071                -1.490184e-03 3 1  ON 70
ci_072                -1.427432e-03 3 1  ON 71
ci_073                 1.830007e-03 3 1  ON 72
ci_074                 1.207692e-03 3 1  ON 73
ci_075                -5.057958e-04 3 1  ON 74
ci_076                -8.710547e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8785e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2304e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.2644
    reference variance = 2.34263
====================================================
  Execution time = 2.4242e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0326e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.9116e+00
  Total weights = 1.950046494e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8833e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.966475273836
                                         uncertainty =       0.239310898007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.966475273836
                                         uncertainty =       0.239310898007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408147406
  error estimate for blocks of size 2^( 2) =       0.001478440330
  error estimate for blocks of size 2^( 3) =       0.001539089183
  error estimate for blocks of size 2^( 4) =       0.001582317276
  error estimate for blocks of size 2^( 5) =       0.001605105832
  error estimate for blocks of size 2^( 6) =       0.001610001986
  error estimate for blocks of size 2^( 7) =       0.001617837476

      target function =                  N/A
              le_mean =     -22.328960449326
             les_mean =     502.494121945023
             stat err =       0.001603815642
             autocorr =       1.297217057573
              std dev =       1.991453022012
             le_variance =       3.965885138879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232896044933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e-02, overlap shift 5.1699e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328960448523       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329051775288       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329062188831       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329065339771       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329066554315       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329066565901       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.329066809265       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e-02 is 2.791894e-03

solving harmonic davidson linear method for identity shift 2.0680e-01, overlap shift 2.0680e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328960448523       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329015674574       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329018437793       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329018763975       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329018780698       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e-01 is 1.482461e-03

solving harmonic davidson linear method for identity shift 8.2718e-01, overlap shift 8.2718e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328960448523       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328981844080       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328982078417       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328982086313       residual = 1.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e-01 is 5.148261e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0136e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -6.860085e-01 3 1  ON 0
ci_002                -7.149634e-01 3 1  ON 1
ci_003                -5.940081e-02 3 1  ON 2
ci_004                -6.157589e-02 3 1  ON 3
ci_005                 4.511556e-02 3 1  ON 4
ci_006                 4.660307e-02 3 1  ON 5
ci_007                 3.148861e-02 3 1  ON 6
ci_008                 3.277510e-02 3 1  ON 7
ci_009                -2.549222e-02 3 1  ON 8
ci_010                -2.559819e-02 3 1  ON 9
ci_011                -2.191671e-02 3 1  ON 10
ci_012                -2.318157e-02 3 1  ON 11
ci_013                 1.892356e-02 3 1  ON 12
ci_014                 2.254201e-02 3 1  ON 13
ci_015                 1.984920e-02 3 1  ON 14
ci_016                 2.068289e-02 3 1  ON 15
ci_017                 1.411471e-02 3 1  ON 16
ci_018                 1.572250e-02 3 1  ON 17
ci_019                 1.039159e-02 3 1  ON 18
ci_020                 9.538894e-03 3 1  ON 19
ci_021                -8.840797e-03 3 1  ON 20
ci_022                -1.006093e-02 3 1  ON 21
ci_023                 8.438040e-03 3 1  ON 22
ci_024                 9.185146e-03 3 1  ON 23
ci_025                 8.706451e-03 3 1  ON 24
ci_026                 8.226295e-03 3 1  ON 25
ci_027                 7.503763e-03 3 1  ON 26
ci_028                 7.064520e-03 3 1  ON 27
ci_029                -7.599871e-03 3 1  ON 28
ci_030                -7.939666e-03 3 1  ON 29
ci_031                -8.027570e-03 3 1  ON 30
ci_032                -7.651292e-03 3 1  ON 31
ci_033                 7.153861e-03 3 1  ON 32
ci_034                 7.341469e-03 3 1  ON 33
ci_035                 6.312564e-03 3 1  ON 34
ci_036                 6.440252e-03 3 1  ON 35
ci_037                 6.135238e-03 3 1  ON 36
ci_038                 6.624220e-03 3 1  ON 37
ci_039                 5.268995e-03 3 1  ON 38
ci_040                 6.201994e-03 3 1  ON 39
ci_041                 5.129197e-03 3 1  ON 40
ci_042                 4.975155e-03 3 1  ON 41
ci_043                 4.842413e-03 3 1  ON 42
ci_044                 5.716728e-03 3 1  ON 43
ci_045                 5.134506e-03 3 1  ON 44
ci_046                 5.103996e-03 3 1  ON 45
ci_047                -3.978034e-03 3 1  ON 46
ci_048                -4.456902e-03 3 1  ON 47
ci_049                 3.189984e-03 3 1  ON 48
ci_050                 4.263301e-03 3 1  ON 49
ci_051                -2.420306e-03 3 1  ON 50
ci_052                -3.345684e-03 3 1  ON 51
ci_053                -2.269467e-03 3 1  ON 52
ci_054                -2.402437e-03 3 1  ON 53
ci_055                -3.764331e-03 3 1  ON 54
ci_056                -1.918703e-03 3 1  ON 55
ci_057                -2.266790e-03 3 1  ON 56
ci_058                -2.111613e-03 3 1  ON 57
ci_059                -1.988625e-03 3 1  ON 58
ci_060                -1.452390e-03 3 1  ON 59
ci_061                -1.298955e-03 3 1  ON 60
ci_062                -1.712435e-03 3 1  ON 61
ci_063                -2.059600e-03 3 1  ON 62
ci_064                -2.483169e-03 3 1  ON 63
ci_065                -7.946494e-04 3 1  ON 64
ci_066                -5.163348e-04 3 1  ON 65
ci_067                -5.404655e-04 3 1  ON 66
ci_068                -1.384094e-03 3 1  ON 67
ci_069                 6.594314e-04 3 1  ON 68
ci_070                 2.235260e-03 3 1  ON 69
ci_071                -1.255821e-03 3 1  ON 70
ci_072                -5.022312e-04 3 1  ON 71
ci_073                 1.208720e-03 3 1  ON 72
ci_074                 1.431033e-03 3 1  ON 73
ci_075                -5.286006e-04 3 1  ON 74
ci_076                -1.207260e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.558
    reference variance = 2.78295
====================================================
  Execution time = 2.3723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7069e+00
  Total weights = 1.9501e+06
  Execution time = 4.4136e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 6.74539e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758127128455
                                         uncertainty =       0.026043500888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.758127128455
                                         uncertainty =       0.026043500888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370906478
  error estimate for blocks of size 2^( 2) =       0.001442701602
  error estimate for blocks of size 2^( 3) =       0.001504790723
  error estimate for blocks of size 2^( 4) =       0.001547918700
  error estimate for blocks of size 2^( 5) =       0.001575798471
  error estimate for blocks of size 2^( 6) =       0.001587055024
  error estimate for blocks of size 2^( 7) =       0.001591404532

      target function =                  N/A
              le_mean =     -22.326703945365
             les_mean =     502.200994517736
             stat err =       0.001575544182
             autocorr =       1.320825713698
              std dev =       1.938785553917
             le_variance =       3.758889424079

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000104412
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757789785455
                                         uncertainty =       0.026061897385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757789785455
                                         uncertainty =       0.026061897385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370844879
  error estimate for blocks of size 2^( 2) =       0.001442647827
  error estimate for blocks of size 2^( 3) =       0.001504712926
  error estimate for blocks of size 2^( 4) =       0.001547835779
  error estimate for blocks of size 2^( 5) =       0.001575744869
  error estimate for blocks of size 2^( 6) =       0.001587010072
  error estimate for blocks of size 2^( 7) =       0.001591340465

      target function =                  N/A
              le_mean =     -22.326679200937
             les_mean =     502.188936150191
             stat err =       0.001575482796
             autocorr =       1.320841489075
              std dev =       1.938698438440
             le_variance =       3.758551635208

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 6.74308e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757860092659
                                         uncertainty =       0.026060858826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757860092659
                                         uncertainty =       0.026060858826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370857653
  error estimate for blocks of size 2^( 2) =       0.001442650980
  error estimate for blocks of size 2^( 3) =       0.001504707201
  error estimate for blocks of size 2^( 4) =       0.001547824394
  error estimate for blocks of size 2^( 5) =       0.001575747705
  error estimate for blocks of size 2^( 6) =       0.001586998346
  error estimate for blocks of size 2^( 7) =       0.001591321129

      target function =                  N/A
              le_mean =     -22.326684571671
             les_mean =     502.232425046151
             stat err =       0.001575472893
             autocorr =       1.320800270172
              std dev =       1.938716503339
             le_variance =       3.758621680319

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000111153
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757926812740
                                         uncertainty =       0.026048035228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.757926812740
                                         uncertainty =       0.026048035228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001370869906
  error estimate for blocks of size 2^( 2) =       0.001442666550
  error estimate for blocks of size 2^( 3) =       0.001504745983
  error estimate for blocks of size 2^( 4) =       0.001547880574
  error estimate for blocks of size 2^( 5) =       0.001575763643
  error estimate for blocks of size 2^( 6) =       0.001587033145
  error estimate for blocks of size 2^( 7) =       0.001591379599

      target function =                  N/A
              le_mean =     -22.326690669598
             les_mean =     502.199813936186
             stat err =       0.001575514240
             autocorr =       1.320845986166
              std dev =       1.938733831670
             le_variance =       3.758688870062


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326703945365        initial  <--
     5.1699e-02     5.1699e-01             2.7919e-03       -22.326679200937
     2.0680e-01     2.0680e+00             1.4825e-03       -22.326684571671
     8.2718e-01     8.2718e+00             5.1483e-04       -22.326690669598

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8817
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -6.865566e-01 3 1  ON 0
ci_002                -7.144345e-01 3 1  ON 1
ci_003                -5.929831e-02 3 1  ON 2
ci_004                -6.121918e-02 3 1  ON 3
ci_005                 4.479987e-02 3 1  ON 4
ci_006                 4.652120e-02 3 1  ON 5
ci_007                 3.166479e-02 3 1  ON 6
ci_008                 3.270753e-02 3 1  ON 7
ci_009                -2.483759e-02 3 1  ON 8
ci_010                -2.560286e-02 3 1  ON 9
ci_011                -2.222546e-02 3 1  ON 10
ci_012                -2.316012e-02 3 1  ON 11
ci_013                 2.014996e-02 3 1  ON 12
ci_014                 2.198966e-02 3 1  ON 13
ci_015                 2.052726e-02 3 1  ON 14
ci_016                 2.159864e-02 3 1  ON 15
ci_017                 1.428165e-02 3 1  ON 16
ci_018                 1.547941e-02 3 1  ON 17
ci_019                 9.746326e-03 3 1  ON 18
ci_020                 1.102136e-02 3 1  ON 19
ci_021                -9.120609e-03 3 1  ON 20
ci_022                -9.742312e-03 3 1  ON 21
ci_023                 8.423973e-03 3 1  ON 22
ci_024                 9.326694e-03 3 1  ON 23
ci_025                 7.663077e-03 3 1  ON 24
ci_026                 8.207970e-03 3 1  ON 25
ci_027                 7.636316e-03 3 1  ON 26
ci_028                 7.931384e-03 3 1  ON 27
ci_029                -7.549368e-03 3 1  ON 28
ci_030                -7.853449e-03 3 1  ON 29
ci_031                -8.882649e-03 3 1  ON 30
ci_032                -7.681001e-03 3 1  ON 31
ci_033                 6.672755e-03 3 1  ON 32
ci_034                 6.766958e-03 3 1  ON 33
ci_035                 6.299171e-03 3 1  ON 34
ci_036                 6.654656e-03 3 1  ON 35
ci_037                 5.837668e-03 3 1  ON 36
ci_038                 6.472024e-03 3 1  ON 37
ci_039                 5.139594e-03 3 1  ON 38
ci_040                 5.496989e-03 3 1  ON 39
ci_041                 5.623173e-03 3 1  ON 40
ci_042                 5.015457e-03 3 1  ON 41
ci_043                 5.110626e-03 3 1  ON 42
ci_044                 5.168502e-03 3 1  ON 43
ci_045                 5.028721e-03 3 1  ON 44
ci_046                 4.727352e-03 3 1  ON 45
ci_047                -4.415784e-03 3 1  ON 46
ci_048                -4.537821e-03 3 1  ON 47
ci_049                 3.661501e-03 3 1  ON 48
ci_050                 4.278602e-03 3 1  ON 49
ci_051                -2.109313e-03 3 1  ON 50
ci_052                -3.383316e-03 3 1  ON 51
ci_053                -2.427078e-03 3 1  ON 52
ci_054                -2.493634e-03 3 1  ON 53
ci_055                -3.602162e-03 3 1  ON 54
ci_056                -1.593851e-03 3 1  ON 55
ci_057                -2.402492e-03 3 1  ON 56
ci_058                -1.846503e-03 3 1  ON 57
ci_059                -2.306089e-03 3 1  ON 58
ci_060                -1.252226e-03 3 1  ON 59
ci_061                -1.771963e-03 3 1  ON 60
ci_062                -1.585964e-03 3 1  ON 61
ci_063                -1.919337e-03 3 1  ON 62
ci_064                -2.138668e-03 3 1  ON 63
ci_065                -9.598423e-04 3 1  ON 64
ci_066                -7.961255e-04 3 1  ON 65
ci_067                -1.076073e-03 3 1  ON 66
ci_068                -1.106300e-03 3 1  ON 67
ci_069                 1.329743e-03 3 1  ON 68
ci_070                 1.049815e-03 3 1  ON 69
ci_071                -1.490184e-03 3 1  ON 70
ci_072                -1.427432e-03 3 1  ON 71
ci_073                 1.830007e-03 3 1  ON 72
ci_074                 1.207692e-03 3 1  ON 73
ci_075                -5.057958e-04 3 1  ON 74
ci_076                -8.710547e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6032e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2305e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.5719
    reference variance = 2.56452
====================================================
  Execution time = 2.4338e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0313e+04
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7258e+00
  Total weights = 1.949781701e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8528e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777280306688
                                         uncertainty =       0.031262339288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.777280306688
                                         uncertainty =       0.031262339288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374181135
  error estimate for blocks of size 2^( 2) =       0.001445816712
  error estimate for blocks of size 2^( 3) =       0.001509768278
  error estimate for blocks of size 2^( 4) =       0.001553663333
  error estimate for blocks of size 2^( 5) =       0.001579190233
  error estimate for blocks of size 2^( 6) =       0.001595396543
  error estimate for blocks of size 2^( 7) =       0.001599357539

      target function =                  N/A
              le_mean =     -22.327958626811
             les_mean =     502.263491398000
             stat err =       0.001581901912
             autocorr =       1.325168602426
              std dev =       1.943416692462
             le_variance =       3.776868440539


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232795862681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e-01, overlap shift 5.1699e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327958626002       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327981864737       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327982713706       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.327982616829       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e-01 is 8.545328e-04

solving harmonic davidson linear method for identity shift 2.0680e+00, overlap shift 2.0680e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327958626002       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327965735691       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327965911676       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+00 is 2.461893e-04

solving harmonic davidson linear method for identity shift 8.2718e+00, overlap shift 8.2718e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.327958626002       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.327960508746       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.327960551157       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+00 is 6.413754e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0201e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -6.865051e-01 3 1  ON 0
ci_002                -7.144853e-01 3 1  ON 1
ci_003                -5.934588e-02 3 1  ON 2
ci_004                -6.124647e-02 3 1  ON 3
ci_005                 4.479274e-02 3 1  ON 4
ci_006                 4.657706e-02 3 1  ON 5
ci_007                 3.159329e-02 3 1  ON 6
ci_008                 3.277500e-02 3 1  ON 7
ci_009                -2.485676e-02 3 1  ON 8
ci_010                -2.555229e-02 3 1  ON 9
ci_011                -2.226394e-02 3 1  ON 10
ci_012                -2.315468e-02 3 1  ON 11
ci_013                 2.013073e-02 3 1  ON 12
ci_014                 2.191846e-02 3 1  ON 13
ci_015                 2.061179e-02 3 1  ON 14
ci_016                 2.135245e-02 3 1  ON 15
ci_017                 1.430149e-02 3 1  ON 16
ci_018                 1.560813e-02 3 1  ON 17
ci_019                 9.635641e-03 3 1  ON 18
ci_020                 1.083379e-02 3 1  ON 19
ci_021                -9.254807e-03 3 1  ON 20
ci_022                -9.872732e-03 3 1  ON 21
ci_023                 8.402948e-03 3 1  ON 22
ci_024                 9.248177e-03 3 1  ON 23
ci_025                 7.621153e-03 3 1  ON 24
ci_026                 8.210668e-03 3 1  ON 25
ci_027                 7.630423e-03 3 1  ON 26
ci_028                 7.923483e-03 3 1  ON 27
ci_029                -7.560193e-03 3 1  ON 28
ci_030                -7.840813e-03 3 1  ON 29
ci_031                -8.844971e-03 3 1  ON 30
ci_032                -7.613711e-03 3 1  ON 31
ci_033                 6.702114e-03 3 1  ON 32
ci_034                 6.754429e-03 3 1  ON 33
ci_035                 6.251839e-03 3 1  ON 34
ci_036                 6.621474e-03 3 1  ON 35
ci_037                 5.827870e-03 3 1  ON 36
ci_038                 6.510362e-03 3 1  ON 37
ci_039                 5.157656e-03 3 1  ON 38
ci_040                 5.578552e-03 3 1  ON 39
ci_041                 5.513376e-03 3 1  ON 40
ci_042                 5.031615e-03 3 1  ON 41
ci_043                 5.170689e-03 3 1  ON 42
ci_044                 5.181924e-03 3 1  ON 43
ci_045                 4.990078e-03 3 1  ON 44
ci_046                 4.811249e-03 3 1  ON 45
ci_047                -4.285763e-03 3 1  ON 46
ci_048                -4.516571e-03 3 1  ON 47
ci_049                 3.693977e-03 3 1  ON 48
ci_050                 4.299534e-03 3 1  ON 49
ci_051                -2.155198e-03 3 1  ON 50
ci_052                -3.308785e-03 3 1  ON 51
ci_053                -2.498304e-03 3 1  ON 52
ci_054                -2.457844e-03 3 1  ON 53
ci_055                -3.430657e-03 3 1  ON 54
ci_056                -1.640394e-03 3 1  ON 55
ci_057                -2.334145e-03 3 1  ON 56
ci_058                -1.825379e-03 3 1  ON 57
ci_059                -2.242825e-03 3 1  ON 58
ci_060                -1.313878e-03 3 1  ON 59
ci_061                -1.705729e-03 3 1  ON 60
ci_062                -1.592711e-03 3 1  ON 61
ci_063                -1.891234e-03 3 1  ON 62
ci_064                -2.082576e-03 3 1  ON 63
ci_065                -1.116000e-03 3 1  ON 64
ci_066                -8.540092e-04 3 1  ON 65
ci_067                -1.054919e-03 3 1  ON 66
ci_068                -1.108298e-03 3 1  ON 67
ci_069                 1.269047e-03 3 1  ON 68
ci_070                 1.056935e-03 3 1  ON 69
ci_071                -1.404893e-03 3 1  ON 70
ci_072                -1.321395e-03 3 1  ON 71
ci_073                 1.779554e-03 3 1  ON 72
ci_074                 1.212634e-03 3 1  ON 73
ci_075                -4.801942e-04 3 1  ON 74
ci_076                -8.845467e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.0527
    reference variance = 3.84782
====================================================
  Execution time = 2.3707e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.6940e+00
  Total weights = 1.9497e+06
  Execution time = 4.4111e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741650341127
                                         uncertainty =       0.031283681101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741650341127
                                         uncertainty =       0.031283681101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367811114
  error estimate for blocks of size 2^( 2) =       0.001439011138
  error estimate for blocks of size 2^( 3) =       0.001500411853
  error estimate for blocks of size 2^( 4) =       0.001543974117
  error estimate for blocks of size 2^( 5) =       0.001568577573
  error estimate for blocks of size 2^( 6) =       0.001581801661
  error estimate for blocks of size 2^( 7) =       0.001584376812

      target function =                  N/A
              le_mean =     -22.327521757445
             les_mean =     502.212555050431
             stat err =       0.001569682541
             autocorr =       1.316956406565
              std dev =       1.934407977261
             le_variance =       3.741934222493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741648903649
                                         uncertainty =       0.031282157832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741648903649
                                         uncertainty =       0.031282157832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367810837
  error estimate for blocks of size 2^( 2) =       0.001439010120
  error estimate for blocks of size 2^( 3) =       0.001500405045
  error estimate for blocks of size 2^( 4) =       0.001543962659
  error estimate for blocks of size 2^( 5) =       0.001568556228
  error estimate for blocks of size 2^( 6) =       0.001581779550
  error estimate for blocks of size 2^( 7) =       0.001584362956

      target function =                  N/A
              le_mean =     -22.327526578108
             les_mean =     502.213388637597
             stat err =       0.001569665348
             autocorr =       1.316928089715
              std dev =       1.934407586541
             le_variance =       3.741932710866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741641622749
                                         uncertainty =       0.031282399124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741641622749
                                         uncertainty =       0.031282399124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367809518
  error estimate for blocks of size 2^( 2) =       0.001439008810
  error estimate for blocks of size 2^( 3) =       0.001500406224
  error estimate for blocks of size 2^( 4) =       0.001543966051
  error estimate for blocks of size 2^( 5) =       0.001568563755
  error estimate for blocks of size 2^( 6) =       0.001581785301
  error estimate for blocks of size 2^( 7) =       0.001584364016

      target function =                  N/A
              le_mean =     -22.327523593803
             les_mean =     502.212360447734
             stat err =       0.001569669781
             autocorr =       1.316938068494
              std dev =       1.934405720313
             le_variance =       3.741925490780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741647714349
                                         uncertainty =       0.031283488004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.741647714349
                                         uncertainty =       0.031283488004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001367810633
  error estimate for blocks of size 2^( 2) =       0.001439010662
  error estimate for blocks of size 2^( 3) =       0.001500411126
  error estimate for blocks of size 2^( 4) =       0.001543973045
  error estimate for blocks of size 2^( 5) =       0.001568575867
  error estimate for blocks of size 2^( 6) =       0.001581799518
  error estimate for blocks of size 2^( 7) =       0.001584374947

      target function =                  N/A
              le_mean =     -22.327521797236
             les_mean =     502.212881472108
             stat err =       0.001569680844
             autocorr =       1.316954484375
              std dev =       1.934407298351
             le_variance =       3.741931595913


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327521757445        initial
     5.1699e-01     5.1699e+00             8.5453e-04       -22.327526578108  <--
     2.0680e+00     2.0680e+01             2.4619e-04       -22.327523593803
     8.2718e+00     8.2718e+01             6.4138e-05       -22.327521797236

*****************************************************************************
Applying the update for shift_i =   5.1699e-01     and shift_s =   5.1699e+00
*****************************************************************************

  Execution time = 4.5766e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -6.863497e-01 3 1  ON 0
ci_002                -7.146380e-01 3 1  ON 1
ci_003                -5.947399e-02 3 1  ON 2
ci_004                -6.132111e-02 3 1  ON 3
ci_005                 4.477081e-02 3 1  ON 4
ci_006                 4.668938e-02 3 1  ON 5
ci_007                 3.141931e-02 3 1  ON 6
ci_008                 3.291611e-02 3 1  ON 7
ci_009                -2.489985e-02 3 1  ON 8
ci_010                -2.543116e-02 3 1  ON 9
ci_011                -2.234896e-02 3 1  ON 10
ci_012                -2.315770e-02 3 1  ON 11
ci_013                 2.007753e-02 3 1  ON 12
ci_014                 2.175729e-02 3 1  ON 13
ci_015                 2.081360e-02 3 1  ON 14
ci_016                 2.074411e-02 3 1  ON 15
ci_017                 1.437377e-02 3 1  ON 16
ci_018                 1.590934e-02 3 1  ON 17
ci_019                 9.376713e-03 3 1  ON 18
ci_020                 1.038868e-02 3 1  ON 19
ci_021                -9.573452e-03 3 1  ON 20
ci_022                -1.018366e-02 3 1  ON 21
ci_023                 8.355971e-03 3 1  ON 22
ci_024                 9.077981e-03 3 1  ON 23
ci_025                 7.533802e-03 3 1  ON 24
ci_026                 8.236019e-03 3 1  ON 25
ci_027                 7.615710e-03 3 1  ON 26
ci_028                 7.902940e-03 3 1  ON 27
ci_029                -7.565412e-03 3 1  ON 28
ci_030                -7.805412e-03 3 1  ON 29
ci_031                -8.738880e-03 3 1  ON 30
ci_032                -7.443538e-03 3 1  ON 31
ci_033                 6.773275e-03 3 1  ON 32
ci_034                 6.707539e-03 3 1  ON 33
ci_035                 6.168795e-03 3 1  ON 34
ci_036                 6.552228e-03 3 1  ON 35
ci_037                 5.803638e-03 3 1  ON 36
ci_038                 6.592583e-03 3 1  ON 37
ci_039                 5.193254e-03 3 1  ON 38
ci_040                 5.733797e-03 3 1  ON 39
ci_041                 5.288615e-03 3 1  ON 40
ci_042                 5.064421e-03 3 1  ON 41
ci_043                 5.302170e-03 3 1  ON 42
ci_044                 5.214993e-03 3 1  ON 43
ci_045                 4.895778e-03 3 1  ON 44
ci_046                 4.994691e-03 3 1  ON 45
ci_047                -4.042266e-03 3 1  ON 46
ci_048                -4.484195e-03 3 1  ON 47
ci_049                 3.768574e-03 3 1  ON 48
ci_050                 4.349073e-03 3 1  ON 49
ci_051                -2.257700e-03 3 1  ON 50
ci_052                -3.153588e-03 3 1  ON 51
ci_053                -2.659139e-03 3 1  ON 52
ci_054                -2.381646e-03 3 1  ON 53
ci_055                -3.012844e-03 3 1  ON 54
ci_056                -1.753166e-03 3 1  ON 55
ci_057                -2.185013e-03 3 1  ON 56
ci_058                -1.779339e-03 3 1  ON 57
ci_059                -2.117810e-03 3 1  ON 58
ci_060                -1.422744e-03 3 1  ON 59
ci_061                -1.560446e-03 3 1  ON 60
ci_062                -1.631009e-03 3 1  ON 61
ci_063                -1.829370e-03 3 1  ON 62
ci_064                -1.960678e-03 3 1  ON 63
ci_065                -1.460547e-03 3 1  ON 64
ci_066                -9.812745e-04 3 1  ON 65
ci_067                -1.011295e-03 3 1  ON 66
ci_068                -1.103826e-03 3 1  ON 67
ci_069                 1.146830e-03 3 1  ON 68
ci_070                 1.072401e-03 3 1  ON 69
ci_071                -1.206588e-03 3 1  ON 70
ci_072                -1.088795e-03 3 1  ON 71
ci_073                 1.691534e-03 3 1  ON 72
ci_074                 1.218128e-03 3 1  ON 73
ci_075                -4.265769e-04 3 1  ON 74
ci_076                -9.080210e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5982e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2305e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.4265
    reference variance = 2.88881
====================================================
  Execution time = 2.4219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0314e+04
  VMC Eavg = -2.2332e+01
  VMC Evar = 3.6985e+00
  Total weights = 1.949689907e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8541e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751486703956
                                         uncertainty =       0.032319030365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.751486703956
                                         uncertainty =       0.032319030365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369469633
  error estimate for blocks of size 2^( 2) =       0.001440198839
  error estimate for blocks of size 2^( 3) =       0.001503415054
  error estimate for blocks of size 2^( 4) =       0.001546926183
  error estimate for blocks of size 2^( 5) =       0.001567675679
  error estimate for blocks of size 2^( 6) =       0.001576214016
  error estimate for blocks of size 2^( 7) =       0.001582903357

      target function =                  N/A
              le_mean =     -22.332153854098
             les_mean =     502.423593885301
             stat err =       0.001568429809
             autocorr =       1.311672345210
              std dev =       1.936753516125
             le_variance =       3.751014182224


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233215385410e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e-01, overlap shift 1.2925e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.332153853288       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.332220877736       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.332221292255       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.332220834672       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.332221002955       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e-01 is 1.098999e-03

solving harmonic davidson linear method for identity shift 5.1699e-01, overlap shift 5.1699e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.332153853288       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.332184260243       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.332184108640       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.332184050741       residual = 3.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e-01 is 4.440068e-04

solving harmonic davidson linear method for identity shift 2.0680e+00, overlap shift 2.0680e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.332153853288       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.332163399201       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.332163378311       residual = 8.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+00 is 1.385900e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239920 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0084e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -6.861864e-01 3 1  ON 0
ci_002                -7.147263e-01 3 1  ON 1
ci_003                -5.960804e-02 3 1  ON 2
ci_004                -6.137326e-02 3 1  ON 3
ci_005                 4.519097e-02 3 1  ON 4
ci_006                 4.707557e-02 3 1  ON 5
ci_007                 3.152203e-02 3 1  ON 6
ci_008                 3.282134e-02 3 1  ON 7
ci_009                -2.509521e-02 3 1  ON 8
ci_010                -2.546668e-02 3 1  ON 9
ci_011                -2.223610e-02 3 1  ON 10
ci_012                -2.303893e-02 3 1  ON 11
ci_013                 1.993636e-02 3 1  ON 12
ci_014                 2.146930e-02 3 1  ON 13
ci_015                 2.053463e-02 3 1  ON 14
ci_016                 2.063861e-02 3 1  ON 15
ci_017                 1.457078e-02 3 1  ON 16
ci_018                 1.611090e-02 3 1  ON 17
ci_019                 9.783134e-03 3 1  ON 18
ci_020                 1.028800e-02 3 1  ON 19
ci_021                -9.588442e-03 3 1  ON 20
ci_022                -1.014033e-02 3 1  ON 21
ci_023                 8.455172e-03 3 1  ON 22
ci_024                 9.297999e-03 3 1  ON 23
ci_025                 7.882262e-03 3 1  ON 24
ci_026                 7.979833e-03 3 1  ON 25
ci_027                 7.292061e-03 3 1  ON 26
ci_028                 7.966767e-03 3 1  ON 27
ci_029                -7.947165e-03 3 1  ON 28
ci_030                -7.773791e-03 3 1  ON 29
ci_031                -8.294873e-03 3 1  ON 30
ci_032                -7.823938e-03 3 1  ON 31
ci_033                 6.935965e-03 3 1  ON 32
ci_034                 7.086728e-03 3 1  ON 33
ci_035                 6.301151e-03 3 1  ON 34
ci_036                 6.477092e-03 3 1  ON 35
ci_037                 6.107459e-03 3 1  ON 36
ci_038                 6.597571e-03 3 1  ON 37
ci_039                 5.237512e-03 3 1  ON 38
ci_040                 5.600029e-03 3 1  ON 39
ci_041                 5.442074e-03 3 1  ON 40
ci_042                 5.127024e-03 3 1  ON 41
ci_043                 5.232208e-03 3 1  ON 42
ci_044                 5.514091e-03 3 1  ON 43
ci_045                 4.738985e-03 3 1  ON 44
ci_046                 5.042531e-03 3 1  ON 45
ci_047                -4.303002e-03 3 1  ON 46
ci_048                -4.217625e-03 3 1  ON 47
ci_049                 3.583920e-03 3 1  ON 48
ci_050                 4.314935e-03 3 1  ON 49
ci_051                -2.502897e-03 3 1  ON 50
ci_052                -3.472006e-03 3 1  ON 51
ci_053                -2.571234e-03 3 1  ON 52
ci_054                -2.613725e-03 3 1  ON 53
ci_055                -2.861323e-03 3 1  ON 54
ci_056                -1.815872e-03 3 1  ON 55
ci_057                -1.835799e-03 3 1  ON 56
ci_058                -1.796188e-03 3 1  ON 57
ci_059                -1.917209e-03 3 1  ON 58
ci_060                -1.664650e-03 3 1  ON 59
ci_061                -1.414292e-03 3 1  ON 60
ci_062                -1.566531e-03 3 1  ON 61
ci_063                -1.529633e-03 3 1  ON 62
ci_064                -1.794664e-03 3 1  ON 63
ci_065                -1.471487e-03 3 1  ON 64
ci_066                -1.043347e-03 3 1  ON 65
ci_067                -1.191050e-03 3 1  ON 66
ci_068                -8.124191e-04 3 1  ON 67
ci_069                 1.321435e-03 3 1  ON 68
ci_070                 1.149413e-03 3 1  ON 69
ci_071                -1.287475e-03 3 1  ON 70
ci_072                -1.135534e-03 3 1  ON 71
ci_073                 1.403373e-03 3 1  ON 72
ci_074                 1.254358e-03 3 1  ON 73
ci_075                -8.116994e-04 3 1  ON 74
ci_076                -1.288978e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.3592
    reference variance = 2.55385
====================================================
  Execution time = 2.3816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2328e+01
  VMC Evar = 3.7637e+00
  Total weights = 1.9498e+06
  Execution time = 4.3900e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813756496775
                                         uncertainty =       0.090746833986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.813756496775
                                         uncertainty =       0.090746833986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380653937
  error estimate for blocks of size 2^( 2) =       0.001450117096
  error estimate for blocks of size 2^( 3) =       0.001512726123
  error estimate for blocks of size 2^( 4) =       0.001558244639
  error estimate for blocks of size 2^( 5) =       0.001587426933
  error estimate for blocks of size 2^( 6) =       0.001603973233
  error estimate for blocks of size 2^( 7) =       0.001607777719

      target function =                  N/A
              le_mean =     -22.327758984814
             les_mean =     506.191882112032
             stat err =       0.001589355631
             autocorr =       1.325172755350
              std dev =       1.952570763011
             le_variance =       3.812532584565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810827057279
                                         uncertainty =       0.090610837829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810827057279
                                         uncertainty =       0.090610837829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380124830
  error estimate for blocks of size 2^( 2) =       0.001449587987
  error estimate for blocks of size 2^( 3) =       0.001512176159
  error estimate for blocks of size 2^( 4) =       0.001557655311
  error estimate for blocks of size 2^( 5) =       0.001586906442
  error estimate for blocks of size 2^( 6) =       0.001603388862
  error estimate for blocks of size 2^( 7) =       0.001607341182

      target function =                  N/A
              le_mean =     -22.327793426513
             les_mean =     502.295105193973
             stat err =       0.001588822949
             autocorr =       1.325300217834
              std dev =       1.951822481262
             le_variance =       3.809610998361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810712955826
                                         uncertainty =       0.090616360376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810712955826
                                         uncertainty =       0.090616360376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380104129
  error estimate for blocks of size 2^( 2) =       0.001449568223
  error estimate for blocks of size 2^( 3) =       0.001512157979
  error estimate for blocks of size 2^( 4) =       0.001557638728
  error estimate for blocks of size 2^( 5) =       0.001586894888
  error estimate for blocks of size 2^( 6) =       0.001603379591
  error estimate for blocks of size 2^( 7) =       0.001607326275

      target function =                  N/A
              le_mean =     -22.327791599506
             les_mean =     502.296689417615
             stat err =       0.001588809871
             autocorr =       1.325318157743
              std dev =       1.951793204674
             le_variance =       3.809496713813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810441574348
                                         uncertainty =       0.090640410427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.810441574348
                                         uncertainty =       0.090640410427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001380054785
  error estimate for blocks of size 2^( 2) =       0.001449540508
  error estimate for blocks of size 2^( 3) =       0.001512144190
  error estimate for blocks of size 2^( 4) =       0.001557636299
  error estimate for blocks of size 2^( 5) =       0.001586899434
  error estimate for blocks of size 2^( 6) =       0.001603412441
  error estimate for blocks of size 2^( 7) =       0.001607295779

      target function =                  N/A
              le_mean =     -22.327798869350
             les_mean =     502.294580447782
             stat err =       0.001588810988
             autocorr =       1.325414797271
              std dev =       1.951723420932
             le_variance =       3.809224311815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.327758984814        initial
     1.2925e-01     1.2925e+00             1.0990e-03       -22.327793426513
     5.1699e-01     5.1699e+00             4.4401e-04       -22.327791599506
     2.0680e+00     2.0680e+01             1.3859e-04       -22.327798869350  <--

*****************************************************************************
Applying the update for shift_i =   2.0680e+00     and shift_s =   2.0680e+01
*****************************************************************************

  Execution time = 4.5838e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -6.863058e-01 3 1  ON 0
ci_002                -7.146587e-01 3 1  ON 1
ci_003                -5.951014e-02 3 1  ON 2
ci_004                -6.133491e-02 3 1  ON 3
ci_005                 4.490940e-02 3 1  ON 4
ci_006                 4.681688e-02 3 1  ON 5
ci_007                 3.144911e-02 3 1  ON 6
ci_008                 3.288750e-02 3 1  ON 7
ci_009                -2.495654e-02 3 1  ON 8
ci_010                -2.544234e-02 3 1  ON 9
ci_011                -2.231539e-02 3 1  ON 10
ci_012                -2.311960e-02 3 1  ON 11
ci_013                 2.003334e-02 3 1  ON 12
ci_014                 2.166889e-02 3 1  ON 13
ci_015                 2.073323e-02 3 1  ON 14
ci_016                 2.071449e-02 3 1  ON 15
ci_017                 1.443255e-02 3 1  ON 16
ci_018                 1.596727e-02 3 1  ON 17
ci_019                 9.497860e-03 3 1  ON 18
ci_020                 1.035547e-02 3 1  ON 19
ci_021                -9.570870e-03 3 1  ON 20
ci_022                -1.017490e-02 3 1  ON 21
ci_023                 8.387694e-03 3 1  ON 22
ci_024                 9.148341e-03 3 1  ON 23
ci_025                 7.640830e-03 3 1  ON 24
ci_026                 8.159231e-03 3 1  ON 25
ci_027                 7.505288e-03 3 1  ON 26
ci_028                 7.925664e-03 3 1  ON 27
ci_029                -7.680159e-03 3 1  ON 28
ci_030                -7.798979e-03 3 1  ON 29
ci_031                -8.606995e-03 3 1  ON 30
ci_032                -7.556650e-03 3 1  ON 31
ci_033                 6.820698e-03 3 1  ON 32
ci_034                 6.822542e-03 3 1  ON 33
ci_035                 6.213109e-03 3 1  ON 34
ci_036                 6.526564e-03 3 1  ON 35
ci_037                 5.898397e-03 3 1  ON 36
ci_038                 6.597005e-03 3 1  ON 37
ci_039                 5.208661e-03 3 1  ON 38
ci_040                 5.689905e-03 3 1  ON 39
ci_041                 5.339952e-03 3 1  ON 40
ci_042                 5.084005e-03 3 1  ON 41
ci_043                 5.281179e-03 3 1  ON 42
ci_044                 5.309101e-03 3 1  ON 43
ci_045                 4.849806e-03 3 1  ON 44
ci_046                 5.012433e-03 3 1  ON 45
ci_047                -4.131076e-03 3 1  ON 46
ci_048                -4.391696e-03 3 1  ON 47
ci_049                 3.713891e-03 3 1  ON 48
ci_050                 4.338327e-03 3 1  ON 49
ci_051                -2.331794e-03 3 1  ON 50
ci_052                -3.252894e-03 3 1  ON 51
ci_053                -2.629873e-03 3 1  ON 52
ci_054                -2.451469e-03 3 1  ON 53
ci_055                -2.967234e-03 3 1  ON 54
ci_056                -1.768165e-03 3 1  ON 55
ci_057                -2.075553e-03 3 1  ON 56
ci_058                -1.784433e-03 3 1  ON 57
ci_059                -2.052779e-03 3 1  ON 58
ci_060                -1.506377e-03 3 1  ON 59
ci_061                -1.514167e-03 3 1  ON 60
ci_062                -1.609966e-03 3 1  ON 61
ci_063                -1.738102e-03 3 1  ON 62
ci_064                -1.907960e-03 3 1  ON 63
ci_065                -1.467996e-03 3 1  ON 64
ci_066                -9.994875e-04 3 1  ON 65
ci_067                -1.065558e-03 3 1  ON 66
ci_068                -1.018096e-03 3 1  ON 67
ci_069                 1.199604e-03 3 1  ON 68
ci_070                 1.094324e-03 3 1  ON 69
ci_071                -1.235186e-03 3 1  ON 70
ci_072                -1.105976e-03 3 1  ON 71
ci_073                 1.596487e-03 3 1  ON 72
ci_074                 1.228814e-03 3 1  ON 73
ci_075                -5.475618e-04 3 1  ON 74
ci_076                -1.024313e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2306e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.2733
    reference variance = 2.71425
====================================================
  Execution time = 2.4459e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0336e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.8926e+00
  Total weights = 1.949981379e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9501e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.943540483019
                                         uncertainty =       0.142006187305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.943540483019
                                         uncertainty =       0.142006187305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001404246308
  error estimate for blocks of size 2^( 2) =       0.001475185538
  error estimate for blocks of size 2^( 3) =       0.001537644925
  error estimate for blocks of size 2^( 4) =       0.001580391534
  error estimate for blocks of size 2^( 5) =       0.001605099215
  error estimate for blocks of size 2^( 6) =       0.001620563398
  error estimate for blocks of size 2^( 7) =       0.001642146745

      target function =                  N/A
              le_mean =     -22.330257356473
             les_mean =     502.532996884137
             stat err =       0.001612050223
             autocorr =       1.317863878844
              std dev =       1.985935947862
             le_variance =       3.943941589011


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233025735647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e-01, overlap shift 5.1699e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330257355616       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330287329763       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330287298074       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330287359786       residual = 6.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e-01 is 6.020317e-04

solving harmonic davidson linear method for identity shift 2.0680e+00, overlap shift 2.0680e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330257355616       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330266722557       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330266777263       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+00 is 1.822571e-04

solving harmonic davidson linear method for identity shift 8.2718e+00, overlap shift 8.2718e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330257355616       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330259853467       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330259876998       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+00 is 4.822057e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0420e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -6.863304e-01 3 1  ON 0
ci_002                -7.146162e-01 3 1  ON 1
ci_003                -5.963208e-02 3 1  ON 2
ci_004                -6.145231e-02 3 1  ON 3
ci_005                 4.501099e-02 3 1  ON 4
ci_006                 4.690579e-02 3 1  ON 5
ci_007                 3.147145e-02 3 1  ON 6
ci_008                 3.274781e-02 3 1  ON 7
ci_009                -2.499328e-02 3 1  ON 8
ci_010                -2.550422e-02 3 1  ON 9
ci_011                -2.231514e-02 3 1  ON 10
ci_012                -2.308649e-02 3 1  ON 11
ci_013                 2.001473e-02 3 1  ON 12
ci_014                 2.148663e-02 3 1  ON 13
ci_015                 2.060394e-02 3 1  ON 14
ci_016                 2.071237e-02 3 1  ON 15
ci_017                 1.449072e-02 3 1  ON 16
ci_018                 1.588350e-02 3 1  ON 17
ci_019                 9.465222e-03 3 1  ON 18
ci_020                 1.030753e-02 3 1  ON 19
ci_021                -9.550624e-03 3 1  ON 20
ci_022                -1.015588e-02 3 1  ON 21
ci_023                 8.476240e-03 3 1  ON 22
ci_024                 9.283611e-03 3 1  ON 23
ci_025                 7.537986e-03 3 1  ON 24
ci_026                 8.159784e-03 3 1  ON 25
ci_027                 7.480843e-03 3 1  ON 26
ci_028                 7.999847e-03 3 1  ON 27
ci_029                -7.684746e-03 3 1  ON 28
ci_030                -7.703674e-03 3 1  ON 29
ci_031                -8.596174e-03 3 1  ON 30
ci_032                -7.529501e-03 3 1  ON 31
ci_033                 6.778939e-03 3 1  ON 32
ci_034                 6.908113e-03 3 1  ON 33
ci_035                 6.256218e-03 3 1  ON 34
ci_036                 6.580318e-03 3 1  ON 35
ci_037                 5.890650e-03 3 1  ON 36
ci_038                 6.583942e-03 3 1  ON 37
ci_039                 5.295639e-03 3 1  ON 38
ci_040                 5.658176e-03 3 1  ON 39
ci_041                 5.378330e-03 3 1  ON 40
ci_042                 5.119316e-03 3 1  ON 41
ci_043                 5.141057e-03 3 1  ON 42
ci_044                 5.292315e-03 3 1  ON 43
ci_045                 4.811386e-03 3 1  ON 44
ci_046                 5.099769e-03 3 1  ON 45
ci_047                -4.152116e-03 3 1  ON 46
ci_048                -4.513121e-03 3 1  ON 47
ci_049                 3.736560e-03 3 1  ON 48
ci_050                 4.272455e-03 3 1  ON 49
ci_051                -2.414452e-03 3 1  ON 50
ci_052                -3.200549e-03 3 1  ON 51
ci_053                -2.567802e-03 3 1  ON 52
ci_054                -2.524248e-03 3 1  ON 53
ci_055                -2.918599e-03 3 1  ON 54
ci_056                -1.741298e-03 3 1  ON 55
ci_057                -2.004809e-03 3 1  ON 56
ci_058                -1.905865e-03 3 1  ON 57
ci_059                -2.118550e-03 3 1  ON 58
ci_060                -1.654970e-03 3 1  ON 59
ci_061                -1.372103e-03 3 1  ON 60
ci_062                -1.657502e-03 3 1  ON 61
ci_063                -1.595230e-03 3 1  ON 62
ci_064                -1.890323e-03 3 1  ON 63
ci_065                -1.334307e-03 3 1  ON 64
ci_066                -9.890173e-04 3 1  ON 65
ci_067                -1.047821e-03 3 1  ON 66
ci_068                -1.014947e-03 3 1  ON 67
ci_069                 1.184684e-03 3 1  ON 68
ci_070                 9.190196e-04 3 1  ON 69
ci_071                -1.176638e-03 3 1  ON 70
ci_072                -1.202973e-03 3 1  ON 71
ci_073                 1.568021e-03 3 1  ON 72
ci_074                 1.258744e-03 3 1  ON 73
ci_075                -6.299172e-04 3 1  ON 74
ci_076                -8.776600e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.5531
    reference variance = 1.95519
====================================================
  Execution time = 2.3728e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6726e+00
  Total weights = 1.9494e+06
  Execution time = 4.3763e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722732358829
                                         uncertainty =       0.019682512556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722732358829
                                         uncertainty =       0.019682512556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364169526
  error estimate for blocks of size 2^( 2) =       0.001435404755
  error estimate for blocks of size 2^( 3) =       0.001498542055
  error estimate for blocks of size 2^( 4) =       0.001541003430
  error estimate for blocks of size 2^( 5) =       0.001563818031
  error estimate for blocks of size 2^( 6) =       0.001578041558
  error estimate for blocks of size 2^( 7) =       0.001581943682

      target function =                  N/A
              le_mean =     -22.328714266466
             les_mean =     502.250262088144
             stat err =       0.001566201675
             autocorr =       1.318131325020
              std dev =       1.929257912150
             le_variance =       3.722036091595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722690207797
                                         uncertainty =       0.019682549723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722690207797
                                         uncertainty =       0.019682549723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364161708
  error estimate for blocks of size 2^( 2) =       0.001435390966
  error estimate for blocks of size 2^( 3) =       0.001498516451
  error estimate for blocks of size 2^( 4) =       0.001540979127
  error estimate for blocks of size 2^( 5) =       0.001563785886
  error estimate for blocks of size 2^( 6) =       0.001578017660
  error estimate for blocks of size 2^( 7) =       0.001581947304

      target function =                  N/A
              le_mean =     -22.328721404518
             les_mean =     502.245997515782
             stat err =       0.001566182495
             autocorr =       1.318114147757
              std dev =       1.929246856083
             le_variance =       3.721993431705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722701911598
                                         uncertainty =       0.019682361367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722701911598
                                         uncertainty =       0.019682361367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364163888
  error estimate for blocks of size 2^( 2) =       0.001435394578
  error estimate for blocks of size 2^( 3) =       0.001498524148
  error estimate for blocks of size 2^( 4) =       0.001540986465
  error estimate for blocks of size 2^( 5) =       0.001563795029
  error estimate for blocks of size 2^( 6) =       0.001578026203
  error estimate for blocks of size 2^( 7) =       0.001581945273

      target function =                  N/A
              le_mean =     -22.328716883837
             les_mean =     502.244222588872
             stat err =       0.001566188243
             autocorr =       1.318119610291
              std dev =       1.929249938980
             le_variance =       3.722005327055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722726588945
                                         uncertainty =       0.019682486221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.722726588945
                                         uncertainty =       0.019682486221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364168461
  error estimate for blocks of size 2^( 2) =       0.001435402971
  error estimate for blocks of size 2^( 3) =       0.001498539283
  error estimate for blocks of size 2^( 4) =       0.001541000346
  error estimate for blocks of size 2^( 5) =       0.001563813052
  error estimate for blocks of size 2^( 6) =       0.001578037777
  error estimate for blocks of size 2^( 7) =       0.001581942867

      target function =                  N/A
              le_mean =     -22.328713883259
             les_mean =     502.244417762549
             stat err =       0.001566198511
             autocorr =       1.318128056236
              std dev =       1.929256406194
             le_variance =       3.722030280842


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328714266466        initial
     5.1699e-01     5.1699e+00             6.0203e-04       -22.328721404518  <--
     2.0680e+00     2.0680e+01             1.8226e-04       -22.328716883837
     8.2718e+00     8.2718e+01             4.8221e-05       -22.328713883259

*****************************************************************************
Applying the update for shift_i =   5.1699e-01     and shift_s =   5.1699e+00
*****************************************************************************

  Execution time = 4.7332e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -6.864109e-01 3 1  ON 0
ci_002                -7.144916e-01 3 1  ON 1
ci_003                -5.996378e-02 3 1  ON 2
ci_004                -6.178382e-02 3 1  ON 3
ci_005                 4.521377e-02 3 1  ON 4
ci_006                 4.708421e-02 3 1  ON 5
ci_007                 3.152401e-02 3 1  ON 6
ci_008                 3.242801e-02 3 1  ON 7
ci_009                -2.507002e-02 3 1  ON 8
ci_010                -2.564379e-02 3 1  ON 9
ci_011                -2.231164e-02 3 1  ON 10
ci_012                -2.301463e-02 3 1  ON 11
ci_013                 1.997861e-02 3 1  ON 12
ci_014                 2.106685e-02 3 1  ON 13
ci_015                 2.028828e-02 3 1  ON 14
ci_016                 2.070788e-02 3 1  ON 15
ci_017                 1.462792e-02 3 1  ON 16
ci_018                 1.569875e-02 3 1  ON 17
ci_019                 9.399714e-03 3 1  ON 18
ci_020                 1.019356e-02 3 1  ON 19
ci_021                -9.501619e-03 3 1  ON 20
ci_022                -1.010425e-02 3 1  ON 21
ci_023                 8.664960e-03 3 1  ON 22
ci_024                 9.576987e-03 3 1  ON 23
ci_025                 7.301048e-03 3 1  ON 24
ci_026                 8.157671e-03 3 1  ON 25
ci_027                 7.429974e-03 3 1  ON 26
ci_028                 8.135576e-03 3 1  ON 27
ci_029                -7.711269e-03 3 1  ON 28
ci_030                -7.490040e-03 3 1  ON 29
ci_031                -8.579282e-03 3 1  ON 30
ci_032                -7.460964e-03 3 1  ON 31
ci_033                 6.691898e-03 3 1  ON 32
ci_034                 7.102067e-03 3 1  ON 33
ci_035                 6.344378e-03 3 1  ON 34
ci_036                 6.679315e-03 3 1  ON 35
ci_037                 5.875475e-03 3 1  ON 36
ci_038                 6.546315e-03 3 1  ON 37
ci_039                 5.461315e-03 3 1  ON 38
ci_040                 5.592277e-03 3 1  ON 39
ci_041                 5.451404e-03 3 1  ON 40
ci_042                 5.194136e-03 3 1  ON 41
ci_043                 4.839868e-03 3 1  ON 42
ci_044                 5.237242e-03 3 1  ON 43
ci_045                 4.722047e-03 3 1  ON 44
ci_046                 5.302746e-03 3 1  ON 45
ci_047                -4.195279e-03 3 1  ON 46
ci_048                -4.738789e-03 3 1  ON 47
ci_049                 3.786694e-03 3 1  ON 48
ci_050                 4.130873e-03 3 1  ON 49
ci_051                -2.607609e-03 3 1  ON 50
ci_052                -3.057382e-03 3 1  ON 51
ci_053                -2.434898e-03 3 1  ON 52
ci_054                -2.682876e-03 3 1  ON 53
ci_055                -2.800787e-03 3 1  ON 54
ci_056                -1.687404e-03 3 1  ON 55
ci_057                -1.850679e-03 3 1  ON 56
ci_058                -2.165812e-03 3 1  ON 57
ci_059                -2.237177e-03 3 1  ON 58
ci_060                -1.942741e-03 3 1  ON 59
ci_061                -1.067157e-03 3 1  ON 60
ci_062                -1.755365e-03 3 1  ON 61
ci_063                -1.271704e-03 3 1  ON 62
ci_064                -1.864107e-03 3 1  ON 63
ci_065                -1.031711e-03 3 1  ON 64
ci_066                -9.753052e-04 3 1  ON 65
ci_067                -1.014735e-03 3 1  ON 66
ci_068                -1.006466e-03 3 1  ON 67
ci_069                 1.145912e-03 3 1  ON 68
ci_070                 5.256962e-04 3 1  ON 69
ci_071                -1.044241e-03 3 1  ON 70
ci_072                -1.425180e-03 3 1  ON 71
ci_073                 1.507975e-03 3 1  ON 72
ci_074                 1.325938e-03 3 1  ON 73
ci_075                -8.028157e-04 3 1  ON 74
ci_076                -5.519031e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7769e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2307e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.2624
    reference variance = 4.52165
====================================================
  Execution time = 2.4568e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0310e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6830e+00
  Total weights = 1.949873142e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9658e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734280023193
                                         uncertainty =       0.025853634611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.734280023193
                                         uncertainty =       0.025853634611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001366421284
  error estimate for blocks of size 2^( 2) =       0.001437600917
  error estimate for blocks of size 2^( 3) =       0.001501278216
  error estimate for blocks of size 2^( 4) =       0.001543577939
  error estimate for blocks of size 2^( 5) =       0.001566116104
  error estimate for blocks of size 2^( 6) =       0.001582848845
  error estimate for blocks of size 2^( 7) =       0.001587343806

      target function =                  N/A
              le_mean =     -22.328521751469
             les_mean =     502.245845632106
             stat err =       0.001569971674
             autocorr =       1.320122997860
              std dev =       1.932442430155
             le_variance =       3.734333745865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232852175147e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e-01, overlap shift 1.2925e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328521750709       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328560335473       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328563564932       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328563451238       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328563276259       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328563342731       residual = 6.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e-01 is 1.178813e-03

solving harmonic davidson linear method for identity shift 5.1699e-01, overlap shift 5.1699e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328521750709       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328538941224       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328539504032       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328539481568       residual = 7.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e-01 is 5.130957e-04

solving harmonic davidson linear method for identity shift 2.0680e+00, overlap shift 2.0680e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328521750709       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328527092853       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328527156357       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+00 is 1.575195e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247088 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0545e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -6.866057e-01 3 1  ON 0
ci_002                -7.142587e-01 3 1  ON 1
ci_003                -6.001076e-02 3 1  ON 2
ci_004                -6.195213e-02 3 1  ON 3
ci_005                 4.504155e-02 3 1  ON 4
ci_006                 4.737923e-02 3 1  ON 5
ci_007                 3.179257e-02 3 1  ON 6
ci_008                 3.241102e-02 3 1  ON 7
ci_009                -2.490453e-02 3 1  ON 8
ci_010                -2.565535e-02 3 1  ON 9
ci_011                -2.235917e-02 3 1  ON 10
ci_012                -2.326750e-02 3 1  ON 11
ci_013                 1.985763e-02 3 1  ON 12
ci_014                 2.095740e-02 3 1  ON 13
ci_015                 2.028780e-02 3 1  ON 14
ci_016                 2.092198e-02 3 1  ON 15
ci_017                 1.498035e-02 3 1  ON 16
ci_018                 1.607042e-02 3 1  ON 17
ci_019                 9.729080e-03 3 1  ON 18
ci_020                 9.805209e-03 3 1  ON 19
ci_021                -9.221788e-03 3 1  ON 20
ci_022                -1.041061e-02 3 1  ON 21
ci_023                 8.871626e-03 3 1  ON 22
ci_024                 9.286636e-03 3 1  ON 23
ci_025                 7.059199e-03 3 1  ON 24
ci_026                 8.093761e-03 3 1  ON 25
ci_027                 7.656870e-03 3 1  ON 26
ci_028                 8.203780e-03 3 1  ON 27
ci_029                -7.232108e-03 3 1  ON 28
ci_030                -7.809680e-03 3 1  ON 29
ci_031                -8.354919e-03 3 1  ON 30
ci_032                -7.681235e-03 3 1  ON 31
ci_033                 6.461492e-03 3 1  ON 32
ci_034                 6.742048e-03 3 1  ON 33
ci_035                 6.246331e-03 3 1  ON 34
ci_036                 6.811550e-03 3 1  ON 35
ci_037                 6.133032e-03 3 1  ON 36
ci_038                 6.751350e-03 3 1  ON 37
ci_039                 5.714556e-03 3 1  ON 38
ci_040                 5.525007e-03 3 1  ON 39
ci_041                 5.453575e-03 3 1  ON 40
ci_042                 5.316477e-03 3 1  ON 41
ci_043                 4.965810e-03 3 1  ON 42
ci_044                 5.435026e-03 3 1  ON 43
ci_045                 4.366552e-03 3 1  ON 44
ci_046                 4.880263e-03 3 1  ON 45
ci_047                -3.982870e-03 3 1  ON 46
ci_048                -4.590875e-03 3 1  ON 47
ci_049                 3.273598e-03 3 1  ON 48
ci_050                 3.832511e-03 3 1  ON 49
ci_051                -2.620047e-03 3 1  ON 50
ci_052                -3.010688e-03 3 1  ON 51
ci_053                -2.438225e-03 3 1  ON 52
ci_054                -2.719780e-03 3 1  ON 53
ci_055                -3.025639e-03 3 1  ON 54
ci_056                -1.902480e-03 3 1  ON 55
ci_057                -2.074450e-03 3 1  ON 56
ci_058                -2.360407e-03 3 1  ON 57
ci_059                -2.156351e-03 3 1  ON 58
ci_060                -1.738334e-03 3 1  ON 59
ci_061                -1.169185e-03 3 1  ON 60
ci_062                -1.894578e-03 3 1  ON 61
ci_063                -9.963679e-04 3 1  ON 62
ci_064                -2.031016e-03 3 1  ON 63
ci_065                -1.041617e-03 3 1  ON 64
ci_066                -9.240746e-04 3 1  ON 65
ci_067                -1.284374e-03 3 1  ON 66
ci_068                -1.037162e-03 3 1  ON 67
ci_069                 1.076329e-03 3 1  ON 68
ci_070                 7.626166e-04 3 1  ON 69
ci_071                -9.597212e-04 3 1  ON 70
ci_072                -1.228314e-03 3 1  ON 71
ci_073                 1.384798e-03 3 1  ON 72
ci_074                 1.391353e-03 3 1  ON 73
ci_075                -4.009464e-04 3 1  ON 74
ci_076                -7.090639e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.5022
    reference variance = 2.26413
====================================================
  Execution time = 2.3811e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7430e+00
  Total weights = 1.9498e+06
  Execution time = 4.3817e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.171247
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796139893895
                                         uncertainty =       0.054860951982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796139893895
                                         uncertainty =       0.054860951982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377588417
  error estimate for blocks of size 2^( 2) =       0.001449062168
  error estimate for blocks of size 2^( 3) =       0.001513258418
  error estimate for blocks of size 2^( 4) =       0.001557844073
  error estimate for blocks of size 2^( 5) =       0.001580653680
  error estimate for blocks of size 2^( 6) =       0.001591893403
  error estimate for blocks of size 2^( 7) =       0.001596471137

      target function =                  N/A
              le_mean =     -22.329625958552
             les_mean =     502.358309860105
             stat err =       0.001581715573
             autocorr =       1.318310818608
              std dev =       1.948235393887
             le_variance =       3.795621149993

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0240729
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796199080189
                                         uncertainty =       0.054860403254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796199080189
                                         uncertainty =       0.054860403254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377599106
  error estimate for blocks of size 2^( 2) =       0.001449077293
  error estimate for blocks of size 2^( 3) =       0.001513259705
  error estimate for blocks of size 2^( 4) =       0.001557847605
  error estimate for blocks of size 2^( 5) =       0.001580668191
  error estimate for blocks of size 2^( 6) =       0.001591924959
  error estimate for blocks of size 2^( 7) =       0.001596466731

      target function =                  N/A
              le_mean =     -22.329633159294
             les_mean =     502.369825555659
             stat err =       0.001581726871
             autocorr =       1.318309194069
              std dev =       1.948250510698
             le_variance =       3.795680052434

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.164171
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796162209410
                                         uncertainty =       0.054861481011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796162209410
                                         uncertainty =       0.054861481011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377592426
  error estimate for blocks of size 2^( 2) =       0.001449068479
  error estimate for blocks of size 2^( 3) =       0.001513251286
  error estimate for blocks of size 2^( 4) =       0.001557836833
  error estimate for blocks of size 2^( 5) =       0.001580661282
  error estimate for blocks of size 2^( 6) =       0.001591917636
  error estimate for blocks of size 2^( 7) =       0.001596455553

      target function =                  N/A
              le_mean =     -22.329624082740
             les_mean =     502.356059758059
             stat err =       0.001581717826
             autocorr =       1.318306901021
              std dev =       1.948241063750
             le_variance =       3.795643242481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796130036718
                                         uncertainty =       0.054861157592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.796130036718
                                         uncertainty =       0.054861157592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377586625
  error estimate for blocks of size 2^( 2) =       0.001449061383
  error estimate for blocks of size 2^( 3) =       0.001513254987
  error estimate for blocks of size 2^( 4) =       0.001557834776
  error estimate for blocks of size 2^( 5) =       0.001580648986
  error estimate for blocks of size 2^( 6) =       0.001591888080
  error estimate for blocks of size 2^( 7) =       0.001596463010

      target function =                  N/A
              le_mean =     -22.329621886138
             les_mean =     502.363254498926
             stat err =       0.001581708713
             autocorr =       1.318302813738
              std dev =       1.948232859038
             le_variance =       3.795611273037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329625958552        initial
     1.2925e-01     1.2925e+00             1.1788e-03       -22.329633159294  <--
     5.1699e-01     5.1699e+00             5.1310e-04       -22.329624082740
     2.0680e+00     2.0680e+01             1.5752e-04       -22.329621886138

*****************************************************************************
Applying the update for shift_i =   1.2925e-01     and shift_s =   1.2925e+00
*****************************************************************************

  Execution time = 4.5846e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -6.871904e-01 3 1  ON 0
ci_002                -7.136294e-01 3 1  ON 1
ci_003                -6.012643e-02 3 1  ON 2
ci_004                -6.231010e-02 3 1  ON 3
ci_005                 4.488173e-02 3 1  ON 4
ci_006                 4.764531e-02 3 1  ON 5
ci_007                 3.218190e-02 3 1  ON 6
ci_008                 3.234878e-02 3 1  ON 7
ci_009                -2.460483e-02 3 1  ON 8
ci_010                -2.563673e-02 3 1  ON 9
ci_011                -2.245672e-02 3 1  ON 10
ci_012                -2.359778e-02 3 1  ON 11
ci_013                 1.973468e-02 3 1  ON 12
ci_014                 2.075429e-02 3 1  ON 13
ci_015                 2.024419e-02 3 1  ON 14
ci_016                 2.122764e-02 3 1  ON 15
ci_017                 1.547709e-02 3 1  ON 16
ci_018                 1.662008e-02 3 1  ON 17
ci_019                 1.026707e-02 3 1  ON 18
ci_020                 9.228194e-03 3 1  ON 19
ci_021                -8.824781e-03 3 1  ON 20
ci_022                -1.080003e-02 3 1  ON 21
ci_023                 9.117052e-03 3 1  ON 22
ci_024                 8.919907e-03 3 1  ON 23
ci_025                 6.668893e-03 3 1  ON 24
ci_026                 8.057303e-03 3 1  ON 25
ci_027                 7.865514e-03 3 1  ON 26
ci_028                 8.251699e-03 3 1  ON 27
ci_029                -6.591497e-03 3 1  ON 28
ci_030                -8.244752e-03 3 1  ON 29
ci_031                -8.044470e-03 3 1  ON 30
ci_032                -7.925286e-03 3 1  ON 31
ci_033                 6.178362e-03 3 1  ON 32
ci_034                 6.277805e-03 3 1  ON 33
ci_035                 6.169876e-03 3 1  ON 34
ci_036                 6.956208e-03 3 1  ON 35
ci_037                 6.433282e-03 3 1  ON 36
ci_038                 6.969100e-03 3 1  ON 37
ci_039                 5.953956e-03 3 1  ON 38
ci_040                 5.462229e-03 3 1  ON 39
ci_041                 5.444563e-03 3 1  ON 40
ci_042                 5.453168e-03 3 1  ON 41
ci_043                 5.097601e-03 3 1  ON 42
ci_044                 5.700892e-03 3 1  ON 43
ci_045                 3.915354e-03 3 1  ON 44
ci_046                 4.333672e-03 3 1  ON 45
ci_047                -3.768489e-03 3 1  ON 46
ci_048                -4.467364e-03 3 1  ON 47
ci_049                 2.607881e-03 3 1  ON 48
ci_050                 3.455706e-03 3 1  ON 49
ci_051                -2.650036e-03 3 1  ON 50
ci_052                -2.958688e-03 3 1  ON 51
ci_053                -2.420414e-03 3 1  ON 52
ci_054                -2.737767e-03 3 1  ON 53
ci_055                -3.276727e-03 3 1  ON 54
ci_056                -2.190593e-03 3 1  ON 55
ci_057                -2.352220e-03 3 1  ON 56
ci_058                -2.587311e-03 3 1  ON 57
ci_059                -2.092557e-03 3 1  ON 58
ci_060                -1.533597e-03 3 1  ON 59
ci_061                -1.289204e-03 3 1  ON 60
ci_062                -2.061807e-03 3 1  ON 61
ci_063                -6.298816e-04 3 1  ON 62
ci_064                -2.259219e-03 3 1  ON 63
ci_065                -1.105981e-03 3 1  ON 64
ci_066                -8.423214e-04 3 1  ON 65
ci_067                -1.613380e-03 3 1  ON 66
ci_068                -1.046053e-03 3 1  ON 67
ci_069                 9.531717e-04 3 1  ON 68
ci_070                 1.071354e-03 3 1  ON 69
ci_071                -8.576691e-04 3 1  ON 70
ci_072                -9.617652e-04 3 1  ON 71
ci_073                 1.283189e-03 3 1  ON 72
ci_074                 1.453107e-03 3 1  ON 73
ci_075                 9.679195e-05 3 1  ON 74
ci_076                -9.218414e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6406e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2308e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.2951
    reference variance = 2.83277
====================================================
  Execution time = 2.4444e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0326e+04
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7175e+00
  Total weights = 1.949628899e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9420e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770618183383
                                         uncertainty =       0.032440812478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.770618183383
                                         uncertainty =       0.032440812478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372989934
  error estimate for blocks of size 2^( 2) =       0.001443517992
  error estimate for blocks of size 2^( 3) =       0.001507550338
  error estimate for blocks of size 2^( 4) =       0.001551795219
  error estimate for blocks of size 2^( 5) =       0.001574280106
  error estimate for blocks of size 2^( 6) =       0.001587600607
  error estimate for blocks of size 2^( 7) =       0.001596396103

      target function =                  N/A
              le_mean =     -22.325415769278
             les_mean =     502.141658639075
             stat err =       0.001577518009
             autocorr =       1.320121625004
              std dev =       1.941732052063
             le_variance =       3.770323362009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232541576928e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e-02, overlap shift 3.2312e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325415768463       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325526185769       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325531094269       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325531566658       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325531462630       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.325531637280       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.325531611092       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.325531554430       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e-02 is 2.723588e-03

solving harmonic davidson linear method for identity shift 1.2925e-01, overlap shift 1.2925e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325415768463       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325492150983       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325493650994       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325493645544       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.325493614540       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e-01 is 1.787321e-03

solving harmonic davidson linear method for identity shift 5.1699e-01, overlap shift 5.1699e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.325415768463       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.325449975030       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.325450058248       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.325450038072       residual = 2.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e-01 is 7.710555e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0398e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -6.873665e-01 3 1  ON 0
ci_002                -7.135144e-01 3 1  ON 1
ci_003                -5.984561e-02 3 1  ON 2
ci_004                -6.304823e-02 3 1  ON 3
ci_005                 4.504486e-02 3 1  ON 4
ci_006                 4.742208e-02 3 1  ON 5
ci_007                 3.092327e-02 3 1  ON 6
ci_008                 3.282064e-02 3 1  ON 7
ci_009                -2.485332e-02 3 1  ON 8
ci_010                -2.492059e-02 3 1  ON 9
ci_011                -2.149785e-02 3 1  ON 10
ci_012                -2.316983e-02 3 1  ON 11
ci_013                 2.002085e-02 3 1  ON 12
ci_014                 2.109552e-02 3 1  ON 13
ci_015                 2.026054e-02 3 1  ON 14
ci_016                 2.117288e-02 3 1  ON 15
ci_017                 1.568107e-02 3 1  ON 16
ci_018                 1.594749e-02 3 1  ON 17
ci_019                 1.001797e-02 3 1  ON 18
ci_020                 9.134229e-03 3 1  ON 19
ci_021                -8.424736e-03 3 1  ON 20
ci_022                -1.031081e-02 3 1  ON 21
ci_023                 8.577395e-03 3 1  ON 22
ci_024                 7.911940e-03 3 1  ON 23
ci_025                 8.363031e-03 3 1  ON 24
ci_026                 8.843834e-03 3 1  ON 25
ci_027                 7.833724e-03 3 1  ON 26
ci_028                 8.249854e-03 3 1  ON 27
ci_029                -7.262968e-03 3 1  ON 28
ci_030                -8.221458e-03 3 1  ON 29
ci_031                -8.314003e-03 3 1  ON 30
ci_032                -7.835052e-03 3 1  ON 31
ci_033                 6.276411e-03 3 1  ON 32
ci_034                 6.436099e-03 3 1  ON 33
ci_035                 6.626426e-03 3 1  ON 34
ci_036                 6.681285e-03 3 1  ON 35
ci_037                 6.379811e-03 3 1  ON 36
ci_038                 6.257699e-03 3 1  ON 37
ci_039                 5.801767e-03 3 1  ON 38
ci_040                 5.481891e-03 3 1  ON 39
ci_041                 5.383863e-03 3 1  ON 40
ci_042                 5.874913e-03 3 1  ON 41
ci_043                 5.477223e-03 3 1  ON 42
ci_044                 5.704396e-03 3 1  ON 43
ci_045                 4.576708e-03 3 1  ON 44
ci_046                 3.804418e-03 3 1  ON 45
ci_047                -3.889615e-03 3 1  ON 46
ci_048                -4.833491e-03 3 1  ON 47
ci_049                 3.025879e-03 3 1  ON 48
ci_050                 4.061950e-03 3 1  ON 49
ci_051                -2.386728e-03 3 1  ON 50
ci_052                -2.971877e-03 3 1  ON 51
ci_053                -2.699804e-03 3 1  ON 52
ci_054                -2.676222e-03 3 1  ON 53
ci_055                -2.843356e-03 3 1  ON 54
ci_056                -2.918846e-03 3 1  ON 55
ci_057                -2.325139e-03 3 1  ON 56
ci_058                -2.010003e-03 3 1  ON 57
ci_059                -2.014647e-03 3 1  ON 58
ci_060                -2.169911e-03 3 1  ON 59
ci_061                -1.307040e-03 3 1  ON 60
ci_062                -1.230899e-03 3 1  ON 61
ci_063                -2.417203e-03 3 1  ON 62
ci_064                -1.381874e-03 3 1  ON 63
ci_065                -1.322632e-03 3 1  ON 64
ci_066                -1.016132e-03 3 1  ON 65
ci_067                -1.729220e-03 3 1  ON 66
ci_068                -8.626501e-04 3 1  ON 67
ci_069                 1.131313e-03 3 1  ON 68
ci_070                 2.215883e-03 3 1  ON 69
ci_071                -1.062905e-03 3 1  ON 70
ci_072                -5.241647e-04 3 1  ON 71
ci_073                 9.751836e-04 3 1  ON 72
ci_074                 1.154707e-03 3 1  ON 73
ci_075                -1.175528e-03 3 1  ON 74
ci_076                -1.353376e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.6467
    reference variance = 2.68552
====================================================
  Execution time = 2.3757e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7141e+00
  Total weights = 1.9502e+06
  Execution time = 4.4207e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.765173228248
                                         uncertainty =       0.028967552910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.765173228248
                                         uncertainty =       0.028967552910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001372059321
  error estimate for blocks of size 2^( 2) =       0.001442183933
  error estimate for blocks of size 2^( 3) =       0.001505007889
  error estimate for blocks of size 2^( 4) =       0.001547782556
  error estimate for blocks of size 2^( 5) =       0.001572249821
  error estimate for blocks of size 2^( 6) =       0.001588796634
  error estimate for blocks of size 2^( 7) =       0.001600746894

      target function =                  N/A
              le_mean =     -22.329593965726
             les_mean =     502.456854634176
             stat err =       0.001577393976
             autocorr =       1.321705140256
              std dev =       1.940415945932
             le_variance =       3.765214043227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764591655409
                                         uncertainty =       0.028984821146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764591655409
                                         uncertainty =       0.028984821146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371953301
  error estimate for blocks of size 2^( 2) =       0.001442112890
  error estimate for blocks of size 2^( 3) =       0.001504992692
  error estimate for blocks of size 2^( 4) =       0.001547738069
  error estimate for blocks of size 2^( 5) =       0.001572193478
  error estimate for blocks of size 2^( 6) =       0.001588713409
  error estimate for blocks of size 2^( 7) =       0.001600664690

      target function =                  N/A
              le_mean =     -22.329581326200
             les_mean =     502.459723701286
             stat err =       0.001577327412
             autocorr =       1.321797858018
              std dev =       1.940266008633
             le_variance =       3.764632184257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764751487165
                                         uncertainty =       0.028983336509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.764751487165
                                         uncertainty =       0.028983336509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371982288
  error estimate for blocks of size 2^( 2) =       0.001442146195
  error estimate for blocks of size 2^( 3) =       0.001505048898
  error estimate for blocks of size 2^( 4) =       0.001547796256
  error estimate for blocks of size 2^( 5) =       0.001572240935
  error estimate for blocks of size 2^( 6) =       0.001588749400
  error estimate for blocks of size 2^( 7) =       0.001600680846

      target function =                  N/A
              le_mean =     -22.329600993260
             les_mean =     502.337469441833
             stat err =       0.001577366859
             autocorr =       1.321808116918
              std dev =       1.940307003294
             le_variance =       3.764791267030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797344407401
                                         uncertainty =       0.045339012618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.797344407401
                                         uncertainty =       0.045339012618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001377887186
  error estimate for blocks of size 2^( 2) =       0.001447806715
  error estimate for blocks of size 2^( 3) =       0.001510498205
  error estimate for blocks of size 2^( 4) =       0.001553053535
  error estimate for blocks of size 2^( 5) =       0.001577271373
  error estimate for blocks of size 2^( 6) =       0.001593947032
  error estimate for blocks of size 2^( 7) =       0.001605147776

      target function =                  N/A
              le_mean =     -22.329711326859
             les_mean =     519.222889250967
             stat err =       0.001582354929
             autocorr =       1.318804697473
              std dev =       1.948657924263
             le_variance =       3.797267705794


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329593965726        initial
     3.2312e-02     3.2312e-01             2.7236e-03       -22.329581326200
     1.2925e-01     1.2925e+00             1.7873e-03       -22.329600993260
     5.1699e-01     5.1699e+00             7.7106e-04       -22.329711326859  <--

*****************************************************************************
Applying the update for shift_i =   5.1699e-01     and shift_s =   5.1699e+00
*****************************************************************************

  Execution time = 4.5906e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -6.872466e-01 3 1  ON 0
ci_002                -7.136053e-01 3 1  ON 1
ci_003                -6.002119e-02 3 1  ON 2
ci_004                -6.255996e-02 3 1  ON 3
ci_005                 4.495244e-02 3 1  ON 4
ci_006                 4.753028e-02 3 1  ON 5
ci_007                 3.164266e-02 3 1  ON 6
ci_008                 3.255335e-02 3 1  ON 7
ci_009                -2.466607e-02 3 1  ON 8
ci_010                -2.532628e-02 3 1  ON 9
ci_011                -2.205463e-02 3 1  ON 10
ci_012                -2.341298e-02 3 1  ON 11
ci_013                 1.986651e-02 3 1  ON 12
ci_014                 2.089355e-02 3 1  ON 13
ci_015                 2.022651e-02 3 1  ON 14
ci_016                 2.121011e-02 3 1  ON 15
ci_017                 1.557020e-02 3 1  ON 16
ci_018                 1.636036e-02 3 1  ON 17
ci_019                 1.022257e-02 3 1  ON 18
ci_020                 9.216093e-03 3 1  ON 19
ci_021                -8.669238e-03 3 1  ON 20
ci_022                -1.060455e-02 3 1  ON 21
ci_023                 8.874591e-03 3 1  ON 22
ci_024                 8.456188e-03 3 1  ON 23
ci_025                 7.347371e-03 3 1  ON 24
ci_026                 8.379727e-03 3 1  ON 25
ci_027                 7.845571e-03 3 1  ON 26
ci_028                 8.244137e-03 3 1  ON 27
ci_029                -6.883071e-03 3 1  ON 28
ci_030                -8.243734e-03 3 1  ON 29
ci_031                -8.142685e-03 3 1  ON 30
ci_032                -7.868955e-03 3 1  ON 31
ci_033                 6.228082e-03 3 1  ON 32
ci_034                 6.337230e-03 3 1  ON 33
ci_035                 6.416403e-03 3 1  ON 34
ci_036                 6.815617e-03 3 1  ON 35
ci_037                 6.400168e-03 3 1  ON 36
ci_038                 6.635657e-03 3 1  ON 37
ci_039                 5.858031e-03 3 1  ON 38
ci_040                 5.472880e-03 3 1  ON 39
ci_041                 5.414255e-03 3 1  ON 40
ci_042                 5.659947e-03 3 1  ON 41
ci_043                 5.285183e-03 3 1  ON 42
ci_044                 5.704789e-03 3 1  ON 43
ci_045                 4.200943e-03 3 1  ON 44
ci_046                 4.106609e-03 3 1  ON 45
ci_047                -3.848455e-03 3 1  ON 46
ci_048                -4.662565e-03 3 1  ON 47
ci_049                 2.785745e-03 3 1  ON 48
ci_050                 3.721701e-03 3 1  ON 49
ci_051                -2.558216e-03 3 1  ON 50
ci_052                -2.943389e-03 3 1  ON 51
ci_053                -2.527066e-03 3 1  ON 52
ci_054                -2.682820e-03 3 1  ON 53
ci_055                -3.079757e-03 3 1  ON 54
ci_056                -2.479541e-03 3 1  ON 55
ci_057                -2.336972e-03 3 1  ON 56
ci_058                -2.317457e-03 3 1  ON 57
ci_059                -2.059663e-03 3 1  ON 58
ci_060                -1.859784e-03 3 1  ON 59
ci_061                -1.306838e-03 3 1  ON 60
ci_062                -1.671490e-03 3 1  ON 61
ci_063                -1.400937e-03 3 1  ON 62
ci_064                -1.882905e-03 3 1  ON 63
ci_065                -1.213987e-03 3 1  ON 64
ci_066                -9.160956e-04 3 1  ON 65
ci_067                -1.661989e-03 3 1  ON 66
ci_068                -9.729606e-04 3 1  ON 67
ci_069                 1.022771e-03 3 1  ON 68
ci_070                 1.578133e-03 3 1  ON 69
ci_071                -9.577792e-04 3 1  ON 70
ci_072                -7.741915e-04 3 1  ON 71
ci_073                 1.115610e-03 3 1  ON 72
ci_074                 1.288894e-03 3 1  ON 73
ci_075                -4.694829e-04 3 1  ON 74
ci_076                -1.112848e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6327e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.263
    reference variance = 3.66489
====================================================
  Execution time = 2.4291e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0287e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6731e+00
  Total weights = 1.949848962e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9381e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.723645878874
                                         uncertainty =       0.026355774312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.723645878874
                                         uncertainty =       0.026355774312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001364497775
  error estimate for blocks of size 2^( 2) =       0.001435730851
  error estimate for blocks of size 2^( 3) =       0.001499130544
  error estimate for blocks of size 2^( 4) =       0.001542704471
  error estimate for blocks of size 2^( 5) =       0.001568311362
  error estimate for blocks of size 2^( 6) =       0.001586211429
  error estimate for blocks of size 2^( 7) =       0.001591997964

      target function =                  N/A
              le_mean =     -22.328874693237
             les_mean =     502.251728106884
             stat err =       0.001572306307
             autocorr =       1.327787723589
              std dev =       1.929722134564
             le_variance =       3.723827516627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232887469324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e-01, overlap shift 1.2925e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328874692425       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328941755840       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328945289497       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328945714773       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328945719393       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328945718158       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e-01 is 2.213539e-03

solving harmonic davidson linear method for identity shift 5.1699e-01, overlap shift 5.1699e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328874692425       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328904443745       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328904905789       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328904932025       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e-01 is 9.545836e-04

solving harmonic davidson linear method for identity shift 2.0680e+00, overlap shift 2.0680e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328874692425       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328883916216       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328883944406       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+00 is 2.912584e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0240e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -6.874243e-01 3 1  ON 0
ci_002                -7.134813e-01 3 1  ON 1
ci_003                -6.020706e-02 3 1  ON 2
ci_004                -6.221352e-02 3 1  ON 3
ci_005                 4.492865e-02 3 1  ON 4
ci_006                 4.722773e-02 3 1  ON 5
ci_007                 3.176486e-02 3 1  ON 6
ci_008                 3.260981e-02 3 1  ON 7
ci_009                -2.447207e-02 3 1  ON 8
ci_010                -2.550371e-02 3 1  ON 9
ci_011                -2.208994e-02 3 1  ON 10
ci_012                -2.296931e-02 3 1  ON 11
ci_013                 1.997150e-02 3 1  ON 12
ci_014                 2.073918e-02 3 1  ON 13
ci_015                 2.017873e-02 3 1  ON 14
ci_016                 2.086838e-02 3 1  ON 15
ci_017                 1.540337e-02 3 1  ON 16
ci_018                 1.620070e-02 3 1  ON 17
ci_019                 9.727615e-03 3 1  ON 18
ci_020                 9.551596e-03 3 1  ON 19
ci_021                -8.823142e-03 3 1  ON 20
ci_022                -1.062965e-02 3 1  ON 21
ci_023                 8.959091e-03 3 1  ON 22
ci_024                 8.740534e-03 3 1  ON 23
ci_025                 7.548292e-03 3 1  ON 24
ci_026                 8.325453e-03 3 1  ON 25
ci_027                 7.662496e-03 3 1  ON 26
ci_028                 8.159411e-03 3 1  ON 27
ci_029                -7.480153e-03 3 1  ON 28
ci_030                -8.350640e-03 3 1  ON 29
ci_031                -8.006225e-03 3 1  ON 30
ci_032                -7.600586e-03 3 1  ON 31
ci_033                 6.350244e-03 3 1  ON 32
ci_034                 6.537790e-03 3 1  ON 33
ci_035                 6.416661e-03 3 1  ON 34
ci_036                 6.560343e-03 3 1  ON 35
ci_037                 6.564933e-03 3 1  ON 36
ci_038                 6.942257e-03 3 1  ON 37
ci_039                 5.938363e-03 3 1  ON 38
ci_040                 5.406052e-03 3 1  ON 39
ci_041                 5.189692e-03 3 1  ON 40
ci_042                 5.557360e-03 3 1  ON 41
ci_043                 5.164796e-03 3 1  ON 42
ci_044                 5.575524e-03 3 1  ON 43
ci_045                 4.839301e-03 3 1  ON 44
ci_046                 5.061193e-03 3 1  ON 45
ci_047                -3.992624e-03 3 1  ON 46
ci_048                -4.438037e-03 3 1  ON 47
ci_049                 3.022672e-03 3 1  ON 48
ci_050                 3.939536e-03 3 1  ON 49
ci_051                -2.436532e-03 3 1  ON 50
ci_052                -3.546302e-03 3 1  ON 51
ci_053                -2.435986e-03 3 1  ON 52
ci_054                -2.795275e-03 3 1  ON 53
ci_055                -3.310083e-03 3 1  ON 54
ci_056                -2.477058e-03 3 1  ON 55
ci_057                -2.644029e-03 3 1  ON 56
ci_058                -2.146425e-03 3 1  ON 57
ci_059                -1.910270e-03 3 1  ON 58
ci_060                -1.818670e-03 3 1  ON 59
ci_061                -9.877838e-04 3 1  ON 60
ci_062                -1.528337e-03 3 1  ON 61
ci_063                -1.463215e-03 3 1  ON 62
ci_064                -1.703428e-03 3 1  ON 63
ci_065                -1.377232e-03 3 1  ON 64
ci_066                -1.025219e-03 3 1  ON 65
ci_067                -1.075275e-03 3 1  ON 66
ci_068                -1.172083e-03 3 1  ON 67
ci_069                 1.407014e-03 3 1  ON 68
ci_070                 1.420404e-03 3 1  ON 69
ci_071                -7.349463e-04 3 1  ON 70
ci_072                -4.871230e-04 3 1  ON 71
ci_073                 8.283713e-04 3 1  ON 72
ci_074                 1.071638e-03 3 1  ON 73
ci_075                -7.685621e-04 3 1  ON 74
ci_076                -8.500926e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.4383
    reference variance = 2.48112
====================================================
  Execution time = 2.3881e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6462e+00
  Total weights = 1.9500e+06
  Execution time = 4.4145e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0447709
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696797222789
                                         uncertainty =       0.021954502429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696797222789
                                         uncertainty =       0.021954502429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359712995
  error estimate for blocks of size 2^( 2) =       0.001433095906
  error estimate for blocks of size 2^( 3) =       0.001495770733
  error estimate for blocks of size 2^( 4) =       0.001538590673
  error estimate for blocks of size 2^( 5) =       0.001560328388
  error estimate for blocks of size 2^( 6) =       0.001573615945
  error estimate for blocks of size 2^( 7) =       0.001582234780

      target function =                  N/A
              le_mean =     -22.329213611430
             les_mean =     502.242029976880
             stat err =       0.001563692446
             autocorr =       1.322538064448
              std dev =       1.922955324334
             le_variance =       3.697757179385

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0200915
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696803603497
                                         uncertainty =       0.021963092501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696803603497
                                         uncertainty =       0.021963092501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359714168
  error estimate for blocks of size 2^( 2) =       0.001433091617
  error estimate for blocks of size 2^( 3) =       0.001495768983
  error estimate for blocks of size 2^( 4) =       0.001538580686
  error estimate for blocks of size 2^( 5) =       0.001560319233
  error estimate for blocks of size 2^( 6) =       0.001573586392
  error estimate for blocks of size 2^( 7) =       0.001582199075

      target function =                  N/A
              le_mean =     -22.329221535178
             les_mean =     502.399494811985
             stat err =       0.001563671347
             autocorr =       1.322500089998
              std dev =       1.922956984235
             le_variance =       3.697763563218

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0434693
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696690915357
                                         uncertainty =       0.021957985661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696690915357
                                         uncertainty =       0.021957985661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359693531
  error estimate for blocks of size 2^( 2) =       0.001433084189
  error estimate for blocks of size 2^( 3) =       0.001495771398
  error estimate for blocks of size 2^( 4) =       0.001538582828
  error estimate for blocks of size 2^( 5) =       0.001560317676
  error estimate for blocks of size 2^( 6) =       0.001573603023
  error estimate for blocks of size 2^( 7) =       0.001582206136

      target function =                  N/A
              le_mean =     -22.329211042781
             les_mean =     502.241064661365
             stat err =       0.001563677416
             autocorr =       1.322550501663
              std dev =       1.922927798848
             le_variance =       3.697651319583

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.196071
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696759675204
                                         uncertainty =       0.021955338819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.696759675204
                                         uncertainty =       0.021955338819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001359706107
  error estimate for blocks of size 2^( 2) =       0.001433089745
  error estimate for blocks of size 2^( 3) =       0.001495767174
  error estimate for blocks of size 2^( 4) =       0.001538586776
  error estimate for blocks of size 2^( 5) =       0.001560322902
  error estimate for blocks of size 2^( 6) =       0.001573606137
  error estimate for blocks of size 2^( 7) =       0.001582223823

      target function =                  N/A
              le_mean =     -22.329210296452
             les_mean =     502.242450275068
             stat err =       0.001563684909
             autocorr =       1.322538713862
              std dev =       1.922945583551
             le_variance =       3.697719717300


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329213611430        initial
     1.2925e-01     1.2925e+00             2.2135e-03       -22.329221535178  <--
     5.1699e-01     5.1699e+00             9.5458e-04       -22.329211042781
     2.0680e+00     2.0680e+01             2.9126e-04       -22.329210296452

*****************************************************************************
Applying the update for shift_i =   1.2925e-01     and shift_s =   1.2925e+00
*****************************************************************************

  Execution time = 4.6040e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -6.879664e-01 3 1  ON 0
ci_002                -7.130250e-01 3 1  ON 1
ci_003                -6.062389e-02 3 1  ON 2
ci_004                -6.144451e-02 3 1  ON 3
ci_005                 4.492190e-02 3 1  ON 4
ci_006                 4.689887e-02 3 1  ON 5
ci_007                 3.191440e-02 3 1  ON 6
ci_008                 3.270283e-02 3 1  ON 7
ci_009                -2.428481e-02 3 1  ON 8
ci_010                -2.574960e-02 3 1  ON 9
ci_011                -2.213718e-02 3 1  ON 10
ci_012                -2.234754e-02 3 1  ON 11
ci_013                 2.010619e-02 3 1  ON 12
ci_014                 2.061396e-02 3 1  ON 13
ci_015                 2.013556e-02 3 1  ON 14
ci_016                 2.032685e-02 3 1  ON 15
ci_017                 1.517249e-02 3 1  ON 16
ci_018                 1.596739e-02 3 1  ON 17
ci_019                 8.939022e-03 3 1  ON 18
ci_020                 1.007942e-02 3 1  ON 19
ci_021                -9.046892e-03 3 1  ON 20
ci_022                -1.073201e-02 3 1  ON 21
ci_023                 9.063377e-03 3 1  ON 22
ci_024                 9.090663e-03 3 1  ON 23
ci_025                 7.930036e-03 3 1  ON 24
ci_026                 8.226757e-03 3 1  ON 25
ci_027                 7.483868e-03 3 1  ON 26
ci_028                 8.090712e-03 3 1  ON 27
ci_029                -8.223214e-03 3 1  ON 28
ci_030                -8.464400e-03 3 1  ON 29
ci_031                -7.812206e-03 3 1  ON 30
ci_032                -7.195822e-03 3 1  ON 31
ci_033                 6.447312e-03 3 1  ON 32
ci_034                 6.730851e-03 3 1  ON 33
ci_035                 6.438451e-03 3 1  ON 34
ci_036                 6.300404e-03 3 1  ON 35
ci_037                 6.795776e-03 3 1  ON 36
ci_038                 7.301185e-03 3 1  ON 37
ci_039                 6.033832e-03 3 1  ON 38
ci_040                 5.342697e-03 3 1  ON 39
ci_041                 4.975771e-03 3 1  ON 40
ci_042                 5.454775e-03 3 1  ON 41
ci_043                 5.033158e-03 3 1  ON 42
ci_044                 5.323081e-03 3 1  ON 43
ci_045                 5.667547e-03 3 1  ON 44
ci_046                 6.320148e-03 3 1  ON 45
ci_047                -4.136988e-03 3 1  ON 46
ci_048                -4.240898e-03 3 1  ON 47
ci_049                 3.312865e-03 3 1  ON 48
ci_050                 4.212466e-03 3 1  ON 49
ci_051                -2.317856e-03 3 1  ON 50
ci_052                -4.372948e-03 3 1  ON 51
ci_053                -2.367176e-03 3 1  ON 52
ci_054                -2.976562e-03 3 1  ON 53
ci_055                -3.703197e-03 3 1  ON 54
ci_056                -2.498379e-03 3 1  ON 55
ci_057                -2.999454e-03 3 1  ON 56
ci_058                -1.933208e-03 3 1  ON 57
ci_059                -1.740205e-03 3 1  ON 58
ci_060                -1.742951e-03 3 1  ON 59
ci_061                -6.022853e-04 3 1  ON 60
ci_062                -1.309278e-03 3 1  ON 61
ci_063                -1.535123e-03 3 1  ON 62
ci_064                -1.445846e-03 3 1  ON 63
ci_065                -1.522869e-03 3 1  ON 64
ci_066                -1.152392e-03 3 1  ON 65
ci_067                -2.900462e-04 3 1  ON 66
ci_068                -1.431836e-03 3 1  ON 67
ci_069                 1.930317e-03 3 1  ON 68
ci_070                 1.245936e-03 3 1  ON 69
ci_071                -4.794365e-04 3 1  ON 70
ci_072                -1.009166e-04 3 1  ON 71
ci_073                 5.499138e-04 3 1  ON 72
ci_074                 8.583014e-04 3 1  ON 73
ci_075                -1.129184e-03 3 1  ON 74
ci_076                -5.254681e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.4716
    reference variance = 2.19503
====================================================
  Execution time = 2.4340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0303e+04
  VMC Eavg = -2.2327e+01
  VMC Evar = 3.7276e+00
  Total weights = 1.949736314e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9592e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779432815508
                                         uncertainty =       0.035547404629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.779432815508
                                         uncertainty =       0.035547404629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001374692014
  error estimate for blocks of size 2^( 2) =       0.001445302021
  error estimate for blocks of size 2^( 3) =       0.001509479416
  error estimate for blocks of size 2^( 4) =       0.001555707464
  error estimate for blocks of size 2^( 5) =       0.001581144515
  error estimate for blocks of size 2^( 6) =       0.001591051424
  error estimate for blocks of size 2^( 7) =       0.001596599247

      target function =                  N/A
              le_mean =     -22.326654036636
             les_mean =     502.207065235527
             stat err =       0.001581125662
             autocorr =       1.322884584784
              std dev =       1.944139195233
             le_variance =       3.779677210442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232665403664e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e-02, overlap shift 3.2312e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326654035804       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326742123032       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326749859422       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326748467271       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326747912526       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.326747886139       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e-02 is 1.898750e-03

solving harmonic davidson linear method for identity shift 1.2925e-01, overlap shift 1.2925e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326654035804       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326716062848       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326719116035       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326718514268       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326718420705       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e-01 is 1.264457e-03

solving harmonic davidson linear method for identity shift 5.1699e-01, overlap shift 5.1699e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326654035804       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326682444265       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326682890997       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326682821270       residual = 2.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e-01 is 5.563544e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0310e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -6.877896e-01 3 1  ON 0
ci_002                -7.129116e-01 3 1  ON 1
ci_003                -6.075850e-02 3 1  ON 2
ci_004                -6.232865e-02 3 1  ON 3
ci_005                 4.523581e-02 3 1  ON 4
ci_006                 4.712269e-02 3 1  ON 5
ci_007                 3.199260e-02 3 1  ON 6
ci_008                 3.302134e-02 3 1  ON 7
ci_009                -2.554926e-02 3 1  ON 8
ci_010                -2.609721e-02 3 1  ON 9
ci_011                -2.238953e-02 3 1  ON 10
ci_012                -2.271387e-02 3 1  ON 11
ci_013                 2.086669e-02 3 1  ON 12
ci_014                 2.107298e-02 3 1  ON 13
ci_015                 2.082465e-02 3 1  ON 14
ci_016                 2.025842e-02 3 1  ON 15
ci_017                 1.538362e-02 3 1  ON 16
ci_018                 1.642178e-02 3 1  ON 17
ci_019                 9.195620e-03 3 1  ON 18
ci_020                 1.004313e-02 3 1  ON 19
ci_021                -9.834434e-03 3 1  ON 20
ci_022                -1.066381e-02 3 1  ON 21
ci_023                 8.658713e-03 3 1  ON 22
ci_024                 9.522844e-03 3 1  ON 23
ci_025                 8.785448e-03 3 1  ON 24
ci_026                 8.353721e-03 3 1  ON 25
ci_027                 8.027886e-03 3 1  ON 26
ci_028                 8.271993e-03 3 1  ON 27
ci_029                -8.166016e-03 3 1  ON 28
ci_030                -7.736104e-03 3 1  ON 29
ci_031                -7.703659e-03 3 1  ON 30
ci_032                -8.120969e-03 3 1  ON 31
ci_033                 6.748022e-03 3 1  ON 32
ci_034                 7.841807e-03 3 1  ON 33
ci_035                 6.209459e-03 3 1  ON 34
ci_036                 6.710449e-03 3 1  ON 35
ci_037                 5.703634e-03 3 1  ON 36
ci_038                 6.374903e-03 3 1  ON 37
ci_039                 5.782861e-03 3 1  ON 38
ci_040                 5.100318e-03 3 1  ON 39
ci_041                 4.749803e-03 3 1  ON 40
ci_042                 5.652878e-03 3 1  ON 41
ci_043                 4.845262e-03 3 1  ON 42
ci_044                 5.309915e-03 3 1  ON 43
ci_045                 4.996102e-03 3 1  ON 44
ci_046                 5.338260e-03 3 1  ON 45
ci_047                -4.555822e-03 3 1  ON 46
ci_048                -4.331203e-03 3 1  ON 47
ci_049                 3.163881e-03 3 1  ON 48
ci_050                 3.936933e-03 3 1  ON 49
ci_051                -2.006902e-03 3 1  ON 50
ci_052                -4.643542e-03 3 1  ON 51
ci_053                -2.055682e-03 3 1  ON 52
ci_054                -3.421001e-03 3 1  ON 53
ci_055                -2.749300e-03 3 1  ON 54
ci_056                -2.312136e-03 3 1  ON 55
ci_057                -3.317218e-03 3 1  ON 56
ci_058                -2.518397e-03 3 1  ON 57
ci_059                -1.058953e-03 3 1  ON 58
ci_060                -1.671447e-03 3 1  ON 59
ci_061                -1.246209e-03 3 1  ON 60
ci_062                -9.976938e-04 3 1  ON 61
ci_063                -1.518078e-03 3 1  ON 62
ci_064                -2.067344e-03 3 1  ON 63
ci_065                -1.402958e-03 3 1  ON 64
ci_066                -9.910588e-04 3 1  ON 65
ci_067                -4.995468e-04 3 1  ON 66
ci_068                -1.916240e-03 3 1  ON 67
ci_069                 9.003307e-04 3 1  ON 68
ci_070                 9.109891e-04 3 1  ON 69
ci_071                -1.425101e-03 3 1  ON 70
ci_072                -6.011122e-04 3 1  ON 71
ci_073                 8.605562e-04 3 1  ON 72
ci_074                 1.346589e-03 3 1  ON 73
ci_075                -6.438712e-04 3 1  ON 74
ci_076                -8.284601e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.0567
    reference variance = 4.65547
====================================================
  Execution time = 2.3873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.9141e+00
  Total weights = 1.9500e+06
  Execution time = 4.4195e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.142438
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.967457809330
                                         uncertainty =       0.193237982620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.967457809330
                                         uncertainty =       0.193237982620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408297391
  error estimate for blocks of size 2^( 2) =       0.001478323909
  error estimate for blocks of size 2^( 3) =       0.001540228094
  error estimate for blocks of size 2^( 4) =       0.001584772675
  error estimate for blocks of size 2^( 5) =       0.001608930367
  error estimate for blocks of size 2^( 6) =       0.001623287303
  error estimate for blocks of size 2^( 7) =       0.001632657055

      target function =                  N/A
              le_mean =     -22.325711125066
             les_mean =     502.351704261027
             stat err =       0.001612411850
             autocorr =       1.310880830703
              std dev =       1.991665136629
             le_variance =       3.966730016464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.967918287429
                                         uncertainty =       0.193238946344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.967918287429
                                         uncertainty =       0.193238946344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408379283
  error estimate for blocks of size 2^( 2) =       0.001478359439
  error estimate for blocks of size 2^( 3) =       0.001540222629
  error estimate for blocks of size 2^( 4) =       0.001584721794
  error estimate for blocks of size 2^( 5) =       0.001608838406
  error estimate for blocks of size 2^( 6) =       0.001623176355
  error estimate for blocks of size 2^( 7) =       0.001632601743

      target function =                  N/A
              le_mean =     -22.325680528536
             les_mean =     502.363322001709
             stat err =       0.001612334574
             autocorr =       1.310602758957
              std dev =       1.991780950614
             le_variance =       3.967191355228

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.148395
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.970293224540
                                         uncertainty =       0.193264633858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.970293224540
                                         uncertainty =       0.193264633858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408799311
  error estimate for blocks of size 2^( 2) =       0.001478731495
  error estimate for blocks of size 2^( 3) =       0.001540516744
  error estimate for blocks of size 2^( 4) =       0.001584970580
  error estimate for blocks of size 2^( 5) =       0.001609039679
  error estimate for blocks of size 2^( 6) =       0.001623439914
  error estimate for blocks of size 2^( 7) =       0.001633044226

      target function =                  N/A
              le_mean =     -22.325680761802
             les_mean =     502.643790292266
             stat err =       0.001612623600
             autocorr =       1.310291009564
              std dev =       1.992374969784
             le_variance =       3.969558020223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.967613488232
                                         uncertainty =       0.193238527013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.967613488232
                                         uncertainty =       0.193238527013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001408325063
  error estimate for blocks of size 2^( 2) =       0.001478332196
  error estimate for blocks of size 2^( 3) =       0.001540228152
  error estimate for blocks of size 2^( 4) =       0.001584752824
  error estimate for blocks of size 2^( 5) =       0.001608891614
  error estimate for blocks of size 2^( 6) =       0.001623240352
  error estimate for blocks of size 2^( 7) =       0.001632650761

      target function =                  N/A
              le_mean =     -22.325677257770
             les_mean =     502.393774980367
             stat err =       0.001612383888
             autocorr =       1.310783853983
              std dev =       1.991704270413
             le_variance =       3.966885900782


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325711125066        initial  <--
     3.2312e-02     3.2312e-01             1.8987e-03       -22.325680528536
     1.2925e-01     1.2925e+00             1.2645e-03       -22.325680761802
     5.1699e-01     5.1699e+00             5.5635e-04       -22.325677257770

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.8694
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -6.879664e-01 3 1  ON 0
ci_002                -7.130250e-01 3 1  ON 1
ci_003                -6.062389e-02 3 1  ON 2
ci_004                -6.144451e-02 3 1  ON 3
ci_005                 4.492190e-02 3 1  ON 4
ci_006                 4.689887e-02 3 1  ON 5
ci_007                 3.191440e-02 3 1  ON 6
ci_008                 3.270283e-02 3 1  ON 7
ci_009                -2.428481e-02 3 1  ON 8
ci_010                -2.574960e-02 3 1  ON 9
ci_011                -2.213718e-02 3 1  ON 10
ci_012                -2.234754e-02 3 1  ON 11
ci_013                 2.010619e-02 3 1  ON 12
ci_014                 2.061396e-02 3 1  ON 13
ci_015                 2.013556e-02 3 1  ON 14
ci_016                 2.032685e-02 3 1  ON 15
ci_017                 1.517249e-02 3 1  ON 16
ci_018                 1.596739e-02 3 1  ON 17
ci_019                 8.939022e-03 3 1  ON 18
ci_020                 1.007942e-02 3 1  ON 19
ci_021                -9.046892e-03 3 1  ON 20
ci_022                -1.073201e-02 3 1  ON 21
ci_023                 9.063377e-03 3 1  ON 22
ci_024                 9.090663e-03 3 1  ON 23
ci_025                 7.930036e-03 3 1  ON 24
ci_026                 8.226757e-03 3 1  ON 25
ci_027                 7.483868e-03 3 1  ON 26
ci_028                 8.090712e-03 3 1  ON 27
ci_029                -8.223214e-03 3 1  ON 28
ci_030                -8.464400e-03 3 1  ON 29
ci_031                -7.812206e-03 3 1  ON 30
ci_032                -7.195822e-03 3 1  ON 31
ci_033                 6.447312e-03 3 1  ON 32
ci_034                 6.730851e-03 3 1  ON 33
ci_035                 6.438451e-03 3 1  ON 34
ci_036                 6.300404e-03 3 1  ON 35
ci_037                 6.795776e-03 3 1  ON 36
ci_038                 7.301185e-03 3 1  ON 37
ci_039                 6.033832e-03 3 1  ON 38
ci_040                 5.342697e-03 3 1  ON 39
ci_041                 4.975771e-03 3 1  ON 40
ci_042                 5.454775e-03 3 1  ON 41
ci_043                 5.033158e-03 3 1  ON 42
ci_044                 5.323081e-03 3 1  ON 43
ci_045                 5.667547e-03 3 1  ON 44
ci_046                 6.320148e-03 3 1  ON 45
ci_047                -4.136988e-03 3 1  ON 46
ci_048                -4.240898e-03 3 1  ON 47
ci_049                 3.312865e-03 3 1  ON 48
ci_050                 4.212466e-03 3 1  ON 49
ci_051                -2.317856e-03 3 1  ON 50
ci_052                -4.372948e-03 3 1  ON 51
ci_053                -2.367176e-03 3 1  ON 52
ci_054                -2.976562e-03 3 1  ON 53
ci_055                -3.703197e-03 3 1  ON 54
ci_056                -2.498379e-03 3 1  ON 55
ci_057                -2.999454e-03 3 1  ON 56
ci_058                -1.933208e-03 3 1  ON 57
ci_059                -1.740205e-03 3 1  ON 58
ci_060                -1.742951e-03 3 1  ON 59
ci_061                -6.022853e-04 3 1  ON 60
ci_062                -1.309278e-03 3 1  ON 61
ci_063                -1.535123e-03 3 1  ON 62
ci_064                -1.445846e-03 3 1  ON 63
ci_065                -1.522869e-03 3 1  ON 64
ci_066                -1.152392e-03 3 1  ON 65
ci_067                -2.900462e-04 3 1  ON 66
ci_068                -1.431836e-03 3 1  ON 67
ci_069                 1.930317e-03 3 1  ON 68
ci_070                 1.245936e-03 3 1  ON 69
ci_071                -4.794365e-04 3 1  ON 70
ci_072                -1.009166e-04 3 1  ON 71
ci_073                 5.499138e-04 3 1  ON 72
ci_074                 8.583014e-04 3 1  ON 73
ci_075                -1.129184e-03 3 1  ON 74
ci_076                -5.254681e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9195e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.3348
    reference variance = 4.31644
====================================================
  Execution time = 2.4332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0300e+04
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7226e+00
  Total weights = 1.949968413e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9324e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774485666932
                                         uncertainty =       0.055353142373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.774485666932
                                         uncertainty =       0.055353142373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001373674560
  error estimate for blocks of size 2^( 2) =       0.001444037659
  error estimate for blocks of size 2^( 3) =       0.001508687819
  error estimate for blocks of size 2^( 4) =       0.001553678408
  error estimate for blocks of size 2^( 5) =       0.001581409752
  error estimate for blocks of size 2^( 6) =       0.001594455762
  error estimate for blocks of size 2^( 7) =       0.001602474394

      target function =                  N/A
              le_mean =     -22.326028291056
             les_mean =     502.174168700695
             stat err =       0.001583004579
             autocorr =       1.327995585767
              std dev =       1.942700275400
             le_variance =       3.774084360041


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232602829106e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e-01, overlap shift 3.2312e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326028290258       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326084331004       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326085242514       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.326085324368       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.326085305945       residual = 2.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e-01 is 8.650870e-04

solving harmonic davidson linear method for identity shift 1.2925e+00, overlap shift 1.2925e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326028290258       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326047427736       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326047462459       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+00 is 2.735654e-04

solving harmonic davidson linear method for identity shift 5.1699e+00, overlap shift 5.1699e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.326028290258       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.326033556430       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.326033563182       residual = 2.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+00 is 7.366830e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262780 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0275e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -6.881504e-01 3 1  ON 0
ci_002                -7.128027e-01 3 1  ON 1
ci_003                -6.072502e-02 3 1  ON 2
ci_004                -6.161662e-02 3 1  ON 3
ci_005                 4.500089e-02 3 1  ON 4
ci_006                 4.692635e-02 3 1  ON 5
ci_007                 3.191515e-02 3 1  ON 6
ci_008                 3.284879e-02 3 1  ON 7
ci_009                -2.451454e-02 3 1  ON 8
ci_010                -2.580549e-02 3 1  ON 9
ci_011                -2.208480e-02 3 1  ON 10
ci_012                -2.241749e-02 3 1  ON 11
ci_013                 2.018027e-02 3 1  ON 12
ci_014                 2.071706e-02 3 1  ON 13
ci_015                 2.008553e-02 3 1  ON 14
ci_016                 2.018701e-02 3 1  ON 15
ci_017                 1.509635e-02 3 1  ON 16
ci_018                 1.610381e-02 3 1  ON 17
ci_019                 9.212587e-03 3 1  ON 18
ci_020                 1.025121e-02 3 1  ON 19
ci_021                -8.949229e-03 3 1  ON 20
ci_022                -1.056329e-02 3 1  ON 21
ci_023                 8.933826e-03 3 1  ON 22
ci_024                 9.159945e-03 3 1  ON 23
ci_025                 8.110544e-03 3 1  ON 24
ci_026                 8.311394e-03 3 1  ON 25
ci_027                 7.352808e-03 3 1  ON 26
ci_028                 8.133534e-03 3 1  ON 27
ci_029                -8.007386e-03 3 1  ON 28
ci_030                -8.447654e-03 3 1  ON 29
ci_031                -7.695661e-03 3 1  ON 30
ci_032                -7.326008e-03 3 1  ON 31
ci_033                 6.324219e-03 3 1  ON 32
ci_034                 6.827186e-03 3 1  ON 33
ci_035                 6.389008e-03 3 1  ON 34
ci_036                 6.388452e-03 3 1  ON 35
ci_037                 6.721219e-03 3 1  ON 36
ci_038                 7.154493e-03 3 1  ON 37
ci_039                 5.827745e-03 3 1  ON 38
ci_040                 5.400497e-03 3 1  ON 39
ci_041                 4.969396e-03 3 1  ON 40
ci_042                 5.549212e-03 3 1  ON 41
ci_043                 4.947949e-03 3 1  ON 42
ci_044                 5.316652e-03 3 1  ON 43
ci_045                 5.490171e-03 3 1  ON 44
ci_046                 6.306472e-03 3 1  ON 45
ci_047                -4.249497e-03 3 1  ON 46
ci_048                -4.341671e-03 3 1  ON 47
ci_049                 3.188565e-03 3 1  ON 48
ci_050                 4.116333e-03 3 1  ON 49
ci_051                -2.414017e-03 3 1  ON 50
ci_052                -4.118927e-03 3 1  ON 51
ci_053                -2.583486e-03 3 1  ON 52
ci_054                -3.093967e-03 3 1  ON 53
ci_055                -3.542699e-03 3 1  ON 54
ci_056                -2.428486e-03 3 1  ON 55
ci_057                -2.878717e-03 3 1  ON 56
ci_058                -2.154938e-03 3 1  ON 57
ci_059                -1.831346e-03 3 1  ON 58
ci_060                -1.770652e-03 3 1  ON 59
ci_061                -7.025898e-04 3 1  ON 60
ci_062                -1.418023e-03 3 1  ON 61
ci_063                -1.688103e-03 3 1  ON 62
ci_064                -1.377587e-03 3 1  ON 63
ci_065                -1.480835e-03 3 1  ON 64
ci_066                -1.210895e-03 3 1  ON 65
ci_067                -1.213491e-04 3 1  ON 66
ci_068                -1.497889e-03 3 1  ON 67
ci_069                 1.954103e-03 3 1  ON 68
ci_070                 1.219753e-03 3 1  ON 69
ci_071                -5.680047e-04 3 1  ON 70
ci_072                -1.926909e-04 3 1  ON 71
ci_073                 6.488349e-04 3 1  ON 72
ci_074                 1.052867e-03 3 1  ON 73
ci_075                -1.132625e-03 3 1  ON 74
ci_076                -6.945980e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.1464
    reference variance = 3.61944
====================================================
  Execution time = 2.3728e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7314e+00
  Total weights = 1.9500e+06
  Execution time = 4.4095e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783147231484
                                         uncertainty =       0.039162457987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783147231484
                                         uncertainty =       0.039162457987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375207640
  error estimate for blocks of size 2^( 2) =       0.001446527670
  error estimate for blocks of size 2^( 3) =       0.001509033346
  error estimate for blocks of size 2^( 4) =       0.001552469127
  error estimate for blocks of size 2^( 5) =       0.001575628525
  error estimate for blocks of size 2^( 6) =       0.001589055453
  error estimate for blocks of size 2^( 7) =       0.001590149564

      target function =                  N/A
              le_mean =     -22.328825544758
             les_mean =     502.310612501450
             stat err =       0.001576825667
             autocorr =       1.314712548592
              std dev =       1.944868413287
             le_variance =       3.782513145001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783174070304
                                         uncertainty =       0.039170554035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783174070304
                                         uncertainty =       0.039170554035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375212711
  error estimate for blocks of size 2^( 2) =       0.001446521444
  error estimate for blocks of size 2^( 3) =       0.001509013239
  error estimate for blocks of size 2^( 4) =       0.001552433160
  error estimate for blocks of size 2^( 5) =       0.001575580872
  error estimate for blocks of size 2^( 6) =       0.001589017823
  error estimate for blocks of size 2^( 7) =       0.001590128105

      target function =                  N/A
              le_mean =     -22.328829258524
             les_mean =     502.335659706145
             stat err =       0.001576789990
             autocorr =       1.314643362014
              std dev =       1.944875584265
             le_variance =       3.782541038268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783147914328
                                         uncertainty =       0.039168239789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783147914328
                                         uncertainty =       0.039168239789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375207902
  error estimate for blocks of size 2^( 2) =       0.001446519750
  error estimate for blocks of size 2^( 3) =       0.001509016547
  error estimate for blocks of size 2^( 4) =       0.001552440222
  error estimate for blocks of size 2^( 5) =       0.001575592553
  error estimate for blocks of size 2^( 6) =       0.001589023703
  error estimate for blocks of size 2^( 7) =       0.001590129558

      target function =                  N/A
              le_mean =     -22.328823193320
             les_mean =     502.308424584655
             stat err =       0.001576796509
             autocorr =       1.314663425869
              std dev =       1.944868783480
             le_variance =       3.782514584956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783142003548
                                         uncertainty =       0.039163325969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.783142003548
                                         uncertainty =       0.039163325969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001375206710
  error estimate for blocks of size 2^( 2) =       0.001446526089
  error estimate for blocks of size 2^( 3) =       0.001509030969
  error estimate for blocks of size 2^( 4) =       0.001552465934
  error estimate for blocks of size 2^( 5) =       0.001575624903
  error estimate for blocks of size 2^( 6) =       0.001589052508
  error estimate for blocks of size 2^( 7) =       0.001590146529

      target function =                  N/A
              le_mean =     -22.328823705829
             les_mean =     502.309726406856
             stat err =       0.001576822468
             autocorr =       1.314708993222
              std dev =       1.944867097716
             le_variance =       3.782508027777


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.328825544758        initial
     3.2312e-01     3.2312e+00             8.6509e-04       -22.328829258524  <--
     1.2925e+00     1.2925e+01             2.7357e-04       -22.328823193320
     5.1699e+00     5.1699e+01             7.3668e-05       -22.328823705829

*****************************************************************************
Applying the update for shift_i =   3.2312e-01     and shift_s =   3.2312e+00
*****************************************************************************

  Execution time = 4.5871e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -6.887173e-01 3 1  ON 0
ci_002                -7.121599e-01 3 1  ON 1
ci_003                -6.098831e-02 3 1  ON 2
ci_004                -6.204950e-02 3 1  ON 3
ci_005                 4.515532e-02 3 1  ON 4
ci_006                 4.694823e-02 3 1  ON 5
ci_007                 3.192807e-02 3 1  ON 6
ci_008                 3.310211e-02 3 1  ON 7
ci_009                -2.495839e-02 3 1  ON 8
ci_010                -2.590264e-02 3 1  ON 9
ci_011                -2.194542e-02 3 1  ON 10
ci_012                -2.253627e-02 3 1  ON 11
ci_013                 2.031832e-02 3 1  ON 12
ci_014                 2.090168e-02 3 1  ON 13
ci_015                 1.995364e-02 3 1  ON 14
ci_016                 1.987507e-02 3 1  ON 15
ci_017                 1.494822e-02 3 1  ON 16
ci_018                 1.638994e-02 3 1  ON 17
ci_019                 9.789036e-03 3 1  ON 18
ci_020                 1.060566e-02 3 1  ON 19
ci_021                -8.778995e-03 3 1  ON 20
ci_022                -1.019796e-02 3 1  ON 21
ci_023                 8.698232e-03 3 1  ON 22
ci_024                 9.286576e-03 3 1  ON 23
ci_025                 8.462929e-03 3 1  ON 24
ci_026                 8.448523e-03 3 1  ON 25
ci_027                 7.155615e-03 3 1  ON 26
ci_028                 8.196044e-03 3 1  ON 27
ci_029                -7.614028e-03 3 1  ON 28
ci_030                -8.408695e-03 3 1  ON 29
ci_031                -7.474159e-03 3 1  ON 30
ci_032                -7.622648e-03 3 1  ON 31
ci_033                 6.093195e-03 3 1  ON 32
ci_034                 7.021209e-03 3 1  ON 33
ci_035                 6.314219e-03 3 1  ON 34
ci_036                 6.542694e-03 3 1  ON 35
ci_037                 6.584484e-03 3 1  ON 36
ci_038                 6.887133e-03 3 1  ON 37
ci_039                 5.514815e-03 3 1  ON 38
ci_040                 5.490341e-03 3 1  ON 39
ci_041                 4.957948e-03 3 1  ON 40
ci_042                 5.709962e-03 3 1  ON 41
ci_043                 4.798376e-03 3 1  ON 42
ci_044                 5.326583e-03 3 1  ON 43
ci_045                 5.156425e-03 3 1  ON 44
ci_046                 6.270951e-03 3 1  ON 45
ci_047                -4.433290e-03 3 1  ON 46
ci_048                -4.496999e-03 3 1  ON 47
ci_049                 2.936652e-03 3 1  ON 48
ci_050                 3.927521e-03 3 1  ON 49
ci_051                -2.607418e-03 3 1  ON 50
ci_052                -3.618574e-03 3 1  ON 51
ci_053                -3.028865e-03 3 1  ON 52
ci_054                -3.326644e-03 3 1  ON 53
ci_055                -3.225062e-03 3 1  ON 54
ci_056                -2.273538e-03 3 1  ON 55
ci_057                -2.658607e-03 3 1  ON 56
ci_058                -2.573160e-03 3 1  ON 57
ci_059                -1.994603e-03 3 1  ON 58
ci_060                -1.844062e-03 3 1  ON 59
ci_061                -8.997431e-04 3 1  ON 60
ci_062                -1.643127e-03 3 1  ON 61
ci_063                -1.981852e-03 3 1  ON 62
ci_064                -1.237325e-03 3 1  ON 63
ci_065                -1.429055e-03 3 1  ON 64
ci_066                -1.335334e-03 3 1  ON 65
ci_067                 2.008830e-04 3 1  ON 66
ci_068                -1.632279e-03 3 1  ON 67
ci_069                 2.002598e-03 3 1  ON 68
ci_070                 1.180187e-03 3 1  ON 69
ci_071                -7.276996e-04 3 1  ON 70
ci_072                -3.992563e-04 3 1  ON 71
ci_073                 8.063559e-04 3 1  ON 72
ci_074                 1.363408e-03 3 1  ON 73
ci_075                -1.141667e-03 3 1  ON 74
ci_076                -1.011636e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6161e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2309e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.2762
    reference variance = 5.56156
====================================================
  Execution time = 2.4412e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0290e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.6545e+00
  Total weights = 1.949567015e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9688e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.705233710796
                                         uncertainty =       0.032799520536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.705233710796
                                         uncertainty =       0.032799520536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001360976189
  error estimate for blocks of size 2^( 2) =       0.001432514646
  error estimate for blocks of size 2^( 3) =       0.001495780921
  error estimate for blocks of size 2^( 4) =       0.001538454155
  error estimate for blocks of size 2^( 5) =       0.001562129822
  error estimate for blocks of size 2^( 6) =       0.001572343750
  error estimate for blocks of size 2^( 7) =       0.001574552533

      target function =                  N/A
              le_mean =     -22.328688361003
             les_mean =     502.224776534935
             stat err =       0.001561870065
             autocorr =       1.317009017100
              std dev =       1.924741779323
             le_variance =       3.704630917070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232868836100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.0779e-02, overlap shift 8.0779e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328688360208       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328754589658       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328754783136       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328756095951       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.328757456744       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.328757390698       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.328757437682       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.0779e-02 is 1.606400e-03

solving harmonic davidson linear method for identity shift 3.2312e-01, overlap shift 3.2312e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328688360208       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328722389886       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328722103462       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.328722228337       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e-01 is 7.885052e-04

solving harmonic davidson linear method for identity shift 1.2925e+00, overlap shift 1.2925e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.328688360208       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.328699916219       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.328699931784       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+00 is 2.769844e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0392e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -6.883420e-01 3 1  ON 0
ci_002                -7.125397e-01 3 1  ON 1
ci_003                -6.043730e-02 3 1  ON 2
ci_004                -6.255711e-02 3 1  ON 3
ci_005                 4.511519e-02 3 1  ON 4
ci_006                 4.656995e-02 3 1  ON 5
ci_007                 3.187533e-02 3 1  ON 6
ci_008                 3.330382e-02 3 1  ON 7
ci_009                -2.465030e-02 3 1  ON 8
ci_010                -2.534647e-02 3 1  ON 9
ci_011                -2.255803e-02 3 1  ON 10
ci_012                -2.194306e-02 3 1  ON 11
ci_013                 1.994774e-02 3 1  ON 12
ci_014                 2.102898e-02 3 1  ON 13
ci_015                 2.039785e-02 3 1  ON 14
ci_016                 1.965933e-02 3 1  ON 15
ci_017                 1.561339e-02 3 1  ON 16
ci_018                 1.634663e-02 3 1  ON 17
ci_019                 9.515948e-03 3 1  ON 18
ci_020                 1.072183e-02 3 1  ON 19
ci_021                -9.329075e-03 3 1  ON 20
ci_022                -1.035497e-02 3 1  ON 21
ci_023                 8.712399e-03 3 1  ON 22
ci_024                 9.337862e-03 3 1  ON 23
ci_025                 8.525461e-03 3 1  ON 24
ci_026                 8.351500e-03 3 1  ON 25
ci_027                 7.476380e-03 3 1  ON 26
ci_028                 8.525971e-03 3 1  ON 27
ci_029                -8.011238e-03 3 1  ON 28
ci_030                -8.506729e-03 3 1  ON 29
ci_031                -7.345534e-03 3 1  ON 30
ci_032                -8.212739e-03 3 1  ON 31
ci_033                 6.528586e-03 3 1  ON 32
ci_034                 7.085013e-03 3 1  ON 33
ci_035                 6.671998e-03 3 1  ON 34
ci_036                 6.792921e-03 3 1  ON 35
ci_037                 6.120499e-03 3 1  ON 36
ci_038                 6.563951e-03 3 1  ON 37
ci_039                 5.508626e-03 3 1  ON 38
ci_040                 5.245073e-03 3 1  ON 39
ci_041                 5.095690e-03 3 1  ON 40
ci_042                 5.420020e-03 3 1  ON 41
ci_043                 5.174245e-03 3 1  ON 42
ci_044                 5.097995e-03 3 1  ON 43
ci_045                 5.751190e-03 3 1  ON 44
ci_046                 6.073135e-03 3 1  ON 45
ci_047                -4.315553e-03 3 1  ON 46
ci_048                -4.655440e-03 3 1  ON 47
ci_049                 3.699884e-03 3 1  ON 48
ci_050                 3.536101e-03 3 1  ON 49
ci_051                -3.004110e-03 3 1  ON 50
ci_052                -3.601465e-03 3 1  ON 51
ci_053                -3.407327e-03 3 1  ON 52
ci_054                -3.460624e-03 3 1  ON 53
ci_055                -2.847203e-03 3 1  ON 54
ci_056                -2.068613e-03 3 1  ON 55
ci_057                -2.249694e-03 3 1  ON 56
ci_058                -1.784655e-03 3 1  ON 57
ci_059                -1.958973e-03 3 1  ON 58
ci_060                -1.918332e-03 3 1  ON 59
ci_061                -1.266847e-03 3 1  ON 60
ci_062                -1.465446e-03 3 1  ON 61
ci_063                -1.473153e-03 3 1  ON 62
ci_064                -1.701489e-03 3 1  ON 63
ci_065                -1.195686e-03 3 1  ON 64
ci_066                -1.063696e-03 3 1  ON 65
ci_067                -3.219479e-04 3 1  ON 66
ci_068                -2.027092e-03 3 1  ON 67
ci_069                 1.943398e-03 3 1  ON 68
ci_070                 1.165250e-03 3 1  ON 69
ci_071                -9.351220e-04 3 1  ON 70
ci_072                -7.451982e-04 3 1  ON 71
ci_073                 9.299724e-04 3 1  ON 72
ci_074                 1.119364e-03 3 1  ON 73
ci_075                -1.009190e-03 3 1  ON 74
ci_076                -1.372433e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.5965
    reference variance = 2.85824
====================================================
  Execution time = 2.3813e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2325e+01
  VMC Evar = 3.7653e+00
  Total weights = 1.9502e+06
  Execution time = 4.4072e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815221779837
                                         uncertainty =       0.034374314638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815221779837
                                         uncertainty =       0.034374314638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381583734
  error estimate for blocks of size 2^( 2) =       0.001453217049
  error estimate for blocks of size 2^( 3) =       0.001516009091
  error estimate for blocks of size 2^( 4) =       0.001558867045
  error estimate for blocks of size 2^( 5) =       0.001585960827
  error estimate for blocks of size 2^( 6) =       0.001603146623
  error estimate for blocks of size 2^( 7) =       0.001603357953

      target function =                  N/A
              le_mean =     -22.325303656054
             les_mean =     502.476782462217
             stat err =       0.001587833112
             autocorr =       1.320855429860
              std dev =       1.953885715216
             le_variance =       3.817669388124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815040583210
                                         uncertainty =       0.034421960237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815040583210
                                         uncertainty =       0.034421960237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381550702
  error estimate for blocks of size 2^( 2) =       0.001453203048
  error estimate for blocks of size 2^( 3) =       0.001516003232
  error estimate for blocks of size 2^( 4) =       0.001558852531
  error estimate for blocks of size 2^( 5) =       0.001585941118
  error estimate for blocks of size 2^( 6) =       0.001603147078
  error estimate for blocks of size 2^( 7) =       0.001603469004

      target function =                  N/A
              le_mean =     -22.325309577854
             les_mean =     502.188453365256
             stat err =       0.001587852433
             autocorr =       1.320950738001
              std dev =       1.953839000486
             le_variance =       3.817486839820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815006333086
                                         uncertainty =       0.034419514552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815006333086
                                         uncertainty =       0.034419514552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381544484
  error estimate for blocks of size 2^( 2) =       0.001453198284
  error estimate for blocks of size 2^( 3) =       0.001516004757
  error estimate for blocks of size 2^( 4) =       0.001558857515
  error estimate for blocks of size 2^( 5) =       0.001585946676
  error estimate for blocks of size 2^( 6) =       0.001603157877
  error estimate for blocks of size 2^( 7) =       0.001603487564

      target function =                  N/A
              le_mean =     -22.325307682841
             les_mean =     502.186446296490
             stat err =       0.001587862408
             autocorr =       1.320979226072
              std dev =       1.953830206459
             le_variance =       3.817452475672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815194096655
                                         uncertainty =       0.034406607039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.815194096655
                                         uncertainty =       0.034406607039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001381578356
  error estimate for blocks of size 2^( 2) =       0.001453217294
  error estimate for blocks of size 2^( 3) =       0.001516028588
  error estimate for blocks of size 2^( 4) =       0.001558892951
  error estimate for blocks of size 2^( 5) =       0.001585953999
  error estimate for blocks of size 2^( 6) =       0.001603169837
  error estimate for blocks of size 2^( 7) =       0.001603465722

      target function =                  N/A
              le_mean =     -22.325323682834
             les_mean =     502.345943935040
             stat err =       0.001587870627
             autocorr =       1.320928128368
              std dev =       1.953878110034
             le_variance =       3.817639668869


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.325303656054        initial
     8.0779e-02     8.0779e-01             1.6064e-03       -22.325309577854
     3.2312e-01     3.2312e+00             7.8851e-04       -22.325307682841
     1.2925e+00     1.2925e+01             2.7698e-04       -22.325323682834  <--

*****************************************************************************
Applying the update for shift_i =   1.2925e+00     and shift_s =   1.2925e+01
*****************************************************************************

  Execution time = 4.5866e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -6.886214e-01 3 1  ON 0
ci_002                -7.122599e-01 3 1  ON 1
ci_003                -6.083351e-02 3 1  ON 2
ci_004                -6.218567e-02 3 1  ON 3
ci_005                 4.514448e-02 3 1  ON 4
ci_006                 4.680036e-02 3 1  ON 5
ci_007                 3.190124e-02 3 1  ON 6
ci_008                 3.316028e-02 3 1  ON 7
ci_009                -2.485276e-02 3 1  ON 8
ci_010                -2.571334e-02 3 1  ON 9
ci_011                -2.213863e-02 3 1  ON 10
ci_012                -2.234214e-02 3 1  ON 11
ci_013                 2.019918e-02 3 1  ON 12
ci_014                 2.094847e-02 3 1  ON 13
ci_015                 2.009011e-02 3 1  ON 14
ci_016                 1.981874e-02 3 1  ON 15
ci_017                 1.516282e-02 3 1  ON 16
ci_018                 1.638670e-02 3 1  ON 17
ci_019                 9.700053e-03 3 1  ON 18
ci_020                 1.063949e-02 3 1  ON 19
ci_021                -8.949572e-03 3 1  ON 20
ci_022                -1.025335e-02 3 1  ON 21
ci_023                 8.705060e-03 3 1  ON 22
ci_024                 9.302905e-03 3 1  ON 23
ci_025                 8.486403e-03 3 1  ON 24
ci_026                 8.421775e-03 3 1  ON 25
ci_027                 7.280790e-03 3 1  ON 26
ci_028                 8.322544e-03 3 1  ON 27
ci_029                -7.750901e-03 3 1  ON 28
ci_030                -8.444481e-03 3 1  ON 29
ci_031                -7.445446e-03 3 1  ON 30
ci_032                -7.814551e-03 3 1  ON 31
ci_033                 6.244818e-03 3 1  ON 32
ci_034                 7.040755e-03 3 1  ON 33
ci_035                 6.455624e-03 3 1  ON 34
ci_036                 6.641693e-03 3 1  ON 35
ci_037                 6.428218e-03 3 1  ON 36
ci_038                 6.773840e-03 3 1  ON 37
ci_039                 5.513429e-03 3 1  ON 38
ci_040                 5.394004e-03 3 1  ON 39
ci_041                 5.008652e-03 3 1  ON 40
ci_042                 5.604472e-03 3 1  ON 41
ci_043                 4.924150e-03 3 1  ON 42
ci_044                 5.254987e-03 3 1  ON 43
ci_045                 5.360795e-03 3 1  ON 44
ci_046                 6.206570e-03 3 1  ON 45
ci_047                -4.388081e-03 3 1  ON 46
ci_048                -4.561962e-03 3 1  ON 47
ci_049                 3.187732e-03 3 1  ON 48
ci_050                 3.796380e-03 3 1  ON 49
ci_051                -2.740843e-03 3 1  ON 50
ci_052                -3.613970e-03 3 1  ON 51
ci_053                -3.169756e-03 3 1  ON 52
ci_054                -3.370087e-03 3 1  ON 53
ci_055                -3.108479e-03 3 1  ON 54
ci_056                -2.217920e-03 3 1  ON 55
ci_057                -2.514038e-03 3 1  ON 56
ci_058                -2.296176e-03 3 1  ON 57
ci_059                -1.980534e-03 3 1  ON 58
ci_060                -1.880437e-03 3 1  ON 59
ci_061                -1.017217e-03 3 1  ON 60
ci_062                -1.573152e-03 3 1  ON 61
ci_063                -1.806085e-03 3 1  ON 62
ci_064                -1.390704e-03 3 1  ON 63
ci_065                -1.355141e-03 3 1  ON 64
ci_066                -1.250713e-03 3 1  ON 65
ci_067                 2.723874e-05 3 1  ON 66
ci_068                -1.764459e-03 3 1  ON 67
ci_069                 1.978483e-03 3 1  ON 68
ci_070                 1.175099e-03 3 1  ON 69
ci_071                -8.067879e-04 3 1  ON 70
ci_072                -5.134398e-04 3 1  ON 71
ci_073                 8.508035e-04 3 1  ON 72
ci_074                 1.269306e-03 3 1  ON 73
ci_075                -1.095375e-03 3 1  ON 74
ci_076                -1.134997e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2310e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.7021
    reference variance = 1.93536
====================================================
  Execution time = 2.4281e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0285e+04
  VMC Eavg = -2.2330e+01
  VMC Evar = 3.7025e+00
  Total weights = 1.949906983e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8265e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752909544453
                                         uncertainty =       0.031335078969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.752909544453
                                         uncertainty =       0.031335078969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001369819291
  error estimate for blocks of size 2^( 2) =       0.001440651613
  error estimate for blocks of size 2^( 3) =       0.001504810786
  error estimate for blocks of size 2^( 4) =       0.001550090745
  error estimate for blocks of size 2^( 5) =       0.001570893847
  error estimate for blocks of size 2^( 6) =       0.001580931595
  error estimate for blocks of size 2^( 7) =       0.001587922673

      target function =                  N/A
              le_mean =     -22.330119175316
             les_mean =     502.336675477360
             stat err =       0.001572459715
             autocorr =       1.317748407085
              std dev =       1.937248014555
             le_variance =       3.752929869898


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.233011917532e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e-01, overlap shift 3.2312e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330119174516       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330162616753       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330163901839       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.330163962721       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e-01 is 9.592830e-04

solving harmonic davidson linear method for identity shift 1.2925e+00, overlap shift 1.2925e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330119174516       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330134164408       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330134296438       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+00 is 3.195279e-04

solving harmonic davidson linear method for identity shift 5.1699e+00, overlap shift 5.1699e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.330119174516       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.330123315607       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.330123336958       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+00 is 8.697377e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268102 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0115e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -6.887006e-01 3 1  ON 0
ci_002                -7.121788e-01 3 1  ON 1
ci_003                -6.070246e-02 3 1  ON 2
ci_004                -6.231824e-02 3 1  ON 3
ci_005                 4.527040e-02 3 1  ON 4
ci_006                 4.678197e-02 3 1  ON 5
ci_007                 3.169987e-02 3 1  ON 6
ci_008                 3.311105e-02 3 1  ON 7
ci_009                -2.494766e-02 3 1  ON 8
ci_010                -2.565083e-02 3 1  ON 9
ci_011                -2.218844e-02 3 1  ON 10
ci_012                -2.239330e-02 3 1  ON 11
ci_013                 2.043770e-02 3 1  ON 12
ci_014                 2.096021e-02 3 1  ON 13
ci_015                 2.013949e-02 3 1  ON 14
ci_016                 1.986687e-02 3 1  ON 15
ci_017                 1.522484e-02 3 1  ON 16
ci_018                 1.629805e-02 3 1  ON 17
ci_019                 9.608428e-03 3 1  ON 18
ci_020                 1.047216e-02 3 1  ON 19
ci_021                -9.174949e-03 3 1  ON 20
ci_022                -1.026872e-02 3 1  ON 21
ci_023                 8.937581e-03 3 1  ON 22
ci_024                 9.315200e-03 3 1  ON 23
ci_025                 8.454977e-03 3 1  ON 24
ci_026                 8.292273e-03 3 1  ON 25
ci_027                 7.381974e-03 3 1  ON 26
ci_028                 8.196295e-03 3 1  ON 27
ci_029                -7.778745e-03 3 1  ON 28
ci_030                -8.442254e-03 3 1  ON 29
ci_031                -7.400474e-03 3 1  ON 30
ci_032                -7.782088e-03 3 1  ON 31
ci_033                 6.254812e-03 3 1  ON 32
ci_034                 6.908196e-03 3 1  ON 33
ci_035                 6.457756e-03 3 1  ON 34
ci_036                 6.632652e-03 3 1  ON 35
ci_037                 6.419278e-03 3 1  ON 36
ci_038                 6.832735e-03 3 1  ON 37
ci_039                 5.609224e-03 3 1  ON 38
ci_040                 5.442937e-03 3 1  ON 39
ci_041                 5.018713e-03 3 1  ON 40
ci_042                 5.468272e-03 3 1  ON 41
ci_043                 4.903139e-03 3 1  ON 42
ci_044                 5.213544e-03 3 1  ON 43
ci_045                 5.383706e-03 3 1  ON 44
ci_046                 6.300237e-03 3 1  ON 45
ci_047                -4.441944e-03 3 1  ON 46
ci_048                -4.432679e-03 3 1  ON 47
ci_049                 3.280899e-03 3 1  ON 48
ci_050                 3.476852e-03 3 1  ON 49
ci_051                -2.823285e-03 3 1  ON 50
ci_052                -3.529088e-03 3 1  ON 51
ci_053                -3.154374e-03 3 1  ON 52
ci_054                -3.120159e-03 3 1  ON 53
ci_055                -2.918913e-03 3 1  ON 54
ci_056                -2.260347e-03 3 1  ON 55
ci_057                -2.489098e-03 3 1  ON 56
ci_058                -2.191190e-03 3 1  ON 57
ci_059                -1.995361e-03 3 1  ON 58
ci_060                -1.964098e-03 3 1  ON 59
ci_061                -1.282450e-03 3 1  ON 60
ci_062                -1.523350e-03 3 1  ON 61
ci_063                -1.779480e-03 3 1  ON 62
ci_064                -1.256362e-03 3 1  ON 63
ci_065                -1.444399e-03 3 1  ON 64
ci_066                -1.313082e-03 3 1  ON 65
ci_067                -2.094026e-06 3 1  ON 66
ci_068                -1.902495e-03 3 1  ON 67
ci_069                 1.886935e-03 3 1  ON 68
ci_070                 1.202793e-03 3 1  ON 69
ci_071                -8.460792e-04 3 1  ON 70
ci_072                -4.349904e-04 3 1  ON 71
ci_073                 1.043957e-03 3 1  ON 72
ci_074                 1.084275e-03 3 1  ON 73
ci_075                -1.059882e-03 3 1  ON 74
ci_076                -1.141215e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.515
    reference variance = 2.26327
====================================================
  Execution time = 2.3668e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2326e+01
  VMC Evar = 3.7937e+00
  Total weights = 1.9500e+06
  Execution time = 4.3810e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847816265304
                                         uncertainty =       0.051696431882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847816265304
                                         uncertainty =       0.051696431882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386976800
  error estimate for blocks of size 2^( 2) =       0.001457692483
  error estimate for blocks of size 2^( 3) =       0.001521397454
  error estimate for blocks of size 2^( 4) =       0.001566040369
  error estimate for blocks of size 2^( 5) =       0.001590335293
  error estimate for blocks of size 2^( 6) =       0.001602327693
  error estimate for blocks of size 2^( 7) =       0.001608375863

      target function =                  N/A
              le_mean =     -22.326173347811
             les_mean =     502.251817084530
             stat err =       0.001591769804
             autocorr =       1.317110252680
              std dev =       1.961512785093
             le_variance =       3.847532406083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847852942436
                                         uncertainty =       0.051696681453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847852942436
                                         uncertainty =       0.051696681453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386983700
  error estimate for blocks of size 2^( 2) =       0.001457692946
  error estimate for blocks of size 2^( 3) =       0.001521391657
  error estimate for blocks of size 2^( 4) =       0.001566024416
  error estimate for blocks of size 2^( 5) =       0.001590315391
  error estimate for blocks of size 2^( 6) =       0.001602290325
  error estimate for blocks of size 2^( 7) =       0.001608357324

      target function =                  N/A
              le_mean =     -22.326176780706
             les_mean =     502.254361008034
             stat err =       0.001591746864
             autocorr =       1.317059185709
              std dev =       1.961522542335
             le_variance =       3.847570684089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847828548421
                                         uncertainty =       0.051696475453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847828548421
                                         uncertainty =       0.051696475453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386979232
  error estimate for blocks of size 2^( 2) =       0.001457690379
  error estimate for blocks of size 2^( 3) =       0.001521391109
  error estimate for blocks of size 2^( 4) =       0.001566027448
  error estimate for blocks of size 2^( 5) =       0.001590320786
  error estimate for blocks of size 2^( 6) =       0.001602298203
  error estimate for blocks of size 2^( 7) =       0.001608358196

      target function =                  N/A
              le_mean =     -22.326172703311
             les_mean =     502.254648787074
             stat err =       0.001591751158
             autocorr =       1.317074776991
              std dev =       1.961516223989
             le_variance =       3.847545896973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847814740689
                                         uncertainty =       0.051696430661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.847814740689
                                         uncertainty =       0.051696430661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001386976557
  error estimate for blocks of size 2^( 2) =       0.001457691600
  error estimate for blocks of size 2^( 3) =       0.001521396038
  error estimate for blocks of size 2^( 4) =       0.001566037996
  error estimate for blocks of size 2^( 5) =       0.001590332762
  error estimate for blocks of size 2^( 6) =       0.001602323278
  error estimate for blocks of size 2^( 7) =       0.001608373218

      target function =                  N/A
              le_mean =     -22.326172424611
             les_mean =     502.251757201889
             stat err =       0.001591766814
             autocorr =       1.317105765155
              std dev =       1.961512441038
             le_variance =       3.847531056348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.326173347811        initial
     3.2312e-01     3.2312e+00             9.5928e-04       -22.326176780706  <--
     1.2925e+00     1.2925e+01             3.1953e-04       -22.326172703311
     5.1699e+00     5.1699e+01             8.6974e-05       -22.326172424611

*****************************************************************************
Applying the update for shift_i =   3.2312e-01     and shift_s =   3.2312e+00
*****************************************************************************

  Execution time = 4.5641e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -6.889543e-01 3 1  ON 0
ci_002                -7.119266e-01 3 1  ON 1
ci_003                -6.035403e-02 3 1  ON 2
ci_004                -6.266361e-02 3 1  ON 3
ci_005                 4.547080e-02 3 1  ON 4
ci_006                 4.674493e-02 3 1  ON 5
ci_007                 3.131289e-02 3 1  ON 6
ci_008                 3.298675e-02 3 1  ON 7
ci_009                -2.516439e-02 3 1  ON 8
ci_010                -2.551574e-02 3 1  ON 9
ci_011                -2.227645e-02 3 1  ON 10
ci_012                -2.251193e-02 3 1  ON 11
ci_013                 2.093654e-02 3 1  ON 12
ci_014                 2.098898e-02 3 1  ON 13
ci_015                 2.025713e-02 3 1  ON 14
ci_016                 1.996938e-02 3 1  ON 15
ci_017                 1.536858e-02 3 1  ON 16
ci_018                 1.611117e-02 3 1  ON 17
ci_019                 9.434737e-03 3 1  ON 18
ci_020                 1.012325e-02 3 1  ON 19
ci_021                -9.660142e-03 3 1  ON 20
ci_022                -1.027818e-02 3 1  ON 21
ci_023                 9.364551e-03 3 1  ON 22
ci_024                 9.344848e-03 3 1  ON 23
ci_025                 8.394851e-03 3 1  ON 24
ci_026                 8.043291e-03 3 1  ON 25
ci_027                 7.526152e-03 3 1  ON 26
ci_028                 7.995517e-03 3 1  ON 27
ci_029                -7.829030e-03 3 1  ON 28
ci_030                -8.428971e-03 3 1  ON 29
ci_031                -7.284022e-03 3 1  ON 30
ci_032                -7.721266e-03 3 1  ON 31
ci_033                 6.279540e-03 3 1  ON 32
ci_034                 6.620613e-03 3 1  ON 33
ci_035                 6.451404e-03 3 1  ON 34
ci_036                 6.623449e-03 3 1  ON 35
ci_037                 6.423431e-03 3 1  ON 36
ci_038                 6.945207e-03 3 1  ON 37
ci_039                 5.755129e-03 3 1  ON 38
ci_040                 5.521444e-03 3 1  ON 39
ci_041                 5.034838e-03 3 1  ON 40
ci_042                 5.239857e-03 3 1  ON 41
ci_043                 4.882502e-03 3 1  ON 42
ci_044                 5.146559e-03 3 1  ON 43
ci_045                 5.435614e-03 3 1  ON 44
ci_046                 6.496326e-03 3 1  ON 45
ci_047                -4.533646e-03 3 1  ON 46
ci_048                -4.227830e-03 3 1  ON 47
ci_049                 3.473819e-03 3 1  ON 48
ci_050                 2.837097e-03 3 1  ON 49
ci_051                -2.963786e-03 3 1  ON 50
ci_052                -3.357072e-03 3 1  ON 51
ci_053                -3.123762e-03 3 1  ON 52
ci_054                -2.619916e-03 3 1  ON 53
ci_055                -2.522626e-03 3 1  ON 54
ci_056                -2.311429e-03 3 1  ON 55
ci_057                -2.449816e-03 3 1  ON 56
ci_058                -1.992676e-03 3 1  ON 57
ci_059                -2.030662e-03 3 1  ON 58
ci_060                -2.083063e-03 3 1  ON 59
ci_061                -1.777282e-03 3 1  ON 60
ci_062                -1.447232e-03 3 1  ON 61
ci_063                -1.711909e-03 3 1  ON 62
ci_064                -9.863365e-04 3 1  ON 63
ci_065                -1.614323e-03 3 1  ON 64
ci_066                -1.420323e-03 3 1  ON 65
ci_067                -7.800189e-05 3 1  ON 66
ci_068                -2.182372e-03 3 1  ON 67
ci_069                 1.710353e-03 3 1  ON 68
ci_070                 1.247000e-03 3 1  ON 69
ci_071                -9.007267e-04 3 1  ON 70
ci_072                -2.892990e-04 3 1  ON 71
ci_073                 1.350651e-03 3 1  ON 72
ci_074                 7.883677e-04 3 1  ON 73
ci_075                -9.831742e-04 3 1  ON 74
ci_076                -1.137160e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5763e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2313e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 28328 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.1384
    reference variance = 3.67727
====================================================
  Execution time = 2.4089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0284e+04
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.8314e+00
  Total weights = 1.950194049e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8630e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.883751982646
                                         uncertainty =       0.120538915998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.883751982646
                                         uncertainty =       0.120538915998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001393700383
  error estimate for blocks of size 2^( 2) =       0.001463221574
  error estimate for blocks of size 2^( 3) =       0.001526236233
  error estimate for blocks of size 2^( 4) =       0.001568437605
  error estimate for blocks of size 2^( 5) =       0.001592723001
  error estimate for blocks of size 2^( 6) =       0.001603304130
  error estimate for blocks of size 2^( 7) =       0.001606568458

      target function =                  N/A
              le_mean =     -22.329363571896
             les_mean =     502.431849511458
             stat err =       0.001592758298
             autocorr =       1.306053339601
              std dev =       1.971021519076
             le_variance =       3.884925828661


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.232936357190e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.0779e-02, overlap shift 8.0779e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329363571096       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329407439526       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329412870177       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329413591031       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.329413339365       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.329413356168       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.0779e-02 is 1.357175e-03

solving harmonic davidson linear method for identity shift 3.2312e-01, overlap shift 3.2312e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329363571096       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329387442110       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329388635539       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.329388709477       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e-01 is 7.118459e-04

solving harmonic davidson linear method for identity shift 1.2925e+00, overlap shift 1.2925e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.329363571096       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.329372025770       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.329372118764       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+00 is 2.581438e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9959e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -6.890095e-01 3 1  ON 0
ci_002                -7.119109e-01 3 1  ON 1
ci_003                -5.997834e-02 3 1  ON 2
ci_004                -6.292852e-02 3 1  ON 3
ci_005                 4.548908e-02 3 1  ON 4
ci_006                 4.631552e-02 3 1  ON 5
ci_007                 3.162033e-02 3 1  ON 6
ci_008                 3.287541e-02 3 1  ON 7
ci_009                -2.520751e-02 3 1  ON 8
ci_010                -2.587644e-02 3 1  ON 9
ci_011                -2.213638e-02 3 1  ON 10
ci_012                -2.251411e-02 3 1  ON 11
ci_013                 2.076893e-02 3 1  ON 12
ci_014                 2.091423e-02 3 1  ON 13
ci_015                 1.988549e-02 3 1  ON 14
ci_016                 1.972716e-02 3 1  ON 15
ci_017                 1.591026e-02 3 1  ON 16
ci_018                 1.594302e-02 3 1  ON 17
ci_019                 9.184840e-03 3 1  ON 18
ci_020                 1.043069e-02 3 1  ON 19
ci_021                -1.023921e-02 3 1  ON 20
ci_022                -1.042091e-02 3 1  ON 21
ci_023                 9.130650e-03 3 1  ON 22
ci_024                 8.901222e-03 3 1  ON 23
ci_025                 8.087361e-03 3 1  ON 24
ci_026                 8.432237e-03 3 1  ON 25
ci_027                 7.594310e-03 3 1  ON 26
ci_028                 7.822151e-03 3 1  ON 27
ci_029                -7.839026e-03 3 1  ON 28
ci_030                -8.264525e-03 3 1  ON 29
ci_031                -7.534251e-03 3 1  ON 30
ci_032                -8.366510e-03 3 1  ON 31
ci_033                 6.683977e-03 3 1  ON 32
ci_034                 6.810202e-03 3 1  ON 33
ci_035                 6.083157e-03 3 1  ON 34
ci_036                 6.917878e-03 3 1  ON 35
ci_037                 6.628251e-03 3 1  ON 36
ci_038                 6.678639e-03 3 1  ON 37
ci_039                 5.498853e-03 3 1  ON 38
ci_040                 5.570850e-03 3 1  ON 39
ci_041                 4.838245e-03 3 1  ON 40
ci_042                 5.050247e-03 3 1  ON 41
ci_043                 4.860984e-03 3 1  ON 42
ci_044                 5.124680e-03 3 1  ON 43
ci_045                 5.540175e-03 3 1  ON 44
ci_046                 5.835818e-03 3 1  ON 45
ci_047                -3.890082e-03 3 1  ON 46
ci_048                -4.101077e-03 3 1  ON 47
ci_049                 3.351458e-03 3 1  ON 48
ci_050                 3.346748e-03 3 1  ON 49
ci_051                -3.029896e-03 3 1  ON 50
ci_052                -3.459009e-03 3 1  ON 51
ci_053                -3.106777e-03 3 1  ON 52
ci_054                -2.562866e-03 3 1  ON 53
ci_055                -2.301947e-03 3 1  ON 54
ci_056                -2.159322e-03 3 1  ON 55
ci_057                -2.275282e-03 3 1  ON 56
ci_058                -2.393752e-03 3 1  ON 57
ci_059                -1.776193e-03 3 1  ON 58
ci_060                -1.715922e-03 3 1  ON 59
ci_061                -1.232388e-03 3 1  ON 60
ci_062                -1.626631e-03 3 1  ON 61
ci_063                -1.505159e-03 3 1  ON 62
ci_064                -1.117634e-03 3 1  ON 63
ci_065                -1.581200e-03 3 1  ON 64
ci_066                -1.212146e-03 3 1  ON 65
ci_067                -4.156258e-04 3 1  ON 66
ci_068                -1.820951e-03 3 1  ON 67
ci_069                 1.526187e-03 3 1  ON 68
ci_070                 1.653717e-03 3 1  ON 69
ci_071                -1.057703e-03 3 1  ON 70
ci_072                -1.001145e-03 3 1  ON 71
ci_073                 9.058543e-04 3 1  ON 72
ci_074                 1.113371e-03 3 1  ON 73
ci_075                -1.234398e-03 3 1  ON 74
ci_076                -1.311482e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.5706
    reference variance = 2.93624
====================================================
  Execution time = 2.4037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -2.2329e+01
  VMC Evar = 3.7096e+00
  Total weights = 1.9496e+06
  Execution time = 4.9902e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759452716965
                                         uncertainty =       0.031819540142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759452716965
                                         uncertainty =       0.031819540142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371451668
  error estimate for blocks of size 2^( 2) =       0.001442063323
  error estimate for blocks of size 2^( 3) =       0.001506170948
  error estimate for blocks of size 2^( 4) =       0.001547922102
  error estimate for blocks of size 2^( 5) =       0.001574657254
  error estimate for blocks of size 2^( 6) =       0.001585676050
  error estimate for blocks of size 2^( 7) =       0.001591295341

      target function =                  N/A
              le_mean =     -22.329476060978
             les_mean =     502.321056021688
             stat err =       0.001574887687
             autocorr =       1.318676178520
              std dev =       1.939556581191
             le_variance =       3.761879731642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759571909493
                                         uncertainty =       0.031817835583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759571909493
                                         uncertainty =       0.031817835583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371473340
  error estimate for blocks of size 2^( 2) =       0.001442092189
  error estimate for blocks of size 2^( 3) =       0.001506204295
  error estimate for blocks of size 2^( 4) =       0.001547945161
  error estimate for blocks of size 2^( 5) =       0.001574669300
  error estimate for blocks of size 2^( 6) =       0.001585727366
  error estimate for blocks of size 2^( 7) =       0.001591347847

      target function =                  N/A
              le_mean =     -22.329463206928
             les_mean =     502.323270317693
             stat err =       0.001574922418
             autocorr =       1.318692665360
              std dev =       1.939587230037
             le_variance =       3.761998622924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760166913319
                                         uncertainty =       0.031957917601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.760166913319
                                         uncertainty =       0.031957917601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371581879
  error estimate for blocks of size 2^( 2) =       0.001442200167
  error estimate for blocks of size 2^( 3) =       0.001506291689
  error estimate for blocks of size 2^( 4) =       0.001548025633
  error estimate for blocks of size 2^( 5) =       0.001574716687
  error estimate for blocks of size 2^( 6) =       0.001585756452
  error estimate for blocks of size 2^( 7) =       0.001591194176

      target function =                  N/A
              le_mean =     -22.329483747550
             les_mean =     504.911394063033
             stat err =       0.001574923237
             autocorr =       1.318485336077
              std dev =       1.939740730911
             le_variance =       3.762594103157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759436373311
                                         uncertainty =       0.031818755631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.759436373311
                                         uncertainty =       0.031818755631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001371448691
  error estimate for blocks of size 2^( 2) =       0.001442063722
  error estimate for blocks of size 2^( 3) =       0.001506181758
  error estimate for blocks of size 2^( 4) =       0.001547931639
  error estimate for blocks of size 2^( 5) =       0.001574662264
  error estimate for blocks of size 2^( 6) =       0.001585686081
  error estimate for blocks of size 2^( 7) =       0.001591306097

      target function =                  N/A
              le_mean =     -22.329465567985
             les_mean =     502.330841238517
             stat err =       0.001574896520
             autocorr =       1.318696695974
              std dev =       1.939552371311
             le_variance =       3.761863401059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.329476060978        initial
     8.0779e-02     8.0779e-01             1.3572e-03       -22.329463206928
     3.2312e-01     3.2312e+00             7.1185e-04       -22.329483747550  <--
     1.2925e+00     1.2925e+01             2.5814e-04       -22.329465567985

*****************************************************************************
Applying the update for shift_i =   3.2312e-01     and shift_s =   3.2312e+00
*****************************************************************************

  Execution time = 4.6787e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -6.890095e-01 3 1  ON 0
ci_002                -7.119109e-01 3 1  ON 1
ci_003                -5.997834e-02 3 1  ON 2
ci_004                -6.292852e-02 3 1  ON 3
ci_005                 4.548908e-02 3 1  ON 4
ci_006                 4.631552e-02 3 1  ON 5
ci_007                 3.162033e-02 3 1  ON 6
ci_008                 3.287541e-02 3 1  ON 7
ci_009                -2.520751e-02 3 1  ON 8
ci_010                -2.587644e-02 3 1  ON 9
ci_011                -2.213638e-02 3 1  ON 10
ci_012                -2.251411e-02 3 1  ON 11
ci_013                 2.076893e-02 3 1  ON 12
ci_014                 2.091423e-02 3 1  ON 13
ci_015                 1.988549e-02 3 1  ON 14
ci_016                 1.972716e-02 3 1  ON 15
ci_017                 1.591026e-02 3 1  ON 16
ci_018                 1.594302e-02 3 1  ON 17
ci_019                 9.184840e-03 3 1  ON 18
ci_020                 1.043069e-02 3 1  ON 19
ci_021                -1.023921e-02 3 1  ON 20
ci_022                -1.042091e-02 3 1  ON 21
ci_023                 9.130650e-03 3 1  ON 22
ci_024                 8.901222e-03 3 1  ON 23
ci_025                 8.087361e-03 3 1  ON 24
ci_026                 8.432237e-03 3 1  ON 25
ci_027                 7.594310e-03 3 1  ON 26
ci_028                 7.822151e-03 3 1  ON 27
ci_029                -7.839026e-03 3 1  ON 28
ci_030                -8.264525e-03 3 1  ON 29
ci_031                -7.534251e-03 3 1  ON 30
ci_032                -8.366510e-03 3 1  ON 31
ci_033                 6.683977e-03 3 1  ON 32
ci_034                 6.810202e-03 3 1  ON 33
ci_035                 6.083157e-03 3 1  ON 34
ci_036                 6.917878e-03 3 1  ON 35
ci_037                 6.628251e-03 3 1  ON 36
ci_038                 6.678639e-03 3 1  ON 37
ci_039                 5.498853e-03 3 1  ON 38
ci_040                 5.570850e-03 3 1  ON 39
ci_041                 4.838245e-03 3 1  ON 40
ci_042                 5.050247e-03 3 1  ON 41
ci_043                 4.860984e-03 3 1  ON 42
ci_044                 5.124680e-03 3 1  ON 43
ci_045                 5.540175e-03 3 1  ON 44
ci_046                 5.835818e-03 3 1  ON 45
ci_047                -3.890082e-03 3 1  ON 46
ci_048                -4.101077e-03 3 1  ON 47
ci_049                 3.351458e-03 3 1  ON 48
ci_050                 3.346748e-03 3 1  ON 49
ci_051                -3.029896e-03 3 1  ON 50
ci_052                -3.459009e-03 3 1  ON 51
ci_053                -3.106777e-03 3 1  ON 52
ci_054                -2.562866e-03 3 1  ON 53
ci_055                -2.301947e-03 3 1  ON 54
ci_056                -2.159322e-03 3 1  ON 55
ci_057                -2.275282e-03 3 1  ON 56
ci_058                -2.393752e-03 3 1  ON 57
ci_059                -1.776193e-03 3 1  ON 58
ci_060                -1.715922e-03 3 1  ON 59
ci_061                -1.232388e-03 3 1  ON 60
ci_062                -1.626631e-03 3 1  ON 61
ci_063                -1.505159e-03 3 1  ON 62
ci_064                -1.117634e-03 3 1  ON 63
ci_065                -1.581200e-03 3 1  ON 64
ci_066                -1.212146e-03 3 1  ON 65
ci_067                -4.156258e-04 3 1  ON 66
ci_068                -1.820951e-03 3 1  ON 67
ci_069                 1.526187e-03 3 1  ON 68
ci_070                 1.653717e-03 3 1  ON 69
ci_071                -1.057703e-03 3 1  ON 70
ci_072                -1.001145e-03 3 1  ON 71
ci_073                 9.058543e-04 3 1  ON 72
ci_074                 1.113371e-03 3 1  ON 73
ci_075                -1.234398e-03 3 1  ON 74
ci_076                -1.311482e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6752e+01 secs
  Total Execution time = 7.6719e+03 secs

=========================================================
  A new xml input file : FORM.s099.cont.xml
