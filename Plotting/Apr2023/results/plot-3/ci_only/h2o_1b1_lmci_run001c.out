Rank =    0  Free Memory = 54973 MB
Rank =    1  Free Memory = 54962 MB
Rank =    2  Free Memory = 54962 MB
Rank =    3  Free Memory = 54962 MB
Rank =    4  Free Memory = 54962 MB
Rank =    5  Free Memory = 54962 MB
Rank =    6  Free Memory = 54962 MB
Rank =    7  Free Memory = 54962 MB
Rank =    8  Free Memory = 54962 MB
Rank =    9  Free Memory = 54962 MB
Rank =   10  Free Memory = 54962 MB
Rank =   11  Free Memory = 54962 MB
Rank =   12  Free Memory = 54962 MB
Rank =   13  Free Memory = 54962 MB
Rank =   14  Free Memory = 54956 MB
Rank =   15  Free Memory = 54948 MB
Rank =   16  Free Memory = 54947 MB
Rank =   17  Free Memory = 54947 MB
Rank =   18  Free Memory = 54947 MB
Rank =   19  Free Memory = 54947 MB
Rank =   20  Free Memory = 54947 MB
Rank =   21  Free Memory = 54947 MB
Rank =   22  Free Memory = 54947 MB
Rank =   23  Free Memory = 54947 MB
Rank =   24  Free Memory = 55765 MB
Rank =   25  Free Memory = 55765 MB
Rank =   26  Free Memory = 55765 MB
Rank =   27  Free Memory = 55764 MB
Rank =   28  Free Memory = 55764 MB
Rank =   29  Free Memory = 55764 MB
Rank =   30  Free Memory = 55764 MB
Rank =   31  Free Memory = 55764 MB
Rank =   32  Free Memory = 55764 MB
Rank =   33  Free Memory = 55764 MB
Rank =   34  Free Memory = 55764 MB
Rank =   35  Free Memory = 55764 MB
Rank =   36  Free Memory = 55764 MB
Rank =   37  Free Memory = 55764 MB
Rank =   38  Free Memory = 55764 MB
Rank =   39  Free Memory = 55764 MB
Rank =   40  Free Memory = 55764 MB
Rank =   41  Free Memory = 55764 MB
Rank =   42  Free Memory = 55764 MB
Rank =   43  Free Memory = 55764 MB
Rank =   44  Free Memory = 55764 MB
Rank =   45  Free Memory = 55764 MB
Rank =   46  Free Memory = 55764 MB
Rank =   47  Free Memory = 55764 MB
Rank =   48  Free Memory = 57493 MB
Rank =   49  Free Memory = 57493 MB
Rank =   50  Free Memory = 57493 MB
Rank =   51  Free Memory = 57493 MB
Rank =   52  Free Memory = 57493 MB
Rank =   53  Free Memory = 57493 MB
Rank =   54  Free Memory = 57493 MB
Rank =   55  Free Memory = 57493 MB
Rank =   56  Free Memory = 57493 MB
Rank =   57  Free Memory = 57493 MB
Rank =   58  Free Memory = 57493 MB
Rank =   59  Free Memory = 57493 MB
Rank =   60  Free Memory = 57493 MB
Rank =   61  Free Memory = 57493 MB
Rank =   62  Free Memory = 57493 MB
Rank =   63  Free Memory = 57493 MB
Rank =   64  Free Memory = 57493 MB
Rank =   65  Free Memory = 57493 MB
Rank =   66  Free Memory = 57493 MB
Rank =   67  Free Memory = 57493 MB
Rank =   68  Free Memory = 57493 MB
Rank =   69  Free Memory = 57493 MB
Rank =   70  Free Memory = 57493 MB
Rank =   71  Free Memory = 57493 MB
Rank =   72  Free Memory = 57765 MB
Rank =   73  Free Memory = 57765 MB
Rank =   74  Free Memory = 57765 MB
Rank =   75  Free Memory = 57765 MB
Rank =   76  Free Memory = 57765 MB
Rank =   77  Free Memory = 57765 MB
Rank =   78  Free Memory = 57765 MB
Rank =   79  Free Memory = 57765 MB
Rank =   80  Free Memory = 57765 MB
Rank =   81  Free Memory = 57765 MB
Rank =   82  Free Memory = 57765 MB
Rank =   83  Free Memory = 57765 MB
Rank =   84  Free Memory = 57765 MB
Rank =   85  Free Memory = 57765 MB
Rank =   86  Free Memory = 57765 MB
Rank =   87  Free Memory = 57765 MB
Rank =   88  Free Memory = 57765 MB
Rank =   89  Free Memory = 57765 MB
Rank =   90  Free Memory = 57765 MB
Rank =   91  Free Memory = 57758 MB
Rank =   92  Free Memory = 57757 MB
Rank =   93  Free Memory = 57757 MB
Rank =   94  Free Memory = 57757 MB
Rank =   95  Free Memory = 57757 MB
  Input file(s): opt_h2o_1b1_lmci_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 96
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 96
  MPI ranks per node        = 24
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmci_run001c.xml

  Project = H2O
  date    = 2023-05-02 11:29:49 PDT
  host    = n0068.savio2

 Random Number
 -------------
  Offset for the random number seeds based on time: 669

  Range of prime numbers to use as seeds over processors and threads = 5009-5843


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0
  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 10.1859

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1e-06 rf = 100 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 12.7057

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 0.991789
Norm of qchem ci vector (sum of qchem_ci^2): 0
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 1.075

  Adding pseudopotential for H1
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001

  Adding pseudopotential for H2
   Linear grid  ri=0 rf=10 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1e-10
  Using global grid with delta = 0.001
   Making L=1 a local potential with a radial cutoff of 9.999
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 0.001
    Spherical grids and weights: 
                        1                 0                 0       0.08333333333
                       -1   1.224646799e-16                 0       0.08333333333
             0.4472135955       0.894427191                 0       0.08333333333
            -0.4472135955      0.7236067977      0.5257311121       0.08333333333
             0.4472135955      0.2763932023      0.8506508084       0.08333333333
            -0.4472135955     -0.2763932023      0.8506508084       0.08333333333
             0.4472135955     -0.7236067977      0.5257311121       0.08333333333
            -0.4472135955      -0.894427191   1.095357397e-16       0.08333333333
             0.4472135955     -0.7236067977     -0.5257311121       0.08333333333
            -0.4472135955     -0.2763932023     -0.8506508084       0.08333333333
             0.4472135955      0.2763932023     -0.8506508084       0.08333333333
            -0.4472135955      0.7236067977     -0.5257311121       0.08333333333
    Maximum cutoff radius 0.001
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 0.1497 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAB source=e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 9.6000000000e+01
  Total weight: 9.6000000000e+01
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834000000e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 74
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.6119
    reference variance = 2.06738
====================================================
  Execution time = 1.3273e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0243e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5847e+00
  Total weights = 1.945838762e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2302e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.613518648975
                                         uncertainty =       0.057106190605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.613518648975
                                         uncertainty =       0.057106190605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001143075468
  error estimate for blocks of size 2^( 2) =       0.001181876000
  error estimate for blocks of size 2^( 3) =       0.001214725393
  error estimate for blocks of size 2^( 4) =       0.001234578793
  error estimate for blocks of size 2^( 5) =       0.001246598917
  error estimate for blocks of size 2^( 6) =       0.001251692377
  error estimate for blocks of size 2^( 7) =       0.001253210802

      target function =                  N/A
              le_mean =     -16.717728173247
             les_mean =     282.067129107677
             stat err =       0.001246520222
             autocorr =       1.189183427061
              std dev =       1.616578694950
             le_variance =       2.613326676967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.671772817325e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717728172333       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717779787990       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717779554631       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717779144169       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 8.808316e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717728172333       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717748841106       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717748742381       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717748702286       residual = 5.66e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 3.722127e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717728172333       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717734254490       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717734256414       residual = 9.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 1.156297e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6561e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001 7.072930e-01                 3 1 ON  0
ci_0002 6.793799e-01                 3 1 ON  1
ci_0003 -4.815542e-02                3 1 ON  2
ci_0004 -4.625138e-02                3 1 ON  3
ci_0005 -4.585383e-02                3 1 ON  4
ci_0006 -4.400883e-02                3 1 ON  5
ci_0007 -3.109338e-02                3 1 ON  6
ci_0008 -3.110204e-02                3 1 ON  7
ci_0009 -3.253124e-02                3 1 ON  8
ci_0010 -3.095264e-02                3 1 ON  9
ci_0011 -2.765031e-02                3 1 ON  10
ci_0012 -2.671528e-02                3 1 ON  11
ci_0013 2.704422e-02                 3 1 ON  12
ci_0014 2.678146e-02                 3 1 ON  13
ci_0015 2.764351e-02                 3 1 ON  14
ci_0016 2.631850e-02                 3 1 ON  15
ci_0017 2.390666e-02                 3 1 ON  16
ci_0018 2.332998e-02                 3 1 ON  17
ci_0019 2.042316e-02                 3 1 ON  18
ci_0020 1.953933e-02                 3 1 ON  19
ci_0021 1.858305e-02                 3 1 ON  20
ci_0022 1.807394e-02                 3 1 ON  21
ci_0023 -1.937555e-02                3 1 ON  22
ci_0024 -1.782248e-02                3 1 ON  23
ci_0025 -1.856035e-02                3 1 ON  24
ci_0026 -1.734926e-02                3 1 ON  25
ci_0027 -1.745569e-02                3 1 ON  26
ci_0028 -1.707733e-02                3 1 ON  27
ci_0029 -1.573931e-02                3 1 ON  28
ci_0030 -1.583420e-02                3 1 ON  29
ci_0031 1.557389e-02                 3 1 ON  30
ci_0032 1.395283e-02                 3 1 ON  31
ci_0033 1.696431e-02                 3 1 ON  32
ci_0034 1.586913e-02                 3 1 ON  33
ci_0035 1.788279e-02                 3 1 ON  34
ci_0036 1.719267e-02                 3 1 ON  35
ci_0037 -1.504875e-02                3 1 ON  36
ci_0038 -1.408181e-02                3 1 ON  37
ci_0039 -1.585899e-02                3 1 ON  38
ci_0040 -1.522551e-02                3 1 ON  39
ci_0041 1.602388e-02                 3 1 ON  40
ci_0042 1.564977e-02                 3 1 ON  41
ci_0043 -1.490947e-02                3 1 ON  42
ci_0044 -1.578044e-02                3 1 ON  43
ci_0045 1.544823e-02                 3 1 ON  44
ci_0046 1.551310e-02                 3 1 ON  45
ci_0047 -1.472479e-02                3 1 ON  46
ci_0048 -1.412172e-02                3 1 ON  47
ci_0049 -1.234419e-02                3 1 ON  48
ci_0050 -1.373205e-02                3 1 ON  49
ci_0051 -1.305510e-02                3 1 ON  50
ci_0052 -1.281082e-02                3 1 ON  51
ci_0053 -1.312360e-02                3 1 ON  52
ci_0054 -1.235873e-02                3 1 ON  53
ci_0055 1.232198e-02                 3 1 ON  54
ci_0056 1.285147e-02                 3 1 ON  55
ci_0057 1.329661e-02                 3 1 ON  56
ci_0058 1.246681e-02                 3 1 ON  57
ci_0059 -1.315306e-02                3 1 ON  58
ci_0060 -1.273018e-02                3 1 ON  59
ci_0061 -1.291427e-02                3 1 ON  60
ci_0062 -1.296396e-02                3 1 ON  61
ci_0063 -1.220347e-02                3 1 ON  62
ci_0064 -1.152532e-02                3 1 ON  63
ci_0065 -1.147321e-02                3 1 ON  64
ci_0066 -1.160414e-02                3 1 ON  65
ci_0067 -1.116345e-02                3 1 ON  66
ci_0068 -1.072861e-02                3 1 ON  67
ci_0069 1.067975e-02                 3 1 ON  68
ci_0070 1.002500e-02                 3 1 ON  69
ci_0071 9.928132e-03                 3 1 ON  70
ci_0072 9.309907e-03                 3 1 ON  71
ci_0073 1.140458e-02                 3 1 ON  72
ci_0074 1.061828e-02                 3 1 ON  73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.6829
    reference variance = 2.5357
====================================================
  Execution time = 1.2906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5327e+00
  Total weights = 1.9459e+06
  Execution time = 2.2318e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561806098147
                                         uncertainty =       0.030720903491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561806098147
                                         uncertainty =       0.030720903491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131706044
  error estimate for blocks of size 2^( 2) =       0.001170039702
  error estimate for blocks of size 2^( 3) =       0.001202778155
  error estimate for blocks of size 2^( 4) =       0.001227700882
  error estimate for blocks of size 2^( 5) =       0.001243837877
  error estimate for blocks of size 2^( 6) =       0.001252946141
  error estimate for blocks of size 2^( 7) =       0.001255632565

      target function =                  N/A
              le_mean =     -16.717595960156
             les_mean =     282.016351733480
             stat err =       0.001245029366
             autocorr =       1.210296897608
              std dev =       1.600499642922
             le_variance =       2.561599106995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561942388783
                                         uncertainty =       0.030713548701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561942388783
                                         uncertainty =       0.030713548701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131735969
  error estimate for blocks of size 2^( 2) =       0.001170032593
  error estimate for blocks of size 2^( 3) =       0.001202730321
  error estimate for blocks of size 2^( 4) =       0.001227617611
  error estimate for blocks of size 2^( 5) =       0.001243729635
  error estimate for blocks of size 2^( 6) =       0.001252879465
  error estimate for blocks of size 2^( 7) =       0.001255554545

      target function =                  N/A
              le_mean =     -16.717602079921
             les_mean =     282.011538021335
             stat err =       0.001244945314
             autocorr =       1.210069491302
              std dev =       1.600541965121
             le_variance =       2.561734582113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561838272006
                                         uncertainty =       0.030715867067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561838272006
                                         uncertainty =       0.030715867067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131713009
  error estimate for blocks of size 2^( 2) =       0.001170015248
  error estimate for blocks of size 2^( 3) =       0.001202720304
  error estimate for blocks of size 2^( 4) =       0.001227615047
  error estimate for blocks of size 2^( 5) =       0.001243729296
  error estimate for blocks of size 2^( 6) =       0.001252872012
  error estimate for blocks of size 2^( 7) =       0.001255550286

      target function =                  N/A
              le_mean =     -16.717595262172
             les_mean =     282.013387622649
             stat err =       0.001244941660
             autocorr =       1.210111488192
              std dev =       1.600509493760
             le_variance =       2.561630639616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561801075415
                                         uncertainty =       0.030720413958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.561801075415
                                         uncertainty =       0.030720413958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131704919
  error estimate for blocks of size 2^( 2) =       0.001170033319
  error estimate for blocks of size 2^( 3) =       0.001202765146
  error estimate for blocks of size 2^( 4) =       0.001227684176
  error estimate for blocks of size 2^( 5) =       0.001243825027
  error estimate for blocks of size 2^( 6) =       0.001252933625
  error estimate for blocks of size 2^( 7) =       0.001255606489

      target function =                  N/A
              le_mean =     -16.717596169369
             les_mean =     282.032096611269
             stat err =       0.001245012329
             autocorr =       1.210266179801
              std dev =       1.600498052490
             le_variance =       2.561594016026


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717595960156        initial
     2.5000e-01     2.5000e+00             8.8083e-04       -16.717602079921  <--
     1.0000e+00     1.0000e+01             3.7221e-04       -16.717595262172
     4.0000e+00     4.0000e+01             1.1563e-04       -16.717596169369

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.4210e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001                 7.071699e-01 3 1  ON 0
ci_0002                 6.793971e-01 3 1  ON 1
ci_0003                -4.840919e-02 3 1  ON 2
ci_0004                -4.601872e-02 3 1  ON 3
ci_0005                -4.625181e-02 3 1  ON 4
ci_0006                -4.413472e-02 3 1  ON 5
ci_0007                -3.150135e-02 3 1  ON 6
ci_0008                -3.096892e-02 3 1  ON 7
ci_0009                -3.282184e-02 3 1  ON 8
ci_0010                -3.137159e-02 3 1  ON 9
ci_0011                -2.709561e-02 3 1  ON 10
ci_0012                -2.679457e-02 3 1  ON 11
ci_0013                 2.732669e-02 3 1  ON 12
ci_0014                 2.654721e-02 3 1  ON 13
ci_0015                 2.801291e-02 3 1  ON 14
ci_0016                 2.633657e-02 3 1  ON 15
ci_0017                 2.403337e-02 3 1  ON 16
ci_0018                 2.317393e-02 3 1  ON 17
ci_0019                 2.022789e-02 3 1  ON 18
ci_0020                 1.947310e-02 3 1  ON 19
ci_0021                 1.856332e-02 3 1  ON 20
ci_0022                 1.816756e-02 3 1  ON 21
ci_0023                -1.954797e-02 3 1  ON 22
ci_0024                -1.801267e-02 3 1  ON 23
ci_0025                -1.890645e-02 3 1  ON 24
ci_0026                -1.702446e-02 3 1  ON 25
ci_0027                -1.753234e-02 3 1  ON 26
ci_0028                -1.725093e-02 3 1  ON 27
ci_0029                -1.591608e-02 3 1  ON 28
ci_0030                -1.536302e-02 3 1  ON 29
ci_0031                 1.559930e-02 3 1  ON 30
ci_0032                 1.391719e-02 3 1  ON 31
ci_0033                 1.687389e-02 3 1  ON 32
ci_0034                 1.584247e-02 3 1  ON 33
ci_0035                 1.806029e-02 3 1  ON 34
ci_0036                 1.772876e-02 3 1  ON 35
ci_0037                -1.483365e-02 3 1  ON 36
ci_0038                -1.411070e-02 3 1  ON 37
ci_0039                -1.595093e-02 3 1  ON 38
ci_0040                -1.544305e-02 3 1  ON 39
ci_0041                 1.643857e-02 3 1  ON 40
ci_0042                 1.562055e-02 3 1  ON 41
ci_0043                -1.473552e-02 3 1  ON 42
ci_0044                -1.536526e-02 3 1  ON 43
ci_0045                 1.568266e-02 3 1  ON 44
ci_0046                 1.494807e-02 3 1  ON 45
ci_0047                -1.494379e-02 3 1  ON 46
ci_0048                -1.404705e-02 3 1  ON 47
ci_0049                -1.213348e-02 3 1  ON 48
ci_0050                -1.374975e-02 3 1  ON 49
ci_0051                -1.259005e-02 3 1  ON 50
ci_0052                -1.291864e-02 3 1  ON 51
ci_0053                -1.348289e-02 3 1  ON 52
ci_0054                -1.252670e-02 3 1  ON 53
ci_0055                 1.204793e-02 3 1  ON 54
ci_0056                 1.308608e-02 3 1  ON 55
ci_0057                 1.350806e-02 3 1  ON 56
ci_0058                 1.256438e-02 3 1  ON 57
ci_0059                -1.338416e-02 3 1  ON 58
ci_0060                -1.274201e-02 3 1  ON 59
ci_0061                -1.333484e-02 3 1  ON 60
ci_0062                -1.301036e-02 3 1  ON 61
ci_0063                -1.258145e-02 3 1  ON 62
ci_0064                -1.193743e-02 3 1  ON 63
ci_0065                -1.162254e-02 3 1  ON 64
ci_0066                -1.132551e-02 3 1  ON 65
ci_0067                -1.124446e-02 3 1  ON 66
ci_0068                -1.064640e-02 3 1  ON 67
ci_0069                 1.061448e-02 3 1  ON 68
ci_0070                 9.929750e-03 3 1  ON 69
ci_0071                 9.896214e-03 3 1  ON 70
ci_0072                 8.916492e-03 3 1  ON 71
ci_0073                 1.127993e-02 3 1  ON 72
ci_0074                 1.070642e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6647e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.388
    reference variance = 4.27869
====================================================
  Execution time = 1.3081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0280e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5448e+00
  Total weights = 1.945503108e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2327e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571661118390
                                         uncertainty =       0.032965818032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571661118390
                                         uncertainty =       0.032965818032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133843877
  error estimate for blocks of size 2^( 2) =       0.001171773353
  error estimate for blocks of size 2^( 3) =       0.001203873069
  error estimate for blocks of size 2^( 4) =       0.001225499650
  error estimate for blocks of size 2^( 5) =       0.001239165587
  error estimate for blocks of size 2^( 6) =       0.001243647977
  error estimate for blocks of size 2^( 7) =       0.001254590609

      target function =                  N/A
              le_mean =     -16.717760256796
             les_mean =     282.028342618836
             stat err =       0.001240725956
             autocorr =       1.197416441560
              std dev =       1.603523044181
             le_variance =       2.571286153219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671776025680e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717760255858       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717809986302       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717811262138       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717813062537       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717812336877       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.717812397266       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.717812312632       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-02 is 1.832194e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717760255858       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717791542887       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717791636205       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717791978101       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717791885017       residual = 5.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 1.146072e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717760255858       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717772853914       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717772802378       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 4.611840e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052953 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6322e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.069519e-01 3 1  ON 0
ci_0002                 6.795422e-01 3 1  ON 1
ci_0003                -4.815706e-02 3 1  ON 2
ci_0004                -4.628068e-02 3 1  ON 3
ci_0005                -4.561797e-02 3 1  ON 4
ci_0006                -4.411157e-02 3 1  ON 5
ci_0007                -3.079542e-02 3 1  ON 6
ci_0008                -3.112685e-02 3 1  ON 7
ci_0009                -3.292292e-02 3 1  ON 8
ci_0010                -3.109385e-02 3 1  ON 9
ci_0011                -2.803681e-02 3 1  ON 10
ci_0012                -2.659296e-02 3 1  ON 11
ci_0013                 2.800453e-02 3 1  ON 12
ci_0014                 2.671147e-02 3 1  ON 13
ci_0015                 2.776764e-02 3 1  ON 14
ci_0016                 2.638477e-02 3 1  ON 15
ci_0017                 2.461499e-02 3 1  ON 16
ci_0018                 2.331481e-02 3 1  ON 17
ci_0019                 2.076893e-02 3 1  ON 18
ci_0020                 1.914167e-02 3 1  ON 19
ci_0021                 1.866872e-02 3 1  ON 20
ci_0022                 1.848527e-02 3 1  ON 21
ci_0023                -1.992505e-02 3 1  ON 22
ci_0024                -1.795413e-02 3 1  ON 23
ci_0025                -1.877535e-02 3 1  ON 24
ci_0026                -1.729688e-02 3 1  ON 25
ci_0027                -1.788057e-02 3 1  ON 26
ci_0028                -1.720143e-02 3 1  ON 27
ci_0029                -1.627058e-02 3 1  ON 28
ci_0030                -1.548042e-02 3 1  ON 29
ci_0031                 1.593265e-02 3 1  ON 30
ci_0032                 1.437381e-02 3 1  ON 31
ci_0033                 1.673706e-02 3 1  ON 32
ci_0034                 1.562601e-02 3 1  ON 33
ci_0035                 1.831589e-02 3 1  ON 34
ci_0036                 1.708361e-02 3 1  ON 35
ci_0037                -1.484460e-02 3 1  ON 36
ci_0038                -1.491346e-02 3 1  ON 37
ci_0039                -1.581746e-02 3 1  ON 38
ci_0040                -1.542878e-02 3 1  ON 39
ci_0041                 1.648701e-02 3 1  ON 40
ci_0042                 1.549221e-02 3 1  ON 41
ci_0043                -1.514412e-02 3 1  ON 42
ci_0044                -1.560658e-02 3 1  ON 43
ci_0045                 1.555003e-02 3 1  ON 44
ci_0046                 1.506171e-02 3 1  ON 45
ci_0047                -1.474734e-02 3 1  ON 46
ci_0048                -1.389208e-02 3 1  ON 47
ci_0049                -1.298762e-02 3 1  ON 48
ci_0050                -1.260368e-02 3 1  ON 49
ci_0051                -1.294389e-02 3 1  ON 50
ci_0052                -1.265133e-02 3 1  ON 51
ci_0053                -1.387839e-02 3 1  ON 52
ci_0054                -1.179847e-02 3 1  ON 53
ci_0055                 1.219239e-02 3 1  ON 54
ci_0056                 1.338634e-02 3 1  ON 55
ci_0057                 1.369272e-02 3 1  ON 56
ci_0058                 1.231539e-02 3 1  ON 57
ci_0059                -1.313047e-02 3 1  ON 58
ci_0060                -1.299101e-02 3 1  ON 59
ci_0061                -1.353089e-02 3 1  ON 60
ci_0062                -1.256281e-02 3 1  ON 61
ci_0063                -1.256791e-02 3 1  ON 62
ci_0064                -1.104195e-02 3 1  ON 63
ci_0065                -1.210185e-02 3 1  ON 64
ci_0066                -1.150870e-02 3 1  ON 65
ci_0067                -1.143792e-02 3 1  ON 66
ci_0068                -1.062852e-02 3 1  ON 67
ci_0069                 1.107078e-02 3 1  ON 68
ci_0070                 9.962213e-03 3 1  ON 69
ci_0071                 9.977978e-03 3 1  ON 70
ci_0072                 9.896248e-03 3 1  ON 71
ci_0073                 1.156034e-02 3 1  ON 72
ci_0074                 1.066531e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.5409
    reference variance = 4.72699
====================================================
  Execution time = 1.2812e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5316e+00
  Total weights = 1.9459e+06
  Execution time = 2.2261e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559377165616
                                         uncertainty =       0.035169903538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559377165616
                                         uncertainty =       0.035169903538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131194529
  error estimate for blocks of size 2^( 2) =       0.001170337297
  error estimate for blocks of size 2^( 3) =       0.001203862944
  error estimate for blocks of size 2^( 4) =       0.001225504729
  error estimate for blocks of size 2^( 5) =       0.001241607091
  error estimate for blocks of size 2^( 6) =       0.001249146706
  error estimate for blocks of size 2^( 7) =       0.001255204702

      target function =                  N/A
              le_mean =     -16.717590980077
             les_mean =     282.018221670032
             stat err =       0.001242865807
             autocorr =       1.207185160558
              std dev =       1.599776240222
             le_variance =       2.559284018779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563524561990
                                         uncertainty =       0.035117770178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563524561990
                                         uncertainty =       0.035117770178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132107609
  error estimate for blocks of size 2^( 2) =       0.001171196495
  error estimate for blocks of size 2^( 3) =       0.001204679041
  error estimate for blocks of size 2^( 4) =       0.001226230897
  error estimate for blocks of size 2^( 5) =       0.001242318737
  error estimate for blocks of size 2^( 6) =       0.001249895775
  error estimate for blocks of size 2^( 7) =       0.001255699052

      target function =                  N/A
              le_mean =     -16.717624539065
             les_mean =     282.839758211263
             stat err =       0.001243536115
             autocorr =       1.206539061876
              std dev =       1.601067551058
             le_variance =       2.563417303052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560054902011
                                         uncertainty =       0.035171804579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560054902011
                                         uncertainty =       0.035171804579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131344073
  error estimate for blocks of size 2^( 2) =       0.001170433934
  error estimate for blocks of size 2^( 3) =       0.001203917095
  error estimate for blocks of size 2^( 4) =       0.001225522114
  error estimate for blocks of size 2^( 5) =       0.001241623426
  error estimate for blocks of size 2^( 6) =       0.001249168197
  error estimate for blocks of size 2^( 7) =       0.001255232950

      target function =                  N/A
              le_mean =     -16.717601052093
             les_mean =     282.017899804213
             stat err =       0.001242886672
             autocorr =       1.206906566719
              std dev =       1.599987730306
             le_variance =       2.559960737128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559354555916
                                         uncertainty =       0.035167615311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559354555916
                                         uncertainty =       0.035167615311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131189524
  error estimate for blocks of size 2^( 2) =       0.001170320319
  error estimate for blocks of size 2^( 3) =       0.001203840685
  error estimate for blocks of size 2^( 4) =       0.001225481355
  error estimate for blocks of size 2^( 5) =       0.001241584382
  error estimate for blocks of size 2^( 6) =       0.001249123019
  error estimate for blocks of size 2^( 7) =       0.001255193612

      target function =                  N/A
              le_mean =     -16.717572261519
             les_mean =     282.009489335002
             stat err =       0.001242845592
             autocorr =       1.207156572988
              std dev =       1.599769162432
             le_variance =       2.559261373067


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717590980077        initial
     6.2500e-02     6.2500e-01             1.8322e-03       -16.717624539065  <--
     2.5000e-01     2.5000e+00             1.1461e-03       -16.717601052093
     1.0000e+00     1.0000e+01             4.6118e-04       -16.717572261519

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.4079e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.065568e-01 3 1  ON 0
ci_0002                 6.799194e-01 3 1  ON 1
ci_0003                -4.788720e-02 3 1  ON 2
ci_0004                -4.653587e-02 3 1  ON 3
ci_0005                -4.494138e-02 3 1  ON 4
ci_0006                -4.417673e-02 3 1  ON 5
ci_0007                -2.986777e-02 3 1  ON 6
ci_0008                -3.129414e-02 3 1  ON 7
ci_0009                -3.294039e-02 3 1  ON 8
ci_0010                -3.092782e-02 3 1  ON 9
ci_0011                -2.861974e-02 3 1  ON 10
ci_0012                -2.648221e-02 3 1  ON 11
ci_0013                 2.840604e-02 3 1  ON 12
ci_0014                 2.684215e-02 3 1  ON 13
ci_0015                 2.756104e-02 3 1  ON 14
ci_0016                 2.642554e-02 3 1  ON 15
ci_0017                 2.491903e-02 3 1  ON 16
ci_0018                 2.342990e-02 3 1  ON 17
ci_0019                 2.106160e-02 3 1  ON 18
ci_0020                 1.892454e-02 3 1  ON 19
ci_0021                 1.885228e-02 3 1  ON 20
ci_0022                 1.893723e-02 3 1  ON 21
ci_0023                -2.007618e-02 3 1  ON 22
ci_0024                -1.794515e-02 3 1  ON 23
ci_0025                -1.864265e-02 3 1  ON 24
ci_0026                -1.749456e-02 3 1  ON 25
ci_0027                -1.807235e-02 3 1  ON 26
ci_0028                -1.718006e-02 3 1  ON 27
ci_0029                -1.646028e-02 3 1  ON 28
ci_0030                -1.556270e-02 3 1  ON 29
ci_0031                 1.619085e-02 3 1  ON 30
ci_0032                 1.480071e-02 3 1  ON 31
ci_0033                 1.660778e-02 3 1  ON 32
ci_0034                 1.542554e-02 3 1  ON 33
ci_0035                 1.844871e-02 3 1  ON 34
ci_0036                 1.670212e-02 3 1  ON 35
ci_0037                -1.484389e-02 3 1  ON 36
ci_0038                -1.558185e-02 3 1  ON 37
ci_0039                -1.575083e-02 3 1  ON 38
ci_0040                -1.543295e-02 3 1  ON 39
ci_0041                 1.647129e-02 3 1  ON 40
ci_0042                 1.539887e-02 3 1  ON 41
ci_0043                -1.567814e-02 3 1  ON 42
ci_0044                -1.601025e-02 3 1  ON 43
ci_0045                 1.542831e-02 3 1  ON 44
ci_0046                 1.517246e-02 3 1  ON 45
ci_0047                -1.465054e-02 3 1  ON 46
ci_0048                -1.382816e-02 3 1  ON 47
ci_0049                -1.351194e-02 3 1  ON 48
ci_0050                -1.191756e-02 3 1  ON 49
ci_0051                -1.309968e-02 3 1  ON 50
ci_0052                -1.252229e-02 3 1  ON 51
ci_0053                -1.406107e-02 3 1  ON 52
ci_0054                -1.146240e-02 3 1  ON 53
ci_0055                 1.231523e-02 3 1  ON 54
ci_0056                 1.362585e-02 3 1  ON 55
ci_0057                 1.381256e-02 3 1  ON 56
ci_0058                 1.212966e-02 3 1  ON 57
ci_0059                -1.299729e-02 3 1  ON 58
ci_0060                -1.311225e-02 3 1  ON 59
ci_0061                -1.365395e-02 3 1  ON 60
ci_0062                -1.225730e-02 3 1  ON 61
ci_0063                -1.257055e-02 3 1  ON 62
ci_0064                -1.054314e-02 3 1  ON 63
ci_0065                -1.235117e-02 3 1  ON 64
ci_0066                -1.161594e-02 3 1  ON 65
ci_0067                -1.150793e-02 3 1  ON 66
ci_0068                -1.065135e-02 3 1  ON 67
ci_0069                 1.127433e-02 3 1  ON 68
ci_0070                 1.000534e-02 3 1  ON 69
ci_0071                 1.005661e-02 3 1  ON 70
ci_0072                 1.052921e-02 3 1  ON 71
ci_0073                 1.169039e-02 3 1  ON 72
ci_0074                 1.065049e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6556e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.5656
    reference variance = 2.14776
====================================================
  Execution time = 1.3143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0277e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5006e+00
  Total weights = 1.946119264e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2252e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529447175259
                                         uncertainty =       0.022667925451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529447175259
                                         uncertainty =       0.022667925451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124640753
  error estimate for blocks of size 2^( 2) =       0.001164218596
  error estimate for blocks of size 2^( 3) =       0.001195489607
  error estimate for blocks of size 2^( 4) =       0.001221140814
  error estimate for blocks of size 2^( 5) =       0.001233730985
  error estimate for blocks of size 2^( 6) =       0.001246326324
  error estimate for blocks of size 2^( 7) =       0.001252188328

      target function =                  N/A
              le_mean =     -16.717340767421
             les_mean =     281.970124679477
             stat err =       0.001238346613
             autocorr =       1.212430373782
              std dev =       1.590507653317
             le_variance =       2.529714595261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671734076742e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717340766510       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717435444178       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717433121003       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717432535415       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717434051509       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.717436435186       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.717437366822       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.717437435746       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.717437954601       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.717437816874       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-02 is 3.275383e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717340766510       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717421624275       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717419090930       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717418666091       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717419273179       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.717419698857       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.717419639506       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-02 is 1.559642e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717340766510       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717391816981       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717390181485       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717390060034       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717390127205       residual = 7.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 9.172854e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059261 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6382e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.074340e-01 3 1  ON 0
ci_0002                 6.791242e-01 3 1  ON 1
ci_0003                -4.878501e-02 3 1  ON 2
ci_0004                -4.678788e-02 3 1  ON 3
ci_0005                -4.441046e-02 3 1  ON 4
ci_0006                -4.441602e-02 3 1  ON 5
ci_0007                -3.023089e-02 3 1  ON 6
ci_0008                -3.036936e-02 3 1  ON 7
ci_0009                -3.268144e-02 3 1  ON 8
ci_0010                -3.074559e-02 3 1  ON 9
ci_0011                -2.794484e-02 3 1  ON 10
ci_0012                -2.672884e-02 3 1  ON 11
ci_0013                 2.749982e-02 3 1  ON 12
ci_0014                 2.740715e-02 3 1  ON 13
ci_0015                 2.776180e-02 3 1  ON 14
ci_0016                 2.574740e-02 3 1  ON 15
ci_0017                 2.486115e-02 3 1  ON 16
ci_0018                 2.371368e-02 3 1  ON 17
ci_0019                 2.035277e-02 3 1  ON 18
ci_0020                 1.939231e-02 3 1  ON 19
ci_0021                 1.957807e-02 3 1  ON 20
ci_0022                 1.761674e-02 3 1  ON 21
ci_0023                -1.954340e-02 3 1  ON 22
ci_0024                -1.867765e-02 3 1  ON 23
ci_0025                -1.892998e-02 3 1  ON 24
ci_0026                -1.777488e-02 3 1  ON 25
ci_0027                -1.829825e-02 3 1  ON 26
ci_0028                -1.733043e-02 3 1  ON 27
ci_0029                -1.704876e-02 3 1  ON 28
ci_0030                -1.559317e-02 3 1  ON 29
ci_0031                 1.562231e-02 3 1  ON 30
ci_0032                 1.605236e-02 3 1  ON 31
ci_0033                 1.665240e-02 3 1  ON 32
ci_0034                 1.607399e-02 3 1  ON 33
ci_0035                 1.786651e-02 3 1  ON 34
ci_0036                 1.752226e-02 3 1  ON 35
ci_0037                -1.466133e-02 3 1  ON 36
ci_0038                -1.501415e-02 3 1  ON 37
ci_0039                -1.580055e-02 3 1  ON 38
ci_0040                -1.533719e-02 3 1  ON 39
ci_0041                 1.583604e-02 3 1  ON 40
ci_0042                 1.587533e-02 3 1  ON 41
ci_0043                -1.455943e-02 3 1  ON 42
ci_0044                -1.481971e-02 3 1  ON 43
ci_0045                 1.415624e-02 3 1  ON 44
ci_0046                 1.480858e-02 3 1  ON 45
ci_0047                -1.413063e-02 3 1  ON 46
ci_0048                -1.385069e-02 3 1  ON 47
ci_0049                -1.417659e-02 3 1  ON 48
ci_0050                -1.308547e-02 3 1  ON 49
ci_0051                -1.347298e-02 3 1  ON 50
ci_0052                -1.268501e-02 3 1  ON 51
ci_0053                -1.295389e-02 3 1  ON 52
ci_0054                -1.259703e-02 3 1  ON 53
ci_0055                 1.323543e-02 3 1  ON 54
ci_0056                 1.390135e-02 3 1  ON 55
ci_0057                 1.225292e-02 3 1  ON 56
ci_0058                 1.262013e-02 3 1  ON 57
ci_0059                -1.347985e-02 3 1  ON 58
ci_0060                -1.309613e-02 3 1  ON 59
ci_0061                -1.303275e-02 3 1  ON 60
ci_0062                -1.261788e-02 3 1  ON 61
ci_0063                -1.231989e-02 3 1  ON 62
ci_0064                -1.151389e-02 3 1  ON 63
ci_0065                -1.096223e-02 3 1  ON 64
ci_0066                -1.152403e-02 3 1  ON 65
ci_0067                -1.158139e-02 3 1  ON 66
ci_0068                -1.074632e-02 3 1  ON 67
ci_0069                 1.115926e-02 3 1  ON 68
ci_0070                 1.023096e-02 3 1  ON 69
ci_0071                 1.056843e-02 3 1  ON 70
ci_0072                 9.380545e-03 3 1  ON 71
ci_0073                 1.055205e-02 3 1  ON 72
ci_0074                 9.840970e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.674
    reference variance = 4.27117
====================================================
  Execution time = 1.2836e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5211e+00
  Total weights = 1.9454e+06
  Execution time = 2.2246e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552570892924
                                         uncertainty =       0.029660340710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552570892924
                                         uncertainty =       0.029660340710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129536035
  error estimate for blocks of size 2^( 2) =       0.001168228424
  error estimate for blocks of size 2^( 3) =       0.001200890489
  error estimate for blocks of size 2^( 4) =       0.001222955085
  error estimate for blocks of size 2^( 5) =       0.001235816837
  error estimate for blocks of size 2^( 6) =       0.001245468743
  error estimate for blocks of size 2^( 7) =       0.001243852702

      target function =                  N/A
              le_mean =     -16.719737054415
             les_mean =     282.109608194816
             stat err =       0.001237023342
             autocorr =       1.199376700026
              std dev =       1.597430738748
             le_variance =       2.551784965096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552171481831
                                         uncertainty =       0.029746864938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552171481831
                                         uncertainty =       0.029746864938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129449629
  error estimate for blocks of size 2^( 2) =       0.001168180871
  error estimate for blocks of size 2^( 3) =       0.001200866547
  error estimate for blocks of size 2^( 4) =       0.001222970075
  error estimate for blocks of size 2^( 5) =       0.001235890031
  error estimate for blocks of size 2^( 6) =       0.001245548892
  error estimate for blocks of size 2^( 7) =       0.001243797877

      target function =                  N/A
              le_mean =     -16.719613921638
             les_mean =     282.091405864079
             stat err =       0.001237051718
             autocorr =       1.199615254443
              std dev =       1.597308539702
             le_variance =       2.551394571005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556584944732
                                         uncertainty =       0.029624168170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556584944732
                                         uncertainty =       0.029624168170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130427088
  error estimate for blocks of size 2^( 2) =       0.001169136131
  error estimate for blocks of size 2^( 3) =       0.001201783557
  error estimate for blocks of size 2^( 4) =       0.001223825731
  error estimate for blocks of size 2^( 5) =       0.001236868636
  error estimate for blocks of size 2^( 6) =       0.001246800588
  error estimate for blocks of size 2^( 7) =       0.001244953492

      target function =                  N/A
              le_mean =     -16.719644575022
             les_mean =     283.088044688680
             stat err =       0.001238112112
             autocorr =       1.199595513352
              std dev =       1.598690897050
             le_variance =       2.555812584312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551670713467
                                         uncertainty =       0.029731752663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551670713467
                                         uncertainty =       0.029731752663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129338456
  error estimate for blocks of size 2^( 2) =       0.001168064528
  error estimate for blocks of size 2^( 3) =       0.001200748544
  error estimate for blocks of size 2^( 4) =       0.001222847756
  error estimate for blocks of size 2^( 5) =       0.001235746992
  error estimate for blocks of size 2^( 6) =       0.001245404455
  error estimate for blocks of size 2^( 7) =       0.001243693087

      target function =                  N/A
              le_mean =     -16.719636297761
             les_mean =     282.068000632584
             stat err =       0.001236923073
             autocorr =       1.199601906049
              std dev =       1.597151315191
             le_variance =       2.550892323616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719737054415        initial  <--
     1.5625e-02     1.5625e-01             3.2754e-03       -16.719613921638
     6.2500e-02     6.2500e-01             1.5596e-03       -16.719644575022
     2.5000e-01     2.5000e+00             9.1729e-04       -16.719636297761

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0699
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.065568e-01 3 1  ON 0
ci_0002                 6.799194e-01 3 1  ON 1
ci_0003                -4.788720e-02 3 1  ON 2
ci_0004                -4.653587e-02 3 1  ON 3
ci_0005                -4.494138e-02 3 1  ON 4
ci_0006                -4.417673e-02 3 1  ON 5
ci_0007                -2.986777e-02 3 1  ON 6
ci_0008                -3.129414e-02 3 1  ON 7
ci_0009                -3.294039e-02 3 1  ON 8
ci_0010                -3.092782e-02 3 1  ON 9
ci_0011                -2.861974e-02 3 1  ON 10
ci_0012                -2.648221e-02 3 1  ON 11
ci_0013                 2.840604e-02 3 1  ON 12
ci_0014                 2.684215e-02 3 1  ON 13
ci_0015                 2.756104e-02 3 1  ON 14
ci_0016                 2.642554e-02 3 1  ON 15
ci_0017                 2.491903e-02 3 1  ON 16
ci_0018                 2.342990e-02 3 1  ON 17
ci_0019                 2.106160e-02 3 1  ON 18
ci_0020                 1.892454e-02 3 1  ON 19
ci_0021                 1.885228e-02 3 1  ON 20
ci_0022                 1.893723e-02 3 1  ON 21
ci_0023                -2.007618e-02 3 1  ON 22
ci_0024                -1.794515e-02 3 1  ON 23
ci_0025                -1.864265e-02 3 1  ON 24
ci_0026                -1.749456e-02 3 1  ON 25
ci_0027                -1.807235e-02 3 1  ON 26
ci_0028                -1.718006e-02 3 1  ON 27
ci_0029                -1.646028e-02 3 1  ON 28
ci_0030                -1.556270e-02 3 1  ON 29
ci_0031                 1.619085e-02 3 1  ON 30
ci_0032                 1.480071e-02 3 1  ON 31
ci_0033                 1.660778e-02 3 1  ON 32
ci_0034                 1.542554e-02 3 1  ON 33
ci_0035                 1.844871e-02 3 1  ON 34
ci_0036                 1.670212e-02 3 1  ON 35
ci_0037                -1.484389e-02 3 1  ON 36
ci_0038                -1.558185e-02 3 1  ON 37
ci_0039                -1.575083e-02 3 1  ON 38
ci_0040                -1.543295e-02 3 1  ON 39
ci_0041                 1.647129e-02 3 1  ON 40
ci_0042                 1.539887e-02 3 1  ON 41
ci_0043                -1.567814e-02 3 1  ON 42
ci_0044                -1.601025e-02 3 1  ON 43
ci_0045                 1.542831e-02 3 1  ON 44
ci_0046                 1.517246e-02 3 1  ON 45
ci_0047                -1.465054e-02 3 1  ON 46
ci_0048                -1.382816e-02 3 1  ON 47
ci_0049                -1.351194e-02 3 1  ON 48
ci_0050                -1.191756e-02 3 1  ON 49
ci_0051                -1.309968e-02 3 1  ON 50
ci_0052                -1.252229e-02 3 1  ON 51
ci_0053                -1.406107e-02 3 1  ON 52
ci_0054                -1.146240e-02 3 1  ON 53
ci_0055                 1.231523e-02 3 1  ON 54
ci_0056                 1.362585e-02 3 1  ON 55
ci_0057                 1.381256e-02 3 1  ON 56
ci_0058                 1.212966e-02 3 1  ON 57
ci_0059                -1.299729e-02 3 1  ON 58
ci_0060                -1.311225e-02 3 1  ON 59
ci_0061                -1.365395e-02 3 1  ON 60
ci_0062                -1.225730e-02 3 1  ON 61
ci_0063                -1.257055e-02 3 1  ON 62
ci_0064                -1.054314e-02 3 1  ON 63
ci_0065                -1.235117e-02 3 1  ON 64
ci_0066                -1.161594e-02 3 1  ON 65
ci_0067                -1.150793e-02 3 1  ON 66
ci_0068                -1.065135e-02 3 1  ON 67
ci_0069                 1.127433e-02 3 1  ON 68
ci_0070                 1.000534e-02 3 1  ON 69
ci_0071                 1.005661e-02 3 1  ON 70
ci_0072                 1.052921e-02 3 1  ON 71
ci_0073                 1.169039e-02 3 1  ON 72
ci_0074                 1.065049e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0467e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6577e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.5985
    reference variance = 2.70817
====================================================
  Execution time = 1.3076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0287e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5393e+00
  Total weights = 1.945634773e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2037e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563718779938
                                         uncertainty =       0.046881143851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563718779938
                                         uncertainty =       0.046881143851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132421922
  error estimate for blocks of size 2^( 2) =       0.001171043784
  error estimate for blocks of size 2^( 3) =       0.001202057156
  error estimate for blocks of size 2^( 4) =       0.001226600735
  error estimate for blocks of size 2^( 5) =       0.001241246207
  error estimate for blocks of size 2^( 6) =       0.001250285531
  error estimate for blocks of size 2^( 7) =       0.001250312825

      target function =                  N/A
              le_mean =     -16.717753414521
             les_mean =     282.022538521860
             stat err =       0.001242111325
             autocorr =       1.203107699832
              std dev =       1.601512064560
             le_variance =       2.564840892932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671775341452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717753413592       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717798040695       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717798417040       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717798786132       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.717798960692       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-01 is 1.181883e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717753413592       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717774243549       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717774108426       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717774138136       residual = 4.89e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 4.664842e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717753413592       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717760062189       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717760036369       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.576897e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6291e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.067017e-01 3 1  ON 0
ci_0002                 6.798541e-01 3 1  ON 1
ci_0003                -4.754169e-02 3 1  ON 2
ci_0004                -4.659454e-02 3 1  ON 3
ci_0005                -4.514758e-02 3 1  ON 4
ci_0006                -4.416639e-02 3 1  ON 5
ci_0007                -2.999709e-02 3 1  ON 6
ci_0008                -3.153070e-02 3 1  ON 7
ci_0009                -3.276224e-02 3 1  ON 8
ci_0010                -3.092069e-02 3 1  ON 9
ci_0011                -2.818666e-02 3 1  ON 10
ci_0012                -2.630991e-02 3 1  ON 11
ci_0013                 2.825421e-02 3 1  ON 12
ci_0014                 2.685923e-02 3 1  ON 13
ci_0015                 2.751409e-02 3 1  ON 14
ci_0016                 2.633845e-02 3 1  ON 15
ci_0017                 2.472658e-02 3 1  ON 16
ci_0018                 2.331374e-02 3 1  ON 17
ci_0019                 2.092153e-02 3 1  ON 18
ci_0020                 1.847903e-02 3 1  ON 19
ci_0021                 1.888466e-02 3 1  ON 20
ci_0022                 1.930766e-02 3 1  ON 21
ci_0023                -1.988331e-02 3 1  ON 22
ci_0024                -1.798490e-02 3 1  ON 23
ci_0025                -1.876337e-02 3 1  ON 24
ci_0026                -1.779172e-02 3 1  ON 25
ci_0027                -1.826585e-02 3 1  ON 26
ci_0028                -1.703995e-02 3 1  ON 27
ci_0029                -1.639741e-02 3 1  ON 28
ci_0030                -1.576447e-02 3 1  ON 29
ci_0031                 1.634121e-02 3 1  ON 30
ci_0032                 1.433423e-02 3 1  ON 31
ci_0033                 1.675443e-02 3 1  ON 32
ci_0034                 1.540004e-02 3 1  ON 33
ci_0035                 1.802344e-02 3 1  ON 34
ci_0036                 1.652209e-02 3 1  ON 35
ci_0037                -1.472619e-02 3 1  ON 36
ci_0038                -1.524344e-02 3 1  ON 37
ci_0039                -1.620626e-02 3 1  ON 38
ci_0040                -1.518635e-02 3 1  ON 39
ci_0041                 1.620462e-02 3 1  ON 40
ci_0042                 1.536403e-02 3 1  ON 41
ci_0043                -1.563976e-02 3 1  ON 42
ci_0044                -1.562303e-02 3 1  ON 43
ci_0045                 1.567419e-02 3 1  ON 44
ci_0046                 1.555759e-02 3 1  ON 45
ci_0047                -1.470789e-02 3 1  ON 46
ci_0048                -1.393431e-02 3 1  ON 47
ci_0049                -1.347214e-02 3 1  ON 48
ci_0050                -1.227245e-02 3 1  ON 49
ci_0051                -1.309679e-02 3 1  ON 50
ci_0052                -1.243354e-02 3 1  ON 51
ci_0053                -1.373794e-02 3 1  ON 52
ci_0054                -1.161104e-02 3 1  ON 53
ci_0055                 1.253692e-02 3 1  ON 54
ci_0056                 1.374795e-02 3 1  ON 55
ci_0057                 1.357181e-02 3 1  ON 56
ci_0058                 1.228393e-02 3 1  ON 57
ci_0059                -1.296233e-02 3 1  ON 58
ci_0060                -1.273108e-02 3 1  ON 59
ci_0061                -1.348953e-02 3 1  ON 60
ci_0062                -1.231177e-02 3 1  ON 61
ci_0063                -1.236135e-02 3 1  ON 62
ci_0064                -1.088970e-02 3 1  ON 63
ci_0065                -1.198963e-02 3 1  ON 64
ci_0066                -1.155642e-02 3 1  ON 65
ci_0067                -1.121743e-02 3 1  ON 66
ci_0068                -1.062930e-02 3 1  ON 67
ci_0069                 1.119459e-02 3 1  ON 68
ci_0070                 1.029254e-02 3 1  ON 69
ci_0071                 9.950455e-03 3 1  ON 70
ci_0072                 1.012261e-02 3 1  ON 71
ci_0073                 1.155848e-02 3 1  ON 72
ci_0074                 1.100184e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8308
    reference variance = 0.972688
====================================================
  Execution time = 1.2933e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5605e+00
  Total weights = 1.9458e+06
  Execution time = 2.2380e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.220172
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589392618070
                                         uncertainty =       0.041623844963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589392618070
                                         uncertainty =       0.041623844963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137804317
  error estimate for blocks of size 2^( 2) =       0.001176683534
  error estimate for blocks of size 2^( 3) =       0.001209871177
  error estimate for blocks of size 2^( 4) =       0.001232920649
  error estimate for blocks of size 2^( 5) =       0.001246041374
  error estimate for blocks of size 2^( 6) =       0.001252089704
  error estimate for blocks of size 2^( 7) =       0.001258810780

      target function =                  N/A
              le_mean =     -16.716170989027
             les_mean =     283.915747428514
             stat err =       0.001247465627
             autocorr =       1.202048583181
              std dev =       1.609124041988
             le_variance =       2.589280182505

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0434531
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592555124652
                                         uncertainty =       0.041804222457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.592555124652
                                         uncertainty =       0.041804222457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138497827
  error estimate for blocks of size 2^( 2) =       0.001177403554
  error estimate for blocks of size 2^( 3) =       0.001210622368
  error estimate for blocks of size 2^( 4) =       0.001233613753
  error estimate for blocks of size 2^( 5) =       0.001246823732
  error estimate for blocks of size 2^( 6) =       0.001252939536
  error estimate for blocks of size 2^( 7) =       0.001259596225

      target function =                  N/A
              le_mean =     -16.716225645492
             les_mean =     282.711500184550
             stat err =       0.001248243312
             autocorr =       1.202081970106
              std dev =       1.610104828956
             le_variance =       2.592437560229

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.230494
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588080187775
                                         uncertainty =       0.041622671764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588080187775
                                         uncertainty =       0.041622671764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137517340
  error estimate for blocks of size 2^( 2) =       0.001176428443
  error estimate for blocks of size 2^( 3) =       0.001209702973
  error estimate for blocks of size 2^( 4) =       0.001232788548
  error estimate for blocks of size 2^( 5) =       0.001245959137
  error estimate for blocks of size 2^( 6) =       0.001252104397
  error estimate for blocks of size 2^( 7) =       0.001258749350

      target function =                  N/A
              le_mean =     -16.716179220252
             les_mean =     281.991937666892
             stat err =       0.001247400358
             autocorr =       1.202529328887
              std dev =       1.608718188974
             le_variance =       2.587974211537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588815119783
                                         uncertainty =       0.041618086695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588815119783
                                         uncertainty =       0.041618086695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137677933
  error estimate for blocks of size 2^( 2) =       0.001176559476
  error estimate for blocks of size 2^( 3) =       0.001209766894
  error estimate for blocks of size 2^( 4) =       0.001232826977
  error estimate for blocks of size 2^( 5) =       0.001245955998
  error estimate for blocks of size 2^( 6) =       0.001252033571
  error estimate for blocks of size 2^( 7) =       0.001258726481

      target function =                  N/A
              le_mean =     -16.716172373110
             les_mean =     281.995992620957
             stat err =       0.001247385757
             autocorr =       1.202161715329
              std dev =       1.608945304278
             le_variance =       2.588704992160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716170989027        initial
     1.5625e-01     1.5625e+00             1.1819e-03       -16.716225645492  <--
     6.2500e-01     6.2500e+00             4.6648e-04       -16.716179220252
     2.5000e+00     2.5000e+01             1.5769e-04       -16.716172373110

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.7364e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.069615e-01 3 1  ON 0
ci_0002                 6.796452e-01 3 1  ON 1
ci_0003                -4.711502e-02 3 1  ON 2
ci_0004                -4.669465e-02 3 1  ON 3
ci_0005                -4.553725e-02 3 1  ON 4
ci_0006                -4.417681e-02 3 1  ON 5
ci_0007                -3.026610e-02 3 1  ON 6
ci_0008                -3.199178e-02 3 1  ON 7
ci_0009                -3.257478e-02 3 1  ON 8
ci_0010                -3.091080e-02 3 1  ON 9
ci_0011                -2.767877e-02 3 1  ON 10
ci_0012                -2.610578e-02 3 1  ON 11
ci_0013                 2.809790e-02 3 1  ON 12
ci_0014                 2.687292e-02 3 1  ON 13
ci_0015                 2.746986e-02 3 1  ON 14
ci_0016                 2.623563e-02 3 1  ON 15
ci_0017                 2.452800e-02 3 1  ON 16
ci_0018                 2.318318e-02 3 1  ON 17
ci_0019                 2.079745e-02 3 1  ON 18
ci_0020                 1.794712e-02 3 1  ON 19
ci_0021                 1.889654e-02 3 1  ON 20
ci_0022                 1.995597e-02 3 1  ON 21
ci_0023                -1.969070e-02 3 1  ON 22
ci_0024                -1.803712e-02 3 1  ON 23
ci_0025                -1.893160e-02 3 1  ON 24
ci_0026                -1.812451e-02 3 1  ON 25
ci_0027                -1.855009e-02 3 1  ON 26
ci_0028                -1.686783e-02 3 1  ON 27
ci_0029                -1.637710e-02 3 1  ON 28
ci_0030                -1.602105e-02 3 1  ON 29
ci_0031                 1.665744e-02 3 1  ON 30
ci_0032                 1.361883e-02 3 1  ON 31
ci_0033                 1.702850e-02 3 1  ON 32
ci_0034                 1.535855e-02 3 1  ON 33
ci_0035                 1.750210e-02 3 1  ON 34
ci_0036                 1.628402e-02 3 1  ON 35
ci_0037                -1.457695e-02 3 1  ON 36
ci_0038                -1.475685e-02 3 1  ON 37
ci_0039                -1.661666e-02 3 1  ON 38
ci_0040                -1.496304e-02 3 1  ON 39
ci_0041                 1.592652e-02 3 1  ON 40
ci_0042                 1.530200e-02 3 1  ON 41
ci_0043                -1.555274e-02 3 1  ON 42
ci_0044                -1.493850e-02 3 1  ON 43
ci_0045                 1.603763e-02 3 1  ON 44
ci_0046                 1.613814e-02 3 1  ON 45
ci_0047                -1.476444e-02 3 1  ON 46
ci_0048                -1.402824e-02 3 1  ON 47
ci_0049                -1.343470e-02 3 1  ON 48
ci_0050                -1.270341e-02 3 1  ON 49
ci_0051                -1.309999e-02 3 1  ON 50
ci_0052                -1.236486e-02 3 1  ON 51
ci_0053                -1.342251e-02 3 1  ON 52
ci_0054                -1.174882e-02 3 1  ON 53
ci_0055                 1.285619e-02 3 1  ON 54
ci_0056                 1.392210e-02 3 1  ON 55
ci_0057                 1.326794e-02 3 1  ON 56
ci_0058                 1.249588e-02 3 1  ON 57
ci_0059                -1.292939e-02 3 1  ON 58
ci_0060                -1.234416e-02 3 1  ON 59
ci_0061                -1.328663e-02 3 1  ON 60
ci_0062                -1.237539e-02 3 1  ON 61
ci_0063                -1.215864e-02 3 1  ON 62
ci_0064                -1.126961e-02 3 1  ON 63
ci_0065                -1.161838e-02 3 1  ON 64
ci_0066                -1.148212e-02 3 1  ON 65
ci_0067                -1.095422e-02 3 1  ON 66
ci_0068                -1.059440e-02 3 1  ON 67
ci_0069                 1.113525e-02 3 1  ON 68
ci_0070                 1.054829e-02 3 1  ON 69
ci_0071                 9.790722e-03 3 1  ON 70
ci_0072                 9.632216e-03 3 1  ON 71
ci_0073                 1.142794e-02 3 1  ON 72
ci_0074                 1.133329e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3669e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6612e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.7814
    reference variance = 2.73015
====================================================
  Execution time = 1.3450e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0298e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.4786e+00
  Total weights = 1.945868090e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2190e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506795256859
                                         uncertainty =       0.019484058498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506795256859
                                         uncertainty =       0.019484058498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119455526
  error estimate for blocks of size 2^( 2) =       0.001158615037
  error estimate for blocks of size 2^( 3) =       0.001192428475
  error estimate for blocks of size 2^( 4) =       0.001215019869
  error estimate for blocks of size 2^( 5) =       0.001229917368
  error estimate for blocks of size 2^( 6) =       0.001237952894
  error estimate for blocks of size 2^( 7) =       0.001248734852

      target function =                  N/A
              le_mean =     -16.720122496025
             les_mean =     282.041073711672
             stat err =       0.001232906246
             autocorr =       1.212959824384
              std dev =       1.583174517405
             le_variance =       2.506441552561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672012249603e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720122495153       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720175767367       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720178807706       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.720178548563       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.720178515518       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.720178597218       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.720178679157       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.720178958754       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-02 is 2.539619e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720122495153       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720159468696       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720160200874       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.720160050250       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.720160050630       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-01 is 1.561153e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720122495153       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720139121343       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720139043112       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.720139029320       residual = 2.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 6.144961e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065302 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6677e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.072052e-01 3 1  ON 0
ci_0002                 6.794774e-01 3 1  ON 1
ci_0003                -4.758849e-02 3 1  ON 2
ci_0004                -4.669034e-02 3 1  ON 3
ci_0005                -4.551357e-02 3 1  ON 4
ci_0006                -4.389446e-02 3 1  ON 5
ci_0007                -3.071753e-02 3 1  ON 6
ci_0008                -3.223399e-02 3 1  ON 7
ci_0009                -3.272681e-02 3 1  ON 8
ci_0010                -3.169088e-02 3 1  ON 9
ci_0011                -2.757877e-02 3 1  ON 10
ci_0012                -2.543109e-02 3 1  ON 11
ci_0013                 2.740586e-02 3 1  ON 12
ci_0014                 2.665567e-02 3 1  ON 13
ci_0015                 2.684394e-02 3 1  ON 14
ci_0016                 2.649144e-02 3 1  ON 15
ci_0017                 2.446489e-02 3 1  ON 16
ci_0018                 2.290879e-02 3 1  ON 17
ci_0019                 2.053177e-02 3 1  ON 18
ci_0020                 1.836231e-02 3 1  ON 19
ci_0021                 1.871092e-02 3 1  ON 20
ci_0022                 1.945607e-02 3 1  ON 21
ci_0023                -1.963027e-02 3 1  ON 22
ci_0024                -1.781846e-02 3 1  ON 23
ci_0025                -1.834512e-02 3 1  ON 24
ci_0026                -1.742011e-02 3 1  ON 25
ci_0027                -1.851989e-02 3 1  ON 26
ci_0028                -1.726523e-02 3 1  ON 27
ci_0029                -1.608988e-02 3 1  ON 28
ci_0030                -1.679866e-02 3 1  ON 29
ci_0031                 1.631173e-02 3 1  ON 30
ci_0032                 1.403408e-02 3 1  ON 31
ci_0033                 1.632294e-02 3 1  ON 32
ci_0034                 1.549247e-02 3 1  ON 33
ci_0035                 1.827611e-02 3 1  ON 34
ci_0036                 1.690832e-02 3 1  ON 35
ci_0037                -1.505121e-02 3 1  ON 36
ci_0038                -1.480040e-02 3 1  ON 37
ci_0039                -1.632541e-02 3 1  ON 38
ci_0040                -1.563386e-02 3 1  ON 39
ci_0041                 1.567238e-02 3 1  ON 40
ci_0042                 1.523257e-02 3 1  ON 41
ci_0043                -1.567495e-02 3 1  ON 42
ci_0044                -1.427440e-02 3 1  ON 43
ci_0045                 1.503012e-02 3 1  ON 44
ci_0046                 1.457699e-02 3 1  ON 45
ci_0047                -1.482390e-02 3 1  ON 46
ci_0048                -1.367400e-02 3 1  ON 47
ci_0049                -1.381265e-02 3 1  ON 48
ci_0050                -1.290685e-02 3 1  ON 49
ci_0051                -1.296513e-02 3 1  ON 50
ci_0052                -1.227697e-02 3 1  ON 51
ci_0053                -1.328544e-02 3 1  ON 52
ci_0054                -1.191089e-02 3 1  ON 53
ci_0055                 1.340737e-02 3 1  ON 54
ci_0056                 1.335391e-02 3 1  ON 55
ci_0057                 1.275702e-02 3 1  ON 56
ci_0058                 1.253475e-02 3 1  ON 57
ci_0059                -1.336531e-02 3 1  ON 58
ci_0060                -1.283573e-02 3 1  ON 59
ci_0061                -1.378693e-02 3 1  ON 60
ci_0062                -1.234819e-02 3 1  ON 61
ci_0063                -1.220005e-02 3 1  ON 62
ci_0064                -1.098396e-02 3 1  ON 63
ci_0065                -1.198710e-02 3 1  ON 64
ci_0066                -1.129386e-02 3 1  ON 65
ci_0067                -1.071777e-02 3 1  ON 66
ci_0068                -1.042237e-02 3 1  ON 67
ci_0069                 1.095053e-02 3 1  ON 68
ci_0070                 1.035922e-02 3 1  ON 69
ci_0071                 9.540687e-03 3 1  ON 70
ci_0072                 1.002403e-02 3 1  ON 71
ci_0073                 1.139114e-02 3 1  ON 72
ci_0074                 1.115127e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.6167
    reference variance = 7.05429
====================================================
  Execution time = 1.2794e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5904e+00
  Total weights = 1.9458e+06
  Execution time = 2.2113e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621361462158
                                         uncertainty =       0.046520356027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621361462158
                                         uncertainty =       0.046520356027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144788756
  error estimate for blocks of size 2^( 2) =       0.001182540245
  error estimate for blocks of size 2^( 3) =       0.001213601425
  error estimate for blocks of size 2^( 4) =       0.001234302984
  error estimate for blocks of size 2^( 5) =       0.001247624955
  error estimate for blocks of size 2^( 6) =       0.001254707673
  error estimate for blocks of size 2^( 7) =       0.001258389435

      target function =                  N/A
              le_mean =     -16.717555699829
             les_mean =     282.084682739250
             stat err =       0.001248756261
             autocorr =       1.189884060993
              std dev =       1.619001688871
             le_variance =       2.621166468567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621418407645
                                         uncertainty =       0.046508997861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621418407645
                                         uncertainty =       0.046508997861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144801478
  error estimate for blocks of size 2^( 2) =       0.001182562058
  error estimate for blocks of size 2^( 3) =       0.001213606656
  error estimate for blocks of size 2^( 4) =       0.001234329533
  error estimate for blocks of size 2^( 5) =       0.001247641267
  error estimate for blocks of size 2^( 6) =       0.001254680225
  error estimate for blocks of size 2^( 7) =       0.001258377562

      target function =                  N/A
              le_mean =     -16.717550722845
             les_mean =     282.081228579209
             stat err =       0.001248757147
             autocorr =       1.189859303665
              std dev =       1.619019679644
             le_variance =       2.621224723074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621719235594
                                         uncertainty =       0.046502290855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621719235594
                                         uncertainty =       0.046502290855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144867265
  error estimate for blocks of size 2^( 2) =       0.001182625480
  error estimate for blocks of size 2^( 3) =       0.001213655107
  error estimate for blocks of size 2^( 4) =       0.001234365917
  error estimate for blocks of size 2^( 5) =       0.001247674434
  error estimate for blocks of size 2^( 6) =       0.001254677145
  error estimate for blocks of size 2^( 7) =       0.001258391509

      target function =                  N/A
              le_mean =     -16.717575014865
             les_mean =     282.074542308487
             stat err =       0.001248777251
             autocorr =       1.189760870288
              std dev =       1.619112718670
             le_variance =       2.621525995759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621284539137
                                         uncertainty =       0.046525079988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.621284539137
                                         uncertainty =       0.046525079988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144772031
  error estimate for blocks of size 2^( 2) =       0.001182530356
  error estimate for blocks of size 2^( 3) =       0.001213586786
  error estimate for blocks of size 2^( 4) =       0.001234297185
  error estimate for blocks of size 2^( 5) =       0.001247625883
  error estimate for blocks of size 2^( 6) =       0.001254712351
  error estimate for blocks of size 2^( 7) =       0.001258400137

      target function =                  N/A
              le_mean =     -16.717546680417
             les_mean =     282.177675463130
             stat err =       0.001248758889
             autocorr =       1.189923838096
              std dev =       1.618978034930
             le_variance =       2.621089877585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717555699829        initial
     3.9062e-02     3.9062e-01             2.5396e-03       -16.717550722845
     1.5625e-01     1.5625e+00             1.5612e-03       -16.717575014865  <--
     6.2500e-01     6.2500e+00             6.1450e-04       -16.717546680417

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.4073e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.072052e-01 3 1  ON 0
ci_0002                 6.794774e-01 3 1  ON 1
ci_0003                -4.758849e-02 3 1  ON 2
ci_0004                -4.669034e-02 3 1  ON 3
ci_0005                -4.551357e-02 3 1  ON 4
ci_0006                -4.389446e-02 3 1  ON 5
ci_0007                -3.071753e-02 3 1  ON 6
ci_0008                -3.223399e-02 3 1  ON 7
ci_0009                -3.272681e-02 3 1  ON 8
ci_0010                -3.169088e-02 3 1  ON 9
ci_0011                -2.757877e-02 3 1  ON 10
ci_0012                -2.543109e-02 3 1  ON 11
ci_0013                 2.740586e-02 3 1  ON 12
ci_0014                 2.665567e-02 3 1  ON 13
ci_0015                 2.684394e-02 3 1  ON 14
ci_0016                 2.649144e-02 3 1  ON 15
ci_0017                 2.446489e-02 3 1  ON 16
ci_0018                 2.290879e-02 3 1  ON 17
ci_0019                 2.053177e-02 3 1  ON 18
ci_0020                 1.836231e-02 3 1  ON 19
ci_0021                 1.871092e-02 3 1  ON 20
ci_0022                 1.945607e-02 3 1  ON 21
ci_0023                -1.963027e-02 3 1  ON 22
ci_0024                -1.781846e-02 3 1  ON 23
ci_0025                -1.834512e-02 3 1  ON 24
ci_0026                -1.742011e-02 3 1  ON 25
ci_0027                -1.851989e-02 3 1  ON 26
ci_0028                -1.726523e-02 3 1  ON 27
ci_0029                -1.608988e-02 3 1  ON 28
ci_0030                -1.679866e-02 3 1  ON 29
ci_0031                 1.631173e-02 3 1  ON 30
ci_0032                 1.403408e-02 3 1  ON 31
ci_0033                 1.632294e-02 3 1  ON 32
ci_0034                 1.549247e-02 3 1  ON 33
ci_0035                 1.827611e-02 3 1  ON 34
ci_0036                 1.690832e-02 3 1  ON 35
ci_0037                -1.505121e-02 3 1  ON 36
ci_0038                -1.480040e-02 3 1  ON 37
ci_0039                -1.632541e-02 3 1  ON 38
ci_0040                -1.563386e-02 3 1  ON 39
ci_0041                 1.567238e-02 3 1  ON 40
ci_0042                 1.523257e-02 3 1  ON 41
ci_0043                -1.567495e-02 3 1  ON 42
ci_0044                -1.427440e-02 3 1  ON 43
ci_0045                 1.503012e-02 3 1  ON 44
ci_0046                 1.457699e-02 3 1  ON 45
ci_0047                -1.482390e-02 3 1  ON 46
ci_0048                -1.367400e-02 3 1  ON 47
ci_0049                -1.381265e-02 3 1  ON 48
ci_0050                -1.290685e-02 3 1  ON 49
ci_0051                -1.296513e-02 3 1  ON 50
ci_0052                -1.227697e-02 3 1  ON 51
ci_0053                -1.328544e-02 3 1  ON 52
ci_0054                -1.191089e-02 3 1  ON 53
ci_0055                 1.340737e-02 3 1  ON 54
ci_0056                 1.335391e-02 3 1  ON 55
ci_0057                 1.275702e-02 3 1  ON 56
ci_0058                 1.253475e-02 3 1  ON 57
ci_0059                -1.336531e-02 3 1  ON 58
ci_0060                -1.283573e-02 3 1  ON 59
ci_0061                -1.378693e-02 3 1  ON 60
ci_0062                -1.234819e-02 3 1  ON 61
ci_0063                -1.220005e-02 3 1  ON 62
ci_0064                -1.098396e-02 3 1  ON 63
ci_0065                -1.198710e-02 3 1  ON 64
ci_0066                -1.129386e-02 3 1  ON 65
ci_0067                -1.071777e-02 3 1  ON 66
ci_0068                -1.042237e-02 3 1  ON 67
ci_0069                 1.095053e-02 3 1  ON 68
ci_0070                 1.035922e-02 3 1  ON 69
ci_0071                 9.540687e-03 3 1  ON 70
ci_0072                 1.002403e-02 3 1  ON 71
ci_0073                 1.139114e-02 3 1  ON 72
ci_0074                 1.115127e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6629e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8279
    reference variance = 1.20125
====================================================
  Execution time = 1.3022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0242e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5395e+00
  Total weights = 1.945799939e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2407e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570029514000
                                         uncertainty =       0.043897364213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570029514000
                                         uncertainty =       0.043897364213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133524218
  error estimate for blocks of size 2^( 2) =       0.001171309664
  error estimate for blocks of size 2^( 3) =       0.001204683490
  error estimate for blocks of size 2^( 4) =       0.001228718159
  error estimate for blocks of size 2^( 5) =       0.001241651841
  error estimate for blocks of size 2^( 6) =       0.001253317489
  error estimate for blocks of size 2^( 7) =       0.001261808067

      target function =                  N/A
              le_mean =     -16.719850279855
             les_mean =     282.092912019802
             stat err =       0.001246373889
             autocorr =       1.209024433170
              std dev =       1.603070970779
             le_variance =       2.569836537355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671985027986e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719850278950       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719940060234       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719947259966       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719948907453       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.719950046240       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.719950090972       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-02 is 2.863179e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719850278950       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719910482497       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719912882520       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719913151842       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.719913384819       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-01 is 1.899474e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719850278950       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719876253498       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719876644546       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719876632577       residual = 4.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 8.108031e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067230 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6269e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.071555e-01 3 1  ON 0
ci_0002                 6.794977e-01 3 1  ON 1
ci_0003                -4.948796e-02 3 1  ON 2
ci_0004                -4.512997e-02 3 1  ON 3
ci_0005                -4.619179e-02 3 1  ON 4
ci_0006                -4.488500e-02 3 1  ON 5
ci_0007                -3.135233e-02 3 1  ON 6
ci_0008                -3.179871e-02 3 1  ON 7
ci_0009                -3.179721e-02 3 1  ON 8
ci_0010                -3.108052e-02 3 1  ON 9
ci_0011                -2.743009e-02 3 1  ON 10
ci_0012                -2.642048e-02 3 1  ON 11
ci_0013                 2.804438e-02 3 1  ON 12
ci_0014                 2.704338e-02 3 1  ON 13
ci_0015                 2.717311e-02 3 1  ON 14
ci_0016                 2.617729e-02 3 1  ON 15
ci_0017                 2.408290e-02 3 1  ON 16
ci_0018                 2.307430e-02 3 1  ON 17
ci_0019                 2.015933e-02 3 1  ON 18
ci_0020                 1.835413e-02 3 1  ON 19
ci_0021                 1.882047e-02 3 1  ON 20
ci_0022                 1.796791e-02 3 1  ON 21
ci_0023                -1.944672e-02 3 1  ON 22
ci_0024                -1.796860e-02 3 1  ON 23
ci_0025                -1.882113e-02 3 1  ON 24
ci_0026                -1.842196e-02 3 1  ON 25
ci_0027                -1.883514e-02 3 1  ON 26
ci_0028                -1.691907e-02 3 1  ON 27
ci_0029                -1.585817e-02 3 1  ON 28
ci_0030                -1.622441e-02 3 1  ON 29
ci_0031                 1.494004e-02 3 1  ON 30
ci_0032                 1.536256e-02 3 1  ON 31
ci_0033                 1.720849e-02 3 1  ON 32
ci_0034                 1.523161e-02 3 1  ON 33
ci_0035                 1.843181e-02 3 1  ON 34
ci_0036                 1.750324e-02 3 1  ON 35
ci_0037                -1.555505e-02 3 1  ON 36
ci_0038                -1.452712e-02 3 1  ON 37
ci_0039                -1.635504e-02 3 1  ON 38
ci_0040                -1.538426e-02 3 1  ON 39
ci_0041                 1.560876e-02 3 1  ON 40
ci_0042                 1.488009e-02 3 1  ON 41
ci_0043                -1.440461e-02 3 1  ON 42
ci_0044                -1.395448e-02 3 1  ON 43
ci_0045                 1.579764e-02 3 1  ON 44
ci_0046                 1.420688e-02 3 1  ON 45
ci_0047                -1.453940e-02 3 1  ON 46
ci_0048                -1.371014e-02 3 1  ON 47
ci_0049                -1.293464e-02 3 1  ON 48
ci_0050                -1.295073e-02 3 1  ON 49
ci_0051                -1.296518e-02 3 1  ON 50
ci_0052                -1.211634e-02 3 1  ON 51
ci_0053                -1.297507e-02 3 1  ON 52
ci_0054                -1.218886e-02 3 1  ON 53
ci_0055                 1.282553e-02 3 1  ON 54
ci_0056                 1.284311e-02 3 1  ON 55
ci_0057                 1.251146e-02 3 1  ON 56
ci_0058                 1.243323e-02 3 1  ON 57
ci_0059                -1.303108e-02 3 1  ON 58
ci_0060                -1.275839e-02 3 1  ON 59
ci_0061                -1.327402e-02 3 1  ON 60
ci_0062                -1.219020e-02 3 1  ON 61
ci_0063                -1.195149e-02 3 1  ON 62
ci_0064                -1.127423e-02 3 1  ON 63
ci_0065                -1.176663e-02 3 1  ON 64
ci_0066                -1.212680e-02 3 1  ON 65
ci_0067                -1.134255e-02 3 1  ON 66
ci_0068                -1.062864e-02 3 1  ON 67
ci_0069                 1.111526e-02 3 1  ON 68
ci_0070                 1.013371e-02 3 1  ON 69
ci_0071                 9.297634e-03 3 1  ON 70
ci_0072                 9.812495e-03 3 1  ON 71
ci_0073                 1.140368e-02 3 1  ON 72
ci_0074                 1.102141e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.7197
    reference variance = 2.24454
====================================================
  Execution time = 1.2728e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5388e+00
  Total weights = 1.9455e+06
  Execution time = 2.2052e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.565045490543
                                         uncertainty =       0.028372910707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.565045490543
                                         uncertainty =       0.028372910707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132423627
  error estimate for blocks of size 2^( 2) =       0.001170974831
  error estimate for blocks of size 2^( 3) =       0.001203500417
  error estimate for blocks of size 2^( 4) =       0.001226549993
  error estimate for blocks of size 2^( 5) =       0.001241882296
  error estimate for blocks of size 2^( 6) =       0.001247679530
  error estimate for blocks of size 2^( 7) =       0.001255698023

      target function =                  N/A
              le_mean =     -16.716424762154
             les_mean =     282.014069675100
             stat err =       0.001242952460
             autocorr =       1.204734070006
              std dev =       1.601514475934
             le_variance =       2.564848616627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564737519363
                                         uncertainty =       0.028389343578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564737519363
                                         uncertainty =       0.028389343578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132355965
  error estimate for blocks of size 2^( 2) =       0.001170924639
  error estimate for blocks of size 2^( 3) =       0.001203449862
  error estimate for blocks of size 2^( 4) =       0.001226526321
  error estimate for blocks of size 2^( 5) =       0.001241936883
  error estimate for blocks of size 2^( 6) =       0.001247663248
  error estimate for blocks of size 2^( 7) =       0.001255652835

      target function =                  N/A
              le_mean =     -16.716366992207
             les_mean =     281.980956586699
             stat err =       0.001242944821
             autocorr =       1.204863240296
              std dev =       1.601418784520
             le_variance =       2.564542123412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.566000568849
                                         uncertainty =       0.028376341085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.566000568849
                                         uncertainty =       0.028376341085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132634536
  error estimate for blocks of size 2^( 2) =       0.001171203289
  error estimate for blocks of size 2^( 3) =       0.001203709158
  error estimate for blocks of size 2^( 4) =       0.001226793282
  error estimate for blocks of size 2^( 5) =       0.001242226542
  error estimate for blocks of size 2^( 6) =       0.001247910924
  error estimate for blocks of size 2^( 7) =       0.001255868816

      target function =                  N/A
              le_mean =     -16.716398918502
             les_mean =     282.066627744139
             stat err =       0.001243199891
             autocorr =       1.204764958063
              std dev =       1.601812749988
             le_variance =       2.565804086024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564619089835
                                         uncertainty =       0.028369806734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564619089835
                                         uncertainty =       0.028369806734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132329655
  error estimate for blocks of size 2^( 2) =       0.001170892395
  error estimate for blocks of size 2^( 3) =       0.001203425019
  error estimate for blocks of size 2^( 4) =       0.001226500715
  error estimate for blocks of size 2^( 5) =       0.001241902410
  error estimate for blocks of size 2^( 6) =       0.001247718504
  error estimate for blocks of size 2^( 7) =       0.001255686053

      target function =                  N/A
              le_mean =     -16.716375487692
             les_mean =     281.985571885341
             stat err =       0.001242951920
             autocorr =       1.204932994179
              std dev =       1.601381576628
             le_variance =       2.564422953963


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716424762154        initial  <--
     3.9062e-02     3.9062e-01             2.8632e-03       -16.716366992207
     1.5625e-01     1.5625e+00             1.8995e-03       -16.716398918502
     6.2500e-01     6.2500e+00             8.1080e-04       -16.716375487692

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9465
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.072052e-01 3 1  ON 0
ci_0002                 6.794774e-01 3 1  ON 1
ci_0003                -4.758849e-02 3 1  ON 2
ci_0004                -4.669034e-02 3 1  ON 3
ci_0005                -4.551357e-02 3 1  ON 4
ci_0006                -4.389446e-02 3 1  ON 5
ci_0007                -3.071753e-02 3 1  ON 6
ci_0008                -3.223399e-02 3 1  ON 7
ci_0009                -3.272681e-02 3 1  ON 8
ci_0010                -3.169088e-02 3 1  ON 9
ci_0011                -2.757877e-02 3 1  ON 10
ci_0012                -2.543109e-02 3 1  ON 11
ci_0013                 2.740586e-02 3 1  ON 12
ci_0014                 2.665567e-02 3 1  ON 13
ci_0015                 2.684394e-02 3 1  ON 14
ci_0016                 2.649144e-02 3 1  ON 15
ci_0017                 2.446489e-02 3 1  ON 16
ci_0018                 2.290879e-02 3 1  ON 17
ci_0019                 2.053177e-02 3 1  ON 18
ci_0020                 1.836231e-02 3 1  ON 19
ci_0021                 1.871092e-02 3 1  ON 20
ci_0022                 1.945607e-02 3 1  ON 21
ci_0023                -1.963027e-02 3 1  ON 22
ci_0024                -1.781846e-02 3 1  ON 23
ci_0025                -1.834512e-02 3 1  ON 24
ci_0026                -1.742011e-02 3 1  ON 25
ci_0027                -1.851989e-02 3 1  ON 26
ci_0028                -1.726523e-02 3 1  ON 27
ci_0029                -1.608988e-02 3 1  ON 28
ci_0030                -1.679866e-02 3 1  ON 29
ci_0031                 1.631173e-02 3 1  ON 30
ci_0032                 1.403408e-02 3 1  ON 31
ci_0033                 1.632294e-02 3 1  ON 32
ci_0034                 1.549247e-02 3 1  ON 33
ci_0035                 1.827611e-02 3 1  ON 34
ci_0036                 1.690832e-02 3 1  ON 35
ci_0037                -1.505121e-02 3 1  ON 36
ci_0038                -1.480040e-02 3 1  ON 37
ci_0039                -1.632541e-02 3 1  ON 38
ci_0040                -1.563386e-02 3 1  ON 39
ci_0041                 1.567238e-02 3 1  ON 40
ci_0042                 1.523257e-02 3 1  ON 41
ci_0043                -1.567495e-02 3 1  ON 42
ci_0044                -1.427440e-02 3 1  ON 43
ci_0045                 1.503012e-02 3 1  ON 44
ci_0046                 1.457699e-02 3 1  ON 45
ci_0047                -1.482390e-02 3 1  ON 46
ci_0048                -1.367400e-02 3 1  ON 47
ci_0049                -1.381265e-02 3 1  ON 48
ci_0050                -1.290685e-02 3 1  ON 49
ci_0051                -1.296513e-02 3 1  ON 50
ci_0052                -1.227697e-02 3 1  ON 51
ci_0053                -1.328544e-02 3 1  ON 52
ci_0054                -1.191089e-02 3 1  ON 53
ci_0055                 1.340737e-02 3 1  ON 54
ci_0056                 1.335391e-02 3 1  ON 55
ci_0057                 1.275702e-02 3 1  ON 56
ci_0058                 1.253475e-02 3 1  ON 57
ci_0059                -1.336531e-02 3 1  ON 58
ci_0060                -1.283573e-02 3 1  ON 59
ci_0061                -1.378693e-02 3 1  ON 60
ci_0062                -1.234819e-02 3 1  ON 61
ci_0063                -1.220005e-02 3 1  ON 62
ci_0064                -1.098396e-02 3 1  ON 63
ci_0065                -1.198710e-02 3 1  ON 64
ci_0066                -1.129386e-02 3 1  ON 65
ci_0067                -1.071777e-02 3 1  ON 66
ci_0068                -1.042237e-02 3 1  ON 67
ci_0069                 1.095053e-02 3 1  ON 68
ci_0070                 1.035922e-02 3 1  ON 69
ci_0071                 9.540687e-03 3 1  ON 70
ci_0072                 1.002403e-02 3 1  ON 71
ci_0073                 1.139114e-02 3 1  ON 72
ci_0074                 1.115127e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0222e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.89
    reference variance = 1.485
====================================================
  Execution time = 1.3037e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0265e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5472e+00
  Total weights = 1.945616134e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1939e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574645099921
                                         uncertainty =       0.033222180287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574645099921
                                         uncertainty =       0.033222180287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134503787
  error estimate for blocks of size 2^( 2) =       0.001172800664
  error estimate for blocks of size 2^( 3) =       0.001205213916
  error estimate for blocks of size 2^( 4) =       0.001229009109
  error estimate for blocks of size 2^( 5) =       0.001245064467
  error estimate for blocks of size 2^( 6) =       0.001250826482
  error estimate for blocks of size 2^( 7) =       0.001255186884

      target function =                  N/A
              le_mean =     -16.719157883471
             les_mean =     282.077428322054
             stat err =       0.001245021736
             autocorr =       1.204320189752
              std dev =       1.604456312845
             le_variance =       2.574280059830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671915788347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719157882532       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719196768583       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719198445833       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719198468673       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 8.967776e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719157882532       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719171614949       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719171700675       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 2.881611e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719157882532       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719161710464       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719161698515       residual = 4.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 8.414776e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6237e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.072469e-01 3 1  ON 0
ci_0002                 6.794187e-01 3 1  ON 1
ci_0003                -4.767350e-02 3 1  ON 2
ci_0004                -4.673010e-02 3 1  ON 3
ci_0005                -4.563986e-02 3 1  ON 4
ci_0006                -4.395122e-02 3 1  ON 5
ci_0007                -3.070539e-02 3 1  ON 6
ci_0008                -3.216457e-02 3 1  ON 7
ci_0009                -3.262831e-02 3 1  ON 8
ci_0010                -3.153897e-02 3 1  ON 9
ci_0011                -2.760195e-02 3 1  ON 10
ci_0012                -2.557105e-02 3 1  ON 11
ci_0013                 2.734432e-02 3 1  ON 12
ci_0014                 2.666936e-02 3 1  ON 13
ci_0015                 2.690650e-02 3 1  ON 14
ci_0016                 2.647241e-02 3 1  ON 15
ci_0017                 2.452353e-02 3 1  ON 16
ci_0018                 2.292764e-02 3 1  ON 17
ci_0019                 2.056651e-02 3 1  ON 18
ci_0020                 1.854408e-02 3 1  ON 19
ci_0021                 1.850925e-02 3 1  ON 20
ci_0022                 1.924553e-02 3 1  ON 21
ci_0023                -1.972247e-02 3 1  ON 22
ci_0024                -1.803670e-02 3 1  ON 23
ci_0025                -1.832692e-02 3 1  ON 24
ci_0026                -1.740328e-02 3 1  ON 25
ci_0027                -1.835591e-02 3 1  ON 26
ci_0028                -1.716641e-02 3 1  ON 27
ci_0029                -1.632339e-02 3 1  ON 28
ci_0030                -1.676972e-02 3 1  ON 29
ci_0031                 1.630774e-02 3 1  ON 30
ci_0032                 1.394407e-02 3 1  ON 31
ci_0033                 1.632312e-02 3 1  ON 32
ci_0034                 1.548103e-02 3 1  ON 33
ci_0035                 1.821280e-02 3 1  ON 34
ci_0036                 1.693099e-02 3 1  ON 35
ci_0037                -1.520195e-02 3 1  ON 36
ci_0038                -1.466273e-02 3 1  ON 37
ci_0039                -1.629422e-02 3 1  ON 38
ci_0040                -1.555623e-02 3 1  ON 39
ci_0041                 1.569540e-02 3 1  ON 40
ci_0042                 1.530692e-02 3 1  ON 41
ci_0043                -1.594562e-02 3 1  ON 42
ci_0044                -1.432944e-02 3 1  ON 43
ci_0045                 1.512439e-02 3 1  ON 44
ci_0046                 1.452547e-02 3 1  ON 45
ci_0047                -1.467766e-02 3 1  ON 46
ci_0048                -1.374713e-02 3 1  ON 47
ci_0049                -1.378596e-02 3 1  ON 48
ci_0050                -1.293122e-02 3 1  ON 49
ci_0051                -1.325330e-02 3 1  ON 50
ci_0052                -1.218681e-02 3 1  ON 51
ci_0053                -1.316472e-02 3 1  ON 52
ci_0054                -1.212866e-02 3 1  ON 53
ci_0055                 1.346522e-02 3 1  ON 54
ci_0056                 1.327858e-02 3 1  ON 55
ci_0057                 1.272385e-02 3 1  ON 56
ci_0058                 1.261765e-02 3 1  ON 57
ci_0059                -1.321428e-02 3 1  ON 58
ci_0060                -1.291109e-02 3 1  ON 59
ci_0061                -1.356778e-02 3 1  ON 60
ci_0062                -1.228569e-02 3 1  ON 61
ci_0063                -1.205742e-02 3 1  ON 62
ci_0064                -1.092439e-02 3 1  ON 63
ci_0065                -1.201125e-02 3 1  ON 64
ci_0066                -1.144049e-02 3 1  ON 65
ci_0067                -1.081042e-02 3 1  ON 66
ci_0068                -1.045528e-02 3 1  ON 67
ci_0069                 1.095691e-02 3 1  ON 68
ci_0070                 1.049463e-02 3 1  ON 69
ci_0071                 9.653942e-03 3 1  ON 70
ci_0072                 9.954610e-03 3 1  ON 71
ci_0073                 1.122809e-02 3 1  ON 72
ci_0074                 1.105997e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.5244
    reference variance = 1.90302
====================================================
  Execution time = 1.2742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5184e+00
  Total weights = 1.9460e+06
  Execution time = 2.2153e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545622477805
                                         uncertainty =       0.042523073622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545622477805
                                         uncertainty =       0.042523073622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128295267
  error estimate for blocks of size 2^( 2) =       0.001167083874
  error estimate for blocks of size 2^( 3) =       0.001200160794
  error estimate for blocks of size 2^( 4) =       0.001222550054
  error estimate for blocks of size 2^( 5) =       0.001237393256
  error estimate for blocks of size 2^( 6) =       0.001249520989
  error estimate for blocks of size 2^( 7) =       0.001248949404

      target function =                  N/A
              le_mean =     -16.719302469136
             les_mean =     282.227516447235
             stat err =       0.001239603426
             autocorr =       1.207035388111
              std dev =       1.595675998865
             le_variance =       2.546181893355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545810857022
                                         uncertainty =       0.042531278733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545810857022
                                         uncertainty =       0.042531278733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128336860
  error estimate for blocks of size 2^( 2) =       0.001167108366
  error estimate for blocks of size 2^( 3) =       0.001200139751
  error estimate for blocks of size 2^( 4) =       0.001222503539
  error estimate for blocks of size 2^( 5) =       0.001237325913
  error estimate for blocks of size 2^( 6) =       0.001249465098
  error estimate for blocks of size 2^( 7) =       0.001248895962

      target function =                  N/A
              le_mean =     -16.719304145689
             les_mean =     282.055020335679
             stat err =       0.001239547628
             autocorr =       1.206837747258
              std dev =       1.595734821929
             le_variance =       2.546369621917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545937207825
                                         uncertainty =       0.042519388692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545937207825
                                         uncertainty =       0.042519388692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128364922
  error estimate for blocks of size 2^( 2) =       0.001167141258
  error estimate for blocks of size 2^( 3) =       0.001200185313
  error estimate for blocks of size 2^( 4) =       0.001222564361
  error estimate for blocks of size 2^( 5) =       0.001237388028
  error estimate for blocks of size 2^( 6) =       0.001249579349
  error estimate for blocks of size 2^( 7) =       0.001248993945

      target function =                  N/A
              le_mean =     -16.719291660280
             les_mean =     283.364253332617
             stat err =       0.001239631421
             autocorr =       1.206940882360
              std dev =       1.595774507618
             le_variance =       2.546496279163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545611884082
                                         uncertainty =       0.042522720264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545611884082
                                         uncertainty =       0.042522720264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128292903
  error estimate for blocks of size 2^( 2) =       0.001167082094
  error estimate for blocks of size 2^( 3) =       0.001200148210
  error estimate for blocks of size 2^( 4) =       0.001222537756
  error estimate for blocks of size 2^( 5) =       0.001237379554
  error estimate for blocks of size 2^( 6) =       0.001249508565
  error estimate for blocks of size 2^( 7) =       0.001248931986

      target function =                  N/A
              le_mean =     -16.719300240271
             les_mean =     282.053615070033
             stat err =       0.001239589465
             autocorr =       1.207013259210
              std dev =       1.595672655328
             le_variance =       2.546171222962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719302469136        initial
     3.9062e-01     3.9062e+00             8.9678e-04       -16.719304145689  <--
     1.5625e+00     1.5625e+01             2.8816e-04       -16.719291660280
     6.2500e+00     6.2500e+01             8.4148e-05       -16.719300240271

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.4007e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.073775e-01 3 1  ON 0
ci_0002                 6.792615e-01 3 1  ON 1
ci_0003                -4.783775e-02 3 1  ON 2
ci_0004                -4.681115e-02 3 1  ON 3
ci_0005                -4.591052e-02 3 1  ON 4
ci_0006                -4.405379e-02 3 1  ON 5
ci_0007                -3.067806e-02 3 1  ON 6
ci_0008                -3.198776e-02 3 1  ON 7
ci_0009                -3.244553e-02 3 1  ON 8
ci_0010                -3.126169e-02 3 1  ON 9
ci_0011                -2.762307e-02 3 1  ON 10
ci_0012                -2.581303e-02 3 1  ON 11
ci_0013                 2.722278e-02 3 1  ON 12
ci_0014                 2.668831e-02 3 1  ON 13
ci_0015                 2.702079e-02 3 1  ON 14
ci_0016                 2.643057e-02 3 1  ON 15
ci_0017                 2.461897e-02 3 1  ON 16
ci_0018                 2.294965e-02 3 1  ON 17
ci_0019                 2.061881e-02 3 1  ON 18
ci_0020                 1.887852e-02 3 1  ON 19
ci_0021                 1.804895e-02 3 1  ON 20
ci_0022                 1.874199e-02 3 1  ON 21
ci_0023                -1.990016e-02 3 1  ON 22
ci_0024                -1.842997e-02 3 1  ON 23
ci_0025                -1.829530e-02 3 1  ON 24
ci_0026                -1.736448e-02 3 1  ON 25
ci_0027                -1.804571e-02 3 1  ON 26
ci_0028                -1.696106e-02 3 1  ON 27
ci_0029                -1.677913e-02 3 1  ON 28
ci_0030                -1.670825e-02 3 1  ON 29
ci_0031                 1.629083e-02 3 1  ON 30
ci_0032                 1.373728e-02 3 1  ON 31
ci_0033                 1.632417e-02 3 1  ON 32
ci_0034                 1.545590e-02 3 1  ON 33
ci_0035                 1.809010e-02 3 1  ON 34
ci_0036                 1.697124e-02 3 1  ON 35
ci_0037                -1.552935e-02 3 1  ON 36
ci_0038                -1.437182e-02 3 1  ON 37
ci_0039                -1.624559e-02 3 1  ON 38
ci_0040                -1.543458e-02 3 1  ON 39
ci_0041                 1.574110e-02 3 1  ON 40
ci_0042                 1.543844e-02 3 1  ON 41
ci_0043                -1.657173e-02 3 1  ON 42
ci_0044                -1.443601e-02 3 1  ON 43
ci_0045                 1.532021e-02 3 1  ON 44
ci_0046                 1.440465e-02 3 1  ON 45
ci_0047                -1.444709e-02 3 1  ON 46
ci_0048                -1.386289e-02 3 1  ON 47
ci_0049                -1.373633e-02 3 1  ON 48
ci_0050                -1.297051e-02 3 1  ON 49
ci_0051                -1.370027e-02 3 1  ON 50
ci_0052                -1.204120e-02 3 1  ON 51
ci_0053                -1.297790e-02 3 1  ON 52
ci_0054                -1.247531e-02 3 1  ON 53
ci_0055                 1.359319e-02 3 1  ON 54
ci_0056                 1.312340e-02 3 1  ON 55
ci_0057                 1.265844e-02 3 1  ON 56
ci_0058                 1.278218e-02 3 1  ON 57
ci_0059                -1.296443e-02 3 1  ON 58
ci_0060                -1.303201e-02 3 1  ON 59
ci_0061                -1.314623e-02 3 1  ON 60
ci_0062                -1.216346e-02 3 1  ON 61
ci_0063                -1.180328e-02 3 1  ON 62
ci_0064                -1.082735e-02 3 1  ON 63
ci_0065                -1.205684e-02 3 1  ON 64
ci_0066                -1.169908e-02 3 1  ON 65
ci_0067                -1.096444e-02 3 1  ON 66
ci_0068                -1.049580e-02 3 1  ON 67
ci_0069                 1.097426e-02 3 1  ON 68
ci_0070                 1.070273e-02 3 1  ON 69
ci_0071                 9.872505e-03 3 1  ON 70
ci_0072                 9.839214e-03 3 1  ON 71
ci_0073                 1.096800e-02 3 1  ON 72
ci_0074                 1.092039e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.0099
    reference variance = 0.990099
====================================================
  Execution time = 1.2987e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0283e+04
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5079e+00
  Total weights = 1.945788435e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2039e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533544284791
                                         uncertainty =       0.034730830046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533544284791
                                         uncertainty =       0.034730830046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125504224
  error estimate for blocks of size 2^( 2) =       0.001164819202
  error estimate for blocks of size 2^( 3) =       0.001196255831
  error estimate for blocks of size 2^( 4) =       0.001219287877
  error estimate for blocks of size 2^( 5) =       0.001231932041
  error estimate for blocks of size 2^( 6) =       0.001233236467
  error estimate for blocks of size 2^( 7) =       0.001234875609

      target function =                  N/A
              le_mean =     -16.715746739715
             les_mean =     281.924114125404
             stat err =       0.001229832998
             autocorr =       1.193982675039
              std dev =       1.591728804813
             le_variance =       2.533600588070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671574673971e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715746738778       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715819199424       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715825694357       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.715826400890       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.715826105559       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-02 is 1.436062e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715746738778       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715785983510       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715787502584       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.715787549031       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 7.084903e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715746738778       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715760588494       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715760853939       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 2.565965e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070107 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6198e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.074042e-01 3 1  ON 0
ci_0002                 6.792774e-01 3 1  ON 1
ci_0003                -4.780056e-02 3 1  ON 2
ci_0004                -4.689210e-02 3 1  ON 3
ci_0005                -4.593395e-02 3 1  ON 4
ci_0006                -4.365312e-02 3 1  ON 5
ci_0007                -3.031670e-02 3 1  ON 6
ci_0008                -3.186165e-02 3 1  ON 7
ci_0009                -3.254089e-02 3 1  ON 8
ci_0010                -3.153421e-02 3 1  ON 9
ci_0011                -2.738998e-02 3 1  ON 10
ci_0012                -2.596585e-02 3 1  ON 11
ci_0013                 2.727993e-02 3 1  ON 12
ci_0014                 2.638813e-02 3 1  ON 13
ci_0015                 2.695249e-02 3 1  ON 14
ci_0016                 2.640222e-02 3 1  ON 15
ci_0017                 2.463520e-02 3 1  ON 16
ci_0018                 2.314730e-02 3 1  ON 17
ci_0019                 2.036149e-02 3 1  ON 18
ci_0020                 1.897578e-02 3 1  ON 19
ci_0021                 1.844072e-02 3 1  ON 20
ci_0022                 1.824089e-02 3 1  ON 21
ci_0023                -1.967138e-02 3 1  ON 22
ci_0024                -1.819468e-02 3 1  ON 23
ci_0025                -1.867465e-02 3 1  ON 24
ci_0026                -1.798008e-02 3 1  ON 25
ci_0027                -1.793023e-02 3 1  ON 26
ci_0028                -1.699266e-02 3 1  ON 27
ci_0029                -1.680496e-02 3 1  ON 28
ci_0030                -1.629787e-02 3 1  ON 29
ci_0031                 1.565936e-02 3 1  ON 30
ci_0032                 1.356721e-02 3 1  ON 31
ci_0033                 1.692962e-02 3 1  ON 32
ci_0034                 1.491194e-02 3 1  ON 33
ci_0035                 1.776203e-02 3 1  ON 34
ci_0036                 1.632341e-02 3 1  ON 35
ci_0037                -1.562153e-02 3 1  ON 36
ci_0038                -1.462279e-02 3 1  ON 37
ci_0039                -1.624103e-02 3 1  ON 38
ci_0040                -1.545901e-02 3 1  ON 39
ci_0041                 1.606988e-02 3 1  ON 40
ci_0042                 1.554860e-02 3 1  ON 41
ci_0043                -1.651532e-02 3 1  ON 42
ci_0044                -1.461374e-02 3 1  ON 43
ci_0045                 1.536966e-02 3 1  ON 44
ci_0046                 1.475052e-02 3 1  ON 45
ci_0047                -1.453090e-02 3 1  ON 46
ci_0048                -1.370918e-02 3 1  ON 47
ci_0049                -1.302784e-02 3 1  ON 48
ci_0050                -1.240508e-02 3 1  ON 49
ci_0051                -1.334824e-02 3 1  ON 50
ci_0052                -1.255189e-02 3 1  ON 51
ci_0053                -1.317527e-02 3 1  ON 52
ci_0054                -1.286793e-02 3 1  ON 53
ci_0055                 1.320752e-02 3 1  ON 54
ci_0056                 1.295979e-02 3 1  ON 55
ci_0057                 1.322071e-02 3 1  ON 56
ci_0058                 1.281554e-02 3 1  ON 57
ci_0059                -1.312890e-02 3 1  ON 58
ci_0060                -1.295987e-02 3 1  ON 59
ci_0061                -1.354671e-02 3 1  ON 60
ci_0062                -1.223868e-02 3 1  ON 61
ci_0063                -1.171462e-02 3 1  ON 62
ci_0064                -1.093184e-02 3 1  ON 63
ci_0065                -1.222095e-02 3 1  ON 64
ci_0066                -1.156812e-02 3 1  ON 65
ci_0067                -1.120323e-02 3 1  ON 66
ci_0068                -1.050807e-02 3 1  ON 67
ci_0069                 1.122472e-02 3 1  ON 68
ci_0070                 1.045502e-02 3 1  ON 69
ci_0071                 1.014395e-02 3 1  ON 70
ci_0072                 1.051864e-02 3 1  ON 71
ci_0073                 1.085432e-02 3 1  ON 72
ci_0074                 1.080393e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.6749
    reference variance = 2.01554
====================================================
  Execution time = 1.2751e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5842e+00
  Total weights = 1.9454e+06
  Execution time = 2.2033e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00413619
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.611586603300
                                         uncertainty =       0.045930779257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.611586603300
                                         uncertainty =       0.045930779257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142705018
  error estimate for blocks of size 2^( 2) =       0.001181146792
  error estimate for blocks of size 2^( 3) =       0.001213258253
  error estimate for blocks of size 2^( 4) =       0.001233835229
  error estimate for blocks of size 2^( 5) =       0.001248323011
  error estimate for blocks of size 2^( 6) =       0.001253176489
  error estimate for blocks of size 2^( 7) =       0.001258952593

      target function =                  N/A
              le_mean =     -16.716886025477
             les_mean =     282.040588915373
             stat err =       0.001248571831
             autocorr =       1.193874829765
              std dev =       1.616054790001
             le_variance =       2.611633084284

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0026282
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.611850946119
                                         uncertainty =       0.045916075381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.611850946119
                                         uncertainty =       0.045916075381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142764466
  error estimate for blocks of size 2^( 2) =       0.001181225648
  error estimate for blocks of size 2^( 3) =       0.001213374325
  error estimate for blocks of size 2^( 4) =       0.001233970584
  error estimate for blocks of size 2^( 5) =       0.001248509725
  error estimate for blocks of size 2^( 6) =       0.001253393399
  error estimate for blocks of size 2^( 7) =       0.001259187461

      target function =                  N/A
              le_mean =     -16.716862483820
             les_mean =     282.041121517135
             stat err =       0.001248765292
             autocorr =       1.194120581457
              std dev =       1.616138863829
             le_variance =       2.611904827180

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00407807
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.611959527214
                                         uncertainty =       0.045917008018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.611959527214
                                         uncertainty =       0.045917008018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142788398
  error estimate for blocks of size 2^( 2) =       0.001181252070
  error estimate for blocks of size 2^( 3) =       0.001213404281
  error estimate for blocks of size 2^( 4) =       0.001234000355
  error estimate for blocks of size 2^( 5) =       0.001248542572
  error estimate for blocks of size 2^( 6) =       0.001253432497
  error estimate for blocks of size 2^( 7) =       0.001259232644

      target function =                  N/A
              le_mean =     -16.716864363178
             les_mean =     282.040989685817
             stat err =       0.001248802017
             autocorr =       1.194140802972
              std dev =       1.616172708923
             le_variance =       2.612014225067

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0175353
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.611580313736
                                         uncertainty =       0.045928181174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.611580313736
                                         uncertainty =       0.045928181174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142703796
  error estimate for blocks of size 2^( 2) =       0.001181149873
  error estimate for blocks of size 2^( 3) =       0.001213268699
  error estimate for blocks of size 2^( 4) =       0.001233849808
  error estimate for blocks of size 2^( 5) =       0.001248348084
  error estimate for blocks of size 2^( 6) =       0.001253209174
  error estimate for blocks of size 2^( 7) =       0.001258992326

      target function =                  N/A
              le_mean =     -16.716876151520
             les_mean =     282.038821638473
             stat err =       0.001248599848
             autocorr =       1.193930963558
              std dev =       1.616053062288
             le_variance =       2.611627500131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716886025477        initial  <--
     9.7656e-02     9.7656e-01             1.4361e-03       -16.716862483820
     3.9062e-01     3.9062e+00             7.0849e-04       -16.716864363178
     1.5625e+00     1.5625e+01             2.5660e-04       -16.716876151520

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9893
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.073775e-01 3 1  ON 0
ci_0002                 6.792615e-01 3 1  ON 1
ci_0003                -4.783775e-02 3 1  ON 2
ci_0004                -4.681115e-02 3 1  ON 3
ci_0005                -4.591052e-02 3 1  ON 4
ci_0006                -4.405379e-02 3 1  ON 5
ci_0007                -3.067806e-02 3 1  ON 6
ci_0008                -3.198776e-02 3 1  ON 7
ci_0009                -3.244553e-02 3 1  ON 8
ci_0010                -3.126169e-02 3 1  ON 9
ci_0011                -2.762307e-02 3 1  ON 10
ci_0012                -2.581303e-02 3 1  ON 11
ci_0013                 2.722278e-02 3 1  ON 12
ci_0014                 2.668831e-02 3 1  ON 13
ci_0015                 2.702079e-02 3 1  ON 14
ci_0016                 2.643057e-02 3 1  ON 15
ci_0017                 2.461897e-02 3 1  ON 16
ci_0018                 2.294965e-02 3 1  ON 17
ci_0019                 2.061881e-02 3 1  ON 18
ci_0020                 1.887852e-02 3 1  ON 19
ci_0021                 1.804895e-02 3 1  ON 20
ci_0022                 1.874199e-02 3 1  ON 21
ci_0023                -1.990016e-02 3 1  ON 22
ci_0024                -1.842997e-02 3 1  ON 23
ci_0025                -1.829530e-02 3 1  ON 24
ci_0026                -1.736448e-02 3 1  ON 25
ci_0027                -1.804571e-02 3 1  ON 26
ci_0028                -1.696106e-02 3 1  ON 27
ci_0029                -1.677913e-02 3 1  ON 28
ci_0030                -1.670825e-02 3 1  ON 29
ci_0031                 1.629083e-02 3 1  ON 30
ci_0032                 1.373728e-02 3 1  ON 31
ci_0033                 1.632417e-02 3 1  ON 32
ci_0034                 1.545590e-02 3 1  ON 33
ci_0035                 1.809010e-02 3 1  ON 34
ci_0036                 1.697124e-02 3 1  ON 35
ci_0037                -1.552935e-02 3 1  ON 36
ci_0038                -1.437182e-02 3 1  ON 37
ci_0039                -1.624559e-02 3 1  ON 38
ci_0040                -1.543458e-02 3 1  ON 39
ci_0041                 1.574110e-02 3 1  ON 40
ci_0042                 1.543844e-02 3 1  ON 41
ci_0043                -1.657173e-02 3 1  ON 42
ci_0044                -1.443601e-02 3 1  ON 43
ci_0045                 1.532021e-02 3 1  ON 44
ci_0046                 1.440465e-02 3 1  ON 45
ci_0047                -1.444709e-02 3 1  ON 46
ci_0048                -1.386289e-02 3 1  ON 47
ci_0049                -1.373633e-02 3 1  ON 48
ci_0050                -1.297051e-02 3 1  ON 49
ci_0051                -1.370027e-02 3 1  ON 50
ci_0052                -1.204120e-02 3 1  ON 51
ci_0053                -1.297790e-02 3 1  ON 52
ci_0054                -1.247531e-02 3 1  ON 53
ci_0055                 1.359319e-02 3 1  ON 54
ci_0056                 1.312340e-02 3 1  ON 55
ci_0057                 1.265844e-02 3 1  ON 56
ci_0058                 1.278218e-02 3 1  ON 57
ci_0059                -1.296443e-02 3 1  ON 58
ci_0060                -1.303201e-02 3 1  ON 59
ci_0061                -1.314623e-02 3 1  ON 60
ci_0062                -1.216346e-02 3 1  ON 61
ci_0063                -1.180328e-02 3 1  ON 62
ci_0064                -1.082735e-02 3 1  ON 63
ci_0065                -1.205684e-02 3 1  ON 64
ci_0066                -1.169908e-02 3 1  ON 65
ci_0067                -1.096444e-02 3 1  ON 66
ci_0068                -1.049580e-02 3 1  ON 67
ci_0069                 1.097426e-02 3 1  ON 68
ci_0070                 1.070273e-02 3 1  ON 69
ci_0071                 9.872505e-03 3 1  ON 70
ci_0072                 9.839214e-03 3 1  ON 71
ci_0073                 1.096800e-02 3 1  ON 72
ci_0074                 1.092039e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0197e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6684e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.7908
    reference variance = 2.66134
====================================================
  Execution time = 1.2967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0303e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5432e+00
  Total weights = 1.945428428e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2157e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.566214303740
                                         uncertainty =       0.031690173811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.566214303740
                                         uncertainty =       0.031690173811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132626510
  error estimate for blocks of size 2^( 2) =       0.001171183260
  error estimate for blocks of size 2^( 3) =       0.001204430409
  error estimate for blocks of size 2^( 4) =       0.001228326660
  error estimate for blocks of size 2^( 5) =       0.001242114107
  error estimate for blocks of size 2^( 6) =       0.001249700187
  error estimate for blocks of size 2^( 7) =       0.001252058744

      target function =                  N/A
              le_mean =     -16.719005187060
             les_mean =     282.068310860225
             stat err =       0.001243049924
             autocorr =       1.204491385789
              std dev =       1.601801399402
             le_variance =       2.565767723125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671900518706e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719005186106       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719025533731       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719025789655       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719025769511       residual = 1.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 3.714859e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719005186106       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719011105923       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719011122115       residual = 4.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.038233e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719005186106       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719006729226       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719006730461       residual = 2.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 2.706562e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073477 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6193e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.074123e-01 3 1  ON 0
ci_0002                 6.792113e-01 3 1  ON 1
ci_0003                -4.788922e-02 3 1  ON 2
ci_0004                -4.682423e-02 3 1  ON 3
ci_0005                -4.589445e-02 3 1  ON 4
ci_0006                -4.403314e-02 3 1  ON 5
ci_0007                -3.073780e-02 3 1  ON 6
ci_0008                -3.194788e-02 3 1  ON 7
ci_0009                -3.246255e-02 3 1  ON 8
ci_0010                -3.123858e-02 3 1  ON 9
ci_0011                -2.762817e-02 3 1  ON 10
ci_0012                -2.588435e-02 3 1  ON 11
ci_0013                 2.731800e-02 3 1  ON 12
ci_0014                 2.664986e-02 3 1  ON 13
ci_0015                 2.705501e-02 3 1  ON 14
ci_0016                 2.641830e-02 3 1  ON 15
ci_0017                 2.465044e-02 3 1  ON 16
ci_0018                 2.301567e-02 3 1  ON 17
ci_0019                 2.057374e-02 3 1  ON 18
ci_0020                 1.895767e-02 3 1  ON 19
ci_0021                 1.808211e-02 3 1  ON 20
ci_0022                 1.866563e-02 3 1  ON 21
ci_0023                -1.989810e-02 3 1  ON 22
ci_0024                -1.845799e-02 3 1  ON 23
ci_0025                -1.827942e-02 3 1  ON 24
ci_0026                -1.740843e-02 3 1  ON 25
ci_0027                -1.801421e-02 3 1  ON 26
ci_0028                -1.694543e-02 3 1  ON 27
ci_0029                -1.677777e-02 3 1  ON 28
ci_0030                -1.660782e-02 3 1  ON 29
ci_0031                 1.620173e-02 3 1  ON 30
ci_0032                 1.378764e-02 3 1  ON 31
ci_0033                 1.636374e-02 3 1  ON 32
ci_0034                 1.548257e-02 3 1  ON 33
ci_0035                 1.809615e-02 3 1  ON 34
ci_0036                 1.701024e-02 3 1  ON 35
ci_0037                -1.555758e-02 3 1  ON 36
ci_0038                -1.437528e-02 3 1  ON 37
ci_0039                -1.623450e-02 3 1  ON 38
ci_0040                -1.536312e-02 3 1  ON 39
ci_0041                 1.583077e-02 3 1  ON 40
ci_0042                 1.545367e-02 3 1  ON 41
ci_0043                -1.654004e-02 3 1  ON 42
ci_0044                -1.445610e-02 3 1  ON 43
ci_0045                 1.538102e-02 3 1  ON 44
ci_0046                 1.442614e-02 3 1  ON 45
ci_0047                -1.448496e-02 3 1  ON 46
ci_0048                -1.387292e-02 3 1  ON 47
ci_0049                -1.375239e-02 3 1  ON 48
ci_0050                -1.304348e-02 3 1  ON 49
ci_0051                -1.359854e-02 3 1  ON 50
ci_0052                -1.209998e-02 3 1  ON 51
ci_0053                -1.292860e-02 3 1  ON 52
ci_0054                -1.243875e-02 3 1  ON 53
ci_0055                 1.348937e-02 3 1  ON 54
ci_0056                 1.309299e-02 3 1  ON 55
ci_0057                 1.270542e-02 3 1  ON 56
ci_0058                 1.277758e-02 3 1  ON 57
ci_0059                -1.294149e-02 3 1  ON 58
ci_0060                -1.302252e-02 3 1  ON 59
ci_0061                -1.320127e-02 3 1  ON 60
ci_0062                -1.215227e-02 3 1  ON 61
ci_0063                -1.180677e-02 3 1  ON 62
ci_0064                -1.086505e-02 3 1  ON 63
ci_0065                -1.213425e-02 3 1  ON 64
ci_0066                -1.163301e-02 3 1  ON 65
ci_0067                -1.096494e-02 3 1  ON 66
ci_0068                -1.047302e-02 3 1  ON 67
ci_0069                 1.098405e-02 3 1  ON 68
ci_0070                 1.076784e-02 3 1  ON 69
ci_0071                 9.877986e-03 3 1  ON 70
ci_0072                 9.850432e-03 3 1  ON 71
ci_0073                 1.094282e-02 3 1  ON 72
ci_0074                 1.093065e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.7407
    reference variance = 1.31292
====================================================
  Execution time = 1.2669e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5697e+00
  Total weights = 1.9455e+06
  Execution time = 2.2120e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599992558267
                                         uncertainty =       0.040944401835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599992558267
                                         uncertainty =       0.040944401835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140230771
  error estimate for blocks of size 2^( 2) =       0.001178179719
  error estimate for blocks of size 2^( 3) =       0.001209513091
  error estimate for blocks of size 2^( 4) =       0.001231737957
  error estimate for blocks of size 2^( 5) =       0.001244280687
  error estimate for blocks of size 2^( 6) =       0.001251475494
  error estimate for blocks of size 2^( 7) =       0.001256130888

      target function =                  N/A
              le_mean =     -16.717844343302
             les_mean =     282.056350487040
             stat err =       0.001245906257
             autocorr =       1.193947470541
              std dev =       1.612555620252
             le_variance =       2.600335628407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599908328518
                                         uncertainty =       0.040947045134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599908328518
                                         uncertainty =       0.040947045134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140212462
  error estimate for blocks of size 2^( 2) =       0.001178150700
  error estimate for blocks of size 2^( 3) =       0.001209473518
  error estimate for blocks of size 2^( 4) =       0.001231697444
  error estimate for blocks of size 2^( 5) =       0.001244234697
  error estimate for blocks of size 2^( 6) =       0.001251421063
  error estimate for blocks of size 2^( 7) =       0.001256069299

      target function =                  N/A
              le_mean =     -16.717840055382
             les_mean =     282.056141752821
             stat err =       0.001245855626
             autocorr =       1.193888774115
              std dev =       1.612529727367
             le_variance =       2.600252121643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599978992963
                                         uncertainty =       0.040944761431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599978992963
                                         uncertainty =       0.040944761431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140227867
  error estimate for blocks of size 2^( 2) =       0.001178163558
  error estimate for blocks of size 2^( 3) =       0.001209479464
  error estimate for blocks of size 2^( 4) =       0.001231698267
  error estimate for blocks of size 2^( 5) =       0.001244230113
  error estimate for blocks of size 2^( 6) =       0.001251437133
  error estimate for blocks of size 2^( 7) =       0.001256065006

      target function =                  N/A
              le_mean =     -16.717845767863
             les_mean =     283.767278707191
             stat err =       0.001245857630
             autocorr =       1.193860354745
              std dev =       1.612551514093
             le_variance =       2.600322385603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599983328499
                                         uncertainty =       0.040944648166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.599983328499
                                         uncertainty =       0.040944648166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140228759
  error estimate for blocks of size 2^( 2) =       0.001178176888
  error estimate for blocks of size 2^( 3) =       0.001209509464
  error estimate for blocks of size 2^( 4) =       0.001231734331
  error estimate for blocks of size 2^( 5) =       0.001244276649
  error estimate for blocks of size 2^( 6) =       0.001251470722
  error estimate for blocks of size 2^( 7) =       0.001256125550

      target function =                  N/A
              le_mean =     -16.717843706194
             les_mean =     282.056353635844
             stat err =       0.001245901813
             autocorr =       1.193943165958
              std dev =       1.612552776075
             le_variance =       2.600326455627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717844343302        initial
     9.7656e-01     9.7656e+00             3.7149e-04       -16.717840055382
     3.9062e+00     3.9062e+01             1.0382e-04       -16.717845767863  <--
     1.5625e+01     1.5625e+02             2.7066e-05       -16.717843706194

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.3886e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.074123e-01 3 1  ON 0
ci_0002                 6.792113e-01 3 1  ON 1
ci_0003                -4.788922e-02 3 1  ON 2
ci_0004                -4.682423e-02 3 1  ON 3
ci_0005                -4.589445e-02 3 1  ON 4
ci_0006                -4.403314e-02 3 1  ON 5
ci_0007                -3.073780e-02 3 1  ON 6
ci_0008                -3.194788e-02 3 1  ON 7
ci_0009                -3.246255e-02 3 1  ON 8
ci_0010                -3.123858e-02 3 1  ON 9
ci_0011                -2.762817e-02 3 1  ON 10
ci_0012                -2.588435e-02 3 1  ON 11
ci_0013                 2.731800e-02 3 1  ON 12
ci_0014                 2.664986e-02 3 1  ON 13
ci_0015                 2.705501e-02 3 1  ON 14
ci_0016                 2.641830e-02 3 1  ON 15
ci_0017                 2.465044e-02 3 1  ON 16
ci_0018                 2.301567e-02 3 1  ON 17
ci_0019                 2.057374e-02 3 1  ON 18
ci_0020                 1.895767e-02 3 1  ON 19
ci_0021                 1.808211e-02 3 1  ON 20
ci_0022                 1.866563e-02 3 1  ON 21
ci_0023                -1.989810e-02 3 1  ON 22
ci_0024                -1.845799e-02 3 1  ON 23
ci_0025                -1.827942e-02 3 1  ON 24
ci_0026                -1.740843e-02 3 1  ON 25
ci_0027                -1.801421e-02 3 1  ON 26
ci_0028                -1.694543e-02 3 1  ON 27
ci_0029                -1.677777e-02 3 1  ON 28
ci_0030                -1.660782e-02 3 1  ON 29
ci_0031                 1.620173e-02 3 1  ON 30
ci_0032                 1.378764e-02 3 1  ON 31
ci_0033                 1.636374e-02 3 1  ON 32
ci_0034                 1.548257e-02 3 1  ON 33
ci_0035                 1.809615e-02 3 1  ON 34
ci_0036                 1.701024e-02 3 1  ON 35
ci_0037                -1.555758e-02 3 1  ON 36
ci_0038                -1.437528e-02 3 1  ON 37
ci_0039                -1.623450e-02 3 1  ON 38
ci_0040                -1.536312e-02 3 1  ON 39
ci_0041                 1.583077e-02 3 1  ON 40
ci_0042                 1.545367e-02 3 1  ON 41
ci_0043                -1.654004e-02 3 1  ON 42
ci_0044                -1.445610e-02 3 1  ON 43
ci_0045                 1.538102e-02 3 1  ON 44
ci_0046                 1.442614e-02 3 1  ON 45
ci_0047                -1.448496e-02 3 1  ON 46
ci_0048                -1.387292e-02 3 1  ON 47
ci_0049                -1.375239e-02 3 1  ON 48
ci_0050                -1.304348e-02 3 1  ON 49
ci_0051                -1.359854e-02 3 1  ON 50
ci_0052                -1.209998e-02 3 1  ON 51
ci_0053                -1.292860e-02 3 1  ON 52
ci_0054                -1.243875e-02 3 1  ON 53
ci_0055                 1.348937e-02 3 1  ON 54
ci_0056                 1.309299e-02 3 1  ON 55
ci_0057                 1.270542e-02 3 1  ON 56
ci_0058                 1.277758e-02 3 1  ON 57
ci_0059                -1.294149e-02 3 1  ON 58
ci_0060                -1.302252e-02 3 1  ON 59
ci_0061                -1.320127e-02 3 1  ON 60
ci_0062                -1.215227e-02 3 1  ON 61
ci_0063                -1.180677e-02 3 1  ON 62
ci_0064                -1.086505e-02 3 1  ON 63
ci_0065                -1.213425e-02 3 1  ON 64
ci_0066                -1.163301e-02 3 1  ON 65
ci_0067                -1.096494e-02 3 1  ON 66
ci_0068                -1.047302e-02 3 1  ON 67
ci_0069                 1.098405e-02 3 1  ON 68
ci_0070                 1.076784e-02 3 1  ON 69
ci_0071                 9.877986e-03 3 1  ON 70
ci_0072                 9.850432e-03 3 1  ON 71
ci_0073                 1.094282e-02 3 1  ON 72
ci_0074                 1.093065e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6693e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.0938
    reference variance = 0.833133
====================================================
  Execution time = 1.3022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0267e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5380e+00
  Total weights = 1.945707606e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2315e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.566730315955
                                         uncertainty =       0.037263186475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.566730315955
                                         uncertainty =       0.037263186475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133041312
  error estimate for blocks of size 2^( 2) =       0.001171873328
  error estimate for blocks of size 2^( 3) =       0.001206269219
  error estimate for blocks of size 2^( 4) =       0.001227876482
  error estimate for blocks of size 2^( 5) =       0.001244516675
  error estimate for blocks of size 2^( 6) =       0.001250700685
  error estimate for blocks of size 2^( 7) =       0.001253660545

      target function =                  N/A
              le_mean =     -16.718658971978
             les_mean =     282.051573785653
             stat err =       0.001244188597
             autocorr =       1.205815724481
              std dev =       1.602388027870
             le_variance =       2.567647391863


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671865897198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718658971085       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718667645668       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718667784636       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718667805719       residual = 9.06e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 3.867917e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718658971085       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718661487866       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718661526207       residual = 8.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.091349e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718658971085       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718659626587       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718659637121       residual = 4.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 2.822377e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076843 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6264e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.074416e-01 3 1  ON 0
ci_0002                 6.791731e-01 3 1  ON 1
ci_0003                -4.790518e-02 3 1  ON 2
ci_0004                -4.682308e-02 3 1  ON 3
ci_0005                -4.593124e-02 3 1  ON 4
ci_0006                -4.401840e-02 3 1  ON 5
ci_0007                -3.078731e-02 3 1  ON 6
ci_0008                -3.188083e-02 3 1  ON 7
ci_0009                -3.250721e-02 3 1  ON 8
ci_0010                -3.126363e-02 3 1  ON 9
ci_0011                -2.761609e-02 3 1  ON 10
ci_0012                -2.592267e-02 3 1  ON 11
ci_0013                 2.737246e-02 3 1  ON 12
ci_0014                 2.661240e-02 3 1  ON 13
ci_0015                 2.710051e-02 3 1  ON 14
ci_0016                 2.645204e-02 3 1  ON 15
ci_0017                 2.464486e-02 3 1  ON 16
ci_0018                 2.300534e-02 3 1  ON 17
ci_0019                 2.054037e-02 3 1  ON 18
ci_0020                 1.897746e-02 3 1  ON 19
ci_0021                 1.806755e-02 3 1  ON 20
ci_0022                 1.864992e-02 3 1  ON 21
ci_0023                -1.988419e-02 3 1  ON 22
ci_0024                -1.842930e-02 3 1  ON 23
ci_0025                -1.832477e-02 3 1  ON 24
ci_0026                -1.740918e-02 3 1  ON 25
ci_0027                -1.804714e-02 3 1  ON 26
ci_0028                -1.694560e-02 3 1  ON 27
ci_0029                -1.675135e-02 3 1  ON 28
ci_0030                -1.656749e-02 3 1  ON 29
ci_0031                 1.613164e-02 3 1  ON 30
ci_0032                 1.382219e-02 3 1  ON 31
ci_0033                 1.644296e-02 3 1  ON 32
ci_0034                 1.550124e-02 3 1  ON 33
ci_0035                 1.811150e-02 3 1  ON 34
ci_0036                 1.700239e-02 3 1  ON 35
ci_0037                -1.550441e-02 3 1  ON 36
ci_0038                -1.448442e-02 3 1  ON 37
ci_0039                -1.620110e-02 3 1  ON 38
ci_0040                -1.533310e-02 3 1  ON 39
ci_0041                 1.580090e-02 3 1  ON 40
ci_0042                 1.538452e-02 3 1  ON 41
ci_0043                -1.647096e-02 3 1  ON 42
ci_0044                -1.440209e-02 3 1  ON 43
ci_0045                 1.542905e-02 3 1  ON 44
ci_0046                 1.444447e-02 3 1  ON 45
ci_0047                -1.448145e-02 3 1  ON 46
ci_0048                -1.392684e-02 3 1  ON 47
ci_0049                -1.370093e-02 3 1  ON 48
ci_0050                -1.302450e-02 3 1  ON 49
ci_0051                -1.356245e-02 3 1  ON 50
ci_0052                -1.216407e-02 3 1  ON 51
ci_0053                -1.295480e-02 3 1  ON 52
ci_0054                -1.245412e-02 3 1  ON 53
ci_0055                 1.347311e-02 3 1  ON 54
ci_0056                 1.308164e-02 3 1  ON 55
ci_0057                 1.266877e-02 3 1  ON 56
ci_0058                 1.283556e-02 3 1  ON 57
ci_0059                -1.300042e-02 3 1  ON 58
ci_0060                -1.300856e-02 3 1  ON 59
ci_0061                -1.316260e-02 3 1  ON 60
ci_0062                -1.215444e-02 3 1  ON 61
ci_0063                -1.172197e-02 3 1  ON 62
ci_0064                -1.091601e-02 3 1  ON 63
ci_0065                -1.213045e-02 3 1  ON 64
ci_0066                -1.165176e-02 3 1  ON 65
ci_0067                -1.097881e-02 3 1  ON 66
ci_0068                -1.055974e-02 3 1  ON 67
ci_0069                 1.102178e-02 3 1  ON 68
ci_0070                 1.073794e-02 3 1  ON 69
ci_0071                 9.887070e-03 3 1  ON 70
ci_0072                 9.891539e-03 3 1  ON 71
ci_0073                 1.095163e-02 3 1  ON 72
ci_0074                 1.092869e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.5436
    reference variance = 1.57562
====================================================
  Execution time = 1.2737e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6715e+01
  VMC Evar = 2.5396e+00
  Total weights = 1.9460e+06
  Execution time = 2.2172e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568699892353
                                         uncertainty =       0.041755381659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568699892353
                                         uncertainty =       0.041755381659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133262949
  error estimate for blocks of size 2^( 2) =       0.001172000913
  error estimate for blocks of size 2^( 3) =       0.001205477749
  error estimate for blocks of size 2^( 4) =       0.001230071561
  error estimate for blocks of size 2^( 5) =       0.001244604088
  error estimate for blocks of size 2^( 6) =       0.001253659088
  error estimate for blocks of size 2^( 7) =       0.001258957288

      target function =                  N/A
              le_mean =     -16.715484544915
             les_mean =     281.946866847436
             stat err =       0.001246823006
             autocorr =       1.210453844557
              std dev =       1.602701474845
             le_variance =       2.568652017472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568977497905
                                         uncertainty =       0.041755166963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568977497905
                                         uncertainty =       0.041755166963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133324991
  error estimate for blocks of size 2^( 2) =       0.001172057345
  error estimate for blocks of size 2^( 3) =       0.001205528993
  error estimate for blocks of size 2^( 4) =       0.001230126935
  error estimate for blocks of size 2^( 5) =       0.001244663409
  error estimate for blocks of size 2^( 6) =       0.001253725655
  error estimate for blocks of size 2^( 7) =       0.001259063130

      target function =                  N/A
              le_mean =     -16.715484871309
             les_mean =     281.999832172529
             stat err =       0.001246894782
             autocorr =       1.210460673200
              std dev =       1.602789217054
             le_variance =       2.568933274306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568857483723
                                         uncertainty =       0.041754924069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568857483723
                                         uncertainty =       0.041754924069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133298139
  error estimate for blocks of size 2^( 2) =       0.001172030882
  error estimate for blocks of size 2^( 3) =       0.001205504535
  error estimate for blocks of size 2^( 4) =       0.001230101056
  error estimate for blocks of size 2^( 5) =       0.001244633085
  error estimate for blocks of size 2^( 6) =       0.001253691839
  error estimate for blocks of size 2^( 7) =       0.001259000844

      target function =                  N/A
              le_mean =     -16.715482712364
             les_mean =     281.947257389271
             stat err =       0.001246856706
             autocorr =       1.210444104987
              std dev =       1.602751241503
             le_variance =       2.568811542139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568719847120
                                         uncertainty =       0.041755316764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.568719847120
                                         uncertainty =       0.041755316764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133267404
  error estimate for blocks of size 2^( 2) =       0.001172004692
  error estimate for blocks of size 2^( 3) =       0.001205481132
  error estimate for blocks of size 2^( 4) =       0.001230075307
  error estimate for blocks of size 2^( 5) =       0.001244607769
  error estimate for blocks of size 2^( 6) =       0.001253663211
  error estimate for blocks of size 2^( 7) =       0.001258962767

      target function =                  N/A
              le_mean =     -16.715484172113
             les_mean =     281.946877385289
             stat err =       0.001246827264
             autocorr =       1.210452594236
              std dev =       1.602707775143
             le_variance =       2.568672212503


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.715484544915        initial
     9.7656e-01     9.7656e+00             3.8679e-04       -16.715484871309  <--
     3.9062e+00     3.9062e+01             1.0913e-04       -16.715482712364
     1.5625e+01     1.5625e+02             2.8224e-05       -16.715484172113

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.3994e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.075308e-01 3 1  ON 0
ci_0002                 6.790620e-01 3 1  ON 1
ci_0003                -4.794801e-02 3 1  ON 2
ci_0004                -4.681529e-02 3 1  ON 3
ci_0005                -4.603159e-02 3 1  ON 4
ci_0006                -4.397945e-02 3 1  ON 5
ci_0007                -3.092457e-02 3 1  ON 6
ci_0008                -3.169759e-02 3 1  ON 7
ci_0009                -3.261268e-02 3 1  ON 8
ci_0010                -3.132234e-02 3 1  ON 9
ci_0011                -2.758752e-02 3 1  ON 10
ci_0012                -2.601852e-02 3 1  ON 11
ci_0013                 2.750696e-02 3 1  ON 12
ci_0014                 2.652181e-02 3 1  ON 13
ci_0015                 2.721225e-02 3 1  ON 14
ci_0016                 2.653537e-02 3 1  ON 15
ci_0017                 2.463325e-02 3 1  ON 16
ci_0018                 2.297922e-02 3 1  ON 17
ci_0019                 2.045886e-02 3 1  ON 18
ci_0020                 1.902399e-02 3 1  ON 19
ci_0021                 1.802563e-02 3 1  ON 20
ci_0022                 1.860457e-02 3 1  ON 21
ci_0023                -1.985020e-02 3 1  ON 22
ci_0024                -1.835966e-02 3 1  ON 23
ci_0025                -1.843415e-02 3 1  ON 24
ci_0026                -1.740894e-02 3 1  ON 25
ci_0027                -1.812470e-02 3 1  ON 26
ci_0028                -1.694612e-02 3 1  ON 27
ci_0029                -1.668199e-02 3 1  ON 28
ci_0030                -1.646790e-02 3 1  ON 29
ci_0031                 1.594979e-02 3 1  ON 30
ci_0032                 1.391658e-02 3 1  ON 31
ci_0033                 1.665737e-02 3 1  ON 32
ci_0034                 1.555008e-02 3 1  ON 33
ci_0035                 1.815125e-02 3 1  ON 34
ci_0036                 1.698139e-02 3 1  ON 35
ci_0037                -1.537044e-02 3 1  ON 36
ci_0038                -1.476208e-02 3 1  ON 37
ci_0039                -1.612904e-02 3 1  ON 38
ci_0040                -1.526643e-02 3 1  ON 39
ci_0041                 1.572814e-02 3 1  ON 40
ci_0042                 1.522018e-02 3 1  ON 41
ci_0043                -1.628555e-02 3 1  ON 42
ci_0044                -1.425329e-02 3 1  ON 43
ci_0045                 1.555464e-02 3 1  ON 44
ci_0046                 1.449074e-02 3 1  ON 45
ci_0047                -1.447459e-02 3 1  ON 46
ci_0048                -1.404419e-02 3 1  ON 47
ci_0049                -1.357704e-02 3 1  ON 48
ci_0050                -1.298018e-02 3 1  ON 49
ci_0051                -1.348367e-02 3 1  ON 50
ci_0052                -1.230515e-02 3 1  ON 51
ci_0053                -1.301266e-02 3 1  ON 52
ci_0054                -1.248893e-02 3 1  ON 53
ci_0055                 1.343136e-02 3 1  ON 54
ci_0056                 1.305292e-02 3 1  ON 55
ci_0057                 1.257839e-02 3 1  ON 56
ci_0058                 1.298061e-02 3 1  ON 57
ci_0059                -1.313295e-02 3 1  ON 58
ci_0060                -1.297730e-02 3 1  ON 59
ci_0061                -1.306781e-02 3 1  ON 60
ci_0062                -1.215836e-02 3 1  ON 61
ci_0063                -1.152852e-02 3 1  ON 62
ci_0064                -1.102899e-02 3 1  ON 63
ci_0065                -1.212062e-02 3 1  ON 64
ci_0066                -1.169917e-02 3 1  ON 65
ci_0067                -1.101054e-02 3 1  ON 66
ci_0068                -1.075319e-02 3 1  ON 67
ci_0069                 1.110552e-02 3 1  ON 68
ci_0070                 1.067097e-02 3 1  ON 69
ci_0071                 9.910583e-03 3 1  ON 70
ci_0072                 9.990215e-03 3 1  ON 71
ci_0073                 1.097134e-02 3 1  ON 72
ci_0074                 1.092555e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0273e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6705e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.3312
    reference variance = 8.99693
====================================================
  Execution time = 1.3000e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0265e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5628e+00
  Total weights = 1.945979430e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1843e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.593543493022
                                         uncertainty =       0.042445472679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.593543493022
                                         uncertainty =       0.042445472679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138580808
  error estimate for blocks of size 2^( 2) =       0.001178260391
  error estimate for blocks of size 2^( 3) =       0.001212543561
  error estimate for blocks of size 2^( 4) =       0.001235759519
  error estimate for blocks of size 2^( 5) =       0.001250092167
  error estimate for blocks of size 2^( 6) =       0.001257926404
  error estimate for blocks of size 2^( 7) =       0.001263793493

      target function =                  N/A
              le_mean =     -16.718863877769
             les_mean =     282.083254169755
             stat err =       0.001251892896
             autocorr =       1.208945245807
              std dev =       1.610222183575
             le_variance =       2.592815480477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671886387777e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718863876866       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718895287684       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718894551745       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718894947323       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 1.298025e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718863876866       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718876192078       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718876084586       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718876101113       residual = 1.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 4.746290e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718863876866       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718867465498       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718867478255       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.389456e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6190e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.075514e-01 3 1  ON 0
ci_0002                 6.790902e-01 3 1  ON 1
ci_0003                -4.785051e-02 3 1  ON 2
ci_0004                -4.648788e-02 3 1  ON 3
ci_0005                -4.589891e-02 3 1  ON 4
ci_0006                -4.398615e-02 3 1  ON 5
ci_0007                -3.090204e-02 3 1  ON 6
ci_0008                -3.160581e-02 3 1  ON 7
ci_0009                -3.259654e-02 3 1  ON 8
ci_0010                -3.129975e-02 3 1  ON 9
ci_0011                -2.756409e-02 3 1  ON 10
ci_0012                -2.607339e-02 3 1  ON 11
ci_0013                 2.720814e-02 3 1  ON 12
ci_0014                 2.641514e-02 3 1  ON 13
ci_0015                 2.740640e-02 3 1  ON 14
ci_0016                 2.626814e-02 3 1  ON 15
ci_0017                 2.478173e-02 3 1  ON 16
ci_0018                 2.320544e-02 3 1  ON 17
ci_0019                 2.030205e-02 3 1  ON 18
ci_0020                 1.894896e-02 3 1  ON 19
ci_0021                 1.804767e-02 3 1  ON 20
ci_0022                 1.834242e-02 3 1  ON 21
ci_0023                -1.982306e-02 3 1  ON 22
ci_0024                -1.798650e-02 3 1  ON 23
ci_0025                -1.890878e-02 3 1  ON 24
ci_0026                -1.767684e-02 3 1  ON 25
ci_0027                -1.789678e-02 3 1  ON 26
ci_0028                -1.693256e-02 3 1  ON 27
ci_0029                -1.651802e-02 3 1  ON 28
ci_0030                -1.634921e-02 3 1  ON 29
ci_0031                 1.579370e-02 3 1  ON 30
ci_0032                 1.365892e-02 3 1  ON 31
ci_0033                 1.694425e-02 3 1  ON 32
ci_0034                 1.580180e-02 3 1  ON 33
ci_0035                 1.822553e-02 3 1  ON 34
ci_0036                 1.706795e-02 3 1  ON 35
ci_0037                -1.542774e-02 3 1  ON 36
ci_0038                -1.478093e-02 3 1  ON 37
ci_0039                -1.611135e-02 3 1  ON 38
ci_0040                -1.512927e-02 3 1  ON 39
ci_0041                 1.584434e-02 3 1  ON 40
ci_0042                 1.553769e-02 3 1  ON 41
ci_0043                -1.631895e-02 3 1  ON 42
ci_0044                -1.448775e-02 3 1  ON 43
ci_0045                 1.540146e-02 3 1  ON 44
ci_0046                 1.469232e-02 3 1  ON 45
ci_0047                -1.448188e-02 3 1  ON 46
ci_0048                -1.385935e-02 3 1  ON 47
ci_0049                -1.342979e-02 3 1  ON 48
ci_0050                -1.300480e-02 3 1  ON 49
ci_0051                -1.335965e-02 3 1  ON 50
ci_0052                -1.239379e-02 3 1  ON 51
ci_0053                -1.310143e-02 3 1  ON 52
ci_0054                -1.244035e-02 3 1  ON 53
ci_0055                 1.296719e-02 3 1  ON 54
ci_0056                 1.305596e-02 3 1  ON 55
ci_0057                 1.270302e-02 3 1  ON 56
ci_0058                 1.313798e-02 3 1  ON 57
ci_0059                -1.310276e-02 3 1  ON 58
ci_0060                -1.294169e-02 3 1  ON 59
ci_0061                -1.306165e-02 3 1  ON 60
ci_0062                -1.214078e-02 3 1  ON 61
ci_0063                -1.178475e-02 3 1  ON 62
ci_0064                -1.129868e-02 3 1  ON 63
ci_0065                -1.228336e-02 3 1  ON 64
ci_0066                -1.163602e-02 3 1  ON 65
ci_0067                -1.105080e-02 3 1  ON 66
ci_0068                -1.071345e-02 3 1  ON 67
ci_0069                 1.105008e-02 3 1  ON 68
ci_0070                 1.063066e-02 3 1  ON 69
ci_0071                 1.019748e-02 3 1  ON 70
ci_0072                 1.004771e-02 3 1  ON 71
ci_0073                 1.074991e-02 3 1  ON 72
ci_0074                 1.072526e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.7898
    reference variance = 1.87792
====================================================
  Execution time = 1.2656e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5368e+00
  Total weights = 1.9455e+06
  Execution time = 2.2098e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562574813118
                                         uncertainty =       0.026759743528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562574813118
                                         uncertainty =       0.026759743528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131740155
  error estimate for blocks of size 2^( 2) =       0.001170059762
  error estimate for blocks of size 2^( 3) =       0.001201396889
  error estimate for blocks of size 2^( 4) =       0.001224085218
  error estimate for blocks of size 2^( 5) =       0.001238951795
  error estimate for blocks of size 2^( 6) =       0.001246177524
  error estimate for blocks of size 2^( 7) =       0.001250512527

      target function =                  N/A
              le_mean =     -16.718131915419
             les_mean =     282.040700365264
             stat err =       0.001239931766
             autocorr =       1.200334038493
              std dev =       1.600547885127
             le_variance =       2.561753532586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563003359378
                                         uncertainty =       0.026748027308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.563003359378
                                         uncertainty =       0.026748027308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131835061
  error estimate for blocks of size 2^( 2) =       0.001170185078
  error estimate for blocks of size 2^( 3) =       0.001201558718
  error estimate for blocks of size 2^( 4) =       0.001224240515
  error estimate for blocks of size 2^( 5) =       0.001239119631
  error estimate for blocks of size 2^( 6) =       0.001246359605
  error estimate for blocks of size 2^( 7) =       0.001250607533

      target function =                  N/A
              le_mean =     -16.718139625997
             les_mean =     282.041763143600
             stat err =       0.001240081821
             autocorr =       1.200423243107
              std dev =       1.600682104110
             le_variance =       2.562183198419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562825874872
                                         uncertainty =       0.026751575917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562825874872
                                         uncertainty =       0.026751575917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131795840
  error estimate for blocks of size 2^( 2) =       0.001170143335
  error estimate for blocks of size 2^( 3) =       0.001201508819
  error estimate for blocks of size 2^( 4) =       0.001224193049
  error estimate for blocks of size 2^( 5) =       0.001239068999
  error estimate for blocks of size 2^( 6) =       0.001246310726
  error estimate for blocks of size 2^( 7) =       0.001250573772

      target function =                  N/A
              le_mean =     -16.718133447783
             les_mean =     282.033731997428
             stat err =       0.001240036637
             autocorr =       1.200418960066
              std dev =       1.600626636235
             le_variance =       2.562005628625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562579072285
                                         uncertainty =       0.026758586745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562579072285
                                         uncertainty =       0.026758586745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131741138
  error estimate for blocks of size 2^( 2) =       0.001170064782
  error estimate for blocks of size 2^( 3) =       0.001201410704
  error estimate for blocks of size 2^( 4) =       0.001224097544
  error estimate for blocks of size 2^( 5) =       0.001238960500
  error estimate for blocks of size 2^( 6) =       0.001246190192
  error estimate for blocks of size 2^( 7) =       0.001250518516

      target function =                  N/A
              le_mean =     -16.718127352217
             les_mean =     282.034507409234
             stat err =       0.001239941688
             autocorr =       1.200351164385
              std dev =       1.600549275020
             le_variance =       2.561757981768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718131915419        initial
     2.4414e-01     2.4414e+00             1.2980e-03       -16.718139625997  <--
     9.7656e-01     9.7656e+00             4.7463e-04       -16.718133447783
     3.9062e+00     3.9062e+01             1.3895e-04       -16.718127352217

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.3898e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.075879e-01 3 1  ON 0
ci_0002                 6.791217e-01 3 1  ON 1
ci_0003                -4.770348e-02 3 1  ON 2
ci_0004                -4.593384e-02 3 1  ON 3
ci_0005                -4.565400e-02 3 1  ON 4
ci_0006                -4.398366e-02 3 1  ON 5
ci_0007                -3.085393e-02 3 1  ON 6
ci_0008                -3.140697e-02 3 1  ON 7
ci_0009                -3.258614e-02 3 1  ON 8
ci_0010                -3.128710e-02 3 1  ON 9
ci_0011                -2.755263e-02 3 1  ON 10
ci_0012                -2.617730e-02 3 1  ON 11
ci_0013                 2.676970e-02 3 1  ON 12
ci_0014                 2.627261e-02 3 1  ON 13
ci_0015                 2.773995e-02 3 1  ON 14
ci_0016                 2.586743e-02 3 1  ON 15
ci_0017                 2.500912e-02 3 1  ON 16
ci_0018                 2.357134e-02 3 1  ON 17
ci_0019                 2.005773e-02 3 1  ON 18
ci_0020                 1.885182e-02 3 1  ON 19
ci_0021                 1.808152e-02 3 1  ON 20
ci_0022                 1.780515e-02 3 1  ON 21
ci_0023                -1.979374e-02 3 1  ON 22
ci_0024                -1.743192e-02 3 1  ON 23
ci_0025                -1.963122e-02 3 1  ON 24
ci_0026                -1.807055e-02 3 1  ON 25
ci_0027                -1.756242e-02 3 1  ON 26
ci_0028                -1.696011e-02 3 1  ON 27
ci_0029                -1.626333e-02 3 1  ON 28
ci_0030                -1.617407e-02 3 1  ON 29
ci_0031                 1.549463e-02 3 1  ON 30
ci_0032                 1.316664e-02 3 1  ON 31
ci_0033                 1.750737e-02 3 1  ON 32
ci_0034                 1.629824e-02 3 1  ON 33
ci_0035                 1.836112e-02 3 1  ON 34
ci_0036                 1.720606e-02 3 1  ON 35
ci_0037                -1.551774e-02 3 1  ON 36
ci_0038                -1.479558e-02 3 1  ON 37
ci_0039                -1.609160e-02 3 1  ON 38
ci_0040                -1.497372e-02 3 1  ON 39
ci_0041                 1.603019e-02 3 1  ON 40
ci_0042                 1.605655e-02 3 1  ON 41
ci_0043                -1.640473e-02 3 1  ON 42
ci_0044                -1.495802e-02 3 1  ON 43
ci_0045                 1.512759e-02 3 1  ON 44
ci_0046                 1.507484e-02 3 1  ON 45
ci_0047                -1.449073e-02 3 1  ON 46
ci_0048                -1.363777e-02 3 1  ON 47
ci_0049                -1.321577e-02 3 1  ON 48
ci_0050                -1.304460e-02 3 1  ON 49
ci_0051                -1.320328e-02 3 1  ON 50
ci_0052                -1.249608e-02 3 1  ON 51
ci_0053                -1.323926e-02 3 1  ON 52
ci_0054                -1.239193e-02 3 1  ON 53
ci_0055                 1.213334e-02 3 1  ON 54
ci_0056                 1.306823e-02 3 1  ON 55
ci_0057                 1.289985e-02 3 1  ON 56
ci_0058                 1.339337e-02 3 1  ON 57
ci_0059                -1.307589e-02 3 1  ON 58
ci_0060                -1.290588e-02 3 1  ON 59
ci_0061                -1.304317e-02 3 1  ON 60
ci_0062                -1.210869e-02 3 1  ON 61
ci_0063                -1.213425e-02 3 1  ON 62
ci_0064                -1.167439e-02 3 1  ON 63
ci_0065                -1.251779e-02 3 1  ON 64
ci_0066                -1.154061e-02 3 1  ON 65
ci_0067                -1.110746e-02 3 1  ON 66
ci_0068                -1.067036e-02 3 1  ON 67
ci_0069                 1.099225e-02 3 1  ON 68
ci_0070                 1.058707e-02 3 1  ON 69
ci_0071                 1.063547e-02 3 1  ON 70
ci_0072                 1.013012e-02 3 1  ON 71
ci_0073                 1.048568e-02 3 1  ON 72
ci_0074                 1.047842e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6692e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.5901
    reference variance = 1.85201
====================================================
  Execution time = 1.5404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0239e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6373e+00
  Total weights = 1.945549568e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2261e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.667599990398
                                         uncertainty =       0.074956740413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.667599990398
                                         uncertainty =       0.074956740413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001154843135
  error estimate for blocks of size 2^( 2) =       0.001193197958
  error estimate for blocks of size 2^( 3) =       0.001225564533
  error estimate for blocks of size 2^( 4) =       0.001248626025
  error estimate for blocks of size 2^( 5) =       0.001263551115
  error estimate for blocks of size 2^( 6) =       0.001270429026
  error estimate for blocks of size 2^( 7) =       0.001275737347

      target function =                  N/A
              le_mean =     -16.716766858273
             les_mean =     282.087626354123
             stat err =       0.001264585878
             autocorr =       1.199086907937
              std dev =       1.633220955113
             le_variance =       2.667410688221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671676685827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716766857348       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716832157850       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716839376427       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716842952037       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.716843934445       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.716843665910       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.716843773496       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-02 is 2.798649e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716766857348       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716806421314       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716807860919       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716808304259       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.716808297647       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 1.314850e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716766857348       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716782212967       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716782206582       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716782223891       residual = 1.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 4.231898e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080269 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8637e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.080545e-01 3 1  ON 0
ci_0002                 6.784335e-01 3 1  ON 1
ci_0003                -4.825419e-02 3 1  ON 2
ci_0004                -4.637096e-02 3 1  ON 3
ci_0005                -4.519214e-02 3 1  ON 4
ci_0006                -4.430881e-02 3 1  ON 5
ci_0007                -3.106190e-02 3 1  ON 6
ci_0008                -3.179827e-02 3 1  ON 7
ci_0009                -3.249309e-02 3 1  ON 8
ci_0010                -3.115396e-02 3 1  ON 9
ci_0011                -2.800585e-02 3 1  ON 10
ci_0012                -2.682210e-02 3 1  ON 11
ci_0013                 2.738833e-02 3 1  ON 12
ci_0014                 2.615073e-02 3 1  ON 13
ci_0015                 2.752185e-02 3 1  ON 14
ci_0016                 2.647522e-02 3 1  ON 15
ci_0017                 2.481335e-02 3 1  ON 16
ci_0018                 2.373700e-02 3 1  ON 17
ci_0019                 1.985590e-02 3 1  ON 18
ci_0020                 1.929520e-02 3 1  ON 19
ci_0021                 1.939637e-02 3 1  ON 20
ci_0022                 1.786862e-02 3 1  ON 21
ci_0023                -1.964689e-02 3 1  ON 22
ci_0024                -1.757444e-02 3 1  ON 23
ci_0025                -1.998940e-02 3 1  ON 24
ci_0026                -1.829335e-02 3 1  ON 25
ci_0027                -1.781910e-02 3 1  ON 26
ci_0028                -1.753194e-02 3 1  ON 27
ci_0029                -1.666048e-02 3 1  ON 28
ci_0030                -1.643633e-02 3 1  ON 29
ci_0031                 1.504047e-02 3 1  ON 30
ci_0032                 1.362585e-02 3 1  ON 31
ci_0033                 1.800598e-02 3 1  ON 32
ci_0034                 1.559983e-02 3 1  ON 33
ci_0035                 1.747596e-02 3 1  ON 34
ci_0036                 1.675170e-02 3 1  ON 35
ci_0037                -1.551205e-02 3 1  ON 36
ci_0038                -1.411595e-02 3 1  ON 37
ci_0039                -1.616778e-02 3 1  ON 38
ci_0040                -1.512320e-02 3 1  ON 39
ci_0041                 1.600585e-02 3 1  ON 40
ci_0042                 1.609420e-02 3 1  ON 41
ci_0043                -1.546013e-02 3 1  ON 42
ci_0044                -1.553062e-02 3 1  ON 43
ci_0045                 1.494896e-02 3 1  ON 44
ci_0046                 1.507191e-02 3 1  ON 45
ci_0047                -1.480215e-02 3 1  ON 46
ci_0048                -1.414859e-02 3 1  ON 47
ci_0049                -1.323257e-02 3 1  ON 48
ci_0050                -1.288818e-02 3 1  ON 49
ci_0051                -1.314949e-02 3 1  ON 50
ci_0052                -1.231691e-02 3 1  ON 51
ci_0053                -1.317062e-02 3 1  ON 52
ci_0054                -1.261316e-02 3 1  ON 53
ci_0055                 1.213299e-02 3 1  ON 54
ci_0056                 1.298933e-02 3 1  ON 55
ci_0057                 1.368137e-02 3 1  ON 56
ci_0058                 1.245031e-02 3 1  ON 57
ci_0059                -1.334851e-02 3 1  ON 58
ci_0060                -1.301767e-02 3 1  ON 59
ci_0061                -1.300064e-02 3 1  ON 60
ci_0062                -1.259112e-02 3 1  ON 61
ci_0063                -1.221269e-02 3 1  ON 62
ci_0064                -1.126516e-02 3 1  ON 63
ci_0065                -1.218084e-02 3 1  ON 64
ci_0066                -1.158259e-02 3 1  ON 65
ci_0067                -1.110669e-02 3 1  ON 66
ci_0068                -1.085285e-02 3 1  ON 67
ci_0069                 1.074092e-02 3 1  ON 68
ci_0070                 1.080846e-02 3 1  ON 69
ci_0071                 1.005601e-02 3 1  ON 70
ci_0072                 1.011763e-02 3 1  ON 71
ci_0073                 1.102051e-02 3 1  ON 72
ci_0074                 1.099091e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.835
    reference variance = 1.57562
====================================================
  Execution time = 1.2672e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.4836e+00
  Total weights = 1.9455e+06
  Execution time = 2.2211e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506307258994
                                         uncertainty =       0.021210608101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.506307258994
                                         uncertainty =       0.021210608101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119509965
  error estimate for blocks of size 2^( 2) =       0.001158326958
  error estimate for blocks of size 2^( 3) =       0.001192729336
  error estimate for blocks of size 2^( 4) =       0.001217936887
  error estimate for blocks of size 2^( 5) =       0.001235665445
  error estimate for blocks of size 2^( 6) =       0.001244722240
  error estimate for blocks of size 2^( 7) =       0.001248257345

      target function =                  N/A
              le_mean =     -16.717598167331
             les_mean =     281.967059034154
             stat err =       0.001236645479
             autocorr =       1.220209777982
              std dev =       1.583251507795
             le_variance =       2.506685336936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.505080839075
                                         uncertainty =       0.021147315636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.505080839075
                                         uncertainty =       0.021147315636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119236214
  error estimate for blocks of size 2^( 2) =       0.001158006329
  error estimate for blocks of size 2^( 3) =       0.001192376254
  error estimate for blocks of size 2^( 4) =       0.001217593226
  error estimate for blocks of size 2^( 5) =       0.001235295223
  error estimate for blocks of size 2^( 6) =       0.001244264815
  error estimate for blocks of size 2^( 7) =       0.001247873612

      target function =                  N/A
              le_mean =     -16.717583129181
             les_mean =     281.966290162106
             stat err =       0.001236256719
             autocorr =       1.220039306473
              std dev =       1.582864358185
             le_variance =       2.505459576413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.505313809293
                                         uncertainty =       0.021162399274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.505313809293
                                         uncertainty =       0.021162399274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119288096
  error estimate for blocks of size 2^( 2) =       0.001158034257
  error estimate for blocks of size 2^( 3) =       0.001192385524
  error estimate for blocks of size 2^( 4) =       0.001217592291
  error estimate for blocks of size 2^( 5) =       0.001235290482
  error estimate for blocks of size 2^( 6) =       0.001244237020
  error estimate for blocks of size 2^( 7) =       0.001247773762

      target function =                  N/A
              le_mean =     -16.717599695101
             les_mean =     281.987826713574
             stat err =       0.001236223389
             autocorr =       1.219860425006
              std dev =       1.582937732231
             le_variance =       2.505691864121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.505942083170
                                         uncertainty =       0.021202952984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.505942083170
                                         uncertainty =       0.021202952984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119428418
  error estimate for blocks of size 2^( 2) =       0.001158230818
  error estimate for blocks of size 2^( 3) =       0.001192617919
  error estimate for blocks of size 2^( 4) =       0.001217826136
  error estimate for blocks of size 2^( 5) =       0.001235550748
  error estimate for blocks of size 2^( 6) =       0.001244589545
  error estimate for blocks of size 2^( 7) =       0.001248157279

      target function =                  N/A
              le_mean =     -16.717581289664
             les_mean =     281.963745044334
             stat err =       0.001236530927
             autocorr =       1.220161480392
              std dev =       1.583136180373
             le_variance =       2.506320165606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717598167331        initial
     6.1035e-02     6.1035e-01             2.7986e-03       -16.717583129181
     2.4414e-01     2.4414e+00             1.3149e-03       -16.717599695101  <--
     9.7656e-01     9.7656e+00             4.2319e-04       -16.717581289664

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.3914e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.080545e-01 3 1  ON 0
ci_0002                 6.784335e-01 3 1  ON 1
ci_0003                -4.825419e-02 3 1  ON 2
ci_0004                -4.637096e-02 3 1  ON 3
ci_0005                -4.519214e-02 3 1  ON 4
ci_0006                -4.430881e-02 3 1  ON 5
ci_0007                -3.106190e-02 3 1  ON 6
ci_0008                -3.179827e-02 3 1  ON 7
ci_0009                -3.249309e-02 3 1  ON 8
ci_0010                -3.115396e-02 3 1  ON 9
ci_0011                -2.800585e-02 3 1  ON 10
ci_0012                -2.682210e-02 3 1  ON 11
ci_0013                 2.738833e-02 3 1  ON 12
ci_0014                 2.615073e-02 3 1  ON 13
ci_0015                 2.752185e-02 3 1  ON 14
ci_0016                 2.647522e-02 3 1  ON 15
ci_0017                 2.481335e-02 3 1  ON 16
ci_0018                 2.373700e-02 3 1  ON 17
ci_0019                 1.985590e-02 3 1  ON 18
ci_0020                 1.929520e-02 3 1  ON 19
ci_0021                 1.939637e-02 3 1  ON 20
ci_0022                 1.786862e-02 3 1  ON 21
ci_0023                -1.964689e-02 3 1  ON 22
ci_0024                -1.757444e-02 3 1  ON 23
ci_0025                -1.998940e-02 3 1  ON 24
ci_0026                -1.829335e-02 3 1  ON 25
ci_0027                -1.781910e-02 3 1  ON 26
ci_0028                -1.753194e-02 3 1  ON 27
ci_0029                -1.666048e-02 3 1  ON 28
ci_0030                -1.643633e-02 3 1  ON 29
ci_0031                 1.504047e-02 3 1  ON 30
ci_0032                 1.362585e-02 3 1  ON 31
ci_0033                 1.800598e-02 3 1  ON 32
ci_0034                 1.559983e-02 3 1  ON 33
ci_0035                 1.747596e-02 3 1  ON 34
ci_0036                 1.675170e-02 3 1  ON 35
ci_0037                -1.551205e-02 3 1  ON 36
ci_0038                -1.411595e-02 3 1  ON 37
ci_0039                -1.616778e-02 3 1  ON 38
ci_0040                -1.512320e-02 3 1  ON 39
ci_0041                 1.600585e-02 3 1  ON 40
ci_0042                 1.609420e-02 3 1  ON 41
ci_0043                -1.546013e-02 3 1  ON 42
ci_0044                -1.553062e-02 3 1  ON 43
ci_0045                 1.494896e-02 3 1  ON 44
ci_0046                 1.507191e-02 3 1  ON 45
ci_0047                -1.480215e-02 3 1  ON 46
ci_0048                -1.414859e-02 3 1  ON 47
ci_0049                -1.323257e-02 3 1  ON 48
ci_0050                -1.288818e-02 3 1  ON 49
ci_0051                -1.314949e-02 3 1  ON 50
ci_0052                -1.231691e-02 3 1  ON 51
ci_0053                -1.317062e-02 3 1  ON 52
ci_0054                -1.261316e-02 3 1  ON 53
ci_0055                 1.213299e-02 3 1  ON 54
ci_0056                 1.298933e-02 3 1  ON 55
ci_0057                 1.368137e-02 3 1  ON 56
ci_0058                 1.245031e-02 3 1  ON 57
ci_0059                -1.334851e-02 3 1  ON 58
ci_0060                -1.301767e-02 3 1  ON 59
ci_0061                -1.300064e-02 3 1  ON 60
ci_0062                -1.259112e-02 3 1  ON 61
ci_0063                -1.221269e-02 3 1  ON 62
ci_0064                -1.126516e-02 3 1  ON 63
ci_0065                -1.218084e-02 3 1  ON 64
ci_0066                -1.158259e-02 3 1  ON 65
ci_0067                -1.110669e-02 3 1  ON 66
ci_0068                -1.085285e-02 3 1  ON 67
ci_0069                 1.074092e-02 3 1  ON 68
ci_0070                 1.080846e-02 3 1  ON 69
ci_0071                 1.005601e-02 3 1  ON 70
ci_0072                 1.011763e-02 3 1  ON 71
ci_0073                 1.102051e-02 3 1  ON 72
ci_0074                 1.099091e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2558e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6694e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.4936
    reference variance = 2.22517
====================================================
  Execution time = 1.3043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0269e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5299e+00
  Total weights = 1.945871649e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1784e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.555910203615
                                         uncertainty =       0.027083731430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.555910203615
                                         uncertainty =       0.027083731430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130455236
  error estimate for blocks of size 2^( 2) =       0.001169165633
  error estimate for blocks of size 2^( 3) =       0.001203511741
  error estimate for blocks of size 2^( 4) =       0.001227528218
  error estimate for blocks of size 2^( 5) =       0.001241419039
  error estimate for blocks of size 2^( 6) =       0.001250436088
  error estimate for blocks of size 2^( 7) =       0.001257761015

      target function =                  N/A
              le_mean =     -16.716693267505
             les_mean =     281.977717839227
             stat err =       0.001244286090
             autocorr =       1.211528829025
              std dev =       1.598730705682
             le_variance =       2.555939869289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671669326750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716693266600       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716751267139       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716752569300       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716752126872       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.716752826037       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.716753427845       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.716753619566       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-02 is 1.631481e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716693266600       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716729111633       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716729173241       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716729050044       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.716729095443       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 9.415323e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716693266600       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716707446006       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716707410809       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716707401657       residual = 9.21e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 3.621395e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6229e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.082819e-01 3 1  ON 0
ci_0002                 6.782025e-01 3 1  ON 1
ci_0003                -4.861740e-02 3 1  ON 2
ci_0004                -4.692570e-02 3 1  ON 3
ci_0005                -4.585833e-02 3 1  ON 4
ci_0006                -4.433062e-02 3 1  ON 5
ci_0007                -3.062008e-02 3 1  ON 6
ci_0008                -3.227122e-02 3 1  ON 7
ci_0009                -3.273835e-02 3 1  ON 8
ci_0010                -3.183481e-02 3 1  ON 9
ci_0011                -2.771056e-02 3 1  ON 10
ci_0012                -2.665842e-02 3 1  ON 11
ci_0013                 2.797789e-02 3 1  ON 12
ci_0014                 2.626653e-02 3 1  ON 13
ci_0015                 2.759137e-02 3 1  ON 14
ci_0016                 2.636565e-02 3 1  ON 15
ci_0017                 2.391168e-02 3 1  ON 16
ci_0018                 2.290858e-02 3 1  ON 17
ci_0019                 1.985587e-02 3 1  ON 18
ci_0020                 1.873924e-02 3 1  ON 19
ci_0021                 1.908407e-02 3 1  ON 20
ci_0022                 1.778002e-02 3 1  ON 21
ci_0023                -1.932194e-02 3 1  ON 22
ci_0024                -1.746412e-02 3 1  ON 23
ci_0025                -1.965020e-02 3 1  ON 24
ci_0026                -1.758865e-02 3 1  ON 25
ci_0027                -1.735880e-02 3 1  ON 26
ci_0028                -1.706516e-02 3 1  ON 27
ci_0029                -1.697887e-02 3 1  ON 28
ci_0030                -1.628076e-02 3 1  ON 29
ci_0031                 1.552997e-02 3 1  ON 30
ci_0032                 1.436253e-02 3 1  ON 31
ci_0033                 1.815506e-02 3 1  ON 32
ci_0034                 1.605077e-02 3 1  ON 33
ci_0035                 1.740516e-02 3 1  ON 34
ci_0036                 1.581016e-02 3 1  ON 35
ci_0037                -1.548408e-02 3 1  ON 36
ci_0038                -1.453636e-02 3 1  ON 37
ci_0039                -1.641982e-02 3 1  ON 38
ci_0040                -1.501634e-02 3 1  ON 39
ci_0041                 1.622024e-02 3 1  ON 40
ci_0042                 1.559665e-02 3 1  ON 41
ci_0043                -1.526212e-02 3 1  ON 42
ci_0044                -1.528395e-02 3 1  ON 43
ci_0045                 1.489903e-02 3 1  ON 44
ci_0046                 1.519326e-02 3 1  ON 45
ci_0047                -1.486000e-02 3 1  ON 46
ci_0048                -1.409788e-02 3 1  ON 47
ci_0049                -1.275898e-02 3 1  ON 48
ci_0050                -1.305641e-02 3 1  ON 49
ci_0051                -1.309477e-02 3 1  ON 50
ci_0052                -1.214545e-02 3 1  ON 51
ci_0053                -1.366353e-02 3 1  ON 52
ci_0054                -1.207491e-02 3 1  ON 53
ci_0055                 1.302248e-02 3 1  ON 54
ci_0056                 1.318495e-02 3 1  ON 55
ci_0057                 1.340518e-02 3 1  ON 56
ci_0058                 1.263836e-02 3 1  ON 57
ci_0059                -1.305307e-02 3 1  ON 58
ci_0060                -1.303393e-02 3 1  ON 59
ci_0061                -1.319230e-02 3 1  ON 60
ci_0062                -1.194354e-02 3 1  ON 61
ci_0063                -1.147781e-02 3 1  ON 62
ci_0064                -1.080435e-02 3 1  ON 63
ci_0065                -1.191486e-02 3 1  ON 64
ci_0066                -1.172939e-02 3 1  ON 65
ci_0067                -1.131035e-02 3 1  ON 66
ci_0068                -1.071601e-02 3 1  ON 67
ci_0069                 1.111907e-02 3 1  ON 68
ci_0070                 1.090707e-02 3 1  ON 69
ci_0071                 1.036644e-02 3 1  ON 70
ci_0072                 9.569841e-03 3 1  ON 71
ci_0073                 1.112212e-02 3 1  ON 72
ci_0074                 1.056615e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.6416
    reference variance = 2.40764
====================================================
  Execution time = 1.2736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5499e+00
  Total weights = 1.9455e+06
  Execution time = 2.2177e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 4.91789e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577865916474
                                         uncertainty =       0.034669541731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577865916474
                                         uncertainty =       0.034669541731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135120542
  error estimate for blocks of size 2^( 2) =       0.001173682366
  error estimate for blocks of size 2^( 3) =       0.001206780893
  error estimate for blocks of size 2^( 4) =       0.001230622430
  error estimate for blocks of size 2^( 5) =       0.001247154382
  error estimate for blocks of size 2^( 6) =       0.001257523719
  error estimate for blocks of size 2^( 7) =       0.001268138580

      target function =                  N/A
              le_mean =     -16.717368615186
             les_mean =     282.034951598222
             stat err =       0.001250859778
             autocorr =       1.214320395210
              std dev =       1.605328550277
             le_variance =       2.577079754335

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 4.96511e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577159527752
                                         uncertainty =       0.034665417348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577159527752
                                         uncertainty =       0.034665417348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134965622
  error estimate for blocks of size 2^( 2) =       0.001173502003
  error estimate for blocks of size 2^( 3) =       0.001206629423
  error estimate for blocks of size 2^( 4) =       0.001230511443
  error estimate for blocks of size 2^( 5) =       0.001247097534
  error estimate for blocks of size 2^( 6) =       0.001257370232
  error estimate for blocks of size 2^( 7) =       0.001267977342

      target function =                  N/A
              le_mean =     -16.717352960153
             les_mean =     282.083703934747
             stat err =       0.001250739138
             autocorr =       1.214417635444
              std dev =       1.605109457248
             le_variance =       2.576376369746

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 4.91793e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.576861066330
                                         uncertainty =       0.034675309079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.576861066330
                                         uncertainty =       0.034675309079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134900244
  error estimate for blocks of size 2^( 2) =       0.001173498561
  error estimate for blocks of size 2^( 3) =       0.001206657099
  error estimate for blocks of size 2^( 4) =       0.001230544970
  error estimate for blocks of size 2^( 5) =       0.001247120461
  error estimate for blocks of size 2^( 6) =       0.001257435663
  error estimate for blocks of size 2^( 7) =       0.001267960239

      target function =                  N/A
              le_mean =     -16.717352221181
             les_mean =     282.078936524210
             stat err =       0.001250765333
             autocorr =       1.214608433804
              std dev =       1.605016996719
             le_variance =       2.576079559756

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 5.09797e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577509113206
                                         uncertainty =       0.034672366101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577509113206
                                         uncertainty =       0.034672366101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135042225
  error estimate for blocks of size 2^( 2) =       0.001173613919
  error estimate for blocks of size 2^( 3) =       0.001206724252
  error estimate for blocks of size 2^( 4) =       0.001230577226
  error estimate for blocks of size 2^( 5) =       0.001247113894
  error estimate for blocks of size 2^( 6) =       0.001257476840
  error estimate for blocks of size 2^( 7) =       0.001268064616

      target function =                  N/A
              le_mean =     -16.717347357624
             les_mean =     282.023007822137
             stat err =       0.001250808144
             autocorr =       1.214387713138
              std dev =       1.605217791152
             le_variance =       2.576724157030


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717368615186        initial  <--
     6.1035e-02     6.1035e-01             1.6315e-03       -16.717352960153
     2.4414e-01     2.4414e+00             9.4153e-04       -16.717352221181
     9.7656e-01     9.7656e+00             3.6214e-04       -16.717347357624

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9760
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.080545e-01 3 1  ON 0
ci_0002                 6.784335e-01 3 1  ON 1
ci_0003                -4.825419e-02 3 1  ON 2
ci_0004                -4.637096e-02 3 1  ON 3
ci_0005                -4.519214e-02 3 1  ON 4
ci_0006                -4.430881e-02 3 1  ON 5
ci_0007                -3.106190e-02 3 1  ON 6
ci_0008                -3.179827e-02 3 1  ON 7
ci_0009                -3.249309e-02 3 1  ON 8
ci_0010                -3.115396e-02 3 1  ON 9
ci_0011                -2.800585e-02 3 1  ON 10
ci_0012                -2.682210e-02 3 1  ON 11
ci_0013                 2.738833e-02 3 1  ON 12
ci_0014                 2.615073e-02 3 1  ON 13
ci_0015                 2.752185e-02 3 1  ON 14
ci_0016                 2.647522e-02 3 1  ON 15
ci_0017                 2.481335e-02 3 1  ON 16
ci_0018                 2.373700e-02 3 1  ON 17
ci_0019                 1.985590e-02 3 1  ON 18
ci_0020                 1.929520e-02 3 1  ON 19
ci_0021                 1.939637e-02 3 1  ON 20
ci_0022                 1.786862e-02 3 1  ON 21
ci_0023                -1.964689e-02 3 1  ON 22
ci_0024                -1.757444e-02 3 1  ON 23
ci_0025                -1.998940e-02 3 1  ON 24
ci_0026                -1.829335e-02 3 1  ON 25
ci_0027                -1.781910e-02 3 1  ON 26
ci_0028                -1.753194e-02 3 1  ON 27
ci_0029                -1.666048e-02 3 1  ON 28
ci_0030                -1.643633e-02 3 1  ON 29
ci_0031                 1.504047e-02 3 1  ON 30
ci_0032                 1.362585e-02 3 1  ON 31
ci_0033                 1.800598e-02 3 1  ON 32
ci_0034                 1.559983e-02 3 1  ON 33
ci_0035                 1.747596e-02 3 1  ON 34
ci_0036                 1.675170e-02 3 1  ON 35
ci_0037                -1.551205e-02 3 1  ON 36
ci_0038                -1.411595e-02 3 1  ON 37
ci_0039                -1.616778e-02 3 1  ON 38
ci_0040                -1.512320e-02 3 1  ON 39
ci_0041                 1.600585e-02 3 1  ON 40
ci_0042                 1.609420e-02 3 1  ON 41
ci_0043                -1.546013e-02 3 1  ON 42
ci_0044                -1.553062e-02 3 1  ON 43
ci_0045                 1.494896e-02 3 1  ON 44
ci_0046                 1.507191e-02 3 1  ON 45
ci_0047                -1.480215e-02 3 1  ON 46
ci_0048                -1.414859e-02 3 1  ON 47
ci_0049                -1.323257e-02 3 1  ON 48
ci_0050                -1.288818e-02 3 1  ON 49
ci_0051                -1.314949e-02 3 1  ON 50
ci_0052                -1.231691e-02 3 1  ON 51
ci_0053                -1.317062e-02 3 1  ON 52
ci_0054                -1.261316e-02 3 1  ON 53
ci_0055                 1.213299e-02 3 1  ON 54
ci_0056                 1.298933e-02 3 1  ON 55
ci_0057                 1.368137e-02 3 1  ON 56
ci_0058                 1.245031e-02 3 1  ON 57
ci_0059                -1.334851e-02 3 1  ON 58
ci_0060                -1.301767e-02 3 1  ON 59
ci_0061                -1.300064e-02 3 1  ON 60
ci_0062                -1.259112e-02 3 1  ON 61
ci_0063                -1.221269e-02 3 1  ON 62
ci_0064                -1.126516e-02 3 1  ON 63
ci_0065                -1.218084e-02 3 1  ON 64
ci_0066                -1.158259e-02 3 1  ON 65
ci_0067                -1.110669e-02 3 1  ON 66
ci_0068                -1.085285e-02 3 1  ON 67
ci_0069                 1.074092e-02 3 1  ON 68
ci_0070                 1.080846e-02 3 1  ON 69
ci_0071                 1.005601e-02 3 1  ON 70
ci_0072                 1.011763e-02 3 1  ON 71
ci_0073                 1.102051e-02 3 1  ON 72
ci_0074                 1.099091e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0216e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6684e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.5938
    reference variance = 2.47368
====================================================
  Execution time = 1.2977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0277e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5422e+00
  Total weights = 1.945579073e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2070e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570400120234
                                         uncertainty =       0.023661585736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.570400120234
                                         uncertainty =       0.023661585736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133589955
  error estimate for blocks of size 2^( 2) =       0.001171927324
  error estimate for blocks of size 2^( 3) =       0.001205728454
  error estimate for blocks of size 2^( 4) =       0.001228872833
  error estimate for blocks of size 2^( 5) =       0.001242822340
  error estimate for blocks of size 2^( 6) =       0.001251804384
  error estimate for blocks of size 2^( 7) =       0.001251920042

      target function =                  N/A
              le_mean =     -16.717211555481
             les_mean =     282.007333184424
             stat err =       0.001243854900
             autocorr =       1.204002710850
              std dev =       1.603163938651
             le_variance =       2.570134614192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671721155548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717211554531       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717235270936       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717236303867       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717236274276       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 6.186703e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717211554531       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717219073278       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717219236831       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.928397e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717211554531       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717213569258       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717213602950       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 5.137793e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6195e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.081491e-01 3 1  ON 0
ci_0002                 6.783976e-01 3 1  ON 1
ci_0003                -4.827107e-02 3 1  ON 2
ci_0004                -4.641999e-02 3 1  ON 3
ci_0005                -4.519361e-02 3 1  ON 4
ci_0006                -4.435080e-02 3 1  ON 5
ci_0007                -3.106414e-02 3 1  ON 6
ci_0008                -3.173500e-02 3 1  ON 7
ci_0009                -3.240626e-02 3 1  ON 8
ci_0010                -3.106445e-02 3 1  ON 9
ci_0011                -2.799423e-02 3 1  ON 10
ci_0012                -2.662926e-02 3 1  ON 11
ci_0013                 2.736312e-02 3 1  ON 12
ci_0014                 2.604346e-02 3 1  ON 13
ci_0015                 2.747939e-02 3 1  ON 14
ci_0016                 2.639967e-02 3 1  ON 15
ci_0017                 2.478879e-02 3 1  ON 16
ci_0018                 2.368270e-02 3 1  ON 17
ci_0019                 1.982129e-02 3 1  ON 18
ci_0020                 1.928880e-02 3 1  ON 19
ci_0021                 1.934326e-02 3 1  ON 20
ci_0022                 1.798511e-02 3 1  ON 21
ci_0023                -1.960687e-02 3 1  ON 22
ci_0024                -1.769967e-02 3 1  ON 23
ci_0025                -1.993638e-02 3 1  ON 24
ci_0026                -1.817995e-02 3 1  ON 25
ci_0027                -1.775608e-02 3 1  ON 26
ci_0028                -1.735960e-02 3 1  ON 27
ci_0029                -1.662222e-02 3 1  ON 28
ci_0030                -1.641884e-02 3 1  ON 29
ci_0031                 1.500529e-02 3 1  ON 30
ci_0032                 1.367610e-02 3 1  ON 31
ci_0033                 1.792449e-02 3 1  ON 32
ci_0034                 1.550042e-02 3 1  ON 33
ci_0035                 1.748529e-02 3 1  ON 34
ci_0036                 1.658642e-02 3 1  ON 35
ci_0037                -1.549652e-02 3 1  ON 36
ci_0038                -1.410333e-02 3 1  ON 37
ci_0039                -1.604068e-02 3 1  ON 38
ci_0040                -1.509010e-02 3 1  ON 39
ci_0041                 1.598292e-02 3 1  ON 40
ci_0042                 1.607221e-02 3 1  ON 41
ci_0043                -1.549151e-02 3 1  ON 42
ci_0044                -1.545566e-02 3 1  ON 43
ci_0045                 1.483399e-02 3 1  ON 44
ci_0046                 1.501694e-02 3 1  ON 45
ci_0047                -1.480371e-02 3 1  ON 46
ci_0048                -1.413742e-02 3 1  ON 47
ci_0049                -1.322697e-02 3 1  ON 48
ci_0050                -1.292720e-02 3 1  ON 49
ci_0051                -1.306816e-02 3 1  ON 50
ci_0052                -1.240681e-02 3 1  ON 51
ci_0053                -1.315365e-02 3 1  ON 52
ci_0054                -1.256360e-02 3 1  ON 53
ci_0055                 1.216554e-02 3 1  ON 54
ci_0056                 1.299853e-02 3 1  ON 55
ci_0057                 1.363733e-02 3 1  ON 56
ci_0058                 1.233093e-02 3 1  ON 57
ci_0059                -1.335851e-02 3 1  ON 58
ci_0060                -1.290426e-02 3 1  ON 59
ci_0061                -1.299077e-02 3 1  ON 60
ci_0062                -1.259107e-02 3 1  ON 61
ci_0063                -1.213608e-02 3 1  ON 62
ci_0064                -1.120932e-02 3 1  ON 63
ci_0065                -1.218657e-02 3 1  ON 64
ci_0066                -1.146995e-02 3 1  ON 65
ci_0067                -1.114595e-02 3 1  ON 66
ci_0068                -1.088026e-02 3 1  ON 67
ci_0069                 1.081623e-02 3 1  ON 68
ci_0070                 1.071249e-02 3 1  ON 69
ci_0071                 9.973606e-03 3 1  ON 70
ci_0072                 1.008496e-02 3 1  ON 71
ci_0073                 1.102393e-02 3 1  ON 72
ci_0074                 1.097201e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.6942
    reference variance = 2.65499
====================================================
  Execution time = 1.2664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5263e+00
  Total weights = 1.9459e+06
  Execution time = 2.2226e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554431121868
                                         uncertainty =       0.041163953457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554431121868
                                         uncertainty =       0.041163953457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130004966
  error estimate for blocks of size 2^( 2) =       0.001168230581
  error estimate for blocks of size 2^( 3) =       0.001200737536
  error estimate for blocks of size 2^( 4) =       0.001223207954
  error estimate for blocks of size 2^( 5) =       0.001233360211
  error estimate for blocks of size 2^( 6) =       0.001243289565
  error estimate for blocks of size 2^( 7) =       0.001248684357

      target function =                  N/A
              le_mean =     -16.719090373710
             les_mean =     282.054979218096
             stat err =       0.001237135522
             autocorr =       1.198598831965
              std dev =       1.598093916680
             le_variance =       2.553904166530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554282705299
                                         uncertainty =       0.041161336406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554282705299
                                         uncertainty =       0.041161336406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129971962
  error estimate for blocks of size 2^( 2) =       0.001168249856
  error estimate for blocks of size 2^( 3) =       0.001200813250
  error estimate for blocks of size 2^( 4) =       0.001223341036
  error estimate for blocks of size 2^( 5) =       0.001233543136
  error estimate for blocks of size 2^( 6) =       0.001243504196
  error estimate for blocks of size 2^( 7) =       0.001248890889

      target function =                  N/A
              le_mean =     -16.719091583222
             les_mean =     282.055552886740
             stat err =       0.001237319814
             autocorr =       1.199025998888
              std dev =       1.598047242298
             le_variance =       2.553754988617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554306039302
                                         uncertainty =       0.041161895219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554306039302
                                         uncertainty =       0.041161895219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129977185
  error estimate for blocks of size 2^( 2) =       0.001168237386
  error estimate for blocks of size 2^( 3) =       0.001200780997
  error estimate for blocks of size 2^( 4) =       0.001223287632
  error estimate for blocks of size 2^( 5) =       0.001233471672
  error estimate for blocks of size 2^( 6) =       0.001243420097
  error estimate for blocks of size 2^( 7) =       0.001248808624

      target function =                  N/A
              le_mean =     -16.719089622532
             les_mean =     282.054426620663
             stat err =       0.001237247006
             autocorr =       1.198873810581
              std dev =       1.598054628968
             le_variance =       2.553778597165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554407731651
                                         uncertainty =       0.041163627115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554407731651
                                         uncertainty =       0.041163627115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129999776
  error estimate for blocks of size 2^( 2) =       0.001168230121
  error estimate for blocks of size 2^( 3) =       0.001200742054
  error estimate for blocks of size 2^( 4) =       0.001223217223
  error estimate for blocks of size 2^( 5) =       0.001233373711
  error estimate for blocks of size 2^( 6) =       0.001243305355
  error estimate for blocks of size 2^( 7) =       0.001248699288

      target function =                  N/A
              le_mean =     -16.719089871830
             les_mean =     282.054381380362
             stat err =       0.001237148894
             autocorr =       1.198635753107
              std dev =       1.598086577391
             le_variance =       2.553880708837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719090373710        initial
     6.1035e-01     6.1035e+00             6.1867e-04       -16.719091583222  <--
     2.4414e+00     2.4414e+01             1.9284e-04       -16.719089622532
     9.7656e+00     9.7656e+01             5.1378e-05       -16.719089871830

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.3938e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832364e-02 3 1  ON 2
ci_0004                -4.654915e-02 3 1  ON 3
ci_0005                -4.519372e-02 3 1  ON 4
ci_0006                -4.445542e-02 3 1  ON 5
ci_0007                -3.107075e-02 3 1  ON 6
ci_0008                -3.156857e-02 3 1  ON 7
ci_0009                -3.223191e-02 3 1  ON 8
ci_0010                -3.088094e-02 3 1  ON 9
ci_0011                -2.797530e-02 3 1  ON 10
ci_0012                -2.620343e-02 3 1  ON 11
ci_0013                 2.731750e-02 3 1  ON 12
ci_0014                 2.581357e-02 3 1  ON 13
ci_0015                 2.739684e-02 3 1  ON 14
ci_0016                 2.623906e-02 3 1  ON 15
ci_0017                 2.474517e-02 3 1  ON 16
ci_0018                 2.356881e-02 3 1  ON 17
ci_0019                 1.974946e-02 3 1  ON 18
ci_0020                 1.928551e-02 3 1  ON 19
ci_0021                 1.920543e-02 3 1  ON 20
ci_0022                 1.827988e-02 3 1  ON 21
ci_0023                -1.952986e-02 3 1  ON 22
ci_0024                -1.798064e-02 3 1  ON 23
ci_0025                -1.982116e-02 3 1  ON 24
ci_0026                -1.793477e-02 3 1  ON 25
ci_0027                -1.762445e-02 3 1  ON 26
ci_0028                -1.699005e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639837e-02 3 1  ON 29
ci_0031                 1.492166e-02 3 1  ON 30
ci_0032                 1.379388e-02 3 1  ON 31
ci_0033                 1.771935e-02 3 1  ON 32
ci_0034                 1.525198e-02 3 1  ON 33
ci_0035                 1.751161e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546322e-02 3 1  ON 36
ci_0038                -1.407576e-02 3 1  ON 37
ci_0039                -1.580539e-02 3 1  ON 38
ci_0040                -1.502754e-02 3 1  ON 39
ci_0041                 1.593025e-02 3 1  ON 40
ci_0042                 1.602366e-02 3 1  ON 41
ci_0043                -1.557519e-02 3 1  ON 42
ci_0044                -1.526803e-02 3 1  ON 43
ci_0045                 1.455653e-02 3 1  ON 44
ci_0046                 1.488568e-02 3 1  ON 45
ci_0047                -1.481038e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321618e-02 3 1  ON 48
ci_0050                -1.301627e-02 3 1  ON 49
ci_0051                -1.291494e-02 3 1  ON 50
ci_0052                -1.258118e-02 3 1  ON 51
ci_0053                -1.311580e-02 3 1  ON 52
ci_0054                -1.246513e-02 3 1  ON 53
ci_0055                 1.224369e-02 3 1  ON 54
ci_0056                 1.302336e-02 3 1  ON 55
ci_0057                 1.354085e-02 3 1  ON 56
ci_0058                 1.206551e-02 3 1  ON 57
ci_0059                -1.338023e-02 3 1  ON 58
ci_0060                -1.268551e-02 3 1  ON 59
ci_0061                -1.297247e-02 3 1  ON 60
ci_0062                -1.259284e-02 3 1  ON 61
ci_0063                -1.198200e-02 3 1  ON 62
ci_0064                -1.109410e-02 3 1  ON 63
ci_0065                -1.219966e-02 3 1  ON 64
ci_0066                -1.123613e-02 3 1  ON 65
ci_0067                -1.122076e-02 3 1  ON 66
ci_0068                -1.093111e-02 3 1  ON 67
ci_0069                 1.096108e-02 3 1  ON 68
ci_0070                 1.053130e-02 3 1  ON 69
ci_0071                 9.801559e-03 3 1  ON 70
ci_0072                 1.001109e-02 3 1  ON 71
ci_0073                 1.103284e-02 3 1  ON 72
ci_0074                 1.093371e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0147e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6681e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9067
    reference variance = 1.80301
====================================================
  Execution time = 1.2957e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0271e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4931e+00
  Total weights = 1.945378454e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1744e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521906593595
                                         uncertainty =       0.029598963600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521906593595
                                         uncertainty =       0.029598963600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122874351
  error estimate for blocks of size 2^( 2) =       0.001161404245
  error estimate for blocks of size 2^( 3) =       0.001194028697
  error estimate for blocks of size 2^( 4) =       0.001219239769
  error estimate for blocks of size 2^( 5) =       0.001235655473
  error estimate for blocks of size 2^( 6) =       0.001242722856
  error estimate for blocks of size 2^( 7) =       0.001243212149

      target function =                  N/A
              le_mean =     -16.719086819469
             les_mean =     282.020923408585
             stat err =       0.001235207562
             autocorr =       1.210089687849
              std dev =       1.588009543509
             le_variance =       2.521774310275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671908681947e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719086818532       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719136617054       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719140100412       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719139630556       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.719139586547       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.719139610272       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e-01 is 1.896581e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719086818532       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719109193005       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719109650499       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719109593031       residual = 5.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 7.114735e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719086818532       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719093804419       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719093846415       residual = 7.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 2.030900e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089590 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6142e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.082367e-01 3 1  ON 0
ci_0002                 6.784140e-01 3 1  ON 1
ci_0003                -4.833054e-02 3 1  ON 2
ci_0004                -4.635403e-02 3 1  ON 3
ci_0005                -4.529632e-02 3 1  ON 4
ci_0006                -4.446784e-02 3 1  ON 5
ci_0007                -3.108862e-02 3 1  ON 6
ci_0008                -3.181906e-02 3 1  ON 7
ci_0009                -3.238928e-02 3 1  ON 8
ci_0010                -3.097294e-02 3 1  ON 9
ci_0011                -2.792154e-02 3 1  ON 10
ci_0012                -2.599425e-02 3 1  ON 11
ci_0013                 2.741372e-02 3 1  ON 12
ci_0014                 2.562882e-02 3 1  ON 13
ci_0015                 2.741636e-02 3 1  ON 14
ci_0016                 2.597020e-02 3 1  ON 15
ci_0017                 2.439052e-02 3 1  ON 16
ci_0018                 2.377235e-02 3 1  ON 17
ci_0019                 1.975288e-02 3 1  ON 18
ci_0020                 1.896632e-02 3 1  ON 19
ci_0021                 1.931795e-02 3 1  ON 20
ci_0022                 1.837301e-02 3 1  ON 21
ci_0023                -1.953817e-02 3 1  ON 22
ci_0024                -1.791896e-02 3 1  ON 23
ci_0025                -1.946807e-02 3 1  ON 24
ci_0026                -1.816229e-02 3 1  ON 25
ci_0027                -1.760760e-02 3 1  ON 26
ci_0028                -1.694423e-02 3 1  ON 27
ci_0029                -1.674755e-02 3 1  ON 28
ci_0030                -1.623559e-02 3 1  ON 29
ci_0031                 1.495540e-02 3 1  ON 30
ci_0032                 1.450535e-02 3 1  ON 31
ci_0033                 1.742732e-02 3 1  ON 32
ci_0034                 1.529304e-02 3 1  ON 33
ci_0035                 1.777005e-02 3 1  ON 34
ci_0036                 1.646597e-02 3 1  ON 35
ci_0037                -1.547545e-02 3 1  ON 36
ci_0038                -1.427578e-02 3 1  ON 37
ci_0039                -1.600983e-02 3 1  ON 38
ci_0040                -1.494259e-02 3 1  ON 39
ci_0041                 1.606775e-02 3 1  ON 40
ci_0042                 1.598825e-02 3 1  ON 41
ci_0043                -1.544240e-02 3 1  ON 42
ci_0044                -1.550668e-02 3 1  ON 43
ci_0045                 1.517577e-02 3 1  ON 44
ci_0046                 1.492842e-02 3 1  ON 45
ci_0047                -1.463307e-02 3 1  ON 46
ci_0048                -1.398502e-02 3 1  ON 47
ci_0049                -1.324123e-02 3 1  ON 48
ci_0050                -1.311201e-02 3 1  ON 49
ci_0051                -1.320845e-02 3 1  ON 50
ci_0052                -1.238306e-02 3 1  ON 51
ci_0053                -1.345454e-02 3 1  ON 52
ci_0054                -1.248210e-02 3 1  ON 53
ci_0055                 1.233920e-02 3 1  ON 54
ci_0056                 1.300070e-02 3 1  ON 55
ci_0057                 1.303202e-02 3 1  ON 56
ci_0058                 1.232388e-02 3 1  ON 57
ci_0059                -1.333845e-02 3 1  ON 58
ci_0060                -1.273660e-02 3 1  ON 59
ci_0061                -1.337846e-02 3 1  ON 60
ci_0062                -1.269354e-02 3 1  ON 61
ci_0063                -1.199493e-02 3 1  ON 62
ci_0064                -1.094584e-02 3 1  ON 63
ci_0065                -1.193588e-02 3 1  ON 64
ci_0066                -1.145406e-02 3 1  ON 65
ci_0067                -1.127299e-02 3 1  ON 66
ci_0068                -1.097965e-02 3 1  ON 67
ci_0069                 1.081860e-02 3 1  ON 68
ci_0070                 1.031732e-02 3 1  ON 69
ci_0071                 9.758395e-03 3 1  ON 70
ci_0072                 9.814570e-03 3 1  ON 71
ci_0073                 1.095591e-02 3 1  ON 72
ci_0074                 1.070858e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8447
    reference variance = 1.53229
====================================================
  Execution time = 1.2649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5576e+00
  Total weights = 1.9454e+06
  Execution time = 2.2138e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582370978003
                                         uncertainty =       0.039289232628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582370978003
                                         uncertainty =       0.039289232628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137072669
  error estimate for blocks of size 2^( 2) =       0.001175813692
  error estimate for blocks of size 2^( 3) =       0.001209204914
  error estimate for blocks of size 2^( 4) =       0.001232615986
  error estimate for blocks of size 2^( 5) =       0.001244990709
  error estimate for blocks of size 2^( 6) =       0.001254336264
  error estimate for blocks of size 2^( 7) =       0.001255437568

      target function =                  N/A
              le_mean =     -16.716994749687
             les_mean =     282.069655998220
             stat err =       0.001246845132
             autocorr =       1.202398943742
              std dev =       1.608089319191
             le_variance =       2.585951258497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582949337740
                                         uncertainty =       0.039290662883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582949337740
                                         uncertainty =       0.039290662883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137200964
  error estimate for blocks of size 2^( 2) =       0.001175933062
  error estimate for blocks of size 2^( 3) =       0.001209286989
  error estimate for blocks of size 2^( 4) =       0.001232675059
  error estimate for blocks of size 2^( 5) =       0.001245033278
  error estimate for blocks of size 2^( 6) =       0.001254476032
  error estimate for blocks of size 2^( 7) =       0.001255641018

      target function =                  N/A
              le_mean =     -16.716986818483
             les_mean =     282.026628960844
             stat err =       0.001246956346
             autocorr =       1.202342120976
              std dev =       1.608270757743
             le_variance =       2.586534830212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582849935284
                                         uncertainty =       0.039290625538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582849935284
                                         uncertainty =       0.039290625538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137178942
  error estimate for blocks of size 2^( 2) =       0.001175915636
  error estimate for blocks of size 2^( 3) =       0.001209279862
  error estimate for blocks of size 2^( 4) =       0.001232673254
  error estimate for blocks of size 2^( 5) =       0.001245032164
  error estimate for blocks of size 2^( 6) =       0.001254469134
  error estimate for blocks of size 2^( 7) =       0.001255625691

      target function =                  N/A
              le_mean =     -16.716984283131
             les_mean =     282.036871210703
             stat err =       0.001246950061
             autocorr =       1.202376567424
              std dev =       1.608239613342
             le_variance =       2.586434653923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582353458425
                                         uncertainty =       0.039291062153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582353458425
                                         uncertainty =       0.039291062153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137069045
  error estimate for blocks of size 2^( 2) =       0.001175807061
  error estimate for blocks of size 2^( 3) =       0.001209200926
  error estimate for blocks of size 2^( 4) =       0.001232603605
  error estimate for blocks of size 2^( 5) =       0.001244963112
  error estimate for blocks of size 2^( 6) =       0.001254383564
  error estimate for blocks of size 2^( 7) =       0.001255516178

      target function =                  N/A
              le_mean =     -16.716987268638
             les_mean =     282.029093775856
             stat err =       0.001246866615
             autocorr =       1.202448042755
              std dev =       1.608084194090
             le_variance =       2.585934775281


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716994749687        initial  <--
     1.5259e-01     1.5259e+00             1.8966e-03       -16.716986818483
     6.1035e-01     6.1035e+00             7.1147e-04       -16.716984283131
     2.4414e+00     2.4414e+01             2.0309e-04       -16.716987268638

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8575
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832364e-02 3 1  ON 2
ci_0004                -4.654915e-02 3 1  ON 3
ci_0005                -4.519372e-02 3 1  ON 4
ci_0006                -4.445542e-02 3 1  ON 5
ci_0007                -3.107075e-02 3 1  ON 6
ci_0008                -3.156857e-02 3 1  ON 7
ci_0009                -3.223191e-02 3 1  ON 8
ci_0010                -3.088094e-02 3 1  ON 9
ci_0011                -2.797530e-02 3 1  ON 10
ci_0012                -2.620343e-02 3 1  ON 11
ci_0013                 2.731750e-02 3 1  ON 12
ci_0014                 2.581357e-02 3 1  ON 13
ci_0015                 2.739684e-02 3 1  ON 14
ci_0016                 2.623906e-02 3 1  ON 15
ci_0017                 2.474517e-02 3 1  ON 16
ci_0018                 2.356881e-02 3 1  ON 17
ci_0019                 1.974946e-02 3 1  ON 18
ci_0020                 1.928551e-02 3 1  ON 19
ci_0021                 1.920543e-02 3 1  ON 20
ci_0022                 1.827988e-02 3 1  ON 21
ci_0023                -1.952986e-02 3 1  ON 22
ci_0024                -1.798064e-02 3 1  ON 23
ci_0025                -1.982116e-02 3 1  ON 24
ci_0026                -1.793477e-02 3 1  ON 25
ci_0027                -1.762445e-02 3 1  ON 26
ci_0028                -1.699005e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639837e-02 3 1  ON 29
ci_0031                 1.492166e-02 3 1  ON 30
ci_0032                 1.379388e-02 3 1  ON 31
ci_0033                 1.771935e-02 3 1  ON 32
ci_0034                 1.525198e-02 3 1  ON 33
ci_0035                 1.751161e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546322e-02 3 1  ON 36
ci_0038                -1.407576e-02 3 1  ON 37
ci_0039                -1.580539e-02 3 1  ON 38
ci_0040                -1.502754e-02 3 1  ON 39
ci_0041                 1.593025e-02 3 1  ON 40
ci_0042                 1.602366e-02 3 1  ON 41
ci_0043                -1.557519e-02 3 1  ON 42
ci_0044                -1.526803e-02 3 1  ON 43
ci_0045                 1.455653e-02 3 1  ON 44
ci_0046                 1.488568e-02 3 1  ON 45
ci_0047                -1.481038e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321618e-02 3 1  ON 48
ci_0050                -1.301627e-02 3 1  ON 49
ci_0051                -1.291494e-02 3 1  ON 50
ci_0052                -1.258118e-02 3 1  ON 51
ci_0053                -1.311580e-02 3 1  ON 52
ci_0054                -1.246513e-02 3 1  ON 53
ci_0055                 1.224369e-02 3 1  ON 54
ci_0056                 1.302336e-02 3 1  ON 55
ci_0057                 1.354085e-02 3 1  ON 56
ci_0058                 1.206551e-02 3 1  ON 57
ci_0059                -1.338023e-02 3 1  ON 58
ci_0060                -1.268551e-02 3 1  ON 59
ci_0061                -1.297247e-02 3 1  ON 60
ci_0062                -1.259284e-02 3 1  ON 61
ci_0063                -1.198200e-02 3 1  ON 62
ci_0064                -1.109410e-02 3 1  ON 63
ci_0065                -1.219966e-02 3 1  ON 64
ci_0066                -1.123613e-02 3 1  ON 65
ci_0067                -1.122076e-02 3 1  ON 66
ci_0068                -1.093111e-02 3 1  ON 67
ci_0069                 1.096108e-02 3 1  ON 68
ci_0070                 1.053130e-02 3 1  ON 69
ci_0071                 9.801559e-03 3 1  ON 70
ci_0072                 1.001109e-02 3 1  ON 71
ci_0073                 1.103284e-02 3 1  ON 72
ci_0074                 1.093371e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6694e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.5298
    reference variance = 2.91078
====================================================
  Execution time = 1.2948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0279e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5585e+00
  Total weights = 1.945901997e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1686e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588721937582
                                         uncertainty =       0.059053311022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.588721937582
                                         uncertainty =       0.059053311022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137565157
  error estimate for blocks of size 2^( 2) =       0.001174993810
  error estimate for blocks of size 2^( 3) =       0.001207317537
  error estimate for blocks of size 2^( 4) =       0.001228797586
  error estimate for blocks of size 2^( 5) =       0.001242238283
  error estimate for blocks of size 2^( 6) =       0.001251847770
  error estimate for blocks of size 2^( 7) =       0.001259997644

      target function =                  N/A
              le_mean =     -16.718998984235
             les_mean =     282.083451478101
             stat err =       0.001245720321
             autocorr =       1.199191481401
              std dev =       1.608785813552
             le_variance =       2.588191793886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671899898424e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718998983316       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719006618599       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719006505366       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+00 is 2.575490e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718998983316       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719001085342       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719001089461       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+00 is 7.171553e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718998983316       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718999522465       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718999526210       residual = 9.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+01 is 1.845817e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6127e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.083944e-01 3 1  ON 0
ci_0002                 6.782752e-01 3 1  ON 1
ci_0003                -4.829679e-02 3 1  ON 2
ci_0004                -4.649733e-02 3 1  ON 3
ci_0005                -4.518454e-02 3 1  ON 4
ci_0006                -4.447787e-02 3 1  ON 5
ci_0007                -3.108686e-02 3 1  ON 6
ci_0008                -3.157927e-02 3 1  ON 7
ci_0009                -3.223461e-02 3 1  ON 8
ci_0010                -3.088367e-02 3 1  ON 9
ci_0011                -2.793825e-02 3 1  ON 10
ci_0012                -2.625799e-02 3 1  ON 11
ci_0013                 2.734515e-02 3 1  ON 12
ci_0014                 2.583530e-02 3 1  ON 13
ci_0015                 2.738360e-02 3 1  ON 14
ci_0016                 2.626244e-02 3 1  ON 15
ci_0017                 2.467345e-02 3 1  ON 16
ci_0018                 2.358229e-02 3 1  ON 17
ci_0019                 1.976550e-02 3 1  ON 18
ci_0020                 1.926792e-02 3 1  ON 19
ci_0021                 1.921144e-02 3 1  ON 20
ci_0022                 1.825773e-02 3 1  ON 21
ci_0023                -1.952513e-02 3 1  ON 22
ci_0024                -1.793447e-02 3 1  ON 23
ci_0025                -1.975059e-02 3 1  ON 24
ci_0026                -1.793658e-02 3 1  ON 25
ci_0027                -1.761933e-02 3 1  ON 26
ci_0028                -1.701261e-02 3 1  ON 27
ci_0029                -1.653273e-02 3 1  ON 28
ci_0030                -1.638114e-02 3 1  ON 29
ci_0031                 1.495879e-02 3 1  ON 30
ci_0032                 1.383664e-02 3 1  ON 31
ci_0033                 1.766849e-02 3 1  ON 32
ci_0034                 1.526571e-02 3 1  ON 33
ci_0035                 1.755483e-02 3 1  ON 34
ci_0036                 1.625418e-02 3 1  ON 35
ci_0037                -1.549505e-02 3 1  ON 36
ci_0038                -1.410779e-02 3 1  ON 37
ci_0039                -1.582935e-02 3 1  ON 38
ci_0040                -1.500567e-02 3 1  ON 39
ci_0041                 1.593462e-02 3 1  ON 40
ci_0042                 1.599403e-02 3 1  ON 41
ci_0043                -1.561036e-02 3 1  ON 42
ci_0044                -1.527136e-02 3 1  ON 43
ci_0045                 1.452271e-02 3 1  ON 44
ci_0046                 1.489856e-02 3 1  ON 45
ci_0047                -1.481190e-02 3 1  ON 46
ci_0048                -1.410989e-02 3 1  ON 47
ci_0049                -1.319623e-02 3 1  ON 48
ci_0050                -1.297853e-02 3 1  ON 49
ci_0051                -1.293368e-02 3 1  ON 50
ci_0052                -1.253342e-02 3 1  ON 51
ci_0053                -1.308423e-02 3 1  ON 52
ci_0054                -1.247360e-02 3 1  ON 53
ci_0055                 1.225729e-02 3 1  ON 54
ci_0056                 1.302995e-02 3 1  ON 55
ci_0057                 1.354442e-02 3 1  ON 56
ci_0058                 1.206003e-02 3 1  ON 57
ci_0059                -1.336692e-02 3 1  ON 58
ci_0060                -1.271668e-02 3 1  ON 59
ci_0061                -1.299724e-02 3 1  ON 60
ci_0062                -1.257034e-02 3 1  ON 61
ci_0063                -1.194882e-02 3 1  ON 62
ci_0064                -1.107694e-02 3 1  ON 63
ci_0065                -1.219511e-02 3 1  ON 64
ci_0066                -1.124329e-02 3 1  ON 65
ci_0067                -1.120226e-02 3 1  ON 66
ci_0068                -1.094215e-02 3 1  ON 67
ci_0069                 1.096364e-02 3 1  ON 68
ci_0070                 1.054442e-02 3 1  ON 69
ci_0071                 9.840164e-03 3 1  ON 70
ci_0072                 1.000696e-02 3 1  ON 71
ci_0073                 1.103458e-02 3 1  ON 72
ci_0074                 1.095386e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8361
    reference variance = 2.14208
====================================================
  Execution time = 1.2744e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5071e+00
  Total weights = 1.9457e+06
  Execution time = 2.2084e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533699856704
                                         uncertainty =       0.023322007181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533699856704
                                         uncertainty =       0.023322007181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125418637
  error estimate for blocks of size 2^( 2) =       0.001164114989
  error estimate for blocks of size 2^( 3) =       0.001196914899
  error estimate for blocks of size 2^( 4) =       0.001220943070
  error estimate for blocks of size 2^( 5) =       0.001235576996
  error estimate for blocks of size 2^( 6) =       0.001243765022
  error estimate for blocks of size 2^( 7) =       0.001244467870

      target function =                  N/A
              le_mean =     -16.717307715501
             les_mean =     281.976677612187
             stat err =       0.001236188239
             autocorr =       1.206538013170
              std dev =       1.591607765321
             le_variance =       2.533215278631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533701614895
                                         uncertainty =       0.023321631605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533701614895
                                         uncertainty =       0.023321631605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125419030
  error estimate for blocks of size 2^( 2) =       0.001164118912
  error estimate for blocks of size 2^( 3) =       0.001196919068
  error estimate for blocks of size 2^( 4) =       0.001220944982
  error estimate for blocks of size 2^( 5) =       0.001235573835
  error estimate for blocks of size 2^( 6) =       0.001243758452
  error estimate for blocks of size 2^( 7) =       0.001244443856

      target function =                  N/A
              le_mean =     -16.717306590371
             les_mean =     281.979631205067
             stat err =       0.001236180281
             autocorr =       1.206521635618
              std dev =       1.591608320993
             le_variance =       2.533217047453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533693554842
                                         uncertainty =       0.023322184365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533693554842
                                         uncertainty =       0.023322184365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125417239
  error estimate for blocks of size 2^( 2) =       0.001164115933
  error estimate for blocks of size 2^( 3) =       0.001196917194
  error estimate for blocks of size 2^( 4) =       0.001220944750
  error estimate for blocks of size 2^( 5) =       0.001235578057
  error estimate for blocks of size 2^( 6) =       0.001243763263
  error estimate for blocks of size 2^( 7) =       0.001244458297

      target function =                  N/A
              le_mean =     -16.717307426570
             les_mean =     281.975742198455
             stat err =       0.001236186092
             autocorr =       1.206536817656
              std dev =       1.591605788436
             le_variance =       2.533208985782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533698580422
                                         uncertainty =       0.023322029021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.533698580422
                                         uncertainty =       0.023322029021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125418354
  error estimate for blocks of size 2^( 2) =       0.001164114980
  error estimate for blocks of size 2^( 3) =       0.001196915122
  error estimate for blocks of size 2^( 4) =       0.001220943236
  error estimate for blocks of size 2^( 5) =       0.001235576959
  error estimate for blocks of size 2^( 6) =       0.001243764412
  error estimate for blocks of size 2^( 7) =       0.001244465963

      target function =                  N/A
              le_mean =     -16.717307556406
             les_mean =     281.976045132155
             stat err =       0.001236187643
             autocorr =       1.206537455119
              std dev =       1.591607364866
             le_variance =       2.533214003896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717307715501        initial  <--
     1.5259e+00     1.5259e+01             2.5755e-04       -16.717306590371
     6.1035e+00     6.1035e+01             7.1716e-05       -16.717307426570
     2.4414e+01     2.4414e+02             1.8458e-05       -16.717307556406

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9150
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832364e-02 3 1  ON 2
ci_0004                -4.654915e-02 3 1  ON 3
ci_0005                -4.519372e-02 3 1  ON 4
ci_0006                -4.445542e-02 3 1  ON 5
ci_0007                -3.107075e-02 3 1  ON 6
ci_0008                -3.156857e-02 3 1  ON 7
ci_0009                -3.223191e-02 3 1  ON 8
ci_0010                -3.088094e-02 3 1  ON 9
ci_0011                -2.797530e-02 3 1  ON 10
ci_0012                -2.620343e-02 3 1  ON 11
ci_0013                 2.731750e-02 3 1  ON 12
ci_0014                 2.581357e-02 3 1  ON 13
ci_0015                 2.739684e-02 3 1  ON 14
ci_0016                 2.623906e-02 3 1  ON 15
ci_0017                 2.474517e-02 3 1  ON 16
ci_0018                 2.356881e-02 3 1  ON 17
ci_0019                 1.974946e-02 3 1  ON 18
ci_0020                 1.928551e-02 3 1  ON 19
ci_0021                 1.920543e-02 3 1  ON 20
ci_0022                 1.827988e-02 3 1  ON 21
ci_0023                -1.952986e-02 3 1  ON 22
ci_0024                -1.798064e-02 3 1  ON 23
ci_0025                -1.982116e-02 3 1  ON 24
ci_0026                -1.793477e-02 3 1  ON 25
ci_0027                -1.762445e-02 3 1  ON 26
ci_0028                -1.699005e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639837e-02 3 1  ON 29
ci_0031                 1.492166e-02 3 1  ON 30
ci_0032                 1.379388e-02 3 1  ON 31
ci_0033                 1.771935e-02 3 1  ON 32
ci_0034                 1.525198e-02 3 1  ON 33
ci_0035                 1.751161e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546322e-02 3 1  ON 36
ci_0038                -1.407576e-02 3 1  ON 37
ci_0039                -1.580539e-02 3 1  ON 38
ci_0040                -1.502754e-02 3 1  ON 39
ci_0041                 1.593025e-02 3 1  ON 40
ci_0042                 1.602366e-02 3 1  ON 41
ci_0043                -1.557519e-02 3 1  ON 42
ci_0044                -1.526803e-02 3 1  ON 43
ci_0045                 1.455653e-02 3 1  ON 44
ci_0046                 1.488568e-02 3 1  ON 45
ci_0047                -1.481038e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321618e-02 3 1  ON 48
ci_0050                -1.301627e-02 3 1  ON 49
ci_0051                -1.291494e-02 3 1  ON 50
ci_0052                -1.258118e-02 3 1  ON 51
ci_0053                -1.311580e-02 3 1  ON 52
ci_0054                -1.246513e-02 3 1  ON 53
ci_0055                 1.224369e-02 3 1  ON 54
ci_0056                 1.302336e-02 3 1  ON 55
ci_0057                 1.354085e-02 3 1  ON 56
ci_0058                 1.206551e-02 3 1  ON 57
ci_0059                -1.338023e-02 3 1  ON 58
ci_0060                -1.268551e-02 3 1  ON 59
ci_0061                -1.297247e-02 3 1  ON 60
ci_0062                -1.259284e-02 3 1  ON 61
ci_0063                -1.198200e-02 3 1  ON 62
ci_0064                -1.109410e-02 3 1  ON 63
ci_0065                -1.219966e-02 3 1  ON 64
ci_0066                -1.123613e-02 3 1  ON 65
ci_0067                -1.122076e-02 3 1  ON 66
ci_0068                -1.093111e-02 3 1  ON 67
ci_0069                 1.096108e-02 3 1  ON 68
ci_0070                 1.053130e-02 3 1  ON 69
ci_0071                 9.801559e-03 3 1  ON 70
ci_0072                 1.001109e-02 3 1  ON 71
ci_0073                 1.103284e-02 3 1  ON 72
ci_0074                 1.093371e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0056e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6694e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.684
    reference variance = 1.76482
====================================================
  Execution time = 1.3032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0270e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5652e+00
  Total weights = 1.945908813e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1961e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.591303795305
                                         uncertainty =       0.057648766488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.591303795305
                                         uncertainty =       0.057648766488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138106478
  error estimate for blocks of size 2^( 2) =       0.001176728990
  error estimate for blocks of size 2^( 3) =       0.001209570271
  error estimate for blocks of size 2^( 4) =       0.001231989968
  error estimate for blocks of size 2^( 5) =       0.001245722683
  error estimate for blocks of size 2^( 6) =       0.001255919007
  error estimate for blocks of size 2^( 7) =       0.001258495474

      target function =                  N/A
              le_mean =     -16.720154972299
             les_mean =     282.128782744001
             stat err =       0.001248031783
             autocorr =       1.202501150232
              std dev =       1.609551368590
             le_variance =       2.590655608130


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672015497230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720154971385       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720155673190       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720155683839       residual = 3.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+01 is 3.596268e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720154971385       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720155148832       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720155151198       residual = 3.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+01 is 9.097820e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720154971385       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720155015873       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720155016446       residual = 3.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+02 is 2.281267e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095861 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6239e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.084128e-01 3 1  ON 0
ci_0002                 6.782531e-01 3 1  ON 1
ci_0003                -4.832290e-02 3 1  ON 2
ci_0004                -4.654780e-02 3 1  ON 3
ci_0005                -4.519866e-02 3 1  ON 4
ci_0006                -4.445343e-02 3 1  ON 5
ci_0007                -3.107432e-02 3 1  ON 6
ci_0008                -3.157193e-02 3 1  ON 7
ci_0009                -3.222721e-02 3 1  ON 8
ci_0010                -3.087944e-02 3 1  ON 9
ci_0011                -2.797242e-02 3 1  ON 10
ci_0012                -2.620591e-02 3 1  ON 11
ci_0013                 2.731453e-02 3 1  ON 12
ci_0014                 2.581217e-02 3 1  ON 13
ci_0015                 2.739645e-02 3 1  ON 14
ci_0016                 2.623875e-02 3 1  ON 15
ci_0017                 2.474416e-02 3 1  ON 16
ci_0018                 2.356460e-02 3 1  ON 17
ci_0019                 1.975053e-02 3 1  ON 18
ci_0020                 1.928182e-02 3 1  ON 19
ci_0021                 1.920282e-02 3 1  ON 20
ci_0022                 1.828325e-02 3 1  ON 21
ci_0023                -1.952726e-02 3 1  ON 22
ci_0024                -1.798131e-02 3 1  ON 23
ci_0025                -1.981940e-02 3 1  ON 24
ci_0026                -1.793767e-02 3 1  ON 25
ci_0027                -1.762328e-02 3 1  ON 26
ci_0028                -1.698900e-02 3 1  ON 27
ci_0029                -1.653731e-02 3 1  ON 28
ci_0030                -1.639623e-02 3 1  ON 29
ci_0031                 1.491985e-02 3 1  ON 30
ci_0032                 1.379513e-02 3 1  ON 31
ci_0033                 1.771774e-02 3 1  ON 32
ci_0034                 1.525091e-02 3 1  ON 33
ci_0035                 1.750895e-02 3 1  ON 34
ci_0036                 1.622206e-02 3 1  ON 35
ci_0037                -1.546430e-02 3 1  ON 36
ci_0038                -1.407715e-02 3 1  ON 37
ci_0039                -1.580515e-02 3 1  ON 38
ci_0040                -1.502599e-02 3 1  ON 39
ci_0041                 1.592925e-02 3 1  ON 40
ci_0042                 1.601956e-02 3 1  ON 41
ci_0043                -1.557539e-02 3 1  ON 42
ci_0044                -1.526323e-02 3 1  ON 43
ci_0045                 1.455727e-02 3 1  ON 44
ci_0046                 1.488552e-02 3 1  ON 45
ci_0047                -1.480626e-02 3 1  ON 46
ci_0048                -1.411751e-02 3 1  ON 47
ci_0049                -1.321701e-02 3 1  ON 48
ci_0050                -1.301989e-02 3 1  ON 49
ci_0051                -1.291793e-02 3 1  ON 50
ci_0052                -1.258232e-02 3 1  ON 51
ci_0053                -1.311560e-02 3 1  ON 52
ci_0054                -1.246360e-02 3 1  ON 53
ci_0055                 1.224853e-02 3 1  ON 54
ci_0056                 1.302512e-02 3 1  ON 55
ci_0057                 1.354060e-02 3 1  ON 56
ci_0058                 1.206198e-02 3 1  ON 57
ci_0059                -1.337544e-02 3 1  ON 58
ci_0060                -1.268321e-02 3 1  ON 59
ci_0061                -1.297352e-02 3 1  ON 60
ci_0062                -1.259175e-02 3 1  ON 61
ci_0063                -1.198242e-02 3 1  ON 62
ci_0064                -1.109515e-02 3 1  ON 63
ci_0065                -1.219908e-02 3 1  ON 64
ci_0066                -1.123641e-02 3 1  ON 65
ci_0067                -1.122261e-02 3 1  ON 66
ci_0068                -1.093348e-02 3 1  ON 67
ci_0069                 1.096260e-02 3 1  ON 68
ci_0070                 1.053063e-02 3 1  ON 69
ci_0071                 9.802493e-03 3 1  ON 70
ci_0072                 1.000921e-02 3 1  ON 71
ci_0073                 1.102983e-02 3 1  ON 72
ci_0074                 1.092866e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.4553
    reference variance = 3.35904
====================================================
  Execution time = 1.2712e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5144e+00
  Total weights = 1.9458e+06
  Execution time = 2.2265e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540580380735
                                         uncertainty =       0.022147970563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540580380735
                                         uncertainty =       0.022147970563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126968770
  error estimate for blocks of size 2^( 2) =       0.001165693916
  error estimate for blocks of size 2^( 3) =       0.001198976067
  error estimate for blocks of size 2^( 4) =       0.001219929615
  error estimate for blocks of size 2^( 5) =       0.001234705966
  error estimate for blocks of size 2^( 6) =       0.001238447579
  error estimate for blocks of size 2^( 7) =       0.001251222800

      target function =                  N/A
              le_mean =     -16.716447064621
             les_mean =     281.953996065983
             stat err =       0.001236076490
             autocorr =       1.203003609019
              std dev =       1.593800018869
             le_variance =       2.540198500148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540581035559
                                         uncertainty =       0.022148071779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540581035559
                                         uncertainty =       0.022148071779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126968912
  error estimate for blocks of size 2^( 2) =       0.001165695837
  error estimate for blocks of size 2^( 3) =       0.001198980013
  error estimate for blocks of size 2^( 4) =       0.001219934430
  error estimate for blocks of size 2^( 5) =       0.001234711689
  error estimate for blocks of size 2^( 6) =       0.001238454311
  error estimate for blocks of size 2^( 7) =       0.001251228759

      target function =                  N/A
              le_mean =     -16.716447040250
             les_mean =     281.953952779736
             stat err =       0.001236082297
             autocorr =       1.203014609635
              std dev =       1.593800219738
             le_variance =       2.540199140437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540580634448
                                         uncertainty =       0.022148022251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540580634448
                                         uncertainty =       0.022148022251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126968825
  error estimate for blocks of size 2^( 2) =       0.001165694877
  error estimate for blocks of size 2^( 3) =       0.001198978059
  error estimate for blocks of size 2^( 4) =       0.001219932049
  error estimate for blocks of size 2^( 5) =       0.001234708866
  error estimate for blocks of size 2^( 6) =       0.001238450998
  error estimate for blocks of size 2^( 7) =       0.001251225839

      target function =                  N/A
              le_mean =     -16.716447043747
             les_mean =     281.953980170919
             stat err =       0.001236079438
             autocorr =       1.203009230713
              std dev =       1.593800096187
             le_variance =       2.540198746606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540580406636
                                         uncertainty =       0.022147977077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.540580406636
                                         uncertainty =       0.022147977077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126968775
  error estimate for blocks of size 2^( 2) =       0.001165694035
  error estimate for blocks of size 2^( 3) =       0.001198976316
  error estimate for blocks of size 2^( 4) =       0.001219929919
  error estimate for blocks of size 2^( 5) =       0.001234706328
  error estimate for blocks of size 2^( 6) =       0.001238448006
  error estimate for blocks of size 2^( 7) =       0.001251223178

      target function =                  N/A
              le_mean =     -16.716447061652
             les_mean =     281.953993467727
             stat err =       0.001236076858
             autocorr =       1.203004312761
              std dev =       1.593800026712
             le_variance =       2.540198525146


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716447064621        initial  <--
     1.5259e+01     1.5259e+02             3.5963e-05       -16.716447040250
     6.1035e+01     6.1035e+02             9.0978e-06       -16.716447043747
     2.4414e+02     2.4414e+03             2.2813e-06       -16.716447061652

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9833
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832364e-02 3 1  ON 2
ci_0004                -4.654915e-02 3 1  ON 3
ci_0005                -4.519372e-02 3 1  ON 4
ci_0006                -4.445542e-02 3 1  ON 5
ci_0007                -3.107075e-02 3 1  ON 6
ci_0008                -3.156857e-02 3 1  ON 7
ci_0009                -3.223191e-02 3 1  ON 8
ci_0010                -3.088094e-02 3 1  ON 9
ci_0011                -2.797530e-02 3 1  ON 10
ci_0012                -2.620343e-02 3 1  ON 11
ci_0013                 2.731750e-02 3 1  ON 12
ci_0014                 2.581357e-02 3 1  ON 13
ci_0015                 2.739684e-02 3 1  ON 14
ci_0016                 2.623906e-02 3 1  ON 15
ci_0017                 2.474517e-02 3 1  ON 16
ci_0018                 2.356881e-02 3 1  ON 17
ci_0019                 1.974946e-02 3 1  ON 18
ci_0020                 1.928551e-02 3 1  ON 19
ci_0021                 1.920543e-02 3 1  ON 20
ci_0022                 1.827988e-02 3 1  ON 21
ci_0023                -1.952986e-02 3 1  ON 22
ci_0024                -1.798064e-02 3 1  ON 23
ci_0025                -1.982116e-02 3 1  ON 24
ci_0026                -1.793477e-02 3 1  ON 25
ci_0027                -1.762445e-02 3 1  ON 26
ci_0028                -1.699005e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639837e-02 3 1  ON 29
ci_0031                 1.492166e-02 3 1  ON 30
ci_0032                 1.379388e-02 3 1  ON 31
ci_0033                 1.771935e-02 3 1  ON 32
ci_0034                 1.525198e-02 3 1  ON 33
ci_0035                 1.751161e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546322e-02 3 1  ON 36
ci_0038                -1.407576e-02 3 1  ON 37
ci_0039                -1.580539e-02 3 1  ON 38
ci_0040                -1.502754e-02 3 1  ON 39
ci_0041                 1.593025e-02 3 1  ON 40
ci_0042                 1.602366e-02 3 1  ON 41
ci_0043                -1.557519e-02 3 1  ON 42
ci_0044                -1.526803e-02 3 1  ON 43
ci_0045                 1.455653e-02 3 1  ON 44
ci_0046                 1.488568e-02 3 1  ON 45
ci_0047                -1.481038e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321618e-02 3 1  ON 48
ci_0050                -1.301627e-02 3 1  ON 49
ci_0051                -1.291494e-02 3 1  ON 50
ci_0052                -1.258118e-02 3 1  ON 51
ci_0053                -1.311580e-02 3 1  ON 52
ci_0054                -1.246513e-02 3 1  ON 53
ci_0055                 1.224369e-02 3 1  ON 54
ci_0056                 1.302336e-02 3 1  ON 55
ci_0057                 1.354085e-02 3 1  ON 56
ci_0058                 1.206551e-02 3 1  ON 57
ci_0059                -1.338023e-02 3 1  ON 58
ci_0060                -1.268551e-02 3 1  ON 59
ci_0061                -1.297247e-02 3 1  ON 60
ci_0062                -1.259284e-02 3 1  ON 61
ci_0063                -1.198200e-02 3 1  ON 62
ci_0064                -1.109410e-02 3 1  ON 63
ci_0065                -1.219966e-02 3 1  ON 64
ci_0066                -1.123613e-02 3 1  ON 65
ci_0067                -1.122076e-02 3 1  ON 66
ci_0068                -1.093111e-02 3 1  ON 67
ci_0069                 1.096108e-02 3 1  ON 68
ci_0070                 1.053130e-02 3 1  ON 69
ci_0071                 9.801559e-03 3 1  ON 70
ci_0072                 1.001109e-02 3 1  ON 71
ci_0073                 1.103284e-02 3 1  ON 72
ci_0074                 1.093371e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0233e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6686e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.0741
    reference variance = 1.68643
====================================================
  Execution time = 1.2976e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0269e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5196e+00
  Total weights = 1.946022679e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1743e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.543576903490
                                         uncertainty =       0.020690762075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.543576903490
                                         uncertainty =       0.020690762075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128368370
  error estimate for blocks of size 2^( 2) =       0.001166051436
  error estimate for blocks of size 2^( 3) =       0.001198187228
  error estimate for blocks of size 2^( 4) =       0.001221904425
  error estimate for blocks of size 2^( 5) =       0.001235158136
  error estimate for blocks of size 2^( 6) =       0.001242907385
  error estimate for blocks of size 2^( 7) =       0.001242095756

      target function =                  N/A
              le_mean =     -16.716775114384
             les_mean =     281.970202047516
             stat err =       0.001235516425
             autocorr =       1.198933898488
              std dev =       1.595779384169
             le_variance =       2.546511842938


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671677511438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716775113461       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716775234873       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716775235273       residual = 3.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 3.027939e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716775113461       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716775143850       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716775143956       residual = 3.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 7.583064e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716775113461       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716775121061       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716775121088       residual = 3.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+03 is 1.896594e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6156e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.084086e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832377e-02 3 1  ON 2
ci_0004                -4.654893e-02 3 1  ON 3
ci_0005                -4.519392e-02 3 1  ON 4
ci_0006                -4.445511e-02 3 1  ON 5
ci_0007                -3.107096e-02 3 1  ON 6
ci_0008                -3.156846e-02 3 1  ON 7
ci_0009                -3.223179e-02 3 1  ON 8
ci_0010                -3.088111e-02 3 1  ON 9
ci_0011                -2.797463e-02 3 1  ON 10
ci_0012                -2.620366e-02 3 1  ON 11
ci_0013                 2.731742e-02 3 1  ON 12
ci_0014                 2.581404e-02 3 1  ON 13
ci_0015                 2.739686e-02 3 1  ON 14
ci_0016                 2.623922e-02 3 1  ON 15
ci_0017                 2.474530e-02 3 1  ON 16
ci_0018                 2.356876e-02 3 1  ON 17
ci_0019                 1.974943e-02 3 1  ON 18
ci_0020                 1.928537e-02 3 1  ON 19
ci_0021                 1.920569e-02 3 1  ON 20
ci_0022                 1.828000e-02 3 1  ON 21
ci_0023                -1.952970e-02 3 1  ON 22
ci_0024                -1.798054e-02 3 1  ON 23
ci_0025                -1.982042e-02 3 1  ON 24
ci_0026                -1.793479e-02 3 1  ON 25
ci_0027                -1.762493e-02 3 1  ON 26
ci_0028                -1.699044e-02 3 1  ON 27
ci_0029                -1.654592e-02 3 1  ON 28
ci_0030                -1.639813e-02 3 1  ON 29
ci_0031                 1.492196e-02 3 1  ON 30
ci_0032                 1.379388e-02 3 1  ON 31
ci_0033                 1.771934e-02 3 1  ON 32
ci_0034                 1.525195e-02 3 1  ON 33
ci_0035                 1.751217e-02 3 1  ON 34
ci_0036                 1.622202e-02 3 1  ON 35
ci_0037                -1.546331e-02 3 1  ON 36
ci_0038                -1.407605e-02 3 1  ON 37
ci_0039                -1.580548e-02 3 1  ON 38
ci_0040                -1.502774e-02 3 1  ON 39
ci_0041                 1.593048e-02 3 1  ON 40
ci_0042                 1.602301e-02 3 1  ON 41
ci_0043                -1.557483e-02 3 1  ON 42
ci_0044                -1.526776e-02 3 1  ON 43
ci_0045                 1.455685e-02 3 1  ON 44
ci_0046                 1.488600e-02 3 1  ON 45
ci_0047                -1.481022e-02 3 1  ON 46
ci_0048                -1.411506e-02 3 1  ON 47
ci_0049                -1.321597e-02 3 1  ON 48
ci_0050                -1.301613e-02 3 1  ON 49
ci_0051                -1.291513e-02 3 1  ON 50
ci_0052                -1.258099e-02 3 1  ON 51
ci_0053                -1.311601e-02 3 1  ON 52
ci_0054                -1.246521e-02 3 1  ON 53
ci_0055                 1.224429e-02 3 1  ON 54
ci_0056                 1.302303e-02 3 1  ON 55
ci_0057                 1.354079e-02 3 1  ON 56
ci_0058                 1.206540e-02 3 1  ON 57
ci_0059                -1.338053e-02 3 1  ON 58
ci_0060                -1.268601e-02 3 1  ON 59
ci_0061                -1.297260e-02 3 1  ON 60
ci_0062                -1.259302e-02 3 1  ON 61
ci_0063                -1.198205e-02 3 1  ON 62
ci_0064                -1.109460e-02 3 1  ON 63
ci_0065                -1.219968e-02 3 1  ON 64
ci_0066                -1.123623e-02 3 1  ON 65
ci_0067                -1.122069e-02 3 1  ON 66
ci_0068                -1.093119e-02 3 1  ON 67
ci_0069                 1.096038e-02 3 1  ON 68
ci_0070                 1.053104e-02 3 1  ON 69
ci_0071                 9.801831e-03 3 1  ON 70
ci_0072                 1.001105e-02 3 1  ON 71
ci_0073                 1.103302e-02 3 1  ON 72
ci_0074                 1.093295e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.6757
    reference variance = 3.24404
====================================================
  Execution time = 1.2685e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5787e+00
  Total weights = 1.9457e+06
  Execution time = 2.2272e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.600192902427
                                         uncertainty =       0.043687805878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.600192902427
                                         uncertainty =       0.043687805878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140545987
  error estimate for blocks of size 2^( 2) =       0.001178180179
  error estimate for blocks of size 2^( 3) =       0.001210709588
  error estimate for blocks of size 2^( 4) =       0.001232566771
  error estimate for blocks of size 2^( 5) =       0.001248723657
  error estimate for blocks of size 2^( 6) =       0.001254333896
  error estimate for blocks of size 2^( 7) =       0.001258120796

      target function =                  N/A
              le_mean =     -16.717083879861
             les_mean =     282.039561988904
             stat err =       0.001248436280
             autocorr =       1.198138876079
              std dev =       1.613001411383
             le_variance =       2.601773553125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.600192256455
                                         uncertainty =       0.043687768154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.600192256455
                                         uncertainty =       0.043687768154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140545847
  error estimate for blocks of size 2^( 2) =       0.001178180027
  error estimate for blocks of size 2^( 3) =       0.001210709500
  error estimate for blocks of size 2^( 4) =       0.001232566688
  error estimate for blocks of size 2^( 5) =       0.001248723535
  error estimate for blocks of size 2^( 6) =       0.001254333766
  error estimate for blocks of size 2^( 7) =       0.001258120519

      target function =                  N/A
              le_mean =     -16.717083848436
             les_mean =     282.039568704221
             stat err =       0.001248436127
             autocorr =       1.198138876829
              std dev =       1.613001213036
             le_variance =       2.601772913257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.600192578325
                                         uncertainty =       0.043687786996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.600192578325
                                         uncertainty =       0.043687786996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140545917
  error estimate for blocks of size 2^( 2) =       0.001178180103
  error estimate for blocks of size 2^( 3) =       0.001210709544
  error estimate for blocks of size 2^( 4) =       0.001232566729
  error estimate for blocks of size 2^( 5) =       0.001248723596
  error estimate for blocks of size 2^( 6) =       0.001254333831
  error estimate for blocks of size 2^( 7) =       0.001258120657

      target function =                  N/A
              le_mean =     -16.717083864074
             les_mean =     282.039565317856
             stat err =       0.001248436203
             autocorr =       1.198138876592
              std dev =       1.613001311865
             le_variance =       2.601773232079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.600192861843
                                         uncertainty =       0.043687803517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.600192861843
                                         uncertainty =       0.043687803517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001140545979
  error estimate for blocks of size 2^( 2) =       0.001178180170
  error estimate for blocks of size 2^( 3) =       0.001210709582
  error estimate for blocks of size 2^( 4) =       0.001232566766
  error estimate for blocks of size 2^( 5) =       0.001248723650
  error estimate for blocks of size 2^( 6) =       0.001254333888
  error estimate for blocks of size 2^( 7) =       0.001258120778

      target function =                  N/A
              le_mean =     -16.717083877880
             les_mean =     282.039562401400
             stat err =       0.001248436270
             autocorr =       1.198138876149
              std dev =       1.613001398922
             le_variance =       2.601773512923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717083879861        initial  <--
     1.5259e+02     1.5259e+03             3.0279e-06       -16.717083848436
     6.1035e+02     6.1035e+03             7.5831e-07       -16.717083864074
     2.4414e+03     2.4414e+04             1.8966e-07       -16.717083877880

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9650
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832364e-02 3 1  ON 2
ci_0004                -4.654915e-02 3 1  ON 3
ci_0005                -4.519372e-02 3 1  ON 4
ci_0006                -4.445542e-02 3 1  ON 5
ci_0007                -3.107075e-02 3 1  ON 6
ci_0008                -3.156857e-02 3 1  ON 7
ci_0009                -3.223191e-02 3 1  ON 8
ci_0010                -3.088094e-02 3 1  ON 9
ci_0011                -2.797530e-02 3 1  ON 10
ci_0012                -2.620343e-02 3 1  ON 11
ci_0013                 2.731750e-02 3 1  ON 12
ci_0014                 2.581357e-02 3 1  ON 13
ci_0015                 2.739684e-02 3 1  ON 14
ci_0016                 2.623906e-02 3 1  ON 15
ci_0017                 2.474517e-02 3 1  ON 16
ci_0018                 2.356881e-02 3 1  ON 17
ci_0019                 1.974946e-02 3 1  ON 18
ci_0020                 1.928551e-02 3 1  ON 19
ci_0021                 1.920543e-02 3 1  ON 20
ci_0022                 1.827988e-02 3 1  ON 21
ci_0023                -1.952986e-02 3 1  ON 22
ci_0024                -1.798064e-02 3 1  ON 23
ci_0025                -1.982116e-02 3 1  ON 24
ci_0026                -1.793477e-02 3 1  ON 25
ci_0027                -1.762445e-02 3 1  ON 26
ci_0028                -1.699005e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639837e-02 3 1  ON 29
ci_0031                 1.492166e-02 3 1  ON 30
ci_0032                 1.379388e-02 3 1  ON 31
ci_0033                 1.771935e-02 3 1  ON 32
ci_0034                 1.525198e-02 3 1  ON 33
ci_0035                 1.751161e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546322e-02 3 1  ON 36
ci_0038                -1.407576e-02 3 1  ON 37
ci_0039                -1.580539e-02 3 1  ON 38
ci_0040                -1.502754e-02 3 1  ON 39
ci_0041                 1.593025e-02 3 1  ON 40
ci_0042                 1.602366e-02 3 1  ON 41
ci_0043                -1.557519e-02 3 1  ON 42
ci_0044                -1.526803e-02 3 1  ON 43
ci_0045                 1.455653e-02 3 1  ON 44
ci_0046                 1.488568e-02 3 1  ON 45
ci_0047                -1.481038e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321618e-02 3 1  ON 48
ci_0050                -1.301627e-02 3 1  ON 49
ci_0051                -1.291494e-02 3 1  ON 50
ci_0052                -1.258118e-02 3 1  ON 51
ci_0053                -1.311580e-02 3 1  ON 52
ci_0054                -1.246513e-02 3 1  ON 53
ci_0055                 1.224369e-02 3 1  ON 54
ci_0056                 1.302336e-02 3 1  ON 55
ci_0057                 1.354085e-02 3 1  ON 56
ci_0058                 1.206551e-02 3 1  ON 57
ci_0059                -1.338023e-02 3 1  ON 58
ci_0060                -1.268551e-02 3 1  ON 59
ci_0061                -1.297247e-02 3 1  ON 60
ci_0062                -1.259284e-02 3 1  ON 61
ci_0063                -1.198200e-02 3 1  ON 62
ci_0064                -1.109410e-02 3 1  ON 63
ci_0065                -1.219966e-02 3 1  ON 64
ci_0066                -1.123613e-02 3 1  ON 65
ci_0067                -1.122076e-02 3 1  ON 66
ci_0068                -1.093111e-02 3 1  ON 67
ci_0069                 1.096108e-02 3 1  ON 68
ci_0070                 1.053130e-02 3 1  ON 69
ci_0071                 9.801559e-03 3 1  ON 70
ci_0072                 1.001109e-02 3 1  ON 71
ci_0073                 1.103284e-02 3 1  ON 72
ci_0074                 1.093371e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6697e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.5426
    reference variance = 1.9
====================================================
  Execution time = 1.2960e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0254e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5163e+00
  Total weights = 1.945604061e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2292e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545358333900
                                         uncertainty =       0.034344807082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545358333900
                                         uncertainty =       0.034344807082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128094629
  error estimate for blocks of size 2^( 2) =       0.001166196856
  error estimate for blocks of size 2^( 3) =       0.001198722509
  error estimate for blocks of size 2^( 4) =       0.001221745815
  error estimate for blocks of size 2^( 5) =       0.001235086935
  error estimate for blocks of size 2^( 6) =       0.001241438759
  error estimate for blocks of size 2^( 7) =       0.001247021197

      target function =                  N/A
              le_mean =     -16.719702567335
             les_mean =     282.064798833375
             stat err =       0.001236323176
             autocorr =       1.201082829538
              std dev =       1.595392249729
             le_variance =       2.545276430495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671970256734e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719702566423       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719702580293       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719702580098       residual = 3.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 4.001497e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719702566423       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719702569891       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719702569842       residual = 3.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+03 is 1.000482e-07

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719702566423       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719702567290       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719702567278       residual = 3.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+04 is 2.501272e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098262 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6195e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832363e-02 3 1  ON 2
ci_0004                -4.654917e-02 3 1  ON 3
ci_0005                -4.519377e-02 3 1  ON 4
ci_0006                -4.445541e-02 3 1  ON 5
ci_0007                -3.107079e-02 3 1  ON 6
ci_0008                -3.156859e-02 3 1  ON 7
ci_0009                -3.223194e-02 3 1  ON 8
ci_0010                -3.088098e-02 3 1  ON 9
ci_0011                -2.797532e-02 3 1  ON 10
ci_0012                -2.620347e-02 3 1  ON 11
ci_0013                 2.731753e-02 3 1  ON 12
ci_0014                 2.581357e-02 3 1  ON 13
ci_0015                 2.739684e-02 3 1  ON 14
ci_0016                 2.623906e-02 3 1  ON 15
ci_0017                 2.474516e-02 3 1  ON 16
ci_0018                 2.356879e-02 3 1  ON 17
ci_0019                 1.974944e-02 3 1  ON 18
ci_0020                 1.928548e-02 3 1  ON 19
ci_0021                 1.920542e-02 3 1  ON 20
ci_0022                 1.827987e-02 3 1  ON 21
ci_0023                -1.952984e-02 3 1  ON 22
ci_0024                -1.798065e-02 3 1  ON 23
ci_0025                -1.982113e-02 3 1  ON 24
ci_0026                -1.793484e-02 3 1  ON 25
ci_0027                -1.762445e-02 3 1  ON 26
ci_0028                -1.699005e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639833e-02 3 1  ON 29
ci_0031                 1.492169e-02 3 1  ON 30
ci_0032                 1.379391e-02 3 1  ON 31
ci_0033                 1.771934e-02 3 1  ON 32
ci_0034                 1.525199e-02 3 1  ON 33
ci_0035                 1.751161e-02 3 1  ON 34
ci_0036                 1.622196e-02 3 1  ON 35
ci_0037                -1.546323e-02 3 1  ON 36
ci_0038                -1.407583e-02 3 1  ON 37
ci_0039                -1.580535e-02 3 1  ON 38
ci_0040                -1.502756e-02 3 1  ON 39
ci_0041                 1.593026e-02 3 1  ON 40
ci_0042                 1.602359e-02 3 1  ON 41
ci_0043                -1.557520e-02 3 1  ON 42
ci_0044                -1.526803e-02 3 1  ON 43
ci_0045                 1.455655e-02 3 1  ON 44
ci_0046                 1.488572e-02 3 1  ON 45
ci_0047                -1.481036e-02 3 1  ON 46
ci_0048                -1.411510e-02 3 1  ON 47
ci_0049                -1.321620e-02 3 1  ON 48
ci_0050                -1.301623e-02 3 1  ON 49
ci_0051                -1.291496e-02 3 1  ON 50
ci_0052                -1.258119e-02 3 1  ON 51
ci_0053                -1.311582e-02 3 1  ON 52
ci_0054                -1.246508e-02 3 1  ON 53
ci_0055                 1.224375e-02 3 1  ON 54
ci_0056                 1.302338e-02 3 1  ON 55
ci_0057                 1.354082e-02 3 1  ON 56
ci_0058                 1.206552e-02 3 1  ON 57
ci_0059                -1.338025e-02 3 1  ON 58
ci_0060                -1.268553e-02 3 1  ON 59
ci_0061                -1.297244e-02 3 1  ON 60
ci_0062                -1.259281e-02 3 1  ON 61
ci_0063                -1.198203e-02 3 1  ON 62
ci_0064                -1.109410e-02 3 1  ON 63
ci_0065                -1.219959e-02 3 1  ON 64
ci_0066                -1.123612e-02 3 1  ON 65
ci_0067                -1.122078e-02 3 1  ON 66
ci_0068                -1.093111e-02 3 1  ON 67
ci_0069                 1.096111e-02 3 1  ON 68
ci_0070                 1.053124e-02 3 1  ON 69
ci_0071                 9.801534e-03 3 1  ON 70
ci_0072                 1.001108e-02 3 1  ON 71
ci_0073                 1.103287e-02 3 1  ON 72
ci_0074                 1.093368e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8108
    reference variance = 2.04786
====================================================
  Execution time = 1.5103e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5088e+00
  Total weights = 1.9456e+06
  Execution time = 2.2146e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537959355383
                                         uncertainty =       0.026043003528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537959355383
                                         uncertainty =       0.026043003528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126343076
  error estimate for blocks of size 2^( 2) =       0.001164678344
  error estimate for blocks of size 2^( 3) =       0.001196619300
  error estimate for blocks of size 2^( 4) =       0.001219286574
  error estimate for blocks of size 2^( 5) =       0.001231467797
  error estimate for blocks of size 2^( 6) =       0.001239494691
  error estimate for blocks of size 2^( 7) =       0.001236740045

      target function =                  N/A
              le_mean =     -16.717948018800
             les_mean =     281.998592804109
             stat err =       0.001231747277
             autocorr =       1.195919187957
              std dev =       1.592915140541
             le_variance =       2.537378644964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537959633311
                                         uncertainty =       0.026043005235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537959633311
                                         uncertainty =       0.026043005235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126343138
  error estimate for blocks of size 2^( 2) =       0.001164678399
  error estimate for blocks of size 2^( 3) =       0.001196619349
  error estimate for blocks of size 2^( 4) =       0.001219286613
  error estimate for blocks of size 2^( 5) =       0.001231467840
  error estimate for blocks of size 2^( 6) =       0.001239494727
  error estimate for blocks of size 2^( 7) =       0.001236740074

      target function =                  N/A
              le_mean =     -16.717948011951
             les_mean =     281.998592336781
             stat err =       0.001231747314
             autocorr =       1.195919128209
              std dev =       1.592915227987
             le_variance =       2.537378923552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537959494361
                                         uncertainty =       0.026043004382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537959494361
                                         uncertainty =       0.026043004382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126343107
  error estimate for blocks of size 2^( 2) =       0.001164678371
  error estimate for blocks of size 2^( 3) =       0.001196619325
  error estimate for blocks of size 2^( 4) =       0.001219286594
  error estimate for blocks of size 2^( 5) =       0.001231467818
  error estimate for blocks of size 2^( 6) =       0.001239494709
  error estimate for blocks of size 2^( 7) =       0.001236740060

      target function =                  N/A
              le_mean =     -16.717948015374
             les_mean =     281.998592568709
             stat err =       0.001231747295
             autocorr =       1.195919158081
              std dev =       1.592915184268
             le_variance =       2.537378784272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537959372756
                                         uncertainty =       0.026043003635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.537959372756
                                         uncertainty =       0.026043003635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126343080
  error estimate for blocks of size 2^( 2) =       0.001164678347
  error estimate for blocks of size 2^( 3) =       0.001196619303
  error estimate for blocks of size 2^( 4) =       0.001219286577
  error estimate for blocks of size 2^( 5) =       0.001231467799
  error estimate for blocks of size 2^( 6) =       0.001239494694
  error estimate for blocks of size 2^( 7) =       0.001236740047

      target function =                  N/A
              le_mean =     -16.717948018372
             les_mean =     281.998592774494
             stat err =       0.001231747279
             autocorr =       1.195919184223
              std dev =       1.592915146007
             le_variance =       2.537378662377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717948018800        initial  <--
     1.5259e+03     1.5259e+04             4.0015e-07       -16.717948011951
     6.1035e+03     6.1035e+04             1.0005e-07       -16.717948015374
     2.4414e+04     2.4414e+05             2.5013e-08       -16.717948018372

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.4187
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832364e-02 3 1  ON 2
ci_0004                -4.654915e-02 3 1  ON 3
ci_0005                -4.519372e-02 3 1  ON 4
ci_0006                -4.445542e-02 3 1  ON 5
ci_0007                -3.107075e-02 3 1  ON 6
ci_0008                -3.156857e-02 3 1  ON 7
ci_0009                -3.223191e-02 3 1  ON 8
ci_0010                -3.088094e-02 3 1  ON 9
ci_0011                -2.797530e-02 3 1  ON 10
ci_0012                -2.620343e-02 3 1  ON 11
ci_0013                 2.731750e-02 3 1  ON 12
ci_0014                 2.581357e-02 3 1  ON 13
ci_0015                 2.739684e-02 3 1  ON 14
ci_0016                 2.623906e-02 3 1  ON 15
ci_0017                 2.474517e-02 3 1  ON 16
ci_0018                 2.356881e-02 3 1  ON 17
ci_0019                 1.974946e-02 3 1  ON 18
ci_0020                 1.928551e-02 3 1  ON 19
ci_0021                 1.920543e-02 3 1  ON 20
ci_0022                 1.827988e-02 3 1  ON 21
ci_0023                -1.952986e-02 3 1  ON 22
ci_0024                -1.798064e-02 3 1  ON 23
ci_0025                -1.982116e-02 3 1  ON 24
ci_0026                -1.793477e-02 3 1  ON 25
ci_0027                -1.762445e-02 3 1  ON 26
ci_0028                -1.699005e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639837e-02 3 1  ON 29
ci_0031                 1.492166e-02 3 1  ON 30
ci_0032                 1.379388e-02 3 1  ON 31
ci_0033                 1.771935e-02 3 1  ON 32
ci_0034                 1.525198e-02 3 1  ON 33
ci_0035                 1.751161e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546322e-02 3 1  ON 36
ci_0038                -1.407576e-02 3 1  ON 37
ci_0039                -1.580539e-02 3 1  ON 38
ci_0040                -1.502754e-02 3 1  ON 39
ci_0041                 1.593025e-02 3 1  ON 40
ci_0042                 1.602366e-02 3 1  ON 41
ci_0043                -1.557519e-02 3 1  ON 42
ci_0044                -1.526803e-02 3 1  ON 43
ci_0045                 1.455653e-02 3 1  ON 44
ci_0046                 1.488568e-02 3 1  ON 45
ci_0047                -1.481038e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321618e-02 3 1  ON 48
ci_0050                -1.301627e-02 3 1  ON 49
ci_0051                -1.291494e-02 3 1  ON 50
ci_0052                -1.258118e-02 3 1  ON 51
ci_0053                -1.311580e-02 3 1  ON 52
ci_0054                -1.246513e-02 3 1  ON 53
ci_0055                 1.224369e-02 3 1  ON 54
ci_0056                 1.302336e-02 3 1  ON 55
ci_0057                 1.354085e-02 3 1  ON 56
ci_0058                 1.206551e-02 3 1  ON 57
ci_0059                -1.338023e-02 3 1  ON 58
ci_0060                -1.268551e-02 3 1  ON 59
ci_0061                -1.297247e-02 3 1  ON 60
ci_0062                -1.259284e-02 3 1  ON 61
ci_0063                -1.198200e-02 3 1  ON 62
ci_0064                -1.109410e-02 3 1  ON 63
ci_0065                -1.219966e-02 3 1  ON 64
ci_0066                -1.123613e-02 3 1  ON 65
ci_0067                -1.122076e-02 3 1  ON 66
ci_0068                -1.093111e-02 3 1  ON 67
ci_0069                 1.096108e-02 3 1  ON 68
ci_0070                 1.053130e-02 3 1  ON 69
ci_0071                 9.801559e-03 3 1  ON 70
ci_0072                 1.001109e-02 3 1  ON 71
ci_0073                 1.103284e-02 3 1  ON 72
ci_0074                 1.093371e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2621e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6696e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8308
    reference variance = 1.16464
====================================================
  Execution time = 1.2965e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0283e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5294e+00
  Total weights = 1.945493086e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2091e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556752655705
                                         uncertainty =       0.030830165003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556752655705
                                         uncertainty =       0.030830165003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130590104
  error estimate for blocks of size 2^( 2) =       0.001169791652
  error estimate for blocks of size 2^( 3) =       0.001202248198
  error estimate for blocks of size 2^( 4) =       0.001226327890
  error estimate for blocks of size 2^( 5) =       0.001236729201
  error estimate for blocks of size 2^( 6) =       0.001242640996
  error estimate for blocks of size 2^( 7) =       0.001249646388

      target function =                  N/A
              le_mean =     -16.718905397333
             les_mean =     282.051240412891
             stat err =       0.001238836119
             autocorr =       1.200652579084
              std dev =       1.598921440832
             le_variance =       2.556549773952


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671890539733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718905396424       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718905397505       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718905397576       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+04 is 2.685267e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718905396424       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718905396694       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718905396712       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+04 is 6.713247e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718905396424       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718905396492       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718905396496       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+05 is 1.678317e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099427 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6181e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832364e-02 3 1  ON 2
ci_0004                -4.654915e-02 3 1  ON 3
ci_0005                -4.519372e-02 3 1  ON 4
ci_0006                -4.445542e-02 3 1  ON 5
ci_0007                -3.107075e-02 3 1  ON 6
ci_0008                -3.156857e-02 3 1  ON 7
ci_0009                -3.223191e-02 3 1  ON 8
ci_0010                -3.088094e-02 3 1  ON 9
ci_0011                -2.797530e-02 3 1  ON 10
ci_0012                -2.620343e-02 3 1  ON 11
ci_0013                 2.731750e-02 3 1  ON 12
ci_0014                 2.581357e-02 3 1  ON 13
ci_0015                 2.739685e-02 3 1  ON 14
ci_0016                 2.623905e-02 3 1  ON 15
ci_0017                 2.474517e-02 3 1  ON 16
ci_0018                 2.356881e-02 3 1  ON 17
ci_0019                 1.974946e-02 3 1  ON 18
ci_0020                 1.928551e-02 3 1  ON 19
ci_0021                 1.920543e-02 3 1  ON 20
ci_0022                 1.827988e-02 3 1  ON 21
ci_0023                -1.952985e-02 3 1  ON 22
ci_0024                -1.798064e-02 3 1  ON 23
ci_0025                -1.982116e-02 3 1  ON 24
ci_0026                -1.793477e-02 3 1  ON 25
ci_0027                -1.762446e-02 3 1  ON 26
ci_0028                -1.699005e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639837e-02 3 1  ON 29
ci_0031                 1.492166e-02 3 1  ON 30
ci_0032                 1.379388e-02 3 1  ON 31
ci_0033                 1.771935e-02 3 1  ON 32
ci_0034                 1.525198e-02 3 1  ON 33
ci_0035                 1.751161e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546322e-02 3 1  ON 36
ci_0038                -1.407577e-02 3 1  ON 37
ci_0039                -1.580539e-02 3 1  ON 38
ci_0040                -1.502754e-02 3 1  ON 39
ci_0041                 1.593025e-02 3 1  ON 40
ci_0042                 1.602366e-02 3 1  ON 41
ci_0043                -1.557519e-02 3 1  ON 42
ci_0044                -1.526803e-02 3 1  ON 43
ci_0045                 1.455653e-02 3 1  ON 44
ci_0046                 1.488568e-02 3 1  ON 45
ci_0047                -1.481038e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321618e-02 3 1  ON 48
ci_0050                -1.301627e-02 3 1  ON 49
ci_0051                -1.291493e-02 3 1  ON 50
ci_0052                -1.258119e-02 3 1  ON 51
ci_0053                -1.311580e-02 3 1  ON 52
ci_0054                -1.246513e-02 3 1  ON 53
ci_0055                 1.224369e-02 3 1  ON 54
ci_0056                 1.302336e-02 3 1  ON 55
ci_0057                 1.354085e-02 3 1  ON 56
ci_0058                 1.206551e-02 3 1  ON 57
ci_0059                -1.338023e-02 3 1  ON 58
ci_0060                -1.268552e-02 3 1  ON 59
ci_0061                -1.297247e-02 3 1  ON 60
ci_0062                -1.259284e-02 3 1  ON 61
ci_0063                -1.198200e-02 3 1  ON 62
ci_0064                -1.109411e-02 3 1  ON 63
ci_0065                -1.219966e-02 3 1  ON 64
ci_0066                -1.123613e-02 3 1  ON 65
ci_0067                -1.122075e-02 3 1  ON 66
ci_0068                -1.093111e-02 3 1  ON 67
ci_0069                 1.096108e-02 3 1  ON 68
ci_0070                 1.053130e-02 3 1  ON 69
ci_0071                 9.801557e-03 3 1  ON 70
ci_0072                 1.001109e-02 3 1  ON 71
ci_0073                 1.103284e-02 3 1  ON 72
ci_0074                 1.093371e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.735
    reference variance = 1.81111
====================================================
  Execution time = 1.2664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5479e+00
  Total weights = 1.9457e+06
  Execution time = 2.2170e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579105917612
                                         uncertainty =       0.047331709524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579105917612
                                         uncertainty =       0.047331709524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135455635
  error estimate for blocks of size 2^( 2) =       0.001173564419
  error estimate for blocks of size 2^( 3) =       0.001206751738
  error estimate for blocks of size 2^( 4) =       0.001228279355
  error estimate for blocks of size 2^( 5) =       0.001240190654
  error estimate for blocks of size 2^( 6) =       0.001247514509
  error estimate for blocks of size 2^( 7) =       0.001257985541

      target function =                  N/A
              le_mean =     -16.719623220818
             les_mean =     282.093749925430
             stat err =       0.001243492515
             autocorr =       1.199350197507
              std dev =       1.605802450199
             le_variance =       2.578601509066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579105898377
                                         uncertainty =       0.047331709425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579105898377
                                         uncertainty =       0.047331709425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135455630
  error estimate for blocks of size 2^( 2) =       0.001173564415
  error estimate for blocks of size 2^( 3) =       0.001206751734
  error estimate for blocks of size 2^( 4) =       0.001228279351
  error estimate for blocks of size 2^( 5) =       0.001240190650
  error estimate for blocks of size 2^( 6) =       0.001247514504
  error estimate for blocks of size 2^( 7) =       0.001257985536

      target function =                  N/A
              le_mean =     -16.719623221094
             les_mean =     282.093750055479
             stat err =       0.001243492510
             autocorr =       1.199350198174
              std dev =       1.605802444211
             le_variance =       2.578601489835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579105907994
                                         uncertainty =       0.047331709474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579105907994
                                         uncertainty =       0.047331709474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135455633
  error estimate for blocks of size 2^( 2) =       0.001173564417
  error estimate for blocks of size 2^( 3) =       0.001206751736
  error estimate for blocks of size 2^( 4) =       0.001228279353
  error estimate for blocks of size 2^( 5) =       0.001240190652
  error estimate for blocks of size 2^( 6) =       0.001247514507
  error estimate for blocks of size 2^( 7) =       0.001257985539

      target function =                  N/A
              le_mean =     -16.719623220956
             les_mean =     282.093749990333
             stat err =       0.001243492512
             autocorr =       1.199350197840
              std dev =       1.605802447205
             le_variance =       2.578601499450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579105916410
                                         uncertainty =       0.047331709518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579105916410
                                         uncertainty =       0.047331709518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135455634
  error estimate for blocks of size 2^( 2) =       0.001173564419
  error estimate for blocks of size 2^( 3) =       0.001206751737
  error estimate for blocks of size 2^( 4) =       0.001228279354
  error estimate for blocks of size 2^( 5) =       0.001240190654
  error estimate for blocks of size 2^( 6) =       0.001247514509
  error estimate for blocks of size 2^( 7) =       0.001257985541

      target function =                  N/A
              le_mean =     -16.719623220835
             les_mean =     282.093749933530
             stat err =       0.001243492514
             autocorr =       1.199350197549
              std dev =       1.605802449825
             le_variance =       2.578601507864


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719623220818        initial
     1.5259e+04     1.5259e+05             2.6853e-08       -16.719623221094  <--
     6.1035e+04     6.1035e+05             6.7132e-09       -16.719623220956
     2.4414e+05     2.4414e+06             1.6783e-09       -16.719623220835

*****************************************************************************
Applying the update for shift_i =   1.5259e+04     and shift_s =   1.5259e+05
*****************************************************************************

  Execution time = 2.4005e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832364e-02 3 1  ON 2
ci_0004                -4.654916e-02 3 1  ON 3
ci_0005                -4.519372e-02 3 1  ON 4
ci_0006                -4.445541e-02 3 1  ON 5
ci_0007                -3.107074e-02 3 1  ON 6
ci_0008                -3.156857e-02 3 1  ON 7
ci_0009                -3.223192e-02 3 1  ON 8
ci_0010                -3.088094e-02 3 1  ON 9
ci_0011                -2.797529e-02 3 1  ON 10
ci_0012                -2.620343e-02 3 1  ON 11
ci_0013                 2.731751e-02 3 1  ON 12
ci_0014                 2.581357e-02 3 1  ON 13
ci_0015                 2.739685e-02 3 1  ON 14
ci_0016                 2.623905e-02 3 1  ON 15
ci_0017                 2.474517e-02 3 1  ON 16
ci_0018                 2.356882e-02 3 1  ON 17
ci_0019                 1.974946e-02 3 1  ON 18
ci_0020                 1.928552e-02 3 1  ON 19
ci_0021                 1.920542e-02 3 1  ON 20
ci_0022                 1.827988e-02 3 1  ON 21
ci_0023                -1.952983e-02 3 1  ON 22
ci_0024                -1.798066e-02 3 1  ON 23
ci_0025                -1.982115e-02 3 1  ON 24
ci_0026                -1.793475e-02 3 1  ON 25
ci_0027                -1.762447e-02 3 1  ON 26
ci_0028                -1.699004e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639836e-02 3 1  ON 29
ci_0031                 1.492166e-02 3 1  ON 30
ci_0032                 1.379390e-02 3 1  ON 31
ci_0033                 1.771935e-02 3 1  ON 32
ci_0034                 1.525199e-02 3 1  ON 33
ci_0035                 1.751160e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546323e-02 3 1  ON 36
ci_0038                -1.407577e-02 3 1  ON 37
ci_0039                -1.580539e-02 3 1  ON 38
ci_0040                -1.502755e-02 3 1  ON 39
ci_0041                 1.593025e-02 3 1  ON 40
ci_0042                 1.602365e-02 3 1  ON 41
ci_0043                -1.557519e-02 3 1  ON 42
ci_0044                -1.526802e-02 3 1  ON 43
ci_0045                 1.455655e-02 3 1  ON 44
ci_0046                 1.488567e-02 3 1  ON 45
ci_0047                -1.481039e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321617e-02 3 1  ON 48
ci_0050                -1.301627e-02 3 1  ON 49
ci_0051                -1.291492e-02 3 1  ON 50
ci_0052                -1.258120e-02 3 1  ON 51
ci_0053                -1.311579e-02 3 1  ON 52
ci_0054                -1.246513e-02 3 1  ON 53
ci_0055                 1.224369e-02 3 1  ON 54
ci_0056                 1.302336e-02 3 1  ON 55
ci_0057                 1.354083e-02 3 1  ON 56
ci_0058                 1.206551e-02 3 1  ON 57
ci_0059                -1.338023e-02 3 1  ON 58
ci_0060                -1.268553e-02 3 1  ON 59
ci_0061                -1.297246e-02 3 1  ON 60
ci_0062                -1.259283e-02 3 1  ON 61
ci_0063                -1.198201e-02 3 1  ON 62
ci_0064                -1.109411e-02 3 1  ON 63
ci_0065                -1.219965e-02 3 1  ON 64
ci_0066                -1.123613e-02 3 1  ON 65
ci_0067                -1.122075e-02 3 1  ON 66
ci_0068                -1.093111e-02 3 1  ON 67
ci_0069                 1.096108e-02 3 1  ON 68
ci_0070                 1.053130e-02 3 1  ON 69
ci_0071                 9.801551e-03 3 1  ON 70
ci_0072                 1.001109e-02 3 1  ON 71
ci_0073                 1.103284e-02 3 1  ON 72
ci_0074                 1.093372e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0192e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6700e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.7275
    reference variance = 5.31105
====================================================
  Execution time = 1.2984e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0256e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5319e+00
  Total weights = 1.945533753e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2084e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556806480319
                                         uncertainty =       0.039173149186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.556806480319
                                         uncertainty =       0.039173149186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131070704
  error estimate for blocks of size 2^( 2) =       0.001170412245
  error estimate for blocks of size 2^( 3) =       0.001202646991
  error estimate for blocks of size 2^( 4) =       0.001226358619
  error estimate for blocks of size 2^( 5) =       0.001238399775
  error estimate for blocks of size 2^( 6) =       0.001253016436
  error estimate for blocks of size 2^( 7) =       0.001255068463

      target function =                  N/A
              le_mean =     -16.717217922635
             les_mean =     281.997312767931
             stat err =       0.001243210823
             autocorr =       1.208119952766
              std dev =       1.599601122554
             le_variance =       2.558723751276


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671721792264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717217921733       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717217926073       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717217926073       residual = 3.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+03 is 1.325987e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717217921733       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717217922818       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717217922818       residual = 3.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+04 is 3.315122e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717217921733       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717217922004       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717217922004       residual = 3.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+04 is 8.287901e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6199e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832363e-02 3 1  ON 2
ci_0004                -4.654916e-02 3 1  ON 3
ci_0005                -4.519372e-02 3 1  ON 4
ci_0006                -4.445540e-02 3 1  ON 5
ci_0007                -3.107075e-02 3 1  ON 6
ci_0008                -3.156858e-02 3 1  ON 7
ci_0009                -3.223192e-02 3 1  ON 8
ci_0010                -3.088093e-02 3 1  ON 9
ci_0011                -2.797527e-02 3 1  ON 10
ci_0012                -2.620343e-02 3 1  ON 11
ci_0013                 2.731749e-02 3 1  ON 12
ci_0014                 2.581358e-02 3 1  ON 13
ci_0015                 2.739684e-02 3 1  ON 14
ci_0016                 2.623905e-02 3 1  ON 15
ci_0017                 2.474516e-02 3 1  ON 16
ci_0018                 2.356883e-02 3 1  ON 17
ci_0019                 1.974945e-02 3 1  ON 18
ci_0020                 1.928551e-02 3 1  ON 19
ci_0021                 1.920542e-02 3 1  ON 20
ci_0022                 1.827988e-02 3 1  ON 21
ci_0023                -1.952982e-02 3 1  ON 22
ci_0024                -1.798066e-02 3 1  ON 23
ci_0025                -1.982113e-02 3 1  ON 24
ci_0026                -1.793473e-02 3 1  ON 25
ci_0027                -1.762447e-02 3 1  ON 26
ci_0028                -1.699005e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639835e-02 3 1  ON 29
ci_0031                 1.492164e-02 3 1  ON 30
ci_0032                 1.379391e-02 3 1  ON 31
ci_0033                 1.771936e-02 3 1  ON 32
ci_0034                 1.525200e-02 3 1  ON 33
ci_0035                 1.751160e-02 3 1  ON 34
ci_0036                 1.622188e-02 3 1  ON 35
ci_0037                -1.546323e-02 3 1  ON 36
ci_0038                -1.407578e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502756e-02 3 1  ON 39
ci_0041                 1.593025e-02 3 1  ON 40
ci_0042                 1.602362e-02 3 1  ON 41
ci_0043                -1.557519e-02 3 1  ON 42
ci_0044                -1.526803e-02 3 1  ON 43
ci_0045                 1.455657e-02 3 1  ON 44
ci_0046                 1.488569e-02 3 1  ON 45
ci_0047                -1.481038e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321616e-02 3 1  ON 48
ci_0050                -1.301627e-02 3 1  ON 49
ci_0051                -1.291495e-02 3 1  ON 50
ci_0052                -1.258121e-02 3 1  ON 51
ci_0053                -1.311580e-02 3 1  ON 52
ci_0054                -1.246511e-02 3 1  ON 53
ci_0055                 1.224368e-02 3 1  ON 54
ci_0056                 1.302333e-02 3 1  ON 55
ci_0057                 1.354083e-02 3 1  ON 56
ci_0058                 1.206553e-02 3 1  ON 57
ci_0059                -1.338023e-02 3 1  ON 58
ci_0060                -1.268552e-02 3 1  ON 59
ci_0061                -1.297246e-02 3 1  ON 60
ci_0062                -1.259282e-02 3 1  ON 61
ci_0063                -1.198199e-02 3 1  ON 62
ci_0064                -1.109414e-02 3 1  ON 63
ci_0065                -1.219964e-02 3 1  ON 64
ci_0066                -1.123614e-02 3 1  ON 65
ci_0067                -1.122074e-02 3 1  ON 66
ci_0068                -1.093109e-02 3 1  ON 67
ci_0069                 1.096107e-02 3 1  ON 68
ci_0070                 1.053129e-02 3 1  ON 69
ci_0071                 9.801561e-03 3 1  ON 70
ci_0072                 1.001110e-02 3 1  ON 71
ci_0073                 1.103283e-02 3 1  ON 72
ci_0074                 1.093372e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.869
    reference variance = 1.34215
====================================================
  Execution time = 1.2761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.4930e+00
  Total weights = 1.9457e+06
  Execution time = 2.2134e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518410165232
                                         uncertainty =       0.022932576657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518410165232
                                         uncertainty =       0.022932576657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122148172
  error estimate for blocks of size 2^( 2) =       0.001163420040
  error estimate for blocks of size 2^( 3) =       0.001196506733
  error estimate for blocks of size 2^( 4) =       0.001219555798
  error estimate for blocks of size 2^( 5) =       0.001235725763
  error estimate for blocks of size 2^( 6) =       0.001246602923
  error estimate for blocks of size 2^( 7) =       0.001253287443

      target function =                  N/A
              le_mean =     -16.718495614072
             les_mean =     282.001088624648
             stat err =       0.001238792982
             autocorr =       1.218700699014
              std dev =       1.586982554273
             le_variance =       2.518513627568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518410108889
                                         uncertainty =       0.022932576745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518410108889
                                         uncertainty =       0.022932576745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122148159
  error estimate for blocks of size 2^( 2) =       0.001163420028
  error estimate for blocks of size 2^( 3) =       0.001196506723
  error estimate for blocks of size 2^( 4) =       0.001219555787
  error estimate for blocks of size 2^( 5) =       0.001235725749
  error estimate for blocks of size 2^( 6) =       0.001246602911
  error estimate for blocks of size 2^( 7) =       0.001253287430

      target function =                  N/A
              le_mean =     -16.718495614352
             les_mean =     282.001088747639
             stat err =       0.001238792969
             autocorr =       1.218700701752
              std dev =       1.586982536412
             le_variance =       2.518513570877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518410137059
                                         uncertainty =       0.022932576701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518410137059
                                         uncertainty =       0.022932576701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122148165
  error estimate for blocks of size 2^( 2) =       0.001163420034
  error estimate for blocks of size 2^( 3) =       0.001196506728
  error estimate for blocks of size 2^( 4) =       0.001219555792
  error estimate for blocks of size 2^( 5) =       0.001235725756
  error estimate for blocks of size 2^( 6) =       0.001246602917
  error estimate for blocks of size 2^( 7) =       0.001253287436

      target function =                  N/A
              le_mean =     -16.718495614212
             les_mean =     282.001088685905
             stat err =       0.001238792976
             autocorr =       1.218700700384
              std dev =       1.586982545342
             le_variance =       2.518513599220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518410161710
                                         uncertainty =       0.022932576663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.518410161710
                                         uncertainty =       0.022932576663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122148171
  error estimate for blocks of size 2^( 2) =       0.001163420039
  error estimate for blocks of size 2^( 3) =       0.001196506732
  error estimate for blocks of size 2^( 4) =       0.001219555797
  error estimate for blocks of size 2^( 5) =       0.001235725762
  error estimate for blocks of size 2^( 6) =       0.001246602922
  error estimate for blocks of size 2^( 7) =       0.001253287442

      target function =                  N/A
              le_mean =     -16.718495614089
             les_mean =     282.001088632279
             stat err =       0.001238792981
             autocorr =       1.218700699186
              std dev =       1.586982553157
             le_variance =       2.518513624025


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718495614072        initial
     3.8147e+03     3.8147e+04             1.3260e-07       -16.718495614352  <--
     1.5259e+04     1.5259e+05             3.3151e-08       -16.718495614212
     6.1035e+04     6.1035e+05             8.2879e-09       -16.718495614089

*****************************************************************************
Applying the update for shift_i =   3.8147e+03     and shift_s =   3.8147e+04
*****************************************************************************

  Execution time = 2.4079e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832363e-02 3 1  ON 2
ci_0004                -4.654917e-02 3 1  ON 3
ci_0005                -4.519374e-02 3 1  ON 4
ci_0006                -4.445536e-02 3 1  ON 5
ci_0007                -3.107077e-02 3 1  ON 6
ci_0008                -3.156860e-02 3 1  ON 7
ci_0009                -3.223193e-02 3 1  ON 8
ci_0010                -3.088091e-02 3 1  ON 9
ci_0011                -2.797523e-02 3 1  ON 10
ci_0012                -2.620342e-02 3 1  ON 11
ci_0013                 2.731744e-02 3 1  ON 12
ci_0014                 2.581361e-02 3 1  ON 13
ci_0015                 2.739681e-02 3 1  ON 14
ci_0016                 2.623906e-02 3 1  ON 15
ci_0017                 2.474515e-02 3 1  ON 16
ci_0018                 2.356886e-02 3 1  ON 17
ci_0019                 1.974940e-02 3 1  ON 18
ci_0020                 1.928549e-02 3 1  ON 19
ci_0021                 1.920541e-02 3 1  ON 20
ci_0022                 1.827985e-02 3 1  ON 21
ci_0023                -1.952978e-02 3 1  ON 22
ci_0024                -1.798067e-02 3 1  ON 23
ci_0025                -1.982106e-02 3 1  ON 24
ci_0026                -1.793467e-02 3 1  ON 25
ci_0027                -1.762448e-02 3 1  ON 26
ci_0028                -1.699009e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639831e-02 3 1  ON 29
ci_0031                 1.492159e-02 3 1  ON 30
ci_0032                 1.379395e-02 3 1  ON 31
ci_0033                 1.771940e-02 3 1  ON 32
ci_0034                 1.525204e-02 3 1  ON 33
ci_0035                 1.751160e-02 3 1  ON 34
ci_0036                 1.622191e-02 3 1  ON 35
ci_0037                -1.546322e-02 3 1  ON 36
ci_0038                -1.407579e-02 3 1  ON 37
ci_0039                -1.580548e-02 3 1  ON 38
ci_0040                -1.502759e-02 3 1  ON 39
ci_0041                 1.593024e-02 3 1  ON 40
ci_0042                 1.602352e-02 3 1  ON 41
ci_0043                -1.557520e-02 3 1  ON 42
ci_0044                -1.526806e-02 3 1  ON 43
ci_0045                 1.455663e-02 3 1  ON 44
ci_0046                 1.488573e-02 3 1  ON 45
ci_0047                -1.481036e-02 3 1  ON 46
ci_0048                -1.411510e-02 3 1  ON 47
ci_0049                -1.321613e-02 3 1  ON 48
ci_0050                -1.301629e-02 3 1  ON 49
ci_0051                -1.291504e-02 3 1  ON 50
ci_0052                -1.258124e-02 3 1  ON 51
ci_0053                -1.311584e-02 3 1  ON 52
ci_0054                -1.246507e-02 3 1  ON 53
ci_0055                 1.224368e-02 3 1  ON 54
ci_0056                 1.302327e-02 3 1  ON 55
ci_0057                 1.354081e-02 3 1  ON 56
ci_0058                 1.206559e-02 3 1  ON 57
ci_0059                -1.338022e-02 3 1  ON 58
ci_0060                -1.268551e-02 3 1  ON 59
ci_0061                -1.297245e-02 3 1  ON 60
ci_0062                -1.259279e-02 3 1  ON 61
ci_0063                -1.198196e-02 3 1  ON 62
ci_0064                -1.109421e-02 3 1  ON 63
ci_0065                -1.219960e-02 3 1  ON 64
ci_0066                -1.123618e-02 3 1  ON 65
ci_0067                -1.122072e-02 3 1  ON 66
ci_0068                -1.093104e-02 3 1  ON 67
ci_0069                 1.096106e-02 3 1  ON 68
ci_0070                 1.053127e-02 3 1  ON 69
ci_0071                 9.801591e-03 3 1  ON 70
ci_0072                 1.001112e-02 3 1  ON 71
ci_0073                 1.103280e-02 3 1  ON 72
ci_0074                 1.093370e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6705e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.7167
    reference variance = 2.11175
====================================================
  Execution time = 1.2998e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0248e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4689e+00
  Total weights = 1.945759473e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1770e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.494787342611
                                         uncertainty =       0.019057105359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.494787342611
                                         uncertainty =       0.019057105359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001116701321
  error estimate for blocks of size 2^( 2) =       0.001155376418
  error estimate for blocks of size 2^( 3) =       0.001187513396
  error estimate for blocks of size 2^( 4) =       0.001211839527
  error estimate for blocks of size 2^( 5) =       0.001225688040
  error estimate for blocks of size 2^( 6) =       0.001229617483
  error estimate for blocks of size 2^( 7) =       0.001234650115

      target function =                  N/A
              le_mean =     -16.718702729768
             les_mean =     281.983954157779
             stat err =       0.001225448791
             autocorr =       1.204248947517
              std dev =       1.579279421678
             le_variance =       2.494123491735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671870272977e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718702728858       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718702739644       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718702739612       residual = 1.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+02 is 4.898724e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718702728858       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718702731555       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718702731547       residual = 1.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+03 is 1.224763e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718702728858       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718702729532       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718702729530       residual = 1.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+04 is 3.061959e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101827 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6182e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832370e-02 3 1  ON 2
ci_0004                -4.654919e-02 3 1  ON 3
ci_0005                -4.519377e-02 3 1  ON 4
ci_0006                -4.445532e-02 3 1  ON 5
ci_0007                -3.107090e-02 3 1  ON 6
ci_0008                -3.156861e-02 3 1  ON 7
ci_0009                -3.223198e-02 3 1  ON 8
ci_0010                -3.088089e-02 3 1  ON 9
ci_0011                -2.797519e-02 3 1  ON 10
ci_0012                -2.620352e-02 3 1  ON 11
ci_0013                 2.731750e-02 3 1  ON 12
ci_0014                 2.581361e-02 3 1  ON 13
ci_0015                 2.739683e-02 3 1  ON 14
ci_0016                 2.623901e-02 3 1  ON 15
ci_0017                 2.474510e-02 3 1  ON 16
ci_0018                 2.356884e-02 3 1  ON 17
ci_0019                 1.974947e-02 3 1  ON 18
ci_0020                 1.928550e-02 3 1  ON 19
ci_0021                 1.920539e-02 3 1  ON 20
ci_0022                 1.827984e-02 3 1  ON 21
ci_0023                -1.952973e-02 3 1  ON 22
ci_0024                -1.798068e-02 3 1  ON 23
ci_0025                -1.982096e-02 3 1  ON 24
ci_0026                -1.793456e-02 3 1  ON 25
ci_0027                -1.762451e-02 3 1  ON 26
ci_0028                -1.699009e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639834e-02 3 1  ON 29
ci_0031                 1.492156e-02 3 1  ON 30
ci_0032                 1.379398e-02 3 1  ON 31
ci_0033                 1.771938e-02 3 1  ON 32
ci_0034                 1.525206e-02 3 1  ON 33
ci_0035                 1.751157e-02 3 1  ON 34
ci_0036                 1.622190e-02 3 1  ON 35
ci_0037                -1.546327e-02 3 1  ON 36
ci_0038                -1.407585e-02 3 1  ON 37
ci_0039                -1.580546e-02 3 1  ON 38
ci_0040                -1.502755e-02 3 1  ON 39
ci_0041                 1.593026e-02 3 1  ON 40
ci_0042                 1.602354e-02 3 1  ON 41
ci_0043                -1.557515e-02 3 1  ON 42
ci_0044                -1.526804e-02 3 1  ON 43
ci_0045                 1.455665e-02 3 1  ON 44
ci_0046                 1.488575e-02 3 1  ON 45
ci_0047                -1.481031e-02 3 1  ON 46
ci_0048                -1.411511e-02 3 1  ON 47
ci_0049                -1.321611e-02 3 1  ON 48
ci_0050                -1.301625e-02 3 1  ON 49
ci_0051                -1.291499e-02 3 1  ON 50
ci_0052                -1.258131e-02 3 1  ON 51
ci_0053                -1.311581e-02 3 1  ON 52
ci_0054                -1.246505e-02 3 1  ON 53
ci_0055                 1.224369e-02 3 1  ON 54
ci_0056                 1.302325e-02 3 1  ON 55
ci_0057                 1.354079e-02 3 1  ON 56
ci_0058                 1.206559e-02 3 1  ON 57
ci_0059                -1.338021e-02 3 1  ON 58
ci_0060                -1.268557e-02 3 1  ON 59
ci_0061                -1.297248e-02 3 1  ON 60
ci_0062                -1.259281e-02 3 1  ON 61
ci_0063                -1.198196e-02 3 1  ON 62
ci_0064                -1.109431e-02 3 1  ON 63
ci_0065                -1.219954e-02 3 1  ON 64
ci_0066                -1.123628e-02 3 1  ON 65
ci_0067                -1.122077e-02 3 1  ON 66
ci_0068                -1.093099e-02 3 1  ON 67
ci_0069                 1.096107e-02 3 1  ON 68
ci_0070                 1.053125e-02 3 1  ON 69
ci_0071                 9.801543e-03 3 1  ON 70
ci_0072                 1.001105e-02 3 1  ON 71
ci_0073                 1.103269e-02 3 1  ON 72
ci_0074                 1.093374e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.4282
    reference variance = 6.72095
====================================================
  Execution time = 1.2658e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.4979e+00
  Total weights = 1.9461e+06
  Execution time = 2.2214e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.523707628390
                                         uncertainty =       0.021541128442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.523707628390
                                         uncertainty =       0.021541128442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123357188
  error estimate for blocks of size 2^( 2) =       0.001161602210
  error estimate for blocks of size 2^( 3) =       0.001193877077
  error estimate for blocks of size 2^( 4) =       0.001218162429
  error estimate for blocks of size 2^( 5) =       0.001233608898
  error estimate for blocks of size 2^( 6) =       0.001241292229
  error estimate for blocks of size 2^( 7) =       0.001247018541

      target function =                  N/A
              le_mean =     -16.716504264906
             les_mean =     281.939396843974
             stat err =       0.001235020524
             autocorr =       1.208683553409
              std dev =       1.588692389265
             le_variance =       2.523943507710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.523707108977
                                         uncertainty =       0.021541130748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.523707108977
                                         uncertainty =       0.021541130748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123357073
  error estimate for blocks of size 2^( 2) =       0.001161602092
  error estimate for blocks of size 2^( 3) =       0.001193876960
  error estimate for blocks of size 2^( 4) =       0.001218162306
  error estimate for blocks of size 2^( 5) =       0.001233608772
  error estimate for blocks of size 2^( 6) =       0.001241292117
  error estimate for blocks of size 2^( 7) =       0.001247018426

      target function =                  N/A
              le_mean =     -16.716504268278
             les_mean =     281.939396008384
             stat err =       0.001235020405
             autocorr =       1.208683569237
              std dev =       1.588692225832
             le_variance =       2.523942988420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.523707368619
                                         uncertainty =       0.021541129595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.523707368619
                                         uncertainty =       0.021541129595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123357130
  error estimate for blocks of size 2^( 2) =       0.001161602151
  error estimate for blocks of size 2^( 3) =       0.001193877019
  error estimate for blocks of size 2^( 4) =       0.001218162367
  error estimate for blocks of size 2^( 5) =       0.001233608835
  error estimate for blocks of size 2^( 6) =       0.001241292172
  error estimate for blocks of size 2^( 7) =       0.001247018483

      target function =                  N/A
              le_mean =     -16.716504266591
             les_mean =     281.939396425473
             stat err =       0.001235020465
             autocorr =       1.208683561326
              std dev =       1.588692307529
             le_variance =       2.523943248001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.523707595915
                                         uncertainty =       0.021541128586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.523707595915
                                         uncertainty =       0.021541128586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123357181
  error estimate for blocks of size 2^( 2) =       0.001161602203
  error estimate for blocks of size 2^( 3) =       0.001193877070
  error estimate for blocks of size 2^( 4) =       0.001218162421
  error estimate for blocks of size 2^( 5) =       0.001233608890
  error estimate for blocks of size 2^( 6) =       0.001241292221
  error estimate for blocks of size 2^( 7) =       0.001247018534

      target function =                  N/A
              le_mean =     -16.716504265116
             les_mean =     281.939396791592
             stat err =       0.001235020517
             autocorr =       1.208683554398
              std dev =       1.588692379047
             le_variance =       2.523943475243


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716504264906        initial
     9.5367e+02     9.5367e+03             4.8987e-07       -16.716504268278  <--
     3.8147e+03     3.8147e+04             1.2248e-07       -16.716504266591
     1.5259e+04     1.5259e+05             3.0620e-08       -16.716504265116

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 2.4030e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832391e-02 3 1  ON 2
ci_0004                -4.654924e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445521e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088084e-02 3 1  ON 9
ci_0011                -2.797505e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731768e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974967e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982065e-02 3 1  ON 24
ci_0026                -1.793424e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654640e-02 3 1  ON 28
ci_0030                -1.639844e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379409e-02 3 1  ON 31
ci_0033                 1.771932e-02 3 1  ON 32
ci_0034                 1.525210e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546342e-02 3 1  ON 36
ci_0038                -1.407601e-02 3 1  ON 37
ci_0039                -1.580542e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593033e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557501e-02 3 1  ON 42
ci_0044                -1.526797e-02 3 1  ON 43
ci_0045                 1.455671e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321607e-02 3 1  ON 48
ci_0050                -1.301612e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258152e-02 3 1  ON 51
ci_0053                -1.311572e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224372e-02 3 1  ON 54
ci_0056                 1.302319e-02 3 1  ON 55
ci_0057                 1.354074e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338016e-02 3 1  ON 58
ci_0060                -1.268577e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198196e-02 3 1  ON 62
ci_0064                -1.109463e-02 3 1  ON 63
ci_0065                -1.219937e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122092e-02 3 1  ON 66
ci_0068                -1.093086e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801398e-03 3 1  ON 70
ci_0072                 1.001084e-02 3 1  ON 71
ci_0073                 1.103236e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0218e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6699e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8211
    reference variance = 1.80615
====================================================
  Execution time = 1.2966e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0263e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5052e+00
  Total weights = 1.945868526e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1702e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534197684477
                                         uncertainty =       0.027483660197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.534197684477
                                         uncertainty =       0.027483660197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125674331
  error estimate for blocks of size 2^( 2) =       0.001164551292
  error estimate for blocks of size 2^( 3) =       0.001197726104
  error estimate for blocks of size 2^( 4) =       0.001220578812
  error estimate for blocks of size 2^( 5) =       0.001234247425
  error estimate for blocks of size 2^( 6) =       0.001243951635
  error estimate for blocks of size 2^( 7) =       0.001257335923

      target function =                  N/A
              le_mean =     -16.718270460281
             les_mean =     282.005742271960
             stat err =       0.001239028449
             autocorr =       1.211537973584
              std dev =       1.591969375944
             le_variance =       2.534366493944


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671827046028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718270459412       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718270508098       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718270508352       residual = 7.19e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+02 is 1.449637e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718270459412       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718270471592       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718270471655       residual = 7.17e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+02 is 3.627976e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718270459412       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718270462458       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718270462473       residual = 7.17e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+03 is 9.072371e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6142e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782563e-01 3 1  ON 1
ci_0003                -4.832407e-02 3 1  ON 2
ci_0004                -4.654917e-02 3 1  ON 3
ci_0005                -4.519406e-02 3 1  ON 4
ci_0006                -4.445532e-02 3 1  ON 5
ci_0007                -3.107134e-02 3 1  ON 6
ci_0008                -3.156878e-02 3 1  ON 7
ci_0009                -3.223231e-02 3 1  ON 8
ci_0010                -3.088087e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620389e-02 3 1  ON 11
ci_0013                 2.731762e-02 3 1  ON 12
ci_0014                 2.581366e-02 3 1  ON 13
ci_0015                 2.739712e-02 3 1  ON 14
ci_0016                 2.623867e-02 3 1  ON 15
ci_0017                 2.474500e-02 3 1  ON 16
ci_0018                 2.356901e-02 3 1  ON 17
ci_0019                 1.974987e-02 3 1  ON 18
ci_0020                 1.928535e-02 3 1  ON 19
ci_0021                 1.920531e-02 3 1  ON 20
ci_0022                 1.828006e-02 3 1  ON 21
ci_0023                -1.952988e-02 3 1  ON 22
ci_0024                -1.798095e-02 3 1  ON 23
ci_0025                -1.982049e-02 3 1  ON 24
ci_0026                -1.793414e-02 3 1  ON 25
ci_0027                -1.762471e-02 3 1  ON 26
ci_0028                -1.699025e-02 3 1  ON 27
ci_0029                -1.654632e-02 3 1  ON 28
ci_0030                -1.639824e-02 3 1  ON 29
ci_0031                 1.492172e-02 3 1  ON 30
ci_0032                 1.379441e-02 3 1  ON 31
ci_0033                 1.771908e-02 3 1  ON 32
ci_0034                 1.525244e-02 3 1  ON 33
ci_0035                 1.751146e-02 3 1  ON 34
ci_0036                 1.622169e-02 3 1  ON 35
ci_0037                -1.546333e-02 3 1  ON 36
ci_0038                -1.407610e-02 3 1  ON 37
ci_0039                -1.580520e-02 3 1  ON 38
ci_0040                -1.502731e-02 3 1  ON 39
ci_0041                 1.593043e-02 3 1  ON 40
ci_0042                 1.602356e-02 3 1  ON 41
ci_0043                -1.557511e-02 3 1  ON 42
ci_0044                -1.526788e-02 3 1  ON 43
ci_0045                 1.455693e-02 3 1  ON 44
ci_0046                 1.488588e-02 3 1  ON 45
ci_0047                -1.481029e-02 3 1  ON 46
ci_0048                -1.411525e-02 3 1  ON 47
ci_0049                -1.321619e-02 3 1  ON 48
ci_0050                -1.301601e-02 3 1  ON 49
ci_0051                -1.291520e-02 3 1  ON 50
ci_0052                -1.258160e-02 3 1  ON 51
ci_0053                -1.311587e-02 3 1  ON 52
ci_0054                -1.246486e-02 3 1  ON 53
ci_0055                 1.224370e-02 3 1  ON 54
ci_0056                 1.302315e-02 3 1  ON 55
ci_0057                 1.354047e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338004e-02 3 1  ON 58
ci_0060                -1.268605e-02 3 1  ON 59
ci_0061                -1.297260e-02 3 1  ON 60
ci_0062                -1.259293e-02 3 1  ON 61
ci_0063                -1.198219e-02 3 1  ON 62
ci_0064                -1.109488e-02 3 1  ON 63
ci_0065                -1.219915e-02 3 1  ON 64
ci_0066                -1.123650e-02 3 1  ON 65
ci_0067                -1.122104e-02 3 1  ON 66
ci_0068                -1.093080e-02 3 1  ON 67
ci_0069                 1.096125e-02 3 1  ON 68
ci_0070                 1.053117e-02 3 1  ON 69
ci_0071                 9.801167e-03 3 1  ON 70
ci_0072                 1.001058e-02 3 1  ON 71
ci_0073                 1.103227e-02 3 1  ON 72
ci_0074                 1.093385e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.7108
    reference variance = 2.86491
====================================================
  Execution time = 1.2647e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5155e+00
  Total weights = 1.9456e+06
  Execution time = 2.2253e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544565701172
                                         uncertainty =       0.027768825933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544565701172
                                         uncertainty =       0.027768825933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127860014
  error estimate for blocks of size 2^( 2) =       0.001166866316
  error estimate for blocks of size 2^( 3) =       0.001199958617
  error estimate for blocks of size 2^( 4) =       0.001222676788
  error estimate for blocks of size 2^( 5) =       0.001235757464
  error estimate for blocks of size 2^( 6) =       0.001247891683
  error estimate for blocks of size 2^( 7) =       0.001249275944

      target function =                  N/A
              le_mean =     -16.717247234569
             les_mean =     281.981871340083
             stat err =       0.001238900470
             autocorr =       1.206597538817
              std dev =       1.595060449128
             le_variance =       2.544217836373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544564960156
                                         uncertainty =       0.027768825145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544564960156
                                         uncertainty =       0.027768825145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127859851
  error estimate for blocks of size 2^( 2) =       0.001166866079
  error estimate for blocks of size 2^( 3) =       0.001199958296
  error estimate for blocks of size 2^( 4) =       0.001222676387
  error estimate for blocks of size 2^( 5) =       0.001235756983
  error estimate for blocks of size 2^( 6) =       0.001247891201
  error estimate for blocks of size 2^( 7) =       0.001249275525

      target function =                  N/A
              le_mean =     -16.717247221706
             les_mean =     281.981787216924
             stat err =       0.001238900024
             autocorr =       1.206597020968
              std dev =       1.595060217407
             le_variance =       2.544217097156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544565330341
                                         uncertainty =       0.027768825542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544565330341
                                         uncertainty =       0.027768825542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127859932
  error estimate for blocks of size 2^( 2) =       0.001166866197
  error estimate for blocks of size 2^( 3) =       0.001199958456
  error estimate for blocks of size 2^( 4) =       0.001222676587
  error estimate for blocks of size 2^( 5) =       0.001235757223
  error estimate for blocks of size 2^( 6) =       0.001247891442
  error estimate for blocks of size 2^( 7) =       0.001249275734

      target function =                  N/A
              le_mean =     -16.717247228123
             les_mean =     281.981817807997
             stat err =       0.001238900247
             autocorr =       1.206597279700
              std dev =       1.595060333167
             le_variance =       2.544217466442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544565654797
                                         uncertainty =       0.027768825884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544565654797
                                         uncertainty =       0.027768825884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127860004
  error estimate for blocks of size 2^( 2) =       0.001166866301
  error estimate for blocks of size 2^( 3) =       0.001199958597
  error estimate for blocks of size 2^( 4) =       0.001222676763
  error estimate for blocks of size 2^( 5) =       0.001235757434
  error estimate for blocks of size 2^( 6) =       0.001247891653
  error estimate for blocks of size 2^( 7) =       0.001249275918

      target function =                  N/A
              le_mean =     -16.717247233763
             les_mean =     281.981862600020
             stat err =       0.001238900442
             autocorr =       1.206597506426
              std dev =       1.595060434626
             le_variance =       2.544217790111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717247234569        initial  <--
     2.3842e+02     2.3842e+03             1.4496e-06       -16.717247221706
     9.5367e+02     9.5367e+03             3.6280e-07       -16.717247228123
     3.8147e+03     3.8147e+04             9.0724e-08       -16.717247233763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0461
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832391e-02 3 1  ON 2
ci_0004                -4.654924e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445521e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088084e-02 3 1  ON 9
ci_0011                -2.797505e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731768e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974967e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982065e-02 3 1  ON 24
ci_0026                -1.793424e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654640e-02 3 1  ON 28
ci_0030                -1.639844e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379409e-02 3 1  ON 31
ci_0033                 1.771932e-02 3 1  ON 32
ci_0034                 1.525210e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546342e-02 3 1  ON 36
ci_0038                -1.407601e-02 3 1  ON 37
ci_0039                -1.580542e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593033e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557501e-02 3 1  ON 42
ci_0044                -1.526797e-02 3 1  ON 43
ci_0045                 1.455671e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321607e-02 3 1  ON 48
ci_0050                -1.301612e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258152e-02 3 1  ON 51
ci_0053                -1.311572e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224372e-02 3 1  ON 54
ci_0056                 1.302319e-02 3 1  ON 55
ci_0057                 1.354074e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338016e-02 3 1  ON 58
ci_0060                -1.268577e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198196e-02 3 1  ON 62
ci_0064                -1.109463e-02 3 1  ON 63
ci_0065                -1.219937e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122092e-02 3 1  ON 66
ci_0068                -1.093086e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801398e-03 3 1  ON 70
ci_0072                 1.001084e-02 3 1  ON 71
ci_0073                 1.103236e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6702e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.743
    reference variance = 1.71073
====================================================
  Execution time = 1.3016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0262e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 3.4915e+00
  Total weights = 1.945755969e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1923e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.547971279649
                                         uncertainty =       1.010596930466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       3.547971279649
                                         uncertainty =       1.010596930466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001330994446
  error estimate for blocks of size 2^( 2) =       0.001363884504
  error estimate for blocks of size 2^( 3) =       0.001393377334
  error estimate for blocks of size 2^( 4) =       0.001412238395
  error estimate for blocks of size 2^( 5) =       0.001424986808
  error estimate for blocks of size 2^( 6) =       0.001437093423
  error estimate for blocks of size 2^( 7) =       0.001436735110

      target function =                  N/A
              le_mean =     -16.718633972773
             les_mean =     283.004190474787
             stat err =       0.001427763434
             autocorr =       1.150694464240
              std dev =       1.882340513806
             le_variance =       3.543205809916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671863397277e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718633971876       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718633975900       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718633975908       residual = 1.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+03 is 1.739578e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718633971876       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718633972882       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718633972884       residual = 1.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+03 is 4.349280e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718633971876       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718633972128       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718633972128       residual = 1.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+04 is 1.087341e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104162 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6215e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832392e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519390e-02 3 1  ON 4
ci_0006                -4.445524e-02 3 1  ON 5
ci_0007                -3.107123e-02 3 1  ON 6
ci_0008                -3.156864e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088087e-02 3 1  ON 9
ci_0011                -2.797506e-02 3 1  ON 10
ci_0012                -2.620384e-02 3 1  ON 11
ci_0013                 2.731768e-02 3 1  ON 12
ci_0014                 2.581368e-02 3 1  ON 13
ci_0015                 2.739693e-02 3 1  ON 14
ci_0016                 2.623886e-02 3 1  ON 15
ci_0017                 2.474495e-02 3 1  ON 16
ci_0018                 2.356877e-02 3 1  ON 17
ci_0019                 1.974972e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920531e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982062e-02 3 1  ON 24
ci_0026                -1.793422e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699008e-02 3 1  ON 27
ci_0029                -1.654641e-02 3 1  ON 28
ci_0030                -1.639845e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379411e-02 3 1  ON 31
ci_0033                 1.771934e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407603e-02 3 1  ON 37
ci_0039                -1.580544e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593034e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488581e-02 3 1  ON 45
ci_0047                -1.481016e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321604e-02 3 1  ON 48
ci_0050                -1.301612e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258152e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246494e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302316e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268576e-02 3 1  ON 59
ci_0061                -1.297257e-02 3 1  ON 60
ci_0062                -1.259286e-02 3 1  ON 61
ci_0063                -1.198196e-02 3 1  ON 62
ci_0064                -1.109465e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122092e-02 3 1  ON 66
ci_0068                -1.093084e-02 3 1  ON 67
ci_0069                 1.096110e-02 3 1  ON 68
ci_0070                 1.053122e-02 3 1  ON 69
ci_0071                 9.801420e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103239e-02 3 1  ON 72
ci_0074                 1.093389e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.7748
    reference variance = 1.50206
====================================================
  Execution time = 1.2686e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5203e+00
  Total weights = 1.9459e+06
  Execution time = 2.2318e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547150083260
                                         uncertainty =       0.025114521788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547150083260
                                         uncertainty =       0.025114521788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128380824
  error estimate for blocks of size 2^( 2) =       0.001166044633
  error estimate for blocks of size 2^( 3) =       0.001197971198
  error estimate for blocks of size 2^( 4) =       0.001222840588
  error estimate for blocks of size 2^( 5) =       0.001236411753
  error estimate for blocks of size 2^( 6) =       0.001247738275
  error estimate for blocks of size 2^( 7) =       0.001255255361

      target function =                  N/A
              le_mean =     -16.718342816842
             les_mean =     282.023278272726
             stat err =       0.001240561494
             autocorr =       1.208718585716
              std dev =       1.595796996735
             le_variance =       2.546568054788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547149853993
                                         uncertainty =       0.025114522316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547149853993
                                         uncertainty =       0.025114522316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128380773
  error estimate for blocks of size 2^( 2) =       0.001166044576
  error estimate for blocks of size 2^( 3) =       0.001197971137
  error estimate for blocks of size 2^( 4) =       0.001222840519
  error estimate for blocks of size 2^( 5) =       0.001236411677
  error estimate for blocks of size 2^( 6) =       0.001247738202
  error estimate for blocks of size 2^( 7) =       0.001255255287

      target function =                  N/A
              le_mean =     -16.718342813883
             les_mean =     282.023277822770
             stat err =       0.001240561421
             autocorr =       1.208718551974
              std dev =       1.595796924900
             le_variance =       2.546567825520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547149968617
                                         uncertainty =       0.025114522052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547149968617
                                         uncertainty =       0.025114522052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128380798
  error estimate for blocks of size 2^( 2) =       0.001166044605
  error estimate for blocks of size 2^( 3) =       0.001197971167
  error estimate for blocks of size 2^( 4) =       0.001222840553
  error estimate for blocks of size 2^( 5) =       0.001236411715
  error estimate for blocks of size 2^( 6) =       0.001247738238
  error estimate for blocks of size 2^( 7) =       0.001255255324

      target function =                  N/A
              le_mean =     -16.718342815362
             les_mean =     282.023278047610
             stat err =       0.001240561458
             autocorr =       1.208718568844
              std dev =       1.595796960814
             le_variance =       2.546567940144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547150068929
                                         uncertainty =       0.025114521821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.547150068929
                                         uncertainty =       0.025114521821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128380821
  error estimate for blocks of size 2^( 2) =       0.001166044630
  error estimate for blocks of size 2^( 3) =       0.001197971194
  error estimate for blocks of size 2^( 4) =       0.001222840584
  error estimate for blocks of size 2^( 5) =       0.001236411748
  error estimate for blocks of size 2^( 6) =       0.001247738271
  error estimate for blocks of size 2^( 7) =       0.001255255356

      target function =                  N/A
              le_mean =     -16.718342816657
             les_mean =     282.023278244572
             stat err =       0.001240561490
             autocorr =       1.208718583608
              std dev =       1.595796992245
             le_variance =       2.546568040457


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718342816842        initial  <--
     2.3842e+03     2.3842e+04             1.7396e-07       -16.718342813883
     9.5367e+03     9.5367e+04             4.3493e-08       -16.718342815362
     3.8147e+04     3.8147e+05             1.0873e-08       -16.718342816657

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0845
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832391e-02 3 1  ON 2
ci_0004                -4.654924e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445521e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088084e-02 3 1  ON 9
ci_0011                -2.797505e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731768e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974967e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982065e-02 3 1  ON 24
ci_0026                -1.793424e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654640e-02 3 1  ON 28
ci_0030                -1.639844e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379409e-02 3 1  ON 31
ci_0033                 1.771932e-02 3 1  ON 32
ci_0034                 1.525210e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546342e-02 3 1  ON 36
ci_0038                -1.407601e-02 3 1  ON 37
ci_0039                -1.580542e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593033e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557501e-02 3 1  ON 42
ci_0044                -1.526797e-02 3 1  ON 43
ci_0045                 1.455671e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321607e-02 3 1  ON 48
ci_0050                -1.301612e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258152e-02 3 1  ON 51
ci_0053                -1.311572e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224372e-02 3 1  ON 54
ci_0056                 1.302319e-02 3 1  ON 55
ci_0057                 1.354074e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338016e-02 3 1  ON 58
ci_0060                -1.268577e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198196e-02 3 1  ON 62
ci_0064                -1.109463e-02 3 1  ON 63
ci_0065                -1.219937e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122092e-02 3 1  ON 66
ci_0068                -1.093086e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801398e-03 3 1  ON 70
ci_0072                 1.001084e-02 3 1  ON 71
ci_0073                 1.103236e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0307e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6704e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.3548
    reference variance = 2.87385
====================================================
  Execution time = 1.2974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0278e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5081e+00
  Total weights = 1.945693926e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2109e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530350595309
                                         uncertainty =       0.024294792913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530350595309
                                         uncertainty =       0.024294792913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126028093
  error estimate for blocks of size 2^( 2) =       0.001164748815
  error estimate for blocks of size 2^( 3) =       0.001196135822
  error estimate for blocks of size 2^( 4) =       0.001218405246
  error estimate for blocks of size 2^( 5) =       0.001232728315
  error estimate for blocks of size 2^( 6) =       0.001237899465
  error estimate for blocks of size 2^( 7) =       0.001247061208

      target function =                  N/A
              le_mean =     -16.717520142792
             les_mean =     281.983622853277
             stat err =       0.001234023558
             autocorr =       1.201015050553
              std dev =       1.592469680109
             le_variance =       2.535959682068


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671752014279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717520141875       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717520142549       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717520142556       residual = 5.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+04 is 1.993883e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717520141875       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717520142043       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717520142045       residual = 5.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+04 is 4.984739e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717520141875       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717520141917       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717520141917       residual = 5.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+05 is 1.246187e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6191e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832391e-02 3 1  ON 2
ci_0004                -4.654924e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445521e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088084e-02 3 1  ON 9
ci_0011                -2.797505e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731768e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982065e-02 3 1  ON 24
ci_0026                -1.793424e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639844e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379409e-02 3 1  ON 31
ci_0033                 1.771932e-02 3 1  ON 32
ci_0034                 1.525210e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622186e-02 3 1  ON 35
ci_0037                -1.546342e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580542e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593033e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557501e-02 3 1  ON 42
ci_0044                -1.526797e-02 3 1  ON 43
ci_0045                 1.455671e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411513e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301612e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311572e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302319e-02 3 1  ON 55
ci_0057                 1.354073e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338016e-02 3 1  ON 58
ci_0060                -1.268577e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198196e-02 3 1  ON 62
ci_0064                -1.109463e-02 3 1  ON 63
ci_0065                -1.219936e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093086e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801401e-03 3 1  ON 70
ci_0072                 1.001084e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9376
    reference variance = 2.05052
====================================================
  Execution time = 1.2649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6722e+01
  VMC Evar = 2.5010e+00
  Total weights = 1.9458e+06
  Execution time = 2.2182e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530555415401
                                         uncertainty =       0.037633372868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530555415401
                                         uncertainty =       0.037633372868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124657092
  error estimate for blocks of size 2^( 2) =       0.001163334555
  error estimate for blocks of size 2^( 3) =       0.001196789250
  error estimate for blocks of size 2^( 4) =       0.001219991137
  error estimate for blocks of size 2^( 5) =       0.001232999427
  error estimate for blocks of size 2^( 6) =       0.001243347184
  error estimate for blocks of size 2^( 7) =       0.001247086591

      target function =                  N/A
              le_mean =     -16.721743176171
             les_mean =     282.117706797453
             stat err =       0.001235856085
             autocorr =       1.207523378772
              std dev =       1.590530760409
             le_variance =       2.529788099806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530555407839
                                         uncertainty =       0.037633373241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530555407839
                                         uncertainty =       0.037633373241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124657090
  error estimate for blocks of size 2^( 2) =       0.001163334554
  error estimate for blocks of size 2^( 3) =       0.001196789250
  error estimate for blocks of size 2^( 4) =       0.001219991138
  error estimate for blocks of size 2^( 5) =       0.001232999428
  error estimate for blocks of size 2^( 6) =       0.001243347184
  error estimate for blocks of size 2^( 7) =       0.001247086590

      target function =                  N/A
              le_mean =     -16.721743176230
             les_mean =     282.117706751803
             stat err =       0.001235856085
             autocorr =       1.207523382822
              std dev =       1.590530758043
             le_variance =       2.529788092279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530555411620
                                         uncertainty =       0.037633373055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530555411620
                                         uncertainty =       0.037633373055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124657091
  error estimate for blocks of size 2^( 2) =       0.001163334554
  error estimate for blocks of size 2^( 3) =       0.001196789250
  error estimate for blocks of size 2^( 4) =       0.001219991137
  error estimate for blocks of size 2^( 5) =       0.001232999427
  error estimate for blocks of size 2^( 6) =       0.001243347184
  error estimate for blocks of size 2^( 7) =       0.001247086590

      target function =                  N/A
              le_mean =     -16.721743176200
             les_mean =     282.117706774623
             stat err =       0.001235856085
             autocorr =       1.207523380798
              std dev =       1.590530759226
             le_variance =       2.529788096043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530555414928
                                         uncertainty =       0.037633372891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.530555414928
                                         uncertainty =       0.037633372891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124657092
  error estimate for blocks of size 2^( 2) =       0.001163334555
  error estimate for blocks of size 2^( 3) =       0.001196789250
  error estimate for blocks of size 2^( 4) =       0.001219991137
  error estimate for blocks of size 2^( 5) =       0.001232999427
  error estimate for blocks of size 2^( 6) =       0.001243347184
  error estimate for blocks of size 2^( 7) =       0.001247086591

      target function =                  N/A
              le_mean =     -16.721743176174
             les_mean =     282.117706794599
             stat err =       0.001235856085
             autocorr =       1.207523379026
              std dev =       1.590530760261
             le_variance =       2.529788099336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.721743176171        initial
     2.3842e+04     2.3842e+05             1.9939e-08       -16.721743176230  <--
     9.5367e+04     9.5367e+05             4.9847e-09       -16.721743176200
     3.8147e+05     3.8147e+06             1.2462e-09       -16.721743176174

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 2.3998e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0200e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6702e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.7356
    reference variance = 1.10506
====================================================
  Execution time = 1.2941e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0308e+04
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5511e+00
  Total weights = 1.946162961e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1455e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.578321280118
                                         uncertainty =       0.026023390448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.578321280118
                                         uncertainty =       0.026023390448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135276684
  error estimate for blocks of size 2^( 2) =       0.001174313392
  error estimate for blocks of size 2^( 3) =       0.001206520261
  error estimate for blocks of size 2^( 4) =       0.001229637787
  error estimate for blocks of size 2^( 5) =       0.001243257479
  error estimate for blocks of size 2^( 6) =       0.001250782686
  error estimate for blocks of size 2^( 7) =       0.001254964998

      target function =                  N/A
              le_mean =     -16.715923007321
             les_mean =     281.973217753299
             stat err =       0.001244660738
             autocorr =       1.201983602377
              std dev =       1.605549371960
             le_variance =       2.577788785802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671592300732e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715923006368       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715923010820       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715923010871       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+03 is 7.316707e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715923006368       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715923007481       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715923007494       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+04 is 1.829230e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.715923006368       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.715923006646       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.715923006649       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+04 is 4.573107e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106498 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6093e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782565e-01 3 1  ON 1
ci_0003                -4.832389e-02 3 1  ON 2
ci_0004                -4.654924e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445519e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223213e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731768e-02 3 1  ON 12
ci_0014                 2.581363e-02 3 1  ON 13
ci_0015                 2.739689e-02 3 1  ON 14
ci_0016                 2.623883e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356877e-02 3 1  ON 17
ci_0019                 1.974969e-02 3 1  ON 18
ci_0020                 1.928554e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827981e-02 3 1  ON 21
ci_0023                -1.952957e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982062e-02 3 1  ON 24
ci_0026                -1.793422e-02 3 1  ON 25
ci_0027                -1.762459e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639842e-02 3 1  ON 29
ci_0031                 1.492148e-02 3 1  ON 30
ci_0032                 1.379409e-02 3 1  ON 31
ci_0033                 1.771930e-02 3 1  ON 32
ci_0034                 1.525212e-02 3 1  ON 33
ci_0035                 1.751148e-02 3 1  ON 34
ci_0036                 1.622188e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580540e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593033e-02 3 1  ON 40
ci_0042                 1.602360e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526797e-02 3 1  ON 43
ci_0045                 1.455673e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481013e-02 3 1  ON 46
ci_0048                -1.411511e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301612e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258152e-02 3 1  ON 51
ci_0053                -1.311574e-02 3 1  ON 52
ci_0054                -1.246497e-02 3 1  ON 53
ci_0055                 1.224370e-02 3 1  ON 54
ci_0056                 1.302319e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206558e-02 3 1  ON 57
ci_0059                -1.338016e-02 3 1  ON 58
ci_0060                -1.268579e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198194e-02 3 1  ON 62
ci_0064                -1.109463e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123657e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096113e-02 3 1  ON 68
ci_0070                 1.053120e-02 3 1  ON 69
ci_0071                 9.801419e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103236e-02 3 1  ON 72
ci_0074                 1.093386e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.6098
    reference variance = 2.34867
====================================================
  Execution time = 1.2651e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6715e+01
  VMC Evar = 2.5310e+00
  Total weights = 1.9457e+06
  Execution time = 2.2384e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558403049757
                                         uncertainty =       0.023196878938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558403049757
                                         uncertainty =       0.023196878938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130928787
  error estimate for blocks of size 2^( 2) =       0.001170083792
  error estimate for blocks of size 2^( 3) =       0.001201237102
  error estimate for blocks of size 2^( 4) =       0.001223238375
  error estimate for blocks of size 2^( 5) =       0.001235147235
  error estimate for blocks of size 2^( 6) =       0.001245405251
  error estimate for blocks of size 2^( 7) =       0.001251877831

      target function =                  N/A
              le_mean =     -16.714962050854
             les_mean =     281.920989161777
             stat err =       0.001238917173
             autocorr =       1.200090582868
              std dev =       1.599400418768
             le_variance =       2.558081699554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558403099921
                                         uncertainty =       0.023196878628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558403099921
                                         uncertainty =       0.023196878628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130928798
  error estimate for blocks of size 2^( 2) =       0.001170083804
  error estimate for blocks of size 2^( 3) =       0.001201237115
  error estimate for blocks of size 2^( 4) =       0.001223238386
  error estimate for blocks of size 2^( 5) =       0.001235147244
  error estimate for blocks of size 2^( 6) =       0.001245405258
  error estimate for blocks of size 2^( 7) =       0.001251877835

      target function =                  N/A
              le_mean =     -16.714962050849
             les_mean =     281.920989046333
             stat err =       0.001238917181
             autocorr =       1.200090574623
              std dev =       1.599400434492
             le_variance =       2.558081749852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558403074839
                                         uncertainty =       0.023196878783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558403074839
                                         uncertainty =       0.023196878783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130928793
  error estimate for blocks of size 2^( 2) =       0.001170083798
  error estimate for blocks of size 2^( 3) =       0.001201237109
  error estimate for blocks of size 2^( 4) =       0.001223238381
  error estimate for blocks of size 2^( 5) =       0.001235147240
  error estimate for blocks of size 2^( 6) =       0.001245405254
  error estimate for blocks of size 2^( 7) =       0.001251877833

      target function =                  N/A
              le_mean =     -16.714962050852
             les_mean =     281.920989104044
             stat err =       0.001238917177
             autocorr =       1.200090578746
              std dev =       1.599400426630
             le_variance =       2.558081724704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558403052892
                                         uncertainty =       0.023196878918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.558403052892
                                         uncertainty =       0.023196878918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130928788
  error estimate for blocks of size 2^( 2) =       0.001170083792
  error estimate for blocks of size 2^( 3) =       0.001201237103
  error estimate for blocks of size 2^( 4) =       0.001223238376
  error estimate for blocks of size 2^( 5) =       0.001235147236
  error estimate for blocks of size 2^( 6) =       0.001245405251
  error estimate for blocks of size 2^( 7) =       0.001251877831

      target function =                  N/A
              le_mean =     -16.714962050854
             les_mean =     281.920989154559
             stat err =       0.001238917174
             autocorr =       1.200090582353
              std dev =       1.599400419750
             le_variance =       2.558081702698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.714962050854        initial  <--
     5.9605e+03     5.9605e+04             7.3167e-08       -16.714962050849
     2.3842e+04     2.3842e+05             1.8292e-08       -16.714962050852
     9.5367e+04     9.5367e+05             4.5731e-09       -16.714962050854

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0016
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0101e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6701e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9556
    reference variance = 1.82762
====================================================
  Execution time = 1.5166e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0276e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5009e+00
  Total weights = 1.945834239e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2191e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529044763757
                                         uncertainty =       0.023447088379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.529044763757
                                         uncertainty =       0.023447088379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124557686
  error estimate for blocks of size 2^( 2) =       0.001163613736
  error estimate for blocks of size 2^( 3) =       0.001197012504
  error estimate for blocks of size 2^( 4) =       0.001222523272
  error estimate for blocks of size 2^( 5) =       0.001240245192
  error estimate for blocks of size 2^( 6) =       0.001249242499
  error estimate for blocks of size 2^( 7) =       0.001251865841

      target function =                  N/A
              le_mean =     -16.718286965330
             les_mean =     282.001992724619
             stat err =       0.001240969201
             autocorr =       1.217751098729
              std dev =       1.590390176366
             le_variance =       2.529340913082


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671828696533e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718286964422       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718286964590       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718286964592       residual = 1.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+04 is 7.485082e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718286964422       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718286964464       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718286964464       residual = 1.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+05 is 1.871279e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718286964422       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718286964432       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718286964432       residual = 1.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+05 is 4.678202e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8392e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654924e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107127e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356877e-02 3 1  ON 17
ci_0019                 1.974969e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952957e-02 3 1  ON 22
ci_0024                -1.798069e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602360e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301612e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354071e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096113e-02 3 1  ON 68
ci_0070                 1.053120e-02 3 1  ON 69
ci_0071                 9.801413e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.7784
    reference variance = 1.79606
====================================================
  Execution time = 1.2683e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5309e+00
  Total weights = 1.9459e+06
  Execution time = 2.2193e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560644661402
                                         uncertainty =       0.044552272596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560644661402
                                         uncertainty =       0.044552272596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131403899
  error estimate for blocks of size 2^( 2) =       0.001171019350
  error estimate for blocks of size 2^( 3) =       0.001204492587
  error estimate for blocks of size 2^( 4) =       0.001227787933
  error estimate for blocks of size 2^( 5) =       0.001244050195
  error estimate for blocks of size 2^( 6) =       0.001253763874
  error estimate for blocks of size 2^( 7) =       0.001260869407

      target function =                  N/A
              le_mean =     -16.720256114872
             les_mean =     282.097861876498
             stat err =       0.001246617852
             autocorr =       1.214035376154
              std dev =       1.600072338806
             le_variance =       2.560231489413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560644665593
                                         uncertainty =       0.044552273171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560644665593
                                         uncertainty =       0.044552273171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131403900
  error estimate for blocks of size 2^( 2) =       0.001171019351
  error estimate for blocks of size 2^( 3) =       0.001204492588
  error estimate for blocks of size 2^( 4) =       0.001227787934
  error estimate for blocks of size 2^( 5) =       0.001244050196
  error estimate for blocks of size 2^( 6) =       0.001253763875
  error estimate for blocks of size 2^( 7) =       0.001260869408

      target function =                  N/A
              le_mean =     -16.720256114863
             les_mean =     282.097861877552
             stat err =       0.001246617853
             autocorr =       1.214035375165
              std dev =       1.600072340115
             le_variance =       2.560231493602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560644663497
                                         uncertainty =       0.044552272883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560644663497
                                         uncertainty =       0.044552272883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131403899
  error estimate for blocks of size 2^( 2) =       0.001171019350
  error estimate for blocks of size 2^( 3) =       0.001204492587
  error estimate for blocks of size 2^( 4) =       0.001227787933
  error estimate for blocks of size 2^( 5) =       0.001244050196
  error estimate for blocks of size 2^( 6) =       0.001253763874
  error estimate for blocks of size 2^( 7) =       0.001260869407

      target function =                  N/A
              le_mean =     -16.720256114867
             les_mean =     282.097861877024
             stat err =       0.001246617853
             autocorr =       1.214035375658
              std dev =       1.600072339461
             le_variance =       2.560231491508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560644661664
                                         uncertainty =       0.044552272632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.560644661664
                                         uncertainty =       0.044552272632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131403899
  error estimate for blocks of size 2^( 2) =       0.001171019350
  error estimate for blocks of size 2^( 3) =       0.001204492587
  error estimate for blocks of size 2^( 4) =       0.001227787933
  error estimate for blocks of size 2^( 5) =       0.001244050195
  error estimate for blocks of size 2^( 6) =       0.001253763874
  error estimate for blocks of size 2^( 7) =       0.001260869407

      target function =                  N/A
              le_mean =     -16.720256114872
             les_mean =     282.097861876563
             stat err =       0.001246617852
             autocorr =       1.214035376091
              std dev =       1.600072338888
             le_variance =       2.560231489675


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.720256114872        initial  <--
     5.9605e+04     5.9605e+05             7.4851e-09       -16.720256114863
     2.3842e+05     2.3842e+06             1.8713e-09       -16.720256114867
     9.5367e+05     9.5367e+06             4.6782e-10       -16.720256114872

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9067
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2305e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6707e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.7445
    reference variance = 1.82101
====================================================
  Execution time = 1.2958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0237e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.6039e+00
  Total weights = 1.945798486e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1612e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.636187678443
                                         uncertainty =       0.064525023365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.636187678443
                                         uncertainty =       0.064525023365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001147895944
  error estimate for blocks of size 2^( 2) =       0.001185909387
  error estimate for blocks of size 2^( 3) =       0.001219157549
  error estimate for blocks of size 2^( 4) =       0.001242062229
  error estimate for blocks of size 2^( 5) =       0.001258522144
  error estimate for blocks of size 2^( 6) =       0.001264765913
  error estimate for blocks of size 2^( 7) =       0.001268415238

      target function =                  N/A
              le_mean =     -16.717964306726
             les_mean =     282.094186227069
             stat err =       0.001258441381
             autocorr =       1.201879529438
              std dev =       1.623395986439
             le_variance =       2.635414528787


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671796430673e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717964305754       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717964305769       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717964305769       residual = 2.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+05 is 6.194693e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717964305754       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717964305757       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717964305757       residual = 2.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+06 is 1.548674e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717964305754       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717964305755       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717964305755       residual = 2.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+06 is 3.871685e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108886 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6126e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.6029
    reference variance = 2.8987
====================================================
  Execution time = 1.2651e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.6894e+00
  Total weights = 1.9460e+06
  Execution time = 2.2093e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.720257952680
                                         uncertainty =       0.119766929823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.720257952680
                                         uncertainty =       0.119766929823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001166078012
  error estimate for blocks of size 2^( 2) =       0.001203281434
  error estimate for blocks of size 2^( 3) =       0.001235996841
  error estimate for blocks of size 2^( 4) =       0.001258511817
  error estimate for blocks of size 2^( 5) =       0.001273915858
  error estimate for blocks of size 2^( 6) =       0.001281571247
  error estimate for blocks of size 2^( 7) =       0.001284771875

      target function =                  N/A
              le_mean =     -16.717636079554
             les_mean =     282.168779599965
             stat err =       0.001274692699
             autocorr =       1.194966648811
              std dev =       1.649109724631
             le_variance =       2.719562883872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.720257952950
                                         uncertainty =       0.119766929823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.720257952950
                                         uncertainty =       0.119766929823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001166078012
  error estimate for blocks of size 2^( 2) =       0.001203281434
  error estimate for blocks of size 2^( 3) =       0.001235996841
  error estimate for blocks of size 2^( 4) =       0.001258511817
  error estimate for blocks of size 2^( 5) =       0.001273915858
  error estimate for blocks of size 2^( 6) =       0.001281571247
  error estimate for blocks of size 2^( 7) =       0.001284771875

      target function =                  N/A
              le_mean =     -16.717636079546
             les_mean =     282.168779597256
             stat err =       0.001274692699
             autocorr =       1.194966648638
              std dev =       1.649109724713
             le_variance =       2.719562884142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.720257952815
                                         uncertainty =       0.119766929823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.720257952815
                                         uncertainty =       0.119766929823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001166078012
  error estimate for blocks of size 2^( 2) =       0.001203281434
  error estimate for blocks of size 2^( 3) =       0.001235996841
  error estimate for blocks of size 2^( 4) =       0.001258511817
  error estimate for blocks of size 2^( 5) =       0.001273915858
  error estimate for blocks of size 2^( 6) =       0.001281571247
  error estimate for blocks of size 2^( 7) =       0.001284771875

      target function =                  N/A
              le_mean =     -16.717636079550
             les_mean =     282.168779598610
             stat err =       0.001274692699
             autocorr =       1.194966648724
              std dev =       1.649109724672
             le_variance =       2.719562884007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.720257952696
                                         uncertainty =       0.119766929823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.720257952696
                                         uncertainty =       0.119766929823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001166078012
  error estimate for blocks of size 2^( 2) =       0.001203281434
  error estimate for blocks of size 2^( 3) =       0.001235996841
  error estimate for blocks of size 2^( 4) =       0.001258511817
  error estimate for blocks of size 2^( 5) =       0.001273915858
  error estimate for blocks of size 2^( 6) =       0.001281571247
  error estimate for blocks of size 2^( 7) =       0.001284771875

      target function =                  N/A
              le_mean =     -16.717636079554
             les_mean =     282.168779599796
             stat err =       0.001274692699
             autocorr =       1.194966648800
              std dev =       1.649109724636
             le_variance =       2.719562883889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717636079554        initial  <--
     5.9605e+05     5.9605e+06             6.1947e-10       -16.717636079546
     2.3842e+06     2.3842e+07             1.5487e-10       -16.717636079550
     9.5367e+06     9.5367e+07             3.8717e-11       -16.717636079554

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8158
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6706e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8582
    reference variance = 1.67395
====================================================
  Execution time = 1.3048e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0270e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5721e+00
  Total weights = 1.945967086e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1736e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.596043320799
                                         uncertainty =       0.032337725799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.596043320799
                                         uncertainty =       0.032337725799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139199313
  error estimate for blocks of size 2^( 2) =       0.001178065398
  error estimate for blocks of size 2^( 3) =       0.001210864463
  error estimate for blocks of size 2^( 4) =       0.001232402391
  error estimate for blocks of size 2^( 5) =       0.001245732038
  error estimate for blocks of size 2^( 6) =       0.001252999455
  error estimate for blocks of size 2^( 7) =       0.001259988721

      target function =                  N/A
              le_mean =     -16.717292049739
             les_mean =     282.039937232101
             stat err =       0.001247780651
             autocorr =       1.199712172122
              std dev =       1.611096895368
             le_variance =       2.595633206264


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671729204974e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717292048832       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717292048834       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717292048834       residual = 3.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+06 is 9.573663e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717292048832       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717292048833       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717292048833       residual = 3.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+07 is 2.393416e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717292048832       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717292048832       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717292048832       residual = 3.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+07 is 5.983540e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6229e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.7287
    reference variance = 1.72494
====================================================
  Execution time = 1.2714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6159e+00
  Total weights = 1.9454e+06
  Execution time = 2.2074e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.647082331586
                                         uncertainty =       0.106889655152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.647082331586
                                         uncertainty =       0.106889655152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001150496744
  error estimate for blocks of size 2^( 2) =       0.001188825960
  error estimate for blocks of size 2^( 3) =       0.001221154982
  error estimate for blocks of size 2^( 4) =       0.001242855346
  error estimate for blocks of size 2^( 5) =       0.001258101567
  error estimate for blocks of size 2^( 6) =       0.001266696953
  error estimate for blocks of size 2^( 7) =       0.001266168197

      target function =                  N/A
              le_mean =     -16.717239712713
             les_mean =     282.081980861373
             stat err =       0.001258455516
             autocorr =       1.196478637799
              std dev =       1.627074131918
             le_variance =       2.647370230757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.647082331654
                                         uncertainty =       0.106889655152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.647082331654
                                         uncertainty =       0.106889655152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001150496744
  error estimate for blocks of size 2^( 2) =       0.001188825960
  error estimate for blocks of size 2^( 3) =       0.001221154982
  error estimate for blocks of size 2^( 4) =       0.001242855346
  error estimate for blocks of size 2^( 5) =       0.001258101567
  error estimate for blocks of size 2^( 6) =       0.001266696953
  error estimate for blocks of size 2^( 7) =       0.001266168197

      target function =                  N/A
              le_mean =     -16.717239712714
             les_mean =     282.081980861383
             stat err =       0.001258455516
             autocorr =       1.196478637777
              std dev =       1.627074131939
             le_variance =       2.647370230825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.647082331620
                                         uncertainty =       0.106889655152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.647082331620
                                         uncertainty =       0.106889655152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001150496744
  error estimate for blocks of size 2^( 2) =       0.001188825960
  error estimate for blocks of size 2^( 3) =       0.001221154982
  error estimate for blocks of size 2^( 4) =       0.001242855346
  error estimate for blocks of size 2^( 5) =       0.001258101567
  error estimate for blocks of size 2^( 6) =       0.001266696953
  error estimate for blocks of size 2^( 7) =       0.001266168197

      target function =                  N/A
              le_mean =     -16.717239712714
             les_mean =     282.081980861378
             stat err =       0.001258455516
             autocorr =       1.196478637788
              std dev =       1.627074131928
             le_variance =       2.647370230791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.647082331590
                                         uncertainty =       0.106889655152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.647082331590
                                         uncertainty =       0.106889655152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001150496744
  error estimate for blocks of size 2^( 2) =       0.001188825960
  error estimate for blocks of size 2^( 3) =       0.001221154982
  error estimate for blocks of size 2^( 4) =       0.001242855346
  error estimate for blocks of size 2^( 5) =       0.001258101567
  error estimate for blocks of size 2^( 6) =       0.001266696953
  error estimate for blocks of size 2^( 7) =       0.001266168197

      target function =                  N/A
              le_mean =     -16.717239712713
             les_mean =     282.081980861374
             stat err =       0.001258455516
             autocorr =       1.196478637798
              std dev =       1.627074131919
             le_variance =       2.647370230761


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717239712713        initial
     5.9605e+06     5.9605e+07             9.5737e-11       -16.717239712714  <--
     2.3842e+07     2.3842e+08             2.3934e-11       -16.717239712714
     9.5367e+07     9.5367e+08             5.9835e-12       -16.717239712713

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 2.3878e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0115e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6709e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.6641
    reference variance = 2.40606
====================================================
  Execution time = 1.2945e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0291e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4773e+00
  Total weights = 1.945682774e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1666e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.507331842045
                                         uncertainty =       0.020544079850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.507331842045
                                         uncertainty =       0.020544079850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001119528635
  error estimate for blocks of size 2^( 2) =       0.001158427350
  error estimate for blocks of size 2^( 3) =       0.001193719465
  error estimate for blocks of size 2^( 4) =       0.001216444385
  error estimate for blocks of size 2^( 5) =       0.001229223805
  error estimate for blocks of size 2^( 6) =       0.001239689877
  error estimate for blocks of size 2^( 7) =       0.001246884855

      target function =                  N/A
              le_mean =     -16.718653910426
             les_mean =     281.990644006885
             stat err =       0.001233060731
             autocorr =       1.213105358221
              std dev =       1.583277911389
             le_variance =       2.506768944693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671865391043e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718653909496       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718653909505       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718653909505       residual = 1.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+06 is 2.470510e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718653909496       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718653909498       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718653909498       residual = 1.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+06 is 6.176275e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718653909496       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718653909497       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718653909497       residual = 1.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+07 is 1.544068e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111210 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6118e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8105
    reference variance = 1.41006
====================================================
  Execution time = 1.2682e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5829e+00
  Total weights = 1.9457e+06
  Execution time = 2.2015e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.613572884884
                                         uncertainty =       0.053845109683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.613572884884
                                         uncertainty =       0.053845109683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001143283814
  error estimate for blocks of size 2^( 2) =       0.001182669278
  error estimate for blocks of size 2^( 3) =       0.001214319743
  error estimate for blocks of size 2^( 4) =       0.001237199487
  error estimate for blocks of size 2^( 5) =       0.001249453312
  error estimate for blocks of size 2^( 6) =       0.001259400749
  error estimate for blocks of size 2^( 7) =       0.001264235755

      target function =                  N/A
              le_mean =     -16.716838800603
             les_mean =     282.035610040874
             stat err =       0.001252572326
             autocorr =       1.200321303211
              std dev =       1.616873345281
             le_variance =       2.614279414679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.613572884799
                                         uncertainty =       0.053845109686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.613572884799
                                         uncertainty =       0.053845109686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001143283814
  error estimate for blocks of size 2^( 2) =       0.001182669278
  error estimate for blocks of size 2^( 3) =       0.001214319743
  error estimate for blocks of size 2^( 4) =       0.001237199487
  error estimate for blocks of size 2^( 5) =       0.001249453312
  error estimate for blocks of size 2^( 6) =       0.001259400749
  error estimate for blocks of size 2^( 7) =       0.001264235755

      target function =                  N/A
              le_mean =     -16.716838800602
             les_mean =     282.035610039435
             stat err =       0.001252572326
             autocorr =       1.200321303170
              std dev =       1.616873345255
             le_variance =       2.614279414595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.613572884842
                                         uncertainty =       0.053845109685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.613572884842
                                         uncertainty =       0.053845109685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001143283814
  error estimate for blocks of size 2^( 2) =       0.001182669278
  error estimate for blocks of size 2^( 3) =       0.001214319743
  error estimate for blocks of size 2^( 4) =       0.001237199487
  error estimate for blocks of size 2^( 5) =       0.001249453312
  error estimate for blocks of size 2^( 6) =       0.001259400749
  error estimate for blocks of size 2^( 7) =       0.001264235755

      target function =                  N/A
              le_mean =     -16.716838800603
             les_mean =     282.035610040154
             stat err =       0.001252572326
             autocorr =       1.200321303191
              std dev =       1.616873345268
             le_variance =       2.614279414637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.613572884879
                                         uncertainty =       0.053845109683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.613572884879
                                         uncertainty =       0.053845109683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001143283814
  error estimate for blocks of size 2^( 2) =       0.001182669278
  error estimate for blocks of size 2^( 3) =       0.001214319743
  error estimate for blocks of size 2^( 4) =       0.001237199487
  error estimate for blocks of size 2^( 5) =       0.001249453312
  error estimate for blocks of size 2^( 6) =       0.001259400749
  error estimate for blocks of size 2^( 7) =       0.001264235755

      target function =                  N/A
              le_mean =     -16.716838800603
             les_mean =     282.035610040784
             stat err =       0.001252572326
             autocorr =       1.200321303209
              std dev =       1.616873345279
             le_variance =       2.614279414674


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716838800603        initial  <--
     1.4901e+06     1.4901e+07             2.4705e-10       -16.716838800602
     5.9605e+06     5.9605e+07             6.1763e-11       -16.716838800603
     2.3842e+07     2.3842e+08             1.5441e-11       -16.716838800603

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8101
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6710e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.5817
    reference variance = 3.15896
====================================================
  Execution time = 1.2965e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0254e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5532e+00
  Total weights = 1.945636816e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1872e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582953544664
                                         uncertainty =       0.036737234333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.582953544664
                                         uncertainty =       0.036737234333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001136321107
  error estimate for blocks of size 2^( 2) =       0.001175148140
  error estimate for blocks of size 2^( 3) =       0.001207905806
  error estimate for blocks of size 2^( 4) =       0.001230687553
  error estimate for blocks of size 2^( 5) =       0.001244074661
  error estimate for blocks of size 2^( 6) =       0.001248161401
  error estimate for blocks of size 2^( 7) =       0.001251617406

      target function =                  N/A
              le_mean =     -16.718225489779
             les_mean =     282.052260577776
             stat err =       0.001243635255
             autocorr =       1.197798881953
              std dev =       1.607026431935
             le_variance =       2.582533952937


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671822548978e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718225488891       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718225488892       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718225488892       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+07 is 3.476668e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718225488891       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718225488891       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718225488891       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+07 is 8.691668e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718225488891       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718225488891       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718225488891       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+08 is 2.172918e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6158e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9795
    reference variance = 1.39158
====================================================
  Execution time = 1.2633e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5159e+00
  Total weights = 1.9457e+06
  Execution time = 2.2166e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544535412520
                                         uncertainty =       0.026556478096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544535412520
                                         uncertainty =       0.026556478096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127799227
  error estimate for blocks of size 2^( 2) =       0.001167108531
  error estimate for blocks of size 2^( 3) =       0.001201235708
  error estimate for blocks of size 2^( 4) =       0.001224677674
  error estimate for blocks of size 2^( 5) =       0.001238498818
  error estimate for blocks of size 2^( 6) =       0.001249409496
  error estimate for blocks of size 2^( 7) =       0.001252796075

      target function =                  N/A
              le_mean =     -16.717505911897
             les_mean =     281.990883504645
             stat err =       0.001241345516
             autocorr =       1.211495412789
              std dev =       1.594974481926
             le_variance =       2.543943597994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544535412579
                                         uncertainty =       0.026556478095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544535412579
                                         uncertainty =       0.026556478095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127799227
  error estimate for blocks of size 2^( 2) =       0.001167108531
  error estimate for blocks of size 2^( 3) =       0.001201235708
  error estimate for blocks of size 2^( 4) =       0.001224677674
  error estimate for blocks of size 2^( 5) =       0.001238498818
  error estimate for blocks of size 2^( 6) =       0.001249409496
  error estimate for blocks of size 2^( 7) =       0.001252796075

      target function =                  N/A
              le_mean =     -16.717505911897
             les_mean =     281.990883504707
             stat err =       0.001241345516
             autocorr =       1.211495412778
              std dev =       1.594974481944
             le_variance =       2.543943598053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544535412550
                                         uncertainty =       0.026556478095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544535412550
                                         uncertainty =       0.026556478095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127799227
  error estimate for blocks of size 2^( 2) =       0.001167108531
  error estimate for blocks of size 2^( 3) =       0.001201235708
  error estimate for blocks of size 2^( 4) =       0.001224677674
  error estimate for blocks of size 2^( 5) =       0.001238498818
  error estimate for blocks of size 2^( 6) =       0.001249409496
  error estimate for blocks of size 2^( 7) =       0.001252796075

      target function =                  N/A
              le_mean =     -16.717505911897
             les_mean =     281.990883504676
             stat err =       0.001241345516
             autocorr =       1.211495412784
              std dev =       1.594974481935
             le_variance =       2.543943598024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544535412524
                                         uncertainty =       0.026556478096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544535412524
                                         uncertainty =       0.026556478096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127799227
  error estimate for blocks of size 2^( 2) =       0.001167108531
  error estimate for blocks of size 2^( 3) =       0.001201235708
  error estimate for blocks of size 2^( 4) =       0.001224677674
  error estimate for blocks of size 2^( 5) =       0.001238498818
  error estimate for blocks of size 2^( 6) =       0.001249409496
  error estimate for blocks of size 2^( 7) =       0.001252796075

      target function =                  N/A
              le_mean =     -16.717505911897
             les_mean =     281.990883504649
             stat err =       0.001241345516
             autocorr =       1.211495412788
              std dev =       1.594974481927
             le_variance =       2.543943597998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717505911897        initial  <--
     1.4901e+07     1.4901e+08             3.4767e-11       -16.717505911897
     5.9605e+07     5.9605e+08             8.6917e-12       -16.717505911897
     2.3842e+08     2.3842e+09             2.1729e-12       -16.717505911897

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8467
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6712e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8254
    reference variance = 2.19857
====================================================
  Execution time = 1.3012e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0248e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5430e+00
  Total weights = 1.945627155e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1972e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571601130028
                                         uncertainty =       0.024517750369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.571601130028
                                         uncertainty =       0.024517750369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134061986
  error estimate for blocks of size 2^( 2) =       0.001171681191
  error estimate for blocks of size 2^( 3) =       0.001203654923
  error estimate for blocks of size 2^( 4) =       0.001226645281
  error estimate for blocks of size 2^( 5) =       0.001243422173
  error estimate for blocks of size 2^( 6) =       0.001249883721
  error estimate for blocks of size 2^( 7) =       0.001260896596

      target function =                  N/A
              le_mean =     -16.718489507278
             les_mean =     282.050906897558
             stat err =       0.001245211943
             autocorr =       1.205627008988
              std dev =       1.603831501799
             le_variance =       2.572275486162


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671848950728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718489506380       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718489506381       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718489506381       residual = 1.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+08 is 2.955105e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718489506380       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718489506380       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718489506380       residual = 1.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+08 is 7.387792e-13

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718489506380       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718489506380       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718489506380       residual = 1.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+09 is 1.846961e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113540 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6215e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.7466
    reference variance = 2.51505
====================================================
  Execution time = 1.2677e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5065e+00
  Total weights = 1.9459e+06
  Execution time = 2.2149e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535706504456
                                         uncertainty =       0.026087967563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535706504456
                                         uncertainty =       0.026087967563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125953898
  error estimate for blocks of size 2^( 2) =       0.001164852663
  error estimate for blocks of size 2^( 3) =       0.001198495632
  error estimate for blocks of size 2^( 4) =       0.001220766423
  error estimate for blocks of size 2^( 5) =       0.001233931507
  error estimate for blocks of size 2^( 6) =       0.001241019890
  error estimate for blocks of size 2^( 7) =       0.001243579322

      target function =                  N/A
              le_mean =     -16.718463171798
             les_mean =     282.013482820130
             stat err =       0.001234824285
             autocorr =       1.202732667335
              std dev =       1.592364750037
             le_variance =       2.535625497161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535706504456
                                         uncertainty =       0.026087967563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535706504456
                                         uncertainty =       0.026087967563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125953898
  error estimate for blocks of size 2^( 2) =       0.001164852663
  error estimate for blocks of size 2^( 3) =       0.001198495632
  error estimate for blocks of size 2^( 4) =       0.001220766423
  error estimate for blocks of size 2^( 5) =       0.001233931507
  error estimate for blocks of size 2^( 6) =       0.001241019890
  error estimate for blocks of size 2^( 7) =       0.001243579322

      target function =                  N/A
              le_mean =     -16.718463171798
             les_mean =     282.013482820126
             stat err =       0.001234824285
             autocorr =       1.202732667335
              std dev =       1.592364750037
             le_variance =       2.535625497161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535706504456
                                         uncertainty =       0.026087967563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535706504456
                                         uncertainty =       0.026087967563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125953898
  error estimate for blocks of size 2^( 2) =       0.001164852663
  error estimate for blocks of size 2^( 3) =       0.001198495632
  error estimate for blocks of size 2^( 4) =       0.001220766423
  error estimate for blocks of size 2^( 5) =       0.001233931507
  error estimate for blocks of size 2^( 6) =       0.001241019890
  error estimate for blocks of size 2^( 7) =       0.001243579322

      target function =                  N/A
              le_mean =     -16.718463171798
             les_mean =     282.013482820128
             stat err =       0.001234824285
             autocorr =       1.202732667335
              std dev =       1.592364750037
             le_variance =       2.535625497161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535706504456
                                         uncertainty =       0.026087967563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.535706504456
                                         uncertainty =       0.026087967563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125953898
  error estimate for blocks of size 2^( 2) =       0.001164852663
  error estimate for blocks of size 2^( 3) =       0.001198495632
  error estimate for blocks of size 2^( 4) =       0.001220766423
  error estimate for blocks of size 2^( 5) =       0.001233931507
  error estimate for blocks of size 2^( 6) =       0.001241019890
  error estimate for blocks of size 2^( 7) =       0.001243579322

      target function =                  N/A
              le_mean =     -16.718463171799
             les_mean =     282.013482820130
             stat err =       0.001234824285
             autocorr =       1.202732667336
              std dev =       1.592364750037
             le_variance =       2.535625497161


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718463171798        initial
     1.4901e+08     1.4901e+09             2.9551e-12       -16.718463171798
     5.9605e+08     5.9605e+09             7.3878e-13       -16.718463171798
     2.3842e+09     2.3842e+10             1.8470e-13       -16.718463171799  <--

*****************************************************************************
Applying the update for shift_i =   2.3842e+09     and shift_s =   2.3842e+10
*****************************************************************************

  Execution time = 2.3860e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0081e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6714e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.6902
    reference variance = 1.73402
====================================================
  Execution time = 1.2969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0276e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5200e+00
  Total weights = 1.945859597e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1675e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549847558555
                                         uncertainty =       0.026009019343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.549847558555
                                         uncertainty =       0.026009019343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129006597
  error estimate for blocks of size 2^( 2) =       0.001167670911
  error estimate for blocks of size 2^( 3) =       0.001199786618
  error estimate for blocks of size 2^( 4) =       0.001222657033
  error estimate for blocks of size 2^( 5) =       0.001241000880
  error estimate for blocks of size 2^( 6) =       0.001249156463
  error estimate for blocks of size 2^( 7) =       0.001252542279

      target function =                  N/A
              le_mean =     -16.720061562066
             les_mean =     282.080505581168
             stat err =       0.001241339164
             autocorr =       1.208893258771
              std dev =       1.596681987500
             le_variance =       2.549393369207


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672006156207e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720061561138       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720061561138       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720061561138       residual = 1.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+08 is 9.195101e-13

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720061561138       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720061561138       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720061561138       residual = 1.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+09 is 2.298624e-13

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720061561138       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720061561138       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720061561138       residual = 1.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+09 is 5.746938e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114728 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6143e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.692
    reference variance = 1.67297
====================================================
  Execution time = 1.2707e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5373e+00
  Total weights = 1.9460e+06
  Execution time = 2.2119e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562959122057
                                         uncertainty =       0.029480754724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562959122057
                                         uncertainty =       0.029480754724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132013128
  error estimate for blocks of size 2^( 2) =       0.001169959463
  error estimate for blocks of size 2^( 3) =       0.001203449233
  error estimate for blocks of size 2^( 4) =       0.001230097216
  error estimate for blocks of size 2^( 5) =       0.001243273805
  error estimate for blocks of size 2^( 6) =       0.001248915853
  error estimate for blocks of size 2^( 7) =       0.001252464618

      target function =                  N/A
              le_mean =     -16.717108570572
             les_mean =     281.999013837368
             stat err =       0.001243687873
             autocorr =       1.207035023308
              std dev =       1.600933933415
             le_variance =       2.562989459159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562959122057
                                         uncertainty =       0.029480754724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562959122057
                                         uncertainty =       0.029480754724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132013128
  error estimate for blocks of size 2^( 2) =       0.001169959463
  error estimate for blocks of size 2^( 3) =       0.001203449233
  error estimate for blocks of size 2^( 4) =       0.001230097216
  error estimate for blocks of size 2^( 5) =       0.001243273805
  error estimate for blocks of size 2^( 6) =       0.001248915853
  error estimate for blocks of size 2^( 7) =       0.001252464618

      target function =                  N/A
              le_mean =     -16.717108570572
             les_mean =     281.999013837362
             stat err =       0.001243687873
             autocorr =       1.207035023307
              std dev =       1.600933933415
             le_variance =       2.562989459159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562959122057
                                         uncertainty =       0.029480754724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562959122057
                                         uncertainty =       0.029480754724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132013128
  error estimate for blocks of size 2^( 2) =       0.001169959463
  error estimate for blocks of size 2^( 3) =       0.001203449233
  error estimate for blocks of size 2^( 4) =       0.001230097216
  error estimate for blocks of size 2^( 5) =       0.001243273805
  error estimate for blocks of size 2^( 6) =       0.001248915853
  error estimate for blocks of size 2^( 7) =       0.001252464618

      target function =                  N/A
              le_mean =     -16.717108570572
             les_mean =     281.999013837365
             stat err =       0.001243687873
             autocorr =       1.207035023307
              std dev =       1.600933933415
             le_variance =       2.562989459159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562959122057
                                         uncertainty =       0.029480754724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562959122057
                                         uncertainty =       0.029480754724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132013128
  error estimate for blocks of size 2^( 2) =       0.001169959463
  error estimate for blocks of size 2^( 3) =       0.001203449233
  error estimate for blocks of size 2^( 4) =       0.001230097216
  error estimate for blocks of size 2^( 5) =       0.001243273805
  error estimate for blocks of size 2^( 6) =       0.001248915853
  error estimate for blocks of size 2^( 7) =       0.001252464618

      target function =                  N/A
              le_mean =     -16.717108570572
             les_mean =     281.999013837367
             stat err =       0.001243687873
             autocorr =       1.207035023308
              std dev =       1.600933933415
             le_variance =       2.562989459159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717108570572        initial
     5.9605e+08     5.9605e+09             9.1951e-13       -16.717108570572  <--
     2.3842e+09     2.3842e+10             2.2986e-13       -16.717108570572
     9.5367e+09     9.5367e+10             5.7469e-14       -16.717108570572

*****************************************************************************
Applying the update for shift_i =   5.9605e+08     and shift_s =   5.9605e+09
*****************************************************************************

  Execution time = 2.3896e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0048e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6713e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8781
    reference variance = 1.36722
====================================================
  Execution time = 1.3015e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0275e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5834e+00
  Total weights = 1.945405582e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2096e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.611776117542
                                         uncertainty =       0.041425583428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.611776117542
                                         uncertainty =       0.041425583428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142509099
  error estimate for blocks of size 2^( 2) =       0.001180130601
  error estimate for blocks of size 2^( 3) =       0.001212748087
  error estimate for blocks of size 2^( 4) =       0.001236470459
  error estimate for blocks of size 2^( 5) =       0.001250892101
  error estimate for blocks of size 2^( 6) =       0.001255428407
  error estimate for blocks of size 2^( 7) =       0.001256676079

      target function =                  N/A
              le_mean =     -16.717879436642
             les_mean =     282.070906387342
             stat err =       0.001249866761
             autocorr =       1.196762858925
              std dev =       1.615777714403
             le_variance =       2.610737622361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671787943664e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717879435730       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717879435730       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717879435730       residual = 6.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+08 is 3.598159e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717879435730       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717879435730       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717879435730       residual = 6.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+08 is 8.995410e-13

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717879435730       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717879435730       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717879435730       residual = 6.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+09 is 2.248734e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6231e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8022
    reference variance = 2.58835
====================================================
  Execution time = 1.5417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5132e+00
  Total weights = 1.9460e+06
  Execution time = 2.2070e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541593675258
                                         uncertainty =       0.035944891383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541593675258
                                         uncertainty =       0.035944891383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127170152
  error estimate for blocks of size 2^( 2) =       0.001165636124
  error estimate for blocks of size 2^( 3) =       0.001197776864
  error estimate for blocks of size 2^( 4) =       0.001219821970
  error estimate for blocks of size 2^( 5) =       0.001233841775
  error estimate for blocks of size 2^( 6) =       0.001241069617
  error estimate for blocks of size 2^( 7) =       0.001246379373

      target function =                  N/A
              le_mean =     -16.718502412199
             les_mean =     282.021524878149
             stat err =       0.001235278183
             autocorr =       1.201020949956
              std dev =       1.594084820285
             le_variance =       2.541106414263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541593675257
                                         uncertainty =       0.035944891383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541593675257
                                         uncertainty =       0.035944891383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127170152
  error estimate for blocks of size 2^( 2) =       0.001165636124
  error estimate for blocks of size 2^( 3) =       0.001197776864
  error estimate for blocks of size 2^( 4) =       0.001219821970
  error estimate for blocks of size 2^( 5) =       0.001233841775
  error estimate for blocks of size 2^( 6) =       0.001241069617
  error estimate for blocks of size 2^( 7) =       0.001246379373

      target function =                  N/A
              le_mean =     -16.718502412199
             les_mean =     282.021524878136
             stat err =       0.001235278183
             autocorr =       1.201020949955
              std dev =       1.594084820285
             le_variance =       2.541106414262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541593675258
                                         uncertainty =       0.035944891383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541593675258
                                         uncertainty =       0.035944891383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127170152
  error estimate for blocks of size 2^( 2) =       0.001165636124
  error estimate for blocks of size 2^( 3) =       0.001197776864
  error estimate for blocks of size 2^( 4) =       0.001219821970
  error estimate for blocks of size 2^( 5) =       0.001233841775
  error estimate for blocks of size 2^( 6) =       0.001241069617
  error estimate for blocks of size 2^( 7) =       0.001246379373

      target function =                  N/A
              le_mean =     -16.718502412199
             les_mean =     282.021524878143
             stat err =       0.001235278183
             autocorr =       1.201020949955
              std dev =       1.594084820285
             le_variance =       2.541106414263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541593675258
                                         uncertainty =       0.035944891383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.541593675258
                                         uncertainty =       0.035944891383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127170152
  error estimate for blocks of size 2^( 2) =       0.001165636124
  error estimate for blocks of size 2^( 3) =       0.001197776864
  error estimate for blocks of size 2^( 4) =       0.001219821970
  error estimate for blocks of size 2^( 5) =       0.001233841775
  error estimate for blocks of size 2^( 6) =       0.001241069617
  error estimate for blocks of size 2^( 7) =       0.001246379373

      target function =                  N/A
              le_mean =     -16.718502412199
             les_mean =     282.021524878148
             stat err =       0.001235278183
             autocorr =       1.201020949956
              std dev =       1.594084820285
             le_variance =       2.541106414263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718502412199        initial
     1.4901e+08     1.4901e+09             3.5982e-12       -16.718502412199  <--
     5.9605e+08     5.9605e+09             8.9954e-13       -16.718502412199
     2.3842e+09     2.3842e+10             2.2487e-13       -16.718502412199

*****************************************************************************
Applying the update for shift_i =   1.4901e+08     and shift_s =   1.4901e+09
*****************************************************************************

  Execution time = 2.6574e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2811e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6717e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.6997
    reference variance = 1.67311
====================================================
  Execution time = 1.2963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0283e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5274e+00
  Total weights = 1.945552109e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2210e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554958593669
                                         uncertainty =       0.028171448179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554958593669
                                         uncertainty =       0.028171448179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001130343849
  error estimate for blocks of size 2^( 2) =       0.001168442355
  error estimate for blocks of size 2^( 3) =       0.001200954609
  error estimate for blocks of size 2^( 4) =       0.001223984950
  error estimate for blocks of size 2^( 5) =       0.001235954357
  error estimate for blocks of size 2^( 6) =       0.001242558590
  error estimate for blocks of size 2^( 7) =       0.001256171316

      target function =                  N/A
              le_mean =     -16.717431853332
             les_mean =     281.999913909820
             stat err =       0.001239667303
             autocorr =       1.202788154314
              std dev =       1.598573178573
             le_variance =       2.555436207254


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671743185333e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717431852371       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717431852371       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717431852371       residual = 4.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+07 is 1.026277e-11

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717431852371       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717431852371       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717431852371       residual = 4.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+08 is 2.565688e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717431852371       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717431852371       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717431852371       residual = 4.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+08 is 6.414233e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117080 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6190e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.4507
    reference variance = 1.93549
====================================================
  Execution time = 1.2692e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6157e+00
  Total weights = 1.9460e+06
  Execution time = 2.2155e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.645302917779
                                         uncertainty =       0.084511219030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.645302917779
                                         uncertainty =       0.084511219030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001150137951
  error estimate for blocks of size 2^( 2) =       0.001187659068
  error estimate for blocks of size 2^( 3) =       0.001221079818
  error estimate for blocks of size 2^( 4) =       0.001242403690
  error estimate for blocks of size 2^( 5) =       0.001256119238
  error estimate for blocks of size 2^( 6) =       0.001266019354
  error estimate for blocks of size 2^( 7) =       0.001268115868

      target function =                  N/A
              le_mean =     -16.717136213092
             les_mean =     282.078352324507
             stat err =       0.001258164537
             autocorr =       1.196671676924
              std dev =       1.626566712817
             le_variance =       2.645719271246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.645302917783
                                         uncertainty =       0.084511219030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.645302917783
                                         uncertainty =       0.084511219030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001150137951
  error estimate for blocks of size 2^( 2) =       0.001187659068
  error estimate for blocks of size 2^( 3) =       0.001221079818
  error estimate for blocks of size 2^( 4) =       0.001242403690
  error estimate for blocks of size 2^( 5) =       0.001256119238
  error estimate for blocks of size 2^( 6) =       0.001266019354
  error estimate for blocks of size 2^( 7) =       0.001268115868

      target function =                  N/A
              le_mean =     -16.717136213092
             les_mean =     282.078352324555
             stat err =       0.001258164537
             autocorr =       1.196671676923
              std dev =       1.626566712819
             le_variance =       2.645719271250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.645302917781
                                         uncertainty =       0.084511219030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.645302917781
                                         uncertainty =       0.084511219030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001150137951
  error estimate for blocks of size 2^( 2) =       0.001187659068
  error estimate for blocks of size 2^( 3) =       0.001221079818
  error estimate for blocks of size 2^( 4) =       0.001242403690
  error estimate for blocks of size 2^( 5) =       0.001256119238
  error estimate for blocks of size 2^( 6) =       0.001266019354
  error estimate for blocks of size 2^( 7) =       0.001268115868

      target function =                  N/A
              le_mean =     -16.717136213092
             les_mean =     282.078352324531
             stat err =       0.001258164537
             autocorr =       1.196671676924
              std dev =       1.626566712818
             le_variance =       2.645719271248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.645302917779
                                         uncertainty =       0.084511219030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.645302917779
                                         uncertainty =       0.084511219030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001150137951
  error estimate for blocks of size 2^( 2) =       0.001187659068
  error estimate for blocks of size 2^( 3) =       0.001221079818
  error estimate for blocks of size 2^( 4) =       0.001242403690
  error estimate for blocks of size 2^( 5) =       0.001256119238
  error estimate for blocks of size 2^( 6) =       0.001266019354
  error estimate for blocks of size 2^( 7) =       0.001268115868

      target function =                  N/A
              le_mean =     -16.717136213092
             les_mean =     282.078352324510
             stat err =       0.001258164537
             autocorr =       1.196671676925
              std dev =       1.626566712818
             le_variance =       2.645719271246


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717136213092        initial  <--
     3.7253e+07     3.7253e+08             1.0263e-11       -16.717136213092
     1.4901e+08     1.4901e+09             2.5657e-12       -16.717136213092
     5.9605e+08     5.9605e+09             6.4142e-13       -16.717136213092

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8939
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0091e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6713e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.5716
    reference variance = 5.45217
====================================================
  Execution time = 1.2922e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0265e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5151e+00
  Total weights = 1.945957079e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2244e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544134964708
                                         uncertainty =       0.045871879060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544134964708
                                         uncertainty =       0.045871879060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127749523
  error estimate for blocks of size 2^( 2) =       0.001166088984
  error estimate for blocks of size 2^( 3) =       0.001199943160
  error estimate for blocks of size 2^( 4) =       0.001221561929
  error estimate for blocks of size 2^( 5) =       0.001236719225
  error estimate for blocks of size 2^( 6) =       0.001242903620
  error estimate for blocks of size 2^( 7) =       0.001250400116

      target function =                  N/A
              le_mean =     -16.720168351178
             les_mean =     282.079146096342
             stat err =       0.001237896222
             autocorr =       1.204878267507
              std dev =       1.594904188322
             le_variance =       2.543719369927


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.672016835118e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720168350238       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720168350238       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720168350238       residual = 2.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+08 is 1.322851e-12

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720168350238       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720168350238       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720168350238       residual = 2.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+09 is 3.307122e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.720168350238       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.720168350238       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.720168350238       residual = 2.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+09 is 8.267792e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118300 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6153e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.5844
    reference variance = 1.56258
====================================================
  Execution time = 1.2704e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6721e+01
  VMC Evar = 2.5229e+00
  Total weights = 1.9463e+06
  Execution time = 2.2032e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552355855411
                                         uncertainty =       0.025797081497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552355855411
                                         uncertainty =       0.025797081497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129639913
  error estimate for blocks of size 2^( 2) =       0.001168675612
  error estimate for blocks of size 2^( 3) =       0.001202484975
  error estimate for blocks of size 2^( 4) =       0.001224161270
  error estimate for blocks of size 2^( 5) =       0.001238426841
  error estimate for blocks of size 2^( 6) =       0.001246030233
  error estimate for blocks of size 2^( 7) =       0.001253442110

      target function =                  N/A
              le_mean =     -16.720891830578
             les_mean =     282.111133480724
             stat err =       0.001240515114
             autocorr =       1.205935450297
              std dev =       1.597577646314
             le_variance =       2.552254336001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552355855411
                                         uncertainty =       0.025797081497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552355855411
                                         uncertainty =       0.025797081497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129639913
  error estimate for blocks of size 2^( 2) =       0.001168675612
  error estimate for blocks of size 2^( 3) =       0.001202484975
  error estimate for blocks of size 2^( 4) =       0.001224161270
  error estimate for blocks of size 2^( 5) =       0.001238426841
  error estimate for blocks of size 2^( 6) =       0.001246030233
  error estimate for blocks of size 2^( 7) =       0.001253442110

      target function =                  N/A
              le_mean =     -16.720891830578
             les_mean =     282.111133480687
             stat err =       0.001240515114
             autocorr =       1.205935450297
              std dev =       1.597577646314
             le_variance =       2.552254336001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552355855411
                                         uncertainty =       0.025797081497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552355855411
                                         uncertainty =       0.025797081497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129639913
  error estimate for blocks of size 2^( 2) =       0.001168675612
  error estimate for blocks of size 2^( 3) =       0.001202484975
  error estimate for blocks of size 2^( 4) =       0.001224161270
  error estimate for blocks of size 2^( 5) =       0.001238426841
  error estimate for blocks of size 2^( 6) =       0.001246030233
  error estimate for blocks of size 2^( 7) =       0.001253442110

      target function =                  N/A
              le_mean =     -16.720891830578
             les_mean =     282.111133480706
             stat err =       0.001240515114
             autocorr =       1.205935450297
              std dev =       1.597577646314
             le_variance =       2.552254336001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552355855411
                                         uncertainty =       0.025797081497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552355855411
                                         uncertainty =       0.025797081497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129639913
  error estimate for blocks of size 2^( 2) =       0.001168675612
  error estimate for blocks of size 2^( 3) =       0.001202484975
  error estimate for blocks of size 2^( 4) =       0.001224161270
  error estimate for blocks of size 2^( 5) =       0.001238426841
  error estimate for blocks of size 2^( 6) =       0.001246030233
  error estimate for blocks of size 2^( 7) =       0.001253442110

      target function =                  N/A
              le_mean =     -16.720891830578
             les_mean =     282.111133480722
             stat err =       0.001240515114
             autocorr =       1.205935450297
              std dev =       1.597577646314
             le_variance =       2.552254336001


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.720891830578        initial
     3.7253e+08     3.7253e+09             1.3229e-12       -16.720891830578
     1.4901e+09     1.4901e+10             3.3071e-13       -16.720891830578
     5.9605e+09     5.9605e+10             8.2678e-14       -16.720891830578  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+09     and shift_s =   5.9605e+10
*****************************************************************************

  Execution time = 2.3835e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9995e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6709e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.5785
    reference variance = 2.25772
====================================================
  Execution time = 1.2983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0290e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5285e+00
  Total weights = 1.945804810e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2255e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552316125265
                                         uncertainty =       0.030621199051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.552316125265
                                         uncertainty =       0.030621199051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129463039
  error estimate for blocks of size 2^( 2) =       0.001168055685
  error estimate for blocks of size 2^( 3) =       0.001201489185
  error estimate for blocks of size 2^( 4) =       0.001224257205
  error estimate for blocks of size 2^( 5) =       0.001238394604
  error estimate for blocks of size 2^( 6) =       0.001243983958
  error estimate for blocks of size 2^( 7) =       0.001253268622

      target function =                  N/A
              le_mean =     -16.718009210171
             les_mean =     282.020357081324
             stat err =       0.001239976097
             autocorr =       1.205265096791
              std dev =       1.597327504344
             le_variance =       2.551455156133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671800921017e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718009209236       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718009209236       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718009209236       residual = 1.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+09 is 3.631257e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718009209236       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718009209236       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718009209236       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+09 is 9.078431e-14

solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718009209236       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718009209236       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718009209236       residual = 2.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+10 is 2.270531e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119494 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6217e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.5434
    reference variance = 2.35751
====================================================
  Execution time = 1.2661e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5239e+00
  Total weights = 1.9461e+06
  Execution time = 2.2094e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551871388592
                                         uncertainty =       0.031485655264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551871388592
                                         uncertainty =       0.031485655264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129429093
  error estimate for blocks of size 2^( 2) =       0.001167920907
  error estimate for blocks of size 2^( 3) =       0.001201004273
  error estimate for blocks of size 2^( 4) =       0.001223071094
  error estimate for blocks of size 2^( 5) =       0.001237036886
  error estimate for blocks of size 2^( 6) =       0.001249464575
  error estimate for blocks of size 2^( 7) =       0.001251466228

      target function =                  N/A
              le_mean =     -16.715582942538
             les_mean =     281.934570775163
             stat err =       0.001240259696
             autocorr =       1.205888964596
              std dev =       1.597279496828
             le_variance =       2.551301790986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551871388592
                                         uncertainty =       0.031485655264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551871388592
                                         uncertainty =       0.031485655264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129429093
  error estimate for blocks of size 2^( 2) =       0.001167920907
  error estimate for blocks of size 2^( 3) =       0.001201004273
  error estimate for blocks of size 2^( 4) =       0.001223071094
  error estimate for blocks of size 2^( 5) =       0.001237036886
  error estimate for blocks of size 2^( 6) =       0.001249464575
  error estimate for blocks of size 2^( 7) =       0.001251466228

      target function =                  N/A
              le_mean =     -16.715582942538
             les_mean =     281.934570775162
             stat err =       0.001240259696
             autocorr =       1.205888964596
              std dev =       1.597279496828
             le_variance =       2.551301790987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551871388592
                                         uncertainty =       0.031485655264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551871388592
                                         uncertainty =       0.031485655264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129429093
  error estimate for blocks of size 2^( 2) =       0.001167920907
  error estimate for blocks of size 2^( 3) =       0.001201004273
  error estimate for blocks of size 2^( 4) =       0.001223071094
  error estimate for blocks of size 2^( 5) =       0.001237036886
  error estimate for blocks of size 2^( 6) =       0.001249464575
  error estimate for blocks of size 2^( 7) =       0.001251466228

      target function =                  N/A
              le_mean =     -16.715582942538
             les_mean =     281.934570775163
             stat err =       0.001240259696
             autocorr =       1.205888964596
              std dev =       1.597279496828
             le_variance =       2.551301790986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551871388592
                                         uncertainty =       0.031485655264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.551871388592
                                         uncertainty =       0.031485655264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129429093
  error estimate for blocks of size 2^( 2) =       0.001167920907
  error estimate for blocks of size 2^( 3) =       0.001201004273
  error estimate for blocks of size 2^( 4) =       0.001223071094
  error estimate for blocks of size 2^( 5) =       0.001237036886
  error estimate for blocks of size 2^( 6) =       0.001249464575
  error estimate for blocks of size 2^( 7) =       0.001251466228

      target function =                  N/A
              le_mean =     -16.715582942538
             les_mean =     281.934570775163
             stat err =       0.001240259696
             autocorr =       1.205888964596
              std dev =       1.597279496828
             le_variance =       2.551301790986


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.715582942538        initial
     1.4901e+09     1.4901e+10             3.6313e-13       -16.715582942538
     5.9605e+09     5.9605e+10             9.0784e-14       -16.715582942538  <--
     2.3842e+10     2.3842e+11             2.2705e-14       -16.715582942538

*****************************************************************************
Applying the update for shift_i =   5.9605e+09     and shift_s =   5.9605e+10
*****************************************************************************

  Execution time = 2.3846e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0073e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6705e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.6826
    reference variance = 1.97701
====================================================
  Execution time = 1.2989e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0305e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.4679e+00
  Total weights = 1.945743164e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2164e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.492861365723
                                         uncertainty =       0.017430709673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.492861365723
                                         uncertainty =       0.017430709673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001116554277
  error estimate for blocks of size 2^( 2) =       0.001155453831
  error estimate for blocks of size 2^( 3) =       0.001188261415
  error estimate for blocks of size 2^( 4) =       0.001212180942
  error estimate for blocks of size 2^( 5) =       0.001228157944
  error estimate for blocks of size 2^( 6) =       0.001234744394
  error estimate for blocks of size 2^( 7) =       0.001240392171

      target function =                  N/A
              le_mean =     -16.717751833444
             les_mean =     281.951137787536
             stat err =       0.001228868863
             autocorr =       1.211299119507
              std dev =       1.579071465817
             le_variance =       2.493466694156


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671775183344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717751832485       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717751832485       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717751832485       residual = 3.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+09 is 3.255873e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717751832485       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717751832485       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717751832485       residual = 3.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+09 is 8.141353e-14

solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717751832485       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717751832485       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717751832485       residual = 5.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+10 is 2.033301e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120659 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6212e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.3843
    reference variance = 4.16153
====================================================
  Execution time = 1.2679e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.4785e+00
  Total weights = 1.9460e+06
  Execution time = 2.2028e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.503721860570
                                         uncertainty =       0.024192972512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.503721860570
                                         uncertainty =       0.024192972512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001118751957
  error estimate for blocks of size 2^( 2) =       0.001157290181
  error estimate for blocks of size 2^( 3) =       0.001190141039
  error estimate for blocks of size 2^( 4) =       0.001212442405
  error estimate for blocks of size 2^( 5) =       0.001223561446
  error estimate for blocks of size 2^( 6) =       0.001231796240
  error estimate for blocks of size 2^( 7) =       0.001240719198

      target function =                  N/A
              le_mean =     -16.720190507990
             les_mean =     282.043303272490
             stat err =       0.001227129822
             autocorr =       1.203132351802
              std dev =       1.582179505252
             le_variance =       2.503291986840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.503721860570
                                         uncertainty =       0.024192972512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.503721860570
                                         uncertainty =       0.024192972512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001118751957
  error estimate for blocks of size 2^( 2) =       0.001157290181
  error estimate for blocks of size 2^( 3) =       0.001190141039
  error estimate for blocks of size 2^( 4) =       0.001212442405
  error estimate for blocks of size 2^( 5) =       0.001223561446
  error estimate for blocks of size 2^( 6) =       0.001231796240
  error estimate for blocks of size 2^( 7) =       0.001240719198

      target function =                  N/A
              le_mean =     -16.720190507990
             les_mean =     282.043303272490
             stat err =       0.001227129822
             autocorr =       1.203132351801
              std dev =       1.582179505252
             le_variance =       2.503291986840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.503721860570
                                         uncertainty =       0.024192972512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.503721860570
                                         uncertainty =       0.024192972512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001118751957
  error estimate for blocks of size 2^( 2) =       0.001157290181
  error estimate for blocks of size 2^( 3) =       0.001190141039
  error estimate for blocks of size 2^( 4) =       0.001212442405
  error estimate for blocks of size 2^( 5) =       0.001223561446
  error estimate for blocks of size 2^( 6) =       0.001231796240
  error estimate for blocks of size 2^( 7) =       0.001240719198

      target function =                  N/A
              le_mean =     -16.720190507990
             les_mean =     282.043303272490
             stat err =       0.001227129822
             autocorr =       1.203132351802
              std dev =       1.582179505252
             le_variance =       2.503291986840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.503721860570
                                         uncertainty =       0.024192972512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.503721860570
                                         uncertainty =       0.024192972512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001118751957
  error estimate for blocks of size 2^( 2) =       0.001157290181
  error estimate for blocks of size 2^( 3) =       0.001190141039
  error estimate for blocks of size 2^( 4) =       0.001212442405
  error estimate for blocks of size 2^( 5) =       0.001223561446
  error estimate for blocks of size 2^( 6) =       0.001231796240
  error estimate for blocks of size 2^( 7) =       0.001240719198

      target function =                  N/A
              le_mean =     -16.720190507990
             les_mean =     282.043303272490
             stat err =       0.001227129822
             autocorr =       1.203132351802
              std dev =       1.582179505252
             le_variance =       2.503291986840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.720190507990        initial
     1.4901e+09     1.4901e+10             3.2559e-13       -16.720190507990  <--
     5.9605e+09     5.9605e+10             8.1414e-14       -16.720190507990
     2.3842e+10     2.3842e+11             2.0333e-14       -16.720190507990

*****************************************************************************
Applying the update for shift_i =   1.4901e+09     and shift_s =   1.4901e+10
*****************************************************************************

  Execution time = 2.3809e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0030e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6701e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.5802
    reference variance = 6.59967
====================================================
  Execution time = 1.2975e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0262e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6347e+00
  Total weights = 1.945596804e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2097e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.667513244148
                                         uncertainty =       0.085480108110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.667513244148
                                         uncertainty =       0.085480108110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001154687930
  error estimate for blocks of size 2^( 2) =       0.001192347741
  error estimate for blocks of size 2^( 3) =       0.001224433575
  error estimate for blocks of size 2^( 4) =       0.001246352533
  error estimate for blocks of size 2^( 5) =       0.001259478054
  error estimate for blocks of size 2^( 6) =       0.001267406391
  error estimate for blocks of size 2^( 7) =       0.001269449575

      target function =                  N/A
              le_mean =     -16.717080723010
             les_mean =     282.095450206907
             stat err =       0.001260671638
             autocorr =       1.191995766403
              std dev =       1.633001457695
             le_variance =       2.666693760834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671708072301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717080722048       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717080722048       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717080722048       residual = 1.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+08 is 1.369057e-12

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717080722048       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717080722048       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717080722048       residual = 1.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+09 is 3.422571e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717080722048       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717080722048       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717080722048       residual = 1.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+09 is 8.556567e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121865 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6191e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8447
    reference variance = 1.95985
====================================================
  Execution time = 1.2653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5382e+00
  Total weights = 1.9456e+06
  Execution time = 2.2061e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564779873594
                                         uncertainty =       0.027061011736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564779873594
                                         uncertainty =       0.027061011736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133124225
  error estimate for blocks of size 2^( 2) =       0.001171522280
  error estimate for blocks of size 2^( 3) =       0.001203552015
  error estimate for blocks of size 2^( 4) =       0.001225260775
  error estimate for blocks of size 2^( 5) =       0.001239613172
  error estimate for blocks of size 2^( 6) =       0.001247254390
  error estimate for blocks of size 2^( 7) =       0.001254858400

      target function =                  N/A
              le_mean =     -16.718018778874
             les_mean =     282.030395849301
             stat err =       0.001241746684
             autocorr =       1.200911404937
              std dev =       1.602505286109
             le_variance =       2.568023192007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564779873593
                                         uncertainty =       0.027061011736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564779873593
                                         uncertainty =       0.027061011736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133124225
  error estimate for blocks of size 2^( 2) =       0.001171522280
  error estimate for blocks of size 2^( 3) =       0.001203552015
  error estimate for blocks of size 2^( 4) =       0.001225260775
  error estimate for blocks of size 2^( 5) =       0.001239613172
  error estimate for blocks of size 2^( 6) =       0.001247254390
  error estimate for blocks of size 2^( 7) =       0.001254858400

      target function =                  N/A
              le_mean =     -16.718018778874
             les_mean =     282.030395849252
             stat err =       0.001241746684
             autocorr =       1.200911404938
              std dev =       1.602505286108
             le_variance =       2.568023192006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564779873594
                                         uncertainty =       0.027061011736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564779873594
                                         uncertainty =       0.027061011736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133124225
  error estimate for blocks of size 2^( 2) =       0.001171522280
  error estimate for blocks of size 2^( 3) =       0.001203552015
  error estimate for blocks of size 2^( 4) =       0.001225260775
  error estimate for blocks of size 2^( 5) =       0.001239613172
  error estimate for blocks of size 2^( 6) =       0.001247254390
  error estimate for blocks of size 2^( 7) =       0.001254858400

      target function =                  N/A
              le_mean =     -16.718018778874
             les_mean =     282.030395849276
             stat err =       0.001241746684
             autocorr =       1.200911404937
              std dev =       1.602505286109
             le_variance =       2.568023192006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564779873594
                                         uncertainty =       0.027061011736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564779873594
                                         uncertainty =       0.027061011736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001133124225
  error estimate for blocks of size 2^( 2) =       0.001171522280
  error estimate for blocks of size 2^( 3) =       0.001203552015
  error estimate for blocks of size 2^( 4) =       0.001225260775
  error estimate for blocks of size 2^( 5) =       0.001239613172
  error estimate for blocks of size 2^( 6) =       0.001247254390
  error estimate for blocks of size 2^( 7) =       0.001254858400

      target function =                  N/A
              le_mean =     -16.718018778874
             les_mean =     282.030395849298
             stat err =       0.001241746684
             autocorr =       1.200911404938
              std dev =       1.602505286109
             le_variance =       2.568023192007


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718018778874        initial
     3.7253e+08     3.7253e+09             1.3691e-12       -16.718018778874
     1.4901e+09     1.4901e+10             3.4226e-13       -16.718018778874  <--
     5.9605e+09     5.9605e+10             8.5566e-14       -16.718018778874

*****************************************************************************
Applying the update for shift_i =   1.4901e+09     and shift_s =   1.4901e+10
*****************************************************************************

  Execution time = 2.3813e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6701e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.7922
    reference variance = 1.58389
====================================================
  Execution time = 1.3002e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0227e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5862e+00
  Total weights = 1.945768597e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2078e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.616527580876
                                         uncertainty =       0.071044059827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.616527580876
                                         uncertainty =       0.071044059827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001143682608
  error estimate for blocks of size 2^( 2) =       0.001181295244
  error estimate for blocks of size 2^( 3) =       0.001213347798
  error estimate for blocks of size 2^( 4) =       0.001235811132
  error estimate for blocks of size 2^( 5) =       0.001249478694
  error estimate for blocks of size 2^( 6) =       0.001259403270
  error estimate for blocks of size 2^( 7) =       0.001263811645

      target function =                  N/A
              le_mean =     -16.719060034113
             les_mean =     282.113138158548
             stat err =       0.001252126185
             autocorr =       1.198630051172
              std dev =       1.617437334230
             le_variance =       2.616103530160


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671906003411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719060033210       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719060033210       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719060033210       residual = 1.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+08 is 9.129819e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719060033210       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719060033210       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719060033210       residual = 1.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+09 is 2.282485e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719060033210       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719060033210       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719060033210       residual = 1.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+09 is 5.706138e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123055 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6217e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.5086
    reference variance = 4.29346
====================================================
  Execution time = 1.2697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.4866e+00
  Total weights = 1.9454e+06
  Execution time = 2.2031e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.510601906553
                                         uncertainty =       0.022728519748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.510601906553
                                         uncertainty =       0.022728519748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001120613893
  error estimate for blocks of size 2^( 2) =       0.001159433593
  error estimate for blocks of size 2^( 3) =       0.001194010953
  error estimate for blocks of size 2^( 4) =       0.001217737058
  error estimate for blocks of size 2^( 5) =       0.001233770947
  error estimate for blocks of size 2^( 6) =       0.001241971194
  error estimate for blocks of size 2^( 7) =       0.001243977103

      target function =                  N/A
              le_mean =     -16.720061955662
             les_mean =     282.047107244998
             stat err =       0.001234364076
             autocorr =       1.213317727446
              std dev =       1.584812721561
             le_variance =       2.511631362421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.510601906552
                                         uncertainty =       0.022728519748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.510601906552
                                         uncertainty =       0.022728519748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001120613893
  error estimate for blocks of size 2^( 2) =       0.001159433593
  error estimate for blocks of size 2^( 3) =       0.001194010953
  error estimate for blocks of size 2^( 4) =       0.001217737058
  error estimate for blocks of size 2^( 5) =       0.001233770947
  error estimate for blocks of size 2^( 6) =       0.001241971194
  error estimate for blocks of size 2^( 7) =       0.001243977103

      target function =                  N/A
              le_mean =     -16.720061955662
             les_mean =     282.047107244985
             stat err =       0.001234364076
             autocorr =       1.213317727446
              std dev =       1.584812721561
             le_variance =       2.511631362420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.510601906553
                                         uncertainty =       0.022728519748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.510601906553
                                         uncertainty =       0.022728519748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001120613893
  error estimate for blocks of size 2^( 2) =       0.001159433593
  error estimate for blocks of size 2^( 3) =       0.001194010953
  error estimate for blocks of size 2^( 4) =       0.001217737058
  error estimate for blocks of size 2^( 5) =       0.001233770947
  error estimate for blocks of size 2^( 6) =       0.001241971194
  error estimate for blocks of size 2^( 7) =       0.001243977103

      target function =                  N/A
              le_mean =     -16.720061955662
             les_mean =     282.047107244991
             stat err =       0.001234364076
             autocorr =       1.213317727445
              std dev =       1.584812721561
             le_variance =       2.511631362420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.510601906553
                                         uncertainty =       0.022728519748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.510601906553
                                         uncertainty =       0.022728519748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001120613893
  error estimate for blocks of size 2^( 2) =       0.001159433593
  error estimate for blocks of size 2^( 3) =       0.001194010953
  error estimate for blocks of size 2^( 4) =       0.001217737058
  error estimate for blocks of size 2^( 5) =       0.001233770947
  error estimate for blocks of size 2^( 6) =       0.001241971194
  error estimate for blocks of size 2^( 7) =       0.001243977103

      target function =                  N/A
              le_mean =     -16.720061955662
             les_mean =     282.047107244997
             stat err =       0.001234364076
             autocorr =       1.213317727446
              std dev =       1.584812721561
             le_variance =       2.511631362421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.720061955662        initial
     3.7253e+08     3.7253e+09             9.1298e-13       -16.720061955662
     1.4901e+09     1.4901e+10             2.2825e-13       -16.720061955662
     5.9605e+09     5.9605e+10             5.7061e-14       -16.720061955662  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+09     and shift_s =   5.9605e+10
*****************************************************************************

  Execution time = 2.3834e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0060e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6700e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.7888
    reference variance = 2.15909
====================================================
  Execution time = 1.3004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0286e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5647e+00
  Total weights = 1.946087783e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1961e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595546649437
                                         uncertainty =       0.030575663152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595546649437
                                         uncertainty =       0.030575663152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139042458
  error estimate for blocks of size 2^( 2) =       0.001177309278
  error estimate for blocks of size 2^( 3) =       0.001209727580
  error estimate for blocks of size 2^( 4) =       0.001233254595
  error estimate for blocks of size 2^( 5) =       0.001247592581
  error estimate for blocks of size 2^( 6) =       0.001254816827
  error estimate for blocks of size 2^( 7) =       0.001262912926

      target function =                  N/A
              le_mean =     -16.716696563255
             les_mean =     282.012618737871
             stat err =       0.001249644232
             autocorr =       1.203629856908
              std dev =       1.610875066276
             le_variance =       2.594918479149


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671669656326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716696562305       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716696562305       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716696562305       residual = 1.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+09 is 2.760761e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716696562305       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716696562305       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716696562305       residual = 1.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+09 is 6.902424e-14

solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716696562305       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716696562305       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.716696562305       residual = 1.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+10 is 1.725606e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124224 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6207e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.7601
    reference variance = 2.08556
====================================================
  Execution time = 1.2726e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5596e+00
  Total weights = 1.9459e+06
  Execution time = 2.2041e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589208558929
                                         uncertainty =       0.033189817580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589208558929
                                         uncertainty =       0.033189817580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137924839
  error estimate for blocks of size 2^( 2) =       0.001176119849
  error estimate for blocks of size 2^( 3) =       0.001208656644
  error estimate for blocks of size 2^( 4) =       0.001232217678
  error estimate for blocks of size 2^( 5) =       0.001245505300
  error estimate for blocks of size 2^( 6) =       0.001253616972
  error estimate for blocks of size 2^( 7) =       0.001263181599

      target function =                  N/A
              le_mean =     -16.717681542569
             les_mean =     282.040474839280
             stat err =       0.001248630387
             autocorr =       1.204039251915
              std dev =       1.609294487932
             le_variance =       2.589828748889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589208558929
                                         uncertainty =       0.033189817580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589208558929
                                         uncertainty =       0.033189817580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137924839
  error estimate for blocks of size 2^( 2) =       0.001176119849
  error estimate for blocks of size 2^( 3) =       0.001208656644
  error estimate for blocks of size 2^( 4) =       0.001232217678
  error estimate for blocks of size 2^( 5) =       0.001245505300
  error estimate for blocks of size 2^( 6) =       0.001253616972
  error estimate for blocks of size 2^( 7) =       0.001263181599

      target function =                  N/A
              le_mean =     -16.717681542569
             les_mean =     282.040474839280
             stat err =       0.001248630387
             autocorr =       1.204039251916
              std dev =       1.609294487932
             le_variance =       2.589828748889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589208558929
                                         uncertainty =       0.033189817580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589208558929
                                         uncertainty =       0.033189817580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137924839
  error estimate for blocks of size 2^( 2) =       0.001176119849
  error estimate for blocks of size 2^( 3) =       0.001208656644
  error estimate for blocks of size 2^( 4) =       0.001232217678
  error estimate for blocks of size 2^( 5) =       0.001245505300
  error estimate for blocks of size 2^( 6) =       0.001253616972
  error estimate for blocks of size 2^( 7) =       0.001263181599

      target function =                  N/A
              le_mean =     -16.717681542569
             les_mean =     282.040474839280
             stat err =       0.001248630387
             autocorr =       1.204039251916
              std dev =       1.609294487932
             le_variance =       2.589828748889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589208558929
                                         uncertainty =       0.033189817580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589208558929
                                         uncertainty =       0.033189817580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137924839
  error estimate for blocks of size 2^( 2) =       0.001176119849
  error estimate for blocks of size 2^( 3) =       0.001208656644
  error estimate for blocks of size 2^( 4) =       0.001232217678
  error estimate for blocks of size 2^( 5) =       0.001245505300
  error estimate for blocks of size 2^( 6) =       0.001253616972
  error estimate for blocks of size 2^( 7) =       0.001263181599

      target function =                  N/A
              le_mean =     -16.717681542569
             les_mean =     282.040474839280
             stat err =       0.001248630387
             autocorr =       1.204039251916
              std dev =       1.609294487932
             le_variance =       2.589828748889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717681542569        initial  <--
     1.4901e+09     1.4901e+10             2.7608e-13       -16.717681542569
     5.9605e+09     5.9605e+10             6.9024e-14       -16.717681542569
     2.3842e+10     2.3842e+11             1.7256e-14       -16.717681542569

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.0168
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3230e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6702e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.7049
    reference variance = 4.56906
====================================================
  Execution time = 1.2974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0282e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5829e+00
  Total weights = 1.945617863e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2484e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.610205547903
                                         uncertainty =       0.058915867057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.610205547903
                                         uncertainty =       0.058915867057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001142262323
  error estimate for blocks of size 2^( 2) =       0.001180062758
  error estimate for blocks of size 2^( 3) =       0.001212087769
  error estimate for blocks of size 2^( 4) =       0.001233106614
  error estimate for blocks of size 2^( 5) =       0.001246346847
  error estimate for blocks of size 2^( 6) =       0.001249004977
  error estimate for blocks of size 2^( 7) =       0.001257059119

      target function =                  N/A
              le_mean =     -16.717219945768
             les_mean =     282.048315492997
             stat err =       0.001246379389
             autocorr =       1.190608046218
              std dev =       1.615428715269
             le_variance =       2.609609934116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671721994577e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717219944829       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717219944829       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717219944829       residual = 1.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+10 is 3.348609e-14

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717219944829       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717219944829       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717219944829       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+10 is 8.393404e-15

solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717219944829       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717219944829       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717219944829       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+11 is 2.098351e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6229e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8018
    reference variance = 2.39802
====================================================
  Execution time = 1.2706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5091e+00
  Total weights = 1.9456e+06
  Execution time = 2.2092e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.536408908035
                                         uncertainty =       0.023250007823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.536408908035
                                         uncertainty =       0.023250007823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125966541
  error estimate for blocks of size 2^( 2) =       0.001165099740
  error estimate for blocks of size 2^( 3) =       0.001196385603
  error estimate for blocks of size 2^( 4) =       0.001221508743
  error estimate for blocks of size 2^( 5) =       0.001232295430
  error estimate for blocks of size 2^( 6) =       0.001240145810
  error estimate for blocks of size 2^( 7) =       0.001247649570

      target function =                  N/A
              le_mean =     -16.717334545952
             les_mean =     281.978410498782
             stat err =       0.001235399888
             autocorr =       1.203827179655
              std dev =       1.592382631181
             le_variance =       2.535682444086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.536408908035
                                         uncertainty =       0.023250007823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.536408908035
                                         uncertainty =       0.023250007823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125966541
  error estimate for blocks of size 2^( 2) =       0.001165099740
  error estimate for blocks of size 2^( 3) =       0.001196385603
  error estimate for blocks of size 2^( 4) =       0.001221508743
  error estimate for blocks of size 2^( 5) =       0.001232295430
  error estimate for blocks of size 2^( 6) =       0.001240145810
  error estimate for blocks of size 2^( 7) =       0.001247649570

      target function =                  N/A
              le_mean =     -16.717334545952
             les_mean =     281.978410498782
             stat err =       0.001235399888
             autocorr =       1.203827179655
              std dev =       1.592382631181
             le_variance =       2.535682444086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.536408908035
                                         uncertainty =       0.023250007823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.536408908035
                                         uncertainty =       0.023250007823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125966541
  error estimate for blocks of size 2^( 2) =       0.001165099740
  error estimate for blocks of size 2^( 3) =       0.001196385603
  error estimate for blocks of size 2^( 4) =       0.001221508743
  error estimate for blocks of size 2^( 5) =       0.001232295430
  error estimate for blocks of size 2^( 6) =       0.001240145810
  error estimate for blocks of size 2^( 7) =       0.001247649570

      target function =                  N/A
              le_mean =     -16.717334545952
             les_mean =     281.978410498782
             stat err =       0.001235399888
             autocorr =       1.203827179656
              std dev =       1.592382631181
             le_variance =       2.535682444086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.536408908035
                                         uncertainty =       0.023250007823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.536408908035
                                         uncertainty =       0.023250007823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001125966541
  error estimate for blocks of size 2^( 2) =       0.001165099740
  error estimate for blocks of size 2^( 3) =       0.001196385603
  error estimate for blocks of size 2^( 4) =       0.001221508743
  error estimate for blocks of size 2^( 5) =       0.001232295430
  error estimate for blocks of size 2^( 6) =       0.001240145810
  error estimate for blocks of size 2^( 7) =       0.001247649570

      target function =                  N/A
              le_mean =     -16.717334545952
             les_mean =     281.978410498782
             stat err =       0.001235399888
             autocorr =       1.203827179655
              std dev =       1.592382631181
             le_variance =       2.535682444086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717334545952        initial
     1.4901e+10     1.4901e+11             3.3486e-14       -16.717334545952
     5.9605e+10     5.9605e+11             8.3934e-15       -16.717334545952
     2.3842e+11     2.3842e+12             2.0984e-15       -16.717334545952  <--

*****************************************************************************
Applying the update for shift_i =   2.3842e+11     and shift_s =   2.3842e+12
*****************************************************************************

  Execution time = 2.3871e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0107e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6703e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.9315
    reference variance = 1.52555
====================================================
  Execution time = 1.3004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0247e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4841e+00
  Total weights = 1.945252553e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2344e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.512290570790
                                         uncertainty =       0.023677162482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.512290570790
                                         uncertainty =       0.023677162482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001120602288
  error estimate for blocks of size 2^( 2) =       0.001159728206
  error estimate for blocks of size 2^( 3) =       0.001194264780
  error estimate for blocks of size 2^( 4) =       0.001218105113
  error estimate for blocks of size 2^( 5) =       0.001233227823
  error estimate for blocks of size 2^( 6) =       0.001243361213
  error estimate for blocks of size 2^( 7) =       0.001249707807

      target function =                  N/A
              le_mean =     -16.718955057005
             les_mean =     282.007554375995
             stat err =       0.001236100489
             autocorr =       1.216758942689
              std dev =       1.584796309615
             le_variance =       2.511579342968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671895505701e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718955056086       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718955056086       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718955056086       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+10 is 5.614543e-15

solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718955056086       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718955056086       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718955056086       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718948335509       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718955056086       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.719087219606       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.718733265781       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.724647328392       residual = 1.03e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.003676886742       residual = 7.44e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.489916862473       residual = 1.81e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.482495075765       residual = 1.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.425550300996       residual = 2.71e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.368708634690       residual = 8.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.018580051159       residual = 3.54e+02           smallest_sin_value = 9.93e-01
davidson iteration   14 stopping due to small subspace S singular value of 7.63e-01
davidson solver did not converge after         14 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+11 is 1.406604e-15

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718955056086       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718955056086       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718955056086       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718855924602       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.718955442169       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.888069119459       residual = 8.01e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.731366422976       residual = 1.81e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -20.958296780581       residual = 3.74e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -24.877641264501       residual = 7.10e+03           smallest_sin_value = 1.00e+00
davidson iteration    9 stopping due to too large eigenvalue change
davidson solver did not converge after          9 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+11 is 3.492674e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131189 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6251e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.7871
    reference variance = 1.61081
====================================================
  Execution time = 1.2687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5299e+00
  Total weights = 1.9456e+06
  Execution time = 2.2042e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559440804593
                                         uncertainty =       0.027467341805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559440804593
                                         uncertainty =       0.027467341805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131163365
  error estimate for blocks of size 2^( 2) =       0.001169786734
  error estimate for blocks of size 2^( 3) =       0.001203217885
  error estimate for blocks of size 2^( 4) =       0.001226151223
  error estimate for blocks of size 2^( 5) =       0.001239666999
  error estimate for blocks of size 2^( 6) =       0.001253273530
  error estimate for blocks of size 2^( 7) =       0.001261892259

      target function =                  N/A
              le_mean =     -16.716591239900
             les_mean =     281.974274117631
             stat err =       0.001245246003
             autocorr =       1.211880089440
              std dev =       1.599732167127
             le_variance =       2.559143006540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559440804593
                                         uncertainty =       0.027467341805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559440804593
                                         uncertainty =       0.027467341805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131163365
  error estimate for blocks of size 2^( 2) =       0.001169786734
  error estimate for blocks of size 2^( 3) =       0.001203217885
  error estimate for blocks of size 2^( 4) =       0.001226151223
  error estimate for blocks of size 2^( 5) =       0.001239666999
  error estimate for blocks of size 2^( 6) =       0.001253273530
  error estimate for blocks of size 2^( 7) =       0.001261892259

      target function =                  N/A
              le_mean =     -16.716591239900
             les_mean =     281.974274117631
             stat err =       0.001245246003
             autocorr =       1.211880089440
              std dev =       1.599732167127
             le_variance =       2.559143006540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559440804593
                                         uncertainty =       0.027467341805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559440804593
                                         uncertainty =       0.027467341805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131163365
  error estimate for blocks of size 2^( 2) =       0.001169786734
  error estimate for blocks of size 2^( 3) =       0.001203217885
  error estimate for blocks of size 2^( 4) =       0.001226151223
  error estimate for blocks of size 2^( 5) =       0.001239666999
  error estimate for blocks of size 2^( 6) =       0.001253273530
  error estimate for blocks of size 2^( 7) =       0.001261892259

      target function =                  N/A
              le_mean =     -16.716591239900
             les_mean =     281.974274117631
             stat err =       0.001245246003
             autocorr =       1.211880089439
              std dev =       1.599732167127
             le_variance =       2.559143006540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559440804593
                                         uncertainty =       0.027467341805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559440804593
                                         uncertainty =       0.027467341805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131163365
  error estimate for blocks of size 2^( 2) =       0.001169786734
  error estimate for blocks of size 2^( 3) =       0.001203217885
  error estimate for blocks of size 2^( 4) =       0.001226151223
  error estimate for blocks of size 2^( 5) =       0.001239666999
  error estimate for blocks of size 2^( 6) =       0.001253273530
  error estimate for blocks of size 2^( 7) =       0.001261892259

      target function =                  N/A
              le_mean =     -16.716591239900
             les_mean =     281.974274117631
             stat err =       0.001245246003
             autocorr =       1.211880089440
              std dev =       1.599732167127
             le_variance =       2.559143006540


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716591239900        initial  <--
     5.9605e+10     5.9605e+11             5.6145e-15       -16.716591239900
     2.3842e+11     2.3842e+12             1.4066e-15       -16.716591239900
     9.5367e+11     9.5367e+12             3.4927e-16       -16.716591239900

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8165
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6707e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.898
    reference variance = 1.44311
====================================================
  Execution time = 1.2963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0282e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5293e+00
  Total weights = 1.945375091e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1642e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554281405992
                                         uncertainty =       0.034104672769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.554281405992
                                         uncertainty =       0.034104672769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129889788
  error estimate for blocks of size 2^( 2) =       0.001170028893
  error estimate for blocks of size 2^( 3) =       0.001202820552
  error estimate for blocks of size 2^( 4) =       0.001225790028
  error estimate for blocks of size 2^( 5) =       0.001239858138
  error estimate for blocks of size 2^( 6) =       0.001247414867
  error estimate for blocks of size 2^( 7) =       0.001257137458

      target function =                  N/A
              le_mean =     -16.719612503959
             les_mean =     282.074762013402
             stat err =       0.001242550123
             autocorr =       1.209360184039
              std dev =       1.597931028465
             le_variance =       2.553383571731


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671961250396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719612503061       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719612503061       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719612503061       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.719612503059       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+11 is 9.977636e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719612503061       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719612503061       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.719612503061       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+12 is 2.493072e-16

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719612503061       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719612503061       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132489 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6134e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9665
    reference variance = 1.21211
====================================================
  Execution time = 1.2722e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5971e+00
  Total weights = 1.9457e+06
  Execution time = 2.1970e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.626338685808
                                         uncertainty =       0.085337124146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.626338685808
                                         uncertainty =       0.085337124146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145881504
  error estimate for blocks of size 2^( 2) =       0.001184099294
  error estimate for blocks of size 2^( 3) =       0.001216686318
  error estimate for blocks of size 2^( 4) =       0.001240587185
  error estimate for blocks of size 2^( 5) =       0.001253588414
  error estimate for blocks of size 2^( 6) =       0.001264622442
  error estimate for blocks of size 2^( 7) =       0.001272484052

      target function =                  N/A
              le_mean =     -16.717904091322
             les_mean =     282.085387990954
             stat err =       0.001257820523
             autocorr =       1.204919225894
              std dev =       1.620547092572
             le_variance =       2.626172879242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.626338685808
                                         uncertainty =       0.085337124146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.626338685808
                                         uncertainty =       0.085337124146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145881504
  error estimate for blocks of size 2^( 2) =       0.001184099294
  error estimate for blocks of size 2^( 3) =       0.001216686318
  error estimate for blocks of size 2^( 4) =       0.001240587185
  error estimate for blocks of size 2^( 5) =       0.001253588414
  error estimate for blocks of size 2^( 6) =       0.001264622442
  error estimate for blocks of size 2^( 7) =       0.001272484052

      target function =                  N/A
              le_mean =     -16.717904091322
             les_mean =     282.085387990954
             stat err =       0.001257820523
             autocorr =       1.204919225894
              std dev =       1.620547092572
             le_variance =       2.626172879242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.626338685808
                                         uncertainty =       0.085337124146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.626338685808
                                         uncertainty =       0.085337124146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145881504
  error estimate for blocks of size 2^( 2) =       0.001184099294
  error estimate for blocks of size 2^( 3) =       0.001216686318
  error estimate for blocks of size 2^( 4) =       0.001240587185
  error estimate for blocks of size 2^( 5) =       0.001253588414
  error estimate for blocks of size 2^( 6) =       0.001264622442
  error estimate for blocks of size 2^( 7) =       0.001272484052

      target function =                  N/A
              le_mean =     -16.717904091322
             les_mean =     282.085387990954
             stat err =       0.001257820523
             autocorr =       1.204919225894
              std dev =       1.620547092571
             le_variance =       2.626172879242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.626338685808
                                         uncertainty =       0.085337124146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.626338685808
                                         uncertainty =       0.085337124146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001145881504
  error estimate for blocks of size 2^( 2) =       0.001184099294
  error estimate for blocks of size 2^( 3) =       0.001216686318
  error estimate for blocks of size 2^( 4) =       0.001240587185
  error estimate for blocks of size 2^( 5) =       0.001253588414
  error estimate for blocks of size 2^( 6) =       0.001264622442
  error estimate for blocks of size 2^( 7) =       0.001272484052

      target function =                  N/A
              le_mean =     -16.717904091322
             les_mean =     282.085387990954
             stat err =       0.001257820523
             autocorr =       1.204919225894
              std dev =       1.620547092572
             le_variance =       2.626172879242


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717904091322        initial  <--
     5.9605e+11     5.9605e+12             9.9776e-16       -16.717904091322
     2.3842e+12     2.3842e+13             2.4931e-16       -16.717904091322
     9.5367e+12     9.5367e+13             0.0000e+00       -16.717904091322

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8217
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9962e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6712e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.8657
    reference variance = 1.58146
====================================================
  Execution time = 1.2997e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0279e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5190e+00
  Total weights = 1.945947741e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1839e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546751354050
                                         uncertainty =       0.027320954066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.546751354050
                                         uncertainty =       0.027320954066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001128232342
  error estimate for blocks of size 2^( 2) =       0.001168348359
  error estimate for blocks of size 2^( 3) =       0.001200345460
  error estimate for blocks of size 2^( 4) =       0.001225589668
  error estimate for blocks of size 2^( 5) =       0.001243528968
  error estimate for blocks of size 2^( 6) =       0.001259682292
  error estimate for blocks of size 2^( 7) =       0.001274884030

      target function =                  N/A
              le_mean =     -16.717939813727
             les_mean =     282.008517445128
             stat err =       0.001250921240
             autocorr =       1.229314042400
              std dev =       1.595587008915
             le_variance =       2.545897903019


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671793981373e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717939812813       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717939812813       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717939812813       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717939812813       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.716744338008       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910073474959       residual = 9.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.529868554601       residual = 2.05e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.868138036021       residual = 1.04e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.164508120619       residual = 2.45e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.706262944378       residual = 4.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -13.520404454368       residual = 5.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.884341944654       residual = 3.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   12 stopping due to too large eigenvalue change
davidson solver did not converge after         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+12 is 6.806451e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717939812813       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717939812813       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.37e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717939812813       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717939812813       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6190e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.5114
    reference variance = 4.9814
====================================================
  Execution time = 3.1383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5321e+00
  Total weights = 1.9459e+06
  Execution time = 2.2220e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559766233089
                                         uncertainty =       0.026690758783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559766233089
                                         uncertainty =       0.026690758783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131313553
  error estimate for blocks of size 2^( 2) =       0.001171407881
  error estimate for blocks of size 2^( 3) =       0.001204177148
  error estimate for blocks of size 2^( 4) =       0.001228954659
  error estimate for blocks of size 2^( 5) =       0.001241047342
  error estimate for blocks of size 2^( 6) =       0.001249986799
  error estimate for blocks of size 2^( 7) =       0.001254231550

      target function =                  N/A
              le_mean =     -16.718159944482
             les_mean =     282.028946429814
             stat err =       0.001243555087
             autocorr =       1.208270236186
              std dev =       1.599944568048
             le_variance =       2.559822620828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559766233089
                                         uncertainty =       0.026690758783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559766233089
                                         uncertainty =       0.026690758783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131313553
  error estimate for blocks of size 2^( 2) =       0.001171407881
  error estimate for blocks of size 2^( 3) =       0.001204177148
  error estimate for blocks of size 2^( 4) =       0.001228954659
  error estimate for blocks of size 2^( 5) =       0.001241047342
  error estimate for blocks of size 2^( 6) =       0.001249986799
  error estimate for blocks of size 2^( 7) =       0.001254231550

      target function =                  N/A
              le_mean =     -16.718159944482
             les_mean =     282.028946429814
             stat err =       0.001243555087
             autocorr =       1.208270236185
              std dev =       1.599944568048
             le_variance =       2.559822620828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559766233089
                                         uncertainty =       0.026690758783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559766233089
                                         uncertainty =       0.026690758783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131313553
  error estimate for blocks of size 2^( 2) =       0.001171407881
  error estimate for blocks of size 2^( 3) =       0.001204177148
  error estimate for blocks of size 2^( 4) =       0.001228954659
  error estimate for blocks of size 2^( 5) =       0.001241047342
  error estimate for blocks of size 2^( 6) =       0.001249986799
  error estimate for blocks of size 2^( 7) =       0.001254231550

      target function =                  N/A
              le_mean =     -16.718159944482
             les_mean =     282.028946429814
             stat err =       0.001243555087
             autocorr =       1.208270236186
              std dev =       1.599944568048
             le_variance =       2.559822620828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559766233089
                                         uncertainty =       0.026690758783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.559766233089
                                         uncertainty =       0.026690758783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131313553
  error estimate for blocks of size 2^( 2) =       0.001171407881
  error estimate for blocks of size 2^( 3) =       0.001204177148
  error estimate for blocks of size 2^( 4) =       0.001228954659
  error estimate for blocks of size 2^( 5) =       0.001241047342
  error estimate for blocks of size 2^( 6) =       0.001249986799
  error estimate for blocks of size 2^( 7) =       0.001254231550

      target function =                  N/A
              le_mean =     -16.718159944482
             les_mean =     282.028946429814
             stat err =       0.001243555087
             autocorr =       1.208270236186
              std dev =       1.599944568048
             le_variance =       2.559822620828


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718159944482        initial  <--
     5.9605e+12     5.9605e+13             6.8065e-17       -16.718159944482
     2.3842e+13     2.3842e+14             0.0000e+00       -16.718159944482
     9.5367e+13     9.5367e+14             0.0000e+00       -16.718159944482

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5537
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6711e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.0281
    reference variance = 1.4531
====================================================
  Execution time = 1.2974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0269e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5149e+00
  Total weights = 1.945748359e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2238e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.543754107006
                                         uncertainty =       0.028180431185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.543754107006
                                         uncertainty =       0.028180431185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127843929
  error estimate for blocks of size 2^( 2) =       0.001167004259
  error estimate for blocks of size 2^( 3) =       0.001201366441
  error estimate for blocks of size 2^( 4) =       0.001223969765
  error estimate for blocks of size 2^( 5) =       0.001239244337
  error estimate for blocks of size 2^( 6) =       0.001245904667
  error estimate for blocks of size 2^( 7) =       0.001251214731

      target function =                  N/A
              le_mean =     -16.717841564538
             les_mean =     282.001152050667
             stat err =       0.001240083375
             autocorr =       1.208937247734
              std dev =       1.595037700059
             le_variance =       2.544145264609


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671784156454e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717841563627       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717841563627       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.76e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717841563627       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717841563627       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.76e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717841563627       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717841563627       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.76e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6204e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.463
    reference variance = 5.85417
====================================================
  Execution time = 1.2682e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5501e+00
  Total weights = 1.9455e+06
  Execution time = 2.2004e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577534984449
                                         uncertainty =       0.026161322202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577534984449
                                         uncertainty =       0.026161322202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135267163
  error estimate for blocks of size 2^( 2) =       0.001174865593
  error estimate for blocks of size 2^( 3) =       0.001208529089
  error estimate for blocks of size 2^( 4) =       0.001231276603
  error estimate for blocks of size 2^( 5) =       0.001244803696
  error estimate for blocks of size 2^( 6) =       0.001253628495
  error estimate for blocks of size 2^( 7) =       0.001259114753

      target function =                  N/A
              le_mean =     -16.717870986134
             les_mean =     282.037337348650
             stat err =       0.001247205887
             autocorr =       1.206924632754
              std dev =       1.605535907311
             le_variance =       2.577745549664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577534984449
                                         uncertainty =       0.026161322202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577534984449
                                         uncertainty =       0.026161322202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135267163
  error estimate for blocks of size 2^( 2) =       0.001174865593
  error estimate for blocks of size 2^( 3) =       0.001208529089
  error estimate for blocks of size 2^( 4) =       0.001231276603
  error estimate for blocks of size 2^( 5) =       0.001244803696
  error estimate for blocks of size 2^( 6) =       0.001253628495
  error estimate for blocks of size 2^( 7) =       0.001259114753

      target function =                  N/A
              le_mean =     -16.717870986134
             les_mean =     282.037337348650
             stat err =       0.001247205887
             autocorr =       1.206924632754
              std dev =       1.605535907311
             le_variance =       2.577745549664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577534984449
                                         uncertainty =       0.026161322202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577534984449
                                         uncertainty =       0.026161322202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135267163
  error estimate for blocks of size 2^( 2) =       0.001174865593
  error estimate for blocks of size 2^( 3) =       0.001208529089
  error estimate for blocks of size 2^( 4) =       0.001231276603
  error estimate for blocks of size 2^( 5) =       0.001244803696
  error estimate for blocks of size 2^( 6) =       0.001253628495
  error estimate for blocks of size 2^( 7) =       0.001259114753

      target function =                  N/A
              le_mean =     -16.717870986134
             les_mean =     282.037337348650
             stat err =       0.001247205887
             autocorr =       1.206924632754
              std dev =       1.605535907311
             le_variance =       2.577745549664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577534984449
                                         uncertainty =       0.026161322202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577534984449
                                         uncertainty =       0.026161322202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135267163
  error estimate for blocks of size 2^( 2) =       0.001174865593
  error estimate for blocks of size 2^( 3) =       0.001208529089
  error estimate for blocks of size 2^( 4) =       0.001231276603
  error estimate for blocks of size 2^( 5) =       0.001244803696
  error estimate for blocks of size 2^( 6) =       0.001253628495
  error estimate for blocks of size 2^( 7) =       0.001259114753

      target function =                  N/A
              le_mean =     -16.717870986134
             les_mean =     282.037337348650
             stat err =       0.001247205887
             autocorr =       1.206924632754
              std dev =       1.605535907311
             le_variance =       2.577745549664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717870986134        initial  <--
     5.9605e+13     5.9605e+14             0.0000e+00       -16.717870986134
     2.3842e+14     2.3842e+15             0.0000e+00       -16.717870986134
     9.5367e+14     9.5367e+15             0.0000e+00       -16.717870986134

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8260
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0036e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6712e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.5921
    reference variance = 3.42692
====================================================
  Execution time = 1.3018e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0288e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5348e+00
  Total weights = 1.945622042e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2004e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564296693386
                                         uncertainty =       0.039131460107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.564296693386
                                         uncertainty =       0.039131460107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001132387087
  error estimate for blocks of size 2^( 2) =       0.001170627440
  error estimate for blocks of size 2^( 3) =       0.001203917753
  error estimate for blocks of size 2^( 4) =       0.001228096772
  error estimate for blocks of size 2^( 5) =       0.001244693014
  error estimate for blocks of size 2^( 6) =       0.001254086384
  error estimate for blocks of size 2^( 7) =       0.001261331417

      target function =                  N/A
              le_mean =     -16.719473794560
             les_mean =     282.075558780943
             stat err =       0.001247051897
             autocorr =       1.212772213498
              std dev =       1.601462798607
             le_variance =       2.564683095321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671947379456e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+14, overlap shift 5.9605e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719473793669       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719473793669       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719473793669       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719473793669       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719473793669       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719473793669       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6225e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.4582
    reference variance = 2.16448
====================================================
  Execution time = 1.2662e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5230e+00
  Total weights = 1.9456e+06
  Execution time = 2.2023e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550899012655
                                         uncertainty =       0.040092276253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550899012655
                                         uncertainty =       0.040092276253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129189418
  error estimate for blocks of size 2^( 2) =       0.001167767701
  error estimate for blocks of size 2^( 3) =       0.001199461060
  error estimate for blocks of size 2^( 4) =       0.001222670503
  error estimate for blocks of size 2^( 5) =       0.001237660709
  error estimate for blocks of size 2^( 6) =       0.001246559867
  error estimate for blocks of size 2^( 7) =       0.001255815051

      target function =                  N/A
              le_mean =     -16.719707580688
             les_mean =     282.071575539517
             stat err =       0.001240676532
             autocorr =       1.207211978459
              std dev =       1.596940539751
             le_variance =       2.550219087499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550899012655
                                         uncertainty =       0.040092276253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550899012655
                                         uncertainty =       0.040092276253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129189418
  error estimate for blocks of size 2^( 2) =       0.001167767701
  error estimate for blocks of size 2^( 3) =       0.001199461060
  error estimate for blocks of size 2^( 4) =       0.001222670503
  error estimate for blocks of size 2^( 5) =       0.001237660709
  error estimate for blocks of size 2^( 6) =       0.001246559867
  error estimate for blocks of size 2^( 7) =       0.001255815051

      target function =                  N/A
              le_mean =     -16.719707580688
             les_mean =     282.071575539517
             stat err =       0.001240676532
             autocorr =       1.207211978459
              std dev =       1.596940539751
             le_variance =       2.550219087499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550899012655
                                         uncertainty =       0.040092276253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550899012655
                                         uncertainty =       0.040092276253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129189418
  error estimate for blocks of size 2^( 2) =       0.001167767701
  error estimate for blocks of size 2^( 3) =       0.001199461060
  error estimate for blocks of size 2^( 4) =       0.001222670503
  error estimate for blocks of size 2^( 5) =       0.001237660709
  error estimate for blocks of size 2^( 6) =       0.001246559867
  error estimate for blocks of size 2^( 7) =       0.001255815051

      target function =                  N/A
              le_mean =     -16.719707580688
             les_mean =     282.071575539517
             stat err =       0.001240676532
             autocorr =       1.207211978459
              std dev =       1.596940539751
             le_variance =       2.550219087499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550899012655
                                         uncertainty =       0.040092276253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.550899012655
                                         uncertainty =       0.040092276253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001129189418
  error estimate for blocks of size 2^( 2) =       0.001167767701
  error estimate for blocks of size 2^( 3) =       0.001199461060
  error estimate for blocks of size 2^( 4) =       0.001222670503
  error estimate for blocks of size 2^( 5) =       0.001237660709
  error estimate for blocks of size 2^( 6) =       0.001246559867
  error estimate for blocks of size 2^( 7) =       0.001255815051

      target function =                  N/A
              le_mean =     -16.719707580688
             les_mean =     282.071575539517
             stat err =       0.001240676532
             autocorr =       1.207211978459
              std dev =       1.596940539751
             le_variance =       2.550219087499


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719707580688        initial  <--
     5.9605e+14     5.9605e+15             0.0000e+00       -16.719707580688
     2.3842e+15     2.3842e+16             0.0000e+00       -16.719707580688
     9.5367e+15     9.5367e+16             0.0000e+00       -16.719707580688

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7970
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0032e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6708e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.7514
    reference variance = 1.99129
====================================================
  Execution time = 1.2971e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0258e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4972e+00
  Total weights = 1.945244248e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2200e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521040979534
                                         uncertainty =       0.026380672826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.521040979534
                                         uncertainty =       0.026380672826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001122586430
  error estimate for blocks of size 2^( 2) =       0.001160579725
  error estimate for blocks of size 2^( 3) =       0.001192490251
  error estimate for blocks of size 2^( 4) =       0.001216221403
  error estimate for blocks of size 2^( 5) =       0.001232673048
  error estimate for blocks of size 2^( 6) =       0.001242436013
  error estimate for blocks of size 2^( 7) =       0.001251327758

      target function =                  N/A
              le_mean =     -16.718688919568
             les_mean =     282.011747249290
             stat err =       0.001235664555
             autocorr =       1.211606522111
              std dev =       1.587602355091
             le_variance =       2.520481237892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671868891957e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+15, overlap shift 5.9605e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718688918637       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718688918637       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.12e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718688918637       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718688918637       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.95e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718688918637       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718688918637       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.95e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139133 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6198e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.5522
    reference variance = 2.93458
====================================================
  Execution time = 1.2697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5025e+00
  Total weights = 1.9454e+06
  Execution time = 2.2090e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531779090675
                                         uncertainty =       0.024215931818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531779090675
                                         uncertainty =       0.024215931818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124980108
  error estimate for blocks of size 2^( 2) =       0.001163609555
  error estimate for blocks of size 2^( 3) =       0.001196381875
  error estimate for blocks of size 2^( 4) =       0.001217777680
  error estimate for blocks of size 2^( 5) =       0.001230924387
  error estimate for blocks of size 2^( 6) =       0.001239906083
  error estimate for blocks of size 2^( 7) =       0.001243365623

      target function =                  N/A
              le_mean =     -16.718796817348
             les_mean =     282.020680557800
             stat err =       0.001232993443
             autocorr =       1.201245704793
              std dev =       1.590987581172
             le_variance =       2.531241483444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531779090675
                                         uncertainty =       0.024215931818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531779090675
                                         uncertainty =       0.024215931818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124980108
  error estimate for blocks of size 2^( 2) =       0.001163609555
  error estimate for blocks of size 2^( 3) =       0.001196381875
  error estimate for blocks of size 2^( 4) =       0.001217777680
  error estimate for blocks of size 2^( 5) =       0.001230924387
  error estimate for blocks of size 2^( 6) =       0.001239906083
  error estimate for blocks of size 2^( 7) =       0.001243365623

      target function =                  N/A
              le_mean =     -16.718796817348
             les_mean =     282.020680557800
             stat err =       0.001232993443
             autocorr =       1.201245704793
              std dev =       1.590987581172
             le_variance =       2.531241483444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531779090675
                                         uncertainty =       0.024215931818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531779090675
                                         uncertainty =       0.024215931818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124980108
  error estimate for blocks of size 2^( 2) =       0.001163609555
  error estimate for blocks of size 2^( 3) =       0.001196381875
  error estimate for blocks of size 2^( 4) =       0.001217777680
  error estimate for blocks of size 2^( 5) =       0.001230924387
  error estimate for blocks of size 2^( 6) =       0.001239906083
  error estimate for blocks of size 2^( 7) =       0.001243365623

      target function =                  N/A
              le_mean =     -16.718796817348
             les_mean =     282.020680557800
             stat err =       0.001232993443
             autocorr =       1.201245704793
              std dev =       1.590987581172
             le_variance =       2.531241483444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531779090675
                                         uncertainty =       0.024215931818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.531779090675
                                         uncertainty =       0.024215931818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001124980108
  error estimate for blocks of size 2^( 2) =       0.001163609555
  error estimate for blocks of size 2^( 3) =       0.001196381875
  error estimate for blocks of size 2^( 4) =       0.001217777680
  error estimate for blocks of size 2^( 5) =       0.001230924387
  error estimate for blocks of size 2^( 6) =       0.001239906083
  error estimate for blocks of size 2^( 7) =       0.001243365623

      target function =                  N/A
              le_mean =     -16.718796817348
             les_mean =     282.020680557800
             stat err =       0.001232993443
             autocorr =       1.201245704793
              std dev =       1.590987581172
             le_variance =       2.531241483444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718796817348        initial  <--
     5.9605e+15     5.9605e+16             0.0000e+00       -16.718796817348
     2.3842e+16     2.3842e+17             0.0000e+00       -16.718796817348
     9.5367e+16     9.5367e+17             0.0000e+00       -16.718796817348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.9470
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3151e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6707e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.7198
    reference variance = 1.37457
====================================================
  Execution time = 1.2975e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0258e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5164e+00
  Total weights = 1.945923187e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1891e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545292706108
                                         uncertainty =       0.028274597786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.545292706108
                                         uncertainty =       0.028274597786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127944844
  error estimate for blocks of size 2^( 2) =       0.001166678154
  error estimate for blocks of size 2^( 3) =       0.001199936229
  error estimate for blocks of size 2^( 4) =       0.001223089589
  error estimate for blocks of size 2^( 5) =       0.001235818945
  error estimate for blocks of size 2^( 6) =       0.001241771014
  error estimate for blocks of size 2^( 7) =       0.001245050958

      target function =                  N/A
              le_mean =     -16.718199477215
             les_mean =     282.014610134910
             stat err =       0.001236432627
             autocorr =       1.201614572341
              std dev =       1.595180418186
             le_variance =       2.544600566563


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671819947722e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+16, overlap shift 5.9605e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718199476305       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718199476305       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718199476304       residual = 6.09e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+16 is 6.936215e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718199476305       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718199476305       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718199476307       residual = 1.96e+03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+17 is 1.734054e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718199476305       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718199476305       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718199476317       residual = 3.82e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.718199482921       residual = 1.92e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+17 is 4.335134e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6171e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9375
    reference variance = 1.2053
====================================================
  Execution time = 1.2659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.6070e+00
  Total weights = 1.9460e+06
  Execution time = 2.2227e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.634169429852
                                         uncertainty =       0.060214698083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.634169429852
                                         uncertainty =       0.060214698083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001148072765
  error estimate for blocks of size 2^( 2) =       0.001185394010
  error estimate for blocks of size 2^( 3) =       0.001216668639
  error estimate for blocks of size 2^( 4) =       0.001239456642
  error estimate for blocks of size 2^( 5) =       0.001252789310
  error estimate for blocks of size 2^( 6) =       0.001256484552
  error estimate for blocks of size 2^( 7) =       0.001256579960

      target function =                  N/A
              le_mean =     -16.718273705961
             les_mean =     282.107682434397
             stat err =       0.001251327616
             autocorr =       1.187963862099
              std dev =       1.623646052252
             le_variance =       2.636226502992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.634169429852
                                         uncertainty =       0.060214698083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.634169429852
                                         uncertainty =       0.060214698083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001148072765
  error estimate for blocks of size 2^( 2) =       0.001185394010
  error estimate for blocks of size 2^( 3) =       0.001216668639
  error estimate for blocks of size 2^( 4) =       0.001239456642
  error estimate for blocks of size 2^( 5) =       0.001252789310
  error estimate for blocks of size 2^( 6) =       0.001256484552
  error estimate for blocks of size 2^( 7) =       0.001256579960

      target function =                  N/A
              le_mean =     -16.718273705961
             les_mean =     282.107682434397
             stat err =       0.001251327616
             autocorr =       1.187963862099
              std dev =       1.623646052252
             le_variance =       2.636226502992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.634169429852
                                         uncertainty =       0.060214698083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.634169429852
                                         uncertainty =       0.060214698083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001148072765
  error estimate for blocks of size 2^( 2) =       0.001185394010
  error estimate for blocks of size 2^( 3) =       0.001216668639
  error estimate for blocks of size 2^( 4) =       0.001239456642
  error estimate for blocks of size 2^( 5) =       0.001252789310
  error estimate for blocks of size 2^( 6) =       0.001256484552
  error estimate for blocks of size 2^( 7) =       0.001256579960

      target function =                  N/A
              le_mean =     -16.718273705961
             les_mean =     282.107682434397
             stat err =       0.001251327616
             autocorr =       1.187963862099
              std dev =       1.623646052252
             le_variance =       2.636226502992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.634169429852
                                         uncertainty =       0.060214698083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.634169429852
                                         uncertainty =       0.060214698083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001148072765
  error estimate for blocks of size 2^( 2) =       0.001185394010
  error estimate for blocks of size 2^( 3) =       0.001216668639
  error estimate for blocks of size 2^( 4) =       0.001239456642
  error estimate for blocks of size 2^( 5) =       0.001252789310
  error estimate for blocks of size 2^( 6) =       0.001256484552
  error estimate for blocks of size 2^( 7) =       0.001256579960

      target function =                  N/A
              le_mean =     -16.718273705961
             les_mean =     282.107682434397
             stat err =       0.001251327616
             autocorr =       1.187963862099
              std dev =       1.623646052252
             le_variance =       2.636226502992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.718273705961        initial  <--
     5.9605e+16     5.9605e+17             6.9362e-21       -16.718273705961
     2.3842e+17     2.3842e+18             1.7341e-21       -16.718273705961
     9.5367e+17     9.5367e+18             4.3351e-22       -16.718273705961

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9165
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0094e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6709e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8717
    reference variance = 1.48835
====================================================
  Execution time = 1.2974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0236e+04
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.4961e+00
  Total weights = 1.945339873e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1896e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.523266179923
                                         uncertainty =       0.027436536734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.523266179923
                                         uncertainty =       0.027436536734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123180488
  error estimate for blocks of size 2^( 2) =       0.001162311586
  error estimate for blocks of size 2^( 3) =       0.001195825877
  error estimate for blocks of size 2^( 4) =       0.001219022543
  error estimate for blocks of size 2^( 5) =       0.001228874417
  error estimate for blocks of size 2^( 6) =       0.001235931807
  error estimate for blocks of size 2^( 7) =       0.001246419028

      target function =                  N/A
              le_mean =     -16.716837171245
             les_mean =     281.948780977310
             stat err =       0.001232561949
             autocorr =       1.204254872024
              std dev =       1.588442493155
             le_variance =       2.523149554062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671683717125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+17, overlap shift 5.9605e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716837170334       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716837170334       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716837170334       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716837170334       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.716837170334       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.716837170334       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141956 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6170e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.5522
    reference variance = 2.62657
====================================================
  Execution time = 1.2648e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.6474e+00
  Total weights = 1.9456e+06
  Execution time = 2.2259e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.680464875771
                                         uncertainty =       0.119773975196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.680464875771
                                         uncertainty =       0.119773975196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001157591898
  error estimate for blocks of size 2^( 2) =       0.001195731583
  error estimate for blocks of size 2^( 3) =       0.001229324227
  error estimate for blocks of size 2^( 4) =       0.001252894409
  error estimate for blocks of size 2^( 5) =       0.001267362197
  error estimate for blocks of size 2^( 6) =       0.001273223399
  error estimate for blocks of size 2^( 7) =       0.001278186053

      target function =                  N/A
              le_mean =     -16.717259068126
             les_mean =     282.114130737406
             stat err =       0.001267916515
             autocorr =       1.199693650838
              std dev =       1.637108354479
             le_variance =       2.680123764305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.680464875771
                                         uncertainty =       0.119773975196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.680464875771
                                         uncertainty =       0.119773975196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001157591898
  error estimate for blocks of size 2^( 2) =       0.001195731583
  error estimate for blocks of size 2^( 3) =       0.001229324227
  error estimate for blocks of size 2^( 4) =       0.001252894409
  error estimate for blocks of size 2^( 5) =       0.001267362197
  error estimate for blocks of size 2^( 6) =       0.001273223399
  error estimate for blocks of size 2^( 7) =       0.001278186053

      target function =                  N/A
              le_mean =     -16.717259068126
             les_mean =     282.114130737406
             stat err =       0.001267916515
             autocorr =       1.199693650838
              std dev =       1.637108354479
             le_variance =       2.680123764305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.680464875771
                                         uncertainty =       0.119773975196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.680464875771
                                         uncertainty =       0.119773975196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001157591898
  error estimate for blocks of size 2^( 2) =       0.001195731583
  error estimate for blocks of size 2^( 3) =       0.001229324227
  error estimate for blocks of size 2^( 4) =       0.001252894409
  error estimate for blocks of size 2^( 5) =       0.001267362197
  error estimate for blocks of size 2^( 6) =       0.001273223399
  error estimate for blocks of size 2^( 7) =       0.001278186053

      target function =                  N/A
              le_mean =     -16.717259068126
             les_mean =     282.114130737406
             stat err =       0.001267916515
             autocorr =       1.199693650838
              std dev =       1.637108354479
             le_variance =       2.680123764305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.680464875771
                                         uncertainty =       0.119773975196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.680464875771
                                         uncertainty =       0.119773975196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001157591898
  error estimate for blocks of size 2^( 2) =       0.001195731583
  error estimate for blocks of size 2^( 3) =       0.001229324227
  error estimate for blocks of size 2^( 4) =       0.001252894409
  error estimate for blocks of size 2^( 5) =       0.001267362197
  error estimate for blocks of size 2^( 6) =       0.001273223399
  error estimate for blocks of size 2^( 7) =       0.001278186053

      target function =                  N/A
              le_mean =     -16.717259068126
             les_mean =     282.114130737406
             stat err =       0.001267916515
             autocorr =       1.199693650838
              std dev =       1.637108354479
             le_variance =       2.680123764305


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717259068126        initial  <--
     5.9605e+17     5.9605e+18             0.0000e+00       -16.717259068126
     2.3842e+18     2.3842e+19             0.0000e+00       -16.717259068126
     9.5367e+18     9.5367e+19             0.0000e+00       -16.717259068126

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9107
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0087e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6709e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.8239
    reference variance = 1.32649
====================================================
  Execution time = 1.2952e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0278e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5106e+00
  Total weights = 1.946141319e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2063e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538719274532
                                         uncertainty =       0.023615736142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.538719274532
                                         uncertainty =       0.023615736142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001126699254
  error estimate for blocks of size 2^( 2) =       0.001165616041
  error estimate for blocks of size 2^( 3) =       0.001198922370
  error estimate for blocks of size 2^( 4) =       0.001222763903
  error estimate for blocks of size 2^( 5) =       0.001235153608
  error estimate for blocks of size 2^( 6) =       0.001243556224
  error estimate for blocks of size 2^( 7) =       0.001249001267

      target function =                  N/A
              le_mean =     -16.718366337972
             les_mean =     282.014362135408
             stat err =       0.001237618751
             autocorr =       1.206584516375
              std dev =       1.593418859199
             le_variance =       2.538983660850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671836633797e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+18, overlap shift 5.9605e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718366337032       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718366337032       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718366337032       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718366337032       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718366337032       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718366337032       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6164e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.6942
    reference variance = 2.55925
====================================================
  Execution time = 1.2738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5622e+00
  Total weights = 1.9457e+06
  Execution time = 2.2307e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589806501632
                                         uncertainty =       0.054615316723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589806501632
                                         uncertainty =       0.054615316723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137894339
  error estimate for blocks of size 2^( 2) =       0.001176482946
  error estimate for blocks of size 2^( 3) =       0.001208754860
  error estimate for blocks of size 2^( 4) =       0.001231974744
  error estimate for blocks of size 2^( 5) =       0.001245414469
  error estimate for blocks of size 2^( 6) =       0.001252884872
  error estimate for blocks of size 2^( 7) =       0.001253810593

      target function =                  N/A
              le_mean =     -16.717941350994
             les_mean =     282.051781214333
             stat err =       0.001246021169
             autocorr =       1.199076711413
              std dev =       1.609251354167
             le_variance =       2.589689920887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589806501632
                                         uncertainty =       0.054615316723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589806501632
                                         uncertainty =       0.054615316723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137894339
  error estimate for blocks of size 2^( 2) =       0.001176482946
  error estimate for blocks of size 2^( 3) =       0.001208754860
  error estimate for blocks of size 2^( 4) =       0.001231974744
  error estimate for blocks of size 2^( 5) =       0.001245414469
  error estimate for blocks of size 2^( 6) =       0.001252884872
  error estimate for blocks of size 2^( 7) =       0.001253810593

      target function =                  N/A
              le_mean =     -16.717941350994
             les_mean =     282.051781214333
             stat err =       0.001246021169
             autocorr =       1.199076711413
              std dev =       1.609251354167
             le_variance =       2.589689920887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589806501632
                                         uncertainty =       0.054615316723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589806501632
                                         uncertainty =       0.054615316723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137894339
  error estimate for blocks of size 2^( 2) =       0.001176482946
  error estimate for blocks of size 2^( 3) =       0.001208754860
  error estimate for blocks of size 2^( 4) =       0.001231974744
  error estimate for blocks of size 2^( 5) =       0.001245414469
  error estimate for blocks of size 2^( 6) =       0.001252884872
  error estimate for blocks of size 2^( 7) =       0.001253810593

      target function =                  N/A
              le_mean =     -16.717941350994
             les_mean =     282.051781214333
             stat err =       0.001246021169
             autocorr =       1.199076711413
              std dev =       1.609251354167
             le_variance =       2.589689920887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589806501632
                                         uncertainty =       0.054615316723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.589806501632
                                         uncertainty =       0.054615316723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001137894339
  error estimate for blocks of size 2^( 2) =       0.001176482946
  error estimate for blocks of size 2^( 3) =       0.001208754860
  error estimate for blocks of size 2^( 4) =       0.001231974744
  error estimate for blocks of size 2^( 5) =       0.001245414469
  error estimate for blocks of size 2^( 6) =       0.001252884872
  error estimate for blocks of size 2^( 7) =       0.001253810593

      target function =                  N/A
              le_mean =     -16.717941350994
             les_mean =     282.051781214333
             stat err =       0.001246021169
             autocorr =       1.199076711413
              std dev =       1.609251354167
             le_variance =       2.589689920887


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717941350994        initial  <--
     5.9605e+18     5.9605e+19             0.0000e+00       -16.717941350994
     2.3842e+19     2.3842e+20             0.0000e+00       -16.717941350994
     9.5367e+19     9.5367e+20             0.0000e+00       -16.717941350994

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0200
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0191e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6710e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.4143
    reference variance = 4.09134
====================================================
  Execution time = 1.2986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0269e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4883e+00
  Total weights = 1.945896172e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2143e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.512606616338
                                         uncertainty =       0.019458653403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.512606616338
                                         uncertainty =       0.019458653403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001120930324
  error estimate for blocks of size 2^( 2) =       0.001159717462
  error estimate for blocks of size 2^( 3) =       0.001193962430
  error estimate for blocks of size 2^( 4) =       0.001217647637
  error estimate for blocks of size 2^( 5) =       0.001232202808
  error estimate for blocks of size 2^( 6) =       0.001239815609
  error estimate for blocks of size 2^( 7) =       0.001241429300

      target function =                  N/A
              le_mean =     -16.718915199988
             les_mean =     282.010389422016
             stat err =       0.001232773838
             autocorr =       1.209510331135
              std dev =       1.585260230639
             le_variance =       2.513049998847


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671891519999e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+19, overlap shift 5.9605e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718915199056       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718915199056       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718915199056       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718915199056       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718915199056       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718915199056       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144366 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6206e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8072
    reference variance = 2.43825
====================================================
  Execution time = 1.2664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.6413e+00
  Total weights = 1.9457e+06
  Execution time = 2.2236e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.672715549964
                                         uncertainty =       0.153602473096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.672715549964
                                         uncertainty =       0.153602473096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155914239
  error estimate for blocks of size 2^( 2) =       0.001192628720
  error estimate for blocks of size 2^( 3) =       0.001223305597
  error estimate for blocks of size 2^( 4) =       0.001245341904
  error estimate for blocks of size 2^( 5) =       0.001259174777
  error estimate for blocks of size 2^( 6) =       0.001266671100
  error estimate for blocks of size 2^( 7) =       0.001272954685

      target function =                  N/A
              le_mean =     -16.719319490831
             les_mean =     282.176916038161
             stat err =       0.001261035617
             autocorr =       1.190154872936
              std dev =       1.634735748225
             le_variance =       2.672360966524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.672715549964
                                         uncertainty =       0.153602473096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.672715549964
                                         uncertainty =       0.153602473096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155914239
  error estimate for blocks of size 2^( 2) =       0.001192628720
  error estimate for blocks of size 2^( 3) =       0.001223305597
  error estimate for blocks of size 2^( 4) =       0.001245341904
  error estimate for blocks of size 2^( 5) =       0.001259174777
  error estimate for blocks of size 2^( 6) =       0.001266671100
  error estimate for blocks of size 2^( 7) =       0.001272954685

      target function =                  N/A
              le_mean =     -16.719319490831
             les_mean =     282.176916038161
             stat err =       0.001261035617
             autocorr =       1.190154872936
              std dev =       1.634735748225
             le_variance =       2.672360966524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.672715549964
                                         uncertainty =       0.153602473096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.672715549964
                                         uncertainty =       0.153602473096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155914239
  error estimate for blocks of size 2^( 2) =       0.001192628720
  error estimate for blocks of size 2^( 3) =       0.001223305597
  error estimate for blocks of size 2^( 4) =       0.001245341904
  error estimate for blocks of size 2^( 5) =       0.001259174777
  error estimate for blocks of size 2^( 6) =       0.001266671100
  error estimate for blocks of size 2^( 7) =       0.001272954685

      target function =                  N/A
              le_mean =     -16.719319490831
             les_mean =     282.176916038161
             stat err =       0.001261035617
             autocorr =       1.190154872936
              std dev =       1.634735748225
             le_variance =       2.672360966524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.672715549964
                                         uncertainty =       0.153602473096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.672715549964
                                         uncertainty =       0.153602473096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155914239
  error estimate for blocks of size 2^( 2) =       0.001192628720
  error estimate for blocks of size 2^( 3) =       0.001223305597
  error estimate for blocks of size 2^( 4) =       0.001245341904
  error estimate for blocks of size 2^( 5) =       0.001259174777
  error estimate for blocks of size 2^( 6) =       0.001266671100
  error estimate for blocks of size 2^( 7) =       0.001272954685

      target function =                  N/A
              le_mean =     -16.719319490831
             les_mean =     282.176916038161
             stat err =       0.001261035617
             autocorr =       1.190154872936
              std dev =       1.634735748225
             le_variance =       2.672360966524


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719319490831        initial  <--
     5.9605e+19     5.9605e+20             0.0000e+00       -16.719319490831
     2.3842e+20     2.3842e+21             0.0000e+00       -16.719319490831
     9.5367e+20     9.5367e+21             0.0000e+00       -16.719319490831

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9053
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0118e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6708e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.9751
    reference variance = 1.39699
====================================================
  Execution time = 1.2993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0249e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5177e+00
  Total weights = 1.946125844e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2311e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544821466234
                                         uncertainty =       0.027280511980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.544821466234
                                         uncertainty =       0.027280511980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001127937823
  error estimate for blocks of size 2^( 2) =       0.001165607195
  error estimate for blocks of size 2^( 3) =       0.001197541565
  error estimate for blocks of size 2^( 4) =       0.001219818895
  error estimate for blocks of size 2^( 5) =       0.001233838460
  error estimate for blocks of size 2^( 6) =       0.001239826305
  error estimate for blocks of size 2^( 7) =       0.001242579062

      target function =                  N/A
              le_mean =     -16.717991343821
             les_mean =     282.008952604079
             stat err =       0.001234015681
             autocorr =       1.196936294912
              std dev =       1.595170489252
             le_variance =       2.544568889781


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671799134382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+20, overlap shift 5.9605e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717991342959       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717991342959       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717991342959       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+20 is 7.064186e-25

solving harmonic davidson linear method for identity shift 2.3842e+21, overlap shift 2.3842e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717991342959       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717991342959       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717991342959       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+21 is 1.766046e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717991342959       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717991342959       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717991342959       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+21 is 4.415116e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145886 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6231e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.9295
    reference variance = 1.62834
====================================================
  Execution time = 1.2688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5577e+00
  Total weights = 1.9453e+06
  Execution time = 2.2290e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574410916909
                                         uncertainty =       0.045510413359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574410916909
                                         uncertainty =       0.045510413359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134621803
  error estimate for blocks of size 2^( 2) =       0.001172863555
  error estimate for blocks of size 2^( 3) =       0.001206220218
  error estimate for blocks of size 2^( 4) =       0.001227125244
  error estimate for blocks of size 2^( 5) =       0.001235951600
  error estimate for blocks of size 2^( 6) =       0.001243602822
  error estimate for blocks of size 2^( 7) =       0.001246821568

      target function =                  N/A
              le_mean =     -16.719774433235
             les_mean =     282.108534056236
             stat err =       0.001238375308
             autocorr =       1.191248369439
              std dev =       1.604623214638
             le_variance =       2.574815660954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574410916909
                                         uncertainty =       0.045510413359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574410916909
                                         uncertainty =       0.045510413359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134621803
  error estimate for blocks of size 2^( 2) =       0.001172863555
  error estimate for blocks of size 2^( 3) =       0.001206220218
  error estimate for blocks of size 2^( 4) =       0.001227125244
  error estimate for blocks of size 2^( 5) =       0.001235951600
  error estimate for blocks of size 2^( 6) =       0.001243602822
  error estimate for blocks of size 2^( 7) =       0.001246821568

      target function =                  N/A
              le_mean =     -16.719774433235
             les_mean =     282.108534056236
             stat err =       0.001238375308
             autocorr =       1.191248369439
              std dev =       1.604623214638
             le_variance =       2.574815660954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574410916909
                                         uncertainty =       0.045510413359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574410916909
                                         uncertainty =       0.045510413359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134621803
  error estimate for blocks of size 2^( 2) =       0.001172863555
  error estimate for blocks of size 2^( 3) =       0.001206220218
  error estimate for blocks of size 2^( 4) =       0.001227125244
  error estimate for blocks of size 2^( 5) =       0.001235951600
  error estimate for blocks of size 2^( 6) =       0.001243602822
  error estimate for blocks of size 2^( 7) =       0.001246821568

      target function =                  N/A
              le_mean =     -16.719774433235
             les_mean =     282.108534056236
             stat err =       0.001238375308
             autocorr =       1.191248369439
              std dev =       1.604623214638
             le_variance =       2.574815660954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574410916909
                                         uncertainty =       0.045510413359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.574410916909
                                         uncertainty =       0.045510413359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134621803
  error estimate for blocks of size 2^( 2) =       0.001172863555
  error estimate for blocks of size 2^( 3) =       0.001206220218
  error estimate for blocks of size 2^( 4) =       0.001227125244
  error estimate for blocks of size 2^( 5) =       0.001235951600
  error estimate for blocks of size 2^( 6) =       0.001243602822
  error estimate for blocks of size 2^( 7) =       0.001246821568

      target function =                  N/A
              le_mean =     -16.719774433235
             les_mean =     282.108534056236
             stat err =       0.001238375308
             autocorr =       1.191248369439
              std dev =       1.604623214638
             le_variance =       2.574815660954


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719774433235        initial  <--
     5.9605e+20     5.9605e+21             7.0642e-25       -16.719774433235
     2.3842e+21     2.3842e+22             1.7660e-25       -16.719774433235
     9.5367e+21     9.5367e+22             4.4151e-26       -16.719774433235

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9925
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0235e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6713e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.669
    reference variance = 2.0766
====================================================
  Execution time = 1.2979e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0274e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5680e+00
  Total weights = 1.945639824e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1983e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595785499618
                                         uncertainty =       0.029156076353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.595785499618
                                         uncertainty =       0.029156076353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001139167614
  error estimate for blocks of size 2^( 2) =       0.001176026480
  error estimate for blocks of size 2^( 3) =       0.001208565797
  error estimate for blocks of size 2^( 4) =       0.001230629224
  error estimate for blocks of size 2^( 5) =       0.001243724827
  error estimate for blocks of size 2^( 6) =       0.001254249851
  error estimate for blocks of size 2^( 7) =       0.001264159747

      target function =                  N/A
              le_mean =     -16.717953386618
             les_mean =     282.057983944130
             stat err =       0.001248190912
             autocorr =       1.200568027089
              std dev =       1.611052065322
             le_variance =       2.595488757178


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671795338662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+21, overlap shift 5.9605e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717953385680       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717953385680       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+22, overlap shift 2.3842e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717953385680       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717953385680       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717953385680       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717953385680       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6184e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.4264
    reference variance = 19.7815
====================================================
  Execution time = 1.2743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6715e+01
  VMC Evar = 2.6504e+00
  Total weights = 1.9456e+06
  Execution time = 2.2261e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670204281780
                                         uncertainty =       0.079975413689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670204281780
                                         uncertainty =       0.079975413689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155448586
  error estimate for blocks of size 2^( 2) =       0.001192773782
  error estimate for blocks of size 2^( 3) =       0.001226638914
  error estimate for blocks of size 2^( 4) =       0.001250690177
  error estimate for blocks of size 2^( 5) =       0.001262861399
  error estimate for blocks of size 2^( 6) =       0.001268141916
  error estimate for blocks of size 2^( 7) =       0.001273104221

      target function =                  N/A
              le_mean =     -16.715234448566
             les_mean =     282.049413520145
             stat err =       0.001263699428
             autocorr =       1.196151879460
              std dev =       1.634077205696
             le_variance =       2.670208314174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670204281780
                                         uncertainty =       0.079975413689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670204281780
                                         uncertainty =       0.079975413689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155448586
  error estimate for blocks of size 2^( 2) =       0.001192773782
  error estimate for blocks of size 2^( 3) =       0.001226638914
  error estimate for blocks of size 2^( 4) =       0.001250690177
  error estimate for blocks of size 2^( 5) =       0.001262861399
  error estimate for blocks of size 2^( 6) =       0.001268141916
  error estimate for blocks of size 2^( 7) =       0.001273104221

      target function =                  N/A
              le_mean =     -16.715234448566
             les_mean =     282.049413520145
             stat err =       0.001263699428
             autocorr =       1.196151879460
              std dev =       1.634077205696
             le_variance =       2.670208314174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670204281780
                                         uncertainty =       0.079975413689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670204281780
                                         uncertainty =       0.079975413689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155448586
  error estimate for blocks of size 2^( 2) =       0.001192773782
  error estimate for blocks of size 2^( 3) =       0.001226638914
  error estimate for blocks of size 2^( 4) =       0.001250690177
  error estimate for blocks of size 2^( 5) =       0.001262861399
  error estimate for blocks of size 2^( 6) =       0.001268141916
  error estimate for blocks of size 2^( 7) =       0.001273104221

      target function =                  N/A
              le_mean =     -16.715234448566
             les_mean =     282.049413520145
             stat err =       0.001263699428
             autocorr =       1.196151879460
              std dev =       1.634077205696
             le_variance =       2.670208314174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670204281780
                                         uncertainty =       0.079975413689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670204281780
                                         uncertainty =       0.079975413689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155448586
  error estimate for blocks of size 2^( 2) =       0.001192773782
  error estimate for blocks of size 2^( 3) =       0.001226638914
  error estimate for blocks of size 2^( 4) =       0.001250690177
  error estimate for blocks of size 2^( 5) =       0.001262861399
  error estimate for blocks of size 2^( 6) =       0.001268141916
  error estimate for blocks of size 2^( 7) =       0.001273104221

      target function =                  N/A
              le_mean =     -16.715234448566
             les_mean =     282.049413520145
             stat err =       0.001263699428
             autocorr =       1.196151879460
              std dev =       1.634077205696
             le_variance =       2.670208314174


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.715234448566        initial  <--
     5.9605e+21     5.9605e+22             0.0000e+00       -16.715234448566
     2.3842e+22     2.3842e+23             0.0000e+00       -16.715234448566
     9.5367e+22     9.5367e+23             0.0000e+00       -16.715234448566

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0113
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0202e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6710e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.4242
    reference variance = 1.7985
====================================================
  Execution time = 1.2977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0242e+04
  VMC Eavg = -1.6720e+01
  VMC Evar = 2.5513e+00
  Total weights = 1.945674091e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2045e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579534492724
                                         uncertainty =       0.032978049944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.579534492724
                                         uncertainty =       0.032978049944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135662326
  error estimate for blocks of size 2^( 2) =       0.001174012913
  error estimate for blocks of size 2^( 3) =       0.001206679819
  error estimate for blocks of size 2^( 4) =       0.001231981278
  error estimate for blocks of size 2^( 5) =       0.001247785192
  error estimate for blocks of size 2^( 6) =       0.001257181554
  error estimate for blocks of size 2^( 7) =       0.001262318484

      target function =                  N/A
              le_mean =     -16.719773721700
             les_mean =     282.102116217508
             stat err =       0.001249816627
             autocorr =       1.211139471092
              std dev =       1.606094761065
             le_variance =       2.579540381520


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671977372170e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+22, overlap shift 5.9605e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719773720821       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719773720821       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+23, overlap shift 2.3842e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719773720821       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719773720821       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+23, overlap shift 9.5367e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719773720821       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719773720821       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148256 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6188e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.3986
    reference variance = 2.22259
====================================================
  Execution time = 1.2670e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.5491e+00
  Total weights = 1.9460e+06
  Execution time = 2.2233e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577551874837
                                         uncertainty =       0.049461042043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577551874837
                                         uncertainty =       0.049461042043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135246103
  error estimate for blocks of size 2^( 2) =       0.001173426283
  error estimate for blocks of size 2^( 3) =       0.001205361370
  error estimate for blocks of size 2^( 4) =       0.001228209096
  error estimate for blocks of size 2^( 5) =       0.001240516778
  error estimate for blocks of size 2^( 6) =       0.001246819998
  error estimate for blocks of size 2^( 7) =       0.001250079604

      target function =                  N/A
              le_mean =     -16.717690641161
             les_mean =     282.030259489831
             stat err =       0.001241406369
             autocorr =       1.195770675979
              std dev =       1.605506122555
             le_variance =       2.577649909561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577551874837
                                         uncertainty =       0.049461042043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577551874837
                                         uncertainty =       0.049461042043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135246103
  error estimate for blocks of size 2^( 2) =       0.001173426283
  error estimate for blocks of size 2^( 3) =       0.001205361370
  error estimate for blocks of size 2^( 4) =       0.001228209096
  error estimate for blocks of size 2^( 5) =       0.001240516778
  error estimate for blocks of size 2^( 6) =       0.001246819998
  error estimate for blocks of size 2^( 7) =       0.001250079604

      target function =                  N/A
              le_mean =     -16.717690641161
             les_mean =     282.030259489831
             stat err =       0.001241406369
             autocorr =       1.195770675979
              std dev =       1.605506122555
             le_variance =       2.577649909561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577551874837
                                         uncertainty =       0.049461042043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577551874837
                                         uncertainty =       0.049461042043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135246103
  error estimate for blocks of size 2^( 2) =       0.001173426283
  error estimate for blocks of size 2^( 3) =       0.001205361370
  error estimate for blocks of size 2^( 4) =       0.001228209096
  error estimate for blocks of size 2^( 5) =       0.001240516778
  error estimate for blocks of size 2^( 6) =       0.001246819998
  error estimate for blocks of size 2^( 7) =       0.001250079604

      target function =                  N/A
              le_mean =     -16.717690641161
             les_mean =     282.030259489831
             stat err =       0.001241406369
             autocorr =       1.195770675979
              std dev =       1.605506122555
             le_variance =       2.577649909561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577551874837
                                         uncertainty =       0.049461042043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.577551874837
                                         uncertainty =       0.049461042043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001135246103
  error estimate for blocks of size 2^( 2) =       0.001173426283
  error estimate for blocks of size 2^( 3) =       0.001205361370
  error estimate for blocks of size 2^( 4) =       0.001228209096
  error estimate for blocks of size 2^( 5) =       0.001240516778
  error estimate for blocks of size 2^( 6) =       0.001246819998
  error estimate for blocks of size 2^( 7) =       0.001250079604

      target function =                  N/A
              le_mean =     -16.717690641161
             les_mean =     282.030259489831
             stat err =       0.001241406369
             autocorr =       1.195770675979
              std dev =       1.605506122555
             le_variance =       2.577649909561


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717690641161        initial  <--
     5.9605e+22     5.9605e+23             0.0000e+00       -16.717690641161
     2.3842e+23     2.3842e+24             0.0000e+00       -16.717690641161
     9.5367e+23     9.5367e+24             0.0000e+00       -16.717690641161

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9234
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0117e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6704e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.7696
    reference variance = 1.61286
====================================================
  Execution time = 1.5500e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0279e+04
  VMC Eavg = -1.6718e+01
  VMC Evar = 2.4872e+00
  Total weights = 1.945708009e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1893e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515109818273
                                         uncertainty =       0.023014218459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.515109818273
                                         uncertainty =       0.023014218459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121325837
  error estimate for blocks of size 2^( 2) =       0.001160729368
  error estimate for blocks of size 2^( 3) =       0.001193959759
  error estimate for blocks of size 2^( 4) =       0.001215900922
  error estimate for blocks of size 2^( 5) =       0.001231329945
  error estimate for blocks of size 2^( 6) =       0.001238470239
  error estimate for blocks of size 2^( 7) =       0.001247742761

      target function =                  N/A
              le_mean =     -16.717512997328
             les_mean =     281.962470090050
             stat err =       0.001233360967
             autocorr =       1.209808806109
              std dev =       1.585819579626
             le_variance =       2.514823739126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671751299733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+23, overlap shift 5.9605e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717512996386       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717512996386       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717512996386       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+23 is 6.465972e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+24, overlap shift 2.3842e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717512996386       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717512996386       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717512996386       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+24 is 1.616493e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+24, overlap shift 9.5367e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.717512996386       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.717512996386       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.717514935575       residual = 4.26e+08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.717512996386       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+24 is 4.041233e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149870 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8696e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.7282
    reference variance = 1.85226
====================================================
  Execution time = 1.2653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5890e+00
  Total weights = 1.9456e+06
  Execution time = 2.2387e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619249290511
                                         uncertainty =       0.080902006643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619249290511
                                         uncertainty =       0.080902006643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144184989
  error estimate for blocks of size 2^( 2) =       0.001182356572
  error estimate for blocks of size 2^( 3) =       0.001214594894
  error estimate for blocks of size 2^( 4) =       0.001237627652
  error estimate for blocks of size 2^( 5) =       0.001251907701
  error estimate for blocks of size 2^( 6) =       0.001256709642
  error estimate for blocks of size 2^( 7) =       0.001260053056

      target function =                  N/A
              le_mean =     -16.716777055866
             les_mean =     282.039653729097
             stat err =       0.001251574513
             autocorr =       1.196522665378
              std dev =       1.618147818428
             le_variance =       2.618402362283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619249290511
                                         uncertainty =       0.080902006643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619249290511
                                         uncertainty =       0.080902006643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144184989
  error estimate for blocks of size 2^( 2) =       0.001182356572
  error estimate for blocks of size 2^( 3) =       0.001214594894
  error estimate for blocks of size 2^( 4) =       0.001237627652
  error estimate for blocks of size 2^( 5) =       0.001251907701
  error estimate for blocks of size 2^( 6) =       0.001256709642
  error estimate for blocks of size 2^( 7) =       0.001260053056

      target function =                  N/A
              le_mean =     -16.716777055866
             les_mean =     282.039653729097
             stat err =       0.001251574513
             autocorr =       1.196522665378
              std dev =       1.618147818428
             le_variance =       2.618402362283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619249290511
                                         uncertainty =       0.080902006643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619249290511
                                         uncertainty =       0.080902006643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144184989
  error estimate for blocks of size 2^( 2) =       0.001182356572
  error estimate for blocks of size 2^( 3) =       0.001214594894
  error estimate for blocks of size 2^( 4) =       0.001237627652
  error estimate for blocks of size 2^( 5) =       0.001251907701
  error estimate for blocks of size 2^( 6) =       0.001256709642
  error estimate for blocks of size 2^( 7) =       0.001260053056

      target function =                  N/A
              le_mean =     -16.716777055866
             les_mean =     282.039653729097
             stat err =       0.001251574513
             autocorr =       1.196522665378
              std dev =       1.618147818428
             le_variance =       2.618402362283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619249290511
                                         uncertainty =       0.080902006643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.619249290511
                                         uncertainty =       0.080902006643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144184989
  error estimate for blocks of size 2^( 2) =       0.001182356572
  error estimate for blocks of size 2^( 3) =       0.001214594894
  error estimate for blocks of size 2^( 4) =       0.001237627652
  error estimate for blocks of size 2^( 5) =       0.001251907701
  error estimate for blocks of size 2^( 6) =       0.001256709642
  error estimate for blocks of size 2^( 7) =       0.001260053056

      target function =                  N/A
              le_mean =     -16.716777055866
             les_mean =     282.039653729097
             stat err =       0.001251574513
             autocorr =       1.196522665378
              std dev =       1.618147818428
             le_variance =       2.618402362283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716777055866        initial  <--
     5.9605e+23     5.9605e+24             6.4660e-28       -16.716777055866
     2.3842e+24     2.3842e+25             1.6165e-28       -16.716777055866
     9.5367e+24     9.5367e+25             4.0412e-29       -16.716777055866

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9787
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2682e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6705e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8943
    reference variance = 1.26804
====================================================
  Execution time = 1.2977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0259e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.6397e+00
  Total weights = 1.946078070e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2209e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670958487048
                                         uncertainty =       0.097294607557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.670958487048
                                         uncertainty =       0.097294607557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001155630288
  error estimate for blocks of size 2^( 2) =       0.001193929215
  error estimate for blocks of size 2^( 3) =       0.001226440309
  error estimate for blocks of size 2^( 4) =       0.001250533390
  error estimate for blocks of size 2^( 5) =       0.001263950501
  error estimate for blocks of size 2^( 6) =       0.001268576733
  error estimate for blocks of size 2^( 7) =       0.001276457838

      target function =                  N/A
              le_mean =     -16.718609567478
             les_mean =     282.151632379256
             stat err =       0.001264879616
             autocorr =       1.198010310603
              std dev =       1.634334174997
             le_variance =       2.671048195564


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671860956748e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+24, overlap shift 5.9605e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718609566591       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718609566591       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718609566591       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+24 is 7.623907e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+25, overlap shift 2.3842e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718609566591       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718609566591       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718609566591       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+25 is 1.905977e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+25, overlap shift 9.5367e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718609566591       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718609566591       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.718609566591       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+25 is 4.764942e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151406 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6205e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.6773
    reference variance = 2.14184
====================================================
  Execution time = 1.2644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6717e+01
  VMC Evar = 2.5682e+00
  Total weights = 1.9454e+06
  Execution time = 2.2171e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.594279197499
                                         uncertainty =       0.058132603512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.594279197499
                                         uncertainty =       0.058132603512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138900433
  error estimate for blocks of size 2^( 2) =       0.001175874941
  error estimate for blocks of size 2^( 3) =       0.001207823833
  error estimate for blocks of size 2^( 4) =       0.001230143543
  error estimate for blocks of size 2^( 5) =       0.001246673800
  error estimate for blocks of size 2^( 6) =       0.001253105760
  error estimate for blocks of size 2^( 7) =       0.001257457084

      target function =                  N/A
              le_mean =     -16.717282201904
             les_mean =     282.035748966639
             stat err =       0.001246845047
             autocorr =       1.198542538696
              std dev =       1.610674208388
             le_variance =       2.594271405568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.594279197499
                                         uncertainty =       0.058132603512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.594279197499
                                         uncertainty =       0.058132603512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138900433
  error estimate for blocks of size 2^( 2) =       0.001175874941
  error estimate for blocks of size 2^( 3) =       0.001207823833
  error estimate for blocks of size 2^( 4) =       0.001230143543
  error estimate for blocks of size 2^( 5) =       0.001246673800
  error estimate for blocks of size 2^( 6) =       0.001253105760
  error estimate for blocks of size 2^( 7) =       0.001257457084

      target function =                  N/A
              le_mean =     -16.717282201904
             les_mean =     282.035748966639
             stat err =       0.001246845047
             autocorr =       1.198542538696
              std dev =       1.610674208388
             le_variance =       2.594271405568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.594279197499
                                         uncertainty =       0.058132603512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.594279197499
                                         uncertainty =       0.058132603512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138900433
  error estimate for blocks of size 2^( 2) =       0.001175874941
  error estimate for blocks of size 2^( 3) =       0.001207823833
  error estimate for blocks of size 2^( 4) =       0.001230143543
  error estimate for blocks of size 2^( 5) =       0.001246673800
  error estimate for blocks of size 2^( 6) =       0.001253105760
  error estimate for blocks of size 2^( 7) =       0.001257457084

      target function =                  N/A
              le_mean =     -16.717282201904
             les_mean =     282.035748966639
             stat err =       0.001246845047
             autocorr =       1.198542538696
              std dev =       1.610674208388
             le_variance =       2.594271405568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.594279197499
                                         uncertainty =       0.058132603512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.594279197499
                                         uncertainty =       0.058132603512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001138900433
  error estimate for blocks of size 2^( 2) =       0.001175874941
  error estimate for blocks of size 2^( 3) =       0.001207823833
  error estimate for blocks of size 2^( 4) =       0.001230143543
  error estimate for blocks of size 2^( 5) =       0.001246673800
  error estimate for blocks of size 2^( 6) =       0.001253105760
  error estimate for blocks of size 2^( 7) =       0.001257457084

      target function =                  N/A
              le_mean =     -16.717282201904
             les_mean =     282.035748966639
             stat err =       0.001246845047
             autocorr =       1.198542538696
              std dev =       1.610674208388
             le_variance =       2.594271405568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.717282201904        initial  <--
     5.9605e+24     5.9605e+25             7.6239e-29       -16.717282201904
     2.3842e+25     2.3842e+26             1.9060e-29       -16.717282201904
     9.5367e+25     9.5367e+26             4.7649e-30       -16.717282201904

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8738
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0085e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6707e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.869
    reference variance = 1.57832
====================================================
  Execution time = 1.2994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0267e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.5898e+00
  Total weights = 1.945611122e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2175e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.620424738479
                                         uncertainty =       0.059904250317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.620424738479
                                         uncertainty =       0.059904250317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001144593767
  error estimate for blocks of size 2^( 2) =       0.001182176024
  error estimate for blocks of size 2^( 3) =       0.001216135294
  error estimate for blocks of size 2^( 4) =       0.001239176612
  error estimate for blocks of size 2^( 5) =       0.001253152886
  error estimate for blocks of size 2^( 6) =       0.001263140284
  error estimate for blocks of size 2^( 7) =       0.001265745961

      target function =                  N/A
              le_mean =     -16.718782541921
             les_mean =     282.107538952874
             stat err =       0.001255303936
             autocorr =       1.202804455576
              std dev =       1.618725927074
             le_variance =       2.620273626981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671878254192e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+25, overlap shift 5.9605e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718782541014       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718782541014       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+26, overlap shift 2.3842e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718782541014       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718782541014       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+26, overlap shift 9.5367e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.718782541014       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.718782541014       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152597 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6218e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.7738
    reference variance = 2.37557
====================================================
  Execution time = 1.2632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6716e+01
  VMC Evar = 2.5491e+00
  Total weights = 1.9457e+06
  Execution time = 2.2258e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.575936335336
                                         uncertainty =       0.021899882827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.575936335336
                                         uncertainty =       0.021899882827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134820124
  error estimate for blocks of size 2^( 2) =       0.001173471999
  error estimate for blocks of size 2^( 3) =       0.001206250050
  error estimate for blocks of size 2^( 4) =       0.001229745497
  error estimate for blocks of size 2^( 5) =       0.001244545103
  error estimate for blocks of size 2^( 6) =       0.001245028590
  error estimate for blocks of size 2^( 7) =       0.001251938083

      target function =                  N/A
              le_mean =     -16.716245731351
             les_mean =     281.981984541660
             stat err =       0.001242814318
             autocorr =       1.199384518788
              std dev =       1.604903687945
             le_variance =       2.575715847579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.575936335336
                                         uncertainty =       0.021899882827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.575936335336
                                         uncertainty =       0.021899882827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134820124
  error estimate for blocks of size 2^( 2) =       0.001173471999
  error estimate for blocks of size 2^( 3) =       0.001206250050
  error estimate for blocks of size 2^( 4) =       0.001229745497
  error estimate for blocks of size 2^( 5) =       0.001244545103
  error estimate for blocks of size 2^( 6) =       0.001245028590
  error estimate for blocks of size 2^( 7) =       0.001251938083

      target function =                  N/A
              le_mean =     -16.716245731351
             les_mean =     281.981984541660
             stat err =       0.001242814318
             autocorr =       1.199384518788
              std dev =       1.604903687945
             le_variance =       2.575715847579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.575936335336
                                         uncertainty =       0.021899882827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.575936335336
                                         uncertainty =       0.021899882827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134820124
  error estimate for blocks of size 2^( 2) =       0.001173471999
  error estimate for blocks of size 2^( 3) =       0.001206250050
  error estimate for blocks of size 2^( 4) =       0.001229745497
  error estimate for blocks of size 2^( 5) =       0.001244545103
  error estimate for blocks of size 2^( 6) =       0.001245028590
  error estimate for blocks of size 2^( 7) =       0.001251938083

      target function =                  N/A
              le_mean =     -16.716245731351
             les_mean =     281.981984541660
             stat err =       0.001242814318
             autocorr =       1.199384518788
              std dev =       1.604903687945
             le_variance =       2.575715847579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.575936335336
                                         uncertainty =       0.021899882827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.575936335336
                                         uncertainty =       0.021899882827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001134820124
  error estimate for blocks of size 2^( 2) =       0.001173471999
  error estimate for blocks of size 2^( 3) =       0.001206250050
  error estimate for blocks of size 2^( 4) =       0.001229745497
  error estimate for blocks of size 2^( 5) =       0.001244545103
  error estimate for blocks of size 2^( 6) =       0.001245028590
  error estimate for blocks of size 2^( 7) =       0.001251938083

      target function =                  N/A
              le_mean =     -16.716245731351
             les_mean =     281.981984541660
             stat err =       0.001242814318
             autocorr =       1.199384518788
              std dev =       1.604903687945
             le_variance =       2.575715847579


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.716245731351        initial  <--
     5.9605e+25     5.9605e+26             0.0000e+00       -16.716245731351
     2.3842e+26     2.3842e+27             0.0000e+00       -16.716245731351
     9.5367e+26     9.5367e+27             0.0000e+00       -16.716245731351

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9112
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0135e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6709e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.4581
    reference variance = 4.16363
====================================================
  Execution time = 1.3021e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0289e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.6091e+00
  Total weights = 1.945690160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1832e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.636532664558
                                         uncertainty =       0.059592497330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.636532664558
                                         uncertainty =       0.059592497330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001148200211
  error estimate for blocks of size 2^( 2) =       0.001186777882
  error estimate for blocks of size 2^( 3) =       0.001220185183
  error estimate for blocks of size 2^( 4) =       0.001242853146
  error estimate for blocks of size 2^( 5) =       0.001259639289
  error estimate for blocks of size 2^( 6) =       0.001262755736
  error estimate for blocks of size 2^( 7) =       0.001270651930

      target function =                  N/A
              le_mean =     -16.719386610703
             les_mean =     282.147030829741
             stat err =       0.001258975025
             autocorr =       1.202261624544
              std dev =       1.623826291767
             le_variance =       2.636811825835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671938661070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+26, overlap shift 5.9605e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719386609781       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719386609781       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+27, overlap shift 2.3842e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719386609781       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719386609781       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+27, overlap shift 9.5367e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719386609781       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719386609781       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153756 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6211e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.744
    reference variance = 2.93173
====================================================
  Execution time = 1.2666e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6715e+01
  VMC Evar = 2.5326e+00
  Total weights = 1.9457e+06
  Execution time = 2.2373e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562565183382
                                         uncertainty =       0.024165972061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562565183382
                                         uncertainty =       0.024165972061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131887889
  error estimate for blocks of size 2^( 2) =       0.001170590637
  error estimate for blocks of size 2^( 3) =       0.001204919152
  error estimate for blocks of size 2^( 4) =       0.001229948117
  error estimate for blocks of size 2^( 5) =       0.001242692100
  error estimate for blocks of size 2^( 6) =       0.001250485532
  error estimate for blocks of size 2^( 7) =       0.001253859291

      target function =                  N/A
              le_mean =     -16.714878581254
             les_mean =     281.919802934819
             stat err =       0.001244246260
             autocorr =       1.208386491086
              std dev =       1.600756815472
             le_variance =       2.562422382279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562565183382
                                         uncertainty =       0.024165972061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562565183382
                                         uncertainty =       0.024165972061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131887889
  error estimate for blocks of size 2^( 2) =       0.001170590637
  error estimate for blocks of size 2^( 3) =       0.001204919152
  error estimate for blocks of size 2^( 4) =       0.001229948117
  error estimate for blocks of size 2^( 5) =       0.001242692100
  error estimate for blocks of size 2^( 6) =       0.001250485532
  error estimate for blocks of size 2^( 7) =       0.001253859291

      target function =                  N/A
              le_mean =     -16.714878581254
             les_mean =     281.919802934819
             stat err =       0.001244246260
             autocorr =       1.208386491086
              std dev =       1.600756815472
             le_variance =       2.562422382279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562565183382
                                         uncertainty =       0.024165972061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562565183382
                                         uncertainty =       0.024165972061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131887889
  error estimate for blocks of size 2^( 2) =       0.001170590637
  error estimate for blocks of size 2^( 3) =       0.001204919152
  error estimate for blocks of size 2^( 4) =       0.001229948117
  error estimate for blocks of size 2^( 5) =       0.001242692100
  error estimate for blocks of size 2^( 6) =       0.001250485532
  error estimate for blocks of size 2^( 7) =       0.001253859291

      target function =                  N/A
              le_mean =     -16.714878581254
             les_mean =     281.919802934819
             stat err =       0.001244246260
             autocorr =       1.208386491086
              std dev =       1.600756815472
             le_variance =       2.562422382279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562565183382
                                         uncertainty =       0.024165972061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.562565183382
                                         uncertainty =       0.024165972061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001131887889
  error estimate for blocks of size 2^( 2) =       0.001170590637
  error estimate for blocks of size 2^( 3) =       0.001204919152
  error estimate for blocks of size 2^( 4) =       0.001229948117
  error estimate for blocks of size 2^( 5) =       0.001242692100
  error estimate for blocks of size 2^( 6) =       0.001250485532
  error estimate for blocks of size 2^( 7) =       0.001253859291

      target function =                  N/A
              le_mean =     -16.714878581254
             les_mean =     281.919802934819
             stat err =       0.001244246260
             autocorr =       1.208386491086
              std dev =       1.600756815472
             le_variance =       2.562422382279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.714878581254        initial  <--
     5.9605e+26     5.9605e+27             0.0000e+00       -16.714878581254
     2.3842e+27     2.3842e+28             0.0000e+00       -16.714878581254
     9.5367e+27     9.5367e+28             0.0000e+00       -16.714878581254

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9902
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0208e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 167
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">2.0834e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">2.0834e+04</parameter>
<parameter name="steps" condition="int">167</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6707e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16456 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.6594
    reference variance = 2.94557
====================================================
  Execution time = 1.3022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 2.0271e+04
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4885e+00
  Total weights = 1.945662745e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.2093e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.513644189295
                                         uncertainty =       0.018671451418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.513644189295
                                         uncertainty =       0.018671451418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001121118243
  error estimate for blocks of size 2^( 2) =       0.001160696979
  error estimate for blocks of size 2^( 3) =       0.001194592523
  error estimate for blocks of size 2^( 4) =       0.001217713861
  error estimate for blocks of size 2^( 5) =       0.001230319015
  error estimate for blocks of size 2^( 6) =       0.001240207838
  error estimate for blocks of size 2^( 7) =       0.001241343123

      target function =                  N/A
              le_mean =     -16.719204790696
             les_mean =     282.020339439109
             stat err =       0.001232395959
             autocorr =       1.208363761519
              std dev =       1.585525991947
             le_variance =       2.513892671139


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.671920479070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+27, overlap shift 5.9605e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719204789780       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719204789780       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+28, overlap shift 2.3842e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719204789780       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719204789780       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+28, overlap shift 9.5367e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.719204789780       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.719204789780       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154955 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6237e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000064
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.7222
    reference variance = 2.63163
====================================================
  Execution time = 1.2655e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 20834 
  VMC Eavg = -1.6719e+01
  VMC Evar = 2.4960e+00
  Total weights = 1.9456e+06
  Execution time = 2.2273e+00
  </log>
</opt>
<opt stage="main" walkers="20834">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524005242982
                                         uncertainty =       0.030420132144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524005242982
                                         uncertainty =       0.030420132144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123572250
  error estimate for blocks of size 2^( 2) =       0.001162097279
  error estimate for blocks of size 2^( 3) =       0.001195474107
  error estimate for blocks of size 2^( 4) =       0.001217523075
  error estimate for blocks of size 2^( 5) =       0.001231738618
  error estimate for blocks of size 2^( 6) =       0.001241882754
  error estimate for blocks of size 2^( 7) =       0.001248892983

      target function =                  N/A
              le_mean =     -16.719220769647
             les_mean =     282.028352319788
             stat err =       0.001235009357
             autocorr =       1.208199043266
              std dev =       1.588996537524
             le_variance =       2.524909996264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524005242982
                                         uncertainty =       0.030420132144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524005242982
                                         uncertainty =       0.030420132144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123572250
  error estimate for blocks of size 2^( 2) =       0.001162097279
  error estimate for blocks of size 2^( 3) =       0.001195474107
  error estimate for blocks of size 2^( 4) =       0.001217523075
  error estimate for blocks of size 2^( 5) =       0.001231738618
  error estimate for blocks of size 2^( 6) =       0.001241882754
  error estimate for blocks of size 2^( 7) =       0.001248892983

      target function =                  N/A
              le_mean =     -16.719220769647
             les_mean =     282.028352319788
             stat err =       0.001235009357
             autocorr =       1.208199043266
              std dev =       1.588996537524
             le_variance =       2.524909996264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524005242982
                                         uncertainty =       0.030420132144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524005242982
                                         uncertainty =       0.030420132144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123572250
  error estimate for blocks of size 2^( 2) =       0.001162097279
  error estimate for blocks of size 2^( 3) =       0.001195474107
  error estimate for blocks of size 2^( 4) =       0.001217523075
  error estimate for blocks of size 2^( 5) =       0.001231738618
  error estimate for blocks of size 2^( 6) =       0.001241882754
  error estimate for blocks of size 2^( 7) =       0.001248892983

      target function =                  N/A
              le_mean =     -16.719220769647
             les_mean =     282.028352319788
             stat err =       0.001235009357
             autocorr =       1.208199043266
              std dev =       1.588996537524
             le_variance =       2.524909996264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524005242982
                                         uncertainty =       0.030420132144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.524005242982
                                         uncertainty =       0.030420132144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001123572250
  error estimate for blocks of size 2^( 2) =       0.001162097279
  error estimate for blocks of size 2^( 3) =       0.001195474107
  error estimate for blocks of size 2^( 4) =       0.001217523075
  error estimate for blocks of size 2^( 5) =       0.001231738618
  error estimate for blocks of size 2^( 6) =       0.001241882754
  error estimate for blocks of size 2^( 7) =       0.001248892983

      target function =                  N/A
              le_mean =     -16.719220769647
             les_mean =     282.028352319788
             stat err =       0.001235009357
             autocorr =       1.208199043266
              std dev =       1.588996537524
             le_variance =       2.524909996264


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.719220769647        initial  <--
     5.9605e+27     5.9605e+28             0.0000e+00       -16.719220769647
     2.3842e+28     2.3842e+29             0.0000e+00       -16.719220769647
     9.5367e+28     9.5367e+29             0.0000e+00       -16.719220769647

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9199
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.084085e-01 3 1  ON 0
ci_0002                 6.782564e-01 3 1  ON 1
ci_0003                -4.832390e-02 3 1  ON 2
ci_0004                -4.654925e-02 3 1  ON 3
ci_0005                -4.519386e-02 3 1  ON 4
ci_0006                -4.445520e-02 3 1  ON 5
ci_0007                -3.107126e-02 3 1  ON 6
ci_0008                -3.156863e-02 3 1  ON 7
ci_0009                -3.223214e-02 3 1  ON 8
ci_0010                -3.088085e-02 3 1  ON 9
ci_0011                -2.797504e-02 3 1  ON 10
ci_0012                -2.620382e-02 3 1  ON 11
ci_0013                 2.731769e-02 3 1  ON 12
ci_0014                 2.581364e-02 3 1  ON 13
ci_0015                 2.739690e-02 3 1  ON 14
ci_0016                 2.623885e-02 3 1  ON 15
ci_0017                 2.474494e-02 3 1  ON 16
ci_0018                 2.356878e-02 3 1  ON 17
ci_0019                 1.974968e-02 3 1  ON 18
ci_0020                 1.928553e-02 3 1  ON 19
ci_0021                 1.920535e-02 3 1  ON 20
ci_0022                 1.827982e-02 3 1  ON 21
ci_0023                -1.952958e-02 3 1  ON 22
ci_0024                -1.798070e-02 3 1  ON 23
ci_0025                -1.982064e-02 3 1  ON 24
ci_0026                -1.793423e-02 3 1  ON 25
ci_0027                -1.762460e-02 3 1  ON 26
ci_0028                -1.699007e-02 3 1  ON 27
ci_0029                -1.654639e-02 3 1  ON 28
ci_0030                -1.639843e-02 3 1  ON 29
ci_0031                 1.492147e-02 3 1  ON 30
ci_0032                 1.379408e-02 3 1  ON 31
ci_0033                 1.771931e-02 3 1  ON 32
ci_0034                 1.525211e-02 3 1  ON 33
ci_0035                 1.751147e-02 3 1  ON 34
ci_0036                 1.622187e-02 3 1  ON 35
ci_0037                -1.546341e-02 3 1  ON 36
ci_0038                -1.407602e-02 3 1  ON 37
ci_0039                -1.580541e-02 3 1  ON 38
ci_0040                -1.502745e-02 3 1  ON 39
ci_0041                 1.593032e-02 3 1  ON 40
ci_0042                 1.602361e-02 3 1  ON 41
ci_0043                -1.557502e-02 3 1  ON 42
ci_0044                -1.526796e-02 3 1  ON 43
ci_0045                 1.455672e-02 3 1  ON 44
ci_0046                 1.488580e-02 3 1  ON 45
ci_0047                -1.481015e-02 3 1  ON 46
ci_0048                -1.411512e-02 3 1  ON 47
ci_0049                -1.321608e-02 3 1  ON 48
ci_0050                -1.301611e-02 3 1  ON 49
ci_0051                -1.291484e-02 3 1  ON 50
ci_0052                -1.258151e-02 3 1  ON 51
ci_0053                -1.311573e-02 3 1  ON 52
ci_0054                -1.246498e-02 3 1  ON 53
ci_0055                 1.224371e-02 3 1  ON 54
ci_0056                 1.302318e-02 3 1  ON 55
ci_0057                 1.354072e-02 3 1  ON 56
ci_0058                 1.206560e-02 3 1  ON 57
ci_0059                -1.338015e-02 3 1  ON 58
ci_0060                -1.268578e-02 3 1  ON 59
ci_0061                -1.297256e-02 3 1  ON 60
ci_0062                -1.259285e-02 3 1  ON 61
ci_0063                -1.198195e-02 3 1  ON 62
ci_0064                -1.109462e-02 3 1  ON 63
ci_0065                -1.219935e-02 3 1  ON 64
ci_0066                -1.123656e-02 3 1  ON 65
ci_0067                -1.122091e-02 3 1  ON 66
ci_0068                -1.093085e-02 3 1  ON 67
ci_0069                 1.096112e-02 3 1  ON 68
ci_0070                 1.053121e-02 3 1  ON 69
ci_0071                 9.801412e-03 3 1  ON 70
ci_0072                 1.001083e-02 3 1  ON 71
ci_0073                 1.103237e-02 3 1  ON 72
ci_0074                 1.093387e-02 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0165e+01 secs
  Total Execution time = 2.4505e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
