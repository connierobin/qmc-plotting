Rank =    0  Free Memory = 87285 MB
Rank =    1  Free Memory = 87285 MB
Rank =    2  Free Memory = 87285 MB
Rank =    3  Free Memory = 87285 MB
Rank =    4  Free Memory = 87284 MB
Rank =    5  Free Memory = 87284 MB
Rank =    6  Free Memory = 87284 MB
Rank =    7  Free Memory = 87284 MB
Rank =    8  Free Memory = 87284 MB
Rank =    9  Free Memory = 87284 MB
Rank =   10  Free Memory = 87284 MB
Rank =   11  Free Memory = 87284 MB
Rank =   12  Free Memory = 87284 MB
Rank =   13  Free Memory = 87284 MB
Rank =   14  Free Memory = 87283 MB
Rank =   15  Free Memory = 87270 MB
Rank =   16  Free Memory = 87269 MB
Rank =   17  Free Memory = 87269 MB
Rank =   18  Free Memory = 87269 MB
Rank =   19  Free Memory = 87269 MB
Rank =   20  Free Memory = 87269 MB
Rank =   21  Free Memory = 87269 MB
Rank =   22  Free Memory = 87269 MB
Rank =   23  Free Memory = 87269 MB
Rank =   24  Free Memory = 87269 MB
Rank =   25  Free Memory = 87269 MB
Rank =   26  Free Memory = 87269 MB
Rank =   27  Free Memory = 87269 MB
Rank =   28  Free Memory = 87269 MB
Rank =   29  Free Memory = 87269 MB
Rank =   30  Free Memory = 87269 MB
Rank =   31  Free Memory = 87269 MB
Rank =   32  Free Memory = 86293 MB
Rank =   33  Free Memory = 86293 MB
Rank =   34  Free Memory = 86293 MB
Rank =   35  Free Memory = 86293 MB
Rank =   36  Free Memory = 86293 MB
Rank =   37  Free Memory = 86293 MB
Rank =   38  Free Memory = 86293 MB
Rank =   39  Free Memory = 86293 MB
Rank =   40  Free Memory = 86293 MB
Rank =   41  Free Memory = 86293 MB
Rank =   42  Free Memory = 86293 MB
Rank =   43  Free Memory = 86293 MB
Rank =   44  Free Memory = 86293 MB
Rank =   45  Free Memory = 86293 MB
Rank =   46  Free Memory = 86293 MB
Rank =   47  Free Memory = 86293 MB
Rank =   48  Free Memory = 86293 MB
Rank =   49  Free Memory = 86293 MB
Rank =   50  Free Memory = 86293 MB
Rank =   51  Free Memory = 86293 MB
Rank =   52  Free Memory = 86293 MB
Rank =   53  Free Memory = 86293 MB
Rank =   54  Free Memory = 86293 MB
Rank =   55  Free Memory = 86293 MB
Rank =   56  Free Memory = 86293 MB
Rank =   57  Free Memory = 86293 MB
Rank =   58  Free Memory = 86293 MB
Rank =   59  Free Memory = 86293 MB
Rank =   60  Free Memory = 86293 MB
Rank =   61  Free Memory = 86293 MB
Rank =   62  Free Memory = 86293 MB
Rank =   63  Free Memory = 86293 MB
Rank =   64  Free Memory = 90007 MB
Rank =   65  Free Memory = 90007 MB
Rank =   66  Free Memory = 90007 MB
Rank =   67  Free Memory = 90007 MB
Rank =   68  Free Memory = 90007 MB
Rank =   69  Free Memory = 90007 MB
Rank =   70  Free Memory = 90007 MB
Rank =   71  Free Memory = 90007 MB
Rank =   72  Free Memory = 90007 MB
Rank =   73  Free Memory = 90007 MB
Rank =   74  Free Memory = 90007 MB
Rank =   75  Free Memory = 90007 MB
Rank =   76  Free Memory = 90007 MB
Rank =   77  Free Memory = 90007 MB
Rank =   78  Free Memory = 90007 MB
Rank =   79  Free Memory = 90007 MB
Rank =   80  Free Memory = 90007 MB
Rank =   81  Free Memory = 90007 MB
Rank =   82  Free Memory = 90007 MB
Rank =   83  Free Memory = 90007 MB
Rank =   84  Free Memory = 90007 MB
Rank =   85  Free Memory = 90007 MB
Rank =   86  Free Memory = 90007 MB
Rank =   87  Free Memory = 90007 MB
Rank =   88  Free Memory = 90007 MB
Rank =   89  Free Memory = 90007 MB
Rank =   90  Free Memory = 90007 MB
Rank =   91  Free Memory = 90007 MB
Rank =   92  Free Memory = 90007 MB
Rank =   93  Free Memory = 90007 MB
Rank =   94  Free Memory = 90007 MB
Rank =   95  Free Memory = 90007 MB
Rank =   96  Free Memory = 90308 MB
Rank =   97  Free Memory = 90308 MB
Rank =   98  Free Memory = 90308 MB
Rank =   99  Free Memory = 90308 MB
Rank =  100  Free Memory = 90308 MB
Rank =  101  Free Memory = 90308 MB
Rank =  102  Free Memory = 90308 MB
Rank =  103  Free Memory = 90308 MB
Rank =  104  Free Memory = 90308 MB
Rank =  105  Free Memory = 90308 MB
Rank =  106  Free Memory = 90308 MB
Rank =  107  Free Memory = 90308 MB
Rank =  108  Free Memory = 90308 MB
Rank =  109  Free Memory = 90308 MB
Rank =  110  Free Memory = 90308 MB
Rank =  111  Free Memory = 90308 MB
Rank =  112  Free Memory = 90308 MB
Rank =  113  Free Memory = 90308 MB
Rank =  114  Free Memory = 90308 MB
Rank =  115  Free Memory = 90308 MB
Rank =  116  Free Memory = 90308 MB
Rank =  117  Free Memory = 90308 MB
Rank =  118  Free Memory = 90308 MB
Rank =  119  Free Memory = 90308 MB
Rank =  120  Free Memory = 90308 MB
Rank =  121  Free Memory = 90308 MB
Rank =  122  Free Memory = 90308 MB
Rank =  123  Free Memory = 90308 MB
Rank =  124  Free Memory = 90308 MB
Rank =  125  Free Memory = 90308 MB
Rank =  126  Free Memory = 90308 MB
Rank =  127  Free Memory = 90308 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001h.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001h.xml

  Project = H2O
  date    = 2023-04-01 12:58:19 PDT
  host    = n0052.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 219

  Range of prime numbers to use as seeds over processors and threads = 1381-2351


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.091636e-01    1         1  ON     0
     uu_1                 1.423625e-01    1         1  ON     1
     uu_2                 4.096902e-02    1         1  ON     2
     uu_3                -2.136688e-02    1         1  ON     3
     uu_4                -6.660708e-02    1         1  ON     4
     uu_5                -1.014585e-01    1         1  ON     5
     uu_6                -1.283832e-01    1         1  ON     6
     uu_7                -1.412810e-01    1         1  ON     7
     uu_8                -1.332560e-01    1         1  ON     8
     uu_9                -1.049622e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.474375e-01    1         1  ON     0
     ud_1                 1.822241e-01    1         1  ON     1
     ud_2                 6.293740e-02    1         1  ON     2
     ud_3                -7.380126e-03    1         1  ON     3
     ud_4                -6.473903e-02    1         1  ON     4
     ud_5                -1.068970e-01    1         1  ON     5
     ud_6                -1.349462e-01    1         1  ON     6
     ud_7                -1.520038e-01    1         1  ON     7
     ud_8                -1.529348e-01    1         1  ON     8
     ud_9                -1.433357e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.599107e-01    1         1  ON     0
     eO_1                -4.401072e-01    1         1  ON     1
     eO_2                -2.176480e-02    1         1  ON     2
     eO_3                 2.985382e-01    1         1  ON     3
     eO_4                 5.253718e-01    1         1  ON     4
     eO_5                 4.877361e-01    1         1  ON     5
     eO_6                 2.599353e-01    1         1  ON     6
     eO_7                -4.075096e-02    1         1  ON     7
     eO_8                -2.213059e-01    1         1  ON     8
     eO_9                -8.636124e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.442243e-01    1         1  ON     0
     eH1_1                -1.451572e-01    1         1  ON     1
     eH1_2                -9.867336e-02    1         1  ON     2
     eH1_3                -4.492682e-02    1         1  ON     3
     eH1_4                 3.212516e-03    1         1  ON     4
     eH1_5                 3.812680e-02    1         1  ON     5
     eH1_6                 9.664004e-02    1         1  ON     6
     eH1_7                 1.541409e-01    1         1  ON     7
     eH1_8                 1.770969e-01    1         1  ON     8
     eH1_9                 6.777768e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.418938e-01    1         1  ON     0
     eH2_1                -1.428385e-01    1         1  ON     1
     eH2_2                -9.657199e-02    1         1  ON     2
     eH2_3                -4.255339e-02    1         1  ON     3
     eH2_4                 5.489892e-03    1         1  ON     4
     eH2_5                 4.023517e-02    1         1  ON     5
     eH2_6                 9.950141e-02    1         1  ON     6
     eH2_7                 1.552637e-01    1         1  ON     7
     eH2_8                 1.826548e-01    1         1  ON     8
     eH2_9                 5.728746e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 5.386803e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 5.0910e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.7673
    reference variance = 0.269173
====================================================
  Execution time = 4.0583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3532e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0915e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335379338614
                                         uncertainty =       0.003596068289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335379338614
                                         uncertainty =       0.003596068289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409466066
  error estimate for blocks of size 2^( 2) =       0.000422255896
  error estimate for blocks of size 2^( 3) =       0.000435969400
  error estimate for blocks of size 2^( 4) =       0.000448269111
  error estimate for blocks of size 2^( 5) =       0.000458914978
  error estimate for blocks of size 2^( 6) =       0.000467187233
  error estimate for blocks of size 2^( 7) =       0.000471678421

      target function =                  N/A
              le_mean =     -16.906213338034
             les_mean =     286.155374182116
             stat err =       0.000461512436
             autocorr =       1.270372206480
              std dev =       0.579072464088
             le_variance =       0.335324918665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690621333803e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213338034       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906218877969       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906218943694       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906221848490       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223101364       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223443897       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223848070       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906224080637       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906224519251       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906224276006       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906224270205       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.451347e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213338034       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906215443594       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906215172593       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906215933976       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906216813146       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906216790803       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906216810776       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906216881038       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906216900767       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.141830e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213338034       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213943128       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906213844982       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906214016428       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906214278303       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906214297532       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906214286600       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906214300869       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.070215e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1626e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.092151e-01                 1 1 ON  0
uu_1  1.424738e-01                 1 1 ON  1
uu_2  4.101418e-02                 1 1 ON  2
uu_3  -2.139596e-02                1 1 ON  3
uu_4  -6.661702e-02                1 1 ON  4
uu_5  -1.014693e-01                1 1 ON  5
uu_6  -1.285476e-01                1 1 ON  6
uu_7  -1.415078e-01                1 1 ON  7
uu_8  -1.332888e-01                1 1 ON  8
uu_9  -1.049307e-01                1 1 ON  9
ud_0  4.476482e-01                 1 1 ON  10
ud_1  1.824016e-01                 1 1 ON  11
ud_2  6.279629e-02                 1 1 ON  12
ud_3  -7.570246e-03                1 1 ON  13
ud_4  -6.485131e-02                1 1 ON  14
ud_5  -1.068339e-01                1 1 ON  15
ud_6  -1.349813e-01                1 1 ON  16
ud_7  -1.520832e-01                1 1 ON  17
ud_8  -1.528776e-01                1 1 ON  18
ud_9  -1.432405e-01                1 1 ON  19
eO_0  -7.600690e-01                1 1 ON  20
eO_1  -4.399468e-01                1 1 ON  21
eO_2  -2.174038e-02                1 1 ON  22
eO_3  2.986231e-01                 1 1 ON  23
eO_4  5.253844e-01                 1 1 ON  24
eO_5  4.877648e-01                 1 1 ON  25
eO_6  2.599739e-01                 1 1 ON  26
eO_7  -4.072463e-02                1 1 ON  27
eO_8  -2.213813e-01                1 1 ON  28
eO_9  -8.647621e-02                1 1 ON  29
eH1_0 -2.446049e-01                1 1 ON  30
eH1_1 -1.452690e-01                1 1 ON  31
eH1_2 -9.864635e-02                1 1 ON  32
eH1_3 -4.488258e-02                1 1 ON  33
eH1_4 3.286792e-03                 1 1 ON  34
eH1_5 3.816219e-02                 1 1 ON  35
eH1_6 9.659470e-02                 1 1 ON  36
eH1_7 1.541160e-01                 1 1 ON  37
eH1_8 1.772439e-01                 1 1 ON  38
eH1_9 6.798561e-02                 1 1 ON  39
eH2_0 -2.423079e-01                1 1 ON  40
eH2_1 -1.429882e-01                1 1 ON  41
eH2_2 -9.653644e-02                1 1 ON  42
eH2_3 -4.250531e-02                1 1 ON  43
eH2_4 5.602936e-03                 1 1 ON  44
eH2_5 4.024832e-02                 1 1 ON  45
eH2_6 9.947931e-02                 1 1 ON  46
eH2_7 1.552244e-01                 1 1 ON  47
eH2_8 1.827507e-01                 1 1 ON  48
eH2_9 5.756310e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8462
    reference variance = 0.165282
====================================================
  Execution time = 3.9847e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3942e-01
  Total weights = 2.0000e+06
  Execution time = 3.7194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339290667533
                                         uncertainty =       0.003377777493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339290667533
                                         uncertainty =       0.003377777493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411836684
  error estimate for blocks of size 2^( 2) =       0.000424567905
  error estimate for blocks of size 2^( 3) =       0.000437641639
  error estimate for blocks of size 2^( 4) =       0.000449564773
  error estimate for blocks of size 2^( 5) =       0.000461833589
  error estimate for blocks of size 2^( 6) =       0.000470578521
  error estimate for blocks of size 2^( 7) =       0.000477046914

      target function =                  N/A
              le_mean =     -16.905588760747
             les_mean =     286.138150085925
             stat err =       0.000464755949
             autocorr =       1.273502667646
              std dev =       0.582425023526
             le_variance =       0.339218908029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339832759296
                                         uncertainty =       0.003380632794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339832759296
                                         uncertainty =       0.003380632794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412165753
  error estimate for blocks of size 2^( 2) =       0.000424866640
  error estimate for blocks of size 2^( 3) =       0.000437907784
  error estimate for blocks of size 2^( 4) =       0.000449812171
  error estimate for blocks of size 2^( 5) =       0.000462066537
  error estimate for blocks of size 2^( 6) =       0.000470822434
  error estimate for blocks of size 2^( 7) =       0.000477292991

      target function =                  N/A
              le_mean =     -16.905585769522
             les_mean =     286.138591256505
             stat err =       0.000464998533
             autocorr =       1.272797634452
              std dev =       0.582890397684
             le_variance =       0.339761215712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339696597174
                                         uncertainty =       0.003378969517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339696597174
                                         uncertainty =       0.003378969517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412083129
  error estimate for blocks of size 2^( 2) =       0.000424790476
  error estimate for blocks of size 2^( 3) =       0.000437838692
  error estimate for blocks of size 2^( 4) =       0.000449747209
  error estimate for blocks of size 2^( 5) =       0.000462005317
  error estimate for blocks of size 2^( 6) =       0.000470757710
  error estimate for blocks of size 2^( 7) =       0.000477230337

      target function =                  N/A
              le_mean =     -16.905585852399
             les_mean =     286.138457852905
             stat err =       0.000464935143
             autocorr =       1.272960949283
              std dev =       0.582773549401
             le_variance =       0.339625009881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339345444413
                                         uncertainty =       0.003377862529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339345444413
                                         uncertainty =       0.003377862529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411869949
  error estimate for blocks of size 2^( 2) =       0.000424597572
  error estimate for blocks of size 2^( 3) =       0.000437667474
  error estimate for blocks of size 2^( 4) =       0.000449588419
  error estimate for blocks of size 2^( 5) =       0.000461855708
  error estimate for blocks of size 2^( 6) =       0.000470601660
  error estimate for blocks of size 2^( 7) =       0.000477070856

      target function =                  N/A
              le_mean =     -16.905587978275
             les_mean =     286.138178431847
             stat err =       0.000464779161
             autocorr =       1.273424151240
              std dev =       0.582472068250
             le_variance =       0.339273710291


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905588760747        initial  <--
     2.5000e-01     2.5000e+00             1.4513e-03       -16.905585769522
     1.0000e+00     1.0000e+01             4.1418e-04       -16.905585852399
     4.0000e+00     4.0000e+01             1.0702e-04       -16.905587978275

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.5483
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1018e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9625
    reference variance = 0.207951
====================================================
  Execution time = 4.2871e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3630e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0567e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336247196957
                                         uncertainty =       0.003991164555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336247196957
                                         uncertainty =       0.003991164555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410062845
  error estimate for blocks of size 2^( 2) =       0.000422828883
  error estimate for blocks of size 2^( 3) =       0.000436464912
  error estimate for blocks of size 2^( 4) =       0.000448775105
  error estimate for blocks of size 2^( 5) =       0.000460194308
  error estimate for blocks of size 2^( 6) =       0.000467964462
  error estimate for blocks of size 2^( 7) =       0.000473304681

      target function =                  N/A
              le_mean =     -16.905936206727
             les_mean =     286.146981931890
             stat err =       0.000462559639
             autocorr =       1.272432137123
              std dev =       0.579916437179
             le_variance =       0.336303074111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593620673e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905936206727       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905937629757       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905938335050       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905938519171       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905938422898       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905938572123       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905938581443       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905938555187       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905938550398       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.965076e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905936206727       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905936582805       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905936770921       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905936829851       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905936803222       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905936839746       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905936842218       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905936836079       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905936835170       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.996495e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905936206727       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905936302109       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905936349941       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905936365608       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905936358883       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905936367998       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905936368569       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905936367088       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905936366870       residual = 1.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.254471e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124857 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3447e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.091651e-01 1 1  ON 0
 uu_1                 1.423601e-01 1 1  ON 1
 uu_2                 4.096779e-02 1 1  ON 2
 uu_3                -2.136981e-02 1 1  ON 3
 uu_4                -6.661372e-02 1 1  ON 4
 uu_5                -1.014558e-01 1 1  ON 5
 uu_6                -1.284078e-01 1 1  ON 6
 uu_7                -1.412842e-01 1 1  ON 7
 uu_8                -1.332475e-01 1 1  ON 8
 uu_9                -1.049554e-01 1 1  ON 9
 ud_0                 4.474503e-01 1 1  ON 10
 ud_1                 1.822477e-01 1 1  ON 11
 ud_2                 6.292776e-02 1 1  ON 12
 ud_3                -7.407107e-03 1 1  ON 13
 ud_4                -6.475322e-02 1 1  ON 14
 ud_5                -1.069053e-01 1 1  ON 15
 ud_6                -1.349536e-01 1 1  ON 16
 ud_7                -1.520053e-01 1 1  ON 17
 ud_8                -1.529225e-01 1 1  ON 18
 ud_9                -1.433187e-01 1 1  ON 19
 eO_0                -7.599288e-01 1 1  ON 20
 eO_1                -4.400903e-01 1 1  ON 21
 eO_2                -2.176208e-02 1 1  ON 22
 eO_3                 2.985524e-01 1 1  ON 23
 eO_4                 5.253654e-01 1 1  ON 24
 eO_5                 4.877387e-01 1 1  ON 25
 eO_6                 2.599283e-01 1 1  ON 26
 eO_7                -4.074787e-02 1 1  ON 27
 eO_8                -2.213058e-01 1 1  ON 28
 eO_9                -8.636805e-02 1 1  ON 29
eH1_0                -2.442742e-01 1 1  ON 30
eH1_1                -1.451770e-01 1 1  ON 31
eH1_2                -9.866245e-02 1 1  ON 32
eH1_3                -4.491641e-02 1 1  ON 33
eH1_4                 3.228271e-03 1 1  ON 34
eH1_5                 3.812898e-02 1 1  ON 35
eH1_6                 9.664289e-02 1 1  ON 36
eH1_7                 1.541384e-01 1 1  ON 37
eH1_8                 1.771060e-01 1 1  ON 38
eH1_9                 6.779708e-02 1 1  ON 39
eH2_0                -2.419260e-01 1 1  ON 40
eH2_1                -1.428585e-01 1 1  ON 41
eH2_2                -9.656583e-02 1 1  ON 42
eH2_3                -4.255679e-02 1 1  ON 43
eH2_4                 5.504130e-03 1 1  ON 44
eH2_5                 4.023214e-02 1 1  ON 45
eH2_6                 9.947987e-02 1 1  ON 46
eH2_7                 1.552624e-01 1 1  ON 47
eH2_8                 1.826768e-01 1 1  ON 48
eH2_9                 5.731942e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8797
    reference variance = 0.201433
====================================================
  Execution time = 4.0073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3849e-01
  Total weights = 2.0000e+06
  Execution time = 3.7352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338570681691
                                         uncertainty =       0.004130932258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338570681691
                                         uncertainty =       0.004130932258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411389314
  error estimate for blocks of size 2^( 2) =       0.000424622955
  error estimate for blocks of size 2^( 3) =       0.000437964329
  error estimate for blocks of size 2^( 4) =       0.000450428430
  error estimate for blocks of size 2^( 5) =       0.000460898182
  error estimate for blocks of size 2^( 6) =       0.000470083782
  error estimate for blocks of size 2^( 7) =       0.000475440260

      target function =                  N/A
              le_mean =     -16.905846806399
             les_mean =     286.146138408012
             stat err =       0.000464212663
             autocorr =       1.273291832229
              std dev =       0.581792347684
             le_variance =       0.338482335823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338597994290
                                         uncertainty =       0.004130693011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338597994290
                                         uncertainty =       0.004130693011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411405911
  error estimate for blocks of size 2^( 2) =       0.000424636222
  error estimate for blocks of size 2^( 3) =       0.000437973910
  error estimate for blocks of size 2^( 4) =       0.000450433970
  error estimate for blocks of size 2^( 5) =       0.000460902700
  error estimate for blocks of size 2^( 6) =       0.000470090379
  error estimate for blocks of size 2^( 7) =       0.000475448279

      target function =                  N/A
              le_mean =     -16.905846101533
             les_mean =     286.146141886195
             stat err =       0.000464218832
             autocorr =       1.273222940245
              std dev =       0.581815818556
             le_variance =       0.338509646722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338581883047
                                         uncertainty =       0.004130747423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338581883047
                                         uncertainty =       0.004130747423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411396122
  error estimate for blocks of size 2^( 2) =       0.000424628086
  error estimate for blocks of size 2^( 3) =       0.000437967554
  error estimate for blocks of size 2^( 4) =       0.000450429558
  error estimate for blocks of size 2^( 5) =       0.000460898845
  error estimate for blocks of size 2^( 6) =       0.000470085573
  error estimate for blocks of size 2^( 7) =       0.000475442816

      target function =                  N/A
              le_mean =     -16.905846408047
             les_mean =     286.146136141018
             stat err =       0.000464214198
             autocorr =       1.273258114407
              std dev =       0.581801974732
             le_variance =       0.338493537802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338571964279
                                         uncertainty =       0.004130906466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338571964279
                                         uncertainty =       0.004130906466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411390094
  error estimate for blocks of size 2^( 2) =       0.000424623524
  error estimate for blocks of size 2^( 3) =       0.000437964656
  error estimate for blocks of size 2^( 4) =       0.000450428493
  error estimate for blocks of size 2^( 5) =       0.000460898188
  error estimate for blocks of size 2^( 6) =       0.000470083932
  error estimate for blocks of size 2^( 7) =       0.000475440508

      target function =                  N/A
              le_mean =     -16.905846752353
             les_mean =     286.146137863353
             stat err =       0.000464212780
             autocorr =       1.273287647794
              std dev =       0.581793450074
             le_variance =       0.338483618549


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905846806399        initial  <--
     2.5000e+00     2.5000e+01             1.9651e-04       -16.905846101533
     1.0000e+01     1.0000e+02             4.9965e-05       -16.905846408047
     4.0000e+01     4.0000e+02             1.2545e-05       -16.905846752353

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.8434
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423625e-01 1 1  ON 1
 uu_2                 4.096902e-02 1 1  ON 2
 uu_3                -2.136688e-02 1 1  ON 3
 uu_4                -6.660708e-02 1 1  ON 4
 uu_5                -1.014585e-01 1 1  ON 5
 uu_6                -1.283832e-01 1 1  ON 6
 uu_7                -1.412810e-01 1 1  ON 7
 uu_8                -1.332560e-01 1 1  ON 8
 uu_9                -1.049622e-01 1 1  ON 9
 ud_0                 4.474375e-01 1 1  ON 10
 ud_1                 1.822241e-01 1 1  ON 11
 ud_2                 6.293740e-02 1 1  ON 12
 ud_3                -7.380126e-03 1 1  ON 13
 ud_4                -6.473903e-02 1 1  ON 14
 ud_5                -1.068970e-01 1 1  ON 15
 ud_6                -1.349462e-01 1 1  ON 16
 ud_7                -1.520038e-01 1 1  ON 17
 ud_8                -1.529348e-01 1 1  ON 18
 ud_9                -1.433357e-01 1 1  ON 19
 eO_0                -7.599107e-01 1 1  ON 20
 eO_1                -4.401072e-01 1 1  ON 21
 eO_2                -2.176480e-02 1 1  ON 22
 eO_3                 2.985382e-01 1 1  ON 23
 eO_4                 5.253718e-01 1 1  ON 24
 eO_5                 4.877361e-01 1 1  ON 25
 eO_6                 2.599353e-01 1 1  ON 26
 eO_7                -4.075096e-02 1 1  ON 27
 eO_8                -2.213059e-01 1 1  ON 28
 eO_9                -8.636124e-02 1 1  ON 29
eH1_0                -2.442243e-01 1 1  ON 30
eH1_1                -1.451572e-01 1 1  ON 31
eH1_2                -9.867336e-02 1 1  ON 32
eH1_3                -4.492682e-02 1 1  ON 33
eH1_4                 3.212516e-03 1 1  ON 34
eH1_5                 3.812680e-02 1 1  ON 35
eH1_6                 9.664004e-02 1 1  ON 36
eH1_7                 1.541409e-01 1 1  ON 37
eH1_8                 1.770969e-01 1 1  ON 38
eH1_9                 6.777768e-02 1 1  ON 39
eH2_0                -2.418938e-01 1 1  ON 40
eH2_1                -1.428385e-01 1 1  ON 41
eH2_2                -9.657199e-02 1 1  ON 42
eH2_3                -4.255339e-02 1 1  ON 43
eH2_4                 5.489892e-03 1 1  ON 44
eH2_5                 4.023517e-02 1 1  ON 45
eH2_6                 9.950141e-02 1 1  ON 46
eH2_7                 1.552637e-01 1 1  ON 47
eH2_8                 1.826548e-01 1 1  ON 48
eH2_9                 5.728746e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1230e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6864e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8708
    reference variance = 0.316202
====================================================
  Execution time = 3.9975e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3195e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0575e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331986236644
                                         uncertainty =       0.002716537939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331986236644
                                         uncertainty =       0.002716537939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407397961
  error estimate for blocks of size 2^( 2) =       0.000420613412
  error estimate for blocks of size 2^( 3) =       0.000433597573
  error estimate for blocks of size 2^( 4) =       0.000445566494
  error estimate for blocks of size 2^( 5) =       0.000456046637
  error estimate for blocks of size 2^( 6) =       0.000461918306
  error estimate for blocks of size 2^( 7) =       0.000468103948

      target function =                  N/A
              le_mean =     -16.906439708951
             les_mean =     286.159649663706
             stat err =       0.000457908846
             autocorr =       1.263340344810
              std dev =       0.576147721758
             le_variance =       0.331946197287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690643970895e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906439708951       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906439755222       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906439776310       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906439781962       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906439793166       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906439796346       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906439803762       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906439801367       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906439801408       residual = 9.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.481296e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906439708951       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906439720586       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906439725860       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906439727340       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906439729975       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906439732478       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906439732814       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906439732162       residual = 9.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 3.699421e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906439708951       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906439711864       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906439713183       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906439713557       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906439714204       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906439714926       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906439714775       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906439714767       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906439714765       residual = 8.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 9.278260e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0557e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.091636e-01 1 1  ON 0
 uu_1                 1.423644e-01 1 1  ON 1
 uu_2                 4.096962e-02 1 1  ON 2
 uu_3                -2.136702e-02 1 1  ON 3
 uu_4                -6.660682e-02 1 1  ON 4
 uu_5                -1.014588e-01 1 1  ON 5
 uu_6                -1.283835e-01 1 1  ON 6
 uu_7                -1.412830e-01 1 1  ON 7
 uu_8                -1.332579e-01 1 1  ON 8
 uu_9                -1.049627e-01 1 1  ON 9
 ud_0                 4.474403e-01 1 1  ON 10
 ud_1                 1.822271e-01 1 1  ON 11
 ud_2                 6.293721e-02 1 1  ON 12
 ud_3                -7.381551e-03 1 1  ON 13
 ud_4                -6.473875e-02 1 1  ON 14
 ud_5                -1.068967e-01 1 1  ON 15
 ud_6                -1.349456e-01 1 1  ON 16
 ud_7                -1.520040e-01 1 1  ON 17
 ud_8                -1.529358e-01 1 1  ON 18
 ud_9                -1.433377e-01 1 1  ON 19
 eO_0                -7.599123e-01 1 1  ON 20
 eO_1                -4.401056e-01 1 1  ON 21
 eO_2                -2.176401e-02 1 1  ON 22
 eO_3                 2.985396e-01 1 1  ON 23
 eO_4                 5.253723e-01 1 1  ON 24
 eO_5                 4.877360e-01 1 1  ON 25
 eO_6                 2.599355e-01 1 1  ON 26
 eO_7                -4.075029e-02 1 1  ON 27
 eO_8                -2.213074e-01 1 1  ON 28
 eO_9                -8.636290e-02 1 1  ON 29
eH1_0                -2.442276e-01 1 1  ON 30
eH1_1                -1.451587e-01 1 1  ON 31
eH1_2                -9.867303e-02 1 1  ON 32
eH1_3                -4.492567e-02 1 1  ON 33
eH1_4                 3.213526e-03 1 1  ON 34
eH1_5                 3.812712e-02 1 1  ON 35
eH1_6                 9.663959e-02 1 1  ON 36
eH1_7                 1.541399e-01 1 1  ON 37
eH1_8                 1.770981e-01 1 1  ON 38
eH1_9                 6.777975e-02 1 1  ON 39
eH2_0                -2.418975e-01 1 1  ON 40
eH2_1                -1.428393e-01 1 1  ON 41
eH2_2                -9.657075e-02 1 1  ON 42
eH2_3                -4.255235e-02 1 1  ON 43
eH2_4                 5.490893e-03 1 1  ON 44
eH2_5                 4.023506e-02 1 1  ON 45
eH2_6                 9.950100e-02 1 1  ON 46
eH2_7                 1.552633e-01 1 1  ON 47
eH2_8                 1.826554e-01 1 1  ON 48
eH2_9                 5.728902e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8823
    reference variance = 0.201373
====================================================
  Execution time = 3.8784e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4150e-01
  Total weights = 2.0000e+06
  Execution time = 3.6640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341568700568
                                         uncertainty =       0.005471059062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341568700568
                                         uncertainty =       0.005471059062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413220248
  error estimate for blocks of size 2^( 2) =       0.000425613057
  error estimate for blocks of size 2^( 3) =       0.000438034146
  error estimate for blocks of size 2^( 4) =       0.000449884627
  error estimate for blocks of size 2^( 5) =       0.000459920974
  error estimate for blocks of size 2^( 6) =       0.000468918300
  error estimate for blocks of size 2^( 7) =       0.000475380277

      target function =                  N/A
              le_mean =     -16.906246160123
             les_mean =     286.162661002288
             stat err =       0.000463526044
             autocorr =       1.258302602395
              std dev =       0.584381678684
             le_variance =       0.341501946381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341574729780
                                         uncertainty =       0.005471012185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341574729780
                                         uncertainty =       0.005471012185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413223894
  error estimate for blocks of size 2^( 2) =       0.000425616123
  error estimate for blocks of size 2^( 3) =       0.000438036532
  error estimate for blocks of size 2^( 4) =       0.000449886659
  error estimate for blocks of size 2^( 5) =       0.000459922669
  error estimate for blocks of size 2^( 6) =       0.000468919742
  error estimate for blocks of size 2^( 7) =       0.000475381417

      target function =                  N/A
              le_mean =     -16.906246371314
             les_mean =     286.162674170318
             stat err =       0.000463527622
             autocorr =       1.258288958973
              std dev =       0.584386835507
             le_variance =       0.341507973514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341571515463
                                         uncertainty =       0.005471033097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341571515463
                                         uncertainty =       0.005471033097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413221950
  error estimate for blocks of size 2^( 2) =       0.000425614476
  error estimate for blocks of size 2^( 3) =       0.000438035230
  error estimate for blocks of size 2^( 4) =       0.000449885537
  error estimate for blocks of size 2^( 5) =       0.000459921719
  error estimate for blocks of size 2^( 6) =       0.000468918917
  error estimate for blocks of size 2^( 7) =       0.000475380748

      target function =                  N/A
              le_mean =     -16.906246266692
             les_mean =     286.162667419574
             stat err =       0.000463526730
             autocorr =       1.258295956910
              std dev =       0.584384086283
             le_variance =       0.341504760301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341569076363
                                         uncertainty =       0.005471055987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341569076363
                                         uncertainty =       0.005471055987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413220475
  error estimate for blocks of size 2^( 2) =       0.000425613248
  error estimate for blocks of size 2^( 3) =       0.000438034294
  error estimate for blocks of size 2^( 4) =       0.000449884753
  error estimate for blocks of size 2^( 5) =       0.000459921078
  error estimate for blocks of size 2^( 6) =       0.000468918388
  error estimate for blocks of size 2^( 7) =       0.000475380346

      target function =                  N/A
              le_mean =     -16.906246173443
             les_mean =     286.162661828362
             stat err =       0.000463526141
             autocorr =       1.258301743810
              std dev =       0.584382000104
             le_variance =       0.341502322045


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906246160123        initial
     2.5000e+01     2.5000e+02             1.4813e-05       -16.906246371314  <--
     1.0000e+02     1.0000e+03             3.6994e-06       -16.906246266692
     4.0000e+02     4.0000e+03             9.2783e-07       -16.906246173443

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 5.7250e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.091639e-01 1 1  ON 0
 uu_1                 1.423698e-01 1 1  ON 1
 uu_2                 4.097122e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660619e-02 1 1  ON 4
 uu_5                -1.014598e-01 1 1  ON 5
 uu_6                -1.283844e-01 1 1  ON 6
 uu_7                -1.412890e-01 1 1  ON 7
 uu_8                -1.332635e-01 1 1  ON 8
 uu_9                -1.049640e-01 1 1  ON 9
 ud_0                 4.474488e-01 1 1  ON 10
 ud_1                 1.822362e-01 1 1  ON 11
 ud_2                 6.293641e-02 1 1  ON 12
 ud_3                -7.385484e-03 1 1  ON 13
 ud_4                -6.473817e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520048e-01 1 1  ON 17
 ud_8                -1.529386e-01 1 1  ON 18
 ud_9                -1.433437e-01 1 1  ON 19
 eO_0                -7.599169e-01 1 1  ON 20
 eO_1                -4.401011e-01 1 1  ON 21
 eO_2                -2.176175e-02 1 1  ON 22
 eO_3                 2.985440e-01 1 1  ON 23
 eO_4                 5.253742e-01 1 1  ON 24
 eO_5                 4.877357e-01 1 1  ON 25
 eO_6                 2.599361e-01 1 1  ON 26
 eO_7                -4.074804e-02 1 1  ON 27
 eO_8                -2.213119e-01 1 1  ON 28
 eO_9                -8.636817e-02 1 1  ON 29
eH1_0                -2.442377e-01 1 1  ON 30
eH1_1                -1.451630e-01 1 1  ON 31
eH1_2                -9.867233e-02 1 1  ON 32
eH1_3                -4.492219e-02 1 1  ON 33
eH1_4                 3.216155e-03 1 1  ON 34
eH1_5                 3.812792e-02 1 1  ON 35
eH1_6                 9.663831e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771018e-01 1 1  ON 38
eH1_9                 6.778635e-02 1 1  ON 39
eH2_0                -2.419086e-01 1 1  ON 40
eH2_1                -1.428416e-01 1 1  ON 41
eH2_2                -9.656730e-02 1 1  ON 42
eH2_3                -4.254900e-02 1 1  ON 43
eH2_4                 5.493461e-03 1 1  ON 44
eH2_5                 4.023461e-02 1 1  ON 45
eH2_6                 9.949990e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826576e-01 1 1  ON 48
eH2_9                 5.729402e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0781e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6868e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8775
    reference variance = 0.225156
====================================================
  Execution time = 3.9582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4212e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0787e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342107903987
                                         uncertainty =       0.003887116605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342107903987
                                         uncertainty =       0.003887116605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413594887
  error estimate for blocks of size 2^( 2) =       0.000426139108
  error estimate for blocks of size 2^( 3) =       0.000439061347
  error estimate for blocks of size 2^( 4) =       0.000451566210
  error estimate for blocks of size 2^( 5) =       0.000461778403
  error estimate for blocks of size 2^( 6) =       0.000470292192
  error estimate for blocks of size 2^( 7) =       0.000477669845

      target function =                  N/A
              le_mean =     -16.906420698936
             les_mean =     286.169182139011
             stat err =       0.000465326663
             autocorr =       1.265801346998
              std dev =       0.584911498143
             le_variance =       0.342121460659


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690642069894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906420698936       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906420801823       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906420993153       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421084114       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906421102998       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906421129249       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906421125453       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906421104638       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906421107754       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 6.978903e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906420698936       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906420725255       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906420774144       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906420798976       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906420803429       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906420810820       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906420810064       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906420804975       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.735228e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906420698936       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906420705554       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906420717845       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906420724190       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906420725301       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906420727196       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906420727024       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906420725760       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 4.348081e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0377e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.091623e-01 1 1  ON 0
 uu_1                 1.423713e-01 1 1  ON 1
 uu_2                 4.097501e-02 1 1  ON 2
 uu_3                -2.136780e-02 1 1  ON 3
 uu_4                -6.660391e-02 1 1  ON 4
 uu_5                -1.014533e-01 1 1  ON 5
 uu_6                -1.283864e-01 1 1  ON 6
 uu_7                -1.412915e-01 1 1  ON 7
 uu_8                -1.332690e-01 1 1  ON 8
 uu_9                -1.049688e-01 1 1  ON 9
 ud_0                 4.474530e-01 1 1  ON 10
 ud_1                 1.822512e-01 1 1  ON 11
 ud_2                 6.293402e-02 1 1  ON 12
 ud_3                -7.388191e-03 1 1  ON 13
 ud_4                -6.474122e-02 1 1  ON 14
 ud_5                -1.068985e-01 1 1  ON 15
 ud_6                -1.349405e-01 1 1  ON 16
 ud_7                -1.520076e-01 1 1  ON 17
 ud_8                -1.529437e-01 1 1  ON 18
 ud_9                -1.433461e-01 1 1  ON 19
 eO_0                -7.599199e-01 1 1  ON 20
 eO_1                -4.400933e-01 1 1  ON 21
 eO_2                -2.176395e-02 1 1  ON 22
 eO_3                 2.985505e-01 1 1  ON 23
 eO_4                 5.253746e-01 1 1  ON 24
 eO_5                 4.877343e-01 1 1  ON 25
 eO_6                 2.599389e-01 1 1  ON 26
 eO_7                -4.074891e-02 1 1  ON 27
 eO_8                -2.213169e-01 1 1  ON 28
 eO_9                -8.637237e-02 1 1  ON 29
eH1_0                -2.442518e-01 1 1  ON 30
eH1_1                -1.451704e-01 1 1  ON 31
eH1_2                -9.866470e-02 1 1  ON 32
eH1_3                -4.491697e-02 1 1  ON 33
eH1_4                 3.222969e-03 1 1  ON 34
eH1_5                 3.812413e-02 1 1  ON 35
eH1_6                 9.663401e-02 1 1  ON 36
eH1_7                 1.541361e-01 1 1  ON 37
eH1_8                 1.771069e-01 1 1  ON 38
eH1_9                 6.779219e-02 1 1  ON 39
eH2_0                -2.419259e-01 1 1  ON 40
eH2_1                -1.428451e-01 1 1  ON 41
eH2_2                -9.656431e-02 1 1  ON 42
eH2_3                -4.254667e-02 1 1  ON 43
eH2_4                 5.497926e-03 1 1  ON 44
eH2_5                 4.023590e-02 1 1  ON 45
eH2_6                 9.949580e-02 1 1  ON 46
eH2_7                 1.552631e-01 1 1  ON 47
eH2_8                 1.826613e-01 1 1  ON 48
eH2_9                 5.730127e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.939
    reference variance = 0.353468
====================================================
  Execution time = 4.0179e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3589e-01
  Total weights = 2.0000e+06
  Execution time = 3.6750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335877368233
                                         uncertainty =       0.003742551633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335877368233
                                         uncertainty =       0.003742551633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409812442
  error estimate for blocks of size 2^( 2) =       0.000422638875
  error estimate for blocks of size 2^( 3) =       0.000435570172
  error estimate for blocks of size 2^( 4) =       0.000447282310
  error estimate for blocks of size 2^( 5) =       0.000458149341
  error estimate for blocks of size 2^( 6) =       0.000466064040
  error estimate for blocks of size 2^( 7) =       0.000471319460

      target function =                  N/A
              le_mean =     -16.906560545589
             les_mean =     286.167681789099
             stat err =       0.000460703788
             autocorr =       1.263785263905
              std dev =       0.579562313629
             le_variance =       0.335892475379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335868580248
                                         uncertainty =       0.003742359029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335868580248
                                         uncertainty =       0.003742359029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409807103
  error estimate for blocks of size 2^( 2) =       0.000422632444
  error estimate for blocks of size 2^( 3) =       0.000435562005
  error estimate for blocks of size 2^( 4) =       0.000447273297
  error estimate for blocks of size 2^( 5) =       0.000458140665
  error estimate for blocks of size 2^( 6) =       0.000466055143
  error estimate for blocks of size 2^( 7) =       0.000471309506

      target function =                  N/A
              le_mean =     -16.906560235289
             les_mean =     286.167662545082
             stat err =       0.000460694653
             autocorr =       1.263768072441
              std dev =       0.579554763204
             le_variance =       0.335883723553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335871305469
                                         uncertainty =       0.003742438822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335871305469
                                         uncertainty =       0.003742438822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409808756
  error estimate for blocks of size 2^( 2) =       0.000422634671
  error estimate for blocks of size 2^( 3) =       0.000435565111
  error estimate for blocks of size 2^( 4) =       0.000447276829
  error estimate for blocks of size 2^( 5) =       0.000458144049
  error estimate for blocks of size 2^( 6) =       0.000466058648
  error estimate for blocks of size 2^( 7) =       0.000471313526

      target function =                  N/A
              le_mean =     -16.906560375914
             les_mean =     286.167670008985
             stat err =       0.000460698263
             autocorr =       1.263777687972
              std dev =       0.579557100297
             le_variance =       0.335886432504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335876576463
                                         uncertainty =       0.003742537090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335876576463
                                         uncertainty =       0.003742537090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409811961
  error estimate for blocks of size 2^( 2) =       0.000422638328
  error estimate for blocks of size 2^( 3) =       0.000435569518
  error estimate for blocks of size 2^( 4) =       0.000447281603
  error estimate for blocks of size 2^( 5) =       0.000458148658
  error estimate for blocks of size 2^( 6) =       0.000466063344
  error estimate for blocks of size 2^( 7) =       0.000471318694

      target function =                  N/A
              le_mean =     -16.906560523423
             les_mean =     286.167680250349
             stat err =       0.000460703075
             autocorr =       1.263784320377
              std dev =       0.579561632720
             le_variance =       0.335891686122


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906560545589        initial  <--
     6.2500e+00     6.2500e+01             6.9789e-05       -16.906560235289
     2.5000e+01     2.5000e+02             1.7352e-05       -16.906560375914
     1.0000e+02     1.0000e+03             4.3481e-06       -16.906560523423

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.6772
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.091639e-01 1 1  ON 0
 uu_1                 1.423698e-01 1 1  ON 1
 uu_2                 4.097122e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660619e-02 1 1  ON 4
 uu_5                -1.014598e-01 1 1  ON 5
 uu_6                -1.283844e-01 1 1  ON 6
 uu_7                -1.412890e-01 1 1  ON 7
 uu_8                -1.332635e-01 1 1  ON 8
 uu_9                -1.049640e-01 1 1  ON 9
 ud_0                 4.474488e-01 1 1  ON 10
 ud_1                 1.822362e-01 1 1  ON 11
 ud_2                 6.293641e-02 1 1  ON 12
 ud_3                -7.385484e-03 1 1  ON 13
 ud_4                -6.473817e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520048e-01 1 1  ON 17
 ud_8                -1.529386e-01 1 1  ON 18
 ud_9                -1.433437e-01 1 1  ON 19
 eO_0                -7.599169e-01 1 1  ON 20
 eO_1                -4.401011e-01 1 1  ON 21
 eO_2                -2.176175e-02 1 1  ON 22
 eO_3                 2.985440e-01 1 1  ON 23
 eO_4                 5.253742e-01 1 1  ON 24
 eO_5                 4.877357e-01 1 1  ON 25
 eO_6                 2.599361e-01 1 1  ON 26
 eO_7                -4.074804e-02 1 1  ON 27
 eO_8                -2.213119e-01 1 1  ON 28
 eO_9                -8.636817e-02 1 1  ON 29
eH1_0                -2.442377e-01 1 1  ON 30
eH1_1                -1.451630e-01 1 1  ON 31
eH1_2                -9.867233e-02 1 1  ON 32
eH1_3                -4.492219e-02 1 1  ON 33
eH1_4                 3.216155e-03 1 1  ON 34
eH1_5                 3.812792e-02 1 1  ON 35
eH1_6                 9.663831e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771018e-01 1 1  ON 38
eH1_9                 6.778635e-02 1 1  ON 39
eH2_0                -2.419086e-01 1 1  ON 40
eH2_1                -1.428416e-01 1 1  ON 41
eH2_2                -9.656730e-02 1 1  ON 42
eH2_3                -4.254900e-02 1 1  ON 43
eH2_4                 5.493461e-03 1 1  ON 44
eH2_5                 4.023461e-02 1 1  ON 45
eH2_6                 9.949990e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826576e-01 1 1  ON 48
eH2_9                 5.729402e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0906e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6878e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8829
    reference variance = 0.495772
====================================================
  Execution time = 4.1318e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5192e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0700e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352011876088
                                         uncertainty =       0.013697815272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352011876088
                                         uncertainty =       0.013697815272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419477123
  error estimate for blocks of size 2^( 2) =       0.000432377119
  error estimate for blocks of size 2^( 3) =       0.000445380992
  error estimate for blocks of size 2^( 4) =       0.000458397924
  error estimate for blocks of size 2^( 5) =       0.000469404100
  error estimate for blocks of size 2^( 6) =       0.000478695901
  error estimate for blocks of size 2^( 7) =       0.000484950142

      target function =                  N/A
              le_mean =     -16.906160988584
             les_mean =     286.170201308840
             stat err =       0.000472862017
             autocorr =       1.270727121607
              std dev =       0.593230235988
             le_variance =       0.351922112891


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616098858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906160988584       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906160995282       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906161007365       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906161027427       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906161045210       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906161035053       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906161040085       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906161039672       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906161038781       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 6.737371e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906160988584       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906160990262       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906160993272       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906160998299       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906161002793       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906161000250       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906161001500       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906161001395       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.673349e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906160988584       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906160989004       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906160989755       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906160991013       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906160992139       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906160991504       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906160991816       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906160991789       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 4.184062e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133562 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2026e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.091635e-01 1 1  ON 0
 uu_1                 1.423706e-01 1 1  ON 1
 uu_2                 4.097095e-02 1 1  ON 2
 uu_3                -2.136710e-02 1 1  ON 3
 uu_4                -6.660657e-02 1 1  ON 4
 uu_5                -1.014594e-01 1 1  ON 5
 uu_6                -1.283843e-01 1 1  ON 6
 uu_7                -1.412896e-01 1 1  ON 7
 uu_8                -1.332638e-01 1 1  ON 8
 uu_9                -1.049641e-01 1 1  ON 9
 ud_0                 4.474497e-01 1 1  ON 10
 ud_1                 1.822370e-01 1 1  ON 11
 ud_2                 6.293644e-02 1 1  ON 12
 ud_3                -7.386362e-03 1 1  ON 13
 ud_4                -6.473859e-02 1 1  ON 14
 ud_5                -1.068959e-01 1 1  ON 15
 ud_6                -1.349445e-01 1 1  ON 16
 ud_7                -1.520050e-01 1 1  ON 17
 ud_8                -1.529384e-01 1 1  ON 18
 ud_9                -1.433436e-01 1 1  ON 19
 eO_0                -7.599176e-01 1 1  ON 20
 eO_1                -4.401006e-01 1 1  ON 21
 eO_2                -2.176162e-02 1 1  ON 22
 eO_3                 2.985445e-01 1 1  ON 23
 eO_4                 5.253745e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599359e-01 1 1  ON 26
 eO_7                -4.074780e-02 1 1  ON 27
 eO_8                -2.213120e-01 1 1  ON 28
 eO_9                -8.636863e-02 1 1  ON 29
eH1_0                -2.442388e-01 1 1  ON 30
eH1_1                -1.451639e-01 1 1  ON 31
eH1_2                -9.867237e-02 1 1  ON 32
eH1_3                -4.492196e-02 1 1  ON 33
eH1_4                 3.216758e-03 1 1  ON 34
eH1_5                 3.812779e-02 1 1  ON 35
eH1_6                 9.663828e-02 1 1  ON 36
eH1_7                 1.541371e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778707e-02 1 1  ON 39
eH2_0                -2.419103e-01 1 1  ON 40
eH2_1                -1.428427e-01 1 1  ON 41
eH2_2                -9.656684e-02 1 1  ON 42
eH2_3                -4.254853e-02 1 1  ON 43
eH2_4                 5.493916e-03 1 1  ON 44
eH2_5                 4.023474e-02 1 1  ON 45
eH2_6                 9.949994e-02 1 1  ON 46
eH2_7                 1.552620e-01 1 1  ON 47
eH2_8                 1.826581e-01 1 1  ON 48
eH2_9                 5.729480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9548
    reference variance = 0.250742
====================================================
  Execution time = 3.9371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3552e-01
  Total weights = 2.0000e+06
  Execution time = 3.6591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335529516496
                                         uncertainty =       0.003530709638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335529516496
                                         uncertainty =       0.003530709638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409586169
  error estimate for blocks of size 2^( 2) =       0.000422531028
  error estimate for blocks of size 2^( 3) =       0.000435451086
  error estimate for blocks of size 2^( 4) =       0.000448033840
  error estimate for blocks of size 2^( 5) =       0.000459417252
  error estimate for blocks of size 2^( 6) =       0.000468634565
  error estimate for blocks of size 2^( 7) =       0.000473578529

      target function =                  N/A
              le_mean =     -16.905592324363
             les_mean =     286.134573329448
             stat err =       0.000462416046
             autocorr =       1.274603852880
              std dev =       0.579242315134
             le_variance =       0.335521659642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335531451333
                                         uncertainty =       0.003530731425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335531451333
                                         uncertainty =       0.003530731425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409587349
  error estimate for blocks of size 2^( 2) =       0.000422531988
  error estimate for blocks of size 2^( 3) =       0.000435451844
  error estimate for blocks of size 2^( 4) =       0.000448034461
  error estimate for blocks of size 2^( 5) =       0.000459417914
  error estimate for blocks of size 2^( 6) =       0.000468635244
  error estimate for blocks of size 2^( 7) =       0.000473579095

      target function =                  N/A
              le_mean =     -16.905592310698
             les_mean =     286.134574801077
             stat err =       0.000462416678
             autocorr =       1.274599991162
              std dev =       0.579243984262
             le_variance =       0.335523593304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335530420374
                                         uncertainty =       0.003530720447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335530420374
                                         uncertainty =       0.003530720447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409586720
  error estimate for blocks of size 2^( 2) =       0.000422531472
  error estimate for blocks of size 2^( 3) =       0.000435451431
  error estimate for blocks of size 2^( 4) =       0.000448034118
  error estimate for blocks of size 2^( 5) =       0.000459417552
  error estimate for blocks of size 2^( 6) =       0.000468634874
  error estimate for blocks of size 2^( 7) =       0.000473578783

      target function =                  N/A
              le_mean =     -16.905592317568
             les_mean =     286.134574003014
             stat err =       0.000462416332
             autocorr =       1.274601993814
              std dev =       0.579243094869
             le_variance =       0.335522562953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335529629452
                                         uncertainty =       0.003530710989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335529629452
                                         uncertainty =       0.003530710989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409586238
  error estimate for blocks of size 2^( 2) =       0.000422531084
  error estimate for blocks of size 2^( 3) =       0.000435451129
  error estimate for blocks of size 2^( 4) =       0.000448033875
  error estimate for blocks of size 2^( 5) =       0.000459417289
  error estimate for blocks of size 2^( 6) =       0.000468634604
  error estimate for blocks of size 2^( 7) =       0.000473578560

      target function =                  N/A
              le_mean =     -16.905592323509
             les_mean =     286.134573413465
             stat err =       0.000462416082
             autocorr =       1.274603620398
              std dev =       0.579242412576
             le_variance =       0.335521772527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905592324363        initial  <--
     6.2500e+01     6.2500e+02             6.7374e-06       -16.905592310698
     2.5000e+02     2.5000e+03             1.6733e-06       -16.905592317568
     1.0000e+03     1.0000e+04             4.1841e-07       -16.905592323509

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.8527
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.091639e-01 1 1  ON 0
 uu_1                 1.423698e-01 1 1  ON 1
 uu_2                 4.097122e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660619e-02 1 1  ON 4
 uu_5                -1.014598e-01 1 1  ON 5
 uu_6                -1.283844e-01 1 1  ON 6
 uu_7                -1.412890e-01 1 1  ON 7
 uu_8                -1.332635e-01 1 1  ON 8
 uu_9                -1.049640e-01 1 1  ON 9
 ud_0                 4.474488e-01 1 1  ON 10
 ud_1                 1.822362e-01 1 1  ON 11
 ud_2                 6.293641e-02 1 1  ON 12
 ud_3                -7.385484e-03 1 1  ON 13
 ud_4                -6.473817e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520048e-01 1 1  ON 17
 ud_8                -1.529386e-01 1 1  ON 18
 ud_9                -1.433437e-01 1 1  ON 19
 eO_0                -7.599169e-01 1 1  ON 20
 eO_1                -4.401011e-01 1 1  ON 21
 eO_2                -2.176175e-02 1 1  ON 22
 eO_3                 2.985440e-01 1 1  ON 23
 eO_4                 5.253742e-01 1 1  ON 24
 eO_5                 4.877357e-01 1 1  ON 25
 eO_6                 2.599361e-01 1 1  ON 26
 eO_7                -4.074804e-02 1 1  ON 27
 eO_8                -2.213119e-01 1 1  ON 28
 eO_9                -8.636817e-02 1 1  ON 29
eH1_0                -2.442377e-01 1 1  ON 30
eH1_1                -1.451630e-01 1 1  ON 31
eH1_2                -9.867233e-02 1 1  ON 32
eH1_3                -4.492219e-02 1 1  ON 33
eH1_4                 3.216155e-03 1 1  ON 34
eH1_5                 3.812792e-02 1 1  ON 35
eH1_6                 9.663831e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771018e-01 1 1  ON 38
eH1_9                 6.778635e-02 1 1  ON 39
eH2_0                -2.419086e-01 1 1  ON 40
eH2_1                -1.428416e-01 1 1  ON 41
eH2_2                -9.656730e-02 1 1  ON 42
eH2_3                -4.254900e-02 1 1  ON 43
eH2_4                 5.493461e-03 1 1  ON 44
eH2_5                 4.023461e-02 1 1  ON 45
eH2_6                 9.949990e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826576e-01 1 1  ON 48
eH2_9                 5.729402e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0988e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9323
    reference variance = 0.347552
====================================================
  Execution time = 3.9376e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3263e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0945e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332564282559
                                         uncertainty =       0.002412507479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332564282559
                                         uncertainty =       0.002412507479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407815040
  error estimate for blocks of size 2^( 2) =       0.000420497019
  error estimate for blocks of size 2^( 3) =       0.000433983714
  error estimate for blocks of size 2^( 4) =       0.000446344970
  error estimate for blocks of size 2^( 5) =       0.000456860096
  error estimate for blocks of size 2^( 6) =       0.000463292550
  error estimate for blocks of size 2^( 7) =       0.000468836660

      target function =                  N/A
              le_mean =     -16.905939154017
             les_mean =     286.143404726417
             stat err =       0.000458833569
             autocorr =       1.265854797546
              std dev =       0.576737560258
             le_variance =       0.332626213413


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593915402e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905939154017       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905939163126       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905939164738       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905939165608       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905939166285       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905939165367       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905939165755       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905939165722       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 6.323009e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905939154017       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905939156295       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905939156698       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905939156915       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905939157084       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905939156855       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905939156952       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905939156944       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.580865e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905939154017       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905939154586       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905939154687       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905939154741       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905939154780       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905939154733       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905939154744       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905939154756       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 3.952232e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136210 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0328e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.091640e-01 1 1  ON 0
 uu_1                 1.423699e-01 1 1  ON 1
 uu_2                 4.097120e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660622e-02 1 1  ON 4
 uu_5                -1.014598e-01 1 1  ON 5
 uu_6                -1.283844e-01 1 1  ON 6
 uu_7                -1.412891e-01 1 1  ON 7
 uu_8                -1.332636e-01 1 1  ON 8
 uu_9                -1.049641e-01 1 1  ON 9
 ud_0                 4.474489e-01 1 1  ON 10
 ud_1                 1.822363e-01 1 1  ON 11
 ud_2                 6.293639e-02 1 1  ON 12
 ud_3                -7.385549e-03 1 1  ON 13
 ud_4                -6.473819e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520048e-01 1 1  ON 17
 ud_8                -1.529387e-01 1 1  ON 18
 ud_9                -1.433438e-01 1 1  ON 19
 eO_0                -7.599169e-01 1 1  ON 20
 eO_1                -4.401010e-01 1 1  ON 21
 eO_2                -2.176173e-02 1 1  ON 22
 eO_3                 2.985441e-01 1 1  ON 23
 eO_4                 5.253742e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599361e-01 1 1  ON 26
 eO_7                -4.074803e-02 1 1  ON 27
 eO_8                -2.213119e-01 1 1  ON 28
 eO_9                -8.636823e-02 1 1  ON 29
eH1_0                -2.442379e-01 1 1  ON 30
eH1_1                -1.451631e-01 1 1  ON 31
eH1_2                -9.867230e-02 1 1  ON 32
eH1_3                -4.492217e-02 1 1  ON 33
eH1_4                 3.216193e-03 1 1  ON 34
eH1_5                 3.812792e-02 1 1  ON 35
eH1_6                 9.663825e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771019e-01 1 1  ON 38
eH1_9                 6.778643e-02 1 1  ON 39
eH2_0                -2.419087e-01 1 1  ON 40
eH2_1                -1.428416e-01 1 1  ON 41
eH2_2                -9.656724e-02 1 1  ON 42
eH2_3                -4.254894e-02 1 1  ON 43
eH2_4                 5.493460e-03 1 1  ON 44
eH2_5                 4.023461e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826577e-01 1 1  ON 48
eH2_9                 5.729410e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9134
    reference variance = 0.252336
====================================================
  Execution time = 3.9046e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5079e-01
  Total weights = 2.0000e+06
  Execution time = 3.6703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350823125774
                                         uncertainty =       0.007101765801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350823125774
                                         uncertainty =       0.007101765801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418800871
  error estimate for blocks of size 2^( 2) =       0.000431695912
  error estimate for blocks of size 2^( 3) =       0.000445067364
  error estimate for blocks of size 2^( 4) =       0.000458900406
  error estimate for blocks of size 2^( 5) =       0.000471067679
  error estimate for blocks of size 2^( 6) =       0.000480960889
  error estimate for blocks of size 2^( 7) =       0.000487254809

      target function =                  N/A
              le_mean =     -16.905706721251
             les_mean =     286.153707907896
             stat err =       0.000474545945
             autocorr =       1.283930106042
              std dev =       0.592273871061
             le_variance =       0.350788338342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350823536996
                                         uncertainty =       0.007101770149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350823536996
                                         uncertainty =       0.007101770149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418801116
  error estimate for blocks of size 2^( 2) =       0.000431696128
  error estimate for blocks of size 2^( 3) =       0.000445067551
  error estimate for blocks of size 2^( 4) =       0.000458900579
  error estimate for blocks of size 2^( 5) =       0.000471067846
  error estimate for blocks of size 2^( 6) =       0.000480961058
  error estimate for blocks of size 2^( 7) =       0.000487254989

      target function =                  N/A
              le_mean =     -16.905706726978
             les_mean =     286.153708512783
             stat err =       0.000474546118
             autocorr =       1.283929534495
              std dev =       0.592274218236
             le_variance =       0.350788749586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350823331404
                                         uncertainty =       0.007101767974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350823331404
                                         uncertainty =       0.007101767974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418800993
  error estimate for blocks of size 2^( 2) =       0.000431696020
  error estimate for blocks of size 2^( 3) =       0.000445067458
  error estimate for blocks of size 2^( 4) =       0.000458900492
  error estimate for blocks of size 2^( 5) =       0.000471067762
  error estimate for blocks of size 2^( 6) =       0.000480960973
  error estimate for blocks of size 2^( 7) =       0.000487254899

      target function =                  N/A
              le_mean =     -16.905706724114
             les_mean =     286.153708210357
             stat err =       0.000474546032
             autocorr =       1.283929820199
              std dev =       0.592274044665
             le_variance =       0.350788543983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350823151478
                                         uncertainty =       0.007101766073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350823151478
                                         uncertainty =       0.007101766073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418800886
  error estimate for blocks of size 2^( 2) =       0.000431695926
  error estimate for blocks of size 2^( 3) =       0.000445067376
  error estimate for blocks of size 2^( 4) =       0.000458900416
  error estimate for blocks of size 2^( 5) =       0.000471067689
  error estimate for blocks of size 2^( 6) =       0.000480960899
  error estimate for blocks of size 2^( 7) =       0.000487254820

      target function =                  N/A
              le_mean =     -16.905706721609
             les_mean =     286.153707945702
             stat err =       0.000474545956
             autocorr =       1.283930070308
              std dev =       0.592273892762
             le_variance =       0.350788364047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905706721251        initial
     6.2500e+02     6.2500e+03             6.3230e-07       -16.905706726978  <--
     2.5000e+03     2.5000e+04             1.5809e-07       -16.905706724114
     1.0000e+04     1.0000e+05             3.9522e-08       -16.905706721609

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 5.7519e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385746e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401008e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985442e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636843e-02 1 1  ON 29
eH1_0                -2.442383e-01 1 1  ON 30
eH1_1                -1.451631e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492211e-02 1 1  ON 33
eH1_4                 3.216308e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663808e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771021e-01 1 1  ON 38
eH1_9                 6.778667e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656705e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493456e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729434e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0785e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8967
    reference variance = 0.298579
====================================================
  Execution time = 3.9452e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5070e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0717e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350779524515
                                         uncertainty =       0.011469941406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350779524515
                                         uncertainty =       0.011469941406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418748470
  error estimate for blocks of size 2^( 2) =       0.000431159165
  error estimate for blocks of size 2^( 3) =       0.000443820905
  error estimate for blocks of size 2^( 4) =       0.000455865137
  error estimate for blocks of size 2^( 5) =       0.000465708960
  error estimate for blocks of size 2^( 6) =       0.000471989515
  error estimate for blocks of size 2^( 7) =       0.000476476076

      target function =                  N/A
              le_mean =     -16.906256857281
             les_mean =     286.172221310998
             stat err =       0.000467509922
             autocorr =       1.246450966285
              std dev =       0.592199765276
             le_variance =       0.350700561993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690625685728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256857281       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906256889531       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906256896804       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906256906837       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906256905059       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906256906543       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906256907610       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906256906810       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.963908e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256857281       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906256865351       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906256867167       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906256869681       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906256869237       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906256869605       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906256869872       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906256869673       residual = 9.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 7.412129e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256857281       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906256859299       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906256859753       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906256860381       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906256860272       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906256860363       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906256860428       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906256860379       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.853180e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138897 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0176e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.091643e-01 1 1  ON 0
 uu_1                 1.423702e-01 1 1  ON 1
 uu_2                 4.097114e-02 1 1  ON 2
 uu_3                -2.136723e-02 1 1  ON 3
 uu_4                -6.660630e-02 1 1  ON 4
 uu_5                -1.014597e-01 1 1  ON 5
 uu_6                -1.283847e-01 1 1  ON 6
 uu_7                -1.412893e-01 1 1  ON 7
 uu_8                -1.332638e-01 1 1  ON 8
 uu_9                -1.049643e-01 1 1  ON 9
 ud_0                 4.474498e-01 1 1  ON 10
 ud_1                 1.822371e-01 1 1  ON 11
 ud_2                 6.293634e-02 1 1  ON 12
 ud_3                -7.386107e-03 1 1  ON 13
 ud_4                -6.473822e-02 1 1  ON 14
 ud_5                -1.068963e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529389e-01 1 1  ON 18
 ud_9                -1.433442e-01 1 1  ON 19
 eO_0                -7.599174e-01 1 1  ON 20
 eO_1                -4.401004e-01 1 1  ON 21
 eO_2                -2.176157e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253744e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599363e-01 1 1  ON 26
 eO_7                -4.074794e-02 1 1  ON 27
 eO_8                -2.213123e-01 1 1  ON 28
 eO_9                -8.636867e-02 1 1  ON 29
eH1_0                -2.442391e-01 1 1  ON 30
eH1_1                -1.451633e-01 1 1  ON 31
eH1_2                -9.867205e-02 1 1  ON 32
eH1_3                -4.492193e-02 1 1  ON 33
eH1_4                 3.216569e-03 1 1  ON 34
eH1_5                 3.812798e-02 1 1  ON 35
eH1_6                 9.663811e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771023e-01 1 1  ON 38
eH1_9                 6.778684e-02 1 1  ON 39
eH2_0                -2.419098e-01 1 1  ON 40
eH2_1                -1.428423e-01 1 1  ON 41
eH2_2                -9.656683e-02 1 1  ON 42
eH2_3                -4.254873e-02 1 1  ON 43
eH2_4                 5.493595e-03 1 1  ON 44
eH2_5                 4.023457e-02 1 1  ON 45
eH2_6                 9.949985e-02 1 1  ON 46
eH2_7                 1.552622e-01 1 1  ON 47
eH2_8                 1.826580e-01 1 1  ON 48
eH2_9                 5.729468e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9313
    reference variance = 0.198157
====================================================
  Execution time = 4.1995e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3909e-01
  Total weights = 2.0000e+06
  Execution time = 3.6827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339067896119
                                         uncertainty =       0.004986340241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339067896119
                                         uncertainty =       0.004986340241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411755879
  error estimate for blocks of size 2^( 2) =       0.000424499601
  error estimate for blocks of size 2^( 3) =       0.000437249407
  error estimate for blocks of size 2^( 4) =       0.000449668633
  error estimate for blocks of size 2^( 5) =       0.000461602802
  error estimate for blocks of size 2^( 6) =       0.000470014722
  error estimate for blocks of size 2^( 7) =       0.000474295318

      target function =                  N/A
              le_mean =     -16.905394132112
             les_mean =     286.131436400795
             stat err =       0.000463895369
             autocorr =       1.269288821546
              std dev =       0.582310748919
             le_variance =       0.339085808306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339069001886
                                         uncertainty =       0.004986371366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339069001886
                                         uncertainty =       0.004986371366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411756550
  error estimate for blocks of size 2^( 2) =       0.000424500171
  error estimate for blocks of size 2^( 3) =       0.000437249870
  error estimate for blocks of size 2^( 4) =       0.000449669014
  error estimate for blocks of size 2^( 5) =       0.000461603170
  error estimate for blocks of size 2^( 6) =       0.000470015072
  error estimate for blocks of size 2^( 7) =       0.000474295662

      target function =                  N/A
              le_mean =     -16.905394110470
             les_mean =     286.131436774203
             stat err =       0.000463895729
             autocorr =       1.269286659290
              std dev =       0.582311697832
             le_variance =       0.339086913432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068449022
                                         uncertainty =       0.004986355807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339068449022
                                         uncertainty =       0.004986355807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411756215
  error estimate for blocks of size 2^( 2) =       0.000424499886
  error estimate for blocks of size 2^( 3) =       0.000437249638
  error estimate for blocks of size 2^( 4) =       0.000449668823
  error estimate for blocks of size 2^( 5) =       0.000461602986
  error estimate for blocks of size 2^( 6) =       0.000470014897
  error estimate for blocks of size 2^( 7) =       0.000474295490

      target function =                  N/A
              le_mean =     -16.905394121264
             les_mean =     286.131436586613
             stat err =       0.000463895549
             autocorr =       1.269287739601
              std dev =       0.582311223392
             le_variance =       0.339086360889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339067965229
                                         uncertainty =       0.004986342187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339067965229
                                         uncertainty =       0.004986342187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411755921
  error estimate for blocks of size 2^( 2) =       0.000424499637
  error estimate for blocks of size 2^( 3) =       0.000437249436
  error estimate for blocks of size 2^( 4) =       0.000449668657
  error estimate for blocks of size 2^( 5) =       0.000461602825
  error estimate for blocks of size 2^( 6) =       0.000470014744
  error estimate for blocks of size 2^( 7) =       0.000474295339

      target function =                  N/A
              le_mean =     -16.905394130754
             les_mean =     286.131436423963
             stat err =       0.000463895391
             autocorr =       1.269288686274
              std dev =       0.582310808226
             le_variance =       0.339085877376


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905394132112        initial  <--
     1.5625e+02     1.5625e+03             2.9639e-06       -16.905394110470
     6.2500e+02     6.2500e+03             7.4121e-07       -16.905394121264
     2.5000e+03     2.5000e+04             1.8532e-07       -16.905394130754

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5616
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385746e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401008e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985442e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636843e-02 1 1  ON 29
eH1_0                -2.442383e-01 1 1  ON 30
eH1_1                -1.451631e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492211e-02 1 1  ON 33
eH1_4                 3.216308e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663808e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771021e-01 1 1  ON 38
eH1_9                 6.778667e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656705e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493456e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729434e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1074e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9971
    reference variance = 0.268167
====================================================
  Execution time = 4.0091e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3596e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0740e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335993402861
                                         uncertainty =       0.003219354985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335993402861
                                         uncertainty =       0.003219354985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409854739
  error estimate for blocks of size 2^( 2) =       0.000422735266
  error estimate for blocks of size 2^( 3) =       0.000436139045
  error estimate for blocks of size 2^( 4) =       0.000448686887
  error estimate for blocks of size 2^( 5) =       0.000459806318
  error estimate for blocks of size 2^( 6) =       0.000468386758
  error estimate for blocks of size 2^( 7) =       0.000474256517

      target function =                  N/A
              le_mean =     -16.906411952197
             les_mean =     286.162726744254
             stat err =       0.000462784120
             autocorr =       1.274961214559
              std dev =       0.579622131100
             le_variance =       0.335961814861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641195220e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411952197       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906411953313       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906411954177       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906411954944       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906411955197       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906411955429       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906411955466       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906411955474       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.344239e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411952197       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906411952476       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906411952692       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906411952883       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906411952947       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906411953005       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906411953014       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906411953014       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 5.860805e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906411952197       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906411952266       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906411952320       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906411952363       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906411952383       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906411952416       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906411952425       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906411952408       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 1.465214e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141597 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0839e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097112e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412893e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293632e-02 1 1  ON 12
 ud_3                -7.385772e-03 1 1  ON 13
 ud_4                -6.473827e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176164e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074797e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636845e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492211e-02 1 1  ON 33
eH1_4                 3.216315e-03 1 1  ON 34
eH1_5                 3.812792e-02 1 1  ON 35
eH1_6                 9.663807e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778670e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656705e-02 1 1  ON 42
eH2_3                -4.254879e-02 1 1  ON 43
eH2_4                 5.493461e-03 1 1  ON 44
eH2_5                 4.023460e-02 1 1  ON 45
eH2_6                 9.949990e-02 1 1  ON 46
eH2_7                 1.552622e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729438e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8957
    reference variance = 0.231599
====================================================
  Execution time = 3.9295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.0000e+06
  Execution time = 3.7261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336395024734
                                         uncertainty =       0.004323171315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336395024734
                                         uncertainty =       0.004323171315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410127096
  error estimate for blocks of size 2^( 2) =       0.000422962855
  error estimate for blocks of size 2^( 3) =       0.000435699267
  error estimate for blocks of size 2^( 4) =       0.000447941845
  error estimate for blocks of size 2^( 5) =       0.000459540768
  error estimate for blocks of size 2^( 6) =       0.000467919240
  error estimate for blocks of size 2^( 7) =       0.000473085717

      target function =                  N/A
              le_mean =     -16.906236246718
             les_mean =     286.157232331949
             stat err =       0.000462121892
             autocorr =       1.269627029437
              std dev =       0.580007301957
             le_variance =       0.336408470323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336395135670
                                         uncertainty =       0.004323174537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336395135670
                                         uncertainty =       0.004323174537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410127164
  error estimate for blocks of size 2^( 2) =       0.000422962915
  error estimate for blocks of size 2^( 3) =       0.000435699315
  error estimate for blocks of size 2^( 4) =       0.000447941886
  error estimate for blocks of size 2^( 5) =       0.000459540805
  error estimate for blocks of size 2^( 6) =       0.000467919272
  error estimate for blocks of size 2^( 7) =       0.000473085747

      target function =                  N/A
              le_mean =     -16.906236245116
             les_mean =     286.157232388699
             stat err =       0.000462121928
             autocorr =       1.269626804478
              std dev =       0.580007397561
             le_variance =       0.336408581226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336395080201
                                         uncertainty =       0.004323172926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336395080201
                                         uncertainty =       0.004323172926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410127130
  error estimate for blocks of size 2^( 2) =       0.000422962885
  error estimate for blocks of size 2^( 3) =       0.000435699291
  error estimate for blocks of size 2^( 4) =       0.000447941866
  error estimate for blocks of size 2^( 5) =       0.000459540787
  error estimate for blocks of size 2^( 6) =       0.000467919256
  error estimate for blocks of size 2^( 7) =       0.000473085732

      target function =                  N/A
              le_mean =     -16.906236245917
             les_mean =     286.157232360318
             stat err =       0.000462121910
             autocorr =       1.269626916956
              std dev =       0.580007349758
             le_variance =       0.336408525773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336395031667
                                         uncertainty =       0.004323171516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336395031667
                                         uncertainty =       0.004323171516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410127101
  error estimate for blocks of size 2^( 2) =       0.000422962859
  error estimate for blocks of size 2^( 3) =       0.000435699270
  error estimate for blocks of size 2^( 4) =       0.000447941847
  error estimate for blocks of size 2^( 5) =       0.000459540771
  error estimate for blocks of size 2^( 6) =       0.000467919242
  error estimate for blocks of size 2^( 7) =       0.000473085719

      target function =                  N/A
              le_mean =     -16.906236246618
             les_mean =     286.157232335494
             stat err =       0.000462121895
             autocorr =       1.269627015375
              std dev =       0.580007307932
             le_variance =       0.336408477254


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906236246718        initial  <--
     1.5625e+03     1.5625e+04             2.3442e-07       -16.906236245116
     6.2500e+03     6.2500e+04             5.8608e-08       -16.906236245917
     2.5000e+04     2.5000e+05             1.4652e-08       -16.906236246618

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.0922
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385746e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401008e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985442e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636843e-02 1 1  ON 29
eH1_0                -2.442383e-01 1 1  ON 30
eH1_1                -1.451631e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492211e-02 1 1  ON 33
eH1_4                 3.216308e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663808e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771021e-01 1 1  ON 38
eH1_9                 6.778667e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656705e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493456e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729434e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0894e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8118
    reference variance = 0.229123
====================================================
  Execution time = 4.0125e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.6588e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0768e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366008284543
                                         uncertainty =       0.017012541809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366008284543
                                         uncertainty =       0.017012541809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427714775
  error estimate for blocks of size 2^( 2) =       0.000440432553
  error estimate for blocks of size 2^( 3) =       0.000453095307
  error estimate for blocks of size 2^( 4) =       0.000465632146
  error estimate for blocks of size 2^( 5) =       0.000477149488
  error estimate for blocks of size 2^( 6) =       0.000484933969
  error estimate for blocks of size 2^( 7) =       0.000488716437

      target function =                  N/A
              le_mean =     -16.905472018290
             les_mean =     286.160863835592
             stat err =       0.000479108010
             autocorr =       1.254753331846
              std dev =       0.604880035507
             le_variance =       0.365879857355


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690547201829e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905472018290       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905472018735       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905472018753       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905472018715       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905472018685       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905472018702       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905472018684       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905472018656       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905472018622       residual = 7.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 2.829895e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905472018290       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905472018401       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905472018406       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905472018396       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905472018389       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905472018422       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905472018385       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905472018393       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905472018335       residual = 7.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 7.074750e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905472018290       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905472018318       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905472018319       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905472018316       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905472018255       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905472018087       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905472018248       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905472018331       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905472018271       residual = 7.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 1.768689e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0901e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385750e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401008e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985442e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636843e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492211e-02 1 1  ON 33
eH1_4                 3.216309e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663808e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771021e-01 1 1  ON 38
eH1_9                 6.778667e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656705e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493458e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729435e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9057
    reference variance = 0.164138
====================================================
  Execution time = 3.9445e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4124e-01
  Total weights = 2.0000e+06
  Execution time = 3.6756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328655538
                                         uncertainty =       0.003711314936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328655538
                                         uncertainty =       0.003711314936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413061045
  error estimate for blocks of size 2^( 2) =       0.000426047294
  error estimate for blocks of size 2^( 3) =       0.000439568236
  error estimate for blocks of size 2^( 4) =       0.000452757441
  error estimate for blocks of size 2^( 5) =       0.000464474082
  error estimate for blocks of size 2^( 6) =       0.000474597164
  error estimate for blocks of size 2^( 7) =       0.000483218597

      target function =                  N/A
              le_mean =     -16.905838632601
             les_mean =     286.148618555198
             stat err =       0.000468761821
             autocorr =       1.287881739381
              std dev =       0.584156532344
             le_variance =       0.341238854280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328672165
                                         uncertainty =       0.003711315230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328672165
                                         uncertainty =       0.003711315230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413061055
  error estimate for blocks of size 2^( 2) =       0.000426047303
  error estimate for blocks of size 2^( 3) =       0.000439568245
  error estimate for blocks of size 2^( 4) =       0.000452757448
  error estimate for blocks of size 2^( 5) =       0.000464474089
  error estimate for blocks of size 2^( 6) =       0.000474597171
  error estimate for blocks of size 2^( 7) =       0.000483218603

      target function =                  N/A
              le_mean =     -16.905838632668
             les_mean =     286.148618574110
             stat err =       0.000468761828
             autocorr =       1.287881714865
              std dev =       0.584156546575
             le_variance =       0.341238870907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328663851
                                         uncertainty =       0.003711315083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328663851
                                         uncertainty =       0.003711315083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413061050
  error estimate for blocks of size 2^( 2) =       0.000426047298
  error estimate for blocks of size 2^( 3) =       0.000439568241
  error estimate for blocks of size 2^( 4) =       0.000452757444
  error estimate for blocks of size 2^( 5) =       0.000464474085
  error estimate for blocks of size 2^( 6) =       0.000474597167
  error estimate for blocks of size 2^( 7) =       0.000483218600

      target function =                  N/A
              le_mean =     -16.905838632635
             les_mean =     286.148618564654
             stat err =       0.000468761824
             autocorr =       1.287881727125
              std dev =       0.584156539459
             le_variance =       0.341238862593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328656577
                                         uncertainty =       0.003711314955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328656577
                                         uncertainty =       0.003711314955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413061046
  error estimate for blocks of size 2^( 2) =       0.000426047294
  error estimate for blocks of size 2^( 3) =       0.000439568237
  error estimate for blocks of size 2^( 4) =       0.000452757441
  error estimate for blocks of size 2^( 5) =       0.000464474082
  error estimate for blocks of size 2^( 6) =       0.000474597164
  error estimate for blocks of size 2^( 7) =       0.000483218597

      target function =                  N/A
              le_mean =     -16.905838632605
             les_mean =     286.148618556380
             stat err =       0.000468761821
             autocorr =       1.287881737852
              std dev =       0.584156533233
             le_variance =       0.341238855318


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905838632601        initial
     1.5625e+04     1.5625e+05             2.8299e-08       -16.905838632668  <--
     6.2500e+04     6.2500e+05             7.0748e-09       -16.905838632635
     2.5000e+05     2.5000e+06             1.7687e-09       -16.905838632605

*****************************************************************************
Applying the update for shift_i =   1.5625e+04     and shift_s =   1.5625e+05
*****************************************************************************

  Execution time = 5.7949e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385761e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176166e-02 1 1  ON 22
 eO_3                 2.985442e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492211e-02 1 1  ON 33
eH1_4                 3.216312e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493465e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0886e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9598
    reference variance = 0.662536
====================================================
  Execution time = 4.1844e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3878e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0743e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338851998724
                                         uncertainty =       0.003228399289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338851998724
                                         uncertainty =       0.003228399289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411569823
  error estimate for blocks of size 2^( 2) =       0.000424573375
  error estimate for blocks of size 2^( 3) =       0.000437559486
  error estimate for blocks of size 2^( 4) =       0.000449134816
  error estimate for blocks of size 2^( 5) =       0.000458589395
  error estimate for blocks of size 2^( 6) =       0.000467875087
  error estimate for blocks of size 2^( 7) =       0.000474618924

      target function =                  N/A
              le_mean =     -16.905749075953
             les_mean =     286.143131088429
             stat err =       0.000462554555
             autocorr =       1.263103318444
              std dev =       0.582047625827
             le_variance =       0.338779438730


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574907595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749075953       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749076911       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749077032       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749077379       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749077426       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749077454       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749077389       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749077406       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905749077417       residual = 1.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.149405e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749075953       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749076193       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749076223       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749076312       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749076338       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749076329       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749076317       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749076319       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905749076315       residual = 1.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 2.873541e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749075953       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749076013       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749076021       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749076048       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749076047       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749076123       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749076061       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749076008       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905749076078       residual = 1.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 7.183869e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2595e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097112e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412893e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293632e-02 1 1  ON 12
 ud_3                -7.385769e-03 1 1  ON 13
 ud_4                -6.473826e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636845e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216315e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778669e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254877e-02 1 1  ON 43
eH2_4                 5.493472e-03 1 1  ON 44
eH2_5                 4.023460e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8884
    reference variance = 0.21533
====================================================
  Execution time = 4.1347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3907e-01
  Total weights = 2.0000e+06
  Execution time = 3.6704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339036126049
                                         uncertainty =       0.004588547878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339036126049
                                         uncertainty =       0.004588547878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411747568
  error estimate for blocks of size 2^( 2) =       0.000424742390
  error estimate for blocks of size 2^( 3) =       0.000438198820
  error estimate for blocks of size 2^( 4) =       0.000451387478
  error estimate for blocks of size 2^( 5) =       0.000461930589
  error estimate for blocks of size 2^( 6) =       0.000470731722
  error estimate for blocks of size 2^( 7) =       0.000473357824

      target function =                  N/A
              le_mean =     -16.904954781964
             les_mean =     286.116568130770
             stat err =       0.000464351903
             autocorr =       1.271839689187
              std dev =       0.582298995400
             le_variance =       0.339072120044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339036143761
                                         uncertainty =       0.004588547202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339036143761
                                         uncertainty =       0.004588547202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411747579
  error estimate for blocks of size 2^( 2) =       0.000424742397
  error estimate for blocks of size 2^( 3) =       0.000438198822
  error estimate for blocks of size 2^( 4) =       0.000451387478
  error estimate for blocks of size 2^( 5) =       0.000461930588
  error estimate for blocks of size 2^( 6) =       0.000470731722
  error estimate for blocks of size 2^( 7) =       0.000473357825

      target function =                  N/A
              le_mean =     -16.904954781560
             les_mean =     286.116568134814
             stat err =       0.000464351903
             autocorr =       1.271839622948
              std dev =       0.582299010619
             le_variance =       0.339072137767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339036134904
                                         uncertainty =       0.004588547540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339036134904
                                         uncertainty =       0.004588547540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411747574
  error estimate for blocks of size 2^( 2) =       0.000424742394
  error estimate for blocks of size 2^( 3) =       0.000438198821
  error estimate for blocks of size 2^( 4) =       0.000451387478
  error estimate for blocks of size 2^( 5) =       0.000461930588
  error estimate for blocks of size 2^( 6) =       0.000470731722
  error estimate for blocks of size 2^( 7) =       0.000473357824

      target function =                  N/A
              le_mean =     -16.904954781762
             les_mean =     286.116568132789
             stat err =       0.000464351903
             autocorr =       1.271839656059
              std dev =       0.582299003008
             le_variance =       0.339072128904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339036127156
                                         uncertainty =       0.004588547836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339036127156
                                         uncertainty =       0.004588547836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411747569
  error estimate for blocks of size 2^( 2) =       0.000424742390
  error estimate for blocks of size 2^( 3) =       0.000438198820
  error estimate for blocks of size 2^( 4) =       0.000451387478
  error estimate for blocks of size 2^( 5) =       0.000461930589
  error estimate for blocks of size 2^( 6) =       0.000470731722
  error estimate for blocks of size 2^( 7) =       0.000473357824

      target function =                  N/A
              le_mean =     -16.904954781939
             les_mean =     286.116568131022
             stat err =       0.000464351903
             autocorr =       1.271839685047
              std dev =       0.582298996351
             le_variance =       0.339072121152


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904954781964        initial  <--
     3.9062e+03     3.9062e+04             1.1494e-07       -16.904954781560
     1.5625e+04     1.5625e+05             2.8735e-08       -16.904954781762
     6.2500e+04     6.2500e+05             7.1839e-09       -16.904954781939

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 59.8322
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385761e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176166e-02 1 1  ON 22
 eO_3                 2.985442e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492211e-02 1 1  ON 33
eH1_4                 3.216312e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493465e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1243e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9265
    reference variance = 0.350359
====================================================
  Execution time = 4.0256e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3115e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0888e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331260780791
                                         uncertainty =       0.002383973297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331260780791
                                         uncertainty =       0.002383973297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406910587
  error estimate for blocks of size 2^( 2) =       0.000420040417
  error estimate for blocks of size 2^( 3) =       0.000432976271
  error estimate for blocks of size 2^( 4) =       0.000444902276
  error estimate for blocks of size 2^( 5) =       0.000454621191
  error estimate for blocks of size 2^( 6) =       0.000460918385
  error estimate for blocks of size 2^( 7) =       0.000465761485

      target function =                  N/A
              le_mean =     -16.906078527518
             les_mean =     286.146643464593
             stat err =       0.000456550834
             autocorr =       1.258868315673
              std dev =       0.575458470764
             le_variance =       0.331152451574


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607852752e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906078527518       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906078527593       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906078527572       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906078527606       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906078527570       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906078527585       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906078527559       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906078527556       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906078527604       residual = 9.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 9.534029e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906078527518       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906078527536       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906078527531       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906078527532       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906078527532       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906078527645       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906078527520       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906078527548       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906078527579       residual = 9.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 2.383509e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906078527518       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906078527522       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906078527521       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906078527492       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906078527521       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906078527526       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906078527517       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906078527521       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906078527728       residual = 9.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 5.958773e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150811 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1152e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385762e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176166e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492211e-02 1 1  ON 33
eH1_4                 3.216312e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493466e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8514
    reference variance = 0.438047
====================================================
  Execution time = 3.9834e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3871e-01
  Total weights = 2.0000e+06
  Execution time = 3.6776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338755607456
                                         uncertainty =       0.004263254277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338755607456
                                         uncertainty =       0.004263254277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411527955
  error estimate for blocks of size 2^( 2) =       0.000424243960
  error estimate for blocks of size 2^( 3) =       0.000436582188
  error estimate for blocks of size 2^( 4) =       0.000448331323
  error estimate for blocks of size 2^( 5) =       0.000458410303
  error estimate for blocks of size 2^( 6) =       0.000465411151
  error estimate for blocks of size 2^( 7) =       0.000471443872

      target function =                  N/A
              le_mean =     -16.906549984786
             les_mean =     286.170142733937
             stat err =       0.000460899162
             autocorr =       1.254333881901
              std dev =       0.581988415034
             le_variance =       0.338710515234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338755610059
                                         uncertainty =       0.004263254285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338755610059
                                         uncertainty =       0.004263254285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411527956
  error estimate for blocks of size 2^( 2) =       0.000424243962
  error estimate for blocks of size 2^( 3) =       0.000436582189
  error estimate for blocks of size 2^( 4) =       0.000448331324
  error estimate for blocks of size 2^( 5) =       0.000458410303
  error estimate for blocks of size 2^( 6) =       0.000465411151
  error estimate for blocks of size 2^( 7) =       0.000471443873

      target function =                  N/A
              le_mean =     -16.906549984829
             les_mean =     286.170142738001
             stat err =       0.000460899163
             autocorr =       1.254333875975
              std dev =       0.581988417268
             le_variance =       0.338710517834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338755608757
                                         uncertainty =       0.004263254281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338755608757
                                         uncertainty =       0.004263254281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411527956
  error estimate for blocks of size 2^( 2) =       0.000424243961
  error estimate for blocks of size 2^( 3) =       0.000436582189
  error estimate for blocks of size 2^( 4) =       0.000448331324
  error estimate for blocks of size 2^( 5) =       0.000458410303
  error estimate for blocks of size 2^( 6) =       0.000465411151
  error estimate for blocks of size 2^( 7) =       0.000471443872

      target function =                  N/A
              le_mean =     -16.906549984807
             les_mean =     286.170142735969
             stat err =       0.000460899163
             autocorr =       1.254333878928
              std dev =       0.581988416151
             le_variance =       0.338710516534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338755607619
                                         uncertainty =       0.004263254277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338755607619
                                         uncertainty =       0.004263254277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411527955
  error estimate for blocks of size 2^( 2) =       0.000424243960
  error estimate for blocks of size 2^( 3) =       0.000436582188
  error estimate for blocks of size 2^( 4) =       0.000448331323
  error estimate for blocks of size 2^( 5) =       0.000458410303
  error estimate for blocks of size 2^( 6) =       0.000465411151
  error estimate for blocks of size 2^( 7) =       0.000471443872

      target function =                  N/A
              le_mean =     -16.906549984788
             les_mean =     286.170142734191
             stat err =       0.000460899162
             autocorr =       1.254333881532
              std dev =       0.581988415174
             le_variance =       0.338710515397


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906549984786        initial
     3.9062e+04     3.9062e+05             9.5340e-09       -16.906549984829  <--
     1.5625e+05     1.5625e+06             2.3835e-09       -16.906549984807
     6.2500e+05     6.2500e+06             5.9588e-10       -16.906549984788

*****************************************************************************
Applying the update for shift_i =   3.9062e+04     and shift_s =   3.9062e+05
*****************************************************************************

  Execution time = 5.8385e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385767e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216313e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493470e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0954e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9486
    reference variance = 0.222261
====================================================
  Execution time = 4.0575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3455e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0795e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334538638142
                                         uncertainty =       0.002880115714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334538638142
                                         uncertainty =       0.002880115714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408995186
  error estimate for blocks of size 2^( 2) =       0.000422156703
  error estimate for blocks of size 2^( 3) =       0.000435401370
  error estimate for blocks of size 2^( 4) =       0.000447472129
  error estimate for blocks of size 2^( 5) =       0.000457785113
  error estimate for blocks of size 2^( 6) =       0.000463768959
  error estimate for blocks of size 2^( 7) =       0.000467498292

      target function =                  N/A
              le_mean =     -16.905542536574
             les_mean =     286.131922413453
             stat err =       0.000459131123
             autocorr =       1.260193029955
              std dev =       0.578406539406
             le_variance =       0.334554124828


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690554253657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905542536574       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905542536840       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905542537003       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905542537023       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905542537040       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905542537059       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905542536982       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905542537033       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 4.094742e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905542536574       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905542536640       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905542536681       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905542536677       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905542536687       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905542536695       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905542536704       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905542536676       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 1.023688e-08

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905542536574       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905542536590       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905542536601       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905542536602       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905542536634       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905542536605       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905542536590       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905542536564       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 2.559221e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153409 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1377e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385772e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636845e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216316e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493472e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729437e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9206
    reference variance = 0.20165
====================================================
  Execution time = 3.9516e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4536e-01
  Total weights = 2.0000e+06
  Execution time = 3.6589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345254978996
                                         uncertainty =       0.005177361572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345254978996
                                         uncertainty =       0.005177361572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415546332
  error estimate for blocks of size 2^( 2) =       0.000428177442
  error estimate for blocks of size 2^( 3) =       0.000441734558
  error estimate for blocks of size 2^( 4) =       0.000453382249
  error estimate for blocks of size 2^( 5) =       0.000462941362
  error estimate for blocks of size 2^( 6) =       0.000469947248
  error estimate for blocks of size 2^( 7) =       0.000474861210

      target function =                  N/A
              le_mean =     -16.905953434787
             les_mean =     286.156618873814
             stat err =       0.000465283017
             autocorr =       1.253705399764
              std dev =       0.587671257849
             le_variance =       0.345357507302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345254982854
                                         uncertainty =       0.005177361551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345254982854
                                         uncertainty =       0.005177361551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415546334
  error estimate for blocks of size 2^( 2) =       0.000428177443
  error estimate for blocks of size 2^( 3) =       0.000441734557
  error estimate for blocks of size 2^( 4) =       0.000453382247
  error estimate for blocks of size 2^( 5) =       0.000462941360
  error estimate for blocks of size 2^( 6) =       0.000469947247
  error estimate for blocks of size 2^( 7) =       0.000474861209

      target function =                  N/A
              le_mean =     -16.905953434233
             les_mean =     286.156618858940
             stat err =       0.000465283016
             autocorr =       1.253705379101
              std dev =       0.587671261131
             le_variance =       0.345357511159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345254980925
                                         uncertainty =       0.005177361562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345254980925
                                         uncertainty =       0.005177361562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415546333
  error estimate for blocks of size 2^( 2) =       0.000428177443
  error estimate for blocks of size 2^( 3) =       0.000441734558
  error estimate for blocks of size 2^( 4) =       0.000453382248
  error estimate for blocks of size 2^( 5) =       0.000462941361
  error estimate for blocks of size 2^( 6) =       0.000469947247
  error estimate for blocks of size 2^( 7) =       0.000474861209

      target function =                  N/A
              le_mean =     -16.905953434510
             les_mean =     286.156618866376
             stat err =       0.000465283016
             autocorr =       1.253705389429
              std dev =       0.587671259490
             le_variance =       0.345357509230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345254979237
                                         uncertainty =       0.005177361571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345254979237
                                         uncertainty =       0.005177361571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415546332
  error estimate for blocks of size 2^( 2) =       0.000428177442
  error estimate for blocks of size 2^( 3) =       0.000441734558
  error estimate for blocks of size 2^( 4) =       0.000453382249
  error estimate for blocks of size 2^( 5) =       0.000462941362
  error estimate for blocks of size 2^( 6) =       0.000469947248
  error estimate for blocks of size 2^( 7) =       0.000474861210

      target function =                  N/A
              le_mean =     -16.905953434753
             les_mean =     286.156618872885
             stat err =       0.000465283017
             autocorr =       1.253705398466
              std dev =       0.587671258054
             le_variance =       0.345357507543


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905953434787        initial  <--
     9.7656e+03     9.7656e+04             4.0947e-08       -16.905953434233
     3.9062e+04     3.9062e+05             1.0237e-08       -16.905953434510
     1.5625e+05     1.5625e+06             2.5592e-09       -16.905953434753

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.9500
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385767e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216313e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493470e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0934e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8656
    reference variance = 0.177029
====================================================
  Execution time = 4.4172e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3887e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0816e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339009248474
                                         uncertainty =       0.006174321997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339009248474
                                         uncertainty =       0.006174321997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411627090
  error estimate for blocks of size 2^( 2) =       0.000424553713
  error estimate for blocks of size 2^( 3) =       0.000438091811
  error estimate for blocks of size 2^( 4) =       0.000449962952
  error estimate for blocks of size 2^( 5) =       0.000461108308
  error estimate for blocks of size 2^( 6) =       0.000469525191
  error estimate for blocks of size 2^( 7) =       0.000475597098

      target function =                  N/A
              le_mean =     -16.905839014132
             les_mean =     286.146266324897
             stat err =       0.000464048387
             autocorr =       1.270921239618
              std dev =       0.582128613436
             le_variance =       0.338873722581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690583901413e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905839014132       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905839014177       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905839014171       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905839014180       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905839014150       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905839014184       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905839014226       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905839014233       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 5.115457e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905839014132       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905839014143       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905839014142       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905839014144       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905839014152       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905839014198       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905839013837       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905839014222       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.278865e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905839014132       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905839014135       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905839014135       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905839014135       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905839014136       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905839015175       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905839013135       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905839012062       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 3.197161e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156009 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.4995e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385768e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216313e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493470e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9284
    reference variance = 0.358712
====================================================
  Execution time = 3.8817e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4726e-01
  Total weights = 2.0000e+06
  Execution time = 3.6681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319562430
                                         uncertainty =       0.008053044386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319562430
                                         uncertainty =       0.008053044386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416692265
  error estimate for blocks of size 2^( 2) =       0.000429669585
  error estimate for blocks of size 2^( 3) =       0.000442764015
  error estimate for blocks of size 2^( 4) =       0.000455588798
  error estimate for blocks of size 2^( 5) =       0.000468222516
  error estimate for blocks of size 2^( 6) =       0.000478331733
  error estimate for blocks of size 2^( 7) =       0.000485096973

      target function =                  N/A
              le_mean =     -16.906474834901
             les_mean =     286.176156057659
             stat err =       0.000471810005
             autocorr =       1.282045426150
              std dev =       0.589291853121
             le_variance =       0.347264888155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319562604
                                         uncertainty =       0.008053044196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319562604
                                         uncertainty =       0.008053044196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416692266
  error estimate for blocks of size 2^( 2) =       0.000429669585
  error estimate for blocks of size 2^( 3) =       0.000442764015
  error estimate for blocks of size 2^( 4) =       0.000455588798
  error estimate for blocks of size 2^( 5) =       0.000468222516
  error estimate for blocks of size 2^( 6) =       0.000478331733
  error estimate for blocks of size 2^( 7) =       0.000485096973

      target function =                  N/A
              le_mean =     -16.906474834890
             les_mean =     286.176156057459
             stat err =       0.000471810005
             autocorr =       1.282045425290
              std dev =       0.589291853268
             le_variance =       0.347264888328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319562517
                                         uncertainty =       0.008053044291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319562517
                                         uncertainty =       0.008053044291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416692265
  error estimate for blocks of size 2^( 2) =       0.000429669585
  error estimate for blocks of size 2^( 3) =       0.000442764015
  error estimate for blocks of size 2^( 4) =       0.000455588798
  error estimate for blocks of size 2^( 5) =       0.000468222516
  error estimate for blocks of size 2^( 6) =       0.000478331733
  error estimate for blocks of size 2^( 7) =       0.000485096973

      target function =                  N/A
              le_mean =     -16.906474834895
             les_mean =     286.176156057559
             stat err =       0.000471810005
             autocorr =       1.282045425733
              std dev =       0.589291853195
             le_variance =       0.347264888241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319562441
                                         uncertainty =       0.008053044374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319562441
                                         uncertainty =       0.008053044374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416692265
  error estimate for blocks of size 2^( 2) =       0.000429669585
  error estimate for blocks of size 2^( 3) =       0.000442764015
  error estimate for blocks of size 2^( 4) =       0.000455588798
  error estimate for blocks of size 2^( 5) =       0.000468222516
  error estimate for blocks of size 2^( 6) =       0.000478331733
  error estimate for blocks of size 2^( 7) =       0.000485096973

      target function =                  N/A
              le_mean =     -16.906474834900
             les_mean =     286.176156057647
             stat err =       0.000471810005
             autocorr =       1.282045426104
              std dev =       0.589291853130
             le_variance =       0.347264888165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906474834901        initial  <--
     9.7656e+04     9.7656e+05             5.1155e-09       -16.906474834890
     3.9062e+05     3.9062e+06             1.2789e-09       -16.906474834895
     1.5625e+06     1.5625e+07             3.1972e-10       -16.906474834900

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.2422
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385767e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216313e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493470e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1224e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9134
    reference variance = 0.151409
====================================================
  Execution time = 4.0553e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3645e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0654e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336432788113
                                         uncertainty =       0.003376484341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336432788113
                                         uncertainty =       0.003376484341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410155250
  error estimate for blocks of size 2^( 2) =       0.000423133563
  error estimate for blocks of size 2^( 3) =       0.000436298150
  error estimate for blocks of size 2^( 4) =       0.000449052091
  error estimate for blocks of size 2^( 5) =       0.000459574020
  error estimate for blocks of size 2^( 6) =       0.000467836655
  error estimate for blocks of size 2^( 7) =       0.000474935914

      target function =                  N/A
              le_mean =     -16.906152213626
             les_mean =     286.154437160054
             stat err =       0.000462849670
             autocorr =       1.273454308412
              std dev =       0.580047117030
             le_variance =       0.336454657975


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615221363e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152213626       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152213627       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152213628       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152213629       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152213629       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152214157       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152214129       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152213633       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906152214258       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 4.256581e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152213626       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152213627       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152213627       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152213627       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152213627       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152212945       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152213777       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152212459       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906152214490       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 1.064144e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152213626       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152213627       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152213627       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152213627       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152213627       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152213627       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152211228       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152212126       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906152216301       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 2.660353e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1216e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385767e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216313e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493470e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9055
    reference variance = 0.28045
====================================================
  Execution time = 3.9290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4128e-01
  Total weights = 2.0000e+06
  Execution time = 3.6504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341311539572
                                         uncertainty =       0.003482811346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341311539572
                                         uncertainty =       0.003482811346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413086666
  error estimate for blocks of size 2^( 2) =       0.000425867039
  error estimate for blocks of size 2^( 3) =       0.000438456838
  error estimate for blocks of size 2^( 4) =       0.000449798655
  error estimate for blocks of size 2^( 5) =       0.000459639764
  error estimate for blocks of size 2^( 6) =       0.000466394999
  error estimate for blocks of size 2^( 7) =       0.000470153341

      target function =                  N/A
              le_mean =     -16.906872237772
             les_mean =     286.183609880588
             stat err =       0.000461496690
             autocorr =       1.248115646466
              std dev =       0.584192765187
             le_variance =       0.341281186897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341311539988
                                         uncertainty =       0.003482811351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341311539988
                                         uncertainty =       0.003482811351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413086666
  error estimate for blocks of size 2^( 2) =       0.000425867039
  error estimate for blocks of size 2^( 3) =       0.000438456838
  error estimate for blocks of size 2^( 4) =       0.000449798655
  error estimate for blocks of size 2^( 5) =       0.000459639764
  error estimate for blocks of size 2^( 6) =       0.000466394999
  error estimate for blocks of size 2^( 7) =       0.000470153341

      target function =                  N/A
              le_mean =     -16.906872237772
             les_mean =     286.183609881017
             stat err =       0.000461496690
             autocorr =       1.248115645910
              std dev =       0.584192765543
             le_variance =       0.341281187312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341311539780
                                         uncertainty =       0.003482811348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341311539780
                                         uncertainty =       0.003482811348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413086666
  error estimate for blocks of size 2^( 2) =       0.000425867039
  error estimate for blocks of size 2^( 3) =       0.000438456838
  error estimate for blocks of size 2^( 4) =       0.000449798655
  error estimate for blocks of size 2^( 5) =       0.000459639764
  error estimate for blocks of size 2^( 6) =       0.000466394999
  error estimate for blocks of size 2^( 7) =       0.000470153341

      target function =                  N/A
              le_mean =     -16.906872237772
             les_mean =     286.183609880803
             stat err =       0.000461496690
             autocorr =       1.248115646187
              std dev =       0.584192765365
             le_variance =       0.341281187105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341311539598
                                         uncertainty =       0.003482811346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341311539598
                                         uncertainty =       0.003482811346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413086666
  error estimate for blocks of size 2^( 2) =       0.000425867039
  error estimate for blocks of size 2^( 3) =       0.000438456838
  error estimate for blocks of size 2^( 4) =       0.000449798655
  error estimate for blocks of size 2^( 5) =       0.000459639764
  error estimate for blocks of size 2^( 6) =       0.000466394999
  error estimate for blocks of size 2^( 7) =       0.000470153341

      target function =                  N/A
              le_mean =     -16.906872237772
             les_mean =     286.183609880615
             stat err =       0.000461496690
             autocorr =       1.248115646424
              std dev =       0.584192765209
             le_variance =       0.341281186923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906872237772        initial
     9.7656e+05     9.7656e+06             4.2566e-10       -16.906872237772  <--
     3.9062e+06     3.9062e+07             1.0641e-10       -16.906872237772
     1.5625e+07     1.5625e+08             2.6604e-11       -16.906872237772

*****************************************************************************
Applying the update for shift_i =   9.7656e+05     and shift_s =   9.7656e+06
*****************************************************************************

  Execution time = 5.7652e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385767e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216313e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493470e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0892e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8809
    reference variance = 0.215862
====================================================
  Execution time = 4.0229e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3407e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0823e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334013512511
                                         uncertainty =       0.002781172084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334013512511
                                         uncertainty =       0.002781172084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408696698
  error estimate for blocks of size 2^( 2) =       0.000421650946
  error estimate for blocks of size 2^( 3) =       0.000434823448
  error estimate for blocks of size 2^( 4) =       0.000447091652
  error estimate for blocks of size 2^( 5) =       0.000459541286
  error estimate for blocks of size 2^( 6) =       0.000468434318
  error estimate for blocks of size 2^( 7) =       0.000474731432

      target function =                  N/A
              le_mean =     -16.906650032106
             les_mean =     286.168881122948
             stat err =       0.000462449672
             autocorr =       1.280344067079
              std dev =       0.577984413181
             le_variance =       0.334065981880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665003211e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906650032106       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906650032121       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906650032131       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906650032113       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906650032364       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906650032125       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906650032205       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906650032112       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906650032014       residual = 1.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.595119e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906650032106       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906650032110       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906650032112       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906650032112       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906650031855       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906650033271       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906650032187       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906650033278       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906650032435       residual = 1.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 3.987795e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906650032106       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906650032107       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906650032107       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906650032031       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906650030433       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906650031476       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906650032875       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906650031415       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906650033793       residual = 1.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 9.969502e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1061e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385767e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216313e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493470e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.0254
    reference variance = 0.322199
====================================================
  Execution time = 4.0620e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3859e-01
  Total weights = 2.0000e+06
  Execution time = 3.6550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338632545274
                                         uncertainty =       0.004812085734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338632545274
                                         uncertainty =       0.004812085734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411454321
  error estimate for blocks of size 2^( 2) =       0.000423951457
  error estimate for blocks of size 2^( 3) =       0.000436524056
  error estimate for blocks of size 2^( 4) =       0.000448644433
  error estimate for blocks of size 2^( 5) =       0.000458666328
  error estimate for blocks of size 2^( 6) =       0.000465436050
  error estimate for blocks of size 2^( 7) =       0.000471501207

      target function =                  N/A
              le_mean =     -16.906037092562
             les_mean =     286.152679322874
             stat err =       0.000461062004
             autocorr =       1.255669692884
              std dev =       0.581884281524
             le_variance =       0.338589317084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338632545556
                                         uncertainty =       0.004812085728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338632545556
                                         uncertainty =       0.004812085728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411454322
  error estimate for blocks of size 2^( 2) =       0.000423951457
  error estimate for blocks of size 2^( 3) =       0.000436524056
  error estimate for blocks of size 2^( 4) =       0.000448644433
  error estimate for blocks of size 2^( 5) =       0.000458666328
  error estimate for blocks of size 2^( 6) =       0.000465436050
  error estimate for blocks of size 2^( 7) =       0.000471501207

      target function =                  N/A
              le_mean =     -16.906037092565
             les_mean =     286.152679323248
             stat err =       0.000461062004
             autocorr =       1.255669691981
              std dev =       0.581884281766
             le_variance =       0.338589317366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338632545415
                                         uncertainty =       0.004812085731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338632545415
                                         uncertainty =       0.004812085731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411454321
  error estimate for blocks of size 2^( 2) =       0.000423951457
  error estimate for blocks of size 2^( 3) =       0.000436524056
  error estimate for blocks of size 2^( 4) =       0.000448644433
  error estimate for blocks of size 2^( 5) =       0.000458666328
  error estimate for blocks of size 2^( 6) =       0.000465436050
  error estimate for blocks of size 2^( 7) =       0.000471501207

      target function =                  N/A
              le_mean =     -16.906037092563
             les_mean =     286.152679323061
             stat err =       0.000461062004
             autocorr =       1.255669692444
              std dev =       0.581884281645
             le_variance =       0.338589317225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338632545292
                                         uncertainty =       0.004812085733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338632545292
                                         uncertainty =       0.004812085733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411454321
  error estimate for blocks of size 2^( 2) =       0.000423951457
  error estimate for blocks of size 2^( 3) =       0.000436524056
  error estimate for blocks of size 2^( 4) =       0.000448644433
  error estimate for blocks of size 2^( 5) =       0.000458666328
  error estimate for blocks of size 2^( 6) =       0.000465436050
  error estimate for blocks of size 2^( 7) =       0.000471501207

      target function =                  N/A
              le_mean =     -16.906037092562
             les_mean =     286.152679322897
             stat err =       0.000461062004
             autocorr =       1.255669692830
              std dev =       0.581884281539
             le_variance =       0.338589317102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906037092562        initial
     2.4414e+05     2.4414e+06             1.5951e-09       -16.906037092565  <--
     9.7656e+05     9.7656e+06             3.9878e-10       -16.906037092563
     3.9062e+06     3.9062e+07             9.9695e-11       -16.906037092562

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 5.9018e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385768e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216313e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493470e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1008e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9342
    reference variance = 0.199568
====================================================
  Execution time = 4.1682e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3850e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0674e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338641305838
                                         uncertainty =       0.004751561566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338641305838
                                         uncertainty =       0.004751561566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411397931
  error estimate for blocks of size 2^( 2) =       0.000424151600
  error estimate for blocks of size 2^( 3) =       0.000437660462
  error estimate for blocks of size 2^( 4) =       0.000450364897
  error estimate for blocks of size 2^( 5) =       0.000460259768
  error estimate for blocks of size 2^( 6) =       0.000468453897
  error estimate for blocks of size 2^( 7) =       0.000473309016

      target function =                  N/A
              le_mean =     -16.905815967144
             les_mean =     286.145109861455
             stat err =       0.000463096894
             autocorr =       1.267125205873
              std dev =       0.581804533972
             le_variance =       0.338496515751


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581596714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905815967144       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905815967188       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905815967212       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905815967203       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905815967209       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905815967197       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905815967195       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905815967245       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905815967251       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 6.825279e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905815967144       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905815967155       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905815967161       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905815967052       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905815967180       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905815967160       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905815967159       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905815967148       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905815967150       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.706321e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905815967144       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905815967147       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905815967149       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905815967149       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905815967148       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905815966928       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905815966521       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905815967265       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905815966686       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 4.265802e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165094 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2364e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385769e-03 1 1  ON 13
 ud_4                -6.473825e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216314e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778668e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493471e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9521
    reference variance = 0.488619
====================================================
  Execution time = 3.8961e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3999e-01
  Total weights = 2.0000e+06
  Execution time = 3.6743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339920744897
                                         uncertainty =       0.005980634755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339920744897
                                         uncertainty =       0.005980634755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412303356
  error estimate for blocks of size 2^( 2) =       0.000424942193
  error estimate for blocks of size 2^( 3) =       0.000437083279
  error estimate for blocks of size 2^( 4) =       0.000448577730
  error estimate for blocks of size 2^( 5) =       0.000458135483
  error estimate for blocks of size 2^( 6) =       0.000464959202
  error estimate for blocks of size 2^( 7) =       0.000469682267

      target function =                  N/A
              le_mean =     -16.905708576712
             les_mean =     286.142970425946
             stat err =       0.000460338670
             autocorr =       1.246582935424
              std dev =       0.583084998299
             le_variance =       0.339988115241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339920749868
                                         uncertainty =       0.005980634805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339920749868
                                         uncertainty =       0.005980634805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412303359
  error estimate for blocks of size 2^( 2) =       0.000424942196
  error estimate for blocks of size 2^( 3) =       0.000437083281
  error estimate for blocks of size 2^( 4) =       0.000448577732
  error estimate for blocks of size 2^( 5) =       0.000458135485
  error estimate for blocks of size 2^( 6) =       0.000464959204
  error estimate for blocks of size 2^( 7) =       0.000469682269

      target function =                  N/A
              le_mean =     -16.905708576712
             les_mean =     286.142970430918
             stat err =       0.000460338672
             autocorr =       1.246582928797
              std dev =       0.583085002559
             le_variance =       0.339988120209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339920747382
                                         uncertainty =       0.005980634780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339920747382
                                         uncertainty =       0.005980634780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412303358
  error estimate for blocks of size 2^( 2) =       0.000424942194
  error estimate for blocks of size 2^( 3) =       0.000437083280
  error estimate for blocks of size 2^( 4) =       0.000448577731
  error estimate for blocks of size 2^( 5) =       0.000458135484
  error estimate for blocks of size 2^( 6) =       0.000464959203
  error estimate for blocks of size 2^( 7) =       0.000469682268

      target function =                  N/A
              le_mean =     -16.905708576712
             les_mean =     286.142970428432
             stat err =       0.000460338671
             autocorr =       1.246582932108
              std dev =       0.583085000429
             le_variance =       0.339988117725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339920745207
                                         uncertainty =       0.005980634758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339920745207
                                         uncertainty =       0.005980634758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412303356
  error estimate for blocks of size 2^( 2) =       0.000424942193
  error estimate for blocks of size 2^( 3) =       0.000437083279
  error estimate for blocks of size 2^( 4) =       0.000448577730
  error estimate for blocks of size 2^( 5) =       0.000458135483
  error estimate for blocks of size 2^( 6) =       0.000464959202
  error estimate for blocks of size 2^( 7) =       0.000469682267

      target function =                  N/A
              le_mean =     -16.905708576712
             les_mean =     286.142970426257
             stat err =       0.000460338670
             autocorr =       1.246582935011
              std dev =       0.583084998565
             le_variance =       0.339988115552


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905708576712        initial
     6.1035e+04     6.1035e+05             6.8253e-09       -16.905708576712  <--
     2.4414e+05     2.4414e+06             1.7063e-09       -16.905708576712
     9.7656e+05     9.7656e+06             4.2658e-10       -16.905708576712

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 5.7468e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385772e-03 1 1  ON 13
 ud_4                -6.473826e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636844e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216315e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778669e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254878e-02 1 1  ON 43
eH2_4                 5.493473e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729437e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0984e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9078
    reference variance = 0.314023
====================================================
  Execution time = 4.0172e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4068e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0643e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340654307929
                                         uncertainty =       0.004269435133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340654307929
                                         uncertainty =       0.004269435133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412721445
  error estimate for blocks of size 2^( 2) =       0.000424932540
  error estimate for blocks of size 2^( 3) =       0.000438276892
  error estimate for blocks of size 2^( 4) =       0.000450150865
  error estimate for blocks of size 2^( 5) =       0.000458740015
  error estimate for blocks of size 2^( 6) =       0.000464811303
  error estimate for blocks of size 2^( 7) =       0.000469015962

      target function =                  N/A
              le_mean =     -16.906410063061
             les_mean =     286.167379032313
             stat err =       0.000460679536
             autocorr =       1.245901679291
              std dev =       0.583676264976
             le_variance =       0.340677982296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641006306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410063061       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410063203       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906410063280       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906410063345       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906410063299       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906410063283       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906410063316       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906410063309       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.718196e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410063061       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410063096       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906410063116       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906410063132       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906410063121       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906410063096       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906410063015       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906410063021       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 6.795509e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906410063061       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906410063069       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906410063074       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906410063179       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906410063129       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906410063090       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906410063165       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906410063073       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.698878e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0823e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412892e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293633e-02 1 1  ON 12
 ud_3                -7.385775e-03 1 1  ON 13
 ud_4                -6.473826e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636845e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216317e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778669e-02 1 1  ON 39
eH2_0                -2.419092e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656704e-02 1 1  ON 42
eH2_3                -4.254877e-02 1 1  ON 43
eH2_4                 5.493476e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729437e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8315
    reference variance = 0.296144
====================================================
  Execution time = 3.9098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3881e-01
  Total weights = 2.0000e+06
  Execution time = 3.6957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338879172851
                                         uncertainty =       0.004815625737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338879172851
                                         uncertainty =       0.004815625737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411589249
  error estimate for blocks of size 2^( 2) =       0.000424688931
  error estimate for blocks of size 2^( 3) =       0.000437823198
  error estimate for blocks of size 2^( 4) =       0.000449950437
  error estimate for blocks of size 2^( 5) =       0.000459915970
  error estimate for blocks of size 2^( 6) =       0.000467377292
  error estimate for blocks of size 2^( 7) =       0.000471890559

      target function =                  N/A
              le_mean =     -16.906377061392
             les_mean =     286.164396591581
             stat err =       0.000462283564
             autocorr =       1.261504671532
              std dev =       0.582075097405
             le_variance =       0.338811419019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338879188733
                                         uncertainty =       0.004815626557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338879188733
                                         uncertainty =       0.004815626557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411589258
  error estimate for blocks of size 2^( 2) =       0.000424688940
  error estimate for blocks of size 2^( 3) =       0.000437823206
  error estimate for blocks of size 2^( 4) =       0.000449950444
  error estimate for blocks of size 2^( 5) =       0.000459915976
  error estimate for blocks of size 2^( 6) =       0.000467377298
  error estimate for blocks of size 2^( 7) =       0.000471890565

      target function =                  N/A
              le_mean =     -16.906377061411
             les_mean =     286.164396608093
             stat err =       0.000462283570
             autocorr =       1.261504645082
              std dev =       0.582075111048
             le_variance =       0.338811434901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338879180792
                                         uncertainty =       0.004815626147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338879180792
                                         uncertainty =       0.004815626147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411589253
  error estimate for blocks of size 2^( 2) =       0.000424688936
  error estimate for blocks of size 2^( 3) =       0.000437823202
  error estimate for blocks of size 2^( 4) =       0.000449950440
  error estimate for blocks of size 2^( 5) =       0.000459915973
  error estimate for blocks of size 2^( 6) =       0.000467377295
  error estimate for blocks of size 2^( 7) =       0.000471890562

      target function =                  N/A
              le_mean =     -16.906377061401
             les_mean =     286.164396599837
             stat err =       0.000462283567
             autocorr =       1.261504658299
              std dev =       0.582075104226
             le_variance =       0.338811426960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338879173844
                                         uncertainty =       0.004815625788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338879173844
                                         uncertainty =       0.004815625788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411589249
  error estimate for blocks of size 2^( 2) =       0.000424688932
  error estimate for blocks of size 2^( 3) =       0.000437823198
  error estimate for blocks of size 2^( 4) =       0.000449950438
  error estimate for blocks of size 2^( 5) =       0.000459915970
  error estimate for blocks of size 2^( 6) =       0.000467377292
  error estimate for blocks of size 2^( 7) =       0.000471890560

      target function =                  N/A
              le_mean =     -16.906377061393
             les_mean =     286.164396592613
             stat err =       0.000462283565
             autocorr =       1.261504669881
              std dev =       0.582075098258
             le_variance =       0.338811420012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906377061392        initial
     1.5259e+04     1.5259e+05             2.7182e-08       -16.906377061411  <--
     6.1035e+04     6.1035e+05             6.7955e-09       -16.906377061401
     2.4414e+05     2.4414e+06             1.6989e-09       -16.906377061393

*****************************************************************************
Applying the update for shift_i =   1.5259e+04     and shift_s =   1.5259e+05
*****************************************************************************

  Execution time = 5.7736e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660631e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412893e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474493e-01 1 1  ON 10
 ud_1                 1.822367e-01 1 1  ON 11
 ud_2                 6.293632e-02 1 1  ON 12
 ud_3                -7.385784e-03 1 1  ON 13
 ud_4                -6.473826e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636845e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492209e-02 1 1  ON 33
eH1_4                 3.216322e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663808e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778670e-02 1 1  ON 39
eH2_0                -2.419093e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656703e-02 1 1  ON 42
eH2_3                -4.254876e-02 1 1  ON 43
eH2_4                 5.493485e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729438e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0856e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8709
    reference variance = 0.316081
====================================================
  Execution time = 3.9675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5965e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0791e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359595995873
                                         uncertainty =       0.012259831272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359595995873
                                         uncertainty =       0.012259831272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424057402
  error estimate for blocks of size 2^( 2) =       0.000436719280
  error estimate for blocks of size 2^( 3) =       0.000449738315
  error estimate for blocks of size 2^( 4) =       0.000461891352
  error estimate for blocks of size 2^( 5) =       0.000472918508
  error estimate for blocks of size 2^( 6) =       0.000481345500
  error estimate for blocks of size 2^( 7) =       0.000487257502

      target function =                  N/A
              le_mean =     -16.905491930250
             les_mean =     286.155306583856
             stat err =       0.000475853215
             autocorr =       1.259205814414
              std dev =       0.599707728761
             le_variance =       0.359649359935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690549193025e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905491930250       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905491931126       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905491931448       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905491931625       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905491931691       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905491931798       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905491931800       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905491931771       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.003329e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905491930250       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905491930469       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905491930549       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905491930594       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905491930610       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905491930643       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905491930660       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905491930636       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.508345e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905491930250       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905491930305       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905491930325       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905491930336       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905491930291       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905491930371       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905491930373       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905491930351       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 6.270875e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170271 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0474e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423700e-01 1 1  ON 1
 uu_2                 4.097111e-02 1 1  ON 2
 uu_3                -2.136732e-02 1 1  ON 3
 uu_4                -6.660630e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412893e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474494e-01 1 1  ON 10
 ud_1                 1.822368e-01 1 1  ON 11
 ud_2                 6.293632e-02 1 1  ON 12
 ud_3                -7.385798e-03 1 1  ON 13
 ud_4                -6.473826e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985443e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636846e-02 1 1  ON 29
eH1_0                -2.442384e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492209e-02 1 1  ON 33
eH1_4                 3.216325e-03 1 1  ON 34
eH1_5                 3.812793e-02 1 1  ON 35
eH1_6                 9.663808e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778671e-02 1 1  ON 39
eH2_0                -2.419093e-01 1 1  ON 40
eH2_1                -1.428419e-01 1 1  ON 41
eH2_2                -9.656702e-02 1 1  ON 42
eH2_3                -4.254876e-02 1 1  ON 43
eH2_4                 5.493486e-03 1 1  ON 44
eH2_5                 4.023459e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8951
    reference variance = 0.224508
====================================================
  Execution time = 4.4245e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3574e-01
  Total weights = 2.0000e+06
  Execution time = 3.6929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335850585858
                                         uncertainty =       0.003155881161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335850585858
                                         uncertainty =       0.003155881161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409718998
  error estimate for blocks of size 2^( 2) =       0.000422650279
  error estimate for blocks of size 2^( 3) =       0.000434936753
  error estimate for blocks of size 2^( 4) =       0.000447727885
  error estimate for blocks of size 2^( 5) =       0.000458208711
  error estimate for blocks of size 2^( 6) =       0.000467263748
  error estimate for blocks of size 2^( 7) =       0.000470607194

      target function =                  N/A
              le_mean =     -16.906077486538
             les_mean =     286.151195126850
             stat err =       0.000460951885
             autocorr =       1.265723918181
              std dev =       0.579430163091
             le_variance =       0.335739313899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335850585088
                                         uncertainty =       0.003155880993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335850585088
                                         uncertainty =       0.003155880993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409718997
  error estimate for blocks of size 2^( 2) =       0.000422650276
  error estimate for blocks of size 2^( 3) =       0.000434936749
  error estimate for blocks of size 2^( 4) =       0.000447727878
  error estimate for blocks of size 2^( 5) =       0.000458208703
  error estimate for blocks of size 2^( 6) =       0.000467263740
  error estimate for blocks of size 2^( 7) =       0.000470607182

      target function =                  N/A
              le_mean =     -16.906077486587
             les_mean =     286.151195127760
             stat err =       0.000460951876
             autocorr =       1.265723873802
              std dev =       0.579430162436
             le_variance =       0.335739313141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335850585471
                                         uncertainty =       0.003155881077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335850585471
                                         uncertainty =       0.003155881077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409718997
  error estimate for blocks of size 2^( 2) =       0.000422650278
  error estimate for blocks of size 2^( 3) =       0.000434936751
  error estimate for blocks of size 2^( 4) =       0.000447727882
  error estimate for blocks of size 2^( 5) =       0.000458208707
  error estimate for blocks of size 2^( 6) =       0.000467263744
  error estimate for blocks of size 2^( 7) =       0.000470607188

      target function =                  N/A
              le_mean =     -16.906077486562
             les_mean =     286.151195127303
             stat err =       0.000460951880
             autocorr =       1.265723895984
              std dev =       0.579430162762
             le_variance =       0.335739313518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335850585810
                                         uncertainty =       0.003155881151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335850585810
                                         uncertainty =       0.003155881151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409718998
  error estimate for blocks of size 2^( 2) =       0.000422650279
  error estimate for blocks of size 2^( 3) =       0.000434936753
  error estimate for blocks of size 2^( 4) =       0.000447727885
  error estimate for blocks of size 2^( 5) =       0.000458208711
  error estimate for blocks of size 2^( 6) =       0.000467263747
  error estimate for blocks of size 2^( 7) =       0.000470607194

      target function =                  N/A
              le_mean =     -16.906077486541
             les_mean =     286.151195126907
             stat err =       0.000460951884
             autocorr =       1.265723915396
              std dev =       0.579430163049
             le_variance =       0.335739313852


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906077486538        initial
     3.8147e+03     3.8147e+04             1.0033e-07       -16.906077486587  <--
     1.5259e+04     1.5259e+05             2.5083e-08       -16.906077486562
     6.1035e+04     6.1035e+05             6.2709e-09       -16.906077486541

*****************************************************************************
Applying the update for shift_i =   3.8147e+03     and shift_s =   3.8147e+04
*****************************************************************************

  Execution time = 6.2837e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423701e-01 1 1  ON 1
 uu_2                 4.097110e-02 1 1  ON 2
 uu_3                -2.136733e-02 1 1  ON 3
 uu_4                -6.660630e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412893e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474494e-01 1 1  ON 10
 ud_1                 1.822368e-01 1 1  ON 11
 ud_2                 6.293632e-02 1 1  ON 12
 ud_3                -7.385841e-03 1 1  ON 13
 ud_4                -6.473829e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599172e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176166e-02 1 1  ON 22
 eO_3                 2.985444e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213121e-01 1 1  ON 28
 eO_9                -8.636849e-02 1 1  ON 29
eH1_0                -2.442385e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867221e-02 1 1  ON 32
eH1_3                -4.492209e-02 1 1  ON 33
eH1_4                 3.216333e-03 1 1  ON 34
eH1_5                 3.812794e-02 1 1  ON 35
eH1_6                 9.663807e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778675e-02 1 1  ON 39
eH2_0                -2.419094e-01 1 1  ON 40
eH2_1                -1.428420e-01 1 1  ON 41
eH2_2                -9.656700e-02 1 1  ON 42
eH2_3                -4.254874e-02 1 1  ON 43
eH2_4                 5.493491e-03 1 1  ON 44
eH2_5                 4.023461e-02 1 1  ON 45
eH2_6                 9.949989e-02 1 1  ON 46
eH2_7                 1.552622e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729443e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1332e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9979
    reference variance = 0.59953
====================================================
  Execution time = 3.9878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4715e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0727e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347179333274
                                         uncertainty =       0.006617693691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347179333274
                                         uncertainty =       0.006617693691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416620565
  error estimate for blocks of size 2^( 2) =       0.000429207524
  error estimate for blocks of size 2^( 3) =       0.000442135399
  error estimate for blocks of size 2^( 4) =       0.000454934804
  error estimate for blocks of size 2^( 5) =       0.000465410271
  error estimate for blocks of size 2^( 6) =       0.000472427147
  error estimate for blocks of size 2^( 7) =       0.000475398533

      target function =                  N/A
              le_mean =     -16.906219138352
             les_mean =     286.167390770086
             stat err =       0.000467042689
             autocorr =       1.256700389553
              std dev =       0.589190452815
             le_variance =       0.347145389689


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621913835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906219138352       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906219144124       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906219145491       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906219145190       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906219145494       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906219145645       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906219145583       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906219145647       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 4.284911e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906219138352       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906219139795       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906219140137       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906219140064       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906219140138       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906219140173       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906219140160       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906219140177       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.071281e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906219138352       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906219138713       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906219138798       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906219138779       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906219138799       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906219138750       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906219138815       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906219138818       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.678237e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0613e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423701e-01 1 1  ON 1
 uu_2                 4.097112e-02 1 1  ON 2
 uu_3                -2.136734e-02 1 1  ON 3
 uu_4                -6.660628e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283846e-01 1 1  ON 6
 uu_7                -1.412893e-01 1 1  ON 7
 uu_8                -1.332637e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474495e-01 1 1  ON 10
 ud_1                 1.822369e-01 1 1  ON 11
 ud_2                 6.293632e-02 1 1  ON 12
 ud_3                -7.385910e-03 1 1  ON 13
 ud_4                -6.473832e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529388e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599173e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176165e-02 1 1  ON 22
 eO_3                 2.985444e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074798e-02 1 1  ON 27
 eO_8                -2.213122e-01 1 1  ON 28
 eO_9                -8.636852e-02 1 1  ON 29
eH1_0                -2.442386e-01 1 1  ON 30
eH1_1                -1.451632e-01 1 1  ON 31
eH1_2                -9.867220e-02 1 1  ON 32
eH1_3                -4.492210e-02 1 1  ON 33
eH1_4                 3.216360e-03 1 1  ON 34
eH1_5                 3.812797e-02 1 1  ON 35
eH1_6                 9.663809e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771022e-01 1 1  ON 38
eH1_9                 6.778678e-02 1 1  ON 39
eH2_0                -2.419094e-01 1 1  ON 40
eH2_1                -1.428420e-01 1 1  ON 41
eH2_2                -9.656698e-02 1 1  ON 42
eH2_3                -4.254876e-02 1 1  ON 43
eH2_4                 5.493507e-03 1 1  ON 44
eH2_5                 4.023458e-02 1 1  ON 45
eH2_6                 9.949986e-02 1 1  ON 46
eH2_7                 1.552622e-01 1 1  ON 47
eH2_8                 1.826578e-01 1 1  ON 48
eH2_9                 5.729449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1085
    reference variance = 1.92231
====================================================
  Execution time = 3.9252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4018e-01
  Total weights = 2.0000e+06
  Execution time = 3.7111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340100683142
                                         uncertainty =       0.003746519943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340100683142
                                         uncertainty =       0.003746519943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412421816
  error estimate for blocks of size 2^( 2) =       0.000425064790
  error estimate for blocks of size 2^( 3) =       0.000437993396
  error estimate for blocks of size 2^( 4) =       0.000450392388
  error estimate for blocks of size 2^( 5) =       0.000460726581
  error estimate for blocks of size 2^( 6) =       0.000468621028
  error estimate for blocks of size 2^( 7) =       0.000474194318

      target function =                  N/A
              le_mean =     -16.905842055951
             les_mean =     286.147678959464
             stat err =       0.000463483579
             autocorr =       1.262947922251
              std dev =       0.583252525746
             le_variance =       0.340183508790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340100845063
                                         uncertainty =       0.003746522370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340100845063
                                         uncertainty =       0.003746522370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412421914
  error estimate for blocks of size 2^( 2) =       0.000425064874
  error estimate for blocks of size 2^( 3) =       0.000437993466
  error estimate for blocks of size 2^( 4) =       0.000450392446
  error estimate for blocks of size 2^( 5) =       0.000460726632
  error estimate for blocks of size 2^( 6) =       0.000468621083
  error estimate for blocks of size 2^( 7) =       0.000474194362

      target function =                  N/A
              le_mean =     -16.905842057623
             les_mean =     286.147679178239
             stat err =       0.000463483631
             autocorr =       1.262947603812
              std dev =       0.583252664846
             le_variance =       0.340183671050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340100764091
                                         uncertainty =       0.003746521156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340100764091
                                         uncertainty =       0.003746521156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412421865
  error estimate for blocks of size 2^( 2) =       0.000425064832
  error estimate for blocks of size 2^( 3) =       0.000437993431
  error estimate for blocks of size 2^( 4) =       0.000450392417
  error estimate for blocks of size 2^( 5) =       0.000460726607
  error estimate for blocks of size 2^( 6) =       0.000468621056
  error estimate for blocks of size 2^( 7) =       0.000474194340

      target function =                  N/A
              le_mean =     -16.905842056787
             les_mean =     286.147679068843
             stat err =       0.000463483605
             autocorr =       1.262947763016
              std dev =       0.583252595287
             le_variance =       0.340183589909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340100693260
                                         uncertainty =       0.003746520094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340100693260
                                         uncertainty =       0.003746520094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412421822
  error estimate for blocks of size 2^( 2) =       0.000425064796
  error estimate for blocks of size 2^( 3) =       0.000437993400
  error estimate for blocks of size 2^( 4) =       0.000450392392
  error estimate for blocks of size 2^( 5) =       0.000460726585
  error estimate for blocks of size 2^( 6) =       0.000468621031
  error estimate for blocks of size 2^( 7) =       0.000474194320

      target function =                  N/A
              le_mean =     -16.905842056056
             les_mean =     286.147678973135
             stat err =       0.000463483582
             autocorr =       1.262947902348
              std dev =       0.583252534439
             le_variance =       0.340183518929


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905842055951        initial
     9.5367e+02     9.5367e+03             4.2849e-07       -16.905842057623  <--
     3.8147e+03     3.8147e+04             1.0713e-07       -16.905842056787
     1.5259e+04     1.5259e+05             2.6782e-08       -16.905842056056

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 5.7913e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423701e-01 1 1  ON 1
 uu_2                 4.097116e-02 1 1  ON 2
 uu_3                -2.136739e-02 1 1  ON 3
 uu_4                -6.660621e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283847e-01 1 1  ON 6
 uu_7                -1.412893e-01 1 1  ON 7
 uu_8                -1.332638e-01 1 1  ON 8
 uu_9                -1.049642e-01 1 1  ON 9
 ud_0                 4.474497e-01 1 1  ON 10
 ud_1                 1.822371e-01 1 1  ON 11
 ud_2                 6.293630e-02 1 1  ON 12
 ud_3                -7.386117e-03 1 1  ON 13
 ud_4                -6.473839e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349440e-01 1 1  ON 16
 ud_7                -1.520048e-01 1 1  ON 17
 ud_8                -1.529389e-01 1 1  ON 18
 ud_9                -1.433440e-01 1 1  ON 19
 eO_0                -7.599173e-01 1 1  ON 20
 eO_1                -4.401006e-01 1 1  ON 21
 eO_2                -2.176161e-02 1 1  ON 22
 eO_3                 2.985445e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599362e-01 1 1  ON 26
 eO_7                -4.074799e-02 1 1  ON 27
 eO_8                -2.213122e-01 1 1  ON 28
 eO_9                -8.636860e-02 1 1  ON 29
eH1_0                -2.442389e-01 1 1  ON 30
eH1_1                -1.451633e-01 1 1  ON 31
eH1_2                -9.867219e-02 1 1  ON 32
eH1_3                -4.492214e-02 1 1  ON 33
eH1_4                 3.216440e-03 1 1  ON 34
eH1_5                 3.812808e-02 1 1  ON 35
eH1_6                 9.663815e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771023e-01 1 1  ON 38
eH1_9                 6.778688e-02 1 1  ON 39
eH2_0                -2.419096e-01 1 1  ON 40
eH2_1                -1.428420e-01 1 1  ON 41
eH2_2                -9.656692e-02 1 1  ON 42
eH2_3                -4.254881e-02 1 1  ON 43
eH2_4                 5.493555e-03 1 1  ON 44
eH2_5                 4.023448e-02 1 1  ON 45
eH2_6                 9.949979e-02 1 1  ON 46
eH2_7                 1.552622e-01 1 1  ON 47
eH2_8                 1.826579e-01 1 1  ON 48
eH2_9                 5.729466e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0856e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9066
    reference variance = 0.427233
====================================================
  Execution time = 3.9222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4442e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0968e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344333098210
                                         uncertainty =       0.005347025535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344333098210
                                         uncertainty =       0.005347025535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414981150
  error estimate for blocks of size 2^( 2) =       0.000427808232
  error estimate for blocks of size 2^( 3) =       0.000440523170
  error estimate for blocks of size 2^( 4) =       0.000452698287
  error estimate for blocks of size 2^( 5) =       0.000462511807
  error estimate for blocks of size 2^( 6) =       0.000468896849
  error estimate for blocks of size 2^( 7) =       0.000477398948

      target function =                  N/A
              le_mean =     -16.906204096651
             les_mean =     286.164155495398
             stat err =       0.000465376473
             autocorr =       1.257627736378
              std dev =       0.586871970702
             le_variance =       0.344418709995


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620409665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204096651       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204115125       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906204117622       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906204119782       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906204121450       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906204122454       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906204122767       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906204122385       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.730085e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204096651       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204101272       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906204101897       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906204102437       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906204102855       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906204103106       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906204103185       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906204103089       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 4.325790e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204096651       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204097806       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906204097963       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906204098098       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906204098201       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906204098266       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906204098283       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906204098260       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.081483e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0198e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.091643e-01 1 1  ON 0
 uu_1                 1.423702e-01 1 1  ON 1
 uu_2                 4.097124e-02 1 1  ON 2
 uu_3                -2.136752e-02 1 1  ON 3
 uu_4                -6.660620e-02 1 1  ON 4
 uu_5                -1.014595e-01 1 1  ON 5
 uu_6                -1.283847e-01 1 1  ON 6
 uu_7                -1.412895e-01 1 1  ON 7
 uu_8                -1.332639e-01 1 1  ON 8
 uu_9                -1.049643e-01 1 1  ON 9
 ud_0                 4.474498e-01 1 1  ON 10
 ud_1                 1.822373e-01 1 1  ON 11
 ud_2                 6.293639e-02 1 1  ON 12
 ud_3                -7.386293e-03 1 1  ON 13
 ud_4                -6.473837e-02 1 1  ON 14
 ud_5                -1.068962e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520047e-01 1 1  ON 17
 ud_8                -1.529390e-01 1 1  ON 18
 ud_9                -1.433441e-01 1 1  ON 19
 eO_0                -7.599173e-01 1 1  ON 20
 eO_1                -4.401006e-01 1 1  ON 21
 eO_2                -2.176164e-02 1 1  ON 22
 eO_3                 2.985446e-01 1 1  ON 23
 eO_4                 5.253743e-01 1 1  ON 24
 eO_5                 4.877356e-01 1 1  ON 25
 eO_6                 2.599363e-01 1 1  ON 26
 eO_7                -4.074794e-02 1 1  ON 27
 eO_8                -2.213124e-01 1 1  ON 28
 eO_9                -8.636875e-02 1 1  ON 29
eH1_0                -2.442394e-01 1 1  ON 30
eH1_1                -1.451634e-01 1 1  ON 31
eH1_2                -9.867208e-02 1 1  ON 32
eH1_3                -4.492199e-02 1 1  ON 33
eH1_4                 3.216608e-03 1 1  ON 34
eH1_5                 3.812803e-02 1 1  ON 35
eH1_6                 9.663812e-02 1 1  ON 36
eH1_7                 1.541370e-01 1 1  ON 37
eH1_8                 1.771024e-01 1 1  ON 38
eH1_9                 6.778701e-02 1 1  ON 39
eH2_0                -2.419100e-01 1 1  ON 40
eH2_1                -1.428423e-01 1 1  ON 41
eH2_2                -9.656676e-02 1 1  ON 42
eH2_3                -4.254876e-02 1 1  ON 43
eH2_4                 5.493734e-03 1 1  ON 44
eH2_5                 4.023438e-02 1 1  ON 45
eH2_6                 9.949975e-02 1 1  ON 46
eH2_7                 1.552622e-01 1 1  ON 47
eH2_8                 1.826581e-01 1 1  ON 48
eH2_9                 5.729489e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8951
    reference variance = 0.199658
====================================================
  Execution time = 3.9229e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3419e-01
  Total weights = 2.0000e+06
  Execution time = 3.6955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334285763033
                                         uncertainty =       0.003556998901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334285763033
                                         uncertainty =       0.003556998901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408771744
  error estimate for blocks of size 2^( 2) =       0.000421665488
  error estimate for blocks of size 2^( 3) =       0.000433860696
  error estimate for blocks of size 2^( 4) =       0.000444979888
  error estimate for blocks of size 2^( 5) =       0.000454151982
  error estimate for blocks of size 2^( 6) =       0.000461792544
  error estimate for blocks of size 2^( 7) =       0.000464824792

      target function =                  N/A
              le_mean =     -16.905379864979
             les_mean =     286.126056889935
             stat err =       0.000456437302
             autocorr =       1.246810704262
              std dev =       0.578090544625
             le_variance =       0.334188677785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334285465437
                                         uncertainty =       0.003557001109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334285465437
                                         uncertainty =       0.003557001109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408771562
  error estimate for blocks of size 2^( 2) =       0.000421665286
  error estimate for blocks of size 2^( 3) =       0.000433860463
  error estimate for blocks of size 2^( 4) =       0.000444979633
  error estimate for blocks of size 2^( 5) =       0.000454151713
  error estimate for blocks of size 2^( 6) =       0.000461792288
  error estimate for blocks of size 2^( 7) =       0.000464824560

      target function =                  N/A
              le_mean =     -16.905379867091
             les_mean =     286.126056663754
             stat err =       0.000456437049
             autocorr =       1.246810432252
              std dev =       0.578090287255
             le_variance =       0.334188380219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334285613646
                                         uncertainty =       0.003557000001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334285613646
                                         uncertainty =       0.003557000001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408771653
  error estimate for blocks of size 2^( 2) =       0.000421665387
  error estimate for blocks of size 2^( 3) =       0.000433860579
  error estimate for blocks of size 2^( 4) =       0.000444979760
  error estimate for blocks of size 2^( 5) =       0.000454151847
  error estimate for blocks of size 2^( 6) =       0.000461792416
  error estimate for blocks of size 2^( 7) =       0.000464824676

      target function =                  N/A
              le_mean =     -16.905379866034
             les_mean =     286.126056776212
             stat err =       0.000456437175
             autocorr =       1.246810568554
              std dev =       0.578090415431
             le_variance =       0.334188528413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334285744340
                                         uncertainty =       0.003556999039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334285744340
                                         uncertainty =       0.003556999039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408771733
  error estimate for blocks of size 2^( 2) =       0.000421665475
  error estimate for blocks of size 2^( 3) =       0.000433860682
  error estimate for blocks of size 2^( 4) =       0.000444979872
  error estimate for blocks of size 2^( 5) =       0.000454151965
  error estimate for blocks of size 2^( 6) =       0.000461792528
  error estimate for blocks of size 2^( 7) =       0.000464824777

      target function =                  N/A
              le_mean =     -16.905379865111
             les_mean =     286.126056875688
             stat err =       0.000456437286
             autocorr =       1.246810687308
              std dev =       0.578090528459
             le_variance =       0.334188659094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905379864979        initial
     2.3842e+02     2.3842e+03             1.7301e-06       -16.905379867091  <--
     9.5367e+02     9.5367e+03             4.3258e-07       -16.905379866034
     3.8147e+03     3.8147e+04             1.0815e-07       -16.905379865111

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 5.7822e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.091646e-01 1 1  ON 0
 uu_1                 1.423704e-01 1 1  ON 1
 uu_2                 4.097147e-02 1 1  ON 2
 uu_3                -2.136790e-02 1 1  ON 3
 uu_4                -6.660618e-02 1 1  ON 4
 uu_5                -1.014591e-01 1 1  ON 5
 uu_6                -1.283848e-01 1 1  ON 6
 uu_7                -1.412900e-01 1 1  ON 7
 uu_8                -1.332643e-01 1 1  ON 8
 uu_9                -1.049645e-01 1 1  ON 9
 ud_0                 4.474502e-01 1 1  ON 10
 ud_1                 1.822381e-01 1 1  ON 11
 ud_2                 6.293664e-02 1 1  ON 12
 ud_3                -7.386822e-03 1 1  ON 13
 ud_4                -6.473831e-02 1 1  ON 14
 ud_5                -1.068964e-01 1 1  ON 15
 ud_6                -1.349439e-01 1 1  ON 16
 ud_7                -1.520045e-01 1 1  ON 17
 ud_8                -1.529394e-01 1 1  ON 18
 ud_9                -1.433445e-01 1 1  ON 19
 eO_0                -7.599170e-01 1 1  ON 20
 eO_1                -4.401007e-01 1 1  ON 21
 eO_2                -2.176173e-02 1 1  ON 22
 eO_3                 2.985449e-01 1 1  ON 23
 eO_4                 5.253742e-01 1 1  ON 24
 eO_5                 4.877358e-01 1 1  ON 25
 eO_6                 2.599366e-01 1 1  ON 26
 eO_7                -4.074777e-02 1 1  ON 27
 eO_8                -2.213128e-01 1 1  ON 28
 eO_9                -8.636922e-02 1 1  ON 29
eH1_0                -2.442406e-01 1 1  ON 30
eH1_1                -1.451637e-01 1 1  ON 31
eH1_2                -9.867178e-02 1 1  ON 32
eH1_3                -4.492152e-02 1 1  ON 33
eH1_4                 3.217111e-03 1 1  ON 34
eH1_5                 3.812791e-02 1 1  ON 35
eH1_6                 9.663805e-02 1 1  ON 36
eH1_7                 1.541369e-01 1 1  ON 37
eH1_8                 1.771027e-01 1 1  ON 38
eH1_9                 6.778739e-02 1 1  ON 39
eH2_0                -2.419113e-01 1 1  ON 40
eH2_1                -1.428430e-01 1 1  ON 41
eH2_2                -9.656629e-02 1 1  ON 42
eH2_3                -4.254861e-02 1 1  ON 43
eH2_4                 5.494273e-03 1 1  ON 44
eH2_5                 4.023407e-02 1 1  ON 45
eH2_6                 9.949964e-02 1 1  ON 46
eH2_7                 1.552622e-01 1 1  ON 47
eH2_8                 1.826587e-01 1 1  ON 48
eH2_9                 5.729558e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0803e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8944
    reference variance = 0.251307
====================================================
  Execution time = 4.1317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4077e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0614e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340782670965
                                         uncertainty =       0.006584031158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340782670965
                                         uncertainty =       0.006584031158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412775023
  error estimate for blocks of size 2^( 2) =       0.000425124491
  error estimate for blocks of size 2^( 3) =       0.000437613141
  error estimate for blocks of size 2^( 4) =       0.000449702050
  error estimate for blocks of size 2^( 5) =       0.000459186697
  error estimate for blocks of size 2^( 6) =       0.000466280503
  error estimate for blocks of size 2^( 7) =       0.000469676257

      target function =                  N/A
              le_mean =     -16.906999724302
             les_mean =     286.187405946117
             stat err =       0.000461211377
             autocorr =       1.248455892158
              std dev =       0.583752035488
             le_variance =       0.340766438936


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690699972430e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906999724302       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906999808676       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906999800166       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906999795665       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906999798079       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906999807824       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906999801657       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906999805756       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 7.668842e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906999724302       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906999745448       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906999743330       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906999742197       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906999742781       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906999745233       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906999743691       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906999744715       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.918731e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906999724302       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906999729592       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906999729063       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906999728779       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906999728924       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906999729538       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906999729154       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906999729412       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 4.797779e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178067 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.5587e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.091645e-01 1 1  ON 0
 uu_1                 1.423708e-01 1 1  ON 1
 uu_2                 4.097172e-02 1 1  ON 2
 uu_3                -2.136786e-02 1 1  ON 3
 uu_4                -6.660611e-02 1 1  ON 4
 uu_5                -1.014593e-01 1 1  ON 5
 uu_6                -1.283845e-01 1 1  ON 6
 uu_7                -1.412908e-01 1 1  ON 7
 uu_8                -1.332652e-01 1 1  ON 8
 uu_9                -1.049645e-01 1 1  ON 9
 ud_0                 4.474510e-01 1 1  ON 10
 ud_1                 1.822393e-01 1 1  ON 11
 ud_2                 6.293676e-02 1 1  ON 12
 ud_3                -7.387772e-03 1 1  ON 13
 ud_4                -6.473861e-02 1 1  ON 14
 ud_5                -1.068964e-01 1 1  ON 15
 ud_6                -1.349436e-01 1 1  ON 16
 ud_7                -1.520046e-01 1 1  ON 17
 ud_8                -1.529398e-01 1 1  ON 18
 ud_9                -1.433447e-01 1 1  ON 19
 eO_0                -7.599179e-01 1 1  ON 20
 eO_1                -4.400999e-01 1 1  ON 21
 eO_2                -2.176190e-02 1 1  ON 22
 eO_3                 2.985458e-01 1 1  ON 23
 eO_4                 5.253744e-01 1 1  ON 24
 eO_5                 4.877359e-01 1 1  ON 25
 eO_6                 2.599369e-01 1 1  ON 26
 eO_7                -4.074774e-02 1 1  ON 27
 eO_8                -2.213133e-01 1 1  ON 28
 eO_9                -8.636979e-02 1 1  ON 29
eH1_0                -2.442426e-01 1 1  ON 30
eH1_1                -1.451643e-01 1 1  ON 31
eH1_2                -9.867120e-02 1 1  ON 32
eH1_3                -4.492095e-02 1 1  ON 33
eH1_4                 3.217691e-03 1 1  ON 34
eH1_5                 3.812807e-02 1 1  ON 35
eH1_6                 9.663832e-02 1 1  ON 36
eH1_7                 1.541368e-01 1 1  ON 37
eH1_8                 1.771028e-01 1 1  ON 38
eH1_9                 6.778770e-02 1 1  ON 39
eH2_0                -2.419128e-01 1 1  ON 40
eH2_1                -1.428433e-01 1 1  ON 41
eH2_2                -9.656629e-02 1 1  ON 42
eH2_3                -4.254874e-02 1 1  ON 43
eH2_4                 5.494533e-03 1 1  ON 44
eH2_5                 4.023411e-02 1 1  ON 45
eH2_6                 9.949947e-02 1 1  ON 46
eH2_7                 1.552621e-01 1 1  ON 47
eH2_8                 1.826592e-01 1 1  ON 48
eH2_9                 5.729671e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9564
    reference variance = 0.21444
====================================================
  Execution time = 3.9591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3950e-01
  Total weights = 2.0000e+06
  Execution time = 3.6897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339505225967
                                         uncertainty =       0.004024615303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339505225967
                                         uncertainty =       0.004024615303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412009778
  error estimate for blocks of size 2^( 2) =       0.000425000433
  error estimate for blocks of size 2^( 3) =       0.000438852243
  error estimate for blocks of size 2^( 4) =       0.000452662657
  error estimate for blocks of size 2^( 5) =       0.000463991078
  error estimate for blocks of size 2^( 6) =       0.000473687969
  error estimate for blocks of size 2^( 7) =       0.000478439504

      target function =                  N/A
              le_mean =     -16.905701532445
             les_mean =     286.142248249030
             stat err =       0.000467195302
             autocorr =       1.285825064999
              std dev =       0.582669816157
             le_variance =       0.339504114660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339505735061
                                         uncertainty =       0.004024653688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339505735061
                                         uncertainty =       0.004024653688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412010087
  error estimate for blocks of size 2^( 2) =       0.000425000606
  error estimate for blocks of size 2^( 3) =       0.000438852230
  error estimate for blocks of size 2^( 4) =       0.000452662537
  error estimate for blocks of size 2^( 5) =       0.000463991045
  error estimate for blocks of size 2^( 6) =       0.000473688092
  error estimate for blocks of size 2^( 7) =       0.000478439490

      target function =                  N/A
              le_mean =     -16.905701547232
             les_mean =     286.142249257580
             stat err =       0.000467195291
             autocorr =       1.285823077716
              std dev =       0.582670252597
             le_variance =       0.339504623262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339505473181
                                         uncertainty =       0.004024634414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339505473181
                                         uncertainty =       0.004024634414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412009928
  error estimate for blocks of size 2^( 2) =       0.000425000515
  error estimate for blocks of size 2^( 3) =       0.000438852232
  error estimate for blocks of size 2^( 4) =       0.000452662592
  error estimate for blocks of size 2^( 5) =       0.000463991057
  error estimate for blocks of size 2^( 6) =       0.000473688026
  error estimate for blocks of size 2^( 7) =       0.000478439493

      target function =                  N/A
              le_mean =     -16.905701539795
             les_mean =     286.142248744521
             stat err =       0.000467195292
             autocorr =       1.285824075582
              std dev =       0.582670028087
             le_variance =       0.339504361631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339505256616
                                         uncertainty =       0.004024617689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339505256616
                                         uncertainty =       0.004024617689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412009797
  error estimate for blocks of size 2^( 2) =       0.000425000443
  error estimate for blocks of size 2^( 3) =       0.000438852242
  error estimate for blocks of size 2^( 4) =       0.000452662648
  error estimate for blocks of size 2^( 5) =       0.000463991076
  error estimate for blocks of size 2^( 6) =       0.000473687976
  error estimate for blocks of size 2^( 7) =       0.000478439502

      target function =                  N/A
              le_mean =     -16.905701533357
             les_mean =     286.142248310488
             stat err =       0.000467195301
             autocorr =       1.285824941425
              std dev =       0.582669842431
             le_variance =       0.339504145278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905701532445        initial
     5.9605e+01     5.9605e+02             7.6688e-06       -16.905701547232  <--
     2.3842e+02     2.3842e+03             1.9187e-06       -16.905701539795
     9.5367e+02     9.5367e+03             4.7978e-07       -16.905701533357

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 5.8163e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.091642e-01 1 1  ON 0
 uu_1                 1.423721e-01 1 1  ON 1
 uu_2                 4.097246e-02 1 1  ON 2
 uu_3                -2.136774e-02 1 1  ON 3
 uu_4                -6.660591e-02 1 1  ON 4
 uu_5                -1.014596e-01 1 1  ON 5
 uu_6                -1.283838e-01 1 1  ON 6
 uu_7                -1.412929e-01 1 1  ON 7
 uu_8                -1.332676e-01 1 1  ON 8
 uu_9                -1.049645e-01 1 1  ON 9
 ud_0                 4.474535e-01 1 1  ON 10
 ud_1                 1.822429e-01 1 1  ON 11
 ud_2                 6.293713e-02 1 1  ON 12
 ud_3                -7.390610e-03 1 1  ON 13
 ud_4                -6.473951e-02 1 1  ON 14
 ud_5                -1.068965e-01 1 1  ON 15
 ud_6                -1.349430e-01 1 1  ON 16
 ud_7                -1.520048e-01 1 1  ON 17
 ud_8                -1.529410e-01 1 1  ON 18
 ud_9                -1.433456e-01 1 1  ON 19
 eO_0                -7.599206e-01 1 1  ON 20
 eO_1                -4.400977e-01 1 1  ON 21
 eO_2                -2.176239e-02 1 1  ON 22
 eO_3                 2.985485e-01 1 1  ON 23
 eO_4                 5.253751e-01 1 1  ON 24
 eO_5                 4.877363e-01 1 1  ON 25
 eO_6                 2.599376e-01 1 1  ON 26
 eO_7                -4.074763e-02 1 1  ON 27
 eO_8                -2.213150e-01 1 1  ON 28
 eO_9                -8.637149e-02 1 1  ON 29
eH1_0                -2.442483e-01 1 1  ON 30
eH1_1                -1.451661e-01 1 1  ON 31
eH1_2                -9.866949e-02 1 1  ON 32
eH1_3                -4.491923e-02 1 1  ON 33
eH1_4                 3.219432e-03 1 1  ON 34
eH1_5                 3.812853e-02 1 1  ON 35
eH1_6                 9.663914e-02 1 1  ON 36
eH1_7                 1.541368e-01 1 1  ON 37
eH1_8                 1.771032e-01 1 1  ON 38
eH1_9                 6.778864e-02 1 1  ON 39
eH2_0                -2.419172e-01 1 1  ON 40
eH2_1                -1.428444e-01 1 1  ON 41
eH2_2                -9.656626e-02 1 1  ON 42
eH2_3                -4.254910e-02 1 1  ON 43
eH2_4                 5.495314e-03 1 1  ON 44
eH2_5                 4.023424e-02 1 1  ON 45
eH2_6                 9.949896e-02 1 1  ON 46
eH2_7                 1.552619e-01 1 1  ON 47
eH2_8                 1.826608e-01 1 1  ON 48
eH2_9                 5.730007e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1377e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.878
    reference variance = 0.335929
====================================================
  Execution time = 3.9756e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3566e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0790e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335744514058
                                         uncertainty =       0.002956008550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335744514058
                                         uncertainty =       0.002956008550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409668624
  error estimate for blocks of size 2^( 2) =       0.000422461138
  error estimate for blocks of size 2^( 3) =       0.000435382155
  error estimate for blocks of size 2^( 4) =       0.000447370755
  error estimate for blocks of size 2^( 5) =       0.000457191994
  error estimate for blocks of size 2^( 6) =       0.000466250262
  error estimate for blocks of size 2^( 7) =       0.000472010938

      target function =                  N/A
              le_mean =     -16.906868657962
             les_mean =     286.177864412600
             stat err =       0.000460705987
             autocorr =       1.264684821246
              std dev =       0.579358924027
             le_variance =       0.335656762850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690686865796e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906868657962       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906868886941       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906868885087       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906868853881       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906868872815       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906868913240       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906868881223       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906868890003       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 2.547482e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906868657962       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906868715773       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906868715506       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906868707582       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906868711966       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906868722356       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906868714369       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906868716491       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 6.384449e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906868657962       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906868672451       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906868672396       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906868670408       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906868671482       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906868674097       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906868672101       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906868672628       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.597097e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180689 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0554e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.091631e-01 1 1  ON 0
 uu_1                 1.423740e-01 1 1  ON 1
 uu_2                 4.097170e-02 1 1  ON 2
 uu_3                -2.136804e-02 1 1  ON 3
 uu_4                -6.660638e-02 1 1  ON 4
 uu_5                -1.014570e-01 1 1  ON 5
 uu_6                -1.283852e-01 1 1  ON 6
 uu_7                -1.412958e-01 1 1  ON 7
 uu_8                -1.332684e-01 1 1  ON 8
 uu_9                -1.049653e-01 1 1  ON 9
 ud_0                 4.474557e-01 1 1  ON 10
 ud_1                 1.822479e-01 1 1  ON 11
 ud_2                 6.293657e-02 1 1  ON 12
 ud_3                -7.393281e-03 1 1  ON 13
 ud_4                -6.474154e-02 1 1  ON 14
 ud_5                -1.068967e-01 1 1  ON 15
 ud_6                -1.349431e-01 1 1  ON 16
 ud_7                -1.520046e-01 1 1  ON 17
 ud_8                -1.529406e-01 1 1  ON 18
 ud_9                -1.433465e-01 1 1  ON 19
 eO_0                -7.599242e-01 1 1  ON 20
 eO_1                -4.400948e-01 1 1  ON 21
 eO_2                -2.176128e-02 1 1  ON 22
 eO_3                 2.985498e-01 1 1  ON 23
 eO_4                 5.253764e-01 1 1  ON 24
 eO_5                 4.877364e-01 1 1  ON 25
 eO_6                 2.599368e-01 1 1  ON 26
 eO_7                -4.074588e-02 1 1  ON 27
 eO_8                -2.213160e-01 1 1  ON 28
 eO_9                -8.637418e-02 1 1  ON 29
eH1_0                -2.442537e-01 1 1  ON 30
eH1_1                -1.451674e-01 1 1  ON 31
eH1_2                -9.866874e-02 1 1  ON 32
eH1_3                -4.491923e-02 1 1  ON 33
eH1_4                 3.221407e-03 1 1  ON 34
eH1_5                 3.812887e-02 1 1  ON 35
eH1_6                 9.663740e-02 1 1  ON 36
eH1_7                 1.541351e-01 1 1  ON 37
eH1_8                 1.771064e-01 1 1  ON 38
eH1_9                 6.779234e-02 1 1  ON 39
eH2_0                -2.419236e-01 1 1  ON 40
eH2_1                -1.428473e-01 1 1  ON 41
eH2_2                -9.656448e-02 1 1  ON 42
eH2_3                -4.254772e-02 1 1  ON 43
eH2_4                 5.495424e-03 1 1  ON 44
eH2_5                 4.023336e-02 1 1  ON 45
eH2_6                 9.949900e-02 1 1  ON 46
eH2_7                 1.552634e-01 1 1  ON 47
eH2_8                 1.826629e-01 1 1  ON 48
eH2_9                 5.730318e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8169
    reference variance = 0.365165
====================================================
  Execution time = 3.9118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4460e-01
  Total weights = 2.0000e+06
  Execution time = 3.6798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344592564927
                                         uncertainty =       0.009175704024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344592564927
                                         uncertainty =       0.009175704024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415088227
  error estimate for blocks of size 2^( 2) =       0.000427421558
  error estimate for blocks of size 2^( 3) =       0.000439728162
  error estimate for blocks of size 2^( 4) =       0.000451225559
  error estimate for blocks of size 2^( 5) =       0.000460258686
  error estimate for blocks of size 2^( 6) =       0.000465684680
  error estimate for blocks of size 2^( 7) =       0.000470639789

      target function =                  N/A
              le_mean =     -16.906080649151
             les_mean =     286.160159216076
             stat err =       0.000461952179
             autocorr =       1.238549040207
              std dev =       0.587023400524
             le_variance =       0.344596472762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344596122381
                                         uncertainty =       0.009176171307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344596122381
                                         uncertainty =       0.009176171307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415090374
  error estimate for blocks of size 2^( 2) =       0.000427423033
  error estimate for blocks of size 2^( 3) =       0.000439728988
  error estimate for blocks of size 2^( 4) =       0.000451225836
  error estimate for blocks of size 2^( 5) =       0.000460259168
  error estimate for blocks of size 2^( 6) =       0.000465685210
  error estimate for blocks of size 2^( 7) =       0.000470640432

      target function =                  N/A
              le_mean =     -16.906080658194
             les_mean =     286.160163086327
             stat err =       0.000461952662
             autocorr =       1.238538818682
              std dev =       0.587026436591
             le_variance =       0.344600037257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344594241289
                                         uncertainty =       0.009175930189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344594241289
                                         uncertainty =       0.009175930189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415089239
  error estimate for blocks of size 2^( 2) =       0.000427422232
  error estimate for blocks of size 2^( 3) =       0.000439728509
  error estimate for blocks of size 2^( 4) =       0.000451225629
  error estimate for blocks of size 2^( 5) =       0.000460258860
  error estimate for blocks of size 2^( 6) =       0.000465684883
  error estimate for blocks of size 2^( 7) =       0.000470640051

      target function =                  N/A
              le_mean =     -16.906080653829
             les_mean =     286.160161054135
             stat err =       0.000461952356
             autocorr =       1.238543951550
              std dev =       0.587024831388
             le_variance =       0.344598152666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344592770783
                                         uncertainty =       0.009175732045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344592770783
                                         uncertainty =       0.009175732045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415088351
  error estimate for blocks of size 2^( 2) =       0.000427421640
  error estimate for blocks of size 2^( 3) =       0.000439728203
  error estimate for blocks of size 2^( 4) =       0.000451225565
  error estimate for blocks of size 2^( 5) =       0.000460258705
  error estimate for blocks of size 2^( 6) =       0.000465684703
  error estimate for blocks of size 2^( 7) =       0.000470639820

      target function =                  N/A
              le_mean =     -16.906080649667
             les_mean =     286.160159439815
             stat err =       0.000461952198
             autocorr =       1.238548404471
              std dev =       0.587023576240
             le_variance =       0.344596679061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906080649151        initial
     1.4901e+01     1.4901e+02             2.5475e-05       -16.906080658194  <--
     5.9605e+01     5.9605e+02             6.3844e-06       -16.906080653829
     2.3842e+02     2.3842e+03             1.5971e-06       -16.906080649667

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 5.7623e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.091598e-01 1 1  ON 0
 uu_1                 1.423798e-01 1 1  ON 1
 uu_2                 4.096949e-02 1 1  ON 2
 uu_3                -2.136893e-02 1 1  ON 3
 uu_4                -6.660778e-02 1 1  ON 4
 uu_5                -1.014492e-01 1 1  ON 5
 uu_6                -1.283892e-01 1 1  ON 6
 uu_7                -1.413044e-01 1 1  ON 7
 uu_8                -1.332707e-01 1 1  ON 8
 uu_9                -1.049675e-01 1 1  ON 9
 ud_0                 4.474625e-01 1 1  ON 10
 ud_1                 1.822625e-01 1 1  ON 11
 ud_2                 6.293503e-02 1 1  ON 12
 ud_3                -7.401222e-03 1 1  ON 13
 ud_4                -6.474763e-02 1 1  ON 14
 ud_5                -1.068976e-01 1 1  ON 15
 ud_6                -1.349435e-01 1 1  ON 16
 ud_7                -1.520041e-01 1 1  ON 17
 ud_8                -1.529394e-01 1 1  ON 18
 ud_9                -1.433491e-01 1 1  ON 19
 eO_0                -7.599350e-01 1 1  ON 20
 eO_1                -4.400863e-01 1 1  ON 21
 eO_2                -2.175792e-02 1 1  ON 22
 eO_3                 2.985538e-01 1 1  ON 23
 eO_4                 5.253803e-01 1 1  ON 24
 eO_5                 4.877370e-01 1 1  ON 25
 eO_6                 2.599347e-01 1 1  ON 26
 eO_7                -4.074064e-02 1 1  ON 27
 eO_8                -2.213193e-01 1 1  ON 28
 eO_9                -8.638222e-02 1 1  ON 29
eH1_0                -2.442698e-01 1 1  ON 30
eH1_1                -1.451714e-01 1 1  ON 31
eH1_2                -9.866651e-02 1 1  ON 32
eH1_3                -4.491922e-02 1 1  ON 33
eH1_4                 3.227297e-03 1 1  ON 34
eH1_5                 3.812987e-02 1 1  ON 35
eH1_6                 9.663217e-02 1 1  ON 36
eH1_7                 1.541303e-01 1 1  ON 37
eH1_8                 1.771160e-01 1 1  ON 38
eH1_9                 6.780342e-02 1 1  ON 39
eH2_0                -2.419427e-01 1 1  ON 40
eH2_1                -1.428560e-01 1 1  ON 41
eH2_2                -9.655920e-02 1 1  ON 42
eH2_3                -4.254363e-02 1 1  ON 43
eH2_4                 5.495791e-03 1 1  ON 44
eH2_5                 4.023071e-02 1 1  ON 45
eH2_6                 9.949910e-02 1 1  ON 46
eH2_7                 1.552678e-01 1 1  ON 47
eH2_8                 1.826691e-01 1 1  ON 48
eH2_9                 5.731247e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0818e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9592
    reference variance = 0.403582
====================================================
  Execution time = 3.9770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3905e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0945e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339107608086
                                         uncertainty =       0.003401886958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339107608086
                                         uncertainty =       0.003401886958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411734573
  error estimate for blocks of size 2^( 2) =       0.000424800246
  error estimate for blocks of size 2^( 3) =       0.000438574329
  error estimate for blocks of size 2^( 4) =       0.000451113167
  error estimate for blocks of size 2^( 5) =       0.000462981417
  error estimate for blocks of size 2^( 6) =       0.000471876039
  error estimate for blocks of size 2^( 7) =       0.000477869654

      target function =                  N/A
              le_mean =     -16.905409261396
             les_mean =     286.131912843315
             stat err =       0.000465960069
             autocorr =       1.280745180819
              std dev =       0.582280617539
             le_variance =       0.339050717562


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540926140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905409261396       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905410085314       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905410168235       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905410136449       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905410095140       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905410201980       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905410121595       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905410109333       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 1.052295e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905409261396       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905409475318       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905409501151       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905409495177       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905409482135       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905409511766       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905409491662       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905409487986       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 2.666288e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905409261396       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905409315397       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905409322198       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905409320850       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905409317434       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905409325039       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905409320024       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905409319076       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 6.687937e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0723e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.091585e-01 1 1  ON 0
 uu_1                 1.423868e-01 1 1  ON 1
 uu_2                 4.096992e-02 1 1  ON 2
 uu_3                -2.136993e-02 1 1  ON 3
 uu_4                -6.661152e-02 1 1  ON 4
 uu_5                -1.014396e-01 1 1  ON 5
 uu_6                -1.283871e-01 1 1  ON 6
 uu_7                -1.413166e-01 1 1  ON 7
 uu_8                -1.332765e-01 1 1  ON 8
 uu_9                -1.049686e-01 1 1  ON 9
 ud_0                 4.474768e-01 1 1  ON 10
 ud_1                 1.822848e-01 1 1  ON 11
 ud_2                 6.293077e-02 1 1  ON 12
 ud_3                -7.414449e-03 1 1  ON 13
 ud_4                -6.475342e-02 1 1  ON 14
 ud_5                -1.069017e-01 1 1  ON 15
 ud_6                -1.349461e-01 1 1  ON 16
 ud_7                -1.520097e-01 1 1  ON 17
 ud_8                -1.529385e-01 1 1  ON 18
 ud_9                -1.433477e-01 1 1  ON 19
 eO_0                -7.599492e-01 1 1  ON 20
 eO_1                -4.400806e-01 1 1  ON 21
 eO_2                -2.175083e-02 1 1  ON 22
 eO_3                 2.985650e-01 1 1  ON 23
 eO_4                 5.253805e-01 1 1  ON 24
 eO_5                 4.877365e-01 1 1  ON 25
 eO_6                 2.599399e-01 1 1  ON 26
 eO_7                -4.073930e-02 1 1  ON 27
 eO_8                -2.213246e-01 1 1  ON 28
 eO_9                -8.639135e-02 1 1  ON 29
eH1_0                -2.442965e-01 1 1  ON 30
eH1_1                -1.451759e-01 1 1  ON 31
eH1_2                -9.866395e-02 1 1  ON 32
eH1_3                -4.490932e-02 1 1  ON 33
eH1_4                 3.236554e-03 1 1  ON 34
eH1_5                 3.812645e-02 1 1  ON 35
eH1_6                 9.663027e-02 1 1  ON 36
eH1_7                 1.541272e-01 1 1  ON 37
eH1_8                 1.771229e-01 1 1  ON 38
eH1_9                 6.781387e-02 1 1  ON 39
eH2_0                -2.419624e-01 1 1  ON 40
eH2_1                -1.428686e-01 1 1  ON 41
eH2_2                -9.655889e-02 1 1  ON 42
eH2_3                -4.253949e-02 1 1  ON 43
eH2_4                 5.501764e-03 1 1  ON 44
eH2_5                 4.022683e-02 1 1  ON 45
eH2_6                 9.949718e-02 1 1  ON 46
eH2_7                 1.552746e-01 1 1  ON 47
eH2_8                 1.826790e-01 1 1  ON 48
eH2_9                 5.732371e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8573
    reference variance = 0.273324
====================================================
  Execution time = 3.9101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4452e-01
  Total weights = 2.0000e+06
  Execution time = 3.7033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344579788046
                                         uncertainty =       0.007239719258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344579788046
                                         uncertainty =       0.007239719258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415036340
  error estimate for blocks of size 2^( 2) =       0.000427918813
  error estimate for blocks of size 2^( 3) =       0.000440484620
  error estimate for blocks of size 2^( 4) =       0.000452043846
  error estimate for blocks of size 2^( 5) =       0.000463256553
  error estimate for blocks of size 2^( 6) =       0.000472293553
  error estimate for blocks of size 2^( 7) =       0.000475508467

      target function =                  N/A
              le_mean =     -16.906062193574
             les_mean =     286.159449048182
             stat err =       0.000465775605
             autocorr =       1.259450860355
              std dev =       0.586950021254
             le_variance =       0.344510327451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344614421886
                                         uncertainty =       0.007241185761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344614421886
                                         uncertainty =       0.007241185761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415057187
  error estimate for blocks of size 2^( 2) =       0.000427936172
  error estimate for blocks of size 2^( 3) =       0.000440498138
  error estimate for blocks of size 2^( 4) =       0.000452054410
  error estimate for blocks of size 2^( 5) =       0.000463266560
  error estimate for blocks of size 2^( 6) =       0.000472304670
  error estimate for blocks of size 2^( 7) =       0.000475517232

      target function =                  N/A
              le_mean =     -16.906062062567
             les_mean =     286.159479228867
             stat err =       0.000465785718
             autocorr =       1.259379032418
              std dev =       0.586979503694
             le_variance =       0.344544937757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344596345992
                                         uncertainty =       0.007240452011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344596345992
                                         uncertainty =       0.007240452011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415046307
  error estimate for blocks of size 2^( 2) =       0.000427926972
  error estimate for blocks of size 2^( 3) =       0.000440490781
  error estimate for blocks of size 2^( 4) =       0.000452048469
  error estimate for blocks of size 2^( 5) =       0.000463260891
  error estimate for blocks of size 2^( 6) =       0.000472298464
  error estimate for blocks of size 2^( 7) =       0.000475512137

      target function =                  N/A
              le_mean =     -16.906062110622
             les_mean =     286.159462789805
             stat err =       0.000465779990
             autocorr =       1.259414088981
              std dev =       0.586964116324
             le_variance =       0.344526873852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344581819271
                                         uncertainty =       0.007239810726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344581819271
                                         uncertainty =       0.007239810726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415037563
  error estimate for blocks of size 2^( 2) =       0.000427919807
  error estimate for blocks of size 2^( 3) =       0.000440485361
  error estimate for blocks of size 2^( 4) =       0.000452044393
  error estimate for blocks of size 2^( 5) =       0.000463257064
  error estimate for blocks of size 2^( 6) =       0.000472294136
  error estimate for blocks of size 2^( 7) =       0.000475508893

      target function =                  N/A
              le_mean =     -16.906062181407
             les_mean =     286.159450666582
             stat err =       0.000465776122
             autocorr =       1.259446234096
              std dev =       0.586951750355
             le_variance =       0.344512357245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906062193574        initial  <--
     3.7253e+00     3.7253e+01             1.0523e-04       -16.906062062567
     1.4901e+01     1.4901e+02             2.6663e-05       -16.906062110622
     5.9605e+01     5.9605e+02             6.6879e-06       -16.906062181407

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0946
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.091598e-01 1 1  ON 0
 uu_1                 1.423798e-01 1 1  ON 1
 uu_2                 4.096949e-02 1 1  ON 2
 uu_3                -2.136893e-02 1 1  ON 3
 uu_4                -6.660778e-02 1 1  ON 4
 uu_5                -1.014492e-01 1 1  ON 5
 uu_6                -1.283892e-01 1 1  ON 6
 uu_7                -1.413044e-01 1 1  ON 7
 uu_8                -1.332707e-01 1 1  ON 8
 uu_9                -1.049675e-01 1 1  ON 9
 ud_0                 4.474625e-01 1 1  ON 10
 ud_1                 1.822625e-01 1 1  ON 11
 ud_2                 6.293503e-02 1 1  ON 12
 ud_3                -7.401222e-03 1 1  ON 13
 ud_4                -6.474763e-02 1 1  ON 14
 ud_5                -1.068976e-01 1 1  ON 15
 ud_6                -1.349435e-01 1 1  ON 16
 ud_7                -1.520041e-01 1 1  ON 17
 ud_8                -1.529394e-01 1 1  ON 18
 ud_9                -1.433491e-01 1 1  ON 19
 eO_0                -7.599350e-01 1 1  ON 20
 eO_1                -4.400863e-01 1 1  ON 21
 eO_2                -2.175792e-02 1 1  ON 22
 eO_3                 2.985538e-01 1 1  ON 23
 eO_4                 5.253803e-01 1 1  ON 24
 eO_5                 4.877370e-01 1 1  ON 25
 eO_6                 2.599347e-01 1 1  ON 26
 eO_7                -4.074064e-02 1 1  ON 27
 eO_8                -2.213193e-01 1 1  ON 28
 eO_9                -8.638222e-02 1 1  ON 29
eH1_0                -2.442698e-01 1 1  ON 30
eH1_1                -1.451714e-01 1 1  ON 31
eH1_2                -9.866651e-02 1 1  ON 32
eH1_3                -4.491922e-02 1 1  ON 33
eH1_4                 3.227297e-03 1 1  ON 34
eH1_5                 3.812987e-02 1 1  ON 35
eH1_6                 9.663217e-02 1 1  ON 36
eH1_7                 1.541303e-01 1 1  ON 37
eH1_8                 1.771160e-01 1 1  ON 38
eH1_9                 6.780342e-02 1 1  ON 39
eH2_0                -2.419427e-01 1 1  ON 40
eH2_1                -1.428560e-01 1 1  ON 41
eH2_2                -9.655920e-02 1 1  ON 42
eH2_3                -4.254363e-02 1 1  ON 43
eH2_4                 5.495791e-03 1 1  ON 44
eH2_5                 4.023071e-02 1 1  ON 45
eH2_6                 9.949910e-02 1 1  ON 46
eH2_7                 1.552678e-01 1 1  ON 47
eH2_8                 1.826691e-01 1 1  ON 48
eH2_9                 5.731247e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1183e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9122
    reference variance = 0.394236
====================================================
  Execution time = 4.1412e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3758e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0959e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337501022738
                                         uncertainty =       0.004460695257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337501022738
                                         uncertainty =       0.004460695257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410837771
  error estimate for blocks of size 2^( 2) =       0.000423756882
  error estimate for blocks of size 2^( 3) =       0.000437472024
  error estimate for blocks of size 2^( 4) =       0.000449731321
  error estimate for blocks of size 2^( 5) =       0.000460371216
  error estimate for blocks of size 2^( 6) =       0.000468360737
  error estimate for blocks of size 2^( 7) =       0.000478980266

      target function =                  N/A
              le_mean =     -16.905027380380
             les_mean =     286.117525910359
             stat err =       0.000464360885
             autocorr =       1.277528308409
              std dev =       0.581012347334
             le_variance =       0.337575347755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690502738038e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905027380380       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905027482846       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905027539776       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905027536425       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905027548319       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905027570988       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905027562616       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905027564061       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 1.133909e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905027380380       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905027406101       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905027420442       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905027419645       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905027422594       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905027428315       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905027426212       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905027426579       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 2.837368e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905027380380       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905027386817       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905027390409       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905027390212       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905027390948       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905027392382       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905027391855       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905027391947       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 7.095040e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2379e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.091598e-01 1 1  ON 0
 uu_1                 1.423802e-01 1 1  ON 1
 uu_2                 4.096948e-02 1 1  ON 2
 uu_3                -2.136926e-02 1 1  ON 3
 uu_4                -6.660763e-02 1 1  ON 4
 uu_5                -1.014497e-01 1 1  ON 5
 uu_6                -1.283894e-01 1 1  ON 6
 uu_7                -1.413057e-01 1 1  ON 7
 uu_8                -1.332703e-01 1 1  ON 8
 uu_9                -1.049672e-01 1 1  ON 9
 ud_0                 4.474645e-01 1 1  ON 10
 ud_1                 1.822640e-01 1 1  ON 11
 ud_2                 6.293458e-02 1 1  ON 12
 ud_3                -7.403035e-03 1 1  ON 13
 ud_4                -6.474810e-02 1 1  ON 14
 ud_5                -1.068979e-01 1 1  ON 15
 ud_6                -1.349431e-01 1 1  ON 16
 ud_7                -1.520049e-01 1 1  ON 17
 ud_8                -1.529394e-01 1 1  ON 18
 ud_9                -1.433489e-01 1 1  ON 19
 eO_0                -7.599359e-01 1 1  ON 20
 eO_1                -4.400864e-01 1 1  ON 21
 eO_2                -2.175722e-02 1 1  ON 22
 eO_3                 2.985551e-01 1 1  ON 23
 eO_4                 5.253805e-01 1 1  ON 24
 eO_5                 4.877372e-01 1 1  ON 25
 eO_6                 2.599347e-01 1 1  ON 26
 eO_7                -4.074078e-02 1 1  ON 27
 eO_8                -2.213196e-01 1 1  ON 28
 eO_9                -8.638296e-02 1 1  ON 29
eH1_0                -2.442720e-01 1 1  ON 30
eH1_1                -1.451723e-01 1 1  ON 31
eH1_2                -9.866588e-02 1 1  ON 32
eH1_3                -4.491873e-02 1 1  ON 33
eH1_4                 3.227164e-03 1 1  ON 34
eH1_5                 3.812950e-02 1 1  ON 35
eH1_6                 9.663201e-02 1 1  ON 36
eH1_7                 1.541304e-01 1 1  ON 37
eH1_8                 1.771172e-01 1 1  ON 38
eH1_9                 6.780461e-02 1 1  ON 39
eH2_0                -2.419456e-01 1 1  ON 40
eH2_1                -1.428572e-01 1 1  ON 41
eH2_2                -9.655866e-02 1 1  ON 42
eH2_3                -4.254372e-02 1 1  ON 43
eH2_4                 5.496398e-03 1 1  ON 44
eH2_5                 4.023047e-02 1 1  ON 45
eH2_6                 9.949981e-02 1 1  ON 46
eH2_7                 1.552684e-01 1 1  ON 47
eH2_8                 1.826698e-01 1 1  ON 48
eH2_9                 5.731362e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9231
    reference variance = 0.257841
====================================================
  Execution time = 3.8727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4015e-01
  Total weights = 2.0000e+06
  Execution time = 3.6913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340224745007
                                         uncertainty =       0.005235994996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340224745007
                                         uncertainty =       0.005235994996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412402100
  error estimate for blocks of size 2^( 2) =       0.000425259475
  error estimate for blocks of size 2^( 3) =       0.000437778309
  error estimate for blocks of size 2^( 4) =       0.000449831888
  error estimate for blocks of size 2^( 5) =       0.000459534022
  error estimate for blocks of size 2^( 6) =       0.000464185379
  error estimate for blocks of size 2^( 7) =       0.000468635440

      target function =                  N/A
              le_mean =     -16.905971813561
             les_mean =     286.152033775579
             stat err =       0.000460546682
             autocorr =       1.247112348438
              std dev =       0.583224643450
             le_variance =       0.340150984727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340230426478
                                         uncertainty =       0.005236131446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340230426478
                                         uncertainty =       0.005236131446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412405544
  error estimate for blocks of size 2^( 2) =       0.000425262563
  error estimate for blocks of size 2^( 3) =       0.000437781072
  error estimate for blocks of size 2^( 4) =       0.000449834462
  error estimate for blocks of size 2^( 5) =       0.000459536256
  error estimate for blocks of size 2^( 6) =       0.000464187735
  error estimate for blocks of size 2^( 7) =       0.000468637814

      target function =                  N/A
              le_mean =     -16.905971827643
             les_mean =     286.152039931851
             stat err =       0.000460549067
             autocorr =       1.247104437063
              std dev =       0.583229513018
             le_variance =       0.340156664855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340227589639
                                         uncertainty =       0.005236063344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340227589639
                                         uncertainty =       0.005236063344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412403824
  error estimate for blocks of size 2^( 2) =       0.000425261021
  error estimate for blocks of size 2^( 3) =       0.000437779692
  error estimate for blocks of size 2^( 4) =       0.000449833176
  error estimate for blocks of size 2^( 5) =       0.000459535139
  error estimate for blocks of size 2^( 6) =       0.000464186558
  error estimate for blocks of size 2^( 7) =       0.000468636627

      target function =                  N/A
              le_mean =     -16.905971820473
             les_mean =     286.152036853226
             stat err =       0.000460547875
             autocorr =       1.247108380049
              std dev =       0.583227081576
             le_variance =       0.340153828684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340225100654
                                         uncertainty =       0.005236003543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340225100654
                                         uncertainty =       0.005236003543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412402316
  error estimate for blocks of size 2^( 2) =       0.000425259669
  error estimate for blocks of size 2^( 3) =       0.000437778482
  error estimate for blocks of size 2^( 4) =       0.000449832049
  error estimate for blocks of size 2^( 5) =       0.000459534162
  error estimate for blocks of size 2^( 6) =       0.000464185527
  error estimate for blocks of size 2^( 7) =       0.000468635588

      target function =                  N/A
              le_mean =     -16.905971814409
             les_mean =     286.152034159818
             stat err =       0.000460546831
             autocorr =       1.247111851934
              std dev =       0.583224948274
             le_variance =       0.340151340289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905971813561        initial
     3.7253e+01     3.7253e+02             1.1339e-05       -16.905971827643  <--
     1.4901e+02     1.4901e+03             2.8374e-06       -16.905971820473
     5.9605e+02     5.9605e+03             7.0950e-07       -16.905971814409

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 5.7297e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.091599e-01 1 1  ON 0
 uu_1                 1.423814e-01 1 1  ON 1
 uu_2                 4.096944e-02 1 1  ON 2
 uu_3                -2.137027e-02 1 1  ON 3
 uu_4                -6.660719e-02 1 1  ON 4
 uu_5                -1.014514e-01 1 1  ON 5
 uu_6                -1.283902e-01 1 1  ON 6
 uu_7                -1.413096e-01 1 1  ON 7
 uu_8                -1.332688e-01 1 1  ON 8
 uu_9                -1.049663e-01 1 1  ON 9
 ud_0                 4.474707e-01 1 1  ON 10
 ud_1                 1.822684e-01 1 1  ON 11
 ud_2                 6.293322e-02 1 1  ON 12
 ud_3                -7.408439e-03 1 1  ON 13
 ud_4                -6.474951e-02 1 1  ON 14
 ud_5                -1.068989e-01 1 1  ON 15
 ud_6                -1.349420e-01 1 1  ON 16
 ud_7                -1.520071e-01 1 1  ON 17
 ud_8                -1.529394e-01 1 1  ON 18
 ud_9                -1.433485e-01 1 1  ON 19
 eO_0                -7.599387e-01 1 1  ON 20
 eO_1                -4.400869e-01 1 1  ON 21
 eO_2                -2.175513e-02 1 1  ON 22
 eO_3                 2.985589e-01 1 1  ON 23
 eO_4                 5.253811e-01 1 1  ON 24
 eO_5                 4.877381e-01 1 1  ON 25
 eO_6                 2.599346e-01 1 1  ON 26
 eO_7                -4.074118e-02 1 1  ON 27
 eO_8                -2.213206e-01 1 1  ON 28
 eO_9                -8.638518e-02 1 1  ON 29
eH1_0                -2.442783e-01 1 1  ON 30
eH1_1                -1.451748e-01 1 1  ON 31
eH1_2                -9.866401e-02 1 1  ON 32
eH1_3                -4.491729e-02 1 1  ON 33
eH1_4                 3.226772e-03 1 1  ON 34
eH1_5                 3.812840e-02 1 1  ON 35
eH1_6                 9.663151e-02 1 1  ON 36
eH1_7                 1.541307e-01 1 1  ON 37
eH1_8                 1.771209e-01 1 1  ON 38
eH1_9                 6.780820e-02 1 1  ON 39
eH2_0                -2.419541e-01 1 1  ON 40
eH2_1                -1.428607e-01 1 1  ON 41
eH2_2                -9.655708e-02 1 1  ON 42
eH2_3                -4.254398e-02 1 1  ON 43
eH2_4                 5.498212e-03 1 1  ON 44
eH2_5                 4.022975e-02 1 1  ON 45
eH2_6                 9.950197e-02 1 1  ON 46
eH2_7                 1.552701e-01 1 1  ON 47
eH2_8                 1.826718e-01 1 1  ON 48
eH2_9                 5.731705e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0972e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9499
    reference variance = 0.311347
====================================================
  Execution time = 3.9716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4311e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0923e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343175322669
                                         uncertainty =       0.005016220949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343175322669
                                         uncertainty =       0.005016220949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414190980
  error estimate for blocks of size 2^( 2) =       0.000426728171
  error estimate for blocks of size 2^( 3) =       0.000439337562
  error estimate for blocks of size 2^( 4) =       0.000451692031
  error estimate for blocks of size 2^( 5) =       0.000461192133
  error estimate for blocks of size 2^( 6) =       0.000468283187
  error estimate for blocks of size 2^( 7) =       0.000470354485

      target function =                  N/A
              le_mean =     -16.906993750978
             les_mean =     286.189545860043
             stat err =       0.000462880459
             autocorr =       1.248925176076
              std dev =       0.585754501475
             le_variance =       0.343108335998


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690699375098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906993750978       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906994081372       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906994158403       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906994166567       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906994234266       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906994218399       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906994239096       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906994211029       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 4.299299e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906993750978       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906993834908       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906993855015       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906993856856       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906993874335       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906993870121       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906993875129       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906993868064       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 1.082700e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906993750978       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906993772045       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906993777127       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906993777575       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906993781981       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906993780912       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906993782153       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906993780383       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 2.711720e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188609 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0647e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.091579e-01 1 1  ON 0
 uu_1                 1.423844e-01 1 1  ON 1
 uu_2                 4.097295e-02 1 1  ON 2
 uu_3                -2.137202e-02 1 1  ON 3
 uu_4                -6.660386e-02 1 1  ON 4
 uu_5                -1.014495e-01 1 1  ON 5
 uu_6                -1.283905e-01 1 1  ON 6
 uu_7                -1.413149e-01 1 1  ON 7
 uu_8                -1.332732e-01 1 1  ON 8
 uu_9                -1.049677e-01 1 1  ON 9
 ud_0                 4.474790e-01 1 1  ON 10
 ud_1                 1.822730e-01 1 1  ON 11
 ud_2                 6.293344e-02 1 1  ON 12
 ud_3                -7.414553e-03 1 1  ON 13
 ud_4                -6.474951e-02 1 1  ON 14
 ud_5                -1.068983e-01 1 1  ON 15
 ud_6                -1.349435e-01 1 1  ON 16
 ud_7                -1.520084e-01 1 1  ON 17
 ud_8                -1.529432e-01 1 1  ON 18
 ud_9                -1.433485e-01 1 1  ON 19
 eO_0                -7.599434e-01 1 1  ON 20
 eO_1                -4.400804e-01 1 1  ON 21
 eO_2                -2.175423e-02 1 1  ON 22
 eO_3                 2.985631e-01 1 1  ON 23
 eO_4                 5.253823e-01 1 1  ON 24
 eO_5                 4.877389e-01 1 1  ON 25
 eO_6                 2.599336e-01 1 1  ON 26
 eO_7                -4.074198e-02 1 1  ON 27
 eO_8                -2.213242e-01 1 1  ON 28
 eO_9                -8.638812e-02 1 1  ON 29
eH1_0                -2.442887e-01 1 1  ON 30
eH1_1                -1.451777e-01 1 1  ON 31
eH1_2                -9.866203e-02 1 1  ON 32
eH1_3                -4.491719e-02 1 1  ON 33
eH1_4                 3.231972e-03 1 1  ON 34
eH1_5                 3.812757e-02 1 1  ON 35
eH1_6                 9.663011e-02 1 1  ON 36
eH1_7                 1.541303e-01 1 1  ON 37
eH1_8                 1.771251e-01 1 1  ON 38
eH1_9                 6.781266e-02 1 1  ON 39
eH2_0                -2.419649e-01 1 1  ON 40
eH2_1                -1.428623e-01 1 1  ON 41
eH2_2                -9.655238e-02 1 1  ON 42
eH2_3                -4.254306e-02 1 1  ON 43
eH2_4                 5.500299e-03 1 1  ON 44
eH2_5                 4.023045e-02 1 1  ON 45
eH2_6                 9.949969e-02 1 1  ON 46
eH2_7                 1.552702e-01 1 1  ON 47
eH2_8                 1.826738e-01 1 1  ON 48
eH2_9                 5.732113e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.933
    reference variance = 0.243096
====================================================
  Execution time = 3.9139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3357e-01
  Total weights = 2.0000e+06
  Execution time = 3.7040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333606594868
                                         uncertainty =       0.002353412576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333606594868
                                         uncertainty =       0.002353412576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408388552
  error estimate for blocks of size 2^( 2) =       0.000421010557
  error estimate for blocks of size 2^( 3) =       0.000434296381
  error estimate for blocks of size 2^( 4) =       0.000446412355
  error estimate for blocks of size 2^( 5) =       0.000456413351
  error estimate for blocks of size 2^( 6) =       0.000463020408
  error estimate for blocks of size 2^( 7) =       0.000467184740

      target function =                  N/A
              le_mean =     -16.906405491265
             les_mean =     286.160108886434
             stat err =       0.000458257714
             autocorr =       1.259135445515
              std dev =       0.577548628391
             le_variance =       0.333562418156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333620883889
                                         uncertainty =       0.002353581334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333620883889
                                         uncertainty =       0.002353581334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408397304
  error estimate for blocks of size 2^( 2) =       0.000421017985
  error estimate for blocks of size 2^( 3) =       0.000434302429
  error estimate for blocks of size 2^( 4) =       0.000446417644
  error estimate for blocks of size 2^( 5) =       0.000456417599
  error estimate for blocks of size 2^( 6) =       0.000463024843
  error estimate for blocks of size 2^( 7) =       0.000467189559

      target function =                  N/A
              le_mean =     -16.906405800258
             les_mean =     286.160133632720
             stat err =       0.000458262411
             autocorr =       1.259107287918
              std dev =       0.577561006732
             le_variance =       0.333576716497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333613721662
                                         uncertainty =       0.002353497460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333613721662
                                         uncertainty =       0.002353497460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408392917
  error estimate for blocks of size 2^( 2) =       0.000421014252
  error estimate for blocks of size 2^( 3) =       0.000434299375
  error estimate for blocks of size 2^( 4) =       0.000446414964
  error estimate for blocks of size 2^( 5) =       0.000456415423
  error estimate for blocks of size 2^( 6) =       0.000463022574
  error estimate for blocks of size 2^( 7) =       0.000467187103

      target function =                  N/A
              le_mean =     -16.906405643026
             les_mean =     286.160121149581
             stat err =       0.000458260016
             autocorr =       1.259121178540
              std dev =       0.577554802453
             le_variance =       0.333569549836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333607483876
                                         uncertainty =       0.002353423200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333607483876
                                         uncertainty =       0.002353423200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408389096
  error estimate for blocks of size 2^( 2) =       0.000421011017
  error estimate for blocks of size 2^( 3) =       0.000434296753
  error estimate for blocks of size 2^( 4) =       0.000446412679
  error estimate for blocks of size 2^( 5) =       0.000456413607
  error estimate for blocks of size 2^( 6) =       0.000463020676
  error estimate for blocks of size 2^( 7) =       0.000467185033

      target function =                  N/A
              le_mean =     -16.906405509928
             les_mean =     286.160110407113
             stat err =       0.000458257999
             autocorr =       1.259133655211
              std dev =       0.577549398565
             le_variance =       0.333563307782


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906405491265        initial
     9.3132e+00     9.3132e+01             4.2993e-05       -16.906405800258  <--
     3.7253e+01     3.7253e+02             1.0827e-05       -16.906405643026
     1.4901e+02     1.4901e+03             2.7117e-06       -16.906405509928

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 5.7772e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.091522e-01 1 1  ON 0
 uu_1                 1.423932e-01 1 1  ON 1
 uu_2                 4.098297e-02 1 1  ON 2
 uu_3                -2.137679e-02 1 1  ON 3
 uu_4                -6.659441e-02 1 1  ON 4
 uu_5                -1.014437e-01 1 1  ON 5
 uu_6                -1.283913e-01 1 1  ON 6
 uu_7                -1.413305e-01 1 1  ON 7
 uu_8                -1.332861e-01 1 1  ON 8
 uu_9                -1.049721e-01 1 1  ON 9
 ud_0                 4.475035e-01 1 1  ON 10
 ud_1                 1.822862e-01 1 1  ON 11
 ud_2                 6.293420e-02 1 1  ON 12
 ud_3                -7.432234e-03 1 1  ON 13
 ud_4                -6.474974e-02 1 1  ON 14
 ud_5                -1.068967e-01 1 1  ON 15
 ud_6                -1.349478e-01 1 1  ON 16
 ud_7                -1.520121e-01 1 1  ON 17
 ud_8                -1.529546e-01 1 1  ON 18
 ud_9                -1.433483e-01 1 1  ON 19
 eO_0                -7.599573e-01 1 1  ON 20
 eO_1                -4.400612e-01 1 1  ON 21
 eO_2                -2.175136e-02 1 1  ON 22
 eO_3                 2.985752e-01 1 1  ON 23
 eO_4                 5.253860e-01 1 1  ON 24
 eO_5                 4.877414e-01 1 1  ON 25
 eO_6                 2.599306e-01 1 1  ON 26
 eO_7                -4.074437e-02 1 1  ON 27
 eO_8                -2.213350e-01 1 1  ON 28
 eO_9                -8.639686e-02 1 1  ON 29
eH1_0                -2.443196e-01 1 1  ON 30
eH1_1                -1.451861e-01 1 1  ON 31
eH1_2                -9.865616e-02 1 1  ON 32
eH1_3                -4.491679e-02 1 1  ON 33
eH1_4                 3.247404e-03 1 1  ON 34
eH1_5                 3.812517e-02 1 1  ON 35
eH1_6                 9.662594e-02 1 1  ON 36
eH1_7                 1.541290e-01 1 1  ON 37
eH1_8                 1.771373e-01 1 1  ON 38
eH1_9                 6.782592e-02 1 1  ON 39
eH2_0                -2.419971e-01 1 1  ON 40
eH2_1                -1.428670e-01 1 1  ON 41
eH2_2                -9.653860e-02 1 1  ON 42
eH2_3                -4.254019e-02 1 1  ON 43
eH2_4                 5.506559e-03 1 1  ON 44
eH2_5                 4.023254e-02 1 1  ON 45
eH2_6                 9.949290e-02 1 1  ON 46
eH2_7                 1.552703e-01 1 1  ON 47
eH2_8                 1.826796e-01 1 1  ON 48
eH2_9                 5.733327e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0843e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.839
    reference variance = 0.238286
====================================================
  Execution time = 4.0324e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3503e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0757e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335089700521
                                         uncertainty =       0.005136244982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335089700521
                                         uncertainty =       0.005136244982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409289102
  error estimate for blocks of size 2^( 2) =       0.000422244603
  error estimate for blocks of size 2^( 3) =       0.000435120496
  error estimate for blocks of size 2^( 4) =       0.000446830109
  error estimate for blocks of size 2^( 5) =       0.000457715501
  error estimate for blocks of size 2^( 6) =       0.000465580201
  error estimate for blocks of size 2^( 7) =       0.000473676244

      target function =                  N/A
              le_mean =     -16.906402534518
             les_mean =     286.161481629533
             stat err =       0.000460950514
             autocorr =       1.268376670232
              std dev =       0.578822198863
             le_variance =       0.335035137897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690640253452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906402534518       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906404156591       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906404334542       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906404494394       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906404522606       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906404601388       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906404649575       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906404572802       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906404601212       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 1.878859e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906402534518       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906402965459       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906403010500       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906403052093       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906403062986       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906403084230       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906403097097       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906403078791       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906403084761       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 4.778334e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906402534518       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906402643969       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906402655303       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906402665796       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906402668783       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906402674234       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906402677482       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906402672986       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 1.190447e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191592 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1090e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.091596e-01 1 1  ON 0
 uu_1                 1.424047e-01 1 1  ON 1
 uu_2                 4.097948e-02 1 1  ON 2
 uu_3                -2.136844e-02 1 1  ON 3
 uu_4                -6.659651e-02 1 1  ON 4
 uu_5                -1.014328e-01 1 1  ON 5
 uu_6                -1.283888e-01 1 1  ON 6
 uu_7                -1.413587e-01 1 1  ON 7
 uu_8                -1.333117e-01 1 1  ON 8
 uu_9                -1.049779e-01 1 1  ON 9
 ud_0                 4.475361e-01 1 1  ON 10
 ud_1                 1.823108e-01 1 1  ON 11
 ud_2                 6.292453e-02 1 1  ON 12
 ud_3                -7.455075e-03 1 1  ON 13
 ud_4                -6.476149e-02 1 1  ON 14
 ud_5                -1.069012e-01 1 1  ON 15
 ud_6                -1.349500e-01 1 1  ON 16
 ud_7                -1.520134e-01 1 1  ON 17
 ud_8                -1.529504e-01 1 1  ON 18
 ud_9                -1.433468e-01 1 1  ON 19
 eO_0                -7.599738e-01 1 1  ON 20
 eO_1                -4.400401e-01 1 1  ON 21
 eO_2                -2.175002e-02 1 1  ON 22
 eO_3                 2.985885e-01 1 1  ON 23
 eO_4                 5.253837e-01 1 1  ON 24
 eO_5                 4.877450e-01 1 1  ON 25
 eO_6                 2.599348e-01 1 1  ON 26
 eO_7                -4.074353e-02 1 1  ON 27
 eO_8                -2.213462e-01 1 1  ON 28
 eO_9                -8.640858e-02 1 1  ON 29
eH1_0                -2.443569e-01 1 1  ON 30
eH1_1                -1.451905e-01 1 1  ON 31
eH1_2                -9.864440e-02 1 1  ON 32
eH1_3                -4.490187e-02 1 1  ON 33
eH1_4                 3.257693e-03 1 1  ON 34
eH1_5                 3.811550e-02 1 1  ON 35
eH1_6                 9.661438e-02 1 1  ON 36
eH1_7                 1.541237e-01 1 1  ON 37
eH1_8                 1.771542e-01 1 1  ON 38
eH1_9                 6.783999e-02 1 1  ON 39
eH2_0                -2.420448e-01 1 1  ON 40
eH2_1                -1.428812e-01 1 1  ON 41
eH2_2                -9.652521e-02 1 1  ON 42
eH2_3                -4.253088e-02 1 1  ON 43
eH2_4                 5.507575e-03 1 1  ON 44
eH2_5                 4.022983e-02 1 1  ON 45
eH2_6                 9.949228e-02 1 1  ON 46
eH2_7                 1.552713e-01 1 1  ON 47
eH2_8                 1.826917e-01 1 1  ON 48
eH2_9                 5.735548e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9298
    reference variance = 0.185036
====================================================
  Execution time = 4.0584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3623e-01
  Total weights = 2.0000e+06
  Execution time = 3.6968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336216520171
                                         uncertainty =       0.004186917971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336216520171
                                         uncertainty =       0.004186917971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410004681
  error estimate for blocks of size 2^( 2) =       0.000422854886
  error estimate for blocks of size 2^( 3) =       0.000435608268
  error estimate for blocks of size 2^( 4) =       0.000447654777
  error estimate for blocks of size 2^( 5) =       0.000458519596
  error estimate for blocks of size 2^( 6) =       0.000466534204
  error estimate for blocks of size 2^( 7) =       0.000471116670

      target function =                  N/A
              le_mean =     -16.905761148621
             les_mean =     286.140967522583
             stat err =       0.000460956312
             autocorr =       1.263984947696
              std dev =       0.579834180130
             le_variance =       0.336207676447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336312827621
                                         uncertainty =       0.004188569553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336312827621
                                         uncertainty =       0.004188569553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410063421
  error estimate for blocks of size 2^( 2) =       0.000422907898
  error estimate for blocks of size 2^( 3) =       0.000435653217
  error estimate for blocks of size 2^( 4) =       0.000447695051
  error estimate for blocks of size 2^( 5) =       0.000458558594
  error estimate for blocks of size 2^( 6) =       0.000466571866
  error estimate for blocks of size 2^( 7) =       0.000471153913

      target function =                  N/A
              le_mean =     -16.905761182105
             les_mean =     286.141064997125
             stat err =       0.000460994856
             autocorr =       1.263834181930
              std dev =       0.579917251764
             le_variance =       0.336304018893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336267521473
                                         uncertainty =       0.004187783242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336267521473
                                         uncertainty =       0.004187783242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410035789
  error estimate for blocks of size 2^( 2) =       0.000422882918
  error estimate for blocks of size 2^( 3) =       0.000435631960
  error estimate for blocks of size 2^( 4) =       0.000447675966
  error estimate for blocks of size 2^( 5) =       0.000458540071
  error estimate for blocks of size 2^( 6) =       0.000466553846
  error estimate for blocks of size 2^( 7) =       0.000471136057

      target function =                  N/A
              le_mean =     -16.905761133720
             les_mean =     286.141018038194
             stat err =       0.000460976485
             autocorr =       1.263903787342
              std dev =       0.579878173358
             le_variance =       0.336258695937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336222848867
                                         uncertainty =       0.004187024490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336222848867
                                         uncertainty =       0.004187024490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410008541
  error estimate for blocks of size 2^( 2) =       0.000422858360
  error estimate for blocks of size 2^( 3) =       0.000435611195
  error estimate for blocks of size 2^( 4) =       0.000447657388
  error estimate for blocks of size 2^( 5) =       0.000458522117
  error estimate for blocks of size 2^( 6) =       0.000466536622
  error estimate for blocks of size 2^( 7) =       0.000471119041

      target function =                  N/A
              le_mean =     -16.905761137705
             les_mean =     286.140973484423
             stat err =       0.000460958792
             autocorr =       1.263974749621
              std dev =       0.579839639369
             le_variance =       0.336214007384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905761148621        initial
     2.3283e+00     2.3283e+01             1.8789e-04       -16.905761182105  <--
     9.3132e+00     9.3132e+01             4.7783e-05       -16.905761133720
     3.7253e+01     3.7253e+02             1.1904e-05       -16.905761137705

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 6.2549e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.091829e-01 1 1  ON 0
 uu_1                 1.424346e-01 1 1  ON 1
 uu_2                 4.097392e-02 1 1  ON 2
 uu_3                -2.134762e-02 1 1  ON 3
 uu_4                -6.659953e-02 1 1  ON 4
 uu_5                -1.014038e-01 1 1  ON 5
 uu_6                -1.283814e-01 1 1  ON 6
 uu_7                -1.414396e-01 1 1  ON 7
 uu_8                -1.333878e-01 1 1  ON 8
 uu_9                -1.049953e-01 1 1  ON 9
 ud_0                 4.476285e-01 1 1  ON 10
 ud_1                 1.823751e-01 1 1  ON 11
 ud_2                 6.290122e-02 1 1  ON 12
 ud_3                -7.517652e-03 1 1  ON 13
 ud_4                -6.479697e-02 1 1  ON 14
 ud_5                -1.069138e-01 1 1  ON 15
 ud_6                -1.349559e-01 1 1  ON 16
 ud_7                -1.520164e-01 1 1  ON 17
 ud_8                -1.529373e-01 1 1  ON 18
 ud_9                -1.433422e-01 1 1  ON 19
 eO_0                -7.600191e-01 1 1  ON 20
 eO_1                -4.399803e-01 1 1  ON 21
 eO_2                -2.174410e-02 1 1  ON 22
 eO_3                 2.986226e-01 1 1  ON 23
 eO_4                 5.253780e-01 1 1  ON 24
 eO_5                 4.877568e-01 1 1  ON 25
 eO_6                 2.599478e-01 1 1  ON 26
 eO_7                -4.074077e-02 1 1  ON 27
 eO_8                -2.213795e-01 1 1  ON 28
 eO_9                -8.644338e-02 1 1  ON 29
eH1_0                -2.444660e-01 1 1  ON 30
eH1_1                -1.452028e-01 1 1  ON 31
eH1_2                -9.861128e-02 1 1  ON 32
eH1_3                -4.485872e-02 1 1  ON 33
eH1_4                 3.288039e-03 1 1  ON 34
eH1_5                 3.808734e-02 1 1  ON 35
eH1_6                 9.658017e-02 1 1  ON 36
eH1_7                 1.541077e-01 1 1  ON 37
eH1_8                 1.772042e-01 1 1  ON 38
eH1_9                 6.788175e-02 1 1  ON 39
eH2_0                -2.421849e-01 1 1  ON 40
eH2_1                -1.429208e-01 1 1  ON 41
eH2_2                -9.648952e-02 1 1  ON 42
eH2_3                -4.250403e-02 1 1  ON 43
eH2_4                 5.510751e-03 1 1  ON 44
eH2_5                 4.022140e-02 1 1  ON 45
eH2_6                 9.949073e-02 1 1  ON 46
eH2_7                 1.552746e-01 1 1  ON 47
eH2_8                 1.827276e-01 1 1  ON 48
eH2_9                 5.742141e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1365e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9221
    reference variance = 0.317853
====================================================
  Execution time = 4.0420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3798e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0791e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337847491448
                                         uncertainty =       0.003953282905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337847491448
                                         uncertainty =       0.003953282905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411081724
  error estimate for blocks of size 2^( 2) =       0.000423774292
  error estimate for blocks of size 2^( 3) =       0.000436519066
  error estimate for blocks of size 2^( 4) =       0.000447656383
  error estimate for blocks of size 2^( 5) =       0.000459113038
  error estimate for blocks of size 2^( 6) =       0.000466440745
  error estimate for blocks of size 2^( 7) =       0.000470029068

      target function =                  N/A
              le_mean =     -16.906117908261
             les_mean =     286.154798926793
             stat err =       0.000460809808
             autocorr =       1.256571166972
              std dev =       0.581357349452
             le_variance =       0.337976367762


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611790826e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906117908261       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906121622009       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906122450428       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906122787388       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906123450901       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906123300614       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906123908119       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906123641118       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906123742599       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906123699201       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 6.753934e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906117908261       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906119031184       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906119315127       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906119448728       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906119567395       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906119495265       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906119669455       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906119613758       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906119627846       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 1.805514e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906117908261       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906118204506       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906118283746       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906118319880       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906118347806       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906118326718       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906118369915       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906118356335       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 4.559471e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1219e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.092019e-01 1 1  ON 0
 uu_1                 1.424344e-01 1 1  ON 1
 uu_2                 4.098729e-02 1 1  ON 2
 uu_3                -2.135164e-02 1 1  ON 3
 uu_4                -6.660529e-02 1 1  ON 4
 uu_5                -1.013792e-01 1 1  ON 5
 uu_6                -1.284424e-01 1 1  ON 6
 uu_7                -1.414881e-01 1 1  ON 7
 uu_8                -1.334076e-01 1 1  ON 8
 uu_9                -1.049913e-01 1 1  ON 9
 ud_0                 4.477159e-01 1 1  ON 10
 ud_1                 1.824476e-01 1 1  ON 11
 ud_2                 6.289683e-02 1 1  ON 12
 ud_3                -7.571427e-03 1 1  ON 13
 ud_4                -6.486380e-02 1 1  ON 14
 ud_5                -1.069404e-01 1 1  ON 15
 ud_6                -1.349765e-01 1 1  ON 16
 ud_7                -1.520553e-01 1 1  ON 17
 ud_8                -1.529470e-01 1 1  ON 18
 ud_9                -1.432979e-01 1 1  ON 19
 eO_0                -7.600894e-01 1 1  ON 20
 eO_1                -4.399272e-01 1 1  ON 21
 eO_2                -2.169678e-02 1 1  ON 22
 eO_3                 2.986713e-01 1 1  ON 23
 eO_4                 5.253319e-01 1 1  ON 24
 eO_5                 4.877744e-01 1 1  ON 25
 eO_6                 2.599616e-01 1 1  ON 26
 eO_7                -4.070831e-02 1 1  ON 27
 eO_8                -2.214169e-01 1 1  ON 28
 eO_9                -8.649417e-02 1 1  ON 29
eH1_0                -2.446420e-01 1 1  ON 30
eH1_1                -1.452114e-01 1 1  ON 31
eH1_2                -9.857541e-02 1 1  ON 32
eH1_3                -4.487359e-02 1 1  ON 33
eH1_4                 3.332786e-03 1 1  ON 34
eH1_5                 3.810157e-02 1 1  ON 35
eH1_6                 9.658067e-02 1 1  ON 36
eH1_7                 1.540941e-01 1 1  ON 37
eH1_8                 1.772305e-01 1 1  ON 38
eH1_9                 6.795674e-02 1 1  ON 39
eH2_0                -2.423655e-01 1 1  ON 40
eH2_1                -1.429934e-01 1 1  ON 41
eH2_2                -9.643154e-02 1 1  ON 42
eH2_3                -4.245813e-02 1 1  ON 43
eH2_4                 5.535469e-03 1 1  ON 44
eH2_5                 4.018918e-02 1 1  ON 45
eH2_6                 9.949272e-02 1 1  ON 46
eH2_7                 1.552947e-01 1 1  ON 47
eH2_8                 1.827670e-01 1 1  ON 48
eH2_9                 5.750768e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8709
    reference variance = 0.239648
====================================================
  Execution time = 3.9197e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3666e-01
  Total weights = 2.0000e+06
  Execution time = 3.7043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336679586683
                                         uncertainty =       0.004274330491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336679586683
                                         uncertainty =       0.004274330491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410256448
  error estimate for blocks of size 2^( 2) =       0.000423199136
  error estimate for blocks of size 2^( 3) =       0.000436261055
  error estimate for blocks of size 2^( 4) =       0.000447838985
  error estimate for blocks of size 2^( 5) =       0.000458986578
  error estimate for blocks of size 2^( 6) =       0.000467295724
  error estimate for blocks of size 2^( 7) =       0.000471825683

      target function =                  N/A
              le_mean =     -16.906092627243
             les_mean =     286.152588459398
             stat err =       0.000461486742
             autocorr =       1.265341134379
              std dev =       0.580190233278
             le_variance =       0.336620706791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336816724368
                                         uncertainty =       0.004275502362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336816724368
                                         uncertainty =       0.004275502362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410340018
  error estimate for blocks of size 2^( 2) =       0.000423273062
  error estimate for blocks of size 2^( 3) =       0.000436323074
  error estimate for blocks of size 2^( 4) =       0.000447894574
  error estimate for blocks of size 2^( 5) =       0.000459039360
  error estimate for blocks of size 2^( 6) =       0.000467348158
  error estimate for blocks of size 2^( 7) =       0.000471874258

      target function =                  N/A
              le_mean =     -16.906092102761
             les_mean =     286.152707880033
             stat err =       0.000461539087
             autocorr =       1.265112733583
              std dev =       0.580308419169
             le_variance =       0.336757861358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336755429017
                                         uncertainty =       0.004274858746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336755429017
                                         uncertainty =       0.004274858746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410302664
  error estimate for blocks of size 2^( 2) =       0.000423239545
  error estimate for blocks of size 2^( 3) =       0.000436294311
  error estimate for blocks of size 2^( 4) =       0.000447868388
  error estimate for blocks of size 2^( 5) =       0.000459014064
  error estimate for blocks of size 2^( 6) =       0.000467322448
  error estimate for blocks of size 2^( 7) =       0.000471849359

      target function =                  N/A
              le_mean =     -16.906092132708
             les_mean =     286.152647583025
             stat err =       0.000461513565
             autocorr =       1.265203158847
              std dev =       0.580255591751
             le_variance =       0.336696551758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336688274135
                                         uncertainty =       0.004274385450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336688274135
                                         uncertainty =       0.004274385450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410261742
  error estimate for blocks of size 2^( 2) =       0.000423203690
  error estimate for blocks of size 2^( 3) =       0.000436264688
  error estimate for blocks of size 2^( 4) =       0.000447842133
  error estimate for blocks of size 2^( 5) =       0.000458989493
  error estimate for blocks of size 2^( 6) =       0.000467298532
  error estimate for blocks of size 2^( 7) =       0.000471828067

      target function =                  N/A
              le_mean =     -16.906092529325
             les_mean =     286.152593836341
             stat err =       0.000461489556
             autocorr =       1.265323908909
              std dev =       0.580197720216
             le_variance =       0.336629394544


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906092627243        initial  <--
     5.8208e-01     5.8208e+00             6.7539e-04       -16.906092102761
     2.3283e+00     2.3283e+01             1.8055e-04       -16.906092132708
     9.3132e+00     9.3132e+01             4.5595e-05       -16.906092529325

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.8544
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.091829e-01 1 1  ON 0
 uu_1                 1.424346e-01 1 1  ON 1
 uu_2                 4.097392e-02 1 1  ON 2
 uu_3                -2.134762e-02 1 1  ON 3
 uu_4                -6.659953e-02 1 1  ON 4
 uu_5                -1.014038e-01 1 1  ON 5
 uu_6                -1.283814e-01 1 1  ON 6
 uu_7                -1.414396e-01 1 1  ON 7
 uu_8                -1.333878e-01 1 1  ON 8
 uu_9                -1.049953e-01 1 1  ON 9
 ud_0                 4.476285e-01 1 1  ON 10
 ud_1                 1.823751e-01 1 1  ON 11
 ud_2                 6.290122e-02 1 1  ON 12
 ud_3                -7.517652e-03 1 1  ON 13
 ud_4                -6.479697e-02 1 1  ON 14
 ud_5                -1.069138e-01 1 1  ON 15
 ud_6                -1.349559e-01 1 1  ON 16
 ud_7                -1.520164e-01 1 1  ON 17
 ud_8                -1.529373e-01 1 1  ON 18
 ud_9                -1.433422e-01 1 1  ON 19
 eO_0                -7.600191e-01 1 1  ON 20
 eO_1                -4.399803e-01 1 1  ON 21
 eO_2                -2.174410e-02 1 1  ON 22
 eO_3                 2.986226e-01 1 1  ON 23
 eO_4                 5.253780e-01 1 1  ON 24
 eO_5                 4.877568e-01 1 1  ON 25
 eO_6                 2.599478e-01 1 1  ON 26
 eO_7                -4.074077e-02 1 1  ON 27
 eO_8                -2.213795e-01 1 1  ON 28
 eO_9                -8.644338e-02 1 1  ON 29
eH1_0                -2.444660e-01 1 1  ON 30
eH1_1                -1.452028e-01 1 1  ON 31
eH1_2                -9.861128e-02 1 1  ON 32
eH1_3                -4.485872e-02 1 1  ON 33
eH1_4                 3.288039e-03 1 1  ON 34
eH1_5                 3.808734e-02 1 1  ON 35
eH1_6                 9.658017e-02 1 1  ON 36
eH1_7                 1.541077e-01 1 1  ON 37
eH1_8                 1.772042e-01 1 1  ON 38
eH1_9                 6.788175e-02 1 1  ON 39
eH2_0                -2.421849e-01 1 1  ON 40
eH2_1                -1.429208e-01 1 1  ON 41
eH2_2                -9.648952e-02 1 1  ON 42
eH2_3                -4.250403e-02 1 1  ON 43
eH2_4                 5.510751e-03 1 1  ON 44
eH2_5                 4.022140e-02 1 1  ON 45
eH2_6                 9.949073e-02 1 1  ON 46
eH2_7                 1.552746e-01 1 1  ON 47
eH2_8                 1.827276e-01 1 1  ON 48
eH2_9                 5.742141e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0908e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9612
    reference variance = 0.206618
====================================================
  Execution time = 4.0127e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3570e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1016e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335551183967
                                         uncertainty =       0.002630711262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335551183967
                                         uncertainty =       0.002630711262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409695103
  error estimate for blocks of size 2^( 2) =       0.000422235549
  error estimate for blocks of size 2^( 3) =       0.000434844779
  error estimate for blocks of size 2^( 4) =       0.000446923202
  error estimate for blocks of size 2^( 5) =       0.000457133872
  error estimate for blocks of size 2^( 6) =       0.000464056055
  error estimate for blocks of size 2^( 7) =       0.000466852136

      target function =                  N/A
              le_mean =     -16.905926573911
             les_mean =     286.146053309352
             stat err =       0.000458741316
             autocorr =       1.253759298157
              std dev =       0.579396370997
             le_variance =       0.335700154724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592657391e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926573911       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926703114       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926609340       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926580041       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926685260       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926859698       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926809960       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926820757       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905926802227       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 6.123734e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926573911       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926607049       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926583272       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926573861       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926598823       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926643137       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926630833       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926634132       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905926630098       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 1.535056e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926573911       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926582250       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926576284       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926573798       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926579945       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926591062       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926587992       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926588851       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905926587883       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 3.839989e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1152e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.091867e-01 1 1  ON 0
 uu_1                 1.424414e-01 1 1  ON 1
 uu_2                 4.097230e-02 1 1  ON 2
 uu_3                -2.135145e-02 1 1  ON 3
 uu_4                -6.659993e-02 1 1  ON 4
 uu_5                -1.014015e-01 1 1  ON 5
 uu_6                -1.283859e-01 1 1  ON 6
 uu_7                -1.414461e-01 1 1  ON 7
 uu_8                -1.333927e-01 1 1  ON 8
 uu_9                -1.049967e-01 1 1  ON 9
 ud_0                 4.476417e-01 1 1  ON 10
 ud_1                 1.823884e-01 1 1  ON 11
 ud_2                 6.290103e-02 1 1  ON 12
 ud_3                -7.524490e-03 1 1  ON 13
 ud_4                -6.480052e-02 1 1  ON 14
 ud_5                -1.069125e-01 1 1  ON 15
 ud_6                -1.349566e-01 1 1  ON 16
 ud_7                -1.520221e-01 1 1  ON 17
 ud_8                -1.529454e-01 1 1  ON 18
 ud_9                -1.433442e-01 1 1  ON 19
 eO_0                -7.600234e-01 1 1  ON 20
 eO_1                -4.399815e-01 1 1  ON 21
 eO_2                -2.173790e-02 1 1  ON 22
 eO_3                 2.986289e-01 1 1  ON 23
 eO_4                 5.253814e-01 1 1  ON 24
 eO_5                 4.877561e-01 1 1  ON 25
 eO_6                 2.599497e-01 1 1  ON 26
 eO_7                -4.074030e-02 1 1  ON 27
 eO_8                -2.213854e-01 1 1  ON 28
 eO_9                -8.644901e-02 1 1  ON 29
eH1_0                -2.444814e-01 1 1  ON 30
eH1_1                -1.452144e-01 1 1  ON 31
eH1_2                -9.860906e-02 1 1  ON 32
eH1_3                -4.485182e-02 1 1  ON 33
eH1_4                 3.294946e-03 1 1  ON 34
eH1_5                 3.808970e-02 1 1  ON 35
eH1_6                 9.657658e-02 1 1  ON 36
eH1_7                 1.541081e-01 1 1  ON 37
eH1_8                 1.772096e-01 1 1  ON 38
eH1_9                 6.788777e-02 1 1  ON 39
eH2_0                -2.421964e-01 1 1  ON 40
eH2_1                -1.429258e-01 1 1  ON 41
eH2_2                -9.649004e-02 1 1  ON 42
eH2_3                -4.250386e-02 1 1  ON 43
eH2_4                 5.522108e-03 1 1  ON 44
eH2_5                 4.022002e-02 1 1  ON 45
eH2_6                 9.948578e-02 1 1  ON 46
eH2_7                 1.552740e-01 1 1  ON 47
eH2_8                 1.827328e-01 1 1  ON 48
eH2_9                 5.742897e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8845
    reference variance = 0.157915
====================================================
  Execution time = 3.8741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3839e-01
  Total weights = 2.0000e+06
  Execution time = 3.7204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338409384988
                                         uncertainty =       0.004039360136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338409384988
                                         uncertainty =       0.004039360136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411328826
  error estimate for blocks of size 2^( 2) =       0.000424007175
  error estimate for blocks of size 2^( 3) =       0.000437793448
  error estimate for blocks of size 2^( 4) =       0.000450865030
  error estimate for blocks of size 2^( 5) =       0.000461780061
  error estimate for blocks of size 2^( 6) =       0.000469897173
  error estimate for blocks of size 2^( 7) =       0.000473551653

      target function =                  N/A
              le_mean =     -16.905545310978
             les_mean =     286.135844899037
             stat err =       0.000464023479
             autocorr =       1.272628425864
              std dev =       0.581706804767
             le_variance =       0.338382806713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338447439612
                                         uncertainty =       0.004039820882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338447439612
                                         uncertainty =       0.004039820882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411351965
  error estimate for blocks of size 2^( 2) =       0.000424028048
  error estimate for blocks of size 2^( 3) =       0.000437811919
  error estimate for blocks of size 2^( 4) =       0.000450881148
  error estimate for blocks of size 2^( 5) =       0.000461795701
  error estimate for blocks of size 2^( 6) =       0.000469912779
  error estimate for blocks of size 2^( 7) =       0.000473566136

      target function =                  N/A
              le_mean =     -16.905545191604
             les_mean =     286.135878934019
             stat err =       0.000464038941
             autocorr =       1.272570060355
              std dev =       0.581739527516
             le_variance =       0.338420877875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338428584698
                                         uncertainty =       0.004039594670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338428584698
                                         uncertainty =       0.004039594670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411340501
  error estimate for blocks of size 2^( 2) =       0.000424017693
  error estimate for blocks of size 2^( 3) =       0.000437802737
  error estimate for blocks of size 2^( 4) =       0.000450873107
  error estimate for blocks of size 2^( 5) =       0.000461787901
  error estimate for blocks of size 2^( 6) =       0.000469904986
  error estimate for blocks of size 2^( 7) =       0.000473558868

      target function =                  N/A
              le_mean =     -16.905545247491
             les_mean =     286.135861961234
             stat err =       0.000464031215
             autocorr =       1.272598619152
              std dev =       0.581723315230
             le_variance =       0.338402015482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338411787343
                                         uncertainty =       0.004039389589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338411787343
                                         uncertainty =       0.004039389589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411330287
  error estimate for blocks of size 2^( 2) =       0.000424008490
  error estimate for blocks of size 2^( 3) =       0.000437794609
  error estimate for blocks of size 2^( 4) =       0.000450866038
  error estimate for blocks of size 2^( 5) =       0.000461781039
  error estimate for blocks of size 2^( 6) =       0.000469898148
  error estimate for blocks of size 2^( 7) =       0.000473552551

      target function =                  N/A
              le_mean =     -16.905545302438
             les_mean =     286.135847013806
             stat err =       0.000464024444
             autocorr =       1.272624677764
              std dev =       0.581708870679
             le_variance =       0.338385210227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905545310978        initial  <--
     5.8208e+00     5.8208e+01             6.1237e-05       -16.905545191604
     2.3283e+01     2.3283e+02             1.5351e-05       -16.905545247491
     9.3132e+01     9.3132e+02             3.8400e-06       -16.905545302438

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.4389
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.091829e-01 1 1  ON 0
 uu_1                 1.424346e-01 1 1  ON 1
 uu_2                 4.097392e-02 1 1  ON 2
 uu_3                -2.134762e-02 1 1  ON 3
 uu_4                -6.659953e-02 1 1  ON 4
 uu_5                -1.014038e-01 1 1  ON 5
 uu_6                -1.283814e-01 1 1  ON 6
 uu_7                -1.414396e-01 1 1  ON 7
 uu_8                -1.333878e-01 1 1  ON 8
 uu_9                -1.049953e-01 1 1  ON 9
 ud_0                 4.476285e-01 1 1  ON 10
 ud_1                 1.823751e-01 1 1  ON 11
 ud_2                 6.290122e-02 1 1  ON 12
 ud_3                -7.517652e-03 1 1  ON 13
 ud_4                -6.479697e-02 1 1  ON 14
 ud_5                -1.069138e-01 1 1  ON 15
 ud_6                -1.349559e-01 1 1  ON 16
 ud_7                -1.520164e-01 1 1  ON 17
 ud_8                -1.529373e-01 1 1  ON 18
 ud_9                -1.433422e-01 1 1  ON 19
 eO_0                -7.600191e-01 1 1  ON 20
 eO_1                -4.399803e-01 1 1  ON 21
 eO_2                -2.174410e-02 1 1  ON 22
 eO_3                 2.986226e-01 1 1  ON 23
 eO_4                 5.253780e-01 1 1  ON 24
 eO_5                 4.877568e-01 1 1  ON 25
 eO_6                 2.599478e-01 1 1  ON 26
 eO_7                -4.074077e-02 1 1  ON 27
 eO_8                -2.213795e-01 1 1  ON 28
 eO_9                -8.644338e-02 1 1  ON 29
eH1_0                -2.444660e-01 1 1  ON 30
eH1_1                -1.452028e-01 1 1  ON 31
eH1_2                -9.861128e-02 1 1  ON 32
eH1_3                -4.485872e-02 1 1  ON 33
eH1_4                 3.288039e-03 1 1  ON 34
eH1_5                 3.808734e-02 1 1  ON 35
eH1_6                 9.658017e-02 1 1  ON 36
eH1_7                 1.541077e-01 1 1  ON 37
eH1_8                 1.772042e-01 1 1  ON 38
eH1_9                 6.788175e-02 1 1  ON 39
eH2_0                -2.421849e-01 1 1  ON 40
eH2_1                -1.429208e-01 1 1  ON 41
eH2_2                -9.648952e-02 1 1  ON 42
eH2_3                -4.250403e-02 1 1  ON 43
eH2_4                 5.510751e-03 1 1  ON 44
eH2_5                 4.022140e-02 1 1  ON 45
eH2_6                 9.949073e-02 1 1  ON 46
eH2_7                 1.552746e-01 1 1  ON 47
eH2_8                 1.827276e-01 1 1  ON 48
eH2_9                 5.742141e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0860e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9001
    reference variance = 0.423084
====================================================
  Execution time = 4.0229e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3883e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0795e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338860396198
                                         uncertainty =       0.005496376145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338860396198
                                         uncertainty =       0.005496376145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411600312
  error estimate for blocks of size 2^( 2) =       0.000424309461
  error estimate for blocks of size 2^( 3) =       0.000437072024
  error estimate for blocks of size 2^( 4) =       0.000449435676
  error estimate for blocks of size 2^( 5) =       0.000460365914
  error estimate for blocks of size 2^( 6) =       0.000467800997
  error estimate for blocks of size 2^( 7) =       0.000472323141

      target function =                  N/A
              le_mean =     -16.905547825943
             les_mean =     286.136376760197
             stat err =       0.000462481432
             autocorr =       1.262516931177
              std dev =       0.582090744093
             le_variance =       0.338829634358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690554782594e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905547825943       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905547885604       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905547891589       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905547901493       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905547902734       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905547899200       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905547901199       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905547901837       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 7.056399e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905547825943       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905547840896       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905547842390       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905547844867       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905547845200       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905547844307       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905547844800       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905547844962       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 1.767987e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905547825943       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905547829684       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905547830057       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905547830677       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905547830760       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905547830537       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905547830660       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905547830699       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 4.422397e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200362 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1031e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.091834e-01 1 1  ON 0
 uu_1                 1.424348e-01 1 1  ON 1
 uu_2                 4.097400e-02 1 1  ON 2
 uu_3                -2.134787e-02 1 1  ON 3
 uu_4                -6.659955e-02 1 1  ON 4
 uu_5                -1.014032e-01 1 1  ON 5
 uu_6                -1.283814e-01 1 1  ON 6
 uu_7                -1.414406e-01 1 1  ON 7
 uu_8                -1.333885e-01 1 1  ON 8
 uu_9                -1.049955e-01 1 1  ON 9
 ud_0                 4.476303e-01 1 1  ON 10
 ud_1                 1.823760e-01 1 1  ON 11
 ud_2                 6.290103e-02 1 1  ON 12
 ud_3                -7.518744e-03 1 1  ON 13
 ud_4                -6.479732e-02 1 1  ON 14
 ud_5                -1.069141e-01 1 1  ON 15
 ud_6                -1.349556e-01 1 1  ON 16
 ud_7                -1.520162e-01 1 1  ON 17
 ud_8                -1.529376e-01 1 1  ON 18
 ud_9                -1.433428e-01 1 1  ON 19
 eO_0                -7.600199e-01 1 1  ON 20
 eO_1                -4.399799e-01 1 1  ON 21
 eO_2                -2.174337e-02 1 1  ON 22
 eO_3                 2.986230e-01 1 1  ON 23
 eO_4                 5.253781e-01 1 1  ON 24
 eO_5                 4.877569e-01 1 1  ON 25
 eO_6                 2.599479e-01 1 1  ON 26
 eO_7                -4.074071e-02 1 1  ON 27
 eO_8                -2.213799e-01 1 1  ON 28
 eO_9                -8.644396e-02 1 1  ON 29
eH1_0                -2.444676e-01 1 1  ON 30
eH1_1                -1.452033e-01 1 1  ON 31
eH1_2                -9.861086e-02 1 1  ON 32
eH1_3                -4.485857e-02 1 1  ON 33
eH1_4                 3.288002e-03 1 1  ON 34
eH1_5                 3.808713e-02 1 1  ON 35
eH1_6                 9.658036e-02 1 1  ON 36
eH1_7                 1.541080e-01 1 1  ON 37
eH1_8                 1.772049e-01 1 1  ON 38
eH1_9                 6.788243e-02 1 1  ON 39
eH2_0                -2.421865e-01 1 1  ON 40
eH2_1                -1.429213e-01 1 1  ON 41
eH2_2                -9.648900e-02 1 1  ON 42
eH2_3                -4.250352e-02 1 1  ON 43
eH2_4                 5.510384e-03 1 1  ON 44
eH2_5                 4.022120e-02 1 1  ON 45
eH2_6                 9.949094e-02 1 1  ON 46
eH2_7                 1.552747e-01 1 1  ON 47
eH2_8                 1.827281e-01 1 1  ON 48
eH2_9                 5.742224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9399
    reference variance = 0.256406
====================================================
  Execution time = 4.0595e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4147e-01
  Total weights = 2.0000e+06
  Execution time = 3.7109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341499309956
                                         uncertainty =       0.004511678499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341499309956
                                         uncertainty =       0.004511678499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413197916
  error estimate for blocks of size 2^( 2) =       0.000425914626
  error estimate for blocks of size 2^( 3) =       0.000439700444
  error estimate for blocks of size 2^( 4) =       0.000452768199
  error estimate for blocks of size 2^( 5) =       0.000463650565
  error estimate for blocks of size 2^( 6) =       0.000472091772
  error estimate for blocks of size 2^( 7) =       0.000478951507

      target function =                  N/A
              le_mean =     -16.905893074809
             les_mean =     286.150685522259
             stat err =       0.000466865511
             autocorr =       1.276636739987
              std dev =       0.584350097213
             le_variance =       0.341465036113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341504819505
                                         uncertainty =       0.004511796283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341504819505
                                         uncertainty =       0.004511796283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413201247
  error estimate for blocks of size 2^( 2) =       0.000425917634
  error estimate for blocks of size 2^( 3) =       0.000439703124
  error estimate for blocks of size 2^( 4) =       0.000452770704
  error estimate for blocks of size 2^( 5) =       0.000463652937
  error estimate for blocks of size 2^( 6) =       0.000472094181
  error estimate for blocks of size 2^( 7) =       0.000478953918

      target function =                  N/A
              le_mean =     -16.905893085747
             les_mean =     286.150691397395
             stat err =       0.000466867935
             autocorr =       1.276629415274
              std dev =       0.584354807815
             le_variance =       0.341470541416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341502071018
                                         uncertainty =       0.004511737547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341502071018
                                         uncertainty =       0.004511737547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413199586
  error estimate for blocks of size 2^( 2) =       0.000425916133
  error estimate for blocks of size 2^( 3) =       0.000439701787
  error estimate for blocks of size 2^( 4) =       0.000452769454
  error estimate for blocks of size 2^( 5) =       0.000463651754
  error estimate for blocks of size 2^( 6) =       0.000472092979
  error estimate for blocks of size 2^( 7) =       0.000478952715

      target function =                  N/A
              le_mean =     -16.905893080226
             les_mean =     286.150688464346
             stat err =       0.000466866726
             autocorr =       1.276633068240
              std dev =       0.584352457891
             le_variance =       0.341467795043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341499655265
                                         uncertainty =       0.004511685884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341499655265
                                         uncertainty =       0.004511685884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413198125
  error estimate for blocks of size 2^( 2) =       0.000425914815
  error estimate for blocks of size 2^( 3) =       0.000439700612
  error estimate for blocks of size 2^( 4) =       0.000452768356
  error estimate for blocks of size 2^( 5) =       0.000463650714
  error estimate for blocks of size 2^( 6) =       0.000472091923
  error estimate for blocks of size 2^( 7) =       0.000478951658

      target function =                  N/A
              le_mean =     -16.905893075479
             les_mean =     286.150685889955
             stat err =       0.000466865663
             autocorr =       1.276636280689
              std dev =       0.584350392449
             le_variance =       0.341465381156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905893074809        initial
     5.8208e+01     5.8208e+02             7.0564e-06       -16.905893085747  <--
     2.3283e+02     2.3283e+03             1.7680e-06       -16.905893080226
     9.3132e+02     9.3132e+03             4.4224e-07       -16.905893075479

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 5.9096e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.091848e-01 1 1  ON 0
 uu_1                 1.424353e-01 1 1  ON 1
 uu_2                 4.097423e-02 1 1  ON 2
 uu_3                -2.134864e-02 1 1  ON 3
 uu_4                -6.659962e-02 1 1  ON 4
 uu_5                -1.014016e-01 1 1  ON 5
 uu_6                -1.283814e-01 1 1  ON 6
 uu_7                -1.414434e-01 1 1  ON 7
 uu_8                -1.333906e-01 1 1  ON 8
 uu_9                -1.049959e-01 1 1  ON 9
 ud_0                 4.476355e-01 1 1  ON 10
 ud_1                 1.823785e-01 1 1  ON 11
 ud_2                 6.290048e-02 1 1  ON 12
 ud_3                -7.522005e-03 1 1  ON 13
 ud_4                -6.479838e-02 1 1  ON 14
 ud_5                -1.069148e-01 1 1  ON 15
 ud_6                -1.349546e-01 1 1  ON 16
 ud_7                -1.520155e-01 1 1  ON 17
 ud_8                -1.529385e-01 1 1  ON 18
 ud_9                -1.433446e-01 1 1  ON 19
 eO_0                -7.600222e-01 1 1  ON 20
 eO_1                -4.399788e-01 1 1  ON 21
 eO_2                -2.174115e-02 1 1  ON 22
 eO_3                 2.986242e-01 1 1  ON 23
 eO_4                 5.253785e-01 1 1  ON 24
 eO_5                 4.877573e-01 1 1  ON 25
 eO_6                 2.599481e-01 1 1  ON 26
 eO_7                -4.074053e-02 1 1  ON 27
 eO_8                -2.213812e-01 1 1  ON 28
 eO_9                -8.644572e-02 1 1  ON 29
eH1_0                -2.444724e-01 1 1  ON 30
eH1_1                -1.452048e-01 1 1  ON 31
eH1_2                -9.860959e-02 1 1  ON 32
eH1_3                -4.485814e-02 1 1  ON 33
eH1_4                 3.287888e-03 1 1  ON 34
eH1_5                 3.808647e-02 1 1  ON 35
eH1_6                 9.658094e-02 1 1  ON 36
eH1_7                 1.541087e-01 1 1  ON 37
eH1_8                 1.772069e-01 1 1  ON 38
eH1_9                 6.788444e-02 1 1  ON 39
eH2_0                -2.421911e-01 1 1  ON 40
eH2_1                -1.429229e-01 1 1  ON 41
eH2_2                -9.648744e-02 1 1  ON 42
eH2_3                -4.250197e-02 1 1  ON 43
eH2_4                 5.509288e-03 1 1  ON 44
eH2_5                 4.022060e-02 1 1  ON 45
eH2_6                 9.949156e-02 1 1  ON 46
eH2_7                 1.552747e-01 1 1  ON 47
eH2_8                 1.827295e-01 1 1  ON 48
eH2_9                 5.742472e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1013e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9331
    reference variance = 0.270866
====================================================
  Execution time = 3.9662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4402e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0820e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343965608998
                                         uncertainty =       0.004800932812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343965608998
                                         uncertainty =       0.004800932812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414740832
  error estimate for blocks of size 2^( 2) =       0.000427492754
  error estimate for blocks of size 2^( 3) =       0.000439894076
  error estimate for blocks of size 2^( 4) =       0.000452512117
  error estimate for blocks of size 2^( 5) =       0.000462533670
  error estimate for blocks of size 2^( 6) =       0.000470177368
  error estimate for blocks of size 2^( 7) =       0.000473375752

      target function =                  N/A
              le_mean =     -16.905734966416
             les_mean =     286.147894498389
             stat err =       0.000464649727
             autocorr =       1.255156220666
              std dev =       0.586532109692
             le_variance =       0.344019915700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573496642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905734966416       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905735109520       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905735091775       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905735102076       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905735126101       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905735128520       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905735142994       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905735144274       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 2.703171e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905734966416       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905735002553       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905734998003       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905735000451       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905735006408       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905735006821       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905735010414       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905735010730       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 6.773178e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905734966416       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905734975473       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905734974328       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905734974932       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905734976418       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905734976510       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905734977406       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905734977483       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 1.694240e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0490e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.091841e-01 1 1  ON 0
 uu_1                 1.424369e-01 1 1  ON 1
 uu_2                 4.097587e-02 1 1  ON 2
 uu_3                -2.134986e-02 1 1  ON 3
 uu_4                -6.660074e-02 1 1  ON 4
 uu_5                -1.014007e-01 1 1  ON 5
 uu_6                -1.283823e-01 1 1  ON 6
 uu_7                -1.414447e-01 1 1  ON 7
 uu_8                -1.333911e-01 1 1  ON 8
 uu_9                -1.049962e-01 1 1  ON 9
 ud_0                 4.476371e-01 1 1  ON 10
 ud_1                 1.823828e-01 1 1  ON 11
 ud_2                 6.289971e-02 1 1  ON 12
 ud_3                -7.526703e-03 1 1  ON 13
 ud_4                -6.479969e-02 1 1  ON 14
 ud_5                -1.069153e-01 1 1  ON 15
 ud_6                -1.349555e-01 1 1  ON 16
 ud_7                -1.520163e-01 1 1  ON 17
 ud_8                -1.529356e-01 1 1  ON 18
 ud_9                -1.433431e-01 1 1  ON 19
 eO_0                -7.600250e-01 1 1  ON 20
 eO_1                -4.399783e-01 1 1  ON 21
 eO_2                -2.173980e-02 1 1  ON 22
 eO_3                 2.986282e-01 1 1  ON 23
 eO_4                 5.253802e-01 1 1  ON 24
 eO_5                 4.877556e-01 1 1  ON 25
 eO_6                 2.599480e-01 1 1  ON 26
 eO_7                -4.074002e-02 1 1  ON 27
 eO_8                -2.213822e-01 1 1  ON 28
 eO_9                -8.644779e-02 1 1  ON 29
eH1_0                -2.444791e-01 1 1  ON 30
eH1_1                -1.452090e-01 1 1  ON 31
eH1_2                -9.860895e-02 1 1  ON 32
eH1_3                -4.485602e-02 1 1  ON 33
eH1_4                 3.291969e-03 1 1  ON 34
eH1_5                 3.808789e-02 1 1  ON 35
eH1_6                 9.658019e-02 1 1  ON 36
eH1_7                 1.541079e-01 1 1  ON 37
eH1_8                 1.772087e-01 1 1  ON 38
eH1_9                 6.788692e-02 1 1  ON 39
eH2_0                -2.421976e-01 1 1  ON 40
eH2_1                -1.429264e-01 1 1  ON 41
eH2_2                -9.648795e-02 1 1  ON 42
eH2_3                -4.249955e-02 1 1  ON 43
eH2_4                 5.510787e-03 1 1  ON 44
eH2_5                 4.022085e-02 1 1  ON 45
eH2_6                 9.949062e-02 1 1  ON 46
eH2_7                 1.552746e-01 1 1  ON 47
eH2_8                 1.827318e-01 1 1  ON 48
eH2_9                 5.742886e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8362
    reference variance = 0.363567
====================================================
  Execution time = 3.8744e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3083e-01
  Total weights = 2.0000e+06
  Execution time = 3.6713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839611076
                                         uncertainty =       0.002352286106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839611076
                                         uncertainty =       0.002352286106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406712548
  error estimate for blocks of size 2^( 2) =       0.000419719076
  error estimate for blocks of size 2^( 3) =       0.000432697649
  error estimate for blocks of size 2^( 4) =       0.000444521088
  error estimate for blocks of size 2^( 5) =       0.000454871014
  error estimate for blocks of size 2^( 6) =       0.000463319041
  error estimate for blocks of size 2^( 7) =       0.000466402933

      target function =                  N/A
              le_mean =     -16.905606071613
             les_mean =     286.130346676329
             stat err =       0.000457278519
             autocorr =       1.264114632071
              std dev =       0.575178401170
             le_variance =       0.330830193173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839686855
                                         uncertainty =       0.002352281117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839686855
                                         uncertainty =       0.002352281117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406712593
  error estimate for blocks of size 2^( 2) =       0.000419718661
  error estimate for blocks of size 2^( 3) =       0.000432696552
  error estimate for blocks of size 2^( 4) =       0.000444519605
  error estimate for blocks of size 2^( 5) =       0.000454869418
  error estimate for blocks of size 2^( 6) =       0.000463317065
  error estimate for blocks of size 2^( 7) =       0.000466401132

      target function =                  N/A
              le_mean =     -16.905606270995
             les_mean =     286.130353491234
             stat err =       0.000457276805
             autocorr =       1.264104875105
              std dev =       0.575178465127
             le_variance =       0.330830266745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839503050
                                         uncertainty =       0.002352282723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839503050
                                         uncertainty =       0.002352282723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406712481
  error estimate for blocks of size 2^( 2) =       0.000419718779
  error estimate for blocks of size 2^( 3) =       0.000432697009
  error estimate for blocks of size 2^( 4) =       0.000444520256
  error estimate for blocks of size 2^( 5) =       0.000454870124
  error estimate for blocks of size 2^( 6) =       0.000463317958
  error estimate for blocks of size 2^( 7) =       0.000466401937

      target function =                  N/A
              le_mean =     -16.905606172787
             les_mean =     286.130349988020
             stat err =       0.000457277569
             autocorr =       1.264109794707
              std dev =       0.575178306307
             le_variance =       0.330830084046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839592436
                                         uncertainty =       0.002352285654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330839592436
                                         uncertainty =       0.002352285654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406712536
  error estimate for blocks of size 2^( 2) =       0.000419719035
  error estimate for blocks of size 2^( 3) =       0.000432697565
  error estimate for blocks of size 2^( 4) =       0.000444520981
  error estimate for blocks of size 2^( 5) =       0.000454870900
  error estimate for blocks of size 2^( 6) =       0.000463318902
  error estimate for blocks of size 2^( 7) =       0.000466402805

      target function =                  N/A
              le_mean =     -16.905606084242
             les_mean =     286.130347084533
             stat err =       0.000457278397
             autocorr =       1.264114028519
              std dev =       0.575178384847
             le_variance =       0.330830174395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905606071613        initial
     1.4552e+01     1.4552e+02             2.7032e-05       -16.905606270995  <--
     5.8208e+01     5.8208e+02             6.7732e-06       -16.905606172787
     2.3283e+02     2.3283e+03             1.6942e-06       -16.905606084242

*****************************************************************************
Applying the update for shift_i =   1.4552e+01     and shift_s =   1.4552e+02
*****************************************************************************

  Execution time = 5.7201e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.091820e-01 1 1  ON 0
 uu_1                 1.424415e-01 1 1  ON 1
 uu_2                 4.098060e-02 1 1  ON 2
 uu_3                -2.135343e-02 1 1  ON 3
 uu_4                -6.660411e-02 1 1  ON 4
 uu_5                -1.013983e-01 1 1  ON 5
 uu_6                -1.283852e-01 1 1  ON 6
 uu_7                -1.414486e-01 1 1  ON 7
 uu_8                -1.333927e-01 1 1  ON 8
 uu_9                -1.049971e-01 1 1  ON 9
 ud_0                 4.476421e-01 1 1  ON 10
 ud_1                 1.823953e-01 1 1  ON 11
 ud_2                 6.289748e-02 1 1  ON 12
 ud_3                -7.540565e-03 1 1  ON 13
 ud_4                -6.480377e-02 1 1  ON 14
 ud_5                -1.069168e-01 1 1  ON 15
 ud_6                -1.349580e-01 1 1  ON 16
 ud_7                -1.520186e-01 1 1  ON 17
 ud_8                -1.529270e-01 1 1  ON 18
 ud_9                -1.433387e-01 1 1  ON 19
 eO_0                -7.600335e-01 1 1  ON 20
 eO_1                -4.399768e-01 1 1  ON 21
 eO_2                -2.173574e-02 1 1  ON 22
 eO_3                 2.986398e-01 1 1  ON 23
 eO_4                 5.253852e-01 1 1  ON 24
 eO_5                 4.877508e-01 1 1  ON 25
 eO_6                 2.599480e-01 1 1  ON 26
 eO_7                -4.073847e-02 1 1  ON 27
 eO_8                -2.213853e-01 1 1  ON 28
 eO_9                -8.645395e-02 1 1  ON 29
eH1_0                -2.444994e-01 1 1  ON 30
eH1_1                -1.452213e-01 1 1  ON 31
eH1_2                -9.860704e-02 1 1  ON 32
eH1_3                -4.484973e-02 1 1  ON 33
eH1_4                 3.304133e-03 1 1  ON 34
eH1_5                 3.809213e-02 1 1  ON 35
eH1_6                 9.657793e-02 1 1  ON 36
eH1_7                 1.541055e-01 1 1  ON 37
eH1_8                 1.772138e-01 1 1  ON 38
eH1_9                 6.789433e-02 1 1  ON 39
eH2_0                -2.422169e-01 1 1  ON 40
eH2_1                -1.429369e-01 1 1  ON 41
eH2_2                -9.648948e-02 1 1  ON 42
eH2_3                -4.249239e-02 1 1  ON 43
eH2_4                 5.515284e-03 1 1  ON 44
eH2_5                 4.022156e-02 1 1  ON 45
eH2_6                 9.948782e-02 1 1  ON 46
eH2_7                 1.552744e-01 1 1  ON 47
eH2_8                 1.827387e-01 1 1  ON 48
eH2_9                 5.744122e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0770e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9119
    reference variance = 0.450087
====================================================
  Execution time = 3.9641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4243e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0630e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342414413816
                                         uncertainty =       0.007519251889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342414413816
                                         uncertainty =       0.007519251889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413781556
  error estimate for blocks of size 2^( 2) =       0.000426661819
  error estimate for blocks of size 2^( 3) =       0.000438850618
  error estimate for blocks of size 2^( 4) =       0.000450526949
  error estimate for blocks of size 2^( 5) =       0.000460161002
  error estimate for blocks of size 2^( 6) =       0.000468717495
  error estimate for blocks of size 2^( 7) =       0.000476363421

      target function =                  N/A
              le_mean =     -16.905800101090
             les_mean =     286.148507239600
             stat err =       0.000463942217
             autocorr =       1.257145454014
              std dev =       0.585175488900
             le_variance =       0.342430352809


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580010109e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800101090       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800677650       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800853066       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905800958898       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905801252092       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905801334132       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801370630       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905801329605       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905801352722       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 1.259198e-04

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800101090       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800250638       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800292449       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905800322557       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905800393648       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905800415152       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905800425563       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905800415349       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 3.164019e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800101090       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800138831       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905800149139       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905800156947       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905800174524       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905800179964       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905800182657       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905800180111       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 7.940105e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0279e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.091829e-01 1 1  ON 0
 uu_1                 1.424509e-01 1 1  ON 1
 uu_2                 4.098104e-02 1 1  ON 2
 uu_3                -2.134585e-02 1 1  ON 3
 uu_4                -6.660324e-02 1 1  ON 4
 uu_5                -1.013922e-01 1 1  ON 5
 uu_6                -1.283829e-01 1 1  ON 6
 uu_7                -1.414538e-01 1 1  ON 7
 uu_8                -1.334090e-01 1 1  ON 8
 uu_9                -1.050121e-01 1 1  ON 9
 ud_0                 4.476637e-01 1 1  ON 10
 ud_1                 1.824120e-01 1 1  ON 11
 ud_2                 6.290184e-02 1 1  ON 12
 ud_3                -7.553510e-03 1 1  ON 13
 ud_4                -6.480753e-02 1 1  ON 14
 ud_5                -1.069191e-01 1 1  ON 15
 ud_6                -1.349568e-01 1 1  ON 16
 ud_7                -1.520139e-01 1 1  ON 17
 ud_8                -1.529322e-01 1 1  ON 18
 ud_9                -1.433500e-01 1 1  ON 19
 eO_0                -7.600482e-01 1 1  ON 20
 eO_1                -4.399671e-01 1 1  ON 21
 eO_2                -2.172509e-02 1 1  ON 22
 eO_3                 2.986549e-01 1 1  ON 23
 eO_4                 5.253887e-01 1 1  ON 24
 eO_5                 4.877476e-01 1 1  ON 25
 eO_6                 2.599496e-01 1 1  ON 26
 eO_7                -4.073442e-02 1 1  ON 27
 eO_8                -2.213977e-01 1 1  ON 28
 eO_9                -8.646623e-02 1 1  ON 29
eH1_0                -2.445310e-01 1 1  ON 30
eH1_1                -1.452305e-01 1 1  ON 31
eH1_2                -9.860083e-02 1 1  ON 32
eH1_3                -4.484688e-02 1 1  ON 33
eH1_4                 3.313150e-03 1 1  ON 34
eH1_5                 3.809663e-02 1 1  ON 35
eH1_6                 9.658237e-02 1 1  ON 36
eH1_7                 1.541050e-01 1 1  ON 37
eH1_8                 1.772193e-01 1 1  ON 38
eH1_9                 6.790247e-02 1 1  ON 39
eH2_0                -2.422444e-01 1 1  ON 40
eH2_1                -1.429391e-01 1 1  ON 41
eH2_2                -9.648023e-02 1 1  ON 42
eH2_3                -4.249136e-02 1 1  ON 43
eH2_4                 5.527424e-03 1 1  ON 44
eH2_5                 4.021937e-02 1 1  ON 45
eH2_6                 9.948540e-02 1 1  ON 46
eH2_7                 1.552700e-01 1 1  ON 47
eH2_8                 1.827423e-01 1 1  ON 48
eH2_9                 5.745363e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9557
    reference variance = 0.209825
====================================================
  Execution time = 3.9645e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4171e-01
  Total weights = 2.0000e+06
  Execution time = 3.6542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341744563774
                                         uncertainty =       0.004838414316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341744563774
                                         uncertainty =       0.004838414316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413340315
  error estimate for blocks of size 2^( 2) =       0.000425808101
  error estimate for blocks of size 2^( 3) =       0.000438856834
  error estimate for blocks of size 2^( 4) =       0.000450731442
  error estimate for blocks of size 2^( 5) =       0.000461883803
  error estimate for blocks of size 2^( 6) =       0.000470063656
  error estimate for blocks of size 2^( 7) =       0.000473783631

      target function =                  N/A
              le_mean =     -16.905859877494
             les_mean =     286.149798458206
             stat err =       0.000464115633
             autocorr =       1.260772892981
              std dev =       0.584551479000
             le_variance =       0.341700431601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341781070858
                                         uncertainty =       0.004838505448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341781070858
                                         uncertainty =       0.004838505448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413362400
  error estimate for blocks of size 2^( 2) =       0.000425827496
  error estimate for blocks of size 2^( 3) =       0.000438873145
  error estimate for blocks of size 2^( 4) =       0.000450745868
  error estimate for blocks of size 2^( 5) =       0.000461897620
  error estimate for blocks of size 2^( 6) =       0.000470079552
  error estimate for blocks of size 2^( 7) =       0.000473801391

      target function =                  N/A
              le_mean =     -16.905859913916
             les_mean =     286.149836206106
             stat err =       0.000464131108
             autocorr =       1.260722239812
              std dev =       0.584582712731
             le_variance =       0.341736948024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341762344971
                                         uncertainty =       0.004838454155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341762344971
                                         uncertainty =       0.004838454155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413351073
  error estimate for blocks of size 2^( 2) =       0.000425817518
  error estimate for blocks of size 2^( 3) =       0.000438864702
  error estimate for blocks of size 2^( 4) =       0.000450738357
  error estimate for blocks of size 2^( 5) =       0.000461890433
  error estimate for blocks of size 2^( 6) =       0.000470071346
  error estimate for blocks of size 2^( 7) =       0.000473792363

      target function =                  N/A
              le_mean =     -16.905859896817
             les_mean =     286.149816898421
             stat err =       0.000464123125
             autocorr =       1.260747967669
              std dev =       0.584566692934
             le_variance =       0.341718218488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341746777008
                                         uncertainty =       0.004838418862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341746777008
                                         uncertainty =       0.004838418862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413341654
  error estimate for blocks of size 2^( 2) =       0.000425809271
  error estimate for blocks of size 2^( 3) =       0.000438857809
  error estimate for blocks of size 2^( 4) =       0.000450732297
  error estimate for blocks of size 2^( 5) =       0.000461884622
  error estimate for blocks of size 2^( 6) =       0.000470064609
  error estimate for blocks of size 2^( 7) =       0.000473784716

      target function =                  N/A
              le_mean =     -16.905859878789
             les_mean =     286.149800715979
             stat err =       0.000464116561
             autocorr =       1.260769766425
              std dev =       0.584553372733
             le_variance =       0.341702645573


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905859877494        initial
     3.6380e+00     3.6380e+01             1.2592e-04       -16.905859913916  <--
     1.4552e+01     1.4552e+02             3.1640e-05       -16.905859896817
     5.8208e+01     5.8208e+02             7.9401e-06       -16.905859878789

*****************************************************************************
Applying the update for shift_i =   3.6380e+00     and shift_s =   3.6380e+01
*****************************************************************************

  Execution time = 5.8012e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.091877e-01 1 1  ON 0
 uu_1                 1.424761e-01 1 1  ON 1
 uu_2                 4.098532e-02 1 1  ON 2
 uu_3                -2.132496e-02 1 1  ON 3
 uu_4                -6.660052e-02 1 1  ON 4
 uu_5                -1.013740e-01 1 1  ON 5
 uu_6                -1.283770e-01 1 1  ON 6
 uu_7                -1.414690e-01 1 1  ON 7
 uu_8                -1.334580e-01 1 1  ON 8
 uu_9                -1.050583e-01 1 1  ON 9
 ud_0                 4.477279e-01 1 1  ON 10
 ud_1                 1.824604e-01 1 1  ON 11
 ud_2                 6.291298e-02 1 1  ON 12
 ud_3                -7.586147e-03 1 1  ON 13
 ud_4                -6.482168e-02 1 1  ON 14
 ud_5                -1.069237e-01 1 1  ON 15
 ud_6                -1.349529e-01 1 1  ON 16
 ud_7                -1.520007e-01 1 1  ON 17
 ud_8                -1.529469e-01 1 1  ON 18
 ud_9                -1.433842e-01 1 1  ON 19
 eO_0                -7.600892e-01 1 1  ON 20
 eO_1                -4.399399e-01 1 1  ON 21
 eO_2                -2.169396e-02 1 1  ON 22
 eO_3                 2.986985e-01 1 1  ON 23
 eO_4                 5.254016e-01 1 1  ON 24
 eO_5                 4.877400e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072126e-02 1 1  ON 27
 eO_8                -2.214364e-01 1 1  ON 28
 eO_9                -8.650505e-02 1 1  ON 29
eH1_0                -2.446253e-01 1 1  ON 30
eH1_1                -1.452575e-01 1 1  ON 31
eH1_2                -9.858460e-02 1 1  ON 32
eH1_3                -4.483628e-02 1 1  ON 33
eH1_4                 3.336684e-03 1 1  ON 34
eH1_5                 3.810875e-02 1 1  ON 35
eH1_6                 9.659641e-02 1 1  ON 36
eH1_7                 1.541038e-01 1 1  ON 37
eH1_8                 1.772371e-01 1 1  ON 38
eH1_9                 6.792867e-02 1 1  ON 39
eH2_0                -2.423258e-01 1 1  ON 40
eH2_1                -1.429466e-01 1 1  ON 41
eH2_2                -9.645490e-02 1 1  ON 42
eH2_3                -4.248618e-02 1 1  ON 43
eH2_4                 5.558517e-03 1 1  ON 44
eH2_5                 4.021267e-02 1 1  ON 45
eH2_6                 9.948000e-02 1 1  ON 46
eH2_7                 1.552570e-01 1 1  ON 47
eH2_8                 1.827541e-01 1 1  ON 48
eH2_9                 5.749337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0830e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8655
    reference variance = 0.168063
====================================================
  Execution time = 4.0933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4182e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0616e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341825914343
                                         uncertainty =       0.003632166168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341825914343
                                         uncertainty =       0.003632166168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413410176
  error estimate for blocks of size 2^( 2) =       0.000425900421
  error estimate for blocks of size 2^( 3) =       0.000438259964
  error estimate for blocks of size 2^( 4) =       0.000448857539
  error estimate for blocks of size 2^( 5) =       0.000459009549
  error estimate for blocks of size 2^( 6) =       0.000464207270
  error estimate for blocks of size 2^( 7) =       0.000467919338

      target function =                  N/A
              le_mean =     -16.906416727812
             les_mean =     286.168742350946
             stat err =       0.000459998424
             autocorr =       1.238084716255
              std dev =       0.584650277862
             le_variance =       0.341815947404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641672781e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906416727812       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906419443254       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906419466109       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906419538081       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906419652097       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906419856142       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906419383593       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906419434722       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906419512361       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e-01 is 3.861146e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906416727812       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906417507558       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906417527625       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906417502335       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906417561323       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906417612602       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906417513857       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906417514809       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906417533677       residual = 8.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 1.004121e-04

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906416727812       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906416930270       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906416936926       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906416925946       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906416952375       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906416955967       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906416933885       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906416933501       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 2.520466e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208646 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1557e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.092231e-01 1 1  ON 0
 uu_1                 1.425006e-01 1 1  ON 1
 uu_2                 4.099506e-02 1 1  ON 2
 uu_3                -2.130573e-02 1 1  ON 3
 uu_4                -6.658509e-02 1 1  ON 4
 uu_5                -1.014112e-01 1 1  ON 5
 uu_6                -1.283854e-01 1 1  ON 6
 uu_7                -1.414893e-01 1 1  ON 7
 uu_8                -1.334966e-01 1 1  ON 8
 uu_9                -1.051045e-01 1 1  ON 9
 ud_0                 4.478069e-01 1 1  ON 10
 ud_1                 1.825270e-01 1 1  ON 11
 ud_2                 6.292080e-02 1 1  ON 12
 ud_3                -7.617564e-03 1 1  ON 13
 ud_4                -6.485230e-02 1 1  ON 14
 ud_5                -1.069134e-01 1 1  ON 15
 ud_6                -1.349274e-01 1 1  ON 16
 ud_7                -1.520351e-01 1 1  ON 17
 ud_8                -1.529819e-01 1 1  ON 18
 ud_9                -1.434228e-01 1 1  ON 19
 eO_0                -7.601053e-01 1 1  ON 20
 eO_1                -4.399257e-01 1 1  ON 21
 eO_2                -2.167447e-02 1 1  ON 22
 eO_3                 2.987257e-01 1 1  ON 23
 eO_4                 5.254046e-01 1 1  ON 24
 eO_5                 4.877678e-01 1 1  ON 25
 eO_6                 2.599797e-01 1 1  ON 26
 eO_7                -4.071640e-02 1 1  ON 27
 eO_8                -2.214846e-01 1 1  ON 28
 eO_9                -8.655477e-02 1 1  ON 29
eH1_0                -2.446934e-01 1 1  ON 30
eH1_1                -1.453128e-01 1 1  ON 31
eH1_2                -9.856697e-02 1 1  ON 32
eH1_3                -4.484598e-02 1 1  ON 33
eH1_4                 3.361649e-03 1 1  ON 34
eH1_5                 3.811467e-02 1 1  ON 35
eH1_6                 9.659884e-02 1 1  ON 36
eH1_7                 1.541117e-01 1 1  ON 37
eH1_8                 1.772748e-01 1 1  ON 38
eH1_9                 6.797413e-02 1 1  ON 39
eH2_0                -2.424262e-01 1 1  ON 40
eH2_1                -1.429863e-01 1 1  ON 41
eH2_2                -9.643005e-02 1 1  ON 42
eH2_3                -4.248463e-02 1 1  ON 43
eH2_4                 5.587240e-03 1 1  ON 44
eH2_5                 4.023944e-02 1 1  ON 45
eH2_6                 9.947700e-02 1 1  ON 46
eH2_7                 1.552581e-01 1 1  ON 47
eH2_8                 1.827746e-01 1 1  ON 48
eH2_9                 5.753200e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9505
    reference variance = 0.224629
====================================================
  Execution time = 3.8532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4015e-01
  Total weights = 2.0000e+06
  Execution time = 3.6524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340174410027
                                         uncertainty =       0.004036172069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340174410027
                                         uncertainty =       0.004036172069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412376398
  error estimate for blocks of size 2^( 2) =       0.000425478012
  error estimate for blocks of size 2^( 3) =       0.000438507084
  error estimate for blocks of size 2^( 4) =       0.000451413916
  error estimate for blocks of size 2^( 5) =       0.000461073856
  error estimate for blocks of size 2^( 6) =       0.000469512159
  error estimate for blocks of size 2^( 7) =       0.000473777475

      target function =                  N/A
              le_mean =     -16.906354522926
             les_mean =     286.164931672258
             stat err =       0.000463944352
             autocorr =       1.265739056929
              std dev =       0.583188295018
             le_variance =       0.340108587446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340312399442
                                         uncertainty =       0.004034095603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340312399442
                                         uncertainty =       0.004034095603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412460054
  error estimate for blocks of size 2^( 2) =       0.000425552310
  error estimate for blocks of size 2^( 3) =       0.000438570086
  error estimate for blocks of size 2^( 4) =       0.000451470098
  error estimate for blocks of size 2^( 5) =       0.000461124703
  error estimate for blocks of size 2^( 6) =       0.000469568671
  error estimate for blocks of size 2^( 7) =       0.000473835389

      target function =                  N/A
              le_mean =     -16.906352673018
             les_mean =     286.165007127030
             stat err =       0.000463999715
             autocorr =       1.265527651251
              std dev =       0.583306602637
             le_variance =       0.340246592680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340249606374
                                         uncertainty =       0.004035002255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340249606374
                                         uncertainty =       0.004035002255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412421988
  error estimate for blocks of size 2^( 2) =       0.000425518280
  error estimate for blocks of size 2^( 3) =       0.000438540943
  error estimate for blocks of size 2^( 4) =       0.000451443976
  error estimate for blocks of size 2^( 5) =       0.000461100757
  error estimate for blocks of size 2^( 6) =       0.000469542531
  error estimate for blocks of size 2^( 7) =       0.000473808718

      target function =                  N/A
              le_mean =     -16.906353111980
             les_mean =     286.164959169316
             stat err =       0.000463973996
             autocorr =       1.265620957850
              std dev =       0.583252768912
             le_variance =       0.340183792443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340183393185
                                         uncertainty =       0.004036001631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340183393185
                                         uncertainty =       0.004036001631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412381845
  error estimate for blocks of size 2^( 2) =       0.000425482778
  error estimate for blocks of size 2^( 3) =       0.000438511030
  error estimate for blocks of size 2^( 4) =       0.000451417386
  error estimate for blocks of size 2^( 5) =       0.000461076908
  error estimate for blocks of size 2^( 6) =       0.000469515684
  error estimate for blocks of size 2^( 7) =       0.000473781110

      target function =                  N/A
              le_mean =     -16.906354308989
             les_mean =     286.164933422640
             stat err =       0.000463947772
             autocorr =       1.265724283784
              std dev =       0.583195997599
             le_variance =       0.340117571616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906354522926        initial  <--
     9.0949e-01     9.0949e+00             3.8611e-04       -16.906352673018
     3.6380e+00     3.6380e+01             1.0041e-04       -16.906353111980
     1.4552e+01     1.4552e+02             2.5205e-05       -16.906354308989

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 56.9448
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.091877e-01 1 1  ON 0
 uu_1                 1.424761e-01 1 1  ON 1
 uu_2                 4.098532e-02 1 1  ON 2
 uu_3                -2.132496e-02 1 1  ON 3
 uu_4                -6.660052e-02 1 1  ON 4
 uu_5                -1.013740e-01 1 1  ON 5
 uu_6                -1.283770e-01 1 1  ON 6
 uu_7                -1.414690e-01 1 1  ON 7
 uu_8                -1.334580e-01 1 1  ON 8
 uu_9                -1.050583e-01 1 1  ON 9
 ud_0                 4.477279e-01 1 1  ON 10
 ud_1                 1.824604e-01 1 1  ON 11
 ud_2                 6.291298e-02 1 1  ON 12
 ud_3                -7.586147e-03 1 1  ON 13
 ud_4                -6.482168e-02 1 1  ON 14
 ud_5                -1.069237e-01 1 1  ON 15
 ud_6                -1.349529e-01 1 1  ON 16
 ud_7                -1.520007e-01 1 1  ON 17
 ud_8                -1.529469e-01 1 1  ON 18
 ud_9                -1.433842e-01 1 1  ON 19
 eO_0                -7.600892e-01 1 1  ON 20
 eO_1                -4.399399e-01 1 1  ON 21
 eO_2                -2.169396e-02 1 1  ON 22
 eO_3                 2.986985e-01 1 1  ON 23
 eO_4                 5.254016e-01 1 1  ON 24
 eO_5                 4.877400e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072126e-02 1 1  ON 27
 eO_8                -2.214364e-01 1 1  ON 28
 eO_9                -8.650505e-02 1 1  ON 29
eH1_0                -2.446253e-01 1 1  ON 30
eH1_1                -1.452575e-01 1 1  ON 31
eH1_2                -9.858460e-02 1 1  ON 32
eH1_3                -4.483628e-02 1 1  ON 33
eH1_4                 3.336684e-03 1 1  ON 34
eH1_5                 3.810875e-02 1 1  ON 35
eH1_6                 9.659641e-02 1 1  ON 36
eH1_7                 1.541038e-01 1 1  ON 37
eH1_8                 1.772371e-01 1 1  ON 38
eH1_9                 6.792867e-02 1 1  ON 39
eH2_0                -2.423258e-01 1 1  ON 40
eH2_1                -1.429466e-01 1 1  ON 41
eH2_2                -9.645490e-02 1 1  ON 42
eH2_3                -4.248618e-02 1 1  ON 43
eH2_4                 5.558517e-03 1 1  ON 44
eH2_5                 4.021267e-02 1 1  ON 45
eH2_6                 9.948000e-02 1 1  ON 46
eH2_7                 1.552570e-01 1 1  ON 47
eH2_8                 1.827541e-01 1 1  ON 48
eH2_9                 5.749337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0851e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8994
    reference variance = 0.562284
====================================================
  Execution time = 3.9083e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3327e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0456e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333303258732
                                         uncertainty =       0.003388435483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333303258732
                                         uncertainty =       0.003388435483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408211329
  error estimate for blocks of size 2^( 2) =       0.000420738393
  error estimate for blocks of size 2^( 3) =       0.000433627540
  error estimate for blocks of size 2^( 4) =       0.000445593998
  error estimate for blocks of size 2^( 5) =       0.000456353384
  error estimate for blocks of size 2^( 6) =       0.000462863814
  error estimate for blocks of size 2^( 7) =       0.000466914395

      target function =                  N/A
              le_mean =     -16.906003734000
             les_mean =     286.146235065796
             stat err =       0.000457931398
             autocorr =       1.258434849136
              std dev =       0.577297997936
             le_variance =       0.333272978421


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600373400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906003734000       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906004291801       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906004451527       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906004366410       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906004380137       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906004357748       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906004354466       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906004353979       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906004356768       residual = 1.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+00 is 4.778435e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906003734000       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906003875657       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906003917140       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906003895439       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906003898921       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906003893510       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906003892204       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906003891900       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 1.190952e-05

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906003734000       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906003769555       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906003780026       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906003774579       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906003775445       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906003774108       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906003773751       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906003773664       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 2.981601e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211424 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9546e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.091919e-01 1 1  ON 0
 uu_1                 1.424764e-01 1 1  ON 1
 uu_2                 4.098477e-02 1 1  ON 2
 uu_3                -2.132663e-02 1 1  ON 3
 uu_4                -6.660013e-02 1 1  ON 4
 uu_5                -1.013738e-01 1 1  ON 5
 uu_6                -1.283792e-01 1 1  ON 6
 uu_7                -1.414713e-01 1 1  ON 7
 uu_8                -1.334581e-01 1 1  ON 8
 uu_9                -1.050600e-01 1 1  ON 9
 ud_0                 4.477363e-01 1 1  ON 10
 ud_1                 1.824660e-01 1 1  ON 11
 ud_2                 6.291370e-02 1 1  ON 12
 ud_3                -7.591178e-03 1 1  ON 13
 ud_4                -6.482317e-02 1 1  ON 14
 ud_5                -1.069243e-01 1 1  ON 15
 ud_6                -1.349569e-01 1 1  ON 16
 ud_7                -1.520028e-01 1 1  ON 17
 ud_8                -1.529473e-01 1 1  ON 18
 ud_9                -1.433845e-01 1 1  ON 19
 eO_0                -7.600901e-01 1 1  ON 20
 eO_1                -4.399373e-01 1 1  ON 21
 eO_2                -2.169283e-02 1 1  ON 22
 eO_3                 2.987010e-01 1 1  ON 23
 eO_4                 5.253999e-01 1 1  ON 24
 eO_5                 4.877421e-01 1 1  ON 25
 eO_6                 2.599542e-01 1 1  ON 26
 eO_7                -4.072026e-02 1 1  ON 27
 eO_8                -2.214394e-01 1 1  ON 28
 eO_9                -8.650840e-02 1 1  ON 29
eH1_0                -2.446335e-01 1 1  ON 30
eH1_1                -1.452640e-01 1 1  ON 31
eH1_2                -9.858279e-02 1 1  ON 32
eH1_3                -4.483366e-02 1 1  ON 33
eH1_4                 3.340333e-03 1 1  ON 34
eH1_5                 3.810812e-02 1 1  ON 35
eH1_6                 9.659578e-02 1 1  ON 36
eH1_7                 1.541041e-01 1 1  ON 37
eH1_8                 1.772397e-01 1 1  ON 38
eH1_9                 6.793311e-02 1 1  ON 39
eH2_0                -2.423377e-01 1 1  ON 40
eH2_1                -1.429500e-01 1 1  ON 41
eH2_2                -9.645108e-02 1 1  ON 42
eH2_3                -4.248243e-02 1 1  ON 43
eH2_4                 5.561153e-03 1 1  ON 44
eH2_5                 4.021149e-02 1 1  ON 45
eH2_6                 9.947866e-02 1 1  ON 46
eH2_7                 1.552562e-01 1 1  ON 47
eH2_8                 1.827575e-01 1 1  ON 48
eH2_9                 5.749818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8781
    reference variance = 0.222938
====================================================
  Execution time = 3.8866e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3974e-01
  Total weights = 2.0000e+06
  Execution time = 3.6583e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339744998704
                                         uncertainty =       0.004310287559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339744998704
                                         uncertainty =       0.004310287559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412148673
  error estimate for blocks of size 2^( 2) =       0.000424967148
  error estimate for blocks of size 2^( 3) =       0.000437920484
  error estimate for blocks of size 2^( 4) =       0.000449695264
  error estimate for blocks of size 2^( 5) =       0.000460341893
  error estimate for blocks of size 2^( 6) =       0.000468898760
  error estimate for blocks of size 2^( 7) =       0.000477078118

      target function =                  N/A
              le_mean =     -16.906232796957
             les_mean =     286.160440271833
             stat err =       0.000464003509
             autocorr =       1.267461329503
              std dev =       0.582866242627
             le_variance =       0.339733056795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339766203256
                                         uncertainty =       0.004310521060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339766203256
                                         uncertainty =       0.004310521060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412161533
  error estimate for blocks of size 2^( 2) =       0.000424978671
  error estimate for blocks of size 2^( 3) =       0.000437930633
  error estimate for blocks of size 2^( 4) =       0.000449704933
  error estimate for blocks of size 2^( 5) =       0.000460351065
  error estimate for blocks of size 2^( 6) =       0.000468907591
  error estimate for blocks of size 2^( 7) =       0.000477087023

      target function =                  N/A
              le_mean =     -16.906232716172
             les_mean =     286.160458742650
             stat err =       0.000464012653
             autocorr =       1.267432189020
              std dev =       0.582884430370
             le_variance =       0.339754259168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339755322539
                                         uncertainty =       0.004310400411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339755322539
                                         uncertainty =       0.004310400411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412154934
  error estimate for blocks of size 2^( 2) =       0.000424972746
  error estimate for blocks of size 2^( 3) =       0.000437925399
  error estimate for blocks of size 2^( 4) =       0.000449699947
  error estimate for blocks of size 2^( 5) =       0.000460346330
  error estimate for blocks of size 2^( 6) =       0.000468903035
  error estimate for blocks of size 2^( 7) =       0.000477082447

      target function =                  N/A
              le_mean =     -16.906232758033
             les_mean =     286.160449278446
             stat err =       0.000464007940
             autocorr =       1.267447027073
              std dev =       0.582875097702
             le_variance =       0.339743379522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339746291471
                                         uncertainty =       0.004310301631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339746291471
                                         uncertainty =       0.004310301631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412149457
  error estimate for blocks of size 2^( 2) =       0.000424967849
  error estimate for blocks of size 2^( 3) =       0.000437921099
  error estimate for blocks of size 2^( 4) =       0.000449695850
  error estimate for blocks of size 2^( 5) =       0.000460342448
  error estimate for blocks of size 2^( 6) =       0.000468899295
  error estimate for blocks of size 2^( 7) =       0.000477078659

      target function =                  N/A
              le_mean =     -16.906232791858
             les_mean =     286.160441392041
             stat err =       0.000464004063
             autocorr =       1.267459534676
              std dev =       0.582867351480
             le_variance =       0.339734349421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906232796957        initial  <--
     9.0949e+00     9.0949e+01             4.7784e-05       -16.906232716172
     3.6380e+01     3.6380e+02             1.1910e-05       -16.906232758033
     1.4552e+02     1.4552e+03             2.9816e-06       -16.906232791858

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.2511
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.091877e-01 1 1  ON 0
 uu_1                 1.424761e-01 1 1  ON 1
 uu_2                 4.098532e-02 1 1  ON 2
 uu_3                -2.132496e-02 1 1  ON 3
 uu_4                -6.660052e-02 1 1  ON 4
 uu_5                -1.013740e-01 1 1  ON 5
 uu_6                -1.283770e-01 1 1  ON 6
 uu_7                -1.414690e-01 1 1  ON 7
 uu_8                -1.334580e-01 1 1  ON 8
 uu_9                -1.050583e-01 1 1  ON 9
 ud_0                 4.477279e-01 1 1  ON 10
 ud_1                 1.824604e-01 1 1  ON 11
 ud_2                 6.291298e-02 1 1  ON 12
 ud_3                -7.586147e-03 1 1  ON 13
 ud_4                -6.482168e-02 1 1  ON 14
 ud_5                -1.069237e-01 1 1  ON 15
 ud_6                -1.349529e-01 1 1  ON 16
 ud_7                -1.520007e-01 1 1  ON 17
 ud_8                -1.529469e-01 1 1  ON 18
 ud_9                -1.433842e-01 1 1  ON 19
 eO_0                -7.600892e-01 1 1  ON 20
 eO_1                -4.399399e-01 1 1  ON 21
 eO_2                -2.169396e-02 1 1  ON 22
 eO_3                 2.986985e-01 1 1  ON 23
 eO_4                 5.254016e-01 1 1  ON 24
 eO_5                 4.877400e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072126e-02 1 1  ON 27
 eO_8                -2.214364e-01 1 1  ON 28
 eO_9                -8.650505e-02 1 1  ON 29
eH1_0                -2.446253e-01 1 1  ON 30
eH1_1                -1.452575e-01 1 1  ON 31
eH1_2                -9.858460e-02 1 1  ON 32
eH1_3                -4.483628e-02 1 1  ON 33
eH1_4                 3.336684e-03 1 1  ON 34
eH1_5                 3.810875e-02 1 1  ON 35
eH1_6                 9.659641e-02 1 1  ON 36
eH1_7                 1.541038e-01 1 1  ON 37
eH1_8                 1.772371e-01 1 1  ON 38
eH1_9                 6.792867e-02 1 1  ON 39
eH2_0                -2.423258e-01 1 1  ON 40
eH2_1                -1.429466e-01 1 1  ON 41
eH2_2                -9.645490e-02 1 1  ON 42
eH2_3                -4.248618e-02 1 1  ON 43
eH2_4                 5.558517e-03 1 1  ON 44
eH2_5                 4.021267e-02 1 1  ON 45
eH2_6                 9.948000e-02 1 1  ON 46
eH2_7                 1.552570e-01 1 1  ON 47
eH2_8                 1.827541e-01 1 1  ON 48
eH2_9                 5.749337e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0680e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9246
    reference variance = 0.188361
====================================================
  Execution time = 3.8918e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4303e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0698e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343043678790
                                         uncertainty =       0.004855841408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343043678790
                                         uncertainty =       0.004855841408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414142348
  error estimate for blocks of size 2^( 2) =       0.000426660863
  error estimate for blocks of size 2^( 3) =       0.000439363468
  error estimate for blocks of size 2^( 4) =       0.000451171169
  error estimate for blocks of size 2^( 5) =       0.000461528585
  error estimate for blocks of size 2^( 6) =       0.000470105502
  error estimate for blocks of size 2^( 7) =       0.000475457177

      target function =                  N/A
              le_mean =     -16.906152247603
             les_mean =     286.161011416445
             stat err =       0.000464565608
             autocorr =       1.258330805050
              std dev =       0.585685725306
             le_variance =       0.343027768827


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615224760e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152247603       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152264005       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152262810       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152267001       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152267586       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152264571       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152264484       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152266364       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 4.844355e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152247603       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152251710       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152251406       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152252459       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152252595       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152251842       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152251818       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152252288       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 1.211770e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152247603       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152248630       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152248554       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152248817       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152248851       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152248663       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152248656       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152248773       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 3.029849e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214018 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9624e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.091878e-01 1 1  ON 0
 uu_1                 1.424760e-01 1 1  ON 1
 uu_2                 4.098540e-02 1 1  ON 2
 uu_3                -2.132496e-02 1 1  ON 3
 uu_4                -6.660043e-02 1 1  ON 4
 uu_5                -1.013740e-01 1 1  ON 5
 uu_6                -1.283775e-01 1 1  ON 6
 uu_7                -1.414691e-01 1 1  ON 7
 uu_8                -1.334579e-01 1 1  ON 8
 uu_9                -1.050585e-01 1 1  ON 9
 ud_0                 4.477283e-01 1 1  ON 10
 ud_1                 1.824613e-01 1 1  ON 11
 ud_2                 6.291307e-02 1 1  ON 12
 ud_3                -7.586362e-03 1 1  ON 13
 ud_4                -6.482199e-02 1 1  ON 14
 ud_5                -1.069234e-01 1 1  ON 15
 ud_6                -1.349528e-01 1 1  ON 16
 ud_7                -1.520011e-01 1 1  ON 17
 ud_8                -1.529473e-01 1 1  ON 18
 ud_9                -1.433843e-01 1 1  ON 19
 eO_0                -7.600893e-01 1 1  ON 20
 eO_1                -4.399397e-01 1 1  ON 21
 eO_2                -2.169409e-02 1 1  ON 22
 eO_3                 2.986989e-01 1 1  ON 23
 eO_4                 5.254015e-01 1 1  ON 24
 eO_5                 4.877402e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072133e-02 1 1  ON 27
 eO_8                -2.214367e-01 1 1  ON 28
 eO_9                -8.650538e-02 1 1  ON 29
eH1_0                -2.446263e-01 1 1  ON 30
eH1_1                -1.452577e-01 1 1  ON 31
eH1_2                -9.858448e-02 1 1  ON 32
eH1_3                -4.483603e-02 1 1  ON 33
eH1_4                 3.336885e-03 1 1  ON 34
eH1_5                 3.810868e-02 1 1  ON 35
eH1_6                 9.659636e-02 1 1  ON 36
eH1_7                 1.541038e-01 1 1  ON 37
eH1_8                 1.772374e-01 1 1  ON 38
eH1_9                 6.792904e-02 1 1  ON 39
eH2_0                -2.423270e-01 1 1  ON 40
eH2_1                -1.429468e-01 1 1  ON 41
eH2_2                -9.645464e-02 1 1  ON 42
eH2_3                -4.248618e-02 1 1  ON 43
eH2_4                 5.558860e-03 1 1  ON 44
eH2_5                 4.021260e-02 1 1  ON 45
eH2_6                 9.947982e-02 1 1  ON 46
eH2_7                 1.552571e-01 1 1  ON 47
eH2_8                 1.827545e-01 1 1  ON 48
eH2_9                 5.749398e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.838
    reference variance = 0.330916
====================================================
  Execution time = 3.8717e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3935e-01
  Total weights = 2.0000e+06
  Execution time = 3.6497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339389973552
                                         uncertainty =       0.005945969280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339389973552
                                         uncertainty =       0.005945969280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411919051
  error estimate for blocks of size 2^( 2) =       0.000424564952
  error estimate for blocks of size 2^( 3) =       0.000437252280
  error estimate for blocks of size 2^( 4) =       0.000449706789
  error estimate for blocks of size 2^( 5) =       0.000461139683
  error estimate for blocks of size 2^( 6) =       0.000468731862
  error estimate for blocks of size 2^( 7) =       0.000472848285

      target function =                  N/A
              le_mean =     -16.906644394939
             les_mean =     286.173979136495
             stat err =       0.000463106655
             autocorr =       1.263974426313
              std dev =       0.582541508603
             le_variance =       0.339354609245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339389376206
                                         uncertainty =       0.005945829270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339389376206
                                         uncertainty =       0.005945829270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411918688
  error estimate for blocks of size 2^( 2) =       0.000424564562
  error estimate for blocks of size 2^( 3) =       0.000437251836
  error estimate for blocks of size 2^( 4) =       0.000449706312
  error estimate for blocks of size 2^( 5) =       0.000461139173
  error estimate for blocks of size 2^( 6) =       0.000468731359
  error estimate for blocks of size 2^( 7) =       0.000472847810

      target function =                  N/A
              le_mean =     -16.906644413477
             les_mean =     286.173979164351
             stat err =       0.000463106163
             autocorr =       1.263973975114
              std dev =       0.582540994502
             le_variance =       0.339354010275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339389671425
                                         uncertainty =       0.005945899002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339389671425
                                         uncertainty =       0.005945899002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411918867
  error estimate for blocks of size 2^( 2) =       0.000424564755
  error estimate for blocks of size 2^( 3) =       0.000437252056
  error estimate for blocks of size 2^( 4) =       0.000449706548
  error estimate for blocks of size 2^( 5) =       0.000461139426
  error estimate for blocks of size 2^( 6) =       0.000468731609
  error estimate for blocks of size 2^( 7) =       0.000472848046

      target function =                  N/A
              le_mean =     -16.906644404220
             les_mean =     286.173979147359
             stat err =       0.000463106407
             autocorr =       1.263974202619
              std dev =       0.582541248587
             le_variance =       0.339354306305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339389935671
                                         uncertainty =       0.005945960487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339389935671
                                         uncertainty =       0.005945960487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411919028
  error estimate for blocks of size 2^( 2) =       0.000424564927
  error estimate for blocks of size 2^( 3) =       0.000437252252
  error estimate for blocks of size 2^( 4) =       0.000449706759
  error estimate for blocks of size 2^( 5) =       0.000461139650
  error estimate for blocks of size 2^( 6) =       0.000468731830
  error estimate for blocks of size 2^( 7) =       0.000472848255

      target function =                  N/A
              le_mean =     -16.906644396098
             les_mean =     286.173979137703
             stat err =       0.000463106624
             autocorr =       1.263974398404
              std dev =       0.582541476002
             le_variance =       0.339354571263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906644394939        initial
     9.0949e+01     9.0949e+02             4.8444e-06       -16.906644413477  <--
     3.6380e+02     3.6380e+03             1.2118e-06       -16.906644404220
     1.4552e+03     1.4552e+04             3.0298e-07       -16.906644396098

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 6.0419e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132497e-02 1 1  ON 3
 uu_4                -6.660016e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414692e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587005e-03 1 1  ON 13
 ud_4                -6.482290e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169448e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214374e-01 1 1  ON 28
 eO_9                -8.650635e-02 1 1  ON 29
eH1_0                -2.446292e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858415e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337486e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659622e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793013e-02 1 1  ON 39
eH2_0                -2.423306e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645385e-02 1 1  ON 42
eH2_3                -4.248615e-02 1 1  ON 43
eH2_4                 5.559886e-03 1 1  ON 44
eH2_5                 4.021241e-02 1 1  ON 45
eH2_6                 9.947929e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1005e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8919
    reference variance = 0.362489
====================================================
  Execution time = 4.1966e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4158e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0892e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341652259713
                                         uncertainty =       0.004352371870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341652259713
                                         uncertainty =       0.004352371870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413270563
  error estimate for blocks of size 2^( 2) =       0.000426116893
  error estimate for blocks of size 2^( 3) =       0.000439667771
  error estimate for blocks of size 2^( 4) =       0.000451283200
  error estimate for blocks of size 2^( 5) =       0.000462486773
  error estimate for blocks of size 2^( 6) =       0.000471643266
  error estimate for blocks of size 2^( 7) =       0.000478450981

      target function =                  N/A
              le_mean =     -16.905343446427
             les_mean =     286.132221988105
             stat err =       0.000465966055
             autocorr =       1.271275319652
              std dev =       0.584452835770
             le_variance =       0.341585117239


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690534344643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905343446427       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905343581820       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905343631181       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905343623974       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905343627663       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905343641554       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905343644994       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905343640197       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 1.843348e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905343446427       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905343480494       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905343492962       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905343491218       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905343492127       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905343495638       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905343496479       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905343495273       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 4.616508e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905343446427       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905343454958       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905343458083       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905343457650       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905343457877       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905343458758       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905343458966       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905343458664       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 1.154635e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2866e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.091895e-01 1 1  ON 0
 uu_1                 1.424759e-01 1 1  ON 1
 uu_2                 4.098638e-02 1 1  ON 2
 uu_3                -2.132565e-02 1 1  ON 3
 uu_4                -6.660077e-02 1 1  ON 4
 uu_5                -1.013735e-01 1 1  ON 5
 uu_6                -1.283799e-01 1 1  ON 6
 uu_7                -1.414716e-01 1 1  ON 7
 uu_8                -1.334588e-01 1 1  ON 8
 uu_9                -1.050588e-01 1 1  ON 9
 ud_0                 4.477318e-01 1 1  ON 10
 ud_1                 1.824658e-01 1 1  ON 11
 ud_2                 6.291337e-02 1 1  ON 12
 ud_3                -7.589514e-03 1 1  ON 13
 ud_4                -6.482336e-02 1 1  ON 14
 ud_5                -1.069228e-01 1 1  ON 15
 ud_6                -1.349513e-01 1 1  ON 16
 ud_7                -1.520024e-01 1 1  ON 17
 ud_8                -1.529499e-01 1 1  ON 18
 ud_9                -1.433849e-01 1 1  ON 19
 eO_0                -7.600911e-01 1 1  ON 20
 eO_1                -4.399381e-01 1 1  ON 21
 eO_2                -2.169452e-02 1 1  ON 22
 eO_3                 2.987017e-01 1 1  ON 23
 eO_4                 5.254021e-01 1 1  ON 24
 eO_5                 4.877418e-01 1 1  ON 25
 eO_6                 2.599555e-01 1 1  ON 26
 eO_7                -4.072202e-02 1 1  ON 27
 eO_8                -2.214389e-01 1 1  ON 28
 eO_9                -8.650760e-02 1 1  ON 29
eH1_0                -2.446331e-01 1 1  ON 30
eH1_1                -1.452582e-01 1 1  ON 31
eH1_2                -9.858355e-02 1 1  ON 32
eH1_3                -4.483489e-02 1 1  ON 33
eH1_4                 3.338378e-03 1 1  ON 34
eH1_5                 3.810777e-02 1 1  ON 35
eH1_6                 9.659596e-02 1 1  ON 36
eH1_7                 1.541034e-01 1 1  ON 37
eH1_8                 1.772398e-01 1 1  ON 38
eH1_9                 6.793193e-02 1 1  ON 39
eH2_0                -2.423353e-01 1 1  ON 40
eH2_1                -1.429494e-01 1 1  ON 41
eH2_2                -9.645274e-02 1 1  ON 42
eH2_3                -4.248452e-02 1 1  ON 43
eH2_4                 5.561278e-03 1 1  ON 44
eH2_5                 4.021118e-02 1 1  ON 45
eH2_6                 9.947887e-02 1 1  ON 46
eH2_7                 1.552575e-01 1 1  ON 47
eH2_8                 1.827568e-01 1 1  ON 48
eH2_9                 5.749811e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8803
    reference variance = 0.254675
====================================================
  Execution time = 3.8743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4095e-01
  Total weights = 2.0000e+06
  Execution time = 3.6636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340944751791
                                         uncertainty =       0.004426313210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340944751791
                                         uncertainty =       0.004426313210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412886173
  error estimate for blocks of size 2^( 2) =       0.000425921059
  error estimate for blocks of size 2^( 3) =       0.000439390938
  error estimate for blocks of size 2^( 4) =       0.000452398715
  error estimate for blocks of size 2^( 5) =       0.000462359499
  error estimate for blocks of size 2^( 6) =       0.000471596705
  error estimate for blocks of size 2^( 7) =       0.000478214116

      target function =                  N/A
              le_mean =     -16.906315075817
             les_mean =     286.164439255777
             stat err =       0.000466142259
             autocorr =       1.274606927514
              std dev =       0.583909225368
             le_variance =       0.340949983470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340949847406
                                         uncertainty =       0.004426296347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340949847406
                                         uncertainty =       0.004426296347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412889256
  error estimate for blocks of size 2^( 2) =       0.000425923779
  error estimate for blocks of size 2^( 3) =       0.000439393225
  error estimate for blocks of size 2^( 4) =       0.000452400745
  error estimate for blocks of size 2^( 5) =       0.000462361305
  error estimate for blocks of size 2^( 6) =       0.000471598780
  error estimate for blocks of size 2^( 7) =       0.000478216413

      target function =                  N/A
              le_mean =     -16.906315061878
             les_mean =     286.164443877260
             stat err =       0.000466144311
             autocorr =       1.274599109662
              std dev =       0.583913586284
             le_variance =       0.340955076248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340947284397
                                         uncertainty =       0.004426304095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340947284397
                                         uncertainty =       0.004426304095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412887705
  error estimate for blocks of size 2^( 2) =       0.000425922410
  error estimate for blocks of size 2^( 3) =       0.000439392071
  error estimate for blocks of size 2^( 4) =       0.000452399719
  error estimate for blocks of size 2^( 5) =       0.000462360391
  error estimate for blocks of size 2^( 6) =       0.000471597732
  error estimate for blocks of size 2^( 7) =       0.000478215254

      target function =                  N/A
              le_mean =     -16.906315068475
             les_mean =     286.164441538685
             stat err =       0.000466143274
             autocorr =       1.274603016736
              std dev =       0.583911392785
             le_variance =       0.340952514624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340945067759
                                         uncertainty =       0.004426312048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340945067759
                                         uncertainty =       0.004426312048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412886364
  error estimate for blocks of size 2^( 2) =       0.000425921227
  error estimate for blocks of size 2^( 3) =       0.000439391080
  error estimate for blocks of size 2^( 4) =       0.000452398840
  error estimate for blocks of size 2^( 5) =       0.000462359610
  error estimate for blocks of size 2^( 6) =       0.000471596833
  error estimate for blocks of size 2^( 7) =       0.000478214258

      target function =                  N/A
              le_mean =     -16.906315074860
             les_mean =     286.164439539221
             stat err =       0.000466142385
             autocorr =       1.274606438454
              std dev =       0.583909495775
             le_variance =       0.340950299256


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906315075817        initial  <--
     2.2737e+01     2.2737e+02             1.8433e-05       -16.906315061878
     9.0949e+01     9.0949e+02             4.6165e-06       -16.906315068475
     3.6380e+02     3.6380e+03             1.1546e-06       -16.906315074860

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.1740
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132497e-02 1 1  ON 3
 uu_4                -6.660016e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414692e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587005e-03 1 1  ON 13
 ud_4                -6.482290e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169448e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214374e-01 1 1  ON 28
 eO_9                -8.650635e-02 1 1  ON 29
eH1_0                -2.446292e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858415e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337486e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659622e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793013e-02 1 1  ON 39
eH2_0                -2.423306e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645385e-02 1 1  ON 42
eH2_3                -4.248615e-02 1 1  ON 43
eH2_4                 5.559886e-03 1 1  ON 44
eH2_5                 4.021241e-02 1 1  ON 45
eH2_6                 9.947929e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1005e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8846
    reference variance = 0.316552
====================================================
  Execution time = 3.9235e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3648e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0729e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336449498976
                                         uncertainty =       0.004048617783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336449498976
                                         uncertainty =       0.004048617783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410168281
  error estimate for blocks of size 2^( 2) =       0.000423098015
  error estimate for blocks of size 2^( 3) =       0.000436308280
  error estimate for blocks of size 2^( 4) =       0.000449012212
  error estimate for blocks of size 2^( 5) =       0.000459323654
  error estimate for blocks of size 2^( 6) =       0.000464720696
  error estimate for blocks of size 2^( 7) =       0.000471010961

      target function =                  N/A
              le_mean =     -16.906533466928
             les_mean =     286.167349737998
             stat err =       0.000461016881
             autocorr =       1.263308767514
              std dev =       0.580065546202
             le_variance =       0.336476037890


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653346693e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906533466928       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906533473027       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906533473652       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906533476351       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906533476814       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906533477860       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906533478555       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906533478574       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906533478263       residual = 9.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 1.848741e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906533466928       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906533468453       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906533468610       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906533469284       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906533469400       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906533469662       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906533469836       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906533469840       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906533469763       residual = 9.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 4.622586e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906533466928       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906533467309       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906533467348       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906533467517       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906533467547       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906533467613       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906533467654       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906533467658       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906533467646       residual = 9.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 1.155692e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9971e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.091883e-01 1 1  ON 0
 uu_1                 1.424757e-01 1 1  ON 1
 uu_2                 4.098562e-02 1 1  ON 2
 uu_3                -2.132502e-02 1 1  ON 3
 uu_4                -6.660014e-02 1 1  ON 4
 uu_5                -1.013740e-01 1 1  ON 5
 uu_6                -1.283792e-01 1 1  ON 6
 uu_7                -1.414694e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477295e-01 1 1  ON 10
 ud_1                 1.824641e-01 1 1  ON 11
 ud_2                 6.291333e-02 1 1  ON 12
 ud_3                -7.587072e-03 1 1  ON 13
 ud_4                -6.482298e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520022e-01 1 1  ON 17
 ud_8                -1.529485e-01 1 1  ON 18
 ud_9                -1.433848e-01 1 1  ON 19
 eO_0                -7.600896e-01 1 1  ON 20
 eO_1                -4.399388e-01 1 1  ON 21
 eO_2                -2.169449e-02 1 1  ON 22
 eO_3                 2.987003e-01 1 1  ON 23
 eO_4                 5.254015e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599544e-01 1 1  ON 26
 eO_7                -4.072149e-02 1 1  ON 27
 eO_8                -2.214375e-01 1 1  ON 28
 eO_9                -8.650651e-02 1 1  ON 29
eH1_0                -2.446296e-01 1 1  ON 30
eH1_1                -1.452584e-01 1 1  ON 31
eH1_2                -9.858414e-02 1 1  ON 32
eH1_3                -4.483525e-02 1 1  ON 33
eH1_4                 3.337596e-03 1 1  ON 34
eH1_5                 3.810861e-02 1 1  ON 35
eH1_6                 9.659624e-02 1 1  ON 36
eH1_7                 1.541039e-01 1 1  ON 37
eH1_8                 1.772385e-01 1 1  ON 38
eH1_9                 6.793037e-02 1 1  ON 39
eH2_0                -2.423311e-01 1 1  ON 40
eH2_1                -1.429478e-01 1 1  ON 41
eH2_2                -9.645379e-02 1 1  ON 42
eH2_3                -4.248601e-02 1 1  ON 43
eH2_4                 5.560045e-03 1 1  ON 44
eH2_5                 4.021244e-02 1 1  ON 45
eH2_6                 9.947918e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827556e-01 1 1  ON 48
eH2_9                 5.749606e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9369
    reference variance = 0.191752
====================================================
  Execution time = 3.9231e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3640e-01
  Total weights = 2.0000e+06
  Execution time = 3.6636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379431108
                                         uncertainty =       0.004680608430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379431108
                                         uncertainty =       0.004680608430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410120479
  error estimate for blocks of size 2^( 2) =       0.000423005721
  error estimate for blocks of size 2^( 3) =       0.000436636289
  error estimate for blocks of size 2^( 4) =       0.000448881479
  error estimate for blocks of size 2^( 5) =       0.000459574205
  error estimate for blocks of size 2^( 6) =       0.000467788274
  error estimate for blocks of size 2^( 7) =       0.000473222504

      target function =                  N/A
              le_mean =     -16.905922326588
             les_mean =     286.146607159320
             stat err =       0.000462366616
             autocorr =       1.271013097207
              std dev =       0.579997943873
             le_variance =       0.336397614897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379733493
                                         uncertainty =       0.004680618937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379733493
                                         uncertainty =       0.004680618937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410120663
  error estimate for blocks of size 2^( 2) =       0.000423005871
  error estimate for blocks of size 2^( 3) =       0.000436636410
  error estimate for blocks of size 2^( 4) =       0.000448881572
  error estimate for blocks of size 2^( 5) =       0.000459574279
  error estimate for blocks of size 2^( 6) =       0.000467788384
  error estimate for blocks of size 2^( 7) =       0.000473222594

      target function =                  N/A
              le_mean =     -16.905922322952
             les_mean =     286.146607338470
             stat err =       0.000462366707
             autocorr =       1.271012459768
              std dev =       0.579998204281
             le_variance =       0.336397916969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379582188
                                         uncertainty =       0.004680613684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379582188
                                         uncertainty =       0.004680613684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410120571
  error estimate for blocks of size 2^( 2) =       0.000423005796
  error estimate for blocks of size 2^( 3) =       0.000436636349
  error estimate for blocks of size 2^( 4) =       0.000448881525
  error estimate for blocks of size 2^( 5) =       0.000459574242
  error estimate for blocks of size 2^( 6) =       0.000467788329
  error estimate for blocks of size 2^( 7) =       0.000473222549

      target function =                  N/A
              le_mean =     -16.905922324767
             les_mean =     286.146607248685
             stat err =       0.000462366661
             autocorr =       1.271012778419
              std dev =       0.579998073980
             le_variance =       0.336397765820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379449989
                                         uncertainty =       0.004680609087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336379449989
                                         uncertainty =       0.004680609087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410120491
  error estimate for blocks of size 2^( 2) =       0.000423005731
  error estimate for blocks of size 2^( 3) =       0.000436636296
  error estimate for blocks of size 2^( 4) =       0.000448881485
  error estimate for blocks of size 2^( 5) =       0.000459574209
  error estimate for blocks of size 2^( 6) =       0.000467788281
  error estimate for blocks of size 2^( 7) =       0.000473222510

      target function =                  N/A
              le_mean =     -16.905922326360
             les_mean =     286.146607170478
             stat err =       0.000462366621
             autocorr =       1.271013057354
              std dev =       0.579997960133
             le_variance =       0.336397633758


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905922326588        initial  <--
     2.2737e+02     2.2737e+03             1.8487e-06       -16.905922322952
     9.0949e+02     9.0949e+03             4.6226e-07       -16.905922324767
     3.6380e+03     3.6380e+04             1.1557e-07       -16.905922326360

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.6581
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132497e-02 1 1  ON 3
 uu_4                -6.660016e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414692e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587005e-03 1 1  ON 13
 ud_4                -6.482290e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169448e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214374e-01 1 1  ON 28
 eO_9                -8.650635e-02 1 1  ON 29
eH1_0                -2.446292e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858415e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337486e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659622e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793013e-02 1 1  ON 39
eH2_0                -2.423306e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645385e-02 1 1  ON 42
eH2_3                -4.248615e-02 1 1  ON 43
eH2_4                 5.559886e-03 1 1  ON 44
eH2_5                 4.021241e-02 1 1  ON 45
eH2_6                 9.947929e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0765e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8467
    reference variance = 0.459386
====================================================
  Execution time = 3.8878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3497e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0782e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334945181055
                                         uncertainty =       0.003245740259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334945181055
                                         uncertainty =       0.003245740259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409249932
  error estimate for blocks of size 2^( 2) =       0.000422155664
  error estimate for blocks of size 2^( 3) =       0.000435010922
  error estimate for blocks of size 2^( 4) =       0.000447184351
  error estimate for blocks of size 2^( 5) =       0.000456869037
  error estimate for blocks of size 2^( 6) =       0.000463415799
  error estimate for blocks of size 2^( 7) =       0.000466085934

      target function =                  N/A
              le_mean =     -16.906050450009
             les_mean =     286.149512664826
             stat err =       0.000458388780
             autocorr =       1.254557946231
              std dev =       0.578766804547
             le_variance =       0.334971014046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690605045001e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906050450009       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906050451213       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906050451208       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906050451184       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906050451261       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906050451385       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906050451304       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906050451238       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.963441e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906050450009       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906050450310       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906050450309       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906050450303       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906050450320       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906050450351       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906050450335       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906050450314       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 4.908735e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906050450009       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906050450085       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906050450084       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906050450081       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906050450088       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906050450095       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906050450140       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906050450049       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 1.227192e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222314 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9668e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132496e-02 1 1  ON 3
 uu_4                -6.660015e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414693e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587022e-03 1 1  ON 13
 ud_4                -6.482291e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169447e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214375e-01 1 1  ON 28
 eO_9                -8.650637e-02 1 1  ON 29
eH1_0                -2.446293e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858414e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337496e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659621e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793015e-02 1 1  ON 39
eH2_0                -2.423307e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645383e-02 1 1  ON 42
eH2_3                -4.248614e-02 1 1  ON 43
eH2_4                 5.559906e-03 1 1  ON 44
eH2_5                 4.021242e-02 1 1  ON 45
eH2_6                 9.947927e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749581e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8417
    reference variance = 0.197314
====================================================
  Execution time = 4.0667e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4399e-01
  Total weights = 2.0000e+06
  Execution time = 3.6735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344129250509
                                         uncertainty =       0.005536836246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344129250509
                                         uncertainty =       0.005536836246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414725231
  error estimate for blocks of size 2^( 2) =       0.000427113208
  error estimate for blocks of size 2^( 3) =       0.000440815327
  error estimate for blocks of size 2^( 4) =       0.000452679016
  error estimate for blocks of size 2^( 5) =       0.000463110569
  error estimate for blocks of size 2^( 6) =       0.000469655086
  error estimate for blocks of size 2^( 7) =       0.000476237905

      target function =                  N/A
              le_mean =     -16.905304073505
             les_mean =     286.133299680261
             stat err =       0.000465420644
             autocorr =       1.259419373605
              std dev =       0.586510046468
             le_variance =       0.343994034608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344129330028
                                         uncertainty =       0.005536838211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344129330028
                                         uncertainty =       0.005536838211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414725279
  error estimate for blocks of size 2^( 2) =       0.000427113249
  error estimate for blocks of size 2^( 3) =       0.000440815363
  error estimate for blocks of size 2^( 4) =       0.000452679049
  error estimate for blocks of size 2^( 5) =       0.000463110599
  error estimate for blocks of size 2^( 6) =       0.000469655113
  error estimate for blocks of size 2^( 7) =       0.000476237933

      target function =                  N/A
              le_mean =     -16.905304072694
             les_mean =     286.133299732330
             stat err =       0.000465420674
             autocorr =       1.259419243136
              std dev =       0.586510114208
             le_variance =       0.343994114068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344129290270
                                         uncertainty =       0.005536837228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344129290270
                                         uncertainty =       0.005536837228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414725255
  error estimate for blocks of size 2^( 2) =       0.000427113229
  error estimate for blocks of size 2^( 3) =       0.000440815345
  error estimate for blocks of size 2^( 4) =       0.000452679033
  error estimate for blocks of size 2^( 5) =       0.000463110584
  error estimate for blocks of size 2^( 6) =       0.000469655099
  error estimate for blocks of size 2^( 7) =       0.000476237919

      target function =                  N/A
              le_mean =     -16.905304073099
             les_mean =     286.133299706295
             stat err =       0.000465420659
             autocorr =       1.259419308362
              std dev =       0.586510080339
             le_variance =       0.343994074340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344129255479
                                         uncertainty =       0.005536836369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344129255479
                                         uncertainty =       0.005536836369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414725234
  error estimate for blocks of size 2^( 2) =       0.000427113210
  error estimate for blocks of size 2^( 3) =       0.000440815329
  error estimate for blocks of size 2^( 4) =       0.000452679018
  error estimate for blocks of size 2^( 5) =       0.000463110571
  error estimate for blocks of size 2^( 6) =       0.000469655087
  error estimate for blocks of size 2^( 7) =       0.000476237906

      target function =                  N/A
              le_mean =     -16.905304073454
             les_mean =     286.133299683515
             stat err =       0.000465420646
             autocorr =       1.259419365460
              std dev =       0.586510050702
             le_variance =       0.343994039574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905304073505        initial  <--
     2.2737e+03     2.2737e+04             1.9634e-07       -16.905304072694
     9.0949e+03     9.0949e+04             4.9087e-08       -16.905304073099
     3.6380e+04     3.6380e+05             1.2272e-08       -16.905304073454

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4323
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132497e-02 1 1  ON 3
 uu_4                -6.660016e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414692e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587005e-03 1 1  ON 13
 ud_4                -6.482290e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169448e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214374e-01 1 1  ON 28
 eO_9                -8.650635e-02 1 1  ON 29
eH1_0                -2.446292e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858415e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337486e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659622e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793013e-02 1 1  ON 39
eH2_0                -2.423306e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645385e-02 1 1  ON 42
eH2_3                -4.248615e-02 1 1  ON 43
eH2_4                 5.559886e-03 1 1  ON 44
eH2_5                 4.021241e-02 1 1  ON 45
eH2_6                 9.947929e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1211e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9544
    reference variance = 0.373984
====================================================
  Execution time = 3.9289e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4152e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0805e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341543902923
                                         uncertainty =       0.004755901237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341543902923
                                         uncertainty =       0.004755901237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413231942
  error estimate for blocks of size 2^( 2) =       0.000425935212
  error estimate for blocks of size 2^( 3) =       0.000438232096
  error estimate for blocks of size 2^( 4) =       0.000449882877
  error estimate for blocks of size 2^( 5) =       0.000459861689
  error estimate for blocks of size 2^( 6) =       0.000467676726
  error estimate for blocks of size 2^( 7) =       0.000471087534

      target function =                  N/A
              le_mean =     -16.906250710054
             les_mean =     286.162834176661
             stat err =       0.000462127207
             autocorr =       1.250648612294
              std dev =       0.584398217166
             le_variance =       0.341521276227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690625071005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906250710054       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906250710121       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906250710153       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250710148       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906250710132       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906250710154       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906250710172       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906250710168       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 1.548397e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906250710054       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906250710071       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906250710079       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250710048       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906250710044       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906250710060       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906250710057       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906250710030       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 3.871002e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906250710054       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906250710058       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906250710060       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250710045       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906250710057       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906250710165       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906250710271       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906250709979       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 9.677510e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0101e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132497e-02 1 1  ON 3
 uu_4                -6.660016e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414692e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587007e-03 1 1  ON 13
 ud_4                -6.482290e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169448e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214374e-01 1 1  ON 28
 eO_9                -8.650635e-02 1 1  ON 29
eH1_0                -2.446292e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858415e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337485e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659622e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793013e-02 1 1  ON 39
eH2_0                -2.423306e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645384e-02 1 1  ON 42
eH2_3                -4.248615e-02 1 1  ON 43
eH2_4                 5.559888e-03 1 1  ON 44
eH2_5                 4.021241e-02 1 1  ON 45
eH2_6                 9.947929e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9798
    reference variance = 0.217777
====================================================
  Execution time = 3.8928e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3944e-01
  Total weights = 2.0000e+06
  Execution time = 3.6539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339408897234
                                         uncertainty =       0.003863663520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339408897234
                                         uncertainty =       0.003863663520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411973255
  error estimate for blocks of size 2^( 2) =       0.000424516886
  error estimate for blocks of size 2^( 3) =       0.000438054751
  error estimate for blocks of size 2^( 4) =       0.000449960520
  error estimate for blocks of size 2^( 5) =       0.000460511972
  error estimate for blocks of size 2^( 6) =       0.000467752654
  error estimate for blocks of size 2^( 7) =       0.000475210025

      target function =                  N/A
              le_mean =     -16.906330486479
             les_mean =     286.163454273483
             stat err =       0.000463358793
             autocorr =       1.265018194548
              std dev =       0.582618164122
             le_variance =       0.339443925165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339408895398
                                         uncertainty =       0.003863663530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339408895398
                                         uncertainty =       0.003863663530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411973254
  error estimate for blocks of size 2^( 2) =       0.000424516884
  error estimate for blocks of size 2^( 3) =       0.000438054749
  error estimate for blocks of size 2^( 4) =       0.000449960518
  error estimate for blocks of size 2^( 5) =       0.000460511971
  error estimate for blocks of size 2^( 6) =       0.000467752652
  error estimate for blocks of size 2^( 7) =       0.000475210023

      target function =                  N/A
              le_mean =     -16.906330486364
             les_mean =     286.163454267753
             stat err =       0.000463358791
             autocorr =       1.265018192052
              std dev =       0.582618162543
             le_variance =       0.339443923325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339408896316
                                         uncertainty =       0.003863663525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339408896316
                                         uncertainty =       0.003863663525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411973254
  error estimate for blocks of size 2^( 2) =       0.000424516885
  error estimate for blocks of size 2^( 3) =       0.000438054750
  error estimate for blocks of size 2^( 4) =       0.000449960519
  error estimate for blocks of size 2^( 5) =       0.000460511971
  error estimate for blocks of size 2^( 6) =       0.000467752653
  error estimate for blocks of size 2^( 7) =       0.000475210024

      target function =                  N/A
              le_mean =     -16.906330486421
             les_mean =     286.163454270618
             stat err =       0.000463358792
             autocorr =       1.265018193305
              std dev =       0.582618163332
             le_variance =       0.339443924245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339408897119
                                         uncertainty =       0.003863663521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339408897119
                                         uncertainty =       0.003863663521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411973255
  error estimate for blocks of size 2^( 2) =       0.000424516886
  error estimate for blocks of size 2^( 3) =       0.000438054751
  error estimate for blocks of size 2^( 4) =       0.000449960520
  error estimate for blocks of size 2^( 5) =       0.000460511972
  error estimate for blocks of size 2^( 6) =       0.000467752653
  error estimate for blocks of size 2^( 7) =       0.000475210024

      target function =                  N/A
              le_mean =     -16.906330486472
             les_mean =     286.163454273124
             stat err =       0.000463358792
             autocorr =       1.265018194385
              std dev =       0.582618164023
             le_variance =       0.339443925050


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906330486479        initial  <--
     2.2737e+04     2.2737e+05             1.5484e-08       -16.906330486364
     9.0949e+04     9.0949e+05             3.8710e-09       -16.906330486421
     3.6380e+05     3.6380e+06             9.6775e-10       -16.906330486472

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.3123
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132497e-02 1 1  ON 3
 uu_4                -6.660016e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414692e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587005e-03 1 1  ON 13
 ud_4                -6.482290e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169448e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214374e-01 1 1  ON 28
 eO_9                -8.650635e-02 1 1  ON 29
eH1_0                -2.446292e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858415e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337486e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659622e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793013e-02 1 1  ON 39
eH2_0                -2.423306e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645385e-02 1 1  ON 42
eH2_3                -4.248615e-02 1 1  ON 43
eH2_4                 5.559886e-03 1 1  ON 44
eH2_5                 4.021241e-02 1 1  ON 45
eH2_6                 9.947929e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0742e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9038
    reference variance = 0.381706
====================================================
  Execution time = 3.9321e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4455e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0777e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344628674512
                                         uncertainty =       0.003918052548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344628674512
                                         uncertainty =       0.003918052548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415060087
  error estimate for blocks of size 2^( 2) =       0.000427380843
  error estimate for blocks of size 2^( 3) =       0.000440505775
  error estimate for blocks of size 2^( 4) =       0.000452777425
  error estimate for blocks of size 2^( 5) =       0.000463448178
  error estimate for blocks of size 2^( 6) =       0.000472661200
  error estimate for blocks of size 2^( 7) =       0.000477720949

      target function =                  N/A
              le_mean =     -16.906136244691
             les_mean =     286.161992304030
             stat err =       0.000466651938
             autocorr =       1.264049848155
              std dev =       0.586983604749
             le_variance =       0.344549752244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613624469e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136244691       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136244697       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906136244698       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906136244701       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906136244607       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136244719       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906136244922       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906136244477       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+05 is 1.771744e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136244691       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136244693       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906136244693       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906136244694       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906136244471       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136244427       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906136245149       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906136243582       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 4.429361e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136244691       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136244692       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906136244692       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906136244158       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906136248044       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136244938       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906136241677       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906136247245       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 1.107339e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227508 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0105e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132497e-02 1 1  ON 3
 uu_4                -6.660016e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414692e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587006e-03 1 1  ON 13
 ud_4                -6.482290e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169448e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214374e-01 1 1  ON 28
 eO_9                -8.650635e-02 1 1  ON 29
eH1_0                -2.446292e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858415e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337486e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659622e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793013e-02 1 1  ON 39
eH2_0                -2.423306e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645385e-02 1 1  ON 42
eH2_3                -4.248615e-02 1 1  ON 43
eH2_4                 5.559886e-03 1 1  ON 44
eH2_5                 4.021241e-02 1 1  ON 45
eH2_6                 9.947929e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8823
    reference variance = 0.204708
====================================================
  Execution time = 3.8708e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3460e-01
  Total weights = 2.0000e+06
  Execution time = 3.6494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334718104460
                                         uncertainty =       0.003769197062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334718104460
                                         uncertainty =       0.003769197062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409023068
  error estimate for blocks of size 2^( 2) =       0.000421515925
  error estimate for blocks of size 2^( 3) =       0.000434458229
  error estimate for blocks of size 2^( 4) =       0.000446694685
  error estimate for blocks of size 2^( 5) =       0.000456628030
  error estimate for blocks of size 2^( 6) =       0.000463522596
  error estimate for blocks of size 2^( 7) =       0.000468520266

      target function =                  N/A
              le_mean =     -16.906762559698
             les_mean =     286.173219823573
             stat err =       0.000458841394
             autocorr =       1.258431488639
              std dev =       0.578445970565
             le_variance =       0.334599740863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334718104900
                                         uncertainty =       0.003769197072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334718104900
                                         uncertainty =       0.003769197072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409023069
  error estimate for blocks of size 2^( 2) =       0.000421515925
  error estimate for blocks of size 2^( 3) =       0.000434458229
  error estimate for blocks of size 2^( 4) =       0.000446694685
  error estimate for blocks of size 2^( 5) =       0.000456628030
  error estimate for blocks of size 2^( 6) =       0.000463522596
  error estimate for blocks of size 2^( 7) =       0.000468520266

      target function =                  N/A
              le_mean =     -16.906762559704
             les_mean =     286.173219824204
             stat err =       0.000458841394
             autocorr =       1.258431487966
              std dev =       0.578445970944
             le_variance =       0.334599741302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334718104680
                                         uncertainty =       0.003769197067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334718104680
                                         uncertainty =       0.003769197067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409023068
  error estimate for blocks of size 2^( 2) =       0.000421515925
  error estimate for blocks of size 2^( 3) =       0.000434458229
  error estimate for blocks of size 2^( 4) =       0.000446694685
  error estimate for blocks of size 2^( 5) =       0.000456628030
  error estimate for blocks of size 2^( 6) =       0.000463522596
  error estimate for blocks of size 2^( 7) =       0.000468520266

      target function =                  N/A
              le_mean =     -16.906762559701
             les_mean =     286.173219823889
             stat err =       0.000458841394
             autocorr =       1.258431488303
              std dev =       0.578445970755
             le_variance =       0.334599741082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334718104488
                                         uncertainty =       0.003769197062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334718104488
                                         uncertainty =       0.003769197062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409023068
  error estimate for blocks of size 2^( 2) =       0.000421515925
  error estimate for blocks of size 2^( 3) =       0.000434458229
  error estimate for blocks of size 2^( 4) =       0.000446694685
  error estimate for blocks of size 2^( 5) =       0.000456628030
  error estimate for blocks of size 2^( 6) =       0.000463522596
  error estimate for blocks of size 2^( 7) =       0.000468520266

      target function =                  N/A
              le_mean =     -16.906762559698
             les_mean =     286.173219823613
             stat err =       0.000458841394
             autocorr =       1.258431488592
              std dev =       0.578445970589
             le_variance =       0.334599740890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906762559698        initial
     2.2737e+05     2.2737e+06             1.7717e-09       -16.906762559704  <--
     9.0949e+05     9.0949e+06             4.4294e-10       -16.906762559701
     3.6380e+06     3.6380e+07             1.1073e-10       -16.906762559698

*****************************************************************************
Applying the update for shift_i =   2.2737e+05     and shift_s =   2.2737e+06
*****************************************************************************

  Execution time = 5.7056e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132497e-02 1 1  ON 3
 uu_4                -6.660016e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414692e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587006e-03 1 1  ON 13
 ud_4                -6.482290e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169448e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214374e-01 1 1  ON 28
 eO_9                -8.650635e-02 1 1  ON 29
eH1_0                -2.446292e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858415e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337486e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659622e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793013e-02 1 1  ON 39
eH2_0                -2.423306e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645385e-02 1 1  ON 42
eH2_3                -4.248615e-02 1 1  ON 43
eH2_4                 5.559886e-03 1 1  ON 44
eH2_5                 4.021241e-02 1 1  ON 45
eH2_6                 9.947929e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0743e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.861
    reference variance = 0.25004
====================================================
  Execution time = 3.9495e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4066e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0753e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340758612807
                                         uncertainty =       0.005260182860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340758612807
                                         uncertainty =       0.005260182860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412710369
  error estimate for blocks of size 2^( 2) =       0.000425186875
  error estimate for blocks of size 2^( 3) =       0.000438358280
  error estimate for blocks of size 2^( 4) =       0.000449806246
  error estimate for blocks of size 2^( 5) =       0.000459621305
  error estimate for blocks of size 2^( 6) =       0.000468017390
  error estimate for blocks of size 2^( 7) =       0.000474166805

      target function =                  N/A
              le_mean =     -16.906323583199
             les_mean =     286.164436626786
             stat err =       0.000462902936
             autocorr =       1.258024534374
              std dev =       0.583660601121
             le_variance =       0.340659697301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632358320e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906323583199       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906323583207       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906323583225       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906323583204       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906323583218       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906323583281       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906323583276       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906323583250       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+04 is 7.841594e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906323583199       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906323583201       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906323583205       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906323583149       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906323583129       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906323583053       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906323583797       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906323583426       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+05 is 1.960400e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906323583199       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906323583199       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906323583200       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906323583051       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906323583272       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906323583230       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906323584200       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906323583338       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 4.901001e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230132 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0255e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132497e-02 1 1  ON 3
 uu_4                -6.660016e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414692e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587007e-03 1 1  ON 13
 ud_4                -6.482290e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169448e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214374e-01 1 1  ON 28
 eO_9                -8.650635e-02 1 1  ON 29
eH1_0                -2.446292e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858415e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337487e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659622e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793013e-02 1 1  ON 39
eH2_0                -2.423306e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645384e-02 1 1  ON 42
eH2_3                -4.248615e-02 1 1  ON 43
eH2_4                 5.559887e-03 1 1  ON 44
eH2_5                 4.021241e-02 1 1  ON 45
eH2_6                 9.947929e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9032
    reference variance = 0.226535
====================================================
  Execution time = 4.0130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.3490e-01
  Total weights = 2.0000e+06
  Execution time = 3.6478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435098880223
                                         uncertainty =       0.078284754554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435098880223
                                         uncertainty =       0.078284754554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466313726
  error estimate for blocks of size 2^( 2) =       0.000477490834
  error estimate for blocks of size 2^( 3) =       0.000489140978
  error estimate for blocks of size 2^( 4) =       0.000500147562
  error estimate for blocks of size 2^( 5) =       0.000508729497
  error estimate for blocks of size 2^( 6) =       0.000514353237
  error estimate for blocks of size 2^( 7) =       0.000519453894

      target function =                  N/A
              le_mean =     -16.905526290892
             les_mean =     286.231715936234
             stat err =       0.000510671047
             autocorr =       1.199295141990
              std dev =       0.659467195282
             le_variance =       0.434896981653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435098882555
                                         uncertainty =       0.078284755399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435098882555
                                         uncertainty =       0.078284755399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466313727
  error estimate for blocks of size 2^( 2) =       0.000477490835
  error estimate for blocks of size 2^( 3) =       0.000489140979
  error estimate for blocks of size 2^( 4) =       0.000500147563
  error estimate for blocks of size 2^( 5) =       0.000508729498
  error estimate for blocks of size 2^( 6) =       0.000514353238
  error estimate for blocks of size 2^( 7) =       0.000519453895

      target function =                  N/A
              le_mean =     -16.905526290869
             les_mean =     286.231715937809
             stat err =       0.000510671048
             autocorr =       1.199295139549
              std dev =       0.659467197049
             le_variance =       0.434896983983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435098881389
                                         uncertainty =       0.078284754976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435098881389
                                         uncertainty =       0.078284754976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466313726
  error estimate for blocks of size 2^( 2) =       0.000477490835
  error estimate for blocks of size 2^( 3) =       0.000489140978
  error estimate for blocks of size 2^( 4) =       0.000500147562
  error estimate for blocks of size 2^( 5) =       0.000508729497
  error estimate for blocks of size 2^( 6) =       0.000514353237
  error estimate for blocks of size 2^( 7) =       0.000519453894

      target function =                  N/A
              le_mean =     -16.905526290880
             les_mean =     286.231715937021
             stat err =       0.000510671048
             autocorr =       1.199295140771
              std dev =       0.659467196165
             le_variance =       0.434896982818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435098880369
                                         uncertainty =       0.078284754607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435098880369
                                         uncertainty =       0.078284754607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466313726
  error estimate for blocks of size 2^( 2) =       0.000477490834
  error estimate for blocks of size 2^( 3) =       0.000489140978
  error estimate for blocks of size 2^( 4) =       0.000500147562
  error estimate for blocks of size 2^( 5) =       0.000508729497
  error estimate for blocks of size 2^( 6) =       0.000514353237
  error estimate for blocks of size 2^( 7) =       0.000519453894

      target function =                  N/A
              le_mean =     -16.905526290890
             les_mean =     286.231715936332
             stat err =       0.000510671047
             autocorr =       1.199295141837
              std dev =       0.659467195393
             le_variance =       0.434896981799


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905526290892        initial  <--
     5.6843e+04     5.6843e+05             7.8416e-09       -16.905526290869
     2.2737e+05     2.2737e+06             1.9604e-09       -16.905526290880
     9.0949e+05     9.0949e+06             4.9010e-10       -16.905526290890

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 58.5024
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.091882e-01 1 1  ON 0
 uu_1                 1.424756e-01 1 1  ON 1
 uu_2                 4.098565e-02 1 1  ON 2
 uu_3                -2.132497e-02 1 1  ON 3
 uu_4                -6.660016e-02 1 1  ON 4
 uu_5                -1.013739e-01 1 1  ON 5
 uu_6                -1.283791e-01 1 1  ON 6
 uu_7                -1.414692e-01 1 1  ON 7
 uu_8                -1.334578e-01 1 1  ON 8
 uu_9                -1.050591e-01 1 1  ON 9
 ud_0                 4.477293e-01 1 1  ON 10
 ud_1                 1.824639e-01 1 1  ON 11
 ud_2                 6.291332e-02 1 1  ON 12
 ud_3                -7.587006e-03 1 1  ON 13
 ud_4                -6.482290e-02 1 1  ON 14
 ud_5                -1.069225e-01 1 1  ON 15
 ud_6                -1.349526e-01 1 1  ON 16
 ud_7                -1.520023e-01 1 1  ON 17
 ud_8                -1.529484e-01 1 1  ON 18
 ud_9                -1.433847e-01 1 1  ON 19
 eO_0                -7.600895e-01 1 1  ON 20
 eO_1                -4.399389e-01 1 1  ON 21
 eO_2                -2.169448e-02 1 1  ON 22
 eO_3                 2.987002e-01 1 1  ON 23
 eO_4                 5.254014e-01 1 1  ON 24
 eO_5                 4.877411e-01 1 1  ON 25
 eO_6                 2.599543e-01 1 1  ON 26
 eO_7                -4.072154e-02 1 1  ON 27
 eO_8                -2.214374e-01 1 1  ON 28
 eO_9                -8.650635e-02 1 1  ON 29
eH1_0                -2.446292e-01 1 1  ON 30
eH1_1                -1.452581e-01 1 1  ON 31
eH1_2                -9.858415e-02 1 1  ON 32
eH1_3                -4.483527e-02 1 1  ON 33
eH1_4                 3.337486e-03 1 1  ON 34
eH1_5                 3.810846e-02 1 1  ON 35
eH1_6                 9.659622e-02 1 1  ON 36
eH1_7                 1.541040e-01 1 1  ON 37
eH1_8                 1.772383e-01 1 1  ON 38
eH1_9                 6.793013e-02 1 1  ON 39
eH2_0                -2.423306e-01 1 1  ON 40
eH2_1                -1.429476e-01 1 1  ON 41
eH2_2                -9.645385e-02 1 1  ON 42
eH2_3                -4.248615e-02 1 1  ON 43
eH2_4                 5.559886e-03 1 1  ON 44
eH2_5                 4.021241e-02 1 1  ON 45
eH2_6                 9.947929e-02 1 1  ON 46
eH2_7                 1.552573e-01 1 1  ON 47
eH2_8                 1.827555e-01 1 1  ON 48
eH2_9                 5.749579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0876e+02 secs
  Total Execution time = 4.3851e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
