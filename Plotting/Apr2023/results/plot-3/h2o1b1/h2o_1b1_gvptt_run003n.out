Rank =    0  Free Memory = 76014 MB
Rank =    1  Free Memory = 76014 MB
Rank =    2  Free Memory = 76014 MB
Rank =    3  Free Memory = 76014 MB
Rank =    4  Free Memory = 76013 MB
Rank =    5  Free Memory = 76013 MB
Rank =    6  Free Memory = 76012 MB
Rank =    7  Free Memory = 76012 MB
Rank =    8  Free Memory = 76012 MB
Rank =    9  Free Memory = 76012 MB
Rank =   10  Free Memory = 76012 MB
Rank =   11  Free Memory = 76012 MB
Rank =   12  Free Memory = 76012 MB
Rank =   13  Free Memory = 76012 MB
Rank =   14  Free Memory = 76012 MB
Rank =   15  Free Memory = 75998 MB
Rank =   16  Free Memory = 75997 MB
Rank =   17  Free Memory = 75997 MB
Rank =   18  Free Memory = 75997 MB
Rank =   19  Free Memory = 75997 MB
Rank =   20  Free Memory = 75997 MB
Rank =   21  Free Memory = 75997 MB
Rank =   22  Free Memory = 75997 MB
Rank =   23  Free Memory = 75997 MB
Rank =   24  Free Memory = 75997 MB
Rank =   25  Free Memory = 75997 MB
Rank =   26  Free Memory = 75997 MB
Rank =   27  Free Memory = 75997 MB
Rank =   28  Free Memory = 75997 MB
Rank =   29  Free Memory = 75997 MB
Rank =   30  Free Memory = 75997 MB
Rank =   31  Free Memory = 75997 MB
Rank =   32  Free Memory = 84925 MB
Rank =   33  Free Memory = 84925 MB
Rank =   34  Free Memory = 84925 MB
Rank =   35  Free Memory = 84925 MB
Rank =   36  Free Memory = 84925 MB
Rank =   37  Free Memory = 84925 MB
Rank =   38  Free Memory = 84925 MB
Rank =   39  Free Memory = 84925 MB
Rank =   40  Free Memory = 84925 MB
Rank =   41  Free Memory = 84925 MB
Rank =   42  Free Memory = 84925 MB
Rank =   43  Free Memory = 84925 MB
Rank =   44  Free Memory = 84925 MB
Rank =   45  Free Memory = 84925 MB
Rank =   46  Free Memory = 84925 MB
Rank =   47  Free Memory = 84925 MB
Rank =   48  Free Memory = 84925 MB
Rank =   49  Free Memory = 84924 MB
Rank =   50  Free Memory = 84924 MB
Rank =   51  Free Memory = 84924 MB
Rank =   52  Free Memory = 84924 MB
Rank =   53  Free Memory = 84924 MB
Rank =   54  Free Memory = 84924 MB
Rank =   55  Free Memory = 84924 MB
Rank =   56  Free Memory = 84924 MB
Rank =   57  Free Memory = 84924 MB
Rank =   58  Free Memory = 84924 MB
Rank =   59  Free Memory = 84924 MB
Rank =   60  Free Memory = 84924 MB
Rank =   61  Free Memory = 84924 MB
Rank =   62  Free Memory = 84924 MB
Rank =   63  Free Memory = 84924 MB
Rank =   64  Free Memory = 85016 MB
Rank =   65  Free Memory = 85016 MB
Rank =   66  Free Memory = 85016 MB
Rank =   67  Free Memory = 85016 MB
Rank =   68  Free Memory = 85016 MB
Rank =   69  Free Memory = 85016 MB
Rank =   70  Free Memory = 85016 MB
Rank =   71  Free Memory = 85016 MB
Rank =   72  Free Memory = 85016 MB
Rank =   73  Free Memory = 85016 MB
Rank =   74  Free Memory = 85016 MB
Rank =   75  Free Memory = 85016 MB
Rank =   76  Free Memory = 85016 MB
Rank =   77  Free Memory = 85016 MB
Rank =   78  Free Memory = 85016 MB
Rank =   79  Free Memory = 85016 MB
Rank =   80  Free Memory = 85016 MB
Rank =   81  Free Memory = 85016 MB
Rank =   82  Free Memory = 85016 MB
Rank =   83  Free Memory = 85016 MB
Rank =   84  Free Memory = 85016 MB
Rank =   85  Free Memory = 85016 MB
Rank =   86  Free Memory = 85016 MB
Rank =   87  Free Memory = 85016 MB
Rank =   88  Free Memory = 85016 MB
Rank =   89  Free Memory = 85016 MB
Rank =   90  Free Memory = 85016 MB
Rank =   91  Free Memory = 85016 MB
Rank =   92  Free Memory = 85016 MB
Rank =   93  Free Memory = 85016 MB
Rank =   94  Free Memory = 85016 MB
Rank =   95  Free Memory = 85016 MB
Rank =   96  Free Memory = 88093 MB
Rank =   97  Free Memory = 88093 MB
Rank =   98  Free Memory = 88093 MB
Rank =   99  Free Memory = 88093 MB
Rank =  100  Free Memory = 88093 MB
Rank =  101  Free Memory = 88093 MB
Rank =  102  Free Memory = 88093 MB
Rank =  103  Free Memory = 88093 MB
Rank =  104  Free Memory = 88093 MB
Rank =  105  Free Memory = 88092 MB
Rank =  106  Free Memory = 88092 MB
Rank =  107  Free Memory = 88092 MB
Rank =  108  Free Memory = 88092 MB
Rank =  109  Free Memory = 88092 MB
Rank =  110  Free Memory = 88092 MB
Rank =  111  Free Memory = 88092 MB
Rank =  112  Free Memory = 88092 MB
Rank =  113  Free Memory = 88092 MB
Rank =  114  Free Memory = 88092 MB
Rank =  115  Free Memory = 88092 MB
Rank =  116  Free Memory = 88092 MB
Rank =  117  Free Memory = 88092 MB
Rank =  118  Free Memory = 88092 MB
Rank =  119  Free Memory = 88092 MB
Rank =  120  Free Memory = 88092 MB
Rank =  121  Free Memory = 88092 MB
Rank =  122  Free Memory = 88092 MB
Rank =  123  Free Memory = 88092 MB
Rank =  124  Free Memory = 88092 MB
Rank =  125  Free Memory = 88092 MB
Rank =  126  Free Memory = 88092 MB
Rank =  127  Free Memory = 88092 MB
  Input file(s): opt_h2o_1b1_gvptt_run003n.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003n.xml

  Project = H2O
  date    = 2023-04-13 17:14:36 PDT
  host    = n0015.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 748

  Range of prime numbers to use as seeds over processors and threads = 5693-6827


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.115760e-01    1         1  ON     0
     uu_1                 1.445829e-01    1         1  ON     1
     uu_2                 4.293969e-02    1         1  ON     2
     uu_3                -1.978169e-02    1         1  ON     3
     uu_4                -6.600940e-02    1         1  ON     4
     uu_5                -1.015321e-01    1         1  ON     5
     uu_6                -1.293719e-01    1         1  ON     6
     uu_7                -1.441037e-01    1         1  ON     7
     uu_8                -1.378683e-01    1         1  ON     8
     uu_9                -1.087603e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.513459e-01    1         1  ON     0
     ud_1                 1.852763e-01    1         1  ON     1
     ud_2                 6.423632e-02    1         1  ON     2
     ud_3                -7.492154e-03    1         1  ON     3
     ud_4                -6.482425e-02    1         1  ON     4
     ud_5                -1.070174e-01    1         1  ON     5
     ud_6                -1.352779e-01    1         1  ON     6
     ud_7                -1.521017e-01    1         1  ON     7
     ud_8                -1.537728e-01    1         1  ON     8
     ud_9                -1.418151e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.569963e-01    1         1  ON     0
     eO_1                -4.354246e-01    1         1  ON     1
     eO_2                -1.819153e-02    1         1  ON     2
     eO_3                 2.998427e-01    1         1  ON     3
     eO_4                 5.270153e-01    1         1  ON     4
     eO_5                 4.892165e-01    1         1  ON     5
     eO_6                 2.599645e-01    1         1  ON     6
     eO_7                -4.230751e-02    1         1  ON     7
     eO_8                -2.283021e-01    1         1  ON     8
     eO_9                -9.250039e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.549669e-01    1         1  ON     0
     eH1_1                -1.518810e-01    1         1  ON     1
     eH1_2                -1.032905e-01    1         1  ON     2
     eH1_3                -4.827885e-02    1         1  ON     3
     eH1_4                 1.756167e-03    1         1  ON     4
     eH1_5                 3.783704e-02    1         1  ON     5
     eH1_6                 9.718659e-02    1         1  ON     6
     eH1_7                 1.565089e-01    1         1  ON     7
     eH1_8                 1.867365e-01    1         1  ON     8
     eH1_9                 7.951785e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.516180e-01    1         1  ON     0
     eH2_1                -1.477201e-01    1         1  ON     1
     eH2_2                -9.980361e-02    1         1  ON     2
     eH2_3                -4.503102e-02    1         1  ON     3
     eH2_4                 4.510211e-03    1         1  ON     4
     eH2_5                 4.015897e-02    1         1  ON     5
     eH2_6                 9.843132e-02    1         1  ON     6
     eH2_7                 1.587333e-01    1         1  ON     7
     eH2_8                 1.912083e-01    1         1  ON     8
     eH2_9                 6.691519e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.822099e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.3245e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8265
    reference variance = 0.202112
====================================================
  Execution time = 2.0807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4133e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341378723659
                                         uncertainty =       0.003613327831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341378723659
                                         uncertainty =       0.003613327831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413114768
  error estimate for blocks of size 2^( 2) =       0.000426073646
  error estimate for blocks of size 2^( 3) =       0.000439054079
  error estimate for blocks of size 2^( 4) =       0.000450504604
  error estimate for blocks of size 2^( 5) =       0.000461881268
  error estimate for blocks of size 2^( 6) =       0.000470066308
  error estimate for blocks of size 2^( 7) =       0.000474856440

      target function =                  N/A
              le_mean =     -16.906314135763
             les_mean =     286.164785109614
             stat err =       0.000464327155
             autocorr =       1.263300665513
              std dev =       0.584232507795
             le_variance =       0.341327623165


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690631413576e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906314135763       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906314049106       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906316080476       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906317034048       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906317717999       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906317803189       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906318012046       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906317904038       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906317696240       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906317820287       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.938725e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906314135763       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906314104872       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906314986493       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906315240088       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906315404588       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906315375703       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906315379666       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906315359907       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.228793e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906314135763       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906314127120       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906314401960       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906314461596       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906314505080       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906314501632       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906314491739       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906314490066       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.571354e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6511e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.116030e-01                 1 1 ON  0
uu_1  1.446519e-01                 1 1 ON  1
uu_2  4.300042e-02                 1 1 ON  2
uu_3  -1.977715e-02                1 1 ON  3
uu_4  -6.596482e-02                1 1 ON  4
uu_5  -1.015815e-01                1 1 ON  5
uu_6  -1.294737e-01                1 1 ON  6
uu_7  -1.442598e-01                1 1 ON  7
uu_8  -1.379251e-01                1 1 ON  8
uu_9  -1.087827e-01                1 1 ON  9
ud_0  4.513051e-01                 1 1 ON  10
ud_1  1.852567e-01                 1 1 ON  11
ud_2  6.428809e-02                 1 1 ON  12
ud_3  -7.486368e-03                1 1 ON  13
ud_4  -6.485198e-02                1 1 ON  14
ud_5  -1.069776e-01                1 1 ON  15
ud_6  -1.351825e-01                1 1 ON  16
ud_7  -1.520927e-01                1 1 ON  17
ud_8  -1.537487e-01                1 1 ON  18
ud_9  -1.418759e-01                1 1 ON  19
eO_0  -7.569059e-01                1 1 ON  20
eO_1  -4.353511e-01                1 1 ON  21
eO_2  -1.823171e-02                1 1 ON  22
eO_3  2.998973e-01                 1 1 ON  23
eO_4  5.269557e-01                 1 1 ON  24
eO_5  4.892887e-01                 1 1 ON  25
eO_6  2.600240e-01                 1 1 ON  26
eO_7  -4.230579e-02                1 1 ON  27
eO_8  -2.284049e-01                1 1 ON  28
eO_9  -9.262699e-02                1 1 ON  29
eH1_0 -2.551190e-01                1 1 ON  30
eH1_1 -1.518901e-01                1 1 ON  31
eH1_2 -1.033505e-01                1 1 ON  32
eH1_3 -4.824162e-02                1 1 ON  33
eH1_4 1.799294e-03                 1 1 ON  34
eH1_5 3.782052e-02                 1 1 ON  35
eH1_6 9.711112e-02                 1 1 ON  36
eH1_7 1.564307e-01                 1 1 ON  37
eH1_8 1.868553e-01                 1 1 ON  38
eH1_9 7.970659e-02                 1 1 ON  39
eH2_0 -2.517924e-01                1 1 ON  40
eH2_1 -1.478425e-01                1 1 ON  41
eH2_2 -9.983119e-02                1 1 ON  42
eH2_3 -4.504192e-02                1 1 ON  43
eH2_4 4.435015e-03                 1 1 ON  44
eH2_5 4.007408e-02                 1 1 ON  45
eH2_6 9.842923e-02                 1 1 ON  46
eH2_7 1.588145e-01                 1 1 ON  47
eH2_8 1.913639e-01                 1 1 ON  48
eH2_9 6.713807e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8948
    reference variance = 0.403292
====================================================
  Execution time = 2.0465e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4337e-01
  Total weights = 2.0000e+06
  Execution time = 1.8946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343443490422
                                         uncertainty =       0.003874867276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343443490422
                                         uncertainty =       0.003874867276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414394788
  error estimate for blocks of size 2^( 2) =       0.000427532813
  error estimate for blocks of size 2^( 3) =       0.000440569578
  error estimate for blocks of size 2^( 4) =       0.000453189651
  error estimate for blocks of size 2^( 5) =       0.000463324360
  error estimate for blocks of size 2^( 6) =       0.000472034390
  error estimate for blocks of size 2^( 7) =       0.000475660072

      target function =                  N/A
              le_mean =     -16.905957418316
             les_mean =     286.154842139387
             stat err =       0.000466052118
             autocorr =       1.264854012615
              std dev =       0.586042729846
             le_variance =       0.343446081206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343273058469
                                         uncertainty =       0.003871877628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343273058469
                                         uncertainty =       0.003871877628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414291979
  error estimate for blocks of size 2^( 2) =       0.000427432240
  error estimate for blocks of size 2^( 3) =       0.000440472663
  error estimate for blocks of size 2^( 4) =       0.000453097203
  error estimate for blocks of size 2^( 5) =       0.000463238634
  error estimate for blocks of size 2^( 6) =       0.000471952703
  error estimate for blocks of size 2^( 7) =       0.000475583191

      target function =                  N/A
              le_mean =     -16.905961884650
             les_mean =     286.154822762022
             stat err =       0.000465967933
             autocorr =       1.265024711430
              std dev =       0.585897336065
             le_variance =       0.343275688408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343286993490
                                         uncertainty =       0.003872361681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343286993490
                                         uncertainty =       0.003872361681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414300376
  error estimate for blocks of size 2^( 2) =       0.000427441353
  error estimate for blocks of size 2^( 3) =       0.000440481948
  error estimate for blocks of size 2^( 4) =       0.000453106092
  error estimate for blocks of size 2^( 5) =       0.000463245831
  error estimate for blocks of size 2^( 6) =       0.000471958821
  error estimate for blocks of size 2^( 7) =       0.000475587546

      target function =                  N/A
              le_mean =     -16.905961044919
             les_mean =     286.154808284045
             stat err =       0.000465974572
             autocorr =       1.265009484012
              std dev =       0.585909210851
             le_variance =       0.343289603360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343417841346
                                         uncertainty =       0.003874481944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343417841346
                                         uncertainty =       0.003874481944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414379316
  error estimate for blocks of size 2^( 2) =       0.000427517891
  error estimate for blocks of size 2^( 3) =       0.000440555328
  error estimate for blocks of size 2^( 4) =       0.000453176032
  error estimate for blocks of size 2^( 5) =       0.000463311448
  error estimate for blocks of size 2^( 6) =       0.000472021969
  error estimate for blocks of size 2^( 7) =       0.000475648026

      target function =                  N/A
              le_mean =     -16.905957946336
             les_mean =     286.154834345839
             stat err =       0.000466039369
             autocorr =       1.264879266165
              std dev =       0.586020847982
             le_variance =       0.343420434270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905957418316        initial
     2.5000e-01     2.5000e+00             8.9387e-04       -16.905961884650  <--
     1.0000e+00     1.0000e+01             2.2288e-04       -16.905961044919
     4.0000e+00     4.0000e+01             5.5714e-05       -16.905957946336

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9991e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.117199e-01 1 1  ON 0
 uu_1                 1.447786e-01 1 1  ON 1
 uu_2                 4.312028e-02 1 1  ON 2
 uu_3                -1.972857e-02 1 1  ON 3
 uu_4                -6.590620e-02 1 1  ON 4
 uu_5                -1.016874e-01 1 1  ON 5
 uu_6                -1.297108e-01 1 1  ON 6
 uu_7                -1.446570e-01 1 1  ON 7
 uu_8                -1.381146e-01 1 1  ON 8
 uu_9                -1.088635e-01 1 1  ON 9
 ud_0                 4.512677e-01 1 1  ON 10
 ud_1                 1.852369e-01 1 1  ON 11
 ud_2                 6.434604e-02 1 1  ON 12
 ud_3                -7.452472e-03 1 1  ON 13
 ud_4                -6.487535e-02 1 1  ON 14
 ud_5                -1.068860e-01 1 1  ON 15
 ud_6                -1.350132e-01 1 1  ON 16
 ud_7                -1.520288e-01 1 1  ON 17
 ud_8                -1.536697e-01 1 1  ON 18
 ud_9                -1.420562e-01 1 1  ON 19
 eO_0                -7.566802e-01 1 1  ON 20
 eO_1                -4.351695e-01 1 1  ON 21
 eO_2                -1.820666e-02 1 1  ON 22
 eO_3                 2.999625e-01 1 1  ON 23
 eO_4                 5.268330e-01 1 1  ON 24
 eO_5                 4.894791e-01 1 1  ON 25
 eO_6                 2.602078e-01 1 1  ON 26
 eO_7                -4.229210e-02 1 1  ON 27
 eO_8                -2.287165e-01 1 1  ON 28
 eO_9                -9.300890e-02 1 1  ON 29
eH1_0                -2.554897e-01 1 1  ON 30
eH1_1                -1.519644e-01 1 1  ON 31
eH1_2                -1.034613e-01 1 1  ON 32
eH1_3                -4.819050e-02 1 1  ON 33
eH1_4                 1.844494e-03 1 1  ON 34
eH1_5                 3.778762e-02 1 1  ON 35
eH1_6                 9.690606e-02 1 1  ON 36
eH1_7                 1.562019e-01 1 1  ON 37
eH1_8                 1.872064e-01 1 1  ON 38
eH1_9                 8.027117e-02 1 1  ON 39
eH2_0                -2.522637e-01 1 1  ON 40
eH2_1                -1.481293e-01 1 1  ON 41
eH2_2                -9.998632e-02 1 1  ON 42
eH2_3                -4.514442e-02 1 1  ON 43
eH2_4                 4.222818e-03 1 1  ON 44
eH2_5                 3.984012e-02 1 1  ON 45
eH2_6                 9.840560e-02 1 1  ON 46
eH2_7                 1.590464e-01 1 1  ON 47
eH2_8                 1.918325e-01 1 1  ON 48
eH2_9                 6.780906e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6509e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6861e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8625
    reference variance = 0.155704
====================================================
  Execution time = 2.0502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3667e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336627209690
                                         uncertainty =       0.002395007738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336627209690
                                         uncertainty =       0.002395007738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410287484
  error estimate for blocks of size 2^( 2) =       0.000423513880
  error estimate for blocks of size 2^( 3) =       0.000437631213
  error estimate for blocks of size 2^( 4) =       0.000450204882
  error estimate for blocks of size 2^( 5) =       0.000462056925
  error estimate for blocks of size 2^( 6) =       0.000471459596
  error estimate for blocks of size 2^( 7) =       0.000474871418

      target function =                  N/A
              le_mean =     -16.905539231815
             les_mean =     286.133928188844
             stat err =       0.000464648205
             autocorr =       1.282543164558
              std dev =       0.580234124089
             le_variance =       0.336671638757


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553923181e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905539231815       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905542583701       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905541788205       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905542949250       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905545261840       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905547212207       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905550147583       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905550227342       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905548686697       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905548363842       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905547849539       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905549094447       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905549324741       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905548857631       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.385021e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905539231815       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905541198336       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905540702035       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905540918118       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905542685706       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905543716213       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905544168650       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905544019112       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905543721395       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905543623527       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905543453355       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.085469e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905539231815       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905539972992       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905539799931       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905539812726       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905540493996       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905540719425       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905540747073       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905540719714       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905540720462       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.710834e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174024 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6135e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.118985e-01 1 1  ON 0
 uu_1                 1.447945e-01 1 1  ON 1
 uu_2                 4.286821e-02 1 1  ON 2
 uu_3                -2.006593e-02 1 1  ON 3
 uu_4                -6.609483e-02 1 1  ON 4
 uu_5                -1.020368e-01 1 1  ON 5
 uu_6                -1.301662e-01 1 1  ON 6
 uu_7                -1.447482e-01 1 1  ON 7
 uu_8                -1.378443e-01 1 1  ON 8
 uu_9                -1.085231e-01 1 1  ON 9
 ud_0                 4.511345e-01 1 1  ON 10
 ud_1                 1.849379e-01 1 1  ON 11
 ud_2                 6.411355e-02 1 1  ON 12
 ud_3                -7.512935e-03 1 1  ON 13
 ud_4                -6.511505e-02 1 1  ON 14
 ud_5                -1.069898e-01 1 1  ON 15
 ud_6                -1.350710e-01 1 1  ON 16
 ud_7                -1.519630e-01 1 1  ON 17
 ud_8                -1.531139e-01 1 1  ON 18
 ud_9                -1.416702e-01 1 1  ON 19
 eO_0                -7.565564e-01 1 1  ON 20
 eO_1                -4.349955e-01 1 1  ON 21
 eO_2                -1.831785e-02 1 1  ON 22
 eO_3                 2.999428e-01 1 1  ON 23
 eO_4                 5.267724e-01 1 1  ON 24
 eO_5                 4.897061e-01 1 1  ON 25
 eO_6                 2.601633e-01 1 1  ON 26
 eO_7                -4.209275e-02 1 1  ON 27
 eO_8                -2.287512e-01 1 1  ON 28
 eO_9                -9.341039e-02 1 1  ON 29
eH1_0                -2.559419e-01 1 1  ON 30
eH1_1                -1.519748e-01 1 1  ON 31
eH1_2                -1.036183e-01 1 1  ON 32
eH1_3                -4.823718e-02 1 1  ON 33
eH1_4                 1.512923e-03 1 1  ON 34
eH1_5                 3.738531e-02 1 1  ON 35
eH1_6                 9.660128e-02 1 1  ON 36
eH1_7                 1.560693e-01 1 1  ON 37
eH1_8                 1.876582e-01 1 1  ON 38
eH1_9                 8.135664e-02 1 1  ON 39
eH2_0                -2.527731e-01 1 1  ON 40
eH2_1                -1.486200e-01 1 1  ON 41
eH2_2                -1.002991e-01 1 1  ON 42
eH2_3                -4.515971e-02 1 1  ON 43
eH2_4                 4.170890e-03 1 1  ON 44
eH2_5                 3.962200e-02 1 1  ON 45
eH2_6                 9.884997e-02 1 1  ON 46
eH2_7                 1.592069e-01 1 1  ON 47
eH2_8                 1.920877e-01 1 1  ON 48
eH2_9                 6.850712e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8321
    reference variance = 0.171951
====================================================
  Execution time = 2.0240e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3614e-01
  Total weights = 2.0000e+06
  Execution time = 1.9002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335934396391
                                         uncertainty =       0.002924871425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335934396391
                                         uncertainty =       0.002924871425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409795047
  error estimate for blocks of size 2^( 2) =       0.000422686289
  error estimate for blocks of size 2^( 3) =       0.000436090352
  error estimate for blocks of size 2^( 4) =       0.000448785638
  error estimate for blocks of size 2^( 5) =       0.000460642843
  error estimate for blocks of size 2^( 6) =       0.000470253976
  error estimate for blocks of size 2^( 7) =       0.000476211992

      target function =                  N/A
              le_mean =     -16.906222779571
             les_mean =     286.156232465597
             stat err =       0.000463973612
             autocorr =       1.281897063713
              std dev =       0.579537713222
             le_variance =       0.335863961047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336332661496
                                         uncertainty =       0.002930609544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336332661496
                                         uncertainty =       0.002930609544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410037712
  error estimate for blocks of size 2^( 2) =       0.000422924107
  error estimate for blocks of size 2^( 3) =       0.000436327201
  error estimate for blocks of size 2^( 4) =       0.000449023625
  error estimate for blocks of size 2^( 5) =       0.000460874836
  error estimate for blocks of size 2^( 6) =       0.000470464953
  error estimate for blocks of size 2^( 7) =       0.000476414435

      target function =                  N/A
              le_mean =     -16.906223184747
             les_mean =     286.156644055358
             stat err =       0.000464194462
             autocorr =       1.281599432581
              std dev =       0.579880893801
             le_variance =       0.336261850996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486418608
                                         uncertainty =       0.002932012194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336486418608
                                         uncertainty =       0.002932012194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410131393
  error estimate for blocks of size 2^( 2) =       0.000423009682
  error estimate for blocks of size 2^( 3) =       0.000436405519
  error estimate for blocks of size 2^( 4) =       0.000449096377
  error estimate for blocks of size 2^( 5) =       0.000460944190
  error estimate for blocks of size 2^( 6) =       0.000470536719
  error estimate for blocks of size 2^( 7) =       0.000476492326

      target function =                  N/A
              le_mean =     -16.906223579344
             les_mean =     286.156811065286
             stat err =       0.000464267403
             autocorr =       1.281416638535
              std dev =       0.580013378067
             le_variance =       0.336415518736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336063155056
                                         uncertainty =       0.002926500526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336063155056
                                         uncertainty =       0.002926500526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409873531
  error estimate for blocks of size 2^( 2) =       0.000422760917
  error estimate for blocks of size 2^( 3) =       0.000436162132
  error estimate for blocks of size 2^( 4) =       0.000448855406
  error estimate for blocks of size 2^( 5) =       0.000460710049
  error estimate for blocks of size 2^( 6) =       0.000470317631
  error estimate for blocks of size 2^( 7) =       0.000476275363

      target function =                  N/A
              le_mean =     -16.906222418254
             les_mean =     286.156348909732
             stat err =       0.000464039612
             autocorr =       1.281770775286
              std dev =       0.579648705905
             le_variance =       0.335992622257


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906222779571        initial
     6.2500e-02     6.2500e-01             4.3850e-03       -16.906223184747
     2.5000e-01     2.5000e+00             1.0855e-03       -16.906223579344  <--
     1.0000e+00     1.0000e+01             2.7108e-04       -16.906222418254

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9801e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.118985e-01 1 1  ON 0
 uu_1                 1.447945e-01 1 1  ON 1
 uu_2                 4.286821e-02 1 1  ON 2
 uu_3                -2.006593e-02 1 1  ON 3
 uu_4                -6.609483e-02 1 1  ON 4
 uu_5                -1.020368e-01 1 1  ON 5
 uu_6                -1.301662e-01 1 1  ON 6
 uu_7                -1.447482e-01 1 1  ON 7
 uu_8                -1.378443e-01 1 1  ON 8
 uu_9                -1.085231e-01 1 1  ON 9
 ud_0                 4.511345e-01 1 1  ON 10
 ud_1                 1.849379e-01 1 1  ON 11
 ud_2                 6.411355e-02 1 1  ON 12
 ud_3                -7.512935e-03 1 1  ON 13
 ud_4                -6.511505e-02 1 1  ON 14
 ud_5                -1.069898e-01 1 1  ON 15
 ud_6                -1.350710e-01 1 1  ON 16
 ud_7                -1.519630e-01 1 1  ON 17
 ud_8                -1.531139e-01 1 1  ON 18
 ud_9                -1.416702e-01 1 1  ON 19
 eO_0                -7.565564e-01 1 1  ON 20
 eO_1                -4.349955e-01 1 1  ON 21
 eO_2                -1.831785e-02 1 1  ON 22
 eO_3                 2.999428e-01 1 1  ON 23
 eO_4                 5.267724e-01 1 1  ON 24
 eO_5                 4.897061e-01 1 1  ON 25
 eO_6                 2.601633e-01 1 1  ON 26
 eO_7                -4.209275e-02 1 1  ON 27
 eO_8                -2.287512e-01 1 1  ON 28
 eO_9                -9.341039e-02 1 1  ON 29
eH1_0                -2.559419e-01 1 1  ON 30
eH1_1                -1.519748e-01 1 1  ON 31
eH1_2                -1.036183e-01 1 1  ON 32
eH1_3                -4.823718e-02 1 1  ON 33
eH1_4                 1.512923e-03 1 1  ON 34
eH1_5                 3.738531e-02 1 1  ON 35
eH1_6                 9.660128e-02 1 1  ON 36
eH1_7                 1.560693e-01 1 1  ON 37
eH1_8                 1.876582e-01 1 1  ON 38
eH1_9                 8.135664e-02 1 1  ON 39
eH2_0                -2.527731e-01 1 1  ON 40
eH2_1                -1.486200e-01 1 1  ON 41
eH2_2                -1.002991e-01 1 1  ON 42
eH2_3                -4.515971e-02 1 1  ON 43
eH2_4                 4.170890e-03 1 1  ON 44
eH2_5                 3.962200e-02 1 1  ON 45
eH2_6                 9.884997e-02 1 1  ON 46
eH2_7                 1.592069e-01 1 1  ON 47
eH2_8                 1.920877e-01 1 1  ON 48
eH2_9                 6.850712e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6854e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8393
    reference variance = 0.469581
====================================================
  Execution time = 2.2771e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4117e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341068750853
                                         uncertainty =       0.003841499981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341068750853
                                         uncertainty =       0.003841499981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413019425
  error estimate for blocks of size 2^( 2) =       0.000425523775
  error estimate for blocks of size 2^( 3) =       0.000438569868
  error estimate for blocks of size 2^( 4) =       0.000450957456
  error estimate for blocks of size 2^( 5) =       0.000461662318
  error estimate for blocks of size 2^( 6) =       0.000469054552
  error estimate for blocks of size 2^( 7) =       0.000475281711

      target function =                  N/A
              le_mean =     -16.906047089094
             les_mean =     286.155598099609
             stat err =       0.000464239009
             autocorr =       1.263404166666
              std dev =       0.584097672942
             le_variance =       0.341170091536


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690604708909e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906047089094       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906048134940       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906044601360       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906042892910       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906045479730       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043740009       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906047871737       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906048469818       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906048205604       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906048440970       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906047637440       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906048502584       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906048495057       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.257147e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906047089094       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906047591195       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906045669232       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906044500510       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906045915085       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906045762968       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906046623755       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906046446028       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906046708328       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906046608197       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.192196e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906047089094       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906047252133       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906046543802       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906046103776       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906046657208       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906046594114       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906046468536       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906046639334       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.042488e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178229 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8352e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.119792e-01 1 1  ON 0
 uu_1                 1.447601e-01 1 1  ON 1
 uu_2                 4.285706e-02 1 1  ON 2
 uu_3                -2.000643e-02 1 1  ON 3
 uu_4                -6.610483e-02 1 1  ON 4
 uu_5                -1.017758e-01 1 1  ON 5
 uu_6                -1.302734e-01 1 1  ON 6
 uu_7                -1.449070e-01 1 1  ON 7
 uu_8                -1.380391e-01 1 1  ON 8
 uu_9                -1.089188e-01 1 1  ON 9
 ud_0                 4.510452e-01 1 1  ON 10
 ud_1                 1.850463e-01 1 1  ON 11
 ud_2                 6.421740e-02 1 1  ON 12
 ud_3                -7.343444e-03 1 1  ON 13
 ud_4                -6.490289e-02 1 1  ON 14
 ud_5                -1.068641e-01 1 1  ON 15
 ud_6                -1.346690e-01 1 1  ON 16
 ud_7                -1.521047e-01 1 1  ON 17
 ud_8                -1.534617e-01 1 1  ON 18
 ud_9                -1.418823e-01 1 1  ON 19
 eO_0                -7.564642e-01 1 1  ON 20
 eO_1                -4.347842e-01 1 1  ON 21
 eO_2                -1.834442e-02 1 1  ON 22
 eO_3                 2.999208e-01 1 1  ON 23
 eO_4                 5.268951e-01 1 1  ON 24
 eO_5                 4.899452e-01 1 1  ON 25
 eO_6                 2.608486e-01 1 1  ON 26
 eO_7                -4.212568e-02 1 1  ON 27
 eO_8                -2.293751e-01 1 1  ON 28
 eO_9                -9.393485e-02 1 1  ON 29
eH1_0                -2.565494e-01 1 1  ON 30
eH1_1                -1.521960e-01 1 1  ON 31
eH1_2                -1.036751e-01 1 1  ON 32
eH1_3                -4.838158e-02 1 1  ON 33
eH1_4                 1.399400e-03 1 1  ON 34
eH1_5                 3.710159e-02 1 1  ON 35
eH1_6                 9.698270e-02 1 1  ON 36
eH1_7                 1.563363e-01 1 1  ON 37
eH1_8                 1.879721e-01 1 1  ON 38
eH1_9                 8.179001e-02 1 1  ON 39
eH2_0                -2.531056e-01 1 1  ON 40
eH2_1                -1.489438e-01 1 1  ON 41
eH2_2                -1.006024e-01 1 1  ON 42
eH2_3                -4.529586e-02 1 1  ON 43
eH2_4                 3.902344e-03 1 1  ON 44
eH2_5                 3.951794e-02 1 1  ON 45
eH2_6                 9.883642e-02 1 1  ON 46
eH2_7                 1.591850e-01 1 1  ON 47
eH2_8                 1.926717e-01 1 1  ON 48
eH2_9                 6.932634e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.889
    reference variance = 0.267604
====================================================
  Execution time = 2.0086e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3672e-01
  Total weights = 2.0000e+06
  Execution time = 1.8845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336798276439
                                         uncertainty =       0.002505693669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336798276439
                                         uncertainty =       0.002505693669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410440479
  error estimate for blocks of size 2^( 2) =       0.000423444044
  error estimate for blocks of size 2^( 3) =       0.000436741659
  error estimate for blocks of size 2^( 4) =       0.000449628362
  error estimate for blocks of size 2^( 5) =       0.000461458037
  error estimate for blocks of size 2^( 6) =       0.000471908336
  error estimate for blocks of size 2^( 7) =       0.000477086819

      target function =                  N/A
              le_mean =     -16.905821916363
             les_mean =     286.143737272231
             stat err =       0.000465020389
             autocorr =       1.283641114645
              std dev =       0.580450491365
             le_variance =       0.336922772926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336496585217
                                         uncertainty =       0.002501290099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336496585217
                                         uncertainty =       0.002501290099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410256606
  error estimate for blocks of size 2^( 2) =       0.000423264167
  error estimate for blocks of size 2^( 3) =       0.000436567427
  error estimate for blocks of size 2^( 4) =       0.000449453550
  error estimate for blocks of size 2^( 5) =       0.000461290524
  error estimate for blocks of size 2^( 6) =       0.000471744192
  error estimate for blocks of size 2^( 7) =       0.000476922109

      target function =                  N/A
              le_mean =     -16.905821775989
             les_mean =     286.143430719005
             stat err =       0.000464852594
             autocorr =       1.283864975719
              std dev =       0.580190456491
             le_variance =       0.336620965803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336403268189
                                         uncertainty =       0.002500955829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336403268189
                                         uncertainty =       0.002500955829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410199730
  error estimate for blocks of size 2^( 2) =       0.000423210541
  error estimate for blocks of size 2^( 3) =       0.000436518564
  error estimate for blocks of size 2^( 4) =       0.000449407886
  error estimate for blocks of size 2^( 5) =       0.000461251419
  error estimate for blocks of size 2^( 6) =       0.000471709238
  error estimate for blocks of size 2^( 7) =       0.000476893537

      target function =                  N/A
              le_mean =     -16.905820839060
             les_mean =     286.143305710765
             stat err =       0.000464815520
             autocorr =       1.284016195201
              std dev =       0.580110021141
             le_variance =       0.336527636629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336710556098
                                         uncertainty =       0.002504685295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336710556098
                                         uncertainty =       0.002504685295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410387032
  error estimate for blocks of size 2^( 2) =       0.000423392222
  error estimate for blocks of size 2^( 3) =       0.000436692079
  error estimate for blocks of size 2^( 4) =       0.000449579417
  error estimate for blocks of size 2^( 5) =       0.000461412529
  error estimate for blocks of size 2^( 6) =       0.000471864570
  error estimate for blocks of size 2^( 7) =       0.000477044702

      target function =                  N/A
              le_mean =     -16.905821444185
             les_mean =     286.143633566085
             stat err =       0.000464975304
             autocorr =       1.283726532586
              std dev =       0.580374906288
             le_variance =       0.336835031848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905821916363        initial  <--
     6.2500e-02     6.2500e-01             3.2571e-03       -16.905821775989
     2.5000e-01     2.5000e+00             8.1922e-04       -16.905820839060
     1.0000e+00     1.0000e+01             2.0425e-04       -16.905821444185

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5870
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.118985e-01 1 1  ON 0
 uu_1                 1.447945e-01 1 1  ON 1
 uu_2                 4.286821e-02 1 1  ON 2
 uu_3                -2.006593e-02 1 1  ON 3
 uu_4                -6.609483e-02 1 1  ON 4
 uu_5                -1.020368e-01 1 1  ON 5
 uu_6                -1.301662e-01 1 1  ON 6
 uu_7                -1.447482e-01 1 1  ON 7
 uu_8                -1.378443e-01 1 1  ON 8
 uu_9                -1.085231e-01 1 1  ON 9
 ud_0                 4.511345e-01 1 1  ON 10
 ud_1                 1.849379e-01 1 1  ON 11
 ud_2                 6.411355e-02 1 1  ON 12
 ud_3                -7.512935e-03 1 1  ON 13
 ud_4                -6.511505e-02 1 1  ON 14
 ud_5                -1.069898e-01 1 1  ON 15
 ud_6                -1.350710e-01 1 1  ON 16
 ud_7                -1.519630e-01 1 1  ON 17
 ud_8                -1.531139e-01 1 1  ON 18
 ud_9                -1.416702e-01 1 1  ON 19
 eO_0                -7.565564e-01 1 1  ON 20
 eO_1                -4.349955e-01 1 1  ON 21
 eO_2                -1.831785e-02 1 1  ON 22
 eO_3                 2.999428e-01 1 1  ON 23
 eO_4                 5.267724e-01 1 1  ON 24
 eO_5                 4.897061e-01 1 1  ON 25
 eO_6                 2.601633e-01 1 1  ON 26
 eO_7                -4.209275e-02 1 1  ON 27
 eO_8                -2.287512e-01 1 1  ON 28
 eO_9                -9.341039e-02 1 1  ON 29
eH1_0                -2.559419e-01 1 1  ON 30
eH1_1                -1.519748e-01 1 1  ON 31
eH1_2                -1.036183e-01 1 1  ON 32
eH1_3                -4.823718e-02 1 1  ON 33
eH1_4                 1.512923e-03 1 1  ON 34
eH1_5                 3.738531e-02 1 1  ON 35
eH1_6                 9.660128e-02 1 1  ON 36
eH1_7                 1.560693e-01 1 1  ON 37
eH1_8                 1.876582e-01 1 1  ON 38
eH1_9                 8.135664e-02 1 1  ON 39
eH2_0                -2.527731e-01 1 1  ON 40
eH2_1                -1.486200e-01 1 1  ON 41
eH2_2                -1.002991e-01 1 1  ON 42
eH2_3                -4.515971e-02 1 1  ON 43
eH2_4                 4.170890e-03 1 1  ON 44
eH2_5                 3.962200e-02 1 1  ON 45
eH2_6                 9.884997e-02 1 1  ON 46
eH2_7                 1.592069e-01 1 1  ON 47
eH2_8                 1.920877e-01 1 1  ON 48
eH2_9                 6.850712e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7947e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6857e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8506
    reference variance = 0.41329
====================================================
  Execution time = 2.0558e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3849e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338446815752
                                         uncertainty =       0.004414890130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338446815752
                                         uncertainty =       0.004414890130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411393370
  error estimate for blocks of size 2^( 2) =       0.000423829164
  error estimate for blocks of size 2^( 3) =       0.000436831030
  error estimate for blocks of size 2^( 4) =       0.000448141676
  error estimate for blocks of size 2^( 5) =       0.000458689302
  error estimate for blocks of size 2^( 6) =       0.000467600736
  error estimate for blocks of size 2^( 7) =       0.000472741863

      target function =                  N/A
              le_mean =     -16.906581329439
             les_mean =     286.170981090092
             stat err =       0.000461793394
             autocorr =       1.260029911112
              std dev =       0.581798083875
             le_variance =       0.338489010401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658132944e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906581329439       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906581943284       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906582869183       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906582945472       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906583005775       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906582907608       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906582849612       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906582933253       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906583025315       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.189886e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906581329439       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906581523634       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906581797677       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906581823959       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906581844588       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906581834823       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906581816973       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906581832836       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 7.949881e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906581329439       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906581381438       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906581453436       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906581460781       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906581466666       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906581464243       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906581460607       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906581463462       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.997773e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181107 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6346e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.119532e-01 1 1  ON 0
 uu_1                 1.447812e-01 1 1  ON 1
 uu_2                 4.284100e-02 1 1  ON 2
 uu_3                -2.009508e-02 1 1  ON 3
 uu_4                -6.607154e-02 1 1  ON 4
 uu_5                -1.020161e-01 1 1  ON 5
 uu_6                -1.301676e-01 1 1  ON 6
 uu_7                -1.447531e-01 1 1  ON 7
 uu_8                -1.378717e-01 1 1  ON 8
 uu_9                -1.085598e-01 1 1  ON 9
 ud_0                 4.511237e-01 1 1  ON 10
 ud_1                 1.849878e-01 1 1  ON 11
 ud_2                 6.414281e-02 1 1  ON 12
 ud_3                -7.505519e-03 1 1  ON 13
 ud_4                -6.508804e-02 1 1  ON 14
 ud_5                -1.069795e-01 1 1  ON 15
 ud_6                -1.350596e-01 1 1  ON 16
 ud_7                -1.520117e-01 1 1  ON 17
 ud_8                -1.531493e-01 1 1  ON 18
 ud_9                -1.416928e-01 1 1  ON 19
 eO_0                -7.565516e-01 1 1  ON 20
 eO_1                -4.349710e-01 1 1  ON 21
 eO_2                -1.825861e-02 1 1  ON 22
 eO_3                 2.999157e-01 1 1  ON 23
 eO_4                 5.267890e-01 1 1  ON 24
 eO_5                 4.897133e-01 1 1  ON 25
 eO_6                 2.601901e-01 1 1  ON 26
 eO_7                -4.209176e-02 1 1  ON 27
 eO_8                -2.287999e-01 1 1  ON 28
 eO_9                -9.346556e-02 1 1  ON 29
eH1_0                -2.559945e-01 1 1  ON 30
eH1_1                -1.520022e-01 1 1  ON 31
eH1_2                -1.036110e-01 1 1  ON 32
eH1_3                -4.822257e-02 1 1  ON 33
eH1_4                 1.468336e-03 1 1  ON 34
eH1_5                 3.739126e-02 1 1  ON 35
eH1_6                 9.663019e-02 1 1  ON 36
eH1_7                 1.560723e-01 1 1  ON 37
eH1_8                 1.876629e-01 1 1  ON 38
eH1_9                 8.140798e-02 1 1  ON 39
eH2_0                -2.528307e-01 1 1  ON 40
eH2_1                -1.486673e-01 1 1  ON 41
eH2_2                -1.003296e-01 1 1  ON 42
eH2_3                -4.517421e-02 1 1  ON 43
eH2_4                 4.159154e-03 1 1  ON 44
eH2_5                 3.965512e-02 1 1  ON 45
eH2_6                 9.885864e-02 1 1  ON 46
eH2_7                 1.592141e-01 1 1  ON 47
eH2_8                 1.921163e-01 1 1  ON 48
eH2_9                 6.858662e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.886
    reference variance = 0.236387
====================================================
  Execution time = 2.0163e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4067e-01
  Total weights = 2.0000e+06
  Execution time = 1.8991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340789784659
                                         uncertainty =       0.005891133956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340789784659
                                         uncertainty =       0.005891133956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412730897
  error estimate for blocks of size 2^( 2) =       0.000425459299
  error estimate for blocks of size 2^( 3) =       0.000438180916
  error estimate for blocks of size 2^( 4) =       0.000450495425
  error estimate for blocks of size 2^( 5) =       0.000461142340
  error estimate for blocks of size 2^( 6) =       0.000466832227
  error estimate for blocks of size 2^( 7) =       0.000470963074

      target function =                  N/A
              le_mean =     -16.906555359532
             les_mean =     286.172307540871
             stat err =       0.000462358267
             autocorr =       1.254940951803
              std dev =       0.583689631821
             le_variance =       0.340693586295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340765195678
                                         uncertainty =       0.005890056347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340765195678
                                         uncertainty =       0.005890056347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412716033
  error estimate for blocks of size 2^( 2) =       0.000425443544
  error estimate for blocks of size 2^( 3) =       0.000438162000
  error estimate for blocks of size 2^( 4) =       0.000450474930
  error estimate for blocks of size 2^( 5) =       0.000461120561
  error estimate for blocks of size 2^( 6) =       0.000466812252
  error estimate for blocks of size 2^( 7) =       0.000470938664

      target function =                  N/A
              le_mean =     -16.906553586560
             les_mean =     286.172223052533
             stat err =       0.000462336602
             autocorr =       1.254913734403
              std dev =       0.583668611143
             le_variance =       0.340669047633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340748010840
                                         uncertainty =       0.005889770272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340748010840
                                         uncertainty =       0.005889770272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412705622
  error estimate for blocks of size 2^( 2) =       0.000425434288
  error estimate for blocks of size 2^( 3) =       0.000438154602
  error estimate for blocks of size 2^( 4) =       0.000450468702
  error estimate for blocks of size 2^( 5) =       0.000461115176
  error estimate for blocks of size 2^( 6) =       0.000466806705
  error estimate for blocks of size 2^( 7) =       0.000470934447

      target function =                  N/A
              le_mean =     -16.906554214749
             les_mean =     286.172227107085
             stat err =       0.000462331258
             autocorr =       1.254948033944
              std dev =       0.583653888172
             le_variance =       0.340651861179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340782907676
                                         uncertainty =       0.005890923592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340782907676
                                         uncertainty =       0.005890923592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412726735
  error estimate for blocks of size 2^( 2) =       0.000425455210
  error estimate for blocks of size 2^( 3) =       0.000438176679
  error estimate for blocks of size 2^( 4) =       0.000450491157
  error estimate for blocks of size 2^( 5) =       0.000461138029
  error estimate for blocks of size 2^( 6) =       0.000466828157
  error estimate for blocks of size 2^( 7) =       0.000470958579

      target function =                  N/A
              le_mean =     -16.906555191787
             les_mean =     286.172294998961
             stat err =       0.000462353981
             autocorr =       1.254942991362
              std dev =       0.583683746866
             le_variance =       0.340686716356


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906555359532        initial  <--
     6.2500e-01     6.2500e+00             3.1899e-04       -16.906553586560
     2.5000e+00     2.5000e+01             7.9499e-05       -16.906554214749
     1.0000e+01     1.0000e+02             1.9978e-05       -16.906555191787

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7140
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.118985e-01 1 1  ON 0
 uu_1                 1.447945e-01 1 1  ON 1
 uu_2                 4.286821e-02 1 1  ON 2
 uu_3                -2.006593e-02 1 1  ON 3
 uu_4                -6.609483e-02 1 1  ON 4
 uu_5                -1.020368e-01 1 1  ON 5
 uu_6                -1.301662e-01 1 1  ON 6
 uu_7                -1.447482e-01 1 1  ON 7
 uu_8                -1.378443e-01 1 1  ON 8
 uu_9                -1.085231e-01 1 1  ON 9
 ud_0                 4.511345e-01 1 1  ON 10
 ud_1                 1.849379e-01 1 1  ON 11
 ud_2                 6.411355e-02 1 1  ON 12
 ud_3                -7.512935e-03 1 1  ON 13
 ud_4                -6.511505e-02 1 1  ON 14
 ud_5                -1.069898e-01 1 1  ON 15
 ud_6                -1.350710e-01 1 1  ON 16
 ud_7                -1.519630e-01 1 1  ON 17
 ud_8                -1.531139e-01 1 1  ON 18
 ud_9                -1.416702e-01 1 1  ON 19
 eO_0                -7.565564e-01 1 1  ON 20
 eO_1                -4.349955e-01 1 1  ON 21
 eO_2                -1.831785e-02 1 1  ON 22
 eO_3                 2.999428e-01 1 1  ON 23
 eO_4                 5.267724e-01 1 1  ON 24
 eO_5                 4.897061e-01 1 1  ON 25
 eO_6                 2.601633e-01 1 1  ON 26
 eO_7                -4.209275e-02 1 1  ON 27
 eO_8                -2.287512e-01 1 1  ON 28
 eO_9                -9.341039e-02 1 1  ON 29
eH1_0                -2.559419e-01 1 1  ON 30
eH1_1                -1.519748e-01 1 1  ON 31
eH1_2                -1.036183e-01 1 1  ON 32
eH1_3                -4.823718e-02 1 1  ON 33
eH1_4                 1.512923e-03 1 1  ON 34
eH1_5                 3.738531e-02 1 1  ON 35
eH1_6                 9.660128e-02 1 1  ON 36
eH1_7                 1.560693e-01 1 1  ON 37
eH1_8                 1.876582e-01 1 1  ON 38
eH1_9                 8.135664e-02 1 1  ON 39
eH2_0                -2.527731e-01 1 1  ON 40
eH2_1                -1.486200e-01 1 1  ON 41
eH2_2                -1.002991e-01 1 1  ON 42
eH2_3                -4.515971e-02 1 1  ON 43
eH2_4                 4.170890e-03 1 1  ON 44
eH2_5                 3.962200e-02 1 1  ON 45
eH2_6                 9.884997e-02 1 1  ON 46
eH2_7                 1.592069e-01 1 1  ON 47
eH2_8                 1.920877e-01 1 1  ON 48
eH2_9                 6.850712e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6067e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6860e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8714
    reference variance = 0.176416
====================================================
  Execution time = 2.0467e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3790e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860368293
                                         uncertainty =       0.004090636315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860368293
                                         uncertainty =       0.004090636315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411033292
  error estimate for blocks of size 2^( 2) =       0.000423775978
  error estimate for blocks of size 2^( 3) =       0.000436271555
  error estimate for blocks of size 2^( 4) =       0.000447891534
  error estimate for blocks of size 2^( 5) =       0.000459804737
  error estimate for blocks of size 2^( 6) =       0.000469210271
  error estimate for blocks of size 2^( 7) =       0.000474053132

      target function =                  N/A
              le_mean =     -16.906303189344
             les_mean =     286.160984094591
             stat err =       0.000462739919
             autocorr =       1.267418184278
              std dev =       0.581288855488
             le_variance =       0.337896733514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630318934e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906303189344       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906303203619       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906303133434       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906303109033       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906303117741       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906303113416       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906303150975       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906303162345       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.544533e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906303189344       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906303192981       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906303174797       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906303168761       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906303170946       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906303169041       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906303178271       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906303181460       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.866415e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906303189344       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906303190258       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906303185670       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906303184165       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906303184712       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906303184184       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906303186478       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906303187296       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.216991e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183828 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6104e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.119014e-01 1 1  ON 0
 uu_1                 1.447898e-01 1 1  ON 1
 uu_2                 4.286347e-02 1 1  ON 2
 uu_3                -2.006537e-02 1 1  ON 3
 uu_4                -6.610036e-02 1 1  ON 4
 uu_5                -1.020308e-01 1 1  ON 5
 uu_6                -1.301657e-01 1 1  ON 6
 uu_7                -1.447469e-01 1 1  ON 7
 uu_8                -1.378447e-01 1 1  ON 8
 uu_9                -1.085248e-01 1 1  ON 9
 ud_0                 4.511309e-01 1 1  ON 10
 ud_1                 1.849393e-01 1 1  ON 11
 ud_2                 6.411787e-02 1 1  ON 12
 ud_3                -7.509119e-03 1 1  ON 13
 ud_4                -6.511400e-02 1 1  ON 14
 ud_5                -1.069905e-01 1 1  ON 15
 ud_6                -1.350689e-01 1 1  ON 16
 ud_7                -1.519666e-01 1 1  ON 17
 ud_8                -1.531158e-01 1 1  ON 18
 ud_9                -1.416739e-01 1 1  ON 19
 eO_0                -7.565540e-01 1 1  ON 20
 eO_1                -4.349936e-01 1 1  ON 21
 eO_2                -1.831865e-02 1 1  ON 22
 eO_3                 2.999433e-01 1 1  ON 23
 eO_4                 5.267727e-01 1 1  ON 24
 eO_5                 4.897087e-01 1 1  ON 25
 eO_6                 2.601656e-01 1 1  ON 26
 eO_7                -4.209184e-02 1 1  ON 27
 eO_8                -2.287556e-01 1 1  ON 28
 eO_9                -9.341517e-02 1 1  ON 29
eH1_0                -2.559491e-01 1 1  ON 30
eH1_1                -1.519765e-01 1 1  ON 31
eH1_2                -1.036152e-01 1 1  ON 32
eH1_3                -4.824505e-02 1 1  ON 33
eH1_4                 1.507486e-03 1 1  ON 34
eH1_5                 3.738371e-02 1 1  ON 35
eH1_6                 9.660603e-02 1 1  ON 36
eH1_7                 1.560742e-01 1 1  ON 37
eH1_8                 1.876629e-01 1 1  ON 38
eH1_9                 8.136218e-02 1 1  ON 39
eH2_0                -2.527749e-01 1 1  ON 40
eH2_1                -1.486208e-01 1 1  ON 41
eH2_2                -1.003020e-01 1 1  ON 42
eH2_3                -4.516549e-02 1 1  ON 43
eH2_4                 4.166465e-03 1 1  ON 44
eH2_5                 3.962091e-02 1 1  ON 45
eH2_6                 9.884903e-02 1 1  ON 46
eH2_7                 1.592076e-01 1 1  ON 47
eH2_8                 1.920947e-01 1 1  ON 48
eH2_9                 6.851599e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9049
    reference variance = 0.184248
====================================================
  Execution time = 2.0182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3552e-01
  Total weights = 2.0000e+06
  Execution time = 1.8960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335516101188
                                         uncertainty =       0.002972336878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335516101188
                                         uncertainty =       0.002972336878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409588278
  error estimate for blocks of size 2^( 2) =       0.000422391531
  error estimate for blocks of size 2^( 3) =       0.000435672780
  error estimate for blocks of size 2^( 4) =       0.000448036478
  error estimate for blocks of size 2^( 5) =       0.000457946675
  error estimate for blocks of size 2^( 6) =       0.000464863053
  error estimate for blocks of size 2^( 7) =       0.000470894063

      target function =                  N/A
              le_mean =     -16.906731820844
             les_mean =     286.173105808813
             stat err =       0.000460435067
             autocorr =       1.263693487662
              std dev =       0.579245297459
             le_variance =       0.335525114629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335493923962
                                         uncertainty =       0.002972118282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335493923962
                                         uncertainty =       0.002972118282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409574742
  error estimate for blocks of size 2^( 2) =       0.000422378805
  error estimate for blocks of size 2^( 3) =       0.000435661384
  error estimate for blocks of size 2^( 4) =       0.000448025918
  error estimate for blocks of size 2^( 5) =       0.000457936981
  error estimate for blocks of size 2^( 6) =       0.000464853733
  error estimate for blocks of size 2^( 7) =       0.000470884529

      target function =                  N/A
              le_mean =     -16.906731902937
             les_mean =     286.173086408322
             stat err =       0.000460425290
             autocorr =       1.263723344978
              std dev =       0.579226154699
             le_variance =       0.335502938288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335504551845
                                         uncertainty =       0.002972222200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335504551845
                                         uncertainty =       0.002972222200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409581229
  error estimate for blocks of size 2^( 2) =       0.000422384902
  error estimate for blocks of size 2^( 3) =       0.000435666842
  error estimate for blocks of size 2^( 4) =       0.000448030974
  error estimate for blocks of size 2^( 5) =       0.000457941626
  error estimate for blocks of size 2^( 6) =       0.000464858200
  error estimate for blocks of size 2^( 7) =       0.000470889104

      target function =                  N/A
              le_mean =     -16.906731860534
             les_mean =     286.173095601980
             stat err =       0.000460429976
             autocorr =       1.263709039533
              std dev =       0.579235328462
             le_variance =       0.335513565739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335514642117
                                         uncertainty =       0.002972322367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335514642117
                                         uncertainty =       0.002972322367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409587387
  error estimate for blocks of size 2^( 2) =       0.000422390693
  error estimate for blocks of size 2^( 3) =       0.000435672030
  error estimate for blocks of size 2^( 4) =       0.000448035782
  error estimate for blocks of size 2^( 5) =       0.000457946037
  error estimate for blocks of size 2^( 6) =       0.000464862439
  error estimate for blocks of size 2^( 7) =       0.000470893437

      target function =                  N/A
              le_mean =     -16.906731825672
             les_mean =     286.173104513034
             stat err =       0.000460434424
             autocorr =       1.263695451858
              std dev =       0.579244038049
             le_variance =       0.335523655615


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906731820844        initial
     6.2500e+00     6.2500e+01             3.5445e-05       -16.906731902937  <--
     2.5000e+01     2.5000e+02             8.8664e-06       -16.906731860534
     1.0000e+02     1.0000e+03             2.2170e-06       -16.906731825672

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9728e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.119092e-01 1 1  ON 0
 uu_1                 1.447760e-01 1 1  ON 1
 uu_2                 4.285002e-02 1 1  ON 2
 uu_3                -2.006433e-02 1 1  ON 3
 uu_4                -6.611574e-02 1 1  ON 4
 uu_5                -1.020138e-01 1 1  ON 5
 uu_6                -1.301643e-01 1 1  ON 6
 uu_7                -1.447431e-01 1 1  ON 7
 uu_8                -1.378460e-01 1 1  ON 8
 uu_9                -1.085298e-01 1 1  ON 9
 ud_0                 4.511209e-01 1 1  ON 10
 ud_1                 1.849435e-01 1 1  ON 11
 ud_2                 6.413019e-02 1 1  ON 12
 ud_3                -7.497916e-03 1 1  ON 13
 ud_4                -6.511076e-02 1 1  ON 14
 ud_5                -1.069924e-01 1 1  ON 15
 ud_6                -1.350627e-01 1 1  ON 16
 ud_7                -1.519771e-01 1 1  ON 17
 ud_8                -1.531217e-01 1 1  ON 18
 ud_9                -1.416847e-01 1 1  ON 19
 eO_0                -7.565473e-01 1 1  ON 20
 eO_1                -4.349876e-01 1 1  ON 21
 eO_2                -1.832072e-02 1 1  ON 22
 eO_3                 2.999449e-01 1 1  ON 23
 eO_4                 5.267734e-01 1 1  ON 24
 eO_5                 4.897166e-01 1 1  ON 25
 eO_6                 2.601724e-01 1 1  ON 26
 eO_7                -4.208910e-02 1 1  ON 27
 eO_8                -2.287689e-01 1 1  ON 28
 eO_9                -9.342952e-02 1 1  ON 29
eH1_0                -2.559703e-01 1 1  ON 30
eH1_1                -1.519814e-01 1 1  ON 31
eH1_2                -1.036066e-01 1 1  ON 32
eH1_3                -4.826800e-02 1 1  ON 33
eH1_4                 1.491072e-03 1 1  ON 34
eH1_5                 3.737887e-02 1 1  ON 35
eH1_6                 9.662027e-02 1 1  ON 36
eH1_7                 1.560890e-01 1 1  ON 37
eH1_8                 1.876769e-01 1 1  ON 38
eH1_9                 8.137881e-02 1 1  ON 39
eH2_0                -2.527801e-01 1 1  ON 40
eH2_1                -1.486234e-01 1 1  ON 41
eH2_2                -1.003110e-01 1 1  ON 42
eH2_3                -4.518249e-02 1 1  ON 43
eH2_4                 4.153165e-03 1 1  ON 44
eH2_5                 3.961764e-02 1 1  ON 45
eH2_6                 9.884620e-02 1 1  ON 46
eH2_7                 1.592097e-01 1 1  ON 47
eH2_8                 1.921158e-01 1 1  ON 48
eH2_9                 6.854257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5848e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6866e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.88
    reference variance = 0.305668
====================================================
  Execution time = 2.0377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4217e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5510e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342203468712
                                         uncertainty =       0.005053388346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342203468712
                                         uncertainty =       0.005053388346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413627025
  error estimate for blocks of size 2^( 2) =       0.000426492408
  error estimate for blocks of size 2^( 3) =       0.000439870891
  error estimate for blocks of size 2^( 4) =       0.000453202133
  error estimate for blocks of size 2^( 5) =       0.000465115582
  error estimate for blocks of size 2^( 6) =       0.000476105788
  error estimate for blocks of size 2^( 7) =       0.000483495192

      target function =                  N/A
              le_mean =     -16.905933892008
             les_mean =     286.152775221750
             stat err =       0.000469479674
             autocorr =       1.288296347247
              std dev =       0.584956948751
             le_variance =       0.342174631892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593389201e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933892008       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905934128317       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905934159344       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905934414857       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905934708889       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905934756290       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905934787844       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905934753781       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.472852e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933892008       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933955861       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933965866       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905934034341       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905934112993       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905934118794       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905934122104       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905934118158       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.708923e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933892008       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933908300       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933910981       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933928448       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933948434       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933949422       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933949854       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905933949110       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 9.289409e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5940e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.119078e-01 1 1  ON 0
 uu_1                 1.447740e-01 1 1  ON 1
 uu_2                 4.284486e-02 1 1  ON 2
 uu_3                -2.006973e-02 1 1  ON 3
 uu_4                -6.614720e-02 1 1  ON 4
 uu_5                -1.019978e-01 1 1  ON 5
 uu_6                -1.301682e-01 1 1  ON 6
 uu_7                -1.447508e-01 1 1  ON 7
 uu_8                -1.378456e-01 1 1  ON 8
 uu_9                -1.085222e-01 1 1  ON 9
 ud_0                 4.511141e-01 1 1  ON 10
 ud_1                 1.849362e-01 1 1  ON 11
 ud_2                 6.413196e-02 1 1  ON 12
 ud_3                -7.497681e-03 1 1  ON 13
 ud_4                -6.510300e-02 1 1  ON 14
 ud_5                -1.069974e-01 1 1  ON 15
 ud_6                -1.350834e-01 1 1  ON 16
 ud_7                -1.519687e-01 1 1  ON 17
 ud_8                -1.531038e-01 1 1  ON 18
 ud_9                -1.416817e-01 1 1  ON 19
 eO_0                -7.565348e-01 1 1  ON 20
 eO_1                -4.349885e-01 1 1  ON 21
 eO_2                -1.831805e-02 1 1  ON 22
 eO_3                 2.999286e-01 1 1  ON 23
 eO_4                 5.267790e-01 1 1  ON 24
 eO_5                 4.897311e-01 1 1  ON 25
 eO_6                 2.601770e-01 1 1  ON 26
 eO_7                -4.208533e-02 1 1  ON 27
 eO_8                -2.287770e-01 1 1  ON 28
 eO_9                -9.344699e-02 1 1  ON 29
eH1_0                -2.559903e-01 1 1  ON 30
eH1_1                -1.520051e-01 1 1  ON 31
eH1_2                -1.036105e-01 1 1  ON 32
eH1_3                -4.827814e-02 1 1  ON 33
eH1_4                 1.479344e-03 1 1  ON 34
eH1_5                 3.737232e-02 1 1  ON 35
eH1_6                 9.662998e-02 1 1  ON 36
eH1_7                 1.560855e-01 1 1  ON 37
eH1_8                 1.877014e-01 1 1  ON 38
eH1_9                 8.141590e-02 1 1  ON 39
eH2_0                -2.528051e-01 1 1  ON 40
eH2_1                -1.486557e-01 1 1  ON 41
eH2_2                -1.003099e-01 1 1  ON 42
eH2_3                -4.517471e-02 1 1  ON 43
eH2_4                 4.140626e-03 1 1  ON 44
eH2_5                 3.961099e-02 1 1  ON 45
eH2_6                 9.884974e-02 1 1  ON 46
eH2_7                 1.592217e-01 1 1  ON 47
eH2_8                 1.921293e-01 1 1  ON 48
eH2_9                 6.857373e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8664
    reference variance = 0.275965
====================================================
  Execution time = 2.0170e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3934e-01
  Total weights = 2.0000e+06
  Execution time = 1.8951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339450978279
                                         uncertainty =       0.003381901390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339450978279
                                         uncertainty =       0.003381901390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411915195
  error estimate for blocks of size 2^( 2) =       0.000424812021
  error estimate for blocks of size 2^( 3) =       0.000437208162
  error estimate for blocks of size 2^( 4) =       0.000448266213
  error estimate for blocks of size 2^( 5) =       0.000458989933
  error estimate for blocks of size 2^( 6) =       0.000466502648
  error estimate for blocks of size 2^( 7) =       0.000470950053

      target function =                  N/A
              le_mean =     -16.906530747242
             les_mean =     286.170129992994
             stat err =       0.000461177212
             autocorr =       1.253487633335
              std dev =       0.582536054884
             le_variance =       0.339348255240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339421023188
                                         uncertainty =       0.003381737677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339421023188
                                         uncertainty =       0.003381737677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411897016
  error estimate for blocks of size 2^( 2) =       0.000424794590
  error estimate for blocks of size 2^( 3) =       0.000437191393
  error estimate for blocks of size 2^( 4) =       0.000448250456
  error estimate for blocks of size 2^( 5) =       0.000458974484
  error estimate for blocks of size 2^( 6) =       0.000466485550
  error estimate for blocks of size 2^( 7) =       0.000470934448

      target function =                  N/A
              le_mean =     -16.906531337382
             les_mean =     286.170119995177
             stat err =       0.000461161234
             autocorr =       1.253511420429
              std dev =       0.582510345789
             le_variance =       0.339318302952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339435360862
                                         uncertainty =       0.003381823467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339435360862
                                         uncertainty =       0.003381823467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411905716
  error estimate for blocks of size 2^( 2) =       0.000424802919
  error estimate for blocks of size 2^( 3) =       0.000437199412
  error estimate for blocks of size 2^( 4) =       0.000448258022
  error estimate for blocks of size 2^( 5) =       0.000458981921
  error estimate for blocks of size 2^( 6) =       0.000466493713
  error estimate for blocks of size 2^( 7) =       0.000470942036

      target function =                  N/A
              le_mean =     -16.906531054077
             les_mean =     286.170124751052
             stat err =       0.000461168923
             autocorr =       1.253500261749
              std dev =       0.582522650416
             le_variance =       0.339332638248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339448999500
                                         uncertainty =       0.003381891820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339448999500
                                         uncertainty =       0.003381891820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411913994
  error estimate for blocks of size 2^( 2) =       0.000424810866
  error estimate for blocks of size 2^( 3) =       0.000437207053
  error estimate for blocks of size 2^( 4) =       0.000448265176
  error estimate for blocks of size 2^( 5) =       0.000458988919
  error estimate for blocks of size 2^( 6) =       0.000466501515
  error estimate for blocks of size 2^( 7) =       0.000470949041

      target function =                  N/A
              le_mean =     -16.906530784598
             les_mean =     286.170129277349
             stat err =       0.000461176163
             autocorr =       1.253489239501
              std dev =       0.582534356463
             le_variance =       0.339346276460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906530747242        initial
     1.5625e+00     1.5625e+01             1.4729e-04       -16.906531337382  <--
     6.2500e+00     6.2500e+01             3.7089e-05       -16.906531054077
     2.5000e+01     2.5000e+02             9.2894e-06       -16.906530784598

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.9694e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.119013e-01 1 1  ON 0
 uu_1                 1.447659e-01 1 1  ON 1
 uu_2                 4.283049e-02 1 1  ON 2
 uu_3                -2.008878e-02 1 1  ON 3
 uu_4                -6.622505e-02 1 1  ON 4
 uu_5                -1.019634e-01 1 1  ON 5
 uu_6                -1.301784e-01 1 1  ON 6
 uu_7                -1.447718e-01 1 1  ON 7
 uu_8                -1.378446e-01 1 1  ON 8
 uu_9                -1.084995e-01 1 1  ON 9
 ud_0                 4.510932e-01 1 1  ON 10
 ud_1                 1.849191e-01 1 1  ON 11
 ud_2                 6.413360e-02 1 1  ON 12
 ud_3                -7.494995e-03 1 1  ON 13
 ud_4                -6.508568e-02 1 1  ON 14
 ud_5                -1.070098e-01 1 1  ON 15
 ud_6                -1.351408e-01 1 1  ON 16
 ud_7                -1.519471e-01 1 1  ON 17
 ud_8                -1.530513e-01 1 1  ON 18
 ud_9                -1.416718e-01 1 1  ON 19
 eO_0                -7.565021e-01 1 1  ON 20
 eO_1                -4.349879e-01 1 1  ON 21
 eO_2                -1.831010e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267943e-01 1 1  ON 24
 eO_5                 4.897745e-01 1 1  ON 25
 eO_6                 2.601911e-01 1 1  ON 26
 eO_7                -4.207429e-02 1 1  ON 27
 eO_8                -2.288009e-01 1 1  ON 28
 eO_9                -9.349874e-02 1 1  ON 29
eH1_0                -2.560504e-01 1 1  ON 30
eH1_1                -1.520710e-01 1 1  ON 31
eH1_2                -1.036256e-01 1 1  ON 32
eH1_3                -4.830926e-02 1 1  ON 33
eH1_4                 1.444830e-03 1 1  ON 34
eH1_5                 3.735261e-02 1 1  ON 35
eH1_6                 9.665897e-02 1 1  ON 36
eH1_7                 1.560757e-01 1 1  ON 37
eH1_8                 1.877746e-01 1 1  ON 38
eH1_9                 8.152609e-02 1 1  ON 39
eH2_0                -2.528804e-01 1 1  ON 40
eH2_1                -1.487429e-01 1 1  ON 41
eH2_2                -1.003108e-01 1 1  ON 42
eH2_3                -4.515639e-02 1 1  ON 43
eH2_4                 4.106811e-03 1 1  ON 44
eH2_5                 3.958954e-02 1 1  ON 45
eH2_6                 9.885954e-02 1 1  ON 46
eH2_7                 1.592575e-01 1 1  ON 47
eH2_8                 1.921696e-01 1 1  ON 48
eH2_9                 6.866634e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5649e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6867e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8816
    reference variance = 0.211848
====================================================
  Execution time = 2.0824e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4831e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348307976574
                                         uncertainty =       0.012939385939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348307976574
                                         uncertainty =       0.012939385939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417319471
  error estimate for blocks of size 2^( 2) =       0.000430165777
  error estimate for blocks of size 2^( 3) =       0.000442898053
  error estimate for blocks of size 2^( 4) =       0.000455194366
  error estimate for blocks of size 2^( 5) =       0.000465781823
  error estimate for blocks of size 2^( 6) =       0.000472155721
  error estimate for blocks of size 2^( 7) =       0.000477529932

      target function =                  N/A
              le_mean =     -16.905396936704
             les_mean =     286.140756494737
             stat err =       0.000467665461
             autocorr =       1.255837065244
              std dev =       0.590178855404
             le_variance =       0.348311081366


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690539693670e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905396936704       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905397472962       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905398073759       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905398837563       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905398950834       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905398986361       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905399472778       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905399280242       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905399322234       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 6.135956e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905396936704       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905397102239       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905397316205       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905397609001       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905397642026       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905397609512       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905397715169       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905397668101       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.532420e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905396936704       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905396980668       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905397042517       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905397125684       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905397133682       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905397123035       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905397145256       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905397134574       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.860001e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6409e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.119019e-01 1 1  ON 0
 uu_1                 1.447201e-01 1 1  ON 1
 uu_2                 4.279657e-02 1 1  ON 2
 uu_3                -2.013487e-02 1 1  ON 3
 uu_4                -6.626473e-02 1 1  ON 4
 uu_5                -1.019154e-01 1 1  ON 5
 uu_6                -1.302091e-01 1 1  ON 6
 uu_7                -1.448146e-01 1 1  ON 7
 uu_8                -1.378114e-01 1 1  ON 8
 uu_9                -1.084750e-01 1 1  ON 9
 ud_0                 4.511056e-01 1 1  ON 10
 ud_1                 1.848942e-01 1 1  ON 11
 ud_2                 6.413563e-02 1 1  ON 12
 ud_3                -7.530366e-03 1 1  ON 13
 ud_4                -6.511023e-02 1 1  ON 14
 ud_5                -1.070156e-01 1 1  ON 15
 ud_6                -1.351710e-01 1 1  ON 16
 ud_7                -1.519372e-01 1 1  ON 17
 ud_8                -1.530090e-01 1 1  ON 18
 ud_9                -1.416260e-01 1 1  ON 19
 eO_0                -7.565090e-01 1 1  ON 20
 eO_1                -4.350004e-01 1 1  ON 21
 eO_2                -1.830588e-02 1 1  ON 22
 eO_3                 2.999214e-01 1 1  ON 23
 eO_4                 5.267432e-01 1 1  ON 24
 eO_5                 4.898600e-01 1 1  ON 25
 eO_6                 2.602227e-01 1 1  ON 26
 eO_7                -4.205222e-02 1 1  ON 27
 eO_8                -2.288403e-01 1 1  ON 28
 eO_9                -9.356285e-02 1 1  ON 29
eH1_0                -2.561048e-01 1 1  ON 30
eH1_1                -1.521368e-01 1 1  ON 31
eH1_2                -1.036257e-01 1 1  ON 32
eH1_3                -4.831130e-02 1 1  ON 33
eH1_4                 1.361972e-03 1 1  ON 34
eH1_5                 3.731042e-02 1 1  ON 35
eH1_6                 9.669218e-02 1 1  ON 36
eH1_7                 1.560642e-01 1 1  ON 37
eH1_8                 1.878567e-01 1 1  ON 38
eH1_9                 8.165943e-02 1 1  ON 39
eH2_0                -2.529334e-01 1 1  ON 40
eH2_1                -1.487527e-01 1 1  ON 41
eH2_2                -1.003467e-01 1 1  ON 42
eH2_3                -4.524283e-02 1 1  ON 43
eH2_4                 4.053737e-03 1 1  ON 44
eH2_5                 3.957722e-02 1 1  ON 45
eH2_6                 9.888171e-02 1 1  ON 46
eH2_7                 1.592304e-01 1 1  ON 47
eH2_8                 1.922538e-01 1 1  ON 48
eH2_9                 6.881958e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9133
    reference variance = 0.226552
====================================================
  Execution time = 2.0498e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4179e-01
  Total weights = 2.0000e+06
  Execution time = 1.8928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341820674468
                                         uncertainty =       0.005983525811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341820674468
                                         uncertainty =       0.005983525811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413385534
  error estimate for blocks of size 2^( 2) =       0.000426437181
  error estimate for blocks of size 2^( 3) =       0.000439362453
  error estimate for blocks of size 2^( 4) =       0.000451716394
  error estimate for blocks of size 2^( 5) =       0.000462465566
  error estimate for blocks of size 2^( 6) =       0.000469557443
  error estimate for blocks of size 2^( 7) =       0.000474713733

      target function =                  N/A
              le_mean =     -16.905839313943
             les_mean =     286.149177937848
             stat err =       0.000464613284
             autocorr =       1.263201682901
              std dev =       0.584615429056
             le_variance =       0.341775199891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341849710074
                                         uncertainty =       0.005977911171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341849710074
                                         uncertainty =       0.005977911171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413403118
  error estimate for blocks of size 2^( 2) =       0.000426456086
  error estimate for blocks of size 2^( 3) =       0.000439382759
  error estimate for blocks of size 2^( 4) =       0.000451736739
  error estimate for blocks of size 2^( 5) =       0.000462482633
  error estimate for blocks of size 2^( 6) =       0.000469569261
  error estimate for blocks of size 2^( 7) =       0.000474719465

      target function =                  N/A
              le_mean =     -16.905838825342
             les_mean =     286.149190494009
             stat err =       0.000464627025
             autocorr =       1.263168935868
              std dev =       0.584640296649
             le_variance =       0.341804276466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341851164256
                                         uncertainty =       0.005978963164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341851164256
                                         uncertainty =       0.005978963164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413403994
  error estimate for blocks of size 2^( 2) =       0.000426456161
  error estimate for blocks of size 2^( 3) =       0.000439381783
  error estimate for blocks of size 2^( 4) =       0.000451735425
  error estimate for blocks of size 2^( 5) =       0.000462482127
  error estimate for blocks of size 2^( 6) =       0.000469570167
  error estimate for blocks of size 2^( 7) =       0.000474722543

      target function =                  N/A
              le_mean =     -16.905838970531
             les_mean =     286.149196850310
             stat err =       0.000464627565
             autocorr =       1.263166527535
              std dev =       0.584641534353
             le_variance =       0.341805723691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341824853528
                                         uncertainty =       0.005982854364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341824853528
                                         uncertainty =       0.005982854364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413388065
  error estimate for blocks of size 2^( 2) =       0.000426439785
  error estimate for blocks of size 2^( 3) =       0.000439365096
  error estimate for blocks of size 2^( 4) =       0.000451718991
  error estimate for blocks of size 2^( 5) =       0.000462467790
  error estimate for blocks of size 2^( 6) =       0.000469559116
  error estimate for blocks of size 2^( 7) =       0.000474714837

      target function =                  N/A
              le_mean =     -16.905839250751
             les_mean =     286.149179985370
             stat err =       0.000464615183
             autocorr =       1.263196544864
              std dev =       0.584619007573
             le_variance =       0.341779384016


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905839313943        initial  <--
     3.9062e-01     3.9062e+00             6.1360e-04       -16.905838825342
     1.5625e+00     1.5625e+01             1.5324e-04       -16.905838970531
     6.2500e+00     6.2500e+01             3.8600e-05       -16.905839250751

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0034
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.119013e-01 1 1  ON 0
 uu_1                 1.447659e-01 1 1  ON 1
 uu_2                 4.283049e-02 1 1  ON 2
 uu_3                -2.008878e-02 1 1  ON 3
 uu_4                -6.622505e-02 1 1  ON 4
 uu_5                -1.019634e-01 1 1  ON 5
 uu_6                -1.301784e-01 1 1  ON 6
 uu_7                -1.447718e-01 1 1  ON 7
 uu_8                -1.378446e-01 1 1  ON 8
 uu_9                -1.084995e-01 1 1  ON 9
 ud_0                 4.510932e-01 1 1  ON 10
 ud_1                 1.849191e-01 1 1  ON 11
 ud_2                 6.413360e-02 1 1  ON 12
 ud_3                -7.494995e-03 1 1  ON 13
 ud_4                -6.508568e-02 1 1  ON 14
 ud_5                -1.070098e-01 1 1  ON 15
 ud_6                -1.351408e-01 1 1  ON 16
 ud_7                -1.519471e-01 1 1  ON 17
 ud_8                -1.530513e-01 1 1  ON 18
 ud_9                -1.416718e-01 1 1  ON 19
 eO_0                -7.565021e-01 1 1  ON 20
 eO_1                -4.349879e-01 1 1  ON 21
 eO_2                -1.831010e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267943e-01 1 1  ON 24
 eO_5                 4.897745e-01 1 1  ON 25
 eO_6                 2.601911e-01 1 1  ON 26
 eO_7                -4.207429e-02 1 1  ON 27
 eO_8                -2.288009e-01 1 1  ON 28
 eO_9                -9.349874e-02 1 1  ON 29
eH1_0                -2.560504e-01 1 1  ON 30
eH1_1                -1.520710e-01 1 1  ON 31
eH1_2                -1.036256e-01 1 1  ON 32
eH1_3                -4.830926e-02 1 1  ON 33
eH1_4                 1.444830e-03 1 1  ON 34
eH1_5                 3.735261e-02 1 1  ON 35
eH1_6                 9.665897e-02 1 1  ON 36
eH1_7                 1.560757e-01 1 1  ON 37
eH1_8                 1.877746e-01 1 1  ON 38
eH1_9                 8.152609e-02 1 1  ON 39
eH2_0                -2.528804e-01 1 1  ON 40
eH2_1                -1.487429e-01 1 1  ON 41
eH2_2                -1.003108e-01 1 1  ON 42
eH2_3                -4.515639e-02 1 1  ON 43
eH2_4                 4.106811e-03 1 1  ON 44
eH2_5                 3.958954e-02 1 1  ON 45
eH2_6                 9.885954e-02 1 1  ON 46
eH2_7                 1.592575e-01 1 1  ON 47
eH2_8                 1.921696e-01 1 1  ON 48
eH2_9                 6.866634e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6871e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9262
    reference variance = 0.237425
====================================================
  Execution time = 2.0878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3658e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336665417084
                                         uncertainty =       0.003431971760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336665417084
                                         uncertainty =       0.003431971760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410230066
  error estimate for blocks of size 2^( 2) =       0.000422863989
  error estimate for blocks of size 2^( 3) =       0.000435388808
  error estimate for blocks of size 2^( 4) =       0.000448069139
  error estimate for blocks of size 2^( 5) =       0.000457606617
  error estimate for blocks of size 2^( 6) =       0.000466359299
  error estimate for blocks of size 2^( 7) =       0.000471626194

      target function =                  N/A
              le_mean =     -16.906566806578
             les_mean =     286.168578430494
             stat err =       0.000460915312
             autocorr =       1.262371843349
              std dev =       0.580152922514
             le_variance =       0.336577413501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690656680658e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906566806578       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906566891708       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906566845186       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906566850647       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906566862613       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906566909114       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906566909511       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906566901773       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.794143e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906566806578       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906566828528       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906566816329       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906566817705       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906566821303       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906566833635       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906566834227       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906566832210       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.203107e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906566806578       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906566812109       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906566809022       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906566809367       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906566810303       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906566813439       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906566813626       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906566813120       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.010390e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191988 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0116e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.119021e-01 1 1  ON 0
 uu_1                 1.447614e-01 1 1  ON 1
 uu_2                 4.283239e-02 1 1  ON 2
 uu_3                -2.009479e-02 1 1  ON 3
 uu_4                -6.622542e-02 1 1  ON 4
 uu_5                -1.019599e-01 1 1  ON 5
 uu_6                -1.301802e-01 1 1  ON 6
 uu_7                -1.447690e-01 1 1  ON 7
 uu_8                -1.378466e-01 1 1  ON 8
 uu_9                -1.085030e-01 1 1  ON 9
 ud_0                 4.510928e-01 1 1  ON 10
 ud_1                 1.849262e-01 1 1  ON 11
 ud_2                 6.413632e-02 1 1  ON 12
 ud_3                -7.494791e-03 1 1  ON 13
 ud_4                -6.507990e-02 1 1  ON 14
 ud_5                -1.070129e-01 1 1  ON 15
 ud_6                -1.351358e-01 1 1  ON 16
 ud_7                -1.519552e-01 1 1  ON 17
 ud_8                -1.530562e-01 1 1  ON 18
 ud_9                -1.416739e-01 1 1  ON 19
 eO_0                -7.565041e-01 1 1  ON 20
 eO_1                -4.349863e-01 1 1  ON 21
 eO_2                -1.830146e-02 1 1  ON 22
 eO_3                 2.998857e-01 1 1  ON 23
 eO_4                 5.267919e-01 1 1  ON 24
 eO_5                 4.897758e-01 1 1  ON 25
 eO_6                 2.601964e-01 1 1  ON 26
 eO_7                -4.207415e-02 1 1  ON 27
 eO_8                -2.288084e-01 1 1  ON 28
 eO_9                -9.350612e-02 1 1  ON 29
eH1_0                -2.560535e-01 1 1  ON 30
eH1_1                -1.520757e-01 1 1  ON 31
eH1_2                -1.036223e-01 1 1  ON 32
eH1_3                -4.831427e-02 1 1  ON 33
eH1_4                 1.443073e-03 1 1  ON 34
eH1_5                 3.734980e-02 1 1  ON 35
eH1_6                 9.665634e-02 1 1  ON 36
eH1_7                 1.560744e-01 1 1  ON 37
eH1_8                 1.877804e-01 1 1  ON 38
eH1_9                 8.153719e-02 1 1  ON 39
eH2_0                -2.528875e-01 1 1  ON 40
eH2_1                -1.487489e-01 1 1  ON 41
eH2_2                -1.003104e-01 1 1  ON 42
eH2_3                -4.515256e-02 1 1  ON 43
eH2_4                 4.105139e-03 1 1  ON 44
eH2_5                 3.959022e-02 1 1  ON 45
eH2_6                 9.885949e-02 1 1  ON 46
eH2_7                 1.592526e-01 1 1  ON 47
eH2_8                 1.921701e-01 1 1  ON 48
eH2_9                 6.867837e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9447
    reference variance = 0.31413
====================================================
  Execution time = 2.1251e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3572e-01
  Total weights = 2.0000e+06
  Execution time = 1.8886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335663778949
                                         uncertainty =       0.002628457168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335663778949
                                         uncertainty =       0.002628457168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409712889
  error estimate for blocks of size 2^( 2) =       0.000422689893
  error estimate for blocks of size 2^( 3) =       0.000435851656
  error estimate for blocks of size 2^( 4) =       0.000447829681
  error estimate for blocks of size 2^( 5) =       0.000459604531
  error estimate for blocks of size 2^( 6) =       0.000467904855
  error estimate for blocks of size 2^( 7) =       0.000474179662

      target function =                  N/A
              le_mean =     -16.905614006594
             les_mean =     286.135514074769
             stat err =       0.000462379682
             autocorr =       1.273615194149
              std dev =       0.579421524182
             le_variance =       0.335729302685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335644584325
                                         uncertainty =       0.002628056976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335644584325
                                         uncertainty =       0.002628056976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409701163
  error estimate for blocks of size 2^( 2) =       0.000422678558
  error estimate for blocks of size 2^( 3) =       0.000435840450
  error estimate for blocks of size 2^( 4) =       0.000447818914
  error estimate for blocks of size 2^( 5) =       0.000459594961
  error estimate for blocks of size 2^( 6) =       0.000467895903
  error estimate for blocks of size 2^( 7) =       0.000474170141

      target function =                  N/A
              le_mean =     -16.905613953440
             les_mean =     286.135493061598
             stat err =       0.000462369980
             autocorr =       1.273634641631
              std dev =       0.579404941910
             le_variance =       0.335710086710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335652672592
                                         uncertainty =       0.002628233019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335652672592
                                         uncertainty =       0.002628233019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409706105
  error estimate for blocks of size 2^( 2) =       0.000422683351
  error estimate for blocks of size 2^( 3) =       0.000435845209
  error estimate for blocks of size 2^( 4) =       0.000447823481
  error estimate for blocks of size 2^( 5) =       0.000459598980
  error estimate for blocks of size 2^( 6) =       0.000467899641
  error estimate for blocks of size 2^( 7) =       0.000474174127

      target function =                  N/A
              le_mean =     -16.905613977931
             les_mean =     286.135501987286
             stat err =       0.000462374057
             autocorr =       1.273626384558
              std dev =       0.579411929746
             le_variance =       0.335718184332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335662335902
                                         uncertainty =       0.002628428295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335662335902
                                         uncertainty =       0.002628428295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409712007
  error estimate for blocks of size 2^( 2) =       0.000422689044
  error estimate for blocks of size 2^( 3) =       0.000435850819
  error estimate for blocks of size 2^( 4) =       0.000447828876
  error estimate for blocks of size 2^( 5) =       0.000459603809
  error estimate for blocks of size 2^( 6) =       0.000467904176
  error estimate for blocks of size 2^( 7) =       0.000474178942

      target function =                  N/A
              le_mean =     -16.905614002810
             les_mean =     286.135512502236
             stat err =       0.000462378951
             autocorr =       1.273616645162
              std dev =       0.579420277598
             le_variance =       0.335727858092


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905614006594        initial  <--
     3.9062e+00     3.9062e+01             4.7941e-05       -16.905613953440
     1.5625e+01     1.5625e+02             1.2031e-05       -16.905613977931
     6.2500e+01     6.2500e+02             3.0104e-06       -16.905614002810

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7692
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.119013e-01 1 1  ON 0
 uu_1                 1.447659e-01 1 1  ON 1
 uu_2                 4.283049e-02 1 1  ON 2
 uu_3                -2.008878e-02 1 1  ON 3
 uu_4                -6.622505e-02 1 1  ON 4
 uu_5                -1.019634e-01 1 1  ON 5
 uu_6                -1.301784e-01 1 1  ON 6
 uu_7                -1.447718e-01 1 1  ON 7
 uu_8                -1.378446e-01 1 1  ON 8
 uu_9                -1.084995e-01 1 1  ON 9
 ud_0                 4.510932e-01 1 1  ON 10
 ud_1                 1.849191e-01 1 1  ON 11
 ud_2                 6.413360e-02 1 1  ON 12
 ud_3                -7.494995e-03 1 1  ON 13
 ud_4                -6.508568e-02 1 1  ON 14
 ud_5                -1.070098e-01 1 1  ON 15
 ud_6                -1.351408e-01 1 1  ON 16
 ud_7                -1.519471e-01 1 1  ON 17
 ud_8                -1.530513e-01 1 1  ON 18
 ud_9                -1.416718e-01 1 1  ON 19
 eO_0                -7.565021e-01 1 1  ON 20
 eO_1                -4.349879e-01 1 1  ON 21
 eO_2                -1.831010e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267943e-01 1 1  ON 24
 eO_5                 4.897745e-01 1 1  ON 25
 eO_6                 2.601911e-01 1 1  ON 26
 eO_7                -4.207429e-02 1 1  ON 27
 eO_8                -2.288009e-01 1 1  ON 28
 eO_9                -9.349874e-02 1 1  ON 29
eH1_0                -2.560504e-01 1 1  ON 30
eH1_1                -1.520710e-01 1 1  ON 31
eH1_2                -1.036256e-01 1 1  ON 32
eH1_3                -4.830926e-02 1 1  ON 33
eH1_4                 1.444830e-03 1 1  ON 34
eH1_5                 3.735261e-02 1 1  ON 35
eH1_6                 9.665897e-02 1 1  ON 36
eH1_7                 1.560757e-01 1 1  ON 37
eH1_8                 1.877746e-01 1 1  ON 38
eH1_9                 8.152609e-02 1 1  ON 39
eH2_0                -2.528804e-01 1 1  ON 40
eH2_1                -1.487429e-01 1 1  ON 41
eH2_2                -1.003108e-01 1 1  ON 42
eH2_3                -4.515639e-02 1 1  ON 43
eH2_4                 4.106811e-03 1 1  ON 44
eH2_5                 3.958954e-02 1 1  ON 45
eH2_6                 9.885954e-02 1 1  ON 46
eH2_7                 1.592575e-01 1 1  ON 47
eH2_8                 1.921696e-01 1 1  ON 48
eH2_9                 6.866634e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6879e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9109
    reference variance = 0.191711
====================================================
  Execution time = 2.1029e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3278e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332666220627
                                         uncertainty =       0.002369532699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332666220627
                                         uncertainty =       0.002369532699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407908286
  error estimate for blocks of size 2^( 2) =       0.000420892516
  error estimate for blocks of size 2^( 3) =       0.000433965408
  error estimate for blocks of size 2^( 4) =       0.000446451161
  error estimate for blocks of size 2^( 5) =       0.000457213519
  error estimate for blocks of size 2^( 6) =       0.000465700563
  error estimate for blocks of size 2^( 7) =       0.000472847506

      target function =                  N/A
              le_mean =     -16.906040483183
             les_mean =     286.146982992807
             stat err =       0.000460553187
             autocorr =       1.274777907075
              std dev =       0.576869430781
             le_variance =       0.332778340169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690604048318e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906040483183       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040484441       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040489285       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040484412       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906040490064       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040491521       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040493424       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040493232       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 6.202889e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906040483183       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040483498       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040484714       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040483491       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906040484900       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040485267       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040485742       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040485697       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.550956e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906040483183       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040483262       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906040483566       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906040483260       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906040483612       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906040483704       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906040483823       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906040483812       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.877534e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194583 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6556e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.119017e-01 1 1  ON 0
 uu_1                 1.447656e-01 1 1  ON 1
 uu_2                 4.283046e-02 1 1  ON 2
 uu_3                -2.008921e-02 1 1  ON 3
 uu_4                -6.622499e-02 1 1  ON 4
 uu_5                -1.019632e-01 1 1  ON 5
 uu_6                -1.301784e-01 1 1  ON 6
 uu_7                -1.447715e-01 1 1  ON 7
 uu_8                -1.378448e-01 1 1  ON 8
 uu_9                -1.085000e-01 1 1  ON 9
 ud_0                 4.510927e-01 1 1  ON 10
 ud_1                 1.849191e-01 1 1  ON 11
 ud_2                 6.413352e-02 1 1  ON 12
 ud_3                -7.494985e-03 1 1  ON 13
 ud_4                -6.508462e-02 1 1  ON 14
 ud_5                -1.070097e-01 1 1  ON 15
 ud_6                -1.351402e-01 1 1  ON 16
 ud_7                -1.519475e-01 1 1  ON 17
 ud_8                -1.530509e-01 1 1  ON 18
 ud_9                -1.416723e-01 1 1  ON 19
 eO_0                -7.565024e-01 1 1  ON 20
 eO_1                -4.349873e-01 1 1  ON 21
 eO_2                -1.830997e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267944e-01 1 1  ON 24
 eO_5                 4.897746e-01 1 1  ON 25
 eO_6                 2.601918e-01 1 1  ON 26
 eO_7                -4.207401e-02 1 1  ON 27
 eO_8                -2.288016e-01 1 1  ON 28
 eO_9                -9.349967e-02 1 1  ON 29
eH1_0                -2.560513e-01 1 1  ON 30
eH1_1                -1.520707e-01 1 1  ON 31
eH1_2                -1.036254e-01 1 1  ON 32
eH1_3                -4.830932e-02 1 1  ON 33
eH1_4                 1.443953e-03 1 1  ON 34
eH1_5                 3.735156e-02 1 1  ON 35
eH1_6                 9.665911e-02 1 1  ON 36
eH1_7                 1.560755e-01 1 1  ON 37
eH1_8                 1.877754e-01 1 1  ON 38
eH1_9                 8.152748e-02 1 1  ON 39
eH2_0                -2.528812e-01 1 1  ON 40
eH2_1                -1.487433e-01 1 1  ON 41
eH2_2                -1.003109e-01 1 1  ON 42
eH2_3                -4.515667e-02 1 1  ON 43
eH2_4                 4.106658e-03 1 1  ON 44
eH2_5                 3.958936e-02 1 1  ON 45
eH2_6                 9.885953e-02 1 1  ON 46
eH2_7                 1.592572e-01 1 1  ON 47
eH2_8                 1.921701e-01 1 1  ON 48
eH2_9                 6.866789e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8569
    reference variance = 0.192153
====================================================
  Execution time = 2.0911e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4477e-01
  Total weights = 2.0000e+06
  Execution time = 1.8797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344796572496
                                         uncertainty =       0.007184661213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344796572496
                                         uncertainty =       0.007184661213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415194564
  error estimate for blocks of size 2^( 2) =       0.000427821828
  error estimate for blocks of size 2^( 3) =       0.000440939603
  error estimate for blocks of size 2^( 4) =       0.000452098451
  error estimate for blocks of size 2^( 5) =       0.000462732634
  error estimate for blocks of size 2^( 6) =       0.000470336967
  error estimate for blocks of size 2^( 7) =       0.000475508046

      target function =                  N/A
              le_mean =     -16.905915479818
             les_mean =     286.154751091132
             stat err =       0.000465169025
             autocorr =       1.255215393942
              std dev =       0.587173784126
             le_variance =       0.344773052765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344795041917
                                         uncertainty =       0.007184590211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344795041917
                                         uncertainty =       0.007184590211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415193643
  error estimate for blocks of size 2^( 2) =       0.000427820954
  error estimate for blocks of size 2^( 3) =       0.000440938760
  error estimate for blocks of size 2^( 4) =       0.000452097623
  error estimate for blocks of size 2^( 5) =       0.000462731840
  error estimate for blocks of size 2^( 6) =       0.000470336190
  error estimate for blocks of size 2^( 7) =       0.000475507147

      target function =                  N/A
              le_mean =     -16.905915496688
             les_mean =     286.154750131245
             stat err =       0.000465168200
             autocorr =       1.255216514474
              std dev =       0.587172481026
             le_variance =       0.344771522474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344795799912
                                         uncertainty =       0.007184625330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344795799912
                                         uncertainty =       0.007184625330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415194099
  error estimate for blocks of size 2^( 2) =       0.000427821387
  error estimate for blocks of size 2^( 3) =       0.000440939177
  error estimate for blocks of size 2^( 4) =       0.000452098033
  error estimate for blocks of size 2^( 5) =       0.000462732233
  error estimate for blocks of size 2^( 6) =       0.000470336575
  error estimate for blocks of size 2^( 7) =       0.000475507592

      target function =                  N/A
              le_mean =     -16.905915488259
             les_mean =     286.154750604098
             stat err =       0.000465168608
             autocorr =       1.255215959200
              std dev =       0.587173126368
             le_variance =       0.344772280329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344796475684
                                         uncertainty =       0.007184656716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344796475684
                                         uncertainty =       0.007184656716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415194506
  error estimate for blocks of size 2^( 2) =       0.000427821773
  error estimate for blocks of size 2^( 3) =       0.000440939549
  error estimate for blocks of size 2^( 4) =       0.000452098399
  error estimate for blocks of size 2^( 5) =       0.000462732584
  error estimate for blocks of size 2^( 6) =       0.000470336918
  error estimate for blocks of size 2^( 7) =       0.000475507989

      target function =                  N/A
              le_mean =     -16.905915480872
             les_mean =     286.154751029983
             stat err =       0.000465168973
             autocorr =       1.255215464751
              std dev =       0.587173701702
             le_variance =       0.344772955971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905915479818        initial
     3.9062e+01     3.9062e+02             6.2029e-06       -16.905915496688  <--
     1.5625e+02     1.5625e+03             1.5510e-06       -16.905915488259
     6.2500e+02     6.2500e+03             3.8775e-07       -16.905915480872

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 3.0374e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.119029e-01 1 1  ON 0
 uu_1                 1.447645e-01 1 1  ON 1
 uu_2                 4.283033e-02 1 1  ON 2
 uu_3                -2.009049e-02 1 1  ON 3
 uu_4                -6.622481e-02 1 1  ON 4
 uu_5                -1.019626e-01 1 1  ON 5
 uu_6                -1.301785e-01 1 1  ON 6
 uu_7                -1.447707e-01 1 1  ON 7
 uu_8                -1.378456e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510913e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413326e-02 1 1  ON 12
 ud_3                -7.494946e-03 1 1  ON 13
 ud_4                -6.508144e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351385e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565030e-01 1 1  ON 20
 eO_1                -4.349854e-01 1 1  ON 21
 eO_2                -1.830958e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267950e-01 1 1  ON 24
 eO_5                 4.897750e-01 1 1  ON 25
 eO_6                 2.601939e-01 1 1  ON 26
 eO_7                -4.207317e-02 1 1  ON 27
 eO_8                -2.288037e-01 1 1  ON 28
 eO_9                -9.350244e-02 1 1  ON 29
eH1_0                -2.560537e-01 1 1  ON 30
eH1_1                -1.520698e-01 1 1  ON 31
eH1_2                -1.036248e-01 1 1  ON 32
eH1_3                -4.830950e-02 1 1  ON 33
eH1_4                 1.441327e-03 1 1  ON 34
eH1_5                 3.734841e-02 1 1  ON 35
eH1_6                 9.665953e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877781e-01 1 1  ON 38
eH1_9                 8.153162e-02 1 1  ON 39
eH2_0                -2.528834e-01 1 1  ON 40
eH2_1                -1.487447e-01 1 1  ON 41
eH2_2                -1.003113e-01 1 1  ON 42
eH2_3                -4.515752e-02 1 1  ON 43
eH2_4                 4.106195e-03 1 1  ON 44
eH2_5                 3.958884e-02 1 1  ON 45
eH2_6                 9.885948e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921718e-01 1 1  ON 48
eH2_9                 6.867254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6938e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6880e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9098
    reference variance = 0.241682
====================================================
  Execution time = 2.1234e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3527e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335267383377
                                         uncertainty =       0.002685633859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335267383377
                                         uncertainty =       0.002685633859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409432049
  error estimate for blocks of size 2^( 2) =       0.000422663644
  error estimate for blocks of size 2^( 3) =       0.000436393591
  error estimate for blocks of size 2^( 4) =       0.000449591397
  error estimate for blocks of size 2^( 5) =       0.000463217578
  error estimate for blocks of size 2^( 6) =       0.000472621828
  error estimate for blocks of size 2^( 7) =       0.000477834799

      target function =                  N/A
              le_mean =     -16.906158813627
             les_mean =     286.153474870159
             stat err =       0.000465816400
             autocorr =       1.294392177238
              std dev =       0.579024357197
             le_variance =       0.335269206227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615881363e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906158813627       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906158879429       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906158905989       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906158914250       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906158824969       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906158834742       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906158849462       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906158843033       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.199346e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906158813627       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906158830275       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906158837121       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906158839178       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906158816045       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906158819123       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906158822105       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906158820481       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.505141e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906158813627       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906158817801       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906158819526       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906158820040       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906158814205       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906158815017       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906158815713       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906158815307       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.376734e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197254 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6769e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.119044e-01 1 1  ON 0
 uu_1                 1.447613e-01 1 1  ON 1
 uu_2                 4.282833e-02 1 1  ON 2
 uu_3                -2.009386e-02 1 1  ON 3
 uu_4                -6.622535e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301768e-01 1 1  ON 6
 uu_7                -1.447715e-01 1 1  ON 7
 uu_8                -1.378429e-01 1 1  ON 8
 uu_9                -1.084998e-01 1 1  ON 9
 ud_0                 4.510885e-01 1 1  ON 10
 ud_1                 1.849213e-01 1 1  ON 11
 ud_2                 6.413309e-02 1 1  ON 12
 ud_3                -7.492868e-03 1 1  ON 13
 ud_4                -6.508197e-02 1 1  ON 14
 ud_5                -1.070099e-01 1 1  ON 15
 ud_6                -1.351387e-01 1 1  ON 16
 ud_7                -1.519503e-01 1 1  ON 17
 ud_8                -1.530495e-01 1 1  ON 18
 ud_9                -1.416732e-01 1 1  ON 19
 eO_0                -7.565034e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.831040e-02 1 1  ON 22
 eO_3                 2.998821e-01 1 1  ON 23
 eO_4                 5.267957e-01 1 1  ON 24
 eO_5                 4.897767e-01 1 1  ON 25
 eO_6                 2.601970e-01 1 1  ON 26
 eO_7                -4.207340e-02 1 1  ON 27
 eO_8                -2.288049e-01 1 1  ON 28
 eO_9                -9.350519e-02 1 1  ON 29
eH1_0                -2.560584e-01 1 1  ON 30
eH1_1                -1.520731e-01 1 1  ON 31
eH1_2                -1.036258e-01 1 1  ON 32
eH1_3                -4.831108e-02 1 1  ON 33
eH1_4                 1.438166e-03 1 1  ON 34
eH1_5                 3.734885e-02 1 1  ON 35
eH1_6                 9.665993e-02 1 1  ON 36
eH1_7                 1.560761e-01 1 1  ON 37
eH1_8                 1.877829e-01 1 1  ON 38
eH1_9                 8.153713e-02 1 1  ON 39
eH2_0                -2.528870e-01 1 1  ON 40
eH2_1                -1.487437e-01 1 1  ON 41
eH2_2                -1.003109e-01 1 1  ON 42
eH2_3                -4.516032e-02 1 1  ON 43
eH2_4                 4.104504e-03 1 1  ON 44
eH2_5                 3.958691e-02 1 1  ON 45
eH2_6                 9.886014e-02 1 1  ON 46
eH2_7                 1.592572e-01 1 1  ON 47
eH2_8                 1.921744e-01 1 1  ON 48
eH2_9                 6.867692e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8518
    reference variance = 0.189675
====================================================
  Execution time = 2.0946e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3980e-01
  Total weights = 2.0000e+06
  Execution time = 1.8610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339832898832
                                         uncertainty =       0.005647386903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339832898832
                                         uncertainty =       0.005647386903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412193109
  error estimate for blocks of size 2^( 2) =       0.000424870384
  error estimate for blocks of size 2^( 3) =       0.000438714880
  error estimate for blocks of size 2^( 4) =       0.000451862608
  error estimate for blocks of size 2^( 5) =       0.000463260970
  error estimate for blocks of size 2^( 6) =       0.000472700110
  error estimate for blocks of size 2^( 7) =       0.000479663081

      target function =                  N/A
              le_mean =     -16.906246973065
             les_mean =     286.160992861760
             stat err =       0.000466871692
             autocorr =       1.282902440188
              std dev =       0.582929084373
             le_variance =       0.339806317408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339823002196
                                         uncertainty =       0.005647283440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339823002196
                                         uncertainty =       0.005647283440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412187107
  error estimate for blocks of size 2^( 2) =       0.000424864843
  error estimate for blocks of size 2^( 3) =       0.000438709761
  error estimate for blocks of size 2^( 4) =       0.000451857578
  error estimate for blocks of size 2^( 5) =       0.000463255999
  error estimate for blocks of size 2^( 6) =       0.000472695168
  error estimate for blocks of size 2^( 7) =       0.000479658865

      target function =                  N/A
              le_mean =     -16.906246882043
             les_mean =     286.160979889012
             stat err =       0.000466866903
             autocorr =       1.282913476102
              std dev =       0.582920596920
             le_variance =       0.339796422314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339827733581
                                         uncertainty =       0.005647332157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339827733581
                                         uncertainty =       0.005647332157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412189976
  error estimate for blocks of size 2^( 2) =       0.000424867489
  error estimate for blocks of size 2^( 3) =       0.000438712202
  error estimate for blocks of size 2^( 4) =       0.000451859976
  error estimate for blocks of size 2^( 5) =       0.000463258369
  error estimate for blocks of size 2^( 6) =       0.000472697527
  error estimate for blocks of size 2^( 7) =       0.000479660873

      target function =                  N/A
              le_mean =     -16.906246925416
             les_mean =     286.160986086247
             stat err =       0.000466869186
             autocorr =       1.282908166513
              std dev =       0.582924654666
             le_variance =       0.339801153018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339832245951
                                         uncertainty =       0.005647379962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339832245951
                                         uncertainty =       0.005647379962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412192713
  error estimate for blocks of size 2^( 2) =       0.000424870018
  error estimate for blocks of size 2^( 3) =       0.000438714541
  error estimate for blocks of size 2^( 4) =       0.000451862275
  error estimate for blocks of size 2^( 5) =       0.000463260641
  error estimate for blocks of size 2^( 6) =       0.000472699784
  error estimate for blocks of size 2^( 7) =       0.000479662801

      target function =                  N/A
              le_mean =     -16.906246967017
             les_mean =     286.160992004490
             stat err =       0.000466871375
             autocorr =       1.282903162718
              std dev =       0.582928524467
             le_variance =       0.339805664637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906246973065        initial  <--
     9.7656e+00     9.7656e+01             2.1993e-05       -16.906246882043
     3.9062e+01     3.9062e+02             5.5051e-06       -16.906246925416
     1.5625e+02     1.5625e+03             1.3767e-06       -16.906246967017

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3520
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.119029e-01 1 1  ON 0
 uu_1                 1.447645e-01 1 1  ON 1
 uu_2                 4.283033e-02 1 1  ON 2
 uu_3                -2.009049e-02 1 1  ON 3
 uu_4                -6.622481e-02 1 1  ON 4
 uu_5                -1.019626e-01 1 1  ON 5
 uu_6                -1.301785e-01 1 1  ON 6
 uu_7                -1.447707e-01 1 1  ON 7
 uu_8                -1.378456e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510913e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413326e-02 1 1  ON 12
 ud_3                -7.494946e-03 1 1  ON 13
 ud_4                -6.508144e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351385e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565030e-01 1 1  ON 20
 eO_1                -4.349854e-01 1 1  ON 21
 eO_2                -1.830958e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267950e-01 1 1  ON 24
 eO_5                 4.897750e-01 1 1  ON 25
 eO_6                 2.601939e-01 1 1  ON 26
 eO_7                -4.207317e-02 1 1  ON 27
 eO_8                -2.288037e-01 1 1  ON 28
 eO_9                -9.350244e-02 1 1  ON 29
eH1_0                -2.560537e-01 1 1  ON 30
eH1_1                -1.520698e-01 1 1  ON 31
eH1_2                -1.036248e-01 1 1  ON 32
eH1_3                -4.830950e-02 1 1  ON 33
eH1_4                 1.441327e-03 1 1  ON 34
eH1_5                 3.734841e-02 1 1  ON 35
eH1_6                 9.665953e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877781e-01 1 1  ON 38
eH1_9                 8.153162e-02 1 1  ON 39
eH2_0                -2.528834e-01 1 1  ON 40
eH2_1                -1.487447e-01 1 1  ON 41
eH2_2                -1.003113e-01 1 1  ON 42
eH2_3                -4.515752e-02 1 1  ON 43
eH2_4                 4.106195e-03 1 1  ON 44
eH2_5                 3.958884e-02 1 1  ON 45
eH2_6                 9.885948e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921718e-01 1 1  ON 48
eH2_9                 6.867254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6880e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9166
    reference variance = 0.242073
====================================================
  Execution time = 2.0753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3390e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333978266803
                                         uncertainty =       0.002881056725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333978266803
                                         uncertainty =       0.002881056725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408593119
  error estimate for blocks of size 2^( 2) =       0.000421558716
  error estimate for blocks of size 2^( 3) =       0.000434577648
  error estimate for blocks of size 2^( 4) =       0.000446791458
  error estimate for blocks of size 2^( 5) =       0.000457004462
  error estimate for blocks of size 2^( 6) =       0.000465374358
  error estimate for blocks of size 2^( 7) =       0.000470079333

      target function =                  N/A
              le_mean =     -16.906291188991
             les_mean =     286.156578274245
             stat err =       0.000459812403
             autocorr =       1.266424389051
              std dev =       0.577837930782
             le_variance =       0.333896674250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690629118899e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906291188991       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906291193081       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906291185588       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906291176552       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906291176066       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906291177023       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906291177072       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906291177531       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.507133e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906291188991       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906291190015       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906291188137       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906291185877       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906291185736       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906291185981       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906291185995       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906291186109       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 6.268234e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906291188991       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906291189247       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906291188777       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906291188212       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906291188176       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906291188237       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906291188241       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906291188269       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.567084e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6314e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.119031e-01 1 1  ON 0
 uu_1                 1.447643e-01 1 1  ON 1
 uu_2                 4.283023e-02 1 1  ON 2
 uu_3                -2.009048e-02 1 1  ON 3
 uu_4                -6.622475e-02 1 1  ON 4
 uu_5                -1.019627e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085018e-01 1 1  ON 9
 ud_0                 4.510908e-01 1 1  ON 10
 ud_1                 1.849194e-01 1 1  ON 11
 ud_2                 6.413315e-02 1 1  ON 12
 ud_3                -7.494810e-03 1 1  ON 13
 ud_4                -6.508159e-02 1 1  ON 14
 ud_5                -1.070094e-01 1 1  ON 15
 ud_6                -1.351383e-01 1 1  ON 16
 ud_7                -1.519486e-01 1 1  ON 17
 ud_8                -1.530498e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565032e-01 1 1  ON 20
 eO_1                -4.349850e-01 1 1  ON 21
 eO_2                -1.830930e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267948e-01 1 1  ON 24
 eO_5                 4.897750e-01 1 1  ON 25
 eO_6                 2.601939e-01 1 1  ON 26
 eO_7                -4.207309e-02 1 1  ON 27
 eO_8                -2.288038e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520698e-01 1 1  ON 31
eH1_2                -1.036245e-01 1 1  ON 32
eH1_3                -4.830972e-02 1 1  ON 33
eH1_4                 1.441238e-03 1 1  ON 34
eH1_5                 3.734825e-02 1 1  ON 35
eH1_6                 9.665946e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877783e-01 1 1  ON 38
eH1_9                 8.153191e-02 1 1  ON 39
eH2_0                -2.528836e-01 1 1  ON 40
eH2_1                -1.487446e-01 1 1  ON 41
eH2_2                -1.003115e-01 1 1  ON 42
eH2_3                -4.515783e-02 1 1  ON 43
eH2_4                 4.106066e-03 1 1  ON 44
eH2_5                 3.958862e-02 1 1  ON 45
eH2_6                 9.885944e-02 1 1  ON 46
eH2_7                 1.592560e-01 1 1  ON 47
eH2_8                 1.921722e-01 1 1  ON 48
eH2_9                 6.867317e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9518
    reference variance = 0.896767
====================================================
  Execution time = 2.0551e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4735e-01
  Total weights = 2.0000e+06
  Execution time = 1.8696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319525517
                                         uncertainty =       0.011212635808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319525517
                                         uncertainty =       0.011212635808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416744046
  error estimate for blocks of size 2^( 2) =       0.000429177515
  error estimate for blocks of size 2^( 3) =       0.000441677877
  error estimate for blocks of size 2^( 4) =       0.000453411981
  error estimate for blocks of size 2^( 5) =       0.000463481637
  error estimate for blocks of size 2^( 6) =       0.000470980172
  error estimate for blocks of size 2^( 7) =       0.000477164594

      target function =                  N/A
              le_mean =     -16.905534739821
             les_mean =     286.144455866107
             stat err =       0.000466259596
             autocorr =       1.251747570872
              std dev =       0.589365082527
             le_variance =       0.347351200502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347317732223
                                         uncertainty =       0.011212472924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347317732223
                                         uncertainty =       0.011212472924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416742970
  error estimate for blocks of size 2^( 2) =       0.000429176478
  error estimate for blocks of size 2^( 3) =       0.000441676881
  error estimate for blocks of size 2^( 4) =       0.000453411033
  error estimate for blocks of size 2^( 5) =       0.000463480717
  error estimate for blocks of size 2^( 6) =       0.000470979288
  error estimate for blocks of size 2^( 7) =       0.000477163734

      target function =                  N/A
              le_mean =     -16.905534731174
             les_mean =     286.144453779604
             stat err =       0.000466258693
             autocorr =       1.251749188577
              std dev =       0.589363560418
             le_variance =       0.347349406348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347318624451
                                         uncertainty =       0.011212553990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347318624451
                                         uncertainty =       0.011212553990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416743506
  error estimate for blocks of size 2^( 2) =       0.000429176994
  error estimate for blocks of size 2^( 3) =       0.000441677377
  error estimate for blocks of size 2^( 4) =       0.000453411505
  error estimate for blocks of size 2^( 5) =       0.000463481175
  error estimate for blocks of size 2^( 6) =       0.000470979728
  error estimate for blocks of size 2^( 7) =       0.000477164162

      target function =                  N/A
              le_mean =     -16.905534735476
             les_mean =     286.144454817721
             stat err =       0.000466259142
             autocorr =       1.251748383686
              std dev =       0.589364317724
             le_variance =       0.347350299006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319412741
                                         uncertainty =       0.011212625569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347319412741
                                         uncertainty =       0.011212625569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416743979
  error estimate for blocks of size 2^( 2) =       0.000429177449
  error estimate for blocks of size 2^( 3) =       0.000441677815
  error estimate for blocks of size 2^( 4) =       0.000453411921
  error estimate for blocks of size 2^( 5) =       0.000463481579
  error estimate for blocks of size 2^( 6) =       0.000470980117
  error estimate for blocks of size 2^( 7) =       0.000477164540

      target function =                  N/A
              le_mean =     -16.905534739277
             les_mean =     286.144455734882
             stat err =       0.000466259539
             autocorr =       1.251747672596
              std dev =       0.589364986805
             le_variance =       0.347351087672


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905534739821        initial  <--
     9.7656e+01     9.7656e+02             2.5071e-06       -16.905534731174
     3.9062e+02     3.9062e+03             6.2682e-07       -16.905534735476
     1.5625e+03     1.5625e+04             1.5671e-07       -16.905534739277

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9700
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.119029e-01 1 1  ON 0
 uu_1                 1.447645e-01 1 1  ON 1
 uu_2                 4.283033e-02 1 1  ON 2
 uu_3                -2.009049e-02 1 1  ON 3
 uu_4                -6.622481e-02 1 1  ON 4
 uu_5                -1.019626e-01 1 1  ON 5
 uu_6                -1.301785e-01 1 1  ON 6
 uu_7                -1.447707e-01 1 1  ON 7
 uu_8                -1.378456e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510913e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413326e-02 1 1  ON 12
 ud_3                -7.494946e-03 1 1  ON 13
 ud_4                -6.508144e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351385e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565030e-01 1 1  ON 20
 eO_1                -4.349854e-01 1 1  ON 21
 eO_2                -1.830958e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267950e-01 1 1  ON 24
 eO_5                 4.897750e-01 1 1  ON 25
 eO_6                 2.601939e-01 1 1  ON 26
 eO_7                -4.207317e-02 1 1  ON 27
 eO_8                -2.288037e-01 1 1  ON 28
 eO_9                -9.350244e-02 1 1  ON 29
eH1_0                -2.560537e-01 1 1  ON 30
eH1_1                -1.520698e-01 1 1  ON 31
eH1_2                -1.036248e-01 1 1  ON 32
eH1_3                -4.830950e-02 1 1  ON 33
eH1_4                 1.441327e-03 1 1  ON 34
eH1_5                 3.734841e-02 1 1  ON 35
eH1_6                 9.665953e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877781e-01 1 1  ON 38
eH1_9                 8.153162e-02 1 1  ON 39
eH2_0                -2.528834e-01 1 1  ON 40
eH2_1                -1.487447e-01 1 1  ON 41
eH2_2                -1.003113e-01 1 1  ON 42
eH2_3                -4.515752e-02 1 1  ON 43
eH2_4                 4.106195e-03 1 1  ON 44
eH2_5                 3.958884e-02 1 1  ON 45
eH2_6                 9.885948e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921718e-01 1 1  ON 48
eH2_9                 6.867254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6291e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9154
    reference variance = 0.236636
====================================================
  Execution time = 2.1011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4400e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344070912459
                                         uncertainty =       0.005488608562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344070912459
                                         uncertainty =       0.005488608562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414730920
  error estimate for blocks of size 2^( 2) =       0.000427176200
  error estimate for blocks of size 2^( 3) =       0.000439735739
  error estimate for blocks of size 2^( 4) =       0.000452484618
  error estimate for blocks of size 2^( 5) =       0.000463207662
  error estimate for blocks of size 2^( 6) =       0.000471794620
  error estimate for blocks of size 2^( 7) =       0.000476397659

      target function =                  N/A
              le_mean =     -16.906066653820
             les_mean =     286.159093002786
             stat err =       0.000465971140
             autocorr =       1.262365767673
              std dev =       0.586518091260
             le_variance =       0.344003471376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606665382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906066653820       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906066653891       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906066653243       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906066653072       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906066652861       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906066652716       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906066652782       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906066652896       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 1.877564e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906066653820       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906066653838       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906066653676       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906066653633       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906066653580       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906066653544       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906066653560       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906066653586       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 4.694233e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906066653820       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906066653825       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906066653784       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906066653773       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906066653760       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906066653751       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906066653755       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906066653781       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 1.173579e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202612 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6550e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.119029e-01 1 1  ON 0
 uu_1                 1.447645e-01 1 1  ON 1
 uu_2                 4.283031e-02 1 1  ON 2
 uu_3                -2.009049e-02 1 1  ON 3
 uu_4                -6.622480e-02 1 1  ON 4
 uu_5                -1.019626e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447707e-01 1 1  ON 7
 uu_8                -1.378456e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510913e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494934e-03 1 1  ON 13
 ud_4                -6.508144e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565030e-01 1 1  ON 20
 eO_1                -4.349854e-01 1 1  ON 21
 eO_2                -1.830956e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267950e-01 1 1  ON 24
 eO_5                 4.897750e-01 1 1  ON 25
 eO_6                 2.601939e-01 1 1  ON 26
 eO_7                -4.207317e-02 1 1  ON 27
 eO_8                -2.288037e-01 1 1  ON 28
 eO_9                -9.350248e-02 1 1  ON 29
eH1_0                -2.560538e-01 1 1  ON 30
eH1_1                -1.520698e-01 1 1  ON 31
eH1_2                -1.036248e-01 1 1  ON 32
eH1_3                -4.830953e-02 1 1  ON 33
eH1_4                 1.441341e-03 1 1  ON 34
eH1_5                 3.734840e-02 1 1  ON 35
eH1_6                 9.665953e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877782e-01 1 1  ON 38
eH1_9                 8.153166e-02 1 1  ON 39
eH2_0                -2.528835e-01 1 1  ON 40
eH2_1                -1.487447e-01 1 1  ON 41
eH2_2                -1.003113e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106206e-03 1 1  ON 44
eH2_5                 3.958882e-02 1 1  ON 45
eH2_6                 9.885950e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921718e-01 1 1  ON 48
eH2_9                 6.867258e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8864
    reference variance = 0.269115
====================================================
  Execution time = 2.0525e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4285e-01
  Total weights = 2.0000e+06
  Execution time = 1.8677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342849819511
                                         uncertainty =       0.003871723385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342849819511
                                         uncertainty =       0.003871723385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414033388
  error estimate for blocks of size 2^( 2) =       0.000426646937
  error estimate for blocks of size 2^( 3) =       0.000439575329
  error estimate for blocks of size 2^( 4) =       0.000451170779
  error estimate for blocks of size 2^( 5) =       0.000461963947
  error estimate for blocks of size 2^( 6) =       0.000469784217
  error estimate for blocks of size 2^( 7) =       0.000474718556

      target function =                  N/A
              le_mean =     -16.906773842969
             les_mean =     286.181848898621
             stat err =       0.000464409375
             autocorr =       1.258146539085
              std dev =       0.585531632581
             le_variance =       0.342847292753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342849767971
                                         uncertainty =       0.003871722597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342849767971
                                         uncertainty =       0.003871722597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414033357
  error estimate for blocks of size 2^( 2) =       0.000426646907
  error estimate for blocks of size 2^( 3) =       0.000439575298
  error estimate for blocks of size 2^( 4) =       0.000451170750
  error estimate for blocks of size 2^( 5) =       0.000461963919
  error estimate for blocks of size 2^( 6) =       0.000469784191
  error estimate for blocks of size 2^( 7) =       0.000474718527

      target function =                  N/A
              le_mean =     -16.906773842890
             les_mean =     286.181848844446
             stat err =       0.000464409347
             autocorr =       1.258146575987
              std dev =       0.585531588579
             le_variance =       0.342847241224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342849793718
                                         uncertainty =       0.003871722991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342849793718
                                         uncertainty =       0.003871722991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414033372
  error estimate for blocks of size 2^( 2) =       0.000426646922
  error estimate for blocks of size 2^( 3) =       0.000439575314
  error estimate for blocks of size 2^( 4) =       0.000451170764
  error estimate for blocks of size 2^( 5) =       0.000461963933
  error estimate for blocks of size 2^( 6) =       0.000469784204
  error estimate for blocks of size 2^( 7) =       0.000474718541

      target function =                  N/A
              le_mean =     -16.906773842930
             les_mean =     286.181848871511
             stat err =       0.000464409361
             autocorr =       1.258146557558
              std dev =       0.585531610561
             le_variance =       0.342847266966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342849816286
                                         uncertainty =       0.003871723336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342849816286
                                         uncertainty =       0.003871723336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414033386
  error estimate for blocks of size 2^( 2) =       0.000426646935
  error estimate for blocks of size 2^( 3) =       0.000439575327
  error estimate for blocks of size 2^( 4) =       0.000451170777
  error estimate for blocks of size 2^( 5) =       0.000461963945
  error estimate for blocks of size 2^( 6) =       0.000469784216
  error estimate for blocks of size 2^( 7) =       0.000474718554

      target function =                  N/A
              le_mean =     -16.906773842964
             les_mean =     286.181848895231
             stat err =       0.000464409373
             autocorr =       1.258146541395
              std dev =       0.585531629828
             le_variance =       0.342847289529


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906773842969        initial  <--
     9.7656e+02     9.7656e+03             1.8776e-07       -16.906773842890
     3.9062e+03     3.9062e+04             4.6942e-08       -16.906773842930
     1.5625e+04     1.5625e+05             1.1736e-08       -16.906773842964

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9587
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.119029e-01 1 1  ON 0
 uu_1                 1.447645e-01 1 1  ON 1
 uu_2                 4.283033e-02 1 1  ON 2
 uu_3                -2.009049e-02 1 1  ON 3
 uu_4                -6.622481e-02 1 1  ON 4
 uu_5                -1.019626e-01 1 1  ON 5
 uu_6                -1.301785e-01 1 1  ON 6
 uu_7                -1.447707e-01 1 1  ON 7
 uu_8                -1.378456e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510913e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413326e-02 1 1  ON 12
 ud_3                -7.494946e-03 1 1  ON 13
 ud_4                -6.508144e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351385e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565030e-01 1 1  ON 20
 eO_1                -4.349854e-01 1 1  ON 21
 eO_2                -1.830958e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267950e-01 1 1  ON 24
 eO_5                 4.897750e-01 1 1  ON 25
 eO_6                 2.601939e-01 1 1  ON 26
 eO_7                -4.207317e-02 1 1  ON 27
 eO_8                -2.288037e-01 1 1  ON 28
 eO_9                -9.350244e-02 1 1  ON 29
eH1_0                -2.560537e-01 1 1  ON 30
eH1_1                -1.520698e-01 1 1  ON 31
eH1_2                -1.036248e-01 1 1  ON 32
eH1_3                -4.830950e-02 1 1  ON 33
eH1_4                 1.441327e-03 1 1  ON 34
eH1_5                 3.734841e-02 1 1  ON 35
eH1_6                 9.665953e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877781e-01 1 1  ON 38
eH1_9                 8.153162e-02 1 1  ON 39
eH2_0                -2.528834e-01 1 1  ON 40
eH2_1                -1.487447e-01 1 1  ON 41
eH2_2                -1.003113e-01 1 1  ON 42
eH2_3                -4.515752e-02 1 1  ON 43
eH2_4                 4.106195e-03 1 1  ON 44
eH2_5                 3.958884e-02 1 1  ON 45
eH2_6                 9.885948e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921718e-01 1 1  ON 48
eH2_9                 6.867254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6531e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8053
    reference variance = 0.322249
====================================================
  Execution time = 2.0738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5010e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350172223291
                                         uncertainty =       0.008673408010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350172223291
                                         uncertainty =       0.008673408010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418391696
  error estimate for blocks of size 2^( 2) =       0.000430761806
  error estimate for blocks of size 2^( 3) =       0.000443734434
  error estimate for blocks of size 2^( 4) =       0.000457133756
  error estimate for blocks of size 2^( 5) =       0.000468450072
  error estimate for blocks of size 2^( 6) =       0.000476651596
  error estimate for blocks of size 2^( 7) =       0.000482996812

      target function =                  N/A
              le_mean =     -16.905855843827
             les_mean =     286.158064858993
             stat err =       0.000471308059
             autocorr =       1.268947400868
              std dev =       0.591695210218
             le_variance =       0.350103221795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585584383e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905855843827       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905855843813       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905855843845       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905855843865       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905855843868       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905855843860       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905855843883       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905855843849       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.665132e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905855843827       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905855843823       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905855843831       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905855843836       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905855843837       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905855843835       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905855843833       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905855843858       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 6.662921e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905855843827       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905855843826       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905855843828       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905855843828       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905855843821       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905855843851       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905855843893       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905855843941       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.665736e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205202 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6279e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.119029e-01 1 1  ON 0
 uu_1                 1.447645e-01 1 1  ON 1
 uu_2                 4.283033e-02 1 1  ON 2
 uu_3                -2.009049e-02 1 1  ON 3
 uu_4                -6.622481e-02 1 1  ON 4
 uu_5                -1.019626e-01 1 1  ON 5
 uu_6                -1.301785e-01 1 1  ON 6
 uu_7                -1.447707e-01 1 1  ON 7
 uu_8                -1.378456e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510913e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413326e-02 1 1  ON 12
 ud_3                -7.494947e-03 1 1  ON 13
 ud_4                -6.508144e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351385e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565030e-01 1 1  ON 20
 eO_1                -4.349854e-01 1 1  ON 21
 eO_2                -1.830958e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267950e-01 1 1  ON 24
 eO_5                 4.897750e-01 1 1  ON 25
 eO_6                 2.601939e-01 1 1  ON 26
 eO_7                -4.207317e-02 1 1  ON 27
 eO_8                -2.288037e-01 1 1  ON 28
 eO_9                -9.350245e-02 1 1  ON 29
eH1_0                -2.560537e-01 1 1  ON 30
eH1_1                -1.520698e-01 1 1  ON 31
eH1_2                -1.036248e-01 1 1  ON 32
eH1_3                -4.830950e-02 1 1  ON 33
eH1_4                 1.441323e-03 1 1  ON 34
eH1_5                 3.734841e-02 1 1  ON 35
eH1_6                 9.665953e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877781e-01 1 1  ON 38
eH1_9                 8.153163e-02 1 1  ON 39
eH2_0                -2.528834e-01 1 1  ON 40
eH2_1                -1.487447e-01 1 1  ON 41
eH2_2                -1.003113e-01 1 1  ON 42
eH2_3                -4.515752e-02 1 1  ON 43
eH2_4                 4.106196e-03 1 1  ON 44
eH2_5                 3.958883e-02 1 1  ON 45
eH2_6                 9.885948e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921718e-01 1 1  ON 48
eH2_9                 6.867255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8748
    reference variance = 0.146939
====================================================
  Execution time = 2.2476e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4440e-01
  Total weights = 2.0000e+06
  Execution time = 1.8508e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344437858935
                                         uncertainty =       0.009756614738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344437858935
                                         uncertainty =       0.009756614738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414971086
  error estimate for blocks of size 2^( 2) =       0.000427360143
  error estimate for blocks of size 2^( 3) =       0.000440339078
  error estimate for blocks of size 2^( 4) =       0.000453354492
  error estimate for blocks of size 2^( 5) =       0.000463513341
  error estimate for blocks of size 2^( 6) =       0.000472607140
  error estimate for blocks of size 2^( 7) =       0.000478735624

      target function =                  N/A
              le_mean =     -16.906314868520
             les_mean =     286.167884265153
             stat err =       0.000467052649
             autocorr =       1.266764854382
              std dev =       0.586857737284
             le_variance =       0.344402003810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344437848539
                                         uncertainty =       0.009756614380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344437848539
                                         uncertainty =       0.009756614380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414971079
  error estimate for blocks of size 2^( 2) =       0.000427360137
  error estimate for blocks of size 2^( 3) =       0.000440339072
  error estimate for blocks of size 2^( 4) =       0.000453354486
  error estimate for blocks of size 2^( 5) =       0.000463513336
  error estimate for blocks of size 2^( 6) =       0.000472607135
  error estimate for blocks of size 2^( 7) =       0.000478735619

      target function =                  N/A
              le_mean =     -16.906314868656
             les_mean =     286.167884259357
             stat err =       0.000467052644
             autocorr =       1.266764865398
              std dev =       0.586857728427
             le_variance =       0.344401993414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344437853737
                                         uncertainty =       0.009756614559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344437853737
                                         uncertainty =       0.009756614559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414971082
  error estimate for blocks of size 2^( 2) =       0.000427360140
  error estimate for blocks of size 2^( 3) =       0.000440339075
  error estimate for blocks of size 2^( 4) =       0.000453354489
  error estimate for blocks of size 2^( 5) =       0.000463513339
  error estimate for blocks of size 2^( 6) =       0.000472607137
  error estimate for blocks of size 2^( 7) =       0.000478735622

      target function =                  N/A
              le_mean =     -16.906314868588
             les_mean =     286.167884262255
             stat err =       0.000467052647
             autocorr =       1.266764859889
              std dev =       0.586857732855
             le_variance =       0.344401998612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344437858286
                                         uncertainty =       0.009756614715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344437858286
                                         uncertainty =       0.009756614715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414971085
  error estimate for blocks of size 2^( 2) =       0.000427360143
  error estimate for blocks of size 2^( 3) =       0.000440339078
  error estimate for blocks of size 2^( 4) =       0.000453354491
  error estimate for blocks of size 2^( 5) =       0.000463513341
  error estimate for blocks of size 2^( 6) =       0.000472607139
  error estimate for blocks of size 2^( 7) =       0.000478735624

      target function =                  N/A
              le_mean =     -16.906314868529
             les_mean =     286.167884264791
             stat err =       0.000467052649
             autocorr =       1.266764855079
              std dev =       0.586857736730
             le_variance =       0.344402003160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906314868520        initial
     9.7656e+03     9.7656e+04             2.6651e-08       -16.906314868656  <--
     3.9062e+04     3.9062e+05             6.6629e-09       -16.906314868588
     1.5625e+05     1.5625e+06             1.6657e-09       -16.906314868529

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 3.1831e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.119029e-01 1 1  ON 0
 uu_1                 1.447645e-01 1 1  ON 1
 uu_2                 4.283033e-02 1 1  ON 2
 uu_3                -2.009050e-02 1 1  ON 3
 uu_4                -6.622481e-02 1 1  ON 4
 uu_5                -1.019626e-01 1 1  ON 5
 uu_6                -1.301785e-01 1 1  ON 6
 uu_7                -1.447707e-01 1 1  ON 7
 uu_8                -1.378456e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510913e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413326e-02 1 1  ON 12
 ud_3                -7.494948e-03 1 1  ON 13
 ud_4                -6.508144e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351385e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565030e-01 1 1  ON 20
 eO_1                -4.349854e-01 1 1  ON 21
 eO_2                -1.830959e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267949e-01 1 1  ON 24
 eO_5                 4.897750e-01 1 1  ON 25
 eO_6                 2.601939e-01 1 1  ON 26
 eO_7                -4.207317e-02 1 1  ON 27
 eO_8                -2.288037e-01 1 1  ON 28
 eO_9                -9.350245e-02 1 1  ON 29
eH1_0                -2.560538e-01 1 1  ON 30
eH1_1                -1.520698e-01 1 1  ON 31
eH1_2                -1.036248e-01 1 1  ON 32
eH1_3                -4.830950e-02 1 1  ON 33
eH1_4                 1.441310e-03 1 1  ON 34
eH1_5                 3.734839e-02 1 1  ON 35
eH1_6                 9.665953e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877781e-01 1 1  ON 38
eH1_9                 8.153164e-02 1 1  ON 39
eH2_0                -2.528835e-01 1 1  ON 40
eH2_1                -1.487447e-01 1 1  ON 41
eH2_2                -1.003113e-01 1 1  ON 42
eH2_3                -4.515752e-02 1 1  ON 43
eH2_4                 4.106198e-03 1 1  ON 44
eH2_5                 3.958883e-02 1 1  ON 45
eH2_6                 9.885948e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921718e-01 1 1  ON 48
eH2_9                 6.867257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8120e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6883e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.869
    reference variance = 0.477698
====================================================
  Execution time = 2.0946e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5435e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354354431438
                                         uncertainty =       0.014021647244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354354431438
                                         uncertainty =       0.014021647244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420924624
  error estimate for blocks of size 2^( 2) =       0.000433854066
  error estimate for blocks of size 2^( 3) =       0.000446716282
  error estimate for blocks of size 2^( 4) =       0.000459044440
  error estimate for blocks of size 2^( 5) =       0.000470363639
  error estimate for blocks of size 2^( 6) =       0.000479286111
  error estimate for blocks of size 2^( 7) =       0.000481601950

      target function =                  N/A
              le_mean =     -16.905672310437
             les_mean =     286.156111169000
             stat err =       0.000472574035
             autocorr =       1.260465743103
              std dev =       0.595277312092
             le_variance =       0.354355078292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567231044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905672310437       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905672310308       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905672310284       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905672310389       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905672310566       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905672310626       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905672310619       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905672310628       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 7.835689e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905672310437       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905672310405       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905672310399       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905672310425       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905672310468       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905672310477       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905672310480       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905672310483       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 1.958936e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905672310437       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905672310429       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905672310428       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905672310440       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905672310465       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905672310454       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905672310449       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905672310457       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 4.897349e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6608e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.119029e-01 1 1  ON 0
 uu_1                 1.447645e-01 1 1  ON 1
 uu_2                 4.283033e-02 1 1  ON 2
 uu_3                -2.009050e-02 1 1  ON 3
 uu_4                -6.622481e-02 1 1  ON 4
 uu_5                -1.019626e-01 1 1  ON 5
 uu_6                -1.301785e-01 1 1  ON 6
 uu_7                -1.447707e-01 1 1  ON 7
 uu_8                -1.378456e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510913e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413326e-02 1 1  ON 12
 ud_3                -7.494958e-03 1 1  ON 13
 ud_4                -6.508142e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351385e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565030e-01 1 1  ON 20
 eO_1                -4.349854e-01 1 1  ON 21
 eO_2                -1.830958e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267950e-01 1 1  ON 24
 eO_5                 4.897750e-01 1 1  ON 25
 eO_6                 2.601939e-01 1 1  ON 26
 eO_7                -4.207317e-02 1 1  ON 27
 eO_8                -2.288037e-01 1 1  ON 28
 eO_9                -9.350247e-02 1 1  ON 29
eH1_0                -2.560538e-01 1 1  ON 30
eH1_1                -1.520698e-01 1 1  ON 31
eH1_2                -1.036248e-01 1 1  ON 32
eH1_3                -4.830950e-02 1 1  ON 33
eH1_4                 1.441293e-03 1 1  ON 34
eH1_5                 3.734840e-02 1 1  ON 35
eH1_6                 9.665955e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877782e-01 1 1  ON 38
eH1_9                 8.153166e-02 1 1  ON 39
eH2_0                -2.528835e-01 1 1  ON 40
eH2_1                -1.487447e-01 1 1  ON 41
eH2_2                -1.003113e-01 1 1  ON 42
eH2_3                -4.515752e-02 1 1  ON 43
eH2_4                 4.106190e-03 1 1  ON 44
eH2_5                 3.958882e-02 1 1  ON 45
eH2_6                 9.885948e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921718e-01 1 1  ON 48
eH2_9                 6.867259e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9428
    reference variance = 0.578525
====================================================
  Execution time = 2.0465e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6469e-01
  Total weights = 2.0000e+06
  Execution time = 1.8555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364460209655
                                         uncertainty =       0.021805215721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364460209655
                                         uncertainty =       0.021805215721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427017269
  error estimate for blocks of size 2^( 2) =       0.000439367793
  error estimate for blocks of size 2^( 3) =       0.000452587503
  error estimate for blocks of size 2^( 4) =       0.000464184950
  error estimate for blocks of size 2^( 5) =       0.000477566527
  error estimate for blocks of size 2^( 6) =       0.000484686876
  error estimate for blocks of size 2^( 7) =       0.000490485181

      target function =                  N/A
              le_mean =     -16.906000255454
             les_mean =     286.177531950794
             stat err =       0.000479230884
             autocorr =       1.259501586418
              std dev =       0.603893612913
             le_variance =       0.364687495718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364460216711
                                         uncertainty =       0.021805216788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364460216711
                                         uncertainty =       0.021805216788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427017273
  error estimate for blocks of size 2^( 2) =       0.000439367797
  error estimate for blocks of size 2^( 3) =       0.000452587507
  error estimate for blocks of size 2^( 4) =       0.000464184955
  error estimate for blocks of size 2^( 5) =       0.000477566532
  error estimate for blocks of size 2^( 6) =       0.000484686882
  error estimate for blocks of size 2^( 7) =       0.000490485186

      target function =                  N/A
              le_mean =     -16.906000255749
             les_mean =     286.177531967825
             stat err =       0.000479230889
             autocorr =       1.259501590311
              std dev =       0.603893618754
             le_variance =       0.364687502772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364460213182
                                         uncertainty =       0.021805216254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364460213182
                                         uncertainty =       0.021805216254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427017271
  error estimate for blocks of size 2^( 2) =       0.000439367795
  error estimate for blocks of size 2^( 3) =       0.000452587505
  error estimate for blocks of size 2^( 4) =       0.000464184953
  error estimate for blocks of size 2^( 5) =       0.000477566529
  error estimate for blocks of size 2^( 6) =       0.000484686879
  error estimate for blocks of size 2^( 7) =       0.000490485184

      target function =                  N/A
              le_mean =     -16.906000255602
             les_mean =     286.177531959308
             stat err =       0.000479230886
             autocorr =       1.259501588366
              std dev =       0.603893615833
             le_variance =       0.364687499244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364460210096
                                         uncertainty =       0.021805215788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364460210096
                                         uncertainty =       0.021805215788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427017269
  error estimate for blocks of size 2^( 2) =       0.000439367794
  error estimate for blocks of size 2^( 3) =       0.000452587503
  error estimate for blocks of size 2^( 4) =       0.000464184951
  error estimate for blocks of size 2^( 5) =       0.000477566527
  error estimate for blocks of size 2^( 6) =       0.000484686876
  error estimate for blocks of size 2^( 7) =       0.000490485181

      target function =                  N/A
              le_mean =     -16.906000255473
             les_mean =     286.177531951858
             stat err =       0.000479230884
             autocorr =       1.259501586658
              std dev =       0.603893613278
             le_variance =       0.364687496158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906000255454        initial
     2.4414e+03     2.4414e+04             7.8357e-08       -16.906000255749  <--
     9.7656e+03     9.7656e+04             1.9589e-08       -16.906000255602
     3.9062e+04     3.9062e+05             4.8973e-09       -16.906000255473

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 2.9815e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.119029e-01 1 1  ON 0
 uu_1                 1.447645e-01 1 1  ON 1
 uu_2                 4.283031e-02 1 1  ON 2
 uu_3                -2.009050e-02 1 1  ON 3
 uu_4                -6.622481e-02 1 1  ON 4
 uu_5                -1.019627e-01 1 1  ON 5
 uu_6                -1.301785e-01 1 1  ON 6
 uu_7                -1.447707e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510913e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413326e-02 1 1  ON 12
 ud_3                -7.494987e-03 1 1  ON 13
 ud_4                -6.508136e-02 1 1  ON 14
 ud_5                -1.070097e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565030e-01 1 1  ON 20
 eO_1                -4.349854e-01 1 1  ON 21
 eO_2                -1.830958e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267950e-01 1 1  ON 24
 eO_5                 4.897750e-01 1 1  ON 25
 eO_6                 2.601939e-01 1 1  ON 26
 eO_7                -4.207317e-02 1 1  ON 27
 eO_8                -2.288037e-01 1 1  ON 28
 eO_9                -9.350251e-02 1 1  ON 29
eH1_0                -2.560538e-01 1 1  ON 30
eH1_1                -1.520699e-01 1 1  ON 31
eH1_2                -1.036248e-01 1 1  ON 32
eH1_3                -4.830952e-02 1 1  ON 33
eH1_4                 1.441242e-03 1 1  ON 34
eH1_5                 3.734842e-02 1 1  ON 35
eH1_6                 9.665958e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877782e-01 1 1  ON 38
eH1_9                 8.153172e-02 1 1  ON 39
eH2_0                -2.528835e-01 1 1  ON 40
eH2_1                -1.487447e-01 1 1  ON 41
eH2_2                -1.003113e-01 1 1  ON 42
eH2_3                -4.515754e-02 1 1  ON 43
eH2_4                 4.106169e-03 1 1  ON 44
eH2_5                 3.958878e-02 1 1  ON 45
eH2_6                 9.885947e-02 1 1  ON 46
eH2_7                 1.592560e-01 1 1  ON 47
eH2_8                 1.921718e-01 1 1  ON 48
eH2_9                 6.867264e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6884e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8854
    reference variance = 0.224895
====================================================
  Execution time = 2.1003e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3682e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336859625644
                                         uncertainty =       0.003902782425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336859625644
                                         uncertainty =       0.003902782425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410378885
  error estimate for blocks of size 2^( 2) =       0.000423375871
  error estimate for blocks of size 2^( 3) =       0.000436146271
  error estimate for blocks of size 2^( 4) =       0.000448368638
  error estimate for blocks of size 2^( 5) =       0.000459421409
  error estimate for blocks of size 2^( 6) =       0.000466888379
  error estimate for blocks of size 2^( 7) =       0.000472284886

      target function =                  N/A
              le_mean =     -16.906807777002
             les_mean =     286.176970697991
             stat err =       0.000461740828
             autocorr =       1.265979116204
              std dev =       0.580363384354
             le_variance =       0.336821657899


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690680777700e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906807777002       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906807777058       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906807776605       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906807776740       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906807776677       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906807776713       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906807776745       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906807776832       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.319326e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906807777002       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906807777016       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906807776903       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906807776937       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906807776920       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906807776929       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906807776938       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906807776960       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 8.298607e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906807777002       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906807777006       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906807776977       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906807776986       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906807776982       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906807776991       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906807776987       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906807776994       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.074670e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210433 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6509e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.119029e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283035e-02 1 1  ON 2
 uu_3                -2.009051e-02 1 1  ON 3
 uu_4                -6.622480e-02 1 1  ON 4
 uu_5                -1.019626e-01 1 1  ON 5
 uu_6                -1.301785e-01 1 1  ON 6
 uu_7                -1.447707e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510913e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413326e-02 1 1  ON 12
 ud_3                -7.494967e-03 1 1  ON 13
 ud_4                -6.508131e-02 1 1  ON 14
 ud_5                -1.070097e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565030e-01 1 1  ON 20
 eO_1                -4.349854e-01 1 1  ON 21
 eO_2                -1.830964e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267950e-01 1 1  ON 24
 eO_5                 4.897750e-01 1 1  ON 25
 eO_6                 2.601940e-01 1 1  ON 26
 eO_7                -4.207314e-02 1 1  ON 27
 eO_8                -2.288038e-01 1 1  ON 28
 eO_9                -9.350256e-02 1 1  ON 29
eH1_0                -2.560539e-01 1 1  ON 30
eH1_1                -1.520699e-01 1 1  ON 31
eH1_2                -1.036248e-01 1 1  ON 32
eH1_3                -4.830953e-02 1 1  ON 33
eH1_4                 1.441216e-03 1 1  ON 34
eH1_5                 3.734839e-02 1 1  ON 35
eH1_6                 9.665954e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877782e-01 1 1  ON 38
eH1_9                 8.153179e-02 1 1  ON 39
eH2_0                -2.528835e-01 1 1  ON 40
eH2_1                -1.487447e-01 1 1  ON 41
eH2_2                -1.003114e-01 1 1  ON 42
eH2_3                -4.515754e-02 1 1  ON 43
eH2_4                 4.106176e-03 1 1  ON 44
eH2_5                 3.958877e-02 1 1  ON 45
eH2_6                 9.885949e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921719e-01 1 1  ON 48
eH2_9                 6.867273e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.896
    reference variance = 0.305858
====================================================
  Execution time = 2.0358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4291e-01
  Total weights = 2.0000e+06
  Execution time = 1.8650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342988602359
                                         uncertainty =       0.005731389891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342988602359
                                         uncertainty =       0.005731389891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414069018
  error estimate for blocks of size 2^( 2) =       0.000426498072
  error estimate for blocks of size 2^( 3) =       0.000438960767
  error estimate for blocks of size 2^( 4) =       0.000450590860
  error estimate for blocks of size 2^( 5) =       0.000459876097
  error estimate for blocks of size 2^( 6) =       0.000467354709
  error estimate for blocks of size 2^( 7) =       0.000471623329

      target function =                  N/A
              le_mean =     -16.906239470003
             les_mean =     286.163839149407
             stat err =       0.000462361249
             autocorr =       1.246859109431
              std dev =       0.585582021389
             le_variance =       0.342906303775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342988261465
                                         uncertainty =       0.005731381080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342988261465
                                         uncertainty =       0.005731381080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414068812
  error estimate for blocks of size 2^( 2) =       0.000426497874
  error estimate for blocks of size 2^( 3) =       0.000438960578
  error estimate for blocks of size 2^( 4) =       0.000450590679
  error estimate for blocks of size 2^( 5) =       0.000459875919
  error estimate for blocks of size 2^( 6) =       0.000467354533
  error estimate for blocks of size 2^( 7) =       0.000471623150

      target function =                  N/A
              le_mean =     -16.906239472655
             les_mean =     286.163838898279
             stat err =       0.000462361070
             autocorr =       1.246859386213
              std dev =       0.585581730385
             le_variance =       0.342905962961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342988431840
                                         uncertainty =       0.005731385484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342988431840
                                         uncertainty =       0.005731385484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414068915
  error estimate for blocks of size 2^( 2) =       0.000426497973
  error estimate for blocks of size 2^( 3) =       0.000438960672
  error estimate for blocks of size 2^( 4) =       0.000450590769
  error estimate for blocks of size 2^( 5) =       0.000459876008
  error estimate for blocks of size 2^( 6) =       0.000467354621
  error estimate for blocks of size 2^( 7) =       0.000471623240

      target function =                  N/A
              le_mean =     -16.906239471330
             les_mean =     286.163839023810
             stat err =       0.000462361159
             autocorr =       1.246859247882
              std dev =       0.585581875826
             le_variance =       0.342906133296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342988581042
                                         uncertainty =       0.005731389340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342988581042
                                         uncertainty =       0.005731389340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414069005
  error estimate for blocks of size 2^( 2) =       0.000426498059
  error estimate for blocks of size 2^( 3) =       0.000438960755
  error estimate for blocks of size 2^( 4) =       0.000450590848
  error estimate for blocks of size 2^( 5) =       0.000459876086
  error estimate for blocks of size 2^( 6) =       0.000467354698
  error estimate for blocks of size 2^( 7) =       0.000471623318

      target function =                  N/A
              le_mean =     -16.906239470169
             les_mean =     286.163839133706
             stat err =       0.000462361238
             autocorr =       1.246859126746
              std dev =       0.585582003192
             le_variance =       0.342906282462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906239470003        initial
     6.1035e+02     6.1035e+03             3.3193e-07       -16.906239472655  <--
     2.4414e+03     2.4414e+04             8.2986e-08       -16.906239471330
     9.7656e+03     9.7656e+04             2.0747e-08       -16.906239470169

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.9754e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.119026e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009057e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494908e-03 1 1  ON 13
 ud_4                -6.508118e-02 1 1  ON 14
 ud_5                -1.070097e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350271e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734828e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153202e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106200e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885953e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867298e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8937
    reference variance = 0.313256
====================================================
  Execution time = 2.0606e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4809e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348098926140
                                         uncertainty =       0.010846990818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348098926140
                                         uncertainty =       0.010846990818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417189405
  error estimate for blocks of size 2^( 2) =       0.000430463206
  error estimate for blocks of size 2^( 3) =       0.000443343562
  error estimate for blocks of size 2^( 4) =       0.000455352872
  error estimate for blocks of size 2^( 5) =       0.000465742323
  error estimate for blocks of size 2^( 6) =       0.000472694077
  error estimate for blocks of size 2^( 7) =       0.000476380467

      target function =                  N/A
              le_mean =     -16.905545932668
             les_mean =     286.145577107251
             stat err =       0.000467542435
             autocorr =       1.255959185745
              std dev =       0.589994915013
             le_variance =       0.348093999741


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690554593267e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905545932668       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905545936984       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905545934660       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905545933723       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905545938703       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905545939622       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905545941147       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905545941811       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.766819e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905545932668       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905545933748       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905545933167       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905545932932       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905545934177       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905545934405       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905545934787       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905545934955       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.417546e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905545932668       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905545932938       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905545932793       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905545932735       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905545933046       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905545933100       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905545933199       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905545933239       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.104418e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6169e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.119028e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283033e-02 1 1  ON 2
 uu_3                -2.009071e-02 1 1  ON 3
 uu_4                -6.622489e-02 1 1  ON 4
 uu_5                -1.019624e-01 1 1  ON 5
 uu_6                -1.301785e-01 1 1  ON 6
 uu_7                -1.447709e-01 1 1  ON 7
 uu_8                -1.378459e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510912e-01 1 1  ON 10
 ud_1                 1.849191e-01 1 1  ON 11
 ud_2                 6.413334e-02 1 1  ON 12
 ud_3                -7.494806e-03 1 1  ON 13
 ud_4                -6.508130e-02 1 1  ON 14
 ud_5                -1.070097e-01 1 1  ON 15
 ud_6                -1.351382e-01 1 1  ON 16
 ud_7                -1.519487e-01 1 1  ON 17
 ud_8                -1.530501e-01 1 1  ON 18
 ud_9                -1.416736e-01 1 1  ON 19
 eO_0                -7.565028e-01 1 1  ON 20
 eO_1                -4.349853e-01 1 1  ON 21
 eO_2                -1.830967e-02 1 1  ON 22
 eO_3                 2.998818e-01 1 1  ON 23
 eO_4                 5.267950e-01 1 1  ON 24
 eO_5                 4.897752e-01 1 1  ON 25
 eO_6                 2.601943e-01 1 1  ON 26
 eO_7                -4.207309e-02 1 1  ON 27
 eO_8                -2.288042e-01 1 1  ON 28
 eO_9                -9.350290e-02 1 1  ON 29
eH1_0                -2.560543e-01 1 1  ON 30
eH1_1                -1.520703e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830954e-02 1 1  ON 33
eH1_4                 1.441045e-03 1 1  ON 34
eH1_5                 3.734820e-02 1 1  ON 35
eH1_6                 9.665961e-02 1 1  ON 36
eH1_7                 1.560750e-01 1 1  ON 37
eH1_8                 1.877786e-01 1 1  ON 38
eH1_9                 8.153225e-02 1 1  ON 39
eH2_0                -2.528839e-01 1 1  ON 40
eH2_1                -1.487449e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515779e-02 1 1  ON 43
eH2_4                 4.106161e-03 1 1  ON 44
eH2_5                 3.958857e-02 1 1  ON 45
eH2_6                 9.885954e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921722e-01 1 1  ON 48
eH2_9                 6.867342e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.7932
    reference variance = 0.741234
====================================================
  Execution time = 2.0287e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4436e-01
  Total weights = 2.0000e+06
  Execution time = 1.8653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344421152351
                                         uncertainty =       0.005728988396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344421152351
                                         uncertainty =       0.005728988396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414943227
  error estimate for blocks of size 2^( 2) =       0.000427575256
  error estimate for blocks of size 2^( 3) =       0.000440694092
  error estimate for blocks of size 2^( 4) =       0.000453862678
  error estimate for blocks of size 2^( 5) =       0.000465162171
  error estimate for blocks of size 2^( 6) =       0.000473211610
  error estimate for blocks of size 2^( 7) =       0.000478756025

      target function =                  N/A
              le_mean =     -16.906446115775
             les_mean =     286.172275856244
             stat err =       0.000467748121
             autocorr =       1.270710865430
              std dev =       0.586818338860
             le_variance =       0.344355762823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344421476899
                                         uncertainty =       0.005728999529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344421476899
                                         uncertainty =       0.005728999529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414943422
  error estimate for blocks of size 2^( 2) =       0.000427575439
  error estimate for blocks of size 2^( 3) =       0.000440694268
  error estimate for blocks of size 2^( 4) =       0.000453862859
  error estimate for blocks of size 2^( 5) =       0.000465162371
  error estimate for blocks of size 2^( 6) =       0.000473211846
  error estimate for blocks of size 2^( 7) =       0.000478756265

      target function =                  N/A
              le_mean =     -16.906446106050
             les_mean =     286.172275852231
             stat err =       0.000467748335
             autocorr =       1.270710831416
              std dev =       0.586818615627
             le_variance =       0.344356087647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344421314965
                                         uncertainty =       0.005728993970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344421314965
                                         uncertainty =       0.005728993970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414943325
  error estimate for blocks of size 2^( 2) =       0.000427575348
  error estimate for blocks of size 2^( 3) =       0.000440694180
  error estimate for blocks of size 2^( 4) =       0.000453862769
  error estimate for blocks of size 2^( 5) =       0.000465162271
  error estimate for blocks of size 2^( 6) =       0.000473211728
  error estimate for blocks of size 2^( 7) =       0.000478756146

      target function =                  N/A
              le_mean =     -16.906446110897
             les_mean =     286.172275854059
             stat err =       0.000467748228
             autocorr =       1.270710848331
              std dev =       0.586818477534
             le_variance =       0.344355925575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344421172687
                                         uncertainty =       0.005728989093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344421172687
                                         uncertainty =       0.005728989093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414943239
  error estimate for blocks of size 2^( 2) =       0.000427575268
  error estimate for blocks of size 2^( 3) =       0.000440694103
  error estimate for blocks of size 2^( 4) =       0.000453862689
  error estimate for blocks of size 2^( 5) =       0.000465162183
  error estimate for blocks of size 2^( 6) =       0.000473211625
  error estimate for blocks of size 2^( 7) =       0.000478756040

      target function =                  N/A
              le_mean =     -16.906446115164
             les_mean =     286.172275855959
             stat err =       0.000467748134
             autocorr =       1.270710863287
              std dev =       0.586818356203
             le_variance =       0.344355783176


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906446115775        initial  <--
     1.5259e+02     1.5259e+03             1.7668e-06       -16.906446106050
     6.1035e+02     6.1035e+03             4.4175e-07       -16.906446110897
     2.4414e+03     2.4414e+04             1.1044e-07       -16.906446115164

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7122
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.119026e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009057e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494908e-03 1 1  ON 13
 ud_4                -6.508118e-02 1 1  ON 14
 ud_5                -1.070097e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350271e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734828e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153202e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106200e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885953e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867298e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5888e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6882e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8832
    reference variance = 0.368409
====================================================
  Execution time = 2.0808e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3655e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336582698691
                                         uncertainty =       0.003012832679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336582698691
                                         uncertainty =       0.003012832679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410214318
  error estimate for blocks of size 2^( 2) =       0.000422978838
  error estimate for blocks of size 2^( 3) =       0.000435870847
  error estimate for blocks of size 2^( 4) =       0.000447954281
  error estimate for blocks of size 2^( 5) =       0.000458390670
  error estimate for blocks of size 2^( 6) =       0.000465930510
  error estimate for blocks of size 2^( 7) =       0.000472385815

      target function =                  N/A
              le_mean =     -16.906027009029
             les_mean =     286.150300635815
             stat err =       0.000461165319
             autocorr =       1.263838698455
              std dev =       0.580130652600
             le_variance =       0.336551574086


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602700903e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027009029       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027009177       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906027009144       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027009137       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906027009192       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027009185       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906027009209       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.357680e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027009029       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027009066       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906027009058       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027009055       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906027009068       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027009067       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906027009079       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.394589e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027009029       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027009038       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906027009036       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027009043       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906027009039       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027009069       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906027009045       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 8.486714e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6350e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283047e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622480e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413326e-02 1 1  ON 12
 ud_3                -7.494911e-03 1 1  ON 13
 ud_4                -6.508118e-02 1 1  ON 14
 ud_5                -1.070097e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207304e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350274e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441115e-03 1 1  ON 34
eH1_5                 3.734828e-02 1 1  ON 35
eH1_6                 9.665944e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153205e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515756e-02 1 1  ON 43
eH2_4                 4.106198e-03 1 1  ON 44
eH2_5                 3.958871e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.854
    reference variance = 0.250718
====================================================
  Execution time = 2.0281e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4305e-01
  Total weights = 2.0000e+06
  Execution time = 1.8630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057644038
                                         uncertainty =       0.006134070911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057644038
                                         uncertainty =       0.006134070911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414153720
  error estimate for blocks of size 2^( 2) =       0.000426633129
  error estimate for blocks of size 2^( 3) =       0.000439704539
  error estimate for blocks of size 2^( 4) =       0.000451795938
  error estimate for blocks of size 2^( 5) =       0.000463272981
  error estimate for blocks of size 2^( 6) =       0.000472269537
  error estimate for blocks of size 2^( 7) =       0.000481040909

      target function =                  N/A
              le_mean =     -16.905659826603
             les_mean =     286.144380608795
             stat err =       0.000467094841
             autocorr =       1.271999699788
              std dev =       0.585701807668
             le_variance =       0.343046607505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057716341
                                         uncertainty =       0.006134072476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057716341
                                         uncertainty =       0.006134072476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414153764
  error estimate for blocks of size 2^( 2) =       0.000426633170
  error estimate for blocks of size 2^( 3) =       0.000439704579
  error estimate for blocks of size 2^( 4) =       0.000451795977
  error estimate for blocks of size 2^( 5) =       0.000463273019
  error estimate for blocks of size 2^( 6) =       0.000472269574
  error estimate for blocks of size 2^( 7) =       0.000481040947

      target function =                  N/A
              le_mean =     -16.905659826433
             les_mean =     286.144380675329
             stat err =       0.000467094879
             autocorr =       1.271999637546
              std dev =       0.585701869362
             le_variance =       0.343046679774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057680197
                                         uncertainty =       0.006134071694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057680197
                                         uncertainty =       0.006134071694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414153742
  error estimate for blocks of size 2^( 2) =       0.000426633149
  error estimate for blocks of size 2^( 3) =       0.000439704559
  error estimate for blocks of size 2^( 4) =       0.000451795958
  error estimate for blocks of size 2^( 5) =       0.000463273000
  error estimate for blocks of size 2^( 6) =       0.000472269555
  error estimate for blocks of size 2^( 7) =       0.000481040928

      target function =                  N/A
              le_mean =     -16.905659826518
             les_mean =     286.144380642070
             stat err =       0.000467094860
             autocorr =       1.271999668665
              std dev =       0.585701838521
             le_variance =       0.343046643647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057648558
                                         uncertainty =       0.006134071009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343057648558
                                         uncertainty =       0.006134071009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414153723
  error estimate for blocks of size 2^( 2) =       0.000426633131
  error estimate for blocks of size 2^( 3) =       0.000439704542
  error estimate for blocks of size 2^( 4) =       0.000451795941
  error estimate for blocks of size 2^( 5) =       0.000463272984
  error estimate for blocks of size 2^( 6) =       0.000472269539
  error estimate for blocks of size 2^( 7) =       0.000481040912

      target function =                  N/A
              le_mean =     -16.905659826592
             les_mean =     286.144380612955
             stat err =       0.000467094844
             autocorr =       1.271999695881
              std dev =       0.585701811525
             le_variance =       0.343046612023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905659826603        initial  <--
     1.5259e+03     1.5259e+04             1.3577e-07       -16.905659826433
     6.1035e+03     6.1035e+04             3.3946e-08       -16.905659826518
     2.4414e+04     2.4414e+05             8.4867e-09       -16.905659826592

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6646
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.119026e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009057e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494908e-03 1 1  ON 13
 ud_4                -6.508118e-02 1 1  ON 14
 ud_5                -1.070097e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350271e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734828e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560748e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153202e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106200e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885953e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867298e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6881e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9097
    reference variance = 0.379455
====================================================
  Execution time = 2.0834e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3410e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334151781272
                                         uncertainty =       0.002781482885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334151781272
                                         uncertainty =       0.002781482885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408720063
  error estimate for blocks of size 2^( 2) =       0.000420810932
  error estimate for blocks of size 2^( 3) =       0.000433604987
  error estimate for blocks of size 2^( 4) =       0.000445414030
  error estimate for blocks of size 2^( 5) =       0.000455739636
  error estimate for blocks of size 2^( 6) =       0.000463702108
  error estimate for blocks of size 2^( 7) =       0.000468714001

      target function =                  N/A
              le_mean =     -16.906085205803
             les_mean =     286.149820997908
             stat err =       0.000458392444
             autocorr =       1.257833009819
              std dev =       0.578017455698
             le_variance =       0.334104179092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608520580e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906085205803       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906085205820       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906085205815       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906085205815       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906085205820       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906085205846       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906085205841       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906085205818       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.621833e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906085205803       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906085205807       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906085205806       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906085205796       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906085205855       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906085205750       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906085205791       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906085205758       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 4.054605e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906085205803       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906085205804       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906085205804       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906085205982       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906085205810       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906085205720       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906085205853       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906085205765       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.013652e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6435e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.119026e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009057e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494907e-03 1 1  ON 13
 ud_4                -6.508118e-02 1 1  ON 14
 ud_5                -1.070097e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350272e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734828e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153202e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106200e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867298e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9316
    reference variance = 0.287171
====================================================
  Execution time = 2.0561e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3964e-01
  Total weights = 2.0000e+06
  Execution time = 1.8663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339680942941
                                         uncertainty =       0.004196624420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339680942941
                                         uncertainty =       0.004196624420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412093960
  error estimate for blocks of size 2^( 2) =       0.000424487983
  error estimate for blocks of size 2^( 3) =       0.000437099300
  error estimate for blocks of size 2^( 4) =       0.000449968294
  error estimate for blocks of size 2^( 5) =       0.000460530517
  error estimate for blocks of size 2^( 6) =       0.000466002903
  error estimate for blocks of size 2^( 7) =       0.000471127218

      target function =                  N/A
              le_mean =     -16.906981514983
             les_mean =     286.185666642665
             stat err =       0.000461907233
             autocorr =       1.256368464536
              std dev =       0.582788867870
             le_variance =       0.339642864513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339680940294
                                         uncertainty =       0.004196624461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339680940294
                                         uncertainty =       0.004196624461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412093959
  error estimate for blocks of size 2^( 2) =       0.000424487981
  error estimate for blocks of size 2^( 3) =       0.000437099299
  error estimate for blocks of size 2^( 4) =       0.000449968293
  error estimate for blocks of size 2^( 5) =       0.000460530516
  error estimate for blocks of size 2^( 6) =       0.000466002902
  error estimate for blocks of size 2^( 7) =       0.000471127217

      target function =                  N/A
              le_mean =     -16.906981515083
             les_mean =     286.185666643415
             stat err =       0.000461907232
             autocorr =       1.256368469517
              std dev =       0.582788865597
             le_variance =       0.339642861864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339680941617
                                         uncertainty =       0.004196624441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339680941617
                                         uncertainty =       0.004196624441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412093960
  error estimate for blocks of size 2^( 2) =       0.000424487982
  error estimate for blocks of size 2^( 3) =       0.000437099300
  error estimate for blocks of size 2^( 4) =       0.000449968294
  error estimate for blocks of size 2^( 5) =       0.000460530517
  error estimate for blocks of size 2^( 6) =       0.000466002903
  error estimate for blocks of size 2^( 7) =       0.000471127218

      target function =                  N/A
              le_mean =     -16.906981515033
             les_mean =     286.185666643040
             stat err =       0.000461907233
             autocorr =       1.256368467026
              std dev =       0.582788866733
             le_variance =       0.339642863188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339680942775
                                         uncertainty =       0.004196624423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339680942775
                                         uncertainty =       0.004196624423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412093960
  error estimate for blocks of size 2^( 2) =       0.000424487983
  error estimate for blocks of size 2^( 3) =       0.000437099300
  error estimate for blocks of size 2^( 4) =       0.000449968294
  error estimate for blocks of size 2^( 5) =       0.000460530517
  error estimate for blocks of size 2^( 6) =       0.000466002903
  error estimate for blocks of size 2^( 7) =       0.000471127218

      target function =                  N/A
              le_mean =     -16.906981514989
             les_mean =     286.185666642712
             stat err =       0.000461907233
             autocorr =       1.256368464843
              std dev =       0.582788867728
             le_variance =       0.339642864348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906981514983        initial
     1.5259e+04     1.5259e+05             1.6218e-08       -16.906981515083  <--
     6.1035e+04     6.1035e+05             4.0546e-09       -16.906981515033
     2.4414e+05     2.4414e+06             1.0137e-09       -16.906981514989

*****************************************************************************
Applying the update for shift_i =   1.5259e+04     and shift_s =   1.5259e+05
*****************************************************************************

  Execution time = 3.3356e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494905e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350272e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441135e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6884e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9408
    reference variance = 0.21349
====================================================
  Execution time = 2.0887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3967e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339725178640
                                         uncertainty =       0.004049952499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339725178640
                                         uncertainty =       0.004049952499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412111605
  error estimate for blocks of size 2^( 2) =       0.000424364382
  error estimate for blocks of size 2^( 3) =       0.000436406417
  error estimate for blocks of size 2^( 4) =       0.000448039628
  error estimate for blocks of size 2^( 5) =       0.000457953498
  error estimate for blocks of size 2^( 6) =       0.000464664265
  error estimate for blocks of size 2^( 7) =       0.000467044625

      target function =                  N/A
              le_mean =     -16.906591203418
             les_mean =     286.172497900241
             stat err =       0.000459425504
             autocorr =       1.242797902168
              std dev =       0.582813821548
             le_variance =       0.339671950587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690659120342e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906591203418       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906591203396       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906591203481       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906591203439       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906591203471       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906591203641       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906591203648       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906591203609       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 5.727074e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906591203418       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906591203413       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906591203434       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906591203424       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906591203431       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906591203465       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906591203484       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906591203471       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.431904e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906591203418       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906591203417       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906591203422       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906591203418       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906591203469       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906591203461       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906591203443       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906591203456       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.579846e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220536 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6526e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.119026e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494899e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830980e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441132e-03 1 1  ON 34
eH1_5                 3.734826e-02 1 1  ON 35
eH1_6                 9.665942e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153204e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106204e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885953e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867300e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9405
    reference variance = 0.244667
====================================================
  Execution time = 2.0385e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5950e-01
  Total weights = 2.0000e+06
  Execution time = 1.8593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359623999548
                                         uncertainty =       0.025122441522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359623999548
                                         uncertainty =       0.025122441522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423969528
  error estimate for blocks of size 2^( 2) =       0.000436822649
  error estimate for blocks of size 2^( 3) =       0.000449944329
  error estimate for blocks of size 2^( 4) =       0.000461347804
  error estimate for blocks of size 2^( 5) =       0.000471022981
  error estimate for blocks of size 2^( 6) =       0.000480010763
  error estimate for blocks of size 2^( 7) =       0.000487109428

      target function =                  N/A
              le_mean =     -16.905915506546
             les_mean =     286.169479255767
             stat err =       0.000474872744
             autocorr =       1.254541983450
              std dev =       0.599583456272
             le_variance =       0.359500321035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359623961037
                                         uncertainty =       0.025122441471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359623961037
                                         uncertainty =       0.025122441471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423969505
  error estimate for blocks of size 2^( 2) =       0.000436822626
  error estimate for blocks of size 2^( 3) =       0.000449944307
  error estimate for blocks of size 2^( 4) =       0.000461347782
  error estimate for blocks of size 2^( 5) =       0.000471022960
  error estimate for blocks of size 2^( 6) =       0.000480010743
  error estimate for blocks of size 2^( 7) =       0.000487109408

      target function =                  N/A
              le_mean =     -16.905915506118
             les_mean =     286.169479202814
             stat err =       0.000474872723
             autocorr =       1.254542008020
              std dev =       0.599583424185
             le_variance =       0.359500282558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359623980291
                                         uncertainty =       0.025122441496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359623980291
                                         uncertainty =       0.025122441496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423969516
  error estimate for blocks of size 2^( 2) =       0.000436822637
  error estimate for blocks of size 2^( 3) =       0.000449944318
  error estimate for blocks of size 2^( 4) =       0.000461347793
  error estimate for blocks of size 2^( 5) =       0.000471022970
  error estimate for blocks of size 2^( 6) =       0.000480010753
  error estimate for blocks of size 2^( 7) =       0.000487109418

      target function =                  N/A
              le_mean =     -16.905915506332
             les_mean =     286.169479229288
             stat err =       0.000474872734
             autocorr =       1.254541995745
              std dev =       0.599583440227
             le_variance =       0.359500301794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359623997141
                                         uncertainty =       0.025122441519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359623997141
                                         uncertainty =       0.025122441519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423969526
  error estimate for blocks of size 2^( 2) =       0.000436822647
  error estimate for blocks of size 2^( 3) =       0.000449944328
  error estimate for blocks of size 2^( 4) =       0.000461347803
  error estimate for blocks of size 2^( 5) =       0.000471022980
  error estimate for blocks of size 2^( 6) =       0.000480010762
  error estimate for blocks of size 2^( 7) =       0.000487109426

      target function =                  N/A
              le_mean =     -16.905915506520
             les_mean =     286.169479252457
             stat err =       0.000474872743
             autocorr =       1.254541984984
              std dev =       0.599583454266
             le_variance =       0.359500318630


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905915506546        initial  <--
     3.8147e+03     3.8147e+04             5.7271e-08       -16.905915506118
     1.5259e+04     1.5259e+05             1.4319e-08       -16.905915506332
     6.1035e+04     6.1035e+05             3.5798e-09       -16.905915506520

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7973
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494905e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350272e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441135e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6332e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8975
    reference variance = 0.297252
====================================================
  Execution time = 2.1064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.8363e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.383639346142
                                         uncertainty =       0.044215273466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.383639346142
                                         uncertainty =       0.044215273466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000437964410
  error estimate for blocks of size 2^( 2) =       0.000449935281
  error estimate for blocks of size 2^( 3) =       0.000461578034
  error estimate for blocks of size 2^( 4) =       0.000472537994
  error estimate for blocks of size 2^( 5) =       0.000481473556
  error estimate for blocks of size 2^( 6) =       0.000487324455
  error estimate for blocks of size 2^( 7) =       0.000489352411

      target function =                  N/A
              le_mean =     -16.906799045479
             les_mean =     286.223479421014
             stat err =       0.000482672104
             autocorr =       1.214581771228
              std dev =       0.619375208257
             le_variance =       0.383625648604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690679904548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906799045479       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906799045485       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906799045490       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906799045489       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906799045497       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906799045469       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906799045441       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906799045546       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.466874e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906799045479       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906799045481       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906799045482       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906799045581       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906799045484       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906799045556       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906799045495       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906799045478       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.366719e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906799045479       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906799045480       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906799045480       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906799045402       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906799045489       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906799045333       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906799045550       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906799045316       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.416799e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6596e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494904e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350272e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441135e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9085
    reference variance = 0.149939
====================================================
  Execution time = 2.0535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4372e-01
  Total weights = 2.0000e+06
  Execution time = 1.8618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665799103
                                         uncertainty =       0.003362286428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665799103
                                         uncertainty =       0.003362286428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414560462
  error estimate for blocks of size 2^( 2) =       0.000427572007
  error estimate for blocks of size 2^( 3) =       0.000440854814
  error estimate for blocks of size 2^( 4) =       0.000453490638
  error estimate for blocks of size 2^( 5) =       0.000464191869
  error estimate for blocks of size 2^( 6) =       0.000472714833
  error estimate for blocks of size 2^( 7) =       0.000479803388

      target function =                  N/A
              le_mean =     -16.906339653809
             les_mean =     286.168041071575
             stat err =       0.000467550182
             autocorr =       1.271981225706
              std dev =       0.586277027935
             le_variance =       0.343720753484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665797761
                                         uncertainty =       0.003362286405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665797761
                                         uncertainty =       0.003362286405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414560461
  error estimate for blocks of size 2^( 2) =       0.000427572006
  error estimate for blocks of size 2^( 3) =       0.000440854813
  error estimate for blocks of size 2^( 4) =       0.000453490638
  error estimate for blocks of size 2^( 5) =       0.000464191868
  error estimate for blocks of size 2^( 6) =       0.000472714832
  error estimate for blocks of size 2^( 7) =       0.000479803387

      target function =                  N/A
              le_mean =     -16.906339653820
             les_mean =     286.168041070611
             stat err =       0.000467550181
             autocorr =       1.271981226714
              std dev =       0.586277026790
             le_variance =       0.343720752142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665798432
                                         uncertainty =       0.003362286417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665798432
                                         uncertainty =       0.003362286417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414560462
  error estimate for blocks of size 2^( 2) =       0.000427572006
  error estimate for blocks of size 2^( 3) =       0.000440854813
  error estimate for blocks of size 2^( 4) =       0.000453490638
  error estimate for blocks of size 2^( 5) =       0.000464191868
  error estimate for blocks of size 2^( 6) =       0.000472714832
  error estimate for blocks of size 2^( 7) =       0.000479803388

      target function =                  N/A
              le_mean =     -16.906339653814
             les_mean =     286.168041071093
             stat err =       0.000467550182
             autocorr =       1.271981226203
              std dev =       0.586277027363
             le_variance =       0.343720752813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665799019
                                         uncertainty =       0.003362286427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665799019
                                         uncertainty =       0.003362286427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414560462
  error estimate for blocks of size 2^( 2) =       0.000427572007
  error estimate for blocks of size 2^( 3) =       0.000440854814
  error estimate for blocks of size 2^( 4) =       0.000453490638
  error estimate for blocks of size 2^( 5) =       0.000464191869
  error estimate for blocks of size 2^( 6) =       0.000472714833
  error estimate for blocks of size 2^( 7) =       0.000479803388

      target function =                  N/A
              le_mean =     -16.906339653810
             les_mean =     286.168041071515
             stat err =       0.000467550182
             autocorr =       1.271981225766
              std dev =       0.586277027864
             le_variance =       0.343720753401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906339653809        initial
     3.8147e+04     3.8147e+05             5.4669e-09       -16.906339653820  <--
     1.5259e+05     1.5259e+06             1.3667e-09       -16.906339653814
     6.1035e+05     6.1035e+06             3.4168e-10       -16.906339653810

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 2.9931e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9355
    reference variance = 0.162836
====================================================
  Execution time = 2.0739e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3767e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337630860292
                                         uncertainty =       0.002869833883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337630860292
                                         uncertainty =       0.002869833883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410892513
  error estimate for blocks of size 2^( 2) =       0.000423472868
  error estimate for blocks of size 2^( 3) =       0.000436059404
  error estimate for blocks of size 2^( 4) =       0.000447892738
  error estimate for blocks of size 2^( 5) =       0.000458850271
  error estimate for blocks of size 2^( 6) =       0.000466323891
  error estimate for blocks of size 2^( 7) =       0.000471956910

      target function =                  N/A
              le_mean =     -16.906923300720
             les_mean =     286.181720642835
             stat err =       0.000461255953
             autocorr =       1.260165283125
              std dev =       0.581089765216
             le_variance =       0.337665315239


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690692330072e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906923300720       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906923300760       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906923300815       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906923300878       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906923300868       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906923300857       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906923300871       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.101296e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906923300720       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906923300730       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906923300744       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906923300759       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906923300754       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906923300739       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906923300755       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.253258e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906923300720       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906923300723       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906923300726       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906923300730       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906923300728       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906923300741       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906923300184       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.313315e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225339 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6478e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413328e-02 1 1  ON 12
 ud_3                -7.494900e-03 1 1  ON 13
 ud_4                -6.508116e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441134e-03 1 1  ON 34
eH1_5                 3.734826e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153204e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106197e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867300e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.844
    reference variance = 0.244894
====================================================
  Execution time = 2.0496e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3044e-01
  Total weights = 2.0000e+06
  Execution time = 1.8652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330513962144
                                         uncertainty =       0.002966254624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330513962144
                                         uncertainty =       0.002966254624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406472575
  error estimate for blocks of size 2^( 2) =       0.000418824110
  error estimate for blocks of size 2^( 3) =       0.000432021499
  error estimate for blocks of size 2^( 4) =       0.000444264317
  error estimate for blocks of size 2^( 5) =       0.000453930067
  error estimate for blocks of size 2^( 6) =       0.000460087523
  error estimate for blocks of size 2^( 7) =       0.000468073153

      target function =                  N/A
              le_mean =     -16.906121139217
             les_mean =     286.147371717320
             stat err =       0.000456588765
             autocorr =       1.261792505828
              std dev =       0.574839028487
             le_variance =       0.330439908672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330513950841
                                         uncertainty =       0.002966254570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330513950841
                                         uncertainty =       0.002966254570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406472568
  error estimate for blocks of size 2^( 2) =       0.000418824103
  error estimate for blocks of size 2^( 3) =       0.000432021493
  error estimate for blocks of size 2^( 4) =       0.000444264311
  error estimate for blocks of size 2^( 5) =       0.000453930061
  error estimate for blocks of size 2^( 6) =       0.000460087517
  error estimate for blocks of size 2^( 7) =       0.000468073147

      target function =                  N/A
              le_mean =     -16.906121139191
             les_mean =     286.147371705170
             stat err =       0.000456588759
             autocorr =       1.261792515706
              std dev =       0.574839018665
             le_variance =       0.330439897380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330513956492
                                         uncertainty =       0.002966254597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330513956492
                                         uncertainty =       0.002966254597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406472572
  error estimate for blocks of size 2^( 2) =       0.000418824107
  error estimate for blocks of size 2^( 3) =       0.000432021496
  error estimate for blocks of size 2^( 4) =       0.000444264314
  error estimate for blocks of size 2^( 5) =       0.000453930064
  error estimate for blocks of size 2^( 6) =       0.000460087520
  error estimate for blocks of size 2^( 7) =       0.000468073150

      target function =                  N/A
              le_mean =     -16.906121139204
             les_mean =     286.147371711245
             stat err =       0.000456588762
             autocorr =       1.261792510769
              std dev =       0.574839023576
             le_variance =       0.330439903026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330513961437
                                         uncertainty =       0.002966254621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330513961437
                                         uncertainty =       0.002966254621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406472575
  error estimate for blocks of size 2^( 2) =       0.000418824109
  error estimate for blocks of size 2^( 3) =       0.000432021499
  error estimate for blocks of size 2^( 4) =       0.000444264317
  error estimate for blocks of size 2^( 5) =       0.000453930066
  error estimate for blocks of size 2^( 6) =       0.000460087522
  error estimate for blocks of size 2^( 7) =       0.000468073152

      target function =                  N/A
              le_mean =     -16.906121139215
             les_mean =     286.147371716560
             stat err =       0.000456588764
             autocorr =       1.261792506439
              std dev =       0.574839027873
             le_variance =       0.330439907966


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906121139217        initial  <--
     9.5367e+03     9.5367e+04             2.1013e-08       -16.906121139191
     3.8147e+04     3.8147e+05             5.2533e-09       -16.906121139204
     1.5259e+05     1.5259e+06             1.3133e-09       -16.906121139215

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8886
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6373e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8841
    reference variance = 0.415165
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4913e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349203668213
                                         uncertainty =       0.006218715665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349203668213
                                         uncertainty =       0.006218715665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417807666
  error estimate for blocks of size 2^( 2) =       0.000430504914
  error estimate for blocks of size 2^( 3) =       0.000443576091
  error estimate for blocks of size 2^( 4) =       0.000455872693
  error estimate for blocks of size 2^( 5) =       0.000466658916
  error estimate for blocks of size 2^( 6) =       0.000476683249
  error estimate for blocks of size 2^( 7) =       0.000482589531

      target function =                  N/A
              le_mean =     -16.905984751806
             les_mean =     286.161446744509
             stat err =       0.000470451097
             autocorr =       1.267874199035
              std dev =       0.590869267080
             le_variance =       0.349126490780


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598475181e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905984751806       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905984751805       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905984751802       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905984751800       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905984751813       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905984751787       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905984751813       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905984751818       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.505395e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905984751806       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905984751806       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905984751805       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905984751836       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905984751794       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905984751449       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905984752081       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905984752004       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 6.263489e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905984751806       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905984751806       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905984751806       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905984751863       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905984753059       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905984751833       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905984749693       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905984752113       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.565872e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6083e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9038
    reference variance = 0.211732
====================================================
  Execution time = 2.0889e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5356e-01
  Total weights = 2.0000e+06
  Execution time = 1.8735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353527395378
                                         uncertainty =       0.010076063037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353527395378
                                         uncertainty =       0.010076063037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420449834
  error estimate for blocks of size 2^( 2) =       0.000432983794
  error estimate for blocks of size 2^( 3) =       0.000445965000
  error estimate for blocks of size 2^( 4) =       0.000458748957
  error estimate for blocks of size 2^( 5) =       0.000469144573
  error estimate for blocks of size 2^( 6) =       0.000477554739
  error estimate for blocks of size 2^( 7) =       0.000482930878

      target function =                  N/A
              le_mean =     -16.906109160516
             les_mean =     286.170082895556
             stat err =       0.000472094787
             autocorr =       1.260753084131
              std dev =       0.594605856889
             le_variance =       0.353556125047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353527394494
                                         uncertainty =       0.010076063038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353527394494
                                         uncertainty =       0.010076063038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420449833
  error estimate for blocks of size 2^( 2) =       0.000432983794
  error estimate for blocks of size 2^( 3) =       0.000445964999
  error estimate for blocks of size 2^( 4) =       0.000458748957
  error estimate for blocks of size 2^( 5) =       0.000469144573
  error estimate for blocks of size 2^( 6) =       0.000477554738
  error estimate for blocks of size 2^( 7) =       0.000482930877

      target function =                  N/A
              le_mean =     -16.906109160512
             les_mean =     286.170082894540
             stat err =       0.000472094786
             autocorr =       1.260753084603
              std dev =       0.594605856145
             le_variance =       0.353556124162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353527394936
                                         uncertainty =       0.010076063037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353527394936
                                         uncertainty =       0.010076063037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420449833
  error estimate for blocks of size 2^( 2) =       0.000432983794
  error estimate for blocks of size 2^( 3) =       0.000445965000
  error estimate for blocks of size 2^( 4) =       0.000458748957
  error estimate for blocks of size 2^( 5) =       0.000469144573
  error estimate for blocks of size 2^( 6) =       0.000477554738
  error estimate for blocks of size 2^( 7) =       0.000482930877

      target function =                  N/A
              le_mean =     -16.906109160514
             les_mean =     286.170082895048
             stat err =       0.000472094786
             autocorr =       1.260753084373
              std dev =       0.594605856517
             le_variance =       0.353556124605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353527395323
                                         uncertainty =       0.010076063037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353527395323
                                         uncertainty =       0.010076063037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420449834
  error estimate for blocks of size 2^( 2) =       0.000432983794
  error estimate for blocks of size 2^( 3) =       0.000445965000
  error estimate for blocks of size 2^( 4) =       0.000458748957
  error estimate for blocks of size 2^( 5) =       0.000469144573
  error estimate for blocks of size 2^( 6) =       0.000477554738
  error estimate for blocks of size 2^( 7) =       0.000482930878

      target function =                  N/A
              le_mean =     -16.906109160516
             les_mean =     286.170082895493
             stat err =       0.000472094787
             autocorr =       1.260753084162
              std dev =       0.594605856843
             le_variance =       0.353556124992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906109160516        initial  <--
     9.5367e+04     9.5367e+05             2.5054e-09       -16.906109160512
     3.8147e+05     3.8147e+06             6.2635e-10       -16.906109160514
     1.5259e+06     1.5259e+07             1.5659e-10       -16.906109160516

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3243
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6425e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.882
    reference variance = 0.291647
====================================================
  Execution time = 2.0883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4412e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344260743693
                                         uncertainty =       0.006358925885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344260743693
                                         uncertainty =       0.006358925885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414800284
  error estimate for blocks of size 2^( 2) =       0.000427579943
  error estimate for blocks of size 2^( 3) =       0.000440690768
  error estimate for blocks of size 2^( 4) =       0.000452683429
  error estimate for blocks of size 2^( 5) =       0.000463527580
  error estimate for blocks of size 2^( 6) =       0.000471450252
  error estimate for blocks of size 2^( 7) =       0.000479266439

      target function =                  N/A
              le_mean =     -16.906520464227
             les_mean =     286.174552586510
             stat err =       0.000466731925
             autocorr =       1.266067690929
              std dev =       0.586616187333
             le_variance =       0.344118551241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652046423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906520464227       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906520464227       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906520464227       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906520464225       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906520463837       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906520464328       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906520465355       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906520464435       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.608733e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906520464227       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906520464227       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906520464227       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906520464227       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906520464227       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906520463311       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906520465614       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906520468525       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 6.521827e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906520464227       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906520464227       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906520464227       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906520464227       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906520464775       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906520466904       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906520473570       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906520465629       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.630458e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230581 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6410e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8522
    reference variance = 0.158655
====================================================
  Execution time = 2.0243e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4495e-01
  Total weights = 2.0000e+06
  Execution time = 1.8687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345030155918
                                         uncertainty =       0.008802992254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345030155918
                                         uncertainty =       0.008802992254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415301132
  error estimate for blocks of size 2^( 2) =       0.000428127469
  error estimate for blocks of size 2^( 3) =       0.000440843332
  error estimate for blocks of size 2^( 4) =       0.000453108660
  error estimate for blocks of size 2^( 5) =       0.000464318454
  error estimate for blocks of size 2^( 6) =       0.000473613703
  error estimate for blocks of size 2^( 7) =       0.000478760232

      target function =                  N/A
              le_mean =     -16.906142609065
             les_mean =     286.162607805604
             stat err =       0.000467450262
             autocorr =       1.266906564178
              std dev =       0.587324492969
             le_variance =       0.344950060041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345030155822
                                         uncertainty =       0.008802992250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345030155822
                                         uncertainty =       0.008802992250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415301132
  error estimate for blocks of size 2^( 2) =       0.000428127469
  error estimate for blocks of size 2^( 3) =       0.000440843332
  error estimate for blocks of size 2^( 4) =       0.000453108660
  error estimate for blocks of size 2^( 5) =       0.000464318454
  error estimate for blocks of size 2^( 6) =       0.000473613703
  error estimate for blocks of size 2^( 7) =       0.000478760232

      target function =                  N/A
              le_mean =     -16.906142609064
             les_mean =     286.162607805495
             stat err =       0.000467450262
             autocorr =       1.266906564266
              std dev =       0.587324492887
             le_variance =       0.344950059944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345030155870
                                         uncertainty =       0.008802992252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345030155870
                                         uncertainty =       0.008802992252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415301132
  error estimate for blocks of size 2^( 2) =       0.000428127469
  error estimate for blocks of size 2^( 3) =       0.000440843332
  error estimate for blocks of size 2^( 4) =       0.000453108660
  error estimate for blocks of size 2^( 5) =       0.000464318454
  error estimate for blocks of size 2^( 6) =       0.000473613703
  error estimate for blocks of size 2^( 7) =       0.000478760232

      target function =                  N/A
              le_mean =     -16.906142609065
             les_mean =     286.162607805549
             stat err =       0.000467450262
             autocorr =       1.266906564220
              std dev =       0.587324492927
             le_variance =       0.344950059992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345030155912
                                         uncertainty =       0.008802992253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345030155912
                                         uncertainty =       0.008802992253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415301132
  error estimate for blocks of size 2^( 2) =       0.000428127469
  error estimate for blocks of size 2^( 3) =       0.000440843332
  error estimate for blocks of size 2^( 4) =       0.000453108660
  error estimate for blocks of size 2^( 5) =       0.000464318454
  error estimate for blocks of size 2^( 6) =       0.000473613703
  error estimate for blocks of size 2^( 7) =       0.000478760232

      target function =                  N/A
              le_mean =     -16.906142609065
             les_mean =     286.162607805597
             stat err =       0.000467450262
             autocorr =       1.266906564184
              std dev =       0.587324492963
             le_variance =       0.344950060035


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906142609065        initial  <--
     9.5367e+05     9.5367e+06             2.6087e-10       -16.906142609064
     3.8147e+06     3.8147e+07             6.5218e-11       -16.906142609065
     1.5259e+07     1.5259e+08             1.6305e-11       -16.906142609065

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6581
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6097e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8584
    reference variance = 0.318768
====================================================
  Execution time = 2.3029e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3575e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335797500666
                                         uncertainty =       0.003046519770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335797500666
                                         uncertainty =       0.003046519770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409726380
  error estimate for blocks of size 2^( 2) =       0.000422631783
  error estimate for blocks of size 2^( 3) =       0.000434946321
  error estimate for blocks of size 2^( 4) =       0.000447078003
  error estimate for blocks of size 2^( 5) =       0.000458402913
  error estimate for blocks of size 2^( 6) =       0.000467348762
  error estimate for blocks of size 2^( 7) =       0.000472730232

      target function =                  N/A
              le_mean =     -16.905593691342
             les_mean =     286.134849301834
             stat err =       0.000461389978
             autocorr =       1.268085275697
              std dev =       0.579440603476
             le_variance =       0.335751412957


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690559369134e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905593691342       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905593691342       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905593691342       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905593696265       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905593691342       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905593691408       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905593700300       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905593691358       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.321591e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905593691342       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905593691342       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905593691342       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905593691342       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905593692647       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905593943158       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905593688420       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905593684207       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 5.804758e-12

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905593691342       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905593691342       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905593691342       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905593559719       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905593691342       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905593707024       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905593683518       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905593733669       residual = 2.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 1.450860e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237475 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8640e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8536
    reference variance = 0.199513
====================================================
  Execution time = 2.1050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3883e-01
  Total weights = 2.0000e+06
  Execution time = 1.8604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338813226491
                                         uncertainty =       0.004124059727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338813226491
                                         uncertainty =       0.004124059727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411601311
  error estimate for blocks of size 2^( 2) =       0.000424430217
  error estimate for blocks of size 2^( 3) =       0.000437228744
  error estimate for blocks of size 2^( 4) =       0.000450229678
  error estimate for blocks of size 2^( 5) =       0.000461210151
  error estimate for blocks of size 2^( 6) =       0.000469928244
  error estimate for blocks of size 2^( 7) =       0.000473140744

      target function =                  N/A
              le_mean =     -16.906698324641
             les_mean =     286.175279349027
             stat err =       0.000463627204
             autocorr =       1.268774156824
              std dev =       0.582092155966
             le_variance =       0.338831278037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338813226504
                                         uncertainty =       0.004124059727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338813226504
                                         uncertainty =       0.004124059727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411601311
  error estimate for blocks of size 2^( 2) =       0.000424430217
  error estimate for blocks of size 2^( 3) =       0.000437228744
  error estimate for blocks of size 2^( 4) =       0.000450229678
  error estimate for blocks of size 2^( 5) =       0.000461210151
  error estimate for blocks of size 2^( 6) =       0.000469928244
  error estimate for blocks of size 2^( 7) =       0.000473140744

      target function =                  N/A
              le_mean =     -16.906698324641
             les_mean =     286.175279349037
             stat err =       0.000463627204
             autocorr =       1.268774156811
              std dev =       0.582092155976
             le_variance =       0.338831278049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338813226497
                                         uncertainty =       0.004124059727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338813226497
                                         uncertainty =       0.004124059727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411601311
  error estimate for blocks of size 2^( 2) =       0.000424430217
  error estimate for blocks of size 2^( 3) =       0.000437228744
  error estimate for blocks of size 2^( 4) =       0.000450229678
  error estimate for blocks of size 2^( 5) =       0.000461210151
  error estimate for blocks of size 2^( 6) =       0.000469928244
  error estimate for blocks of size 2^( 7) =       0.000473140744

      target function =                  N/A
              le_mean =     -16.906698324641
             les_mean =     286.175279349032
             stat err =       0.000463627204
             autocorr =       1.268774156814
              std dev =       0.582092155971
             le_variance =       0.338831278043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338813226492
                                         uncertainty =       0.004124059727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338813226492
                                         uncertainty =       0.004124059727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411601311
  error estimate for blocks of size 2^( 2) =       0.000424430217
  error estimate for blocks of size 2^( 3) =       0.000437228744
  error estimate for blocks of size 2^( 4) =       0.000450229678
  error estimate for blocks of size 2^( 5) =       0.000461210151
  error estimate for blocks of size 2^( 6) =       0.000469928244
  error estimate for blocks of size 2^( 7) =       0.000473140744

      target function =                  N/A
              le_mean =     -16.906698324641
             les_mean =     286.175279349028
             stat err =       0.000463627204
             autocorr =       1.268774156820
              std dev =       0.582092155966
             le_variance =       0.338831278037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906698324641        initial  <--
     9.5367e+06     9.5367e+07             2.3216e-11       -16.906698324641
     3.8147e+07     3.8147e+08             5.8048e-12       -16.906698324641
     1.5259e+08     1.5259e+09             1.4509e-12       -16.906698324641

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4911
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9146e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8465
    reference variance = 0.447787
====================================================
  Execution time = 2.0803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4372e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343812508101
                                         uncertainty =       0.009067533523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343812508101
                                         uncertainty =       0.009067533523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414557936
  error estimate for blocks of size 2^( 2) =       0.000426787441
  error estimate for blocks of size 2^( 3) =       0.000440107869
  error estimate for blocks of size 2^( 4) =       0.000451184638
  error estimate for blocks of size 2^( 5) =       0.000460736342
  error estimate for blocks of size 2^( 6) =       0.000468054118
  error estimate for blocks of size 2^( 7) =       0.000471840381

      target function =                  N/A
              le_mean =     -16.905665041104
             les_mean =     286.145226875146
             stat err =       0.000462953870
             autocorr =       1.247110600537
              std dev =       0.586273455805
             le_variance =       0.343716564982


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566504110e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665041105       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665041105       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905665041105       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905665041358       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905665132155       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905665073911       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905664902425       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905665085178       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.032385e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665041105       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665041105       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905665041105       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905665053328       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905665236483       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905665041687       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905664789707       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905665306787       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 5.080845e-13

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665041105       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665041105       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905665041105       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905664987438       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905664973868       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905665040622       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905665567567       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905664235822       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 1.270665e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244339 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6387e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8524
    reference variance = 0.249285
====================================================
  Execution time = 2.0540e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3568e-01
  Total weights = 2.0000e+06
  Execution time = 1.8677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784912704
                                         uncertainty =       0.003747949994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784912704
                                         uncertainty =       0.003747949994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409684886
  error estimate for blocks of size 2^( 2) =       0.000422772751
  error estimate for blocks of size 2^( 3) =       0.000435713101
  error estimate for blocks of size 2^( 4) =       0.000447100023
  error estimate for blocks of size 2^( 5) =       0.000458186881
  error estimate for blocks of size 2^( 6) =       0.000467145272
  error estimate for blocks of size 2^( 7) =       0.000472759488

      target function =                  N/A
              le_mean =     -16.905698216590
             les_mean =     286.138315434856
             stat err =       0.000461297916
             autocorr =       1.267836058881
              std dev =       0.579381922638
             le_variance =       0.335683412280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784912703
                                         uncertainty =       0.003747949994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784912703
                                         uncertainty =       0.003747949994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409684886
  error estimate for blocks of size 2^( 2) =       0.000422772751
  error estimate for blocks of size 2^( 3) =       0.000435713101
  error estimate for blocks of size 2^( 4) =       0.000447100023
  error estimate for blocks of size 2^( 5) =       0.000458186881
  error estimate for blocks of size 2^( 6) =       0.000467145272
  error estimate for blocks of size 2^( 7) =       0.000472759488

      target function =                  N/A
              le_mean =     -16.905698216590
             les_mean =     286.138315434855
             stat err =       0.000461297916
             autocorr =       1.267836058884
              std dev =       0.579381922637
             le_variance =       0.335683412278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784912703
                                         uncertainty =       0.003747949994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784912703
                                         uncertainty =       0.003747949994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409684886
  error estimate for blocks of size 2^( 2) =       0.000422772751
  error estimate for blocks of size 2^( 3) =       0.000435713101
  error estimate for blocks of size 2^( 4) =       0.000447100023
  error estimate for blocks of size 2^( 5) =       0.000458186881
  error estimate for blocks of size 2^( 6) =       0.000467145272
  error estimate for blocks of size 2^( 7) =       0.000472759488

      target function =                  N/A
              le_mean =     -16.905698216590
             les_mean =     286.138315434855
             stat err =       0.000461297916
             autocorr =       1.267836058873
              std dev =       0.579381922638
             le_variance =       0.335683412279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784912704
                                         uncertainty =       0.003747949994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335784912704
                                         uncertainty =       0.003747949994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409684886
  error estimate for blocks of size 2^( 2) =       0.000422772751
  error estimate for blocks of size 2^( 3) =       0.000435713101
  error estimate for blocks of size 2^( 4) =       0.000447100023
  error estimate for blocks of size 2^( 5) =       0.000458186881
  error estimate for blocks of size 2^( 6) =       0.000467145272
  error estimate for blocks of size 2^( 7) =       0.000472759488

      target function =                  N/A
              le_mean =     -16.905698216590
             les_mean =     286.138315434856
             stat err =       0.000461297916
             autocorr =       1.267836058877
              std dev =       0.579381922639
             le_variance =       0.335683412280


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905698216590        initial
     9.5367e+07     9.5367e+08             2.0324e-12       -16.905698216590  <--
     3.8147e+08     3.8147e+09             5.0808e-13       -16.905698216590
     1.5259e+09     1.5259e+10             1.2707e-13       -16.905698216590

*****************************************************************************
Applying the update for shift_i =   9.5367e+07     and shift_s =   9.5367e+08
*****************************************************************************

  Execution time = 2.9995e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6398e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6884e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8902
    reference variance = 0.633169
====================================================
  Execution time = 2.1165e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4229e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342379197923
                                         uncertainty =       0.004153402273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342379197923
                                         uncertainty =       0.004153402273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413699430
  error estimate for blocks of size 2^( 2) =       0.000426315386
  error estimate for blocks of size 2^( 3) =       0.000438816599
  error estimate for blocks of size 2^( 4) =       0.000450938066
  error estimate for blocks of size 2^( 5) =       0.000461484961
  error estimate for blocks of size 2^( 6) =       0.000467188962
  error estimate for blocks of size 2^( 7) =       0.000472110993

      target function =                  N/A
              le_mean =     -16.906262602808
             les_mean =     286.164009461286
             stat err =       0.000462930746
             autocorr =       1.252166859131
              std dev =       0.585059345141
             le_variance =       0.342294437336


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626260281e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262602808       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262602808       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906262602808       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906262603137       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906262601893       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906262604190       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906262602325       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906262602407       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 1.062638e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262602808       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262602808       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906262602808       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906262546115       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906262558764       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906262608605       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906262654316       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906262583538       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.656564e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262602808       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262602808       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906262602808       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906262602808       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906262611085       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906262891837       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906262428298       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906262428428       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 6.638625e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6677e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.896
    reference variance = 0.276973
====================================================
  Execution time = 2.0323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5094e-01
  Total weights = 2.0000e+06
  Execution time = 1.8706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350931804643
                                         uncertainty =       0.006282493088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350931804643
                                         uncertainty =       0.006282493088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418888657
  error estimate for blocks of size 2^( 2) =       0.000431517301
  error estimate for blocks of size 2^( 3) =       0.000444660432
  error estimate for blocks of size 2^( 4) =       0.000455973575
  error estimate for blocks of size 2^( 5) =       0.000465536244
  error estimate for blocks of size 2^( 6) =       0.000473675241
  error estimate for blocks of size 2^( 7) =       0.000478097622

      target function =                  N/A
              le_mean =     -16.905851074592
             les_mean =     286.158735794454
             stat err =       0.000468320671
             autocorr =       1.249940826191
              std dev =       0.592398019606
             le_variance =       0.350935413633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350931804640
                                         uncertainty =       0.006282493088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350931804640
                                         uncertainty =       0.006282493088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418888657
  error estimate for blocks of size 2^( 2) =       0.000431517301
  error estimate for blocks of size 2^( 3) =       0.000444660432
  error estimate for blocks of size 2^( 4) =       0.000455973575
  error estimate for blocks of size 2^( 5) =       0.000465536244
  error estimate for blocks of size 2^( 6) =       0.000473675241
  error estimate for blocks of size 2^( 7) =       0.000478097622

      target function =                  N/A
              le_mean =     -16.905851074592
             les_mean =     286.158735794451
             stat err =       0.000468320671
             autocorr =       1.249940826190
              std dev =       0.592398019604
             le_variance =       0.350935413630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350931804641
                                         uncertainty =       0.006282493088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350931804641
                                         uncertainty =       0.006282493088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418888657
  error estimate for blocks of size 2^( 2) =       0.000431517301
  error estimate for blocks of size 2^( 3) =       0.000444660432
  error estimate for blocks of size 2^( 4) =       0.000455973575
  error estimate for blocks of size 2^( 5) =       0.000465536244
  error estimate for blocks of size 2^( 6) =       0.000473675241
  error estimate for blocks of size 2^( 7) =       0.000478097622

      target function =                  N/A
              le_mean =     -16.905851074592
             les_mean =     286.158735794453
             stat err =       0.000468320671
             autocorr =       1.249940826180
              std dev =       0.592398019605
             le_variance =       0.350935413632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350931804642
                                         uncertainty =       0.006282493088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350931804642
                                         uncertainty =       0.006282493088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418888657
  error estimate for blocks of size 2^( 2) =       0.000431517301
  error estimate for blocks of size 2^( 3) =       0.000444660432
  error estimate for blocks of size 2^( 4) =       0.000455973575
  error estimate for blocks of size 2^( 5) =       0.000465536244
  error estimate for blocks of size 2^( 6) =       0.000473675241
  error estimate for blocks of size 2^( 7) =       0.000478097622

      target function =                  N/A
              le_mean =     -16.905851074592
             les_mean =     286.158735794454
             stat err =       0.000468320671
             autocorr =       1.249940826191
              std dev =       0.592398019606
             le_variance =       0.350935413633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905851074592        initial  <--
     2.3842e+07     2.3842e+08             1.0626e-11       -16.905851074592
     9.5367e+07     9.5367e+08             2.6566e-12       -16.905851074592
     3.8147e+08     3.8147e+09             6.6386e-13       -16.905851074592

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7489
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6441e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6884e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8736
    reference variance = 0.228392
====================================================
  Execution time = 2.0833e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3902e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339010017541
                                         uncertainty =       0.006954182039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339010017541
                                         uncertainty =       0.006954182039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411715034
  error estimate for blocks of size 2^( 2) =       0.000424390638
  error estimate for blocks of size 2^( 3) =       0.000436673552
  error estimate for blocks of size 2^( 4) =       0.000448618948
  error estimate for blocks of size 2^( 5) =       0.000459218317
  error estimate for blocks of size 2^( 6) =       0.000465283653
  error estimate for blocks of size 2^( 7) =       0.000471587953

      target function =                  N/A
              le_mean =     -16.906486274126
             les_mean =     286.168296505336
             stat err =       0.000461177218
             autocorr =       1.254706766528
              std dev =       0.582252984230
             le_variance =       0.339018537644


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690648627413e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906486274126       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906486274126       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906486274126       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906486274126       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906486179792       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906486254981       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906486258247       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906486472170       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 8.859607e-13

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906486274126       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906486274126       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906486274126       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906486315338       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906485722836       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906485877204       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906486794001       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906486328659       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 2.212419e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906486274126       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906486274126       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906486274126       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906486274126       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906486483231       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906486009982       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906487893841       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906487352702       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 5.540142e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6358e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9561
    reference variance = 0.285985
====================================================
  Execution time = 2.0729e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3947e-01
  Total weights = 2.0000e+06
  Execution time = 1.8647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339518267732
                                         uncertainty =       0.004145955032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339518267732
                                         uncertainty =       0.004145955032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411989414
  error estimate for blocks of size 2^( 2) =       0.000424726109
  error estimate for blocks of size 2^( 3) =       0.000437508676
  error estimate for blocks of size 2^( 4) =       0.000449686402
  error estimate for blocks of size 2^( 5) =       0.000459758763
  error estimate for blocks of size 2^( 6) =       0.000468554693
  error estimate for blocks of size 2^( 7) =       0.000471834548

      target function =                  N/A
              le_mean =     -16.905103780554
             les_mean =     286.122004216455
             stat err =       0.000462458602
             autocorr =       1.260008887620
              std dev =       0.582641017181
             le_variance =       0.339470554902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339518267732
                                         uncertainty =       0.004145955032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339518267732
                                         uncertainty =       0.004145955032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411989414
  error estimate for blocks of size 2^( 2) =       0.000424726109
  error estimate for blocks of size 2^( 3) =       0.000437508676
  error estimate for blocks of size 2^( 4) =       0.000449686402
  error estimate for blocks of size 2^( 5) =       0.000459758763
  error estimate for blocks of size 2^( 6) =       0.000468554693
  error estimate for blocks of size 2^( 7) =       0.000471834548

      target function =                  N/A
              le_mean =     -16.905103780554
             les_mean =     286.122004216455
             stat err =       0.000462458602
             autocorr =       1.260008887617
              std dev =       0.582641017181
             le_variance =       0.339470554902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339518267732
                                         uncertainty =       0.004145955032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339518267732
                                         uncertainty =       0.004145955032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411989414
  error estimate for blocks of size 2^( 2) =       0.000424726109
  error estimate for blocks of size 2^( 3) =       0.000437508676
  error estimate for blocks of size 2^( 4) =       0.000449686402
  error estimate for blocks of size 2^( 5) =       0.000459758763
  error estimate for blocks of size 2^( 6) =       0.000468554693
  error estimate for blocks of size 2^( 7) =       0.000471834548

      target function =                  N/A
              le_mean =     -16.905103780554
             les_mean =     286.122004216455
             stat err =       0.000462458602
             autocorr =       1.260008887621
              std dev =       0.582641017181
             le_variance =       0.339470554902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339518267732
                                         uncertainty =       0.004145955032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339518267732
                                         uncertainty =       0.004145955032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411989414
  error estimate for blocks of size 2^( 2) =       0.000424726109
  error estimate for blocks of size 2^( 3) =       0.000437508676
  error estimate for blocks of size 2^( 4) =       0.000449686402
  error estimate for blocks of size 2^( 5) =       0.000459758763
  error estimate for blocks of size 2^( 6) =       0.000468554693
  error estimate for blocks of size 2^( 7) =       0.000471834548

      target function =                  N/A
              le_mean =     -16.905103780554
             les_mean =     286.122004216455
             stat err =       0.000462458602
             autocorr =       1.260008887620
              std dev =       0.582641017181
             le_variance =       0.339470554902


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905103780554        initial
     2.3842e+08     2.3842e+09             8.8596e-13       -16.905103780554
     9.5367e+08     9.5367e+09             2.2124e-13       -16.905103780554  <--
     3.8147e+09     3.8147e+10             5.5401e-14       -16.905103780554

*****************************************************************************
Applying the update for shift_i =   9.5367e+08     and shift_s =   9.5367e+09
*****************************************************************************

  Execution time = 3.0143e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6532e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8299
    reference variance = 0.169915
====================================================
  Execution time = 2.0965e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.9219e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.392380109452
                                         uncertainty =       0.054120938091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.392380109452
                                         uncertainty =       0.054120938091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442827520
  error estimate for blocks of size 2^( 2) =       0.000455204722
  error estimate for blocks of size 2^( 3) =       0.000467704493
  error estimate for blocks of size 2^( 4) =       0.000479182116
  error estimate for blocks of size 2^( 5) =       0.000489349140
  error estimate for blocks of size 2^( 6) =       0.000496845673
  error estimate for blocks of size 2^( 7) =       0.000498936051

      target function =                  N/A
              le_mean =     -16.905801433577
             les_mean =     286.198314340495
             stat err =       0.000491078245
             autocorr =       1.229793474322
              std dev =       0.626252684672
             le_variance =       0.392192425058


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580143358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801433577       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905801433577       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801433577       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905801433577       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905801565685       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905801329197       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801224756       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905801453915       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 9.880552e-13

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801433577       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905801433577       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801433577       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905801468767       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905801623525       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905801298085       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801405357       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905802423819       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 2.469724e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801433577       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905801433577       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801433577       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905801433577       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905801758506       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905800511573       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801131476       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905801675329       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 6.177396e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265005 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6531e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9392
    reference variance = 0.406848
====================================================
  Execution time = 2.0754e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4194e-01
  Total weights = 2.0000e+06
  Execution time = 1.8577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341950991566
                                         uncertainty =       0.003915114543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341950991566
                                         uncertainty =       0.003915114543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413482727
  error estimate for blocks of size 2^( 2) =       0.000425849895
  error estimate for blocks of size 2^( 3) =       0.000438774101
  error estimate for blocks of size 2^( 4) =       0.000450920794
  error estimate for blocks of size 2^( 5) =       0.000462566196
  error estimate for blocks of size 2^( 6) =       0.000469492090
  error estimate for blocks of size 2^( 7) =       0.000474319604

      target function =                  N/A
              le_mean =     -16.906843259270
             les_mean =     286.183284754210
             stat err =       0.000464324671
             autocorr =       1.261039745183
              std dev =       0.584752880855
             le_variance =       0.341935931668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341950991565
                                         uncertainty =       0.003915114543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341950991565
                                         uncertainty =       0.003915114543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413482727
  error estimate for blocks of size 2^( 2) =       0.000425849895
  error estimate for blocks of size 2^( 3) =       0.000438774101
  error estimate for blocks of size 2^( 4) =       0.000450920794
  error estimate for blocks of size 2^( 5) =       0.000462566196
  error estimate for blocks of size 2^( 6) =       0.000469492090
  error estimate for blocks of size 2^( 7) =       0.000474319604

      target function =                  N/A
              le_mean =     -16.906843259270
             les_mean =     286.183284754209
             stat err =       0.000464324671
             autocorr =       1.261039745176
              std dev =       0.584752880854
             le_variance =       0.341935931667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341950991566
                                         uncertainty =       0.003915114543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341950991566
                                         uncertainty =       0.003915114543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413482727
  error estimate for blocks of size 2^( 2) =       0.000425849895
  error estimate for blocks of size 2^( 3) =       0.000438774101
  error estimate for blocks of size 2^( 4) =       0.000450920794
  error estimate for blocks of size 2^( 5) =       0.000462566196
  error estimate for blocks of size 2^( 6) =       0.000469492090
  error estimate for blocks of size 2^( 7) =       0.000474319604

      target function =                  N/A
              le_mean =     -16.906843259270
             les_mean =     286.183284754209
             stat err =       0.000464324671
             autocorr =       1.261039745181
              std dev =       0.584752880855
             le_variance =       0.341935931668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341950991566
                                         uncertainty =       0.003915114543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341950991566
                                         uncertainty =       0.003915114543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413482727
  error estimate for blocks of size 2^( 2) =       0.000425849895
  error estimate for blocks of size 2^( 3) =       0.000438774101
  error estimate for blocks of size 2^( 4) =       0.000450920794
  error estimate for blocks of size 2^( 5) =       0.000462566196
  error estimate for blocks of size 2^( 6) =       0.000469492090
  error estimate for blocks of size 2^( 7) =       0.000474319604

      target function =                  N/A
              le_mean =     -16.906843259270
             les_mean =     286.183284754209
             stat err =       0.000464324671
             autocorr =       1.261039745176
              std dev =       0.584752880855
             le_variance =       0.341935931668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906843259270        initial  <--
     2.3842e+08     2.3842e+09             9.8806e-13       -16.906843259270
     9.5367e+08     9.5367e+09             2.4697e-13       -16.906843259270
     3.8147e+09     3.8147e+10             6.1774e-14       -16.906843259270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2943
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6864e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 1.4879
====================================================
  Execution time = 2.0688e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5323e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353242488412
                                         uncertainty =       0.017764963171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353242488412
                                         uncertainty =       0.017764963171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420257063
  error estimate for blocks of size 2^( 2) =       0.000432435306
  error estimate for blocks of size 2^( 3) =       0.000444892759
  error estimate for blocks of size 2^( 4) =       0.000458075709
  error estimate for blocks of size 2^( 5) =       0.000468730922
  error estimate for blocks of size 2^( 6) =       0.000475164626
  error estimate for blocks of size 2^( 7) =       0.000478792350

      target function =                  N/A
              le_mean =     -16.906190941610
             les_mean =     286.172523976292
             stat err =       0.000470190902
             autocorr =       1.251752304486
              std dev =       0.594333238792
             le_variance =       0.353231998733


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619094161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906190941610       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906190941610       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906190941610       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906190941610       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906191917750       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906190159368       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906188297936       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906191807650       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 7.806884e-14

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906190941610       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906190941610       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906190941610       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906190788042       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193128700       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906153173739       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906196598979       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906187078304       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+09 is 1.928204e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906190941610       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906190941610       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906190941610       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906190941610       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906166600452       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193356714       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906202895530       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906197029489       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906185522930       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 4.967648e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6161e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9566
    reference variance = 0.407484
====================================================
  Execution time = 2.2497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3302e-01
  Total weights = 2.0000e+06
  Execution time = 1.8576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332921085252
                                         uncertainty =       0.002814632163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332921085252
                                         uncertainty =       0.002814632163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408054216
  error estimate for blocks of size 2^( 2) =       0.000420832037
  error estimate for blocks of size 2^( 3) =       0.000433780574
  error estimate for blocks of size 2^( 4) =       0.000445862771
  error estimate for blocks of size 2^( 5) =       0.000456551193
  error estimate for blocks of size 2^( 6) =       0.000464301315
  error estimate for blocks of size 2^( 7) =       0.000469038641

      target function =                  N/A
              le_mean =     -16.906022562997
             les_mean =     286.146615219876
             stat err =       0.000458938480
             autocorr =       1.264949557935
              std dev =       0.577075805946
             le_variance =       0.333016485808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332921085252
                                         uncertainty =       0.002814632163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332921085252
                                         uncertainty =       0.002814632163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408054216
  error estimate for blocks of size 2^( 2) =       0.000420832037
  error estimate for blocks of size 2^( 3) =       0.000433780574
  error estimate for blocks of size 2^( 4) =       0.000445862771
  error estimate for blocks of size 2^( 5) =       0.000456551193
  error estimate for blocks of size 2^( 6) =       0.000464301315
  error estimate for blocks of size 2^( 7) =       0.000469038641

      target function =                  N/A
              le_mean =     -16.906022562997
             les_mean =     286.146615219876
             stat err =       0.000458938480
             autocorr =       1.264949557936
              std dev =       0.577075805946
             le_variance =       0.333016485809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332921085252
                                         uncertainty =       0.002814632163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332921085252
                                         uncertainty =       0.002814632163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408054216
  error estimate for blocks of size 2^( 2) =       0.000420832037
  error estimate for blocks of size 2^( 3) =       0.000433780574
  error estimate for blocks of size 2^( 4) =       0.000445862771
  error estimate for blocks of size 2^( 5) =       0.000456551193
  error estimate for blocks of size 2^( 6) =       0.000464301315
  error estimate for blocks of size 2^( 7) =       0.000469038641

      target function =                  N/A
              le_mean =     -16.906022562997
             les_mean =     286.146615219876
             stat err =       0.000458938480
             autocorr =       1.264949557930
              std dev =       0.577075805946
             le_variance =       0.333016485808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332921085252
                                         uncertainty =       0.002814632163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332921085252
                                         uncertainty =       0.002814632163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408054216
  error estimate for blocks of size 2^( 2) =       0.000420832037
  error estimate for blocks of size 2^( 3) =       0.000433780574
  error estimate for blocks of size 2^( 4) =       0.000445862771
  error estimate for blocks of size 2^( 5) =       0.000456551193
  error estimate for blocks of size 2^( 6) =       0.000464301315
  error estimate for blocks of size 2^( 7) =       0.000469038641

      target function =                  N/A
              le_mean =     -16.906022562997
             les_mean =     286.146615219876
             stat err =       0.000458938480
             autocorr =       1.264949557933
              std dev =       0.577075805946
             le_variance =       0.333016485809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906022562997        initial  <--
     2.3842e+09     2.3842e+10             7.8069e-14       -16.906022562997
     9.5367e+09     9.5367e+10             1.9282e-14       -16.906022562997
     3.8147e+10     3.8147e+11             4.9676e-15       -16.906022562997

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8688
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8037e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8714
    reference variance = 0.159261
====================================================
  Execution time = 2.0470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3775e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337624637714
                                         uncertainty =       0.003855783718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337624637714
                                         uncertainty =       0.003855783718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410942103
  error estimate for blocks of size 2^( 2) =       0.000423531038
  error estimate for blocks of size 2^( 3) =       0.000436679806
  error estimate for blocks of size 2^( 4) =       0.000449340944
  error estimate for blocks of size 2^( 5) =       0.000459666340
  error estimate for blocks of size 2^( 6) =       0.000467912076
  error estimate for blocks of size 2^( 7) =       0.000473406524

      target function =                  N/A
              le_mean =     -16.905653073194
             les_mean =     286.138852486531
             stat err =       0.000462581471
             autocorr =       1.267112535187
              std dev =       0.581159895570
             le_variance =       0.337746824219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565307319e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905653073194       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905653073194       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905653073194       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905659224769       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905639849180       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905652034664       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905654551597       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 9.127221e-15

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905653073194       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905653073194       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905653073194       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905653073194       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905625393236       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905653460783       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905955085598       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905615721371       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905721335326       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905832436188       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904815989799       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907465598389       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905008237309       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907016852167       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905159235518       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906261203655       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906209130579       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905930551342       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.902246889206       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.911348947536       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907779521812       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.901609875283       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906395733500       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.913730291624       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.922637988707       residual = 3.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.899133905302       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905246581305       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.900033547820       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.907828098421       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.913499608066       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.914448736209       residual = 1.05e-02           smallest_sin_value = 9.97e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 2.016592e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905653073194       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905653073194       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905653073194       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905628319214       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905587281900       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905947263407       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906168274217       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905553468286       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905328684216       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905575923448       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903912960863       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906931010977       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.916197637404       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904911826722       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.920616458361       residual = 3.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.920278611366       residual = 2.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.933582368892       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.924971921303       residual = 5.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.925380672595       residual = 5.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.932077380725       residual = 9.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.875955442293       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.896278172189       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.899290543864       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.924506911362       residual = 4.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.962848027659       residual = 4.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.921292512904       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.910897938489       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.820487779242       residual = 9.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.839392370906       residual = 5.71e-01           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -16.901797046229       residual = 2.27e-03           smallest_sin_value = 9.92e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.72e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 1.183109e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.294697 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6049e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9398
    reference variance = 0.220878
====================================================
  Execution time = 2.0131e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4594e-01
  Total weights = 2.0000e+06
  Execution time = 1.8757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345969350751
                                         uncertainty =       0.011952557270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345969350751
                                         uncertainty =       0.011952557270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415895865
  error estimate for blocks of size 2^( 2) =       0.000428271091
  error estimate for blocks of size 2^( 3) =       0.000440391698
  error estimate for blocks of size 2^( 4) =       0.000452105524
  error estimate for blocks of size 2^( 5) =       0.000462154121
  error estimate for blocks of size 2^( 6) =       0.000469292766
  error estimate for blocks of size 2^( 7) =       0.000475086662

      target function =                  N/A
              le_mean =     -16.905835365675
             les_mean =     286.153207979518
             stat err =       0.000464659768
             autocorr =       1.248248170568
              std dev =       0.588165572932
             le_variance =       0.345938741182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345969350751
                                         uncertainty =       0.011952557270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345969350751
                                         uncertainty =       0.011952557270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415895865
  error estimate for blocks of size 2^( 2) =       0.000428271091
  error estimate for blocks of size 2^( 3) =       0.000440391698
  error estimate for blocks of size 2^( 4) =       0.000452105524
  error estimate for blocks of size 2^( 5) =       0.000462154121
  error estimate for blocks of size 2^( 6) =       0.000469292766
  error estimate for blocks of size 2^( 7) =       0.000475086662

      target function =                  N/A
              le_mean =     -16.905835365675
             les_mean =     286.153207979518
             stat err =       0.000464659768
             autocorr =       1.248248170567
              std dev =       0.588165572932
             le_variance =       0.345938741182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345969350751
                                         uncertainty =       0.011952557270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345969350751
                                         uncertainty =       0.011952557270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415895865
  error estimate for blocks of size 2^( 2) =       0.000428271091
  error estimate for blocks of size 2^( 3) =       0.000440391698
  error estimate for blocks of size 2^( 4) =       0.000452105524
  error estimate for blocks of size 2^( 5) =       0.000462154121
  error estimate for blocks of size 2^( 6) =       0.000469292766
  error estimate for blocks of size 2^( 7) =       0.000475086662

      target function =                  N/A
              le_mean =     -16.905835365675
             les_mean =     286.153207979518
             stat err =       0.000464659768
             autocorr =       1.248248170568
              std dev =       0.588165572932
             le_variance =       0.345938741182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345969350751
                                         uncertainty =       0.011952557270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345969350751
                                         uncertainty =       0.011952557270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415895865
  error estimate for blocks of size 2^( 2) =       0.000428271091
  error estimate for blocks of size 2^( 3) =       0.000440391698
  error estimate for blocks of size 2^( 4) =       0.000452105524
  error estimate for blocks of size 2^( 5) =       0.000462154121
  error estimate for blocks of size 2^( 6) =       0.000469292766
  error estimate for blocks of size 2^( 7) =       0.000475086662

      target function =                  N/A
              le_mean =     -16.905835365675
             les_mean =     286.153207979518
             stat err =       0.000464659768
             autocorr =       1.248248170568
              std dev =       0.588165572932
             le_variance =       0.345938741182


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905835365675        initial  <--
     2.3842e+10     2.3842e+11             9.1272e-15       -16.905835365675
     9.5367e+10     9.5367e+11             2.0166e-15       -16.905835365675
     3.8147e+11     3.8147e+12             1.1831e-16       -16.905835365675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5515
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5616e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8937
    reference variance = 0.408509
====================================================
  Execution time = 2.0353e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4108e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341121333370
                                         uncertainty =       0.005690096623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341121333370
                                         uncertainty =       0.005690096623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412965017
  error estimate for blocks of size 2^( 2) =       0.000425964066
  error estimate for blocks of size 2^( 3) =       0.000439397399
  error estimate for blocks of size 2^( 4) =       0.000451115182
  error estimate for blocks of size 2^( 5) =       0.000461151111
  error estimate for blocks of size 2^( 6) =       0.000468113775
  error estimate for blocks of size 2^( 7) =       0.000470833492

      target function =                  N/A
              le_mean =     -16.906221661249
             les_mean =     286.161410899259
             stat err =       0.000462803390
             autocorr =       1.255933187298
              std dev =       0.584020727816
             le_variance =       0.341080210519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622166125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221661249       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906221661249       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906221661249       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906221661249       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906221661249       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905858160173       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906438407718       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907032622699       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906617891282       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904325050015       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903505482477       residual = 9.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.901547571835       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905790455509       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904070900033       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909933456603       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.917896143836       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906012658386       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908679072119       residual = 8.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.908983221090       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.899807626227       residual = 6.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910161942772       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.913461187821       residual = 7.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905826617043       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908910717547       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.920865885216       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.909058937977       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.892095034143       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.915309135823       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908168865424       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.901364619980       residual = 3.52e-03           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.888683962732       residual = 3.95e-02           smallest_sin_value = 9.98e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.930194263051       residual = 7.29e-02           smallest_sin_value = 9.98e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.899750991935       residual = 8.67e-03           smallest_sin_value = 9.95e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+11 is 6.492294e-16

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221661249       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906221661249       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906221661249       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907108802159       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906076339262       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905114604429       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908188171168       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906414224753       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906986563790       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.912443270967       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.901238165872       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.937848118951       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.886463170519       residual = 5.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.902443258455       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905023980587       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.992747783966       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.884946762982       residual = 5.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.927064444001       residual = 7.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.899131314476       residual = 8.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.890576404573       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.025974695335       residual = 1.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.918155064769       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.808182035951       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.940211155841       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.944100671326       residual = 2.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.871030826018       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.968932800241       residual = 5.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.847598637971       residual = 4.93e-01           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -16.945324062758       residual = 2.02e-01           smallest_sin_value = 9.94e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 8.237566e-17

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906221661249       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906221661249       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906221661249       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906221661249       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904275628699       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906340846622       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.899050873600       residual = 7.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.961328250659       residual = 3.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.912612764760       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.931778475138       residual = 7.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.799886880325       residual = 1.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.929966235971       residual = 8.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.799819690805       residual = 1.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.054443691562       residual = 2.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.975837116730       residual = 6.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.807074930159       residual = 1.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.846698390436       residual = 4.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.921927353358       residual = 7.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.832435829850       residual = 7.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.004607815310       residual = 1.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.380139790192       residual = 2.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.343829820070       residual = 4.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.611279690386       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.163638271227       residual = 8.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.182953769059       residual = 1.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.546684835106       residual = 1.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.958675678404       residual = 3.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.818246443015       residual = 9.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.828566407851       residual = 8.03e-01           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -16.630261720823       residual = 1.33e+01           smallest_sin_value = 9.95e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.72e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 2.059391e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.333641 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6050e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8601
    reference variance = 0.380645
====================================================
  Execution time = 2.0157e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4641e-01
  Total weights = 2.0000e+06
  Execution time = 1.8656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346304580666
                                         uncertainty =       0.006859205530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346304580666
                                         uncertainty =       0.006859205530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416177685
  error estimate for blocks of size 2^( 2) =       0.000428554233
  error estimate for blocks of size 2^( 3) =       0.000441294746
  error estimate for blocks of size 2^( 4) =       0.000453590560
  error estimate for blocks of size 2^( 5) =       0.000464355080
  error estimate for blocks of size 2^( 6) =       0.000471660718
  error estimate for blocks of size 2^( 7) =       0.000477234061

      target function =                  N/A
              le_mean =     -16.907209290111
             les_mean =     286.200133536926
             stat err =       0.000466710105
             autocorr =       1.257583492386
              std dev =       0.588564126087
             le_variance =       0.346407730517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346304580666
                                         uncertainty =       0.006859205530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346304580666
                                         uncertainty =       0.006859205530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416177685
  error estimate for blocks of size 2^( 2) =       0.000428554233
  error estimate for blocks of size 2^( 3) =       0.000441294746
  error estimate for blocks of size 2^( 4) =       0.000453590560
  error estimate for blocks of size 2^( 5) =       0.000464355080
  error estimate for blocks of size 2^( 6) =       0.000471660718
  error estimate for blocks of size 2^( 7) =       0.000477234061

      target function =                  N/A
              le_mean =     -16.907209290111
             les_mean =     286.200133536926
             stat err =       0.000466710105
             autocorr =       1.257583492386
              std dev =       0.588564126087
             le_variance =       0.346407730517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346304580666
                                         uncertainty =       0.006859205530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346304580666
                                         uncertainty =       0.006859205530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416177685
  error estimate for blocks of size 2^( 2) =       0.000428554233
  error estimate for blocks of size 2^( 3) =       0.000441294746
  error estimate for blocks of size 2^( 4) =       0.000453590560
  error estimate for blocks of size 2^( 5) =       0.000464355080
  error estimate for blocks of size 2^( 6) =       0.000471660718
  error estimate for blocks of size 2^( 7) =       0.000477234061

      target function =                  N/A
              le_mean =     -16.907209290111
             les_mean =     286.200133536926
             stat err =       0.000466710105
             autocorr =       1.257583492385
              std dev =       0.588564126087
             le_variance =       0.346407730517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346304580666
                                         uncertainty =       0.006859205530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346304580666
                                         uncertainty =       0.006859205530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416177685
  error estimate for blocks of size 2^( 2) =       0.000428554233
  error estimate for blocks of size 2^( 3) =       0.000441294746
  error estimate for blocks of size 2^( 4) =       0.000453590560
  error estimate for blocks of size 2^( 5) =       0.000464355080
  error estimate for blocks of size 2^( 6) =       0.000471660718
  error estimate for blocks of size 2^( 7) =       0.000477234061

      target function =                  N/A
              le_mean =     -16.907209290111
             les_mean =     286.200133536926
             stat err =       0.000466710105
             autocorr =       1.257583492388
              std dev =       0.588564126087
             le_variance =       0.346407730517


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907209290111        initial  <--
     2.3842e+11     2.3842e+12             6.4923e-16       -16.907209290111
     9.5367e+11     9.5367e+12             8.2376e-17       -16.907209290111
     3.8147e+12     3.8147e+13             2.0594e-17       -16.907209290111

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5793
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9428
    reference variance = 0.388742
====================================================
  Execution time = 2.0274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4816e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348195118851
                                         uncertainty =       0.009329165578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348195118851
                                         uncertainty =       0.009329165578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417226645
  error estimate for blocks of size 2^( 2) =       0.000429408624
  error estimate for blocks of size 2^( 3) =       0.000442302072
  error estimate for blocks of size 2^( 4) =       0.000454138619
  error estimate for blocks of size 2^( 5) =       0.000464923746
  error estimate for blocks of size 2^( 6) =       0.000470107962
  error estimate for blocks of size 2^( 7) =       0.000474792456

      target function =                  N/A
              le_mean =     -16.906465609832
             les_mean =     286.176735388193
             stat err =       0.000465990696
             autocorr =       1.247413445274
              std dev =       0.590047579305
             le_variance =       0.348156145843


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690646560983e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465609832       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465609832       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465609832       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465609832       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465609832       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465609832       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5800e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9011
    reference variance = 0.230705
====================================================
  Execution time = 2.0376e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3438e-01
  Total weights = 2.0000e+06
  Execution time = 1.8740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334372992194
                                         uncertainty =       0.003714914365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334372992194
                                         uncertainty =       0.003714914365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408888593
  error estimate for blocks of size 2^( 2) =       0.000421976139
  error estimate for blocks of size 2^( 3) =       0.000435153783
  error estimate for blocks of size 2^( 4) =       0.000447117583
  error estimate for blocks of size 2^( 5) =       0.000456160669
  error estimate for blocks of size 2^( 6) =       0.000464920013
  error estimate for blocks of size 2^( 7) =       0.000469591562

      target function =                  N/A
              le_mean =     -16.906505834430
             les_mean =     286.164319125307
             stat err =       0.000459447457
             autocorr =       1.262588165478
              std dev =       0.578255793632
             le_variance =       0.334379762869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334372992194
                                         uncertainty =       0.003714914365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334372992194
                                         uncertainty =       0.003714914365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408888593
  error estimate for blocks of size 2^( 2) =       0.000421976139
  error estimate for blocks of size 2^( 3) =       0.000435153783
  error estimate for blocks of size 2^( 4) =       0.000447117583
  error estimate for blocks of size 2^( 5) =       0.000456160669
  error estimate for blocks of size 2^( 6) =       0.000464920013
  error estimate for blocks of size 2^( 7) =       0.000469591562

      target function =                  N/A
              le_mean =     -16.906505834430
             les_mean =     286.164319125307
             stat err =       0.000459447457
             autocorr =       1.262588165478
              std dev =       0.578255793632
             le_variance =       0.334379762869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334372992194
                                         uncertainty =       0.003714914365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334372992194
                                         uncertainty =       0.003714914365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408888593
  error estimate for blocks of size 2^( 2) =       0.000421976139
  error estimate for blocks of size 2^( 3) =       0.000435153783
  error estimate for blocks of size 2^( 4) =       0.000447117583
  error estimate for blocks of size 2^( 5) =       0.000456160669
  error estimate for blocks of size 2^( 6) =       0.000464920013
  error estimate for blocks of size 2^( 7) =       0.000469591562

      target function =                  N/A
              le_mean =     -16.906505834430
             les_mean =     286.164319125307
             stat err =       0.000459447457
             autocorr =       1.262588165478
              std dev =       0.578255793632
             le_variance =       0.334379762869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334372992194
                                         uncertainty =       0.003714914365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334372992194
                                         uncertainty =       0.003714914365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408888593
  error estimate for blocks of size 2^( 2) =       0.000421976139
  error estimate for blocks of size 2^( 3) =       0.000435153783
  error estimate for blocks of size 2^( 4) =       0.000447117583
  error estimate for blocks of size 2^( 5) =       0.000456160669
  error estimate for blocks of size 2^( 6) =       0.000464920013
  error estimate for blocks of size 2^( 7) =       0.000469591562

      target function =                  N/A
              le_mean =     -16.906505834430
             les_mean =     286.164319125307
             stat err =       0.000459447457
             autocorr =       1.262588165478
              std dev =       0.578255793632
             le_variance =       0.334379762869


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906505834430        initial  <--
     2.3842e+12     2.3842e+13             0.0000e+00       -16.906505834430
     9.5367e+12     9.5367e+13             0.0000e+00       -16.906505834430
     3.8147e+13     3.8147e+14             0.0000e+00       -16.906505834430

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8511
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5658e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.881
    reference variance = 0.31091
====================================================
  Execution time = 2.0278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4696e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346950723130
                                         uncertainty =       0.004740728822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346950723130
                                         uncertainty =       0.004740728822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416510186
  error estimate for blocks of size 2^( 2) =       0.000429116395
  error estimate for blocks of size 2^( 3) =       0.000442770259
  error estimate for blocks of size 2^( 4) =       0.000455283104
  error estimate for blocks of size 2^( 5) =       0.000466828945
  error estimate for blocks of size 2^( 6) =       0.000476709871
  error estimate for blocks of size 2^( 7) =       0.000482630456

      target function =                  N/A
              le_mean =     -16.905713368526
             les_mean =     286.150105795806
             stat err =       0.000470363094
             autocorr =       1.275308406719
              std dev =       0.589034354273
             le_variance =       0.346961470514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690571336853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905713368526       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905713368526       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905713368526       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905713368526       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.944368486936       residual = 2.00e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905713368510       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.607353798944       residual = 1.25e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.833365936769       residual = 6.51e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.956249746139       residual = 5.07e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.883309971253       residual = 9.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.232937883065       residual = 1.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.450039811729       residual = 2.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.663577968320       residual = 7.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.965011775945       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -19.190977963911       residual = 7.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -15.125427652383       residual = 4.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -18.289845807036       residual = 2.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -20.133351043852       residual = 1.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.913605563832       residual = 1.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -18.421885291813       residual = 3.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -15.729629188164       residual = 2.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -14.043258288509       residual = 1.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.919469587117       residual = 2.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -15.817228080227       residual = 1.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.454543817293       residual = 3.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.553997244657       residual = 5.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.772787520964       residual = 5.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -19.711716252344       residual = 8.60e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.005028629374       residual = 3.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.609338417077       residual = 2.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -19.229814443980       residual = 6.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.635642460326       residual = 8.44e+01           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -22.222159560428       residual = 3.78e+03           smallest_sin_value = 9.97e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+13 is 2.070465e-18

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905713368526       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905713368526       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905713368526       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910753261945       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903956712233       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904364962760       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.825980950908       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.175413866049       residual = 9.18e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904783895501       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.761943329494       residual = 3.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.085552745047       residual = 8.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.693930248651       residual = 9.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.552642934087       residual = 1.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -19.208859485443       residual = 7.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -13.923869544621       residual = 1.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -20.489319248274       residual = 1.72e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -19.486603864480       residual = 9.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.032131974060       residual = 1.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -10.992585920445       residual = 4.57e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -12.273356131315       residual = 2.97e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -20.334873347142       residual = 1.55e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -13.061919487027       residual = 2.07e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -18.732312920294       residual = 4.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.080548778117       residual = 3.54e+03           smallest_sin_value = 1.00e+00
davidson iteration   24 stopping due to too large eigenvalue change
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 5.176161e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905713368526       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905713368526       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905713368526       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905713368526       residual = 5.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -15.291824083728       residual = 3.11e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.359105772871       residual = 5.59e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.412011584441       residual = 3.02e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -18.462851721041       residual = 2.98e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -11.054298339380       residual = 4.56e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -20.987825773425       residual = 2.27e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -25.538836222532       residual = 1.01e+04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -15.615964219908       residual = 1.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -10.837113249655       residual = 4.69e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =      -9.557164727915       residual = 6.75e+03           smallest_sin_value = 1.00e+00
davidson iteration   14 stopping due to too large eigenvalue change
davidson solver did not converge after         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 1.294040e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.360083 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5854e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9167
    reference variance = 0.235091
====================================================
  Execution time = 1.9800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3871e-01
  Total weights = 2.0000e+06
  Execution time = 1.8588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699776791
                                         uncertainty =       0.003950496726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699776791
                                         uncertainty =       0.003950496726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411528349
  error estimate for blocks of size 2^( 2) =       0.000424329034
  error estimate for blocks of size 2^( 3) =       0.000437501389
  error estimate for blocks of size 2^( 4) =       0.000449522965
  error estimate for blocks of size 2^( 5) =       0.000460861694
  error estimate for blocks of size 2^( 6) =       0.000469984400
  error estimate for blocks of size 2^( 7) =       0.000475318033

      target function =                  N/A
              le_mean =     -16.905774527963
             les_mean =     286.143923384246
             stat err =       0.000463921773
             autocorr =       1.270837426424
              std dev =       0.581988971780
             le_variance =       0.338711163274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699776791
                                         uncertainty =       0.003950496726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699776791
                                         uncertainty =       0.003950496726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411528349
  error estimate for blocks of size 2^( 2) =       0.000424329034
  error estimate for blocks of size 2^( 3) =       0.000437501389
  error estimate for blocks of size 2^( 4) =       0.000449522965
  error estimate for blocks of size 2^( 5) =       0.000460861694
  error estimate for blocks of size 2^( 6) =       0.000469984400
  error estimate for blocks of size 2^( 7) =       0.000475318033

      target function =                  N/A
              le_mean =     -16.905774527963
             les_mean =     286.143923384246
             stat err =       0.000463921773
             autocorr =       1.270837426423
              std dev =       0.581988971780
             le_variance =       0.338711163274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699776791
                                         uncertainty =       0.003950496726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699776791
                                         uncertainty =       0.003950496726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411528349
  error estimate for blocks of size 2^( 2) =       0.000424329034
  error estimate for blocks of size 2^( 3) =       0.000437501389
  error estimate for blocks of size 2^( 4) =       0.000449522965
  error estimate for blocks of size 2^( 5) =       0.000460861694
  error estimate for blocks of size 2^( 6) =       0.000469984400
  error estimate for blocks of size 2^( 7) =       0.000475318033

      target function =                  N/A
              le_mean =     -16.905774527963
             les_mean =     286.143923384246
             stat err =       0.000463921773
             autocorr =       1.270837426424
              std dev =       0.581988971780
             le_variance =       0.338711163274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699776791
                                         uncertainty =       0.003950496726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338699776791
                                         uncertainty =       0.003950496726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411528349
  error estimate for blocks of size 2^( 2) =       0.000424329034
  error estimate for blocks of size 2^( 3) =       0.000437501389
  error estimate for blocks of size 2^( 4) =       0.000449522965
  error estimate for blocks of size 2^( 5) =       0.000460861694
  error estimate for blocks of size 2^( 6) =       0.000469984400
  error estimate for blocks of size 2^( 7) =       0.000475318033

      target function =                  N/A
              le_mean =     -16.905774527963
             les_mean =     286.143923384246
             stat err =       0.000463921773
             autocorr =       1.270837426424
              std dev =       0.581988971780
             le_variance =       0.338711163274


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905774527963        initial  <--
     2.3842e+13     2.3842e+14             2.0705e-18       -16.905774527963
     9.5367e+13     9.5367e+14             5.1762e-19       -16.905774527963
     3.8147e+14     3.8147e+15             1.2940e-19       -16.905774527963

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1706
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5044e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.7621
    reference variance = 0.788886
====================================================
  Execution time = 2.0407e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4094e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340939422937
                                         uncertainty =       0.004547138285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340939422937
                                         uncertainty =       0.004547138285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412879078
  error estimate for blocks of size 2^( 2) =       0.000425818252
  error estimate for blocks of size 2^( 3) =       0.000439154352
  error estimate for blocks of size 2^( 4) =       0.000451056690
  error estimate for blocks of size 2^( 5) =       0.000462163697
  error estimate for blocks of size 2^( 6) =       0.000468180056
  error estimate for blocks of size 2^( 7) =       0.000471863840

      target function =                  N/A
              le_mean =     -16.905930914109
             les_mean =     286.151438168592
             stat err =       0.000463316071
             autocorr =       1.259241350872
              std dev =       0.583899192001
             le_variance =       0.340938266419


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593091411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905930914109       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905930914109       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905930914109       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905930914109       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905930914109       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905930914109       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361136 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5904e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9472
    reference variance = 0.311738
====================================================
  Execution time = 2.0239e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4485e-01
  Total weights = 2.0000e+06
  Execution time = 2.0616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344996760146
                                         uncertainty =       0.007894275066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344996760146
                                         uncertainty =       0.007894275066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415242931
  error estimate for blocks of size 2^( 2) =       0.000427990491
  error estimate for blocks of size 2^( 3) =       0.000441631455
  error estimate for blocks of size 2^( 4) =       0.000454770511
  error estimate for blocks of size 2^( 5) =       0.000466651243
  error estimate for blocks of size 2^( 6) =       0.000475780054
  error estimate for blocks of size 2^( 7) =       0.000483088951

      target function =                  N/A
              le_mean =     -16.906031611388
             les_mean =     286.158758056014
             stat err =       0.000470072690
             autocorr =       1.281520463191
              std dev =       0.587242184438
             le_variance =       0.344853383184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344996760146
                                         uncertainty =       0.007894275066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344996760146
                                         uncertainty =       0.007894275066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415242931
  error estimate for blocks of size 2^( 2) =       0.000427990491
  error estimate for blocks of size 2^( 3) =       0.000441631455
  error estimate for blocks of size 2^( 4) =       0.000454770511
  error estimate for blocks of size 2^( 5) =       0.000466651243
  error estimate for blocks of size 2^( 6) =       0.000475780054
  error estimate for blocks of size 2^( 7) =       0.000483088951

      target function =                  N/A
              le_mean =     -16.906031611388
             les_mean =     286.158758056014
             stat err =       0.000470072690
             autocorr =       1.281520463191
              std dev =       0.587242184438
             le_variance =       0.344853383184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344996760146
                                         uncertainty =       0.007894275066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344996760146
                                         uncertainty =       0.007894275066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415242931
  error estimate for blocks of size 2^( 2) =       0.000427990491
  error estimate for blocks of size 2^( 3) =       0.000441631455
  error estimate for blocks of size 2^( 4) =       0.000454770511
  error estimate for blocks of size 2^( 5) =       0.000466651243
  error estimate for blocks of size 2^( 6) =       0.000475780054
  error estimate for blocks of size 2^( 7) =       0.000483088951

      target function =                  N/A
              le_mean =     -16.906031611388
             les_mean =     286.158758056014
             stat err =       0.000470072690
             autocorr =       1.281520463191
              std dev =       0.587242184438
             le_variance =       0.344853383184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344996760146
                                         uncertainty =       0.007894275066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344996760146
                                         uncertainty =       0.007894275066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415242931
  error estimate for blocks of size 2^( 2) =       0.000427990491
  error estimate for blocks of size 2^( 3) =       0.000441631455
  error estimate for blocks of size 2^( 4) =       0.000454770511
  error estimate for blocks of size 2^( 5) =       0.000466651243
  error estimate for blocks of size 2^( 6) =       0.000475780054
  error estimate for blocks of size 2^( 7) =       0.000483088951

      target function =                  N/A
              le_mean =     -16.906031611388
             les_mean =     286.158758056014
             stat err =       0.000470072690
             autocorr =       1.281520463191
              std dev =       0.587242184438
             le_variance =       0.344853383184


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906031611388        initial  <--
     2.3842e+14     2.3842e+15             0.0000e+00       -16.906031611388
     9.5367e+14     9.5367e+15             0.0000e+00       -16.906031611388
     3.8147e+15     3.8147e+16             0.0000e+00       -16.906031611388

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8401
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9886
    reference variance = 0.237223
====================================================
  Execution time = 2.0599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4386e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343943169590
                                         uncertainty =       0.007810637095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343943169590
                                         uncertainty =       0.007810637095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414642461
  error estimate for blocks of size 2^( 2) =       0.000427245843
  error estimate for blocks of size 2^( 3) =       0.000440022475
  error estimate for blocks of size 2^( 4) =       0.000452328170
  error estimate for blocks of size 2^( 5) =       0.000462886932
  error estimate for blocks of size 2^( 6) =       0.000471326550
  error estimate for blocks of size 2^( 7) =       0.000476907032

      target function =                  N/A
              le_mean =     -16.905823634915
             les_mean =     286.150729344688
             stat err =       0.000465862171
             autocorr =       1.262313842473
              std dev =       0.586392992582
             le_variance =       0.343856741749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690582363492e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905823634915       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905823634915       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905823634915       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.309487832336       residual = 3.25e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.787051567833       residual = 1.73e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -18.494207523845       residual = 3.30e+02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -23.839997139781       residual = 5.44e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -12.588907204130       residual = 2.13e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -11.281619559473       residual = 4.03e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -19.663057109986       residual = 1.20e+03           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+15 is 1.538941e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905823634915       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905823634915       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905823634915       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905823634915       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.363296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6138e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.7677
    reference variance = 0.324617
====================================================
  Execution time = 2.0209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4205e-01
  Total weights = 2.0000e+06
  Execution time = 1.8575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342111416552
                                         uncertainty =       0.004278195193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342111416552
                                         uncertainty =       0.004278195193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413549872
  error estimate for blocks of size 2^( 2) =       0.000426459490
  error estimate for blocks of size 2^( 3) =       0.000438655811
  error estimate for blocks of size 2^( 4) =       0.000449920431
  error estimate for blocks of size 2^( 5) =       0.000459718011
  error estimate for blocks of size 2^( 6) =       0.000463567497
  error estimate for blocks of size 2^( 7) =       0.000467991800

      target function =                  N/A
              le_mean =     -16.906811387485
             les_mean =     286.182318115004
             stat err =       0.000460299435
             autocorr =       1.238868186687
              std dev =       0.584847838363
             le_variance =       0.342046994038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342111416552
                                         uncertainty =       0.004278195193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342111416552
                                         uncertainty =       0.004278195193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413549872
  error estimate for blocks of size 2^( 2) =       0.000426459490
  error estimate for blocks of size 2^( 3) =       0.000438655811
  error estimate for blocks of size 2^( 4) =       0.000449920431
  error estimate for blocks of size 2^( 5) =       0.000459718011
  error estimate for blocks of size 2^( 6) =       0.000463567497
  error estimate for blocks of size 2^( 7) =       0.000467991800

      target function =                  N/A
              le_mean =     -16.906811387485
             les_mean =     286.182318115004
             stat err =       0.000460299435
             autocorr =       1.238868186687
              std dev =       0.584847838363
             le_variance =       0.342046994038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342111416552
                                         uncertainty =       0.004278195193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342111416552
                                         uncertainty =       0.004278195193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413549872
  error estimate for blocks of size 2^( 2) =       0.000426459490
  error estimate for blocks of size 2^( 3) =       0.000438655811
  error estimate for blocks of size 2^( 4) =       0.000449920431
  error estimate for blocks of size 2^( 5) =       0.000459718011
  error estimate for blocks of size 2^( 6) =       0.000463567497
  error estimate for blocks of size 2^( 7) =       0.000467991800

      target function =                  N/A
              le_mean =     -16.906811387485
             les_mean =     286.182318115004
             stat err =       0.000460299435
             autocorr =       1.238868186687
              std dev =       0.584847838363
             le_variance =       0.342046994038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342111416552
                                         uncertainty =       0.004278195193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342111416552
                                         uncertainty =       0.004278195193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413549872
  error estimate for blocks of size 2^( 2) =       0.000426459490
  error estimate for blocks of size 2^( 3) =       0.000438655811
  error estimate for blocks of size 2^( 4) =       0.000449920431
  error estimate for blocks of size 2^( 5) =       0.000459718011
  error estimate for blocks of size 2^( 6) =       0.000463567497
  error estimate for blocks of size 2^( 7) =       0.000467991800

      target function =                  N/A
              le_mean =     -16.906811387485
             les_mean =     286.182318115004
             stat err =       0.000460299435
             autocorr =       1.238868186687
              std dev =       0.584847838363
             le_variance =       0.342046994038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906811387485        initial  <--
     2.3842e+15     2.3842e+16             1.5389e-20       -16.906811387485
     9.5367e+15     9.5367e+16             0.0000e+00       -16.906811387485
     3.8147e+16     3.8147e+17             0.0000e+00       -16.906811387485

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5984
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5767e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8758
    reference variance = 0.21945
====================================================
  Execution time = 2.0375e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3521e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335253346357
                                         uncertainty =       0.003674292016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335253346357
                                         uncertainty =       0.003674292016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409394977
  error estimate for blocks of size 2^( 2) =       0.000422135104
  error estimate for blocks of size 2^( 3) =       0.000434259582
  error estimate for blocks of size 2^( 4) =       0.000445561295
  error estimate for blocks of size 2^( 5) =       0.000455301252
  error estimate for blocks of size 2^( 6) =       0.000463726992
  error estimate for blocks of size 2^( 7) =       0.000467933359

      target function =                  N/A
              le_mean =     -16.906203761285
             les_mean =     286.154933945088
             stat err =       0.000458130725
             autocorr =       1.252258007658
              std dev =       0.578971929035
             le_variance =       0.335208494611


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620376128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906203761285       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906203761285       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906203761285       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906203761285       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906203761285       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906203761285       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364391 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5925e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9292
    reference variance = 0.250179
====================================================
  Execution time = 2.0277e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3701e-01
  Total weights = 2.0000e+06
  Execution time = 1.8690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010850283
                                         uncertainty =       0.004338185017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010850283
                                         uncertainty =       0.004338185017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410495165
  error estimate for blocks of size 2^( 2) =       0.000423617187
  error estimate for blocks of size 2^( 3) =       0.000436408789
  error estimate for blocks of size 2^( 4) =       0.000448919526
  error estimate for blocks of size 2^( 5) =       0.000459607723
  error estimate for blocks of size 2^( 6) =       0.000467057820
  error estimate for blocks of size 2^( 7) =       0.000472421143

      target function =                  N/A
              le_mean =     -16.906013122288
             les_mean =     286.150292083030
             stat err =       0.000462001553
             autocorr =       1.266691274489
              std dev =       0.580527829273
             le_variance =       0.337012560560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010850283
                                         uncertainty =       0.004338185017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010850283
                                         uncertainty =       0.004338185017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410495165
  error estimate for blocks of size 2^( 2) =       0.000423617187
  error estimate for blocks of size 2^( 3) =       0.000436408789
  error estimate for blocks of size 2^( 4) =       0.000448919526
  error estimate for blocks of size 2^( 5) =       0.000459607723
  error estimate for blocks of size 2^( 6) =       0.000467057820
  error estimate for blocks of size 2^( 7) =       0.000472421143

      target function =                  N/A
              le_mean =     -16.906013122288
             les_mean =     286.150292083030
             stat err =       0.000462001553
             autocorr =       1.266691274489
              std dev =       0.580527829273
             le_variance =       0.337012560560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010850283
                                         uncertainty =       0.004338185017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010850283
                                         uncertainty =       0.004338185017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410495165
  error estimate for blocks of size 2^( 2) =       0.000423617187
  error estimate for blocks of size 2^( 3) =       0.000436408789
  error estimate for blocks of size 2^( 4) =       0.000448919526
  error estimate for blocks of size 2^( 5) =       0.000459607723
  error estimate for blocks of size 2^( 6) =       0.000467057820
  error estimate for blocks of size 2^( 7) =       0.000472421143

      target function =                  N/A
              le_mean =     -16.906013122288
             les_mean =     286.150292083030
             stat err =       0.000462001553
             autocorr =       1.266691274489
              std dev =       0.580527829273
             le_variance =       0.337012560560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010850283
                                         uncertainty =       0.004338185017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010850283
                                         uncertainty =       0.004338185017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410495165
  error estimate for blocks of size 2^( 2) =       0.000423617187
  error estimate for blocks of size 2^( 3) =       0.000436408789
  error estimate for blocks of size 2^( 4) =       0.000448919526
  error estimate for blocks of size 2^( 5) =       0.000459607723
  error estimate for blocks of size 2^( 6) =       0.000467057820
  error estimate for blocks of size 2^( 7) =       0.000472421143

      target function =                  N/A
              le_mean =     -16.906013122288
             les_mean =     286.150292083030
             stat err =       0.000462001553
             autocorr =       1.266691274489
              std dev =       0.580527829273
             le_variance =       0.337012560560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906013122288        initial  <--
     2.3842e+16     2.3842e+17             0.0000e+00       -16.906013122288
     9.5367e+16     9.5367e+17             0.0000e+00       -16.906013122288
     3.8147e+17     3.8147e+18             0.0000e+00       -16.906013122288

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7921
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5724e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8784
    reference variance = 0.40852
====================================================
  Execution time = 2.0241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4167e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341660009902
                                         uncertainty =       0.008121634840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341660009902
                                         uncertainty =       0.008121634840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413323146
  error estimate for blocks of size 2^( 2) =       0.000425610464
  error estimate for blocks of size 2^( 3) =       0.000437959123
  error estimate for blocks of size 2^( 4) =       0.000449829726
  error estimate for blocks of size 2^( 5) =       0.000460876177
  error estimate for blocks of size 2^( 6) =       0.000468199074
  error estimate for blocks of size 2^( 7) =       0.000470806402

      target function =                  N/A
              le_mean =     -16.906495568635
             les_mean =     286.171264287652
             stat err =       0.000462427845
             autocorr =       1.251723774100
              std dev =       0.584527198852
             le_variance =       0.341672046198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649556864e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906495568635       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906495568635       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906495568635       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+17 is 1.772410e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906495568635       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906495568635       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906495568635       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+17 is 4.431025e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906495568635       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906495568635       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906495568635       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 1.107756e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5786e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9155
    reference variance = 0.25701
====================================================
  Execution time = 2.0096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4125e-01
  Total weights = 2.0000e+06
  Execution time = 1.8626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341314064696
                                         uncertainty =       0.004182390175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341314064696
                                         uncertainty =       0.004182390175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065522
  error estimate for blocks of size 2^( 2) =       0.000425857618
  error estimate for blocks of size 2^( 3) =       0.000438866023
  error estimate for blocks of size 2^( 4) =       0.000450622133
  error estimate for blocks of size 2^( 5) =       0.000461313657
  error estimate for blocks of size 2^( 6) =       0.000470073980
  error estimate for blocks of size 2^( 7) =       0.000474015335

      target function =                  N/A
              le_mean =     -16.906246117911
             les_mean =     286.162403879430
             stat err =       0.000464006276
             autocorr =       1.261856058392
              std dev =       0.584162863153
             le_variance =       0.341246250687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341314064696
                                         uncertainty =       0.004182390175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341314064696
                                         uncertainty =       0.004182390175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065522
  error estimate for blocks of size 2^( 2) =       0.000425857618
  error estimate for blocks of size 2^( 3) =       0.000438866023
  error estimate for blocks of size 2^( 4) =       0.000450622133
  error estimate for blocks of size 2^( 5) =       0.000461313657
  error estimate for blocks of size 2^( 6) =       0.000470073980
  error estimate for blocks of size 2^( 7) =       0.000474015335

      target function =                  N/A
              le_mean =     -16.906246117911
             les_mean =     286.162403879430
             stat err =       0.000464006276
             autocorr =       1.261856058392
              std dev =       0.584162863153
             le_variance =       0.341246250687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341314064696
                                         uncertainty =       0.004182390175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341314064696
                                         uncertainty =       0.004182390175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065522
  error estimate for blocks of size 2^( 2) =       0.000425857618
  error estimate for blocks of size 2^( 3) =       0.000438866023
  error estimate for blocks of size 2^( 4) =       0.000450622133
  error estimate for blocks of size 2^( 5) =       0.000461313657
  error estimate for blocks of size 2^( 6) =       0.000470073980
  error estimate for blocks of size 2^( 7) =       0.000474015335

      target function =                  N/A
              le_mean =     -16.906246117911
             les_mean =     286.162403879430
             stat err =       0.000464006276
             autocorr =       1.261856058392
              std dev =       0.584162863153
             le_variance =       0.341246250687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341314064696
                                         uncertainty =       0.004182390175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341314064696
                                         uncertainty =       0.004182390175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065522
  error estimate for blocks of size 2^( 2) =       0.000425857618
  error estimate for blocks of size 2^( 3) =       0.000438866023
  error estimate for blocks of size 2^( 4) =       0.000450622133
  error estimate for blocks of size 2^( 5) =       0.000461313657
  error estimate for blocks of size 2^( 6) =       0.000470073980
  error estimate for blocks of size 2^( 7) =       0.000474015335

      target function =                  N/A
              le_mean =     -16.906246117911
             les_mean =     286.162403879430
             stat err =       0.000464006276
             autocorr =       1.261856058392
              std dev =       0.584162863153
             le_variance =       0.341246250687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906246117911        initial  <--
     2.3842e+17     2.3842e+18             1.7724e-22       -16.906246117911
     9.5367e+17     9.5367e+18             4.4310e-23       -16.906246117911
     3.8147e+18     3.8147e+19             1.1078e-23       -16.906246117911

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5110
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5303e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9124
    reference variance = 0.494632
====================================================
  Execution time = 2.0196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3870e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338686700661
                                         uncertainty =       0.003515437980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338686700661
                                         uncertainty =       0.003515437980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411519093
  error estimate for blocks of size 2^( 2) =       0.000424088984
  error estimate for blocks of size 2^( 3) =       0.000437111563
  error estimate for blocks of size 2^( 4) =       0.000449202184
  error estimate for blocks of size 2^( 5) =       0.000460019101
  error estimate for blocks of size 2^( 6) =       0.000467148974
  error estimate for blocks of size 2^( 7) =       0.000470176840

      target function =                  N/A
              le_mean =     -16.906312691100
             les_mean =     286.162104567780
             stat err =       0.000461636775
             autocorr =       1.258406106627
              std dev =       0.581975882572
             le_variance =       0.338695927895


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631269110e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906312691100       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906312691100       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906312691100       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906312691100       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906312691100       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906312691100       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906312691100       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906312691100       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906312691100       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367043 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5727e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9386
    reference variance = 0.295922
====================================================
  Execution time = 2.0217e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4421e-01
  Total weights = 2.0000e+06
  Execution time = 1.8594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344127591612
                                         uncertainty =       0.004335784506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344127591612
                                         uncertainty =       0.004335784506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414856893
  error estimate for blocks of size 2^( 2) =       0.000427570921
  error estimate for blocks of size 2^( 3) =       0.000439910815
  error estimate for blocks of size 2^( 4) =       0.000452225548
  error estimate for blocks of size 2^( 5) =       0.000463310186
  error estimate for blocks of size 2^( 6) =       0.000470885174
  error estimate for blocks of size 2^( 7) =       0.000478044919

      target function =                  N/A
              le_mean =     -16.905698591878
             les_mean =     286.146857191313
             stat err =       0.000466116457
             autocorr =       1.262386237534
              std dev =       0.586696245077
             le_variance =       0.344212483988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344127591612
                                         uncertainty =       0.004335784506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344127591612
                                         uncertainty =       0.004335784506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414856893
  error estimate for blocks of size 2^( 2) =       0.000427570921
  error estimate for blocks of size 2^( 3) =       0.000439910815
  error estimate for blocks of size 2^( 4) =       0.000452225548
  error estimate for blocks of size 2^( 5) =       0.000463310186
  error estimate for blocks of size 2^( 6) =       0.000470885174
  error estimate for blocks of size 2^( 7) =       0.000478044919

      target function =                  N/A
              le_mean =     -16.905698591878
             les_mean =     286.146857191313
             stat err =       0.000466116457
             autocorr =       1.262386237534
              std dev =       0.586696245077
             le_variance =       0.344212483988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344127591612
                                         uncertainty =       0.004335784506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344127591612
                                         uncertainty =       0.004335784506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414856893
  error estimate for blocks of size 2^( 2) =       0.000427570921
  error estimate for blocks of size 2^( 3) =       0.000439910815
  error estimate for blocks of size 2^( 4) =       0.000452225548
  error estimate for blocks of size 2^( 5) =       0.000463310186
  error estimate for blocks of size 2^( 6) =       0.000470885174
  error estimate for blocks of size 2^( 7) =       0.000478044919

      target function =                  N/A
              le_mean =     -16.905698591878
             les_mean =     286.146857191313
             stat err =       0.000466116457
             autocorr =       1.262386237534
              std dev =       0.586696245077
             le_variance =       0.344212483988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344127591612
                                         uncertainty =       0.004335784506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344127591612
                                         uncertainty =       0.004335784506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414856893
  error estimate for blocks of size 2^( 2) =       0.000427570921
  error estimate for blocks of size 2^( 3) =       0.000439910815
  error estimate for blocks of size 2^( 4) =       0.000452225548
  error estimate for blocks of size 2^( 5) =       0.000463310186
  error estimate for blocks of size 2^( 6) =       0.000470885174
  error estimate for blocks of size 2^( 7) =       0.000478044919

      target function =                  N/A
              le_mean =     -16.905698591878
             les_mean =     286.146857191313
             stat err =       0.000466116457
             autocorr =       1.262386237534
              std dev =       0.586696245077
             le_variance =       0.344212483988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905698591878        initial  <--
     2.3842e+18     2.3842e+19             0.0000e+00       -16.905698591878
     9.5367e+18     9.5367e+19             0.0000e+00       -16.905698591878
     3.8147e+19     3.8147e+20             0.0000e+00       -16.905698591878

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6304
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5377e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9429
    reference variance = 0.365495
====================================================
  Execution time = 2.0207e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4199e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342034726280
                                         uncertainty =       0.004250754266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342034726280
                                         uncertainty =       0.004250754266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413514220
  error estimate for blocks of size 2^( 2) =       0.000425747118
  error estimate for blocks of size 2^( 3) =       0.000438359932
  error estimate for blocks of size 2^( 4) =       0.000449737236
  error estimate for blocks of size 2^( 5) =       0.000460540087
  error estimate for blocks of size 2^( 6) =       0.000468690267
  error estimate for blocks of size 2^( 7) =       0.000470236739

      target function =                  N/A
              le_mean =     -16.906706583692
             les_mean =     286.178715356807
             stat err =       0.000462301082
             autocorr =       1.249881735702
              std dev =       0.584797418550
             le_variance =       0.341988020742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690670658369e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906706583692       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906706583692       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906706583692       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906706583692       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906706583692       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906706583692       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5700e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9891
    reference variance = 0.193385
====================================================
  Execution time = 2.0389e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3710e-01
  Total weights = 2.0000e+06
  Execution time = 1.8641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337106101330
                                         uncertainty =       0.004681002477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337106101330
                                         uncertainty =       0.004681002477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410546547
  error estimate for blocks of size 2^( 2) =       0.000423532015
  error estimate for blocks of size 2^( 3) =       0.000436429573
  error estimate for blocks of size 2^( 4) =       0.000448235929
  error estimate for blocks of size 2^( 5) =       0.000457099545
  error estimate for blocks of size 2^( 6) =       0.000465020179
  error estimate for blocks of size 2^( 7) =       0.000470881834

      target function =                  N/A
              le_mean =     -16.906336419336
             les_mean =     286.161307890064
             stat err =       0.000460309372
             autocorr =       1.257114471612
              std dev =       0.580600495033
             le_variance =       0.337096934832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337106101330
                                         uncertainty =       0.004681002477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337106101330
                                         uncertainty =       0.004681002477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410546547
  error estimate for blocks of size 2^( 2) =       0.000423532015
  error estimate for blocks of size 2^( 3) =       0.000436429573
  error estimate for blocks of size 2^( 4) =       0.000448235929
  error estimate for blocks of size 2^( 5) =       0.000457099545
  error estimate for blocks of size 2^( 6) =       0.000465020179
  error estimate for blocks of size 2^( 7) =       0.000470881834

      target function =                  N/A
              le_mean =     -16.906336419336
             les_mean =     286.161307890064
             stat err =       0.000460309372
             autocorr =       1.257114471612
              std dev =       0.580600495033
             le_variance =       0.337096934832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337106101330
                                         uncertainty =       0.004681002477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337106101330
                                         uncertainty =       0.004681002477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410546547
  error estimate for blocks of size 2^( 2) =       0.000423532015
  error estimate for blocks of size 2^( 3) =       0.000436429573
  error estimate for blocks of size 2^( 4) =       0.000448235929
  error estimate for blocks of size 2^( 5) =       0.000457099545
  error estimate for blocks of size 2^( 6) =       0.000465020179
  error estimate for blocks of size 2^( 7) =       0.000470881834

      target function =                  N/A
              le_mean =     -16.906336419336
             les_mean =     286.161307890064
             stat err =       0.000460309372
             autocorr =       1.257114471612
              std dev =       0.580600495033
             le_variance =       0.337096934832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337106101330
                                         uncertainty =       0.004681002477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337106101330
                                         uncertainty =       0.004681002477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410546547
  error estimate for blocks of size 2^( 2) =       0.000423532015
  error estimate for blocks of size 2^( 3) =       0.000436429573
  error estimate for blocks of size 2^( 4) =       0.000448235929
  error estimate for blocks of size 2^( 5) =       0.000457099545
  error estimate for blocks of size 2^( 6) =       0.000465020179
  error estimate for blocks of size 2^( 7) =       0.000470881834

      target function =                  N/A
              le_mean =     -16.906336419336
             les_mean =     286.161307890064
             stat err =       0.000460309372
             autocorr =       1.257114471612
              std dev =       0.580600495033
             le_variance =       0.337096934832


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906336419336        initial  <--
     2.3842e+19     2.3842e+20             0.0000e+00       -16.906336419336
     9.5367e+19     9.5367e+20             0.0000e+00       -16.906336419336
     3.8147e+20     3.8147e+21             0.0000e+00       -16.906336419336

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8112
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5530e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9919
    reference variance = 0.672393
====================================================
  Execution time = 2.2628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3869e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338709175371
                                         uncertainty =       0.003850347283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338709175371
                                         uncertainty =       0.003850347283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411514011
  error estimate for blocks of size 2^( 2) =       0.000424052433
  error estimate for blocks of size 2^( 3) =       0.000436852964
  error estimate for blocks of size 2^( 4) =       0.000448815493
  error estimate for blocks of size 2^( 5) =       0.000458859941
  error estimate for blocks of size 2^( 6) =       0.000465419604
  error estimate for blocks of size 2^( 7) =       0.000468488357

      target function =                  N/A
              le_mean =     -16.905750766381
             les_mean =     286.143096367912
             stat err =       0.000460395849
             autocorr =       1.251680670925
              std dev =       0.581968695249
             le_variance =       0.338687562249


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575076638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905750766381       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905750766381       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905750766381       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905750766381       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905750766381       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905750766381       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905750766381       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+21 is 1.187561e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.369276 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8136e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9164
    reference variance = 0.264556
====================================================
  Execution time = 2.0078e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3370e-01
  Total weights = 2.0000e+06
  Execution time = 1.8635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333710010185
                                         uncertainty =       0.003068736489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333710010185
                                         uncertainty =       0.003068736489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408471285
  error estimate for blocks of size 2^( 2) =       0.000421507986
  error estimate for blocks of size 2^( 3) =       0.000434337098
  error estimate for blocks of size 2^( 4) =       0.000446109690
  error estimate for blocks of size 2^( 5) =       0.000456589419
  error estimate for blocks of size 2^( 6) =       0.000465628456
  error estimate for blocks of size 2^( 7) =       0.000470588848

      target function =                  N/A
              le_mean =     -16.905489857905
             les_mean =     286.129284750272
             stat err =       0.000459729103
             autocorr =       1.266720889240
              std dev =       0.577665631131
             le_variance =       0.333697581390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333710010185
                                         uncertainty =       0.003068736489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333710010185
                                         uncertainty =       0.003068736489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408471285
  error estimate for blocks of size 2^( 2) =       0.000421507986
  error estimate for blocks of size 2^( 3) =       0.000434337098
  error estimate for blocks of size 2^( 4) =       0.000446109690
  error estimate for blocks of size 2^( 5) =       0.000456589419
  error estimate for blocks of size 2^( 6) =       0.000465628456
  error estimate for blocks of size 2^( 7) =       0.000470588848

      target function =                  N/A
              le_mean =     -16.905489857905
             les_mean =     286.129284750272
             stat err =       0.000459729103
             autocorr =       1.266720889240
              std dev =       0.577665631131
             le_variance =       0.333697581390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333710010185
                                         uncertainty =       0.003068736489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333710010185
                                         uncertainty =       0.003068736489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408471285
  error estimate for blocks of size 2^( 2) =       0.000421507986
  error estimate for blocks of size 2^( 3) =       0.000434337098
  error estimate for blocks of size 2^( 4) =       0.000446109690
  error estimate for blocks of size 2^( 5) =       0.000456589419
  error estimate for blocks of size 2^( 6) =       0.000465628456
  error estimate for blocks of size 2^( 7) =       0.000470588848

      target function =                  N/A
              le_mean =     -16.905489857905
             les_mean =     286.129284750272
             stat err =       0.000459729103
             autocorr =       1.266720889240
              std dev =       0.577665631131
             le_variance =       0.333697581390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333710010185
                                         uncertainty =       0.003068736489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333710010185
                                         uncertainty =       0.003068736489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408471285
  error estimate for blocks of size 2^( 2) =       0.000421507986
  error estimate for blocks of size 2^( 3) =       0.000434337098
  error estimate for blocks of size 2^( 4) =       0.000446109690
  error estimate for blocks of size 2^( 5) =       0.000456589419
  error estimate for blocks of size 2^( 6) =       0.000465628456
  error estimate for blocks of size 2^( 7) =       0.000470588848

      target function =                  N/A
              le_mean =     -16.905489857905
             les_mean =     286.129284750272
             stat err =       0.000459729103
             autocorr =       1.266720889240
              std dev =       0.577665631131
             le_variance =       0.333697581390


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905489857905        initial  <--
     2.3842e+20     2.3842e+21             0.0000e+00       -16.905489857905
     9.5367e+20     9.5367e+21             0.0000e+00       -16.905489857905
     3.8147e+21     3.8147e+22             1.1876e-26       -16.905489857905

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4832
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.119027e-01 1 1  ON 0
 uu_1                 1.447644e-01 1 1  ON 1
 uu_2                 4.283048e-02 1 1  ON 2
 uu_3                -2.009056e-02 1 1  ON 3
 uu_4                -6.622479e-02 1 1  ON 4
 uu_5                -1.019625e-01 1 1  ON 5
 uu_6                -1.301786e-01 1 1  ON 6
 uu_7                -1.447708e-01 1 1  ON 7
 uu_8                -1.378457e-01 1 1  ON 8
 uu_9                -1.085017e-01 1 1  ON 9
 ud_0                 4.510911e-01 1 1  ON 10
 ud_1                 1.849190e-01 1 1  ON 11
 ud_2                 6.413327e-02 1 1  ON 12
 ud_3                -7.494902e-03 1 1  ON 13
 ud_4                -6.508117e-02 1 1  ON 14
 ud_5                -1.070096e-01 1 1  ON 15
 ud_6                -1.351384e-01 1 1  ON 16
 ud_7                -1.519485e-01 1 1  ON 17
 ud_8                -1.530499e-01 1 1  ON 18
 ud_9                -1.416735e-01 1 1  ON 19
 eO_0                -7.565029e-01 1 1  ON 20
 eO_1                -4.349852e-01 1 1  ON 21
 eO_2                -1.830981e-02 1 1  ON 22
 eO_3                 2.998817e-01 1 1  ON 23
 eO_4                 5.267951e-01 1 1  ON 24
 eO_5                 4.897751e-01 1 1  ON 25
 eO_6                 2.601941e-01 1 1  ON 26
 eO_7                -4.207305e-02 1 1  ON 27
 eO_8                -2.288039e-01 1 1  ON 28
 eO_9                -9.350273e-02 1 1  ON 29
eH1_0                -2.560540e-01 1 1  ON 30
eH1_1                -1.520700e-01 1 1  ON 31
eH1_2                -1.036247e-01 1 1  ON 32
eH1_3                -4.830958e-02 1 1  ON 33
eH1_4                 1.441136e-03 1 1  ON 34
eH1_5                 3.734827e-02 1 1  ON 35
eH1_6                 9.665943e-02 1 1  ON 36
eH1_7                 1.560749e-01 1 1  ON 37
eH1_8                 1.877784e-01 1 1  ON 38
eH1_9                 8.153203e-02 1 1  ON 39
eH2_0                -2.528837e-01 1 1  ON 40
eH2_1                -1.487448e-01 1 1  ON 41
eH2_2                -1.003116e-01 1 1  ON 42
eH2_3                -4.515755e-02 1 1  ON 43
eH2_4                 4.106201e-03 1 1  ON 44
eH2_5                 3.958872e-02 1 1  ON 45
eH2_6                 9.885952e-02 1 1  ON 46
eH2_7                 1.592561e-01 1 1  ON 47
eH2_8                 1.921720e-01 1 1  ON 48
eH2_9                 6.867299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7626e+01 secs
  Total Execution time = 2.2656e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
