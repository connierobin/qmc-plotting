Rank =    0  Free Memory = 87389 MB
Rank =    1  Free Memory = 87388 MB
Rank =    2  Free Memory = 87388 MB
Rank =    3  Free Memory = 87388 MB
Rank =    4  Free Memory = 87388 MB
Rank =    5  Free Memory = 87388 MB
Rank =    6  Free Memory = 87387 MB
Rank =    7  Free Memory = 87387 MB
Rank =    8  Free Memory = 87387 MB
Rank =    9  Free Memory = 87387 MB
Rank =   10  Free Memory = 87387 MB
Rank =   11  Free Memory = 87387 MB
Rank =   12  Free Memory = 87387 MB
Rank =   13  Free Memory = 87387 MB
Rank =   14  Free Memory = 87387 MB
Rank =   15  Free Memory = 87373 MB
Rank =   16  Free Memory = 87373 MB
Rank =   17  Free Memory = 87373 MB
Rank =   18  Free Memory = 87373 MB
Rank =   19  Free Memory = 87373 MB
Rank =   20  Free Memory = 87373 MB
Rank =   21  Free Memory = 87373 MB
Rank =   22  Free Memory = 87373 MB
Rank =   23  Free Memory = 87373 MB
Rank =   24  Free Memory = 87373 MB
Rank =   25  Free Memory = 87373 MB
Rank =   26  Free Memory = 87373 MB
Rank =   27  Free Memory = 87373 MB
Rank =   28  Free Memory = 87373 MB
Rank =   29  Free Memory = 87373 MB
Rank =   30  Free Memory = 87373 MB
Rank =   31  Free Memory = 87373 MB
Rank =   32  Free Memory = 85017 MB
Rank =   33  Free Memory = 85017 MB
Rank =   34  Free Memory = 85016 MB
Rank =   35  Free Memory = 85016 MB
Rank =   36  Free Memory = 85016 MB
Rank =   37  Free Memory = 85016 MB
Rank =   38  Free Memory = 85016 MB
Rank =   39  Free Memory = 85016 MB
Rank =   40  Free Memory = 85016 MB
Rank =   41  Free Memory = 85016 MB
Rank =   42  Free Memory = 85016 MB
Rank =   43  Free Memory = 85016 MB
Rank =   44  Free Memory = 85016 MB
Rank =   45  Free Memory = 85016 MB
Rank =   46  Free Memory = 85016 MB
Rank =   47  Free Memory = 85016 MB
Rank =   48  Free Memory = 85016 MB
Rank =   49  Free Memory = 85016 MB
Rank =   50  Free Memory = 85016 MB
Rank =   51  Free Memory = 85016 MB
Rank =   52  Free Memory = 85016 MB
Rank =   53  Free Memory = 85016 MB
Rank =   54  Free Memory = 85016 MB
Rank =   55  Free Memory = 85016 MB
Rank =   56  Free Memory = 85016 MB
Rank =   57  Free Memory = 85016 MB
Rank =   58  Free Memory = 85016 MB
Rank =   59  Free Memory = 85016 MB
Rank =   60  Free Memory = 85016 MB
Rank =   61  Free Memory = 85016 MB
Rank =   62  Free Memory = 85016 MB
Rank =   63  Free Memory = 85016 MB
Rank =   64  Free Memory = 76993 MB
Rank =   65  Free Memory = 76993 MB
Rank =   66  Free Memory = 76993 MB
Rank =   67  Free Memory = 76993 MB
Rank =   68  Free Memory = 76993 MB
Rank =   69  Free Memory = 76992 MB
Rank =   70  Free Memory = 76992 MB
Rank =   71  Free Memory = 76992 MB
Rank =   72  Free Memory = 76992 MB
Rank =   73  Free Memory = 76992 MB
Rank =   74  Free Memory = 76992 MB
Rank =   75  Free Memory = 76992 MB
Rank =   76  Free Memory = 76992 MB
Rank =   77  Free Memory = 76992 MB
Rank =   78  Free Memory = 76992 MB
Rank =   79  Free Memory = 76992 MB
Rank =   80  Free Memory = 76992 MB
Rank =   81  Free Memory = 76992 MB
Rank =   82  Free Memory = 76992 MB
Rank =   83  Free Memory = 76992 MB
Rank =   84  Free Memory = 76992 MB
Rank =   85  Free Memory = 76992 MB
Rank =   86  Free Memory = 76992 MB
Rank =   87  Free Memory = 76992 MB
Rank =   88  Free Memory = 76992 MB
Rank =   89  Free Memory = 76992 MB
Rank =   90  Free Memory = 76992 MB
Rank =   91  Free Memory = 76992 MB
Rank =   92  Free Memory = 76992 MB
Rank =   93  Free Memory = 76992 MB
Rank =   94  Free Memory = 76992 MB
Rank =   95  Free Memory = 76992 MB
Rank =   96  Free Memory = 71720 MB
Rank =   97  Free Memory = 71720 MB
Rank =   98  Free Memory = 71720 MB
Rank =   99  Free Memory = 71720 MB
Rank =  100  Free Memory = 71720 MB
Rank =  101  Free Memory = 71720 MB
Rank =  102  Free Memory = 71720 MB
Rank =  103  Free Memory = 71720 MB
Rank =  104  Free Memory = 71720 MB
Rank =  105  Free Memory = 71720 MB
Rank =  106  Free Memory = 71720 MB
Rank =  107  Free Memory = 71720 MB
Rank =  108  Free Memory = 71720 MB
Rank =  109  Free Memory = 71720 MB
Rank =  110  Free Memory = 71720 MB
Rank =  111  Free Memory = 71720 MB
Rank =  112  Free Memory = 71720 MB
Rank =  113  Free Memory = 71720 MB
Rank =  114  Free Memory = 71720 MB
Rank =  115  Free Memory = 71720 MB
Rank =  116  Free Memory = 71720 MB
Rank =  117  Free Memory = 71720 MB
Rank =  118  Free Memory = 71720 MB
Rank =  119  Free Memory = 71720 MB
Rank =  120  Free Memory = 71720 MB
Rank =  121  Free Memory = 71720 MB
Rank =  122  Free Memory = 71720 MB
Rank =  123  Free Memory = 71720 MB
Rank =  124  Free Memory = 71720 MB
Rank =  125  Free Memory = 71720 MB
Rank =  126  Free Memory = 71720 MB
Rank =  127  Free Memory = 71720 MB
  Input file(s): opt_h2o_1b1_gvptt_run003t.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003t.xml

  Project = H2O
  date    = 2023-04-19 10:09:41 PDT
  host    = n0091.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 85

  Range of prime numbers to use as seeds over processors and threads = 449-1319


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.115237e-01    1         1  ON     0
     uu_1                 1.442749e-01    1         1  ON     1
     uu_2                 4.237860e-02    1         1  ON     2
     uu_3                -2.049807e-02    1         1  ON     3
     uu_4                -6.677617e-02    1         1  ON     4
     uu_5                -1.028152e-01    1         1  ON     5
     uu_6                -1.318067e-01    1         1  ON     6
     uu_7                -1.469737e-01    1         1  ON     7
     uu_8                -1.400136e-01    1         1  ON     8
     uu_9                -1.124501e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.542576e-01    1         1  ON     0
     ud_1                 1.880757e-01    1         1  ON     1
     ud_2                 6.722077e-02    1         1  ON     2
     ud_3                -4.470047e-03    1         1  ON     3
     ud_4                -6.195226e-02    1         1  ON     4
     ud_5                -1.044843e-01    1         1  ON     5
     ud_6                -1.334104e-01    1         1  ON     6
     ud_7                -1.515937e-01    1         1  ON     7
     ud_8                -1.538548e-01    1         1  ON     8
     ud_9                -1.462260e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.513044e-01    1         1  ON     0
     eO_1                -4.296051e-01    1         1  ON     1
     eO_2                -1.420843e-02    1         1  ON     2
     eO_3                 3.032107e-01    1         1  ON     3
     eO_4                 5.304576e-01    1         1  ON     4
     eO_5                 4.938934e-01    1         1  ON     5
     eO_6                 2.653268e-01    1         1  ON     6
     eO_7                -4.103286e-02    1         1  ON     7
     eO_8                -2.397470e-01    1         1  ON     8
     eO_9                -1.107749e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.644187e-01    1         1  ON     0
     eH1_1                -1.593305e-01    1         1  ON     1
     eH1_2                -1.096890e-01    1         1  ON     2
     eH1_3                -5.436770e-02    1         1  ON     3
     eH1_4                -3.900233e-03    1         1  ON     4
     eH1_5                 3.329279e-02    1         1  ON     5
     eH1_6                 9.615575e-02    1         1  ON     6
     eH1_7                 1.601511e-01    1         1  ON     7
     eH1_8                 1.990792e-01    1         1  ON     8
     eH1_9                 1.021447e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.606647e-01    1         1  ON     0
     eH2_1                -1.551854e-01    1         1  ON     1
     eH2_2                -1.060508e-01    1         1  ON     2
     eH2_3                -5.085487e-02    1         1  ON     3
     eH2_4                -6.095250e-04    1         1  ON     4
     eH2_5                 3.508374e-02    1         1  ON     5
     eH2_6                 9.763619e-02    1         1  ON     6
     eH2_7                 1.598680e-01    1         1  ON     7
     eH2_8                 2.003480e-01    1         1  ON     8
     eH2_9                 9.237096e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.574423e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9378e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9464
    reference variance = 0.258393
====================================================
  Execution time = 2.0661e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4057e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340698352732
                                         uncertainty =       0.005069317733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340698352732
                                         uncertainty =       0.005069317733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412658759
  error estimate for blocks of size 2^( 2) =       0.000425301831
  error estimate for blocks of size 2^( 3) =       0.000438179485
  error estimate for blocks of size 2^( 4) =       0.000449891689
  error estimate for blocks of size 2^( 5) =       0.000459182061
  error estimate for blocks of size 2^( 6) =       0.000468013822
  error estimate for blocks of size 2^( 7) =       0.000470738502

      target function =                  N/A
              le_mean =     -16.906527703258
             les_mean =     286.171253313966
             stat err =       0.000461956518
             autocorr =       1.253199066259
              std dev =       0.583587614001
             le_variance =       0.340574503216


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690652770326e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906527703258       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906528274951       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906529408287       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906529643967       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906529326863       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906529174426       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906529665190       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906529278252       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906529664262       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.332449e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906527703258       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906527909782       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906528362435       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906528534966       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906528459721       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906528201376       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906528345947       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906528286874       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906528365351       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.667946e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906527703258       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906527761352       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906527896980       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906527955119       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906527942988       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906527857046       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906527888568       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906527873392       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 4.011605e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6413e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.115175e-01                 1 1 ON  0
uu_1  1.444001e-01                 1 1 ON  1
uu_2  4.242343e-02                 1 1 ON  2
uu_3  -2.050735e-02                1 1 ON  3
uu_4  -6.669455e-02                1 1 ON  4
uu_5  -1.027993e-01                1 1 ON  5
uu_6  -1.318645e-01                1 1 ON  6
uu_7  -1.470804e-01                1 1 ON  7
uu_8  -1.401294e-01                1 1 ON  8
uu_9  -1.125441e-01                1 1 ON  9
ud_0  4.542212e-01                 1 1 ON  10
ud_1  1.880848e-01                 1 1 ON  11
ud_2  6.720024e-02                 1 1 ON  12
ud_3  -4.449120e-03                1 1 ON  13
ud_4  -6.197374e-02                1 1 ON  14
ud_5  -1.044773e-01                1 1 ON  15
ud_6  -1.332983e-01                1 1 ON  16
ud_7  -1.516204e-01                1 1 ON  17
ud_8  -1.538537e-01                1 1 ON  18
ud_9  -1.461951e-01                1 1 ON  19
eO_0  -7.513031e-01                1 1 ON  20
eO_1  -4.295340e-01                1 1 ON  21
eO_2  -1.413414e-02                1 1 ON  22
eO_3  3.032724e-01                 1 1 ON  23
eO_4  5.305012e-01                 1 1 ON  24
eO_5  4.938897e-01                 1 1 ON  25
eO_6  2.653740e-01                 1 1 ON  26
eO_7  -4.109207e-02                1 1 ON  27
eO_8  -2.398372e-01                1 1 ON  28
eO_9  -1.109001e-01                1 1 ON  29
eH1_0 -2.644341e-01                1 1 ON  30
eH1_1 -1.592862e-01                1 1 ON  31
eH1_2 -1.097630e-01                1 1 ON  32
eH1_3 -5.437663e-02                1 1 ON  33
eH1_4 -3.987688e-03                1 1 ON  34
eH1_5 3.323595e-02                 1 1 ON  35
eH1_6 9.611558e-02                 1 1 ON  36
eH1_7 1.601186e-01                 1 1 ON  37
eH1_8 1.991360e-01                 1 1 ON  38
eH1_9 1.023115e-01                 1 1 ON  39
eH2_0 -2.606879e-01                1 1 ON  40
eH2_1 -1.551654e-01                1 1 ON  41
eH2_2 -1.060807e-01                1 1 ON  42
eH2_3 -5.088662e-02                1 1 ON  43
eH2_4 -6.913252e-04                1 1 ON  44
eH2_5 3.511061e-02                 1 1 ON  45
eH2_6 9.761603e-02                 1 1 ON  46
eH2_7 1.598475e-01                 1 1 ON  47
eH2_8 2.004003e-01                 1 1 ON  48
eH2_9 9.249470e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9181
    reference variance = 0.251527
====================================================
  Execution time = 2.0492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4041e-01
  Total weights = 2.0000e+06
  Execution time = 1.8919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340496680849
                                         uncertainty =       0.003745242920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340496680849
                                         uncertainty =       0.003745242920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412559091
  error estimate for blocks of size 2^( 2) =       0.000425076535
  error estimate for blocks of size 2^( 3) =       0.000438880285
  error estimate for blocks of size 2^( 4) =       0.000452229893
  error estimate for blocks of size 2^( 5) =       0.000463066950
  error estimate for blocks of size 2^( 6) =       0.000471775892
  error estimate for blocks of size 2^( 7) =       0.000479230453

      target function =                  N/A
              le_mean =     -16.906071152479
             les_mean =     286.155651649643
             stat err =       0.000466575797
             autocorr =       1.279004551255
              std dev =       0.583446661808
             le_variance =       0.340410007175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340515672871
                                         uncertainty =       0.003745478370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340515672871
                                         uncertainty =       0.003745478370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412570557
  error estimate for blocks of size 2^( 2) =       0.000425082422
  error estimate for blocks of size 2^( 3) =       0.000438879356
  error estimate for blocks of size 2^( 4) =       0.000452224043
  error estimate for blocks of size 2^( 5) =       0.000463061852
  error estimate for blocks of size 2^( 6) =       0.000471775542
  error estimate for blocks of size 2^( 7) =       0.000479230595

      target function =                  N/A
              le_mean =     -16.906070170555
             les_mean =     286.155637370572
             stat err =       0.000466573008
             autocorr =       1.278918172823
              std dev =       0.583462877198
             le_variance =       0.340428929068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340503796658
                                         uncertainty =       0.003745289697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340503796658
                                         uncertainty =       0.003745289697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412563372
  error estimate for blocks of size 2^( 2) =       0.000425076530
  error estimate for blocks of size 2^( 3) =       0.000438875016
  error estimate for blocks of size 2^( 4) =       0.000452221054
  error estimate for blocks of size 2^( 5) =       0.000463059130
  error estimate for blocks of size 2^( 6) =       0.000471771787
  error estimate for blocks of size 2^( 7) =       0.000479227360

      target function =                  N/A
              le_mean =     -16.906070083783
             les_mean =     286.155622579814
             stat err =       0.000466569833
             autocorr =       1.278945309807
              std dev =       0.583452716364
             le_variance =       0.340417072232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340494993628
                                         uncertainty =       0.003745219823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340494993628
                                         uncertainty =       0.003745219823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412558064
  error estimate for blocks of size 2^( 2) =       0.000425074918
  error estimate for blocks of size 2^( 3) =       0.000438877934
  error estimate for blocks of size 2^( 4) =       0.000452227073
  error estimate for blocks of size 2^( 5) =       0.000463064346
  error estimate for blocks of size 2^( 6) =       0.000471773877
  error estimate for blocks of size 2^( 7) =       0.000479228628

      target function =                  N/A
              le_mean =     -16.906070942156
             les_mean =     286.155642843455
             stat err =       0.000466573481
             autocorr =       1.278998220797
              std dev =       0.583445209451
             le_variance =       0.340408312432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906071152479        initial  <--
     2.5000e-01     2.5000e+00             6.3324e-04       -16.906070170555
     1.0000e+00     1.0000e+01             1.6679e-04       -16.906070083783
     4.0000e+00     4.0000e+01             4.0116e-05       -16.906070942156

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0428
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.115237e-01 1 1  ON 0
 uu_1                 1.442749e-01 1 1  ON 1
 uu_2                 4.237860e-02 1 1  ON 2
 uu_3                -2.049807e-02 1 1  ON 3
 uu_4                -6.677617e-02 1 1  ON 4
 uu_5                -1.028152e-01 1 1  ON 5
 uu_6                -1.318067e-01 1 1  ON 6
 uu_7                -1.469737e-01 1 1  ON 7
 uu_8                -1.400136e-01 1 1  ON 8
 uu_9                -1.124501e-01 1 1  ON 9
 ud_0                 4.542576e-01 1 1  ON 10
 ud_1                 1.880757e-01 1 1  ON 11
 ud_2                 6.722077e-02 1 1  ON 12
 ud_3                -4.470047e-03 1 1  ON 13
 ud_4                -6.195226e-02 1 1  ON 14
 ud_5                -1.044843e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.515937e-01 1 1  ON 17
 ud_8                -1.538548e-01 1 1  ON 18
 ud_9                -1.462260e-01 1 1  ON 19
 eO_0                -7.513044e-01 1 1  ON 20
 eO_1                -4.296051e-01 1 1  ON 21
 eO_2                -1.420843e-02 1 1  ON 22
 eO_3                 3.032107e-01 1 1  ON 23
 eO_4                 5.304576e-01 1 1  ON 24
 eO_5                 4.938934e-01 1 1  ON 25
 eO_6                 2.653268e-01 1 1  ON 26
 eO_7                -4.103286e-02 1 1  ON 27
 eO_8                -2.397470e-01 1 1  ON 28
 eO_9                -1.107749e-01 1 1  ON 29
eH1_0                -2.644187e-01 1 1  ON 30
eH1_1                -1.593305e-01 1 1  ON 31
eH1_2                -1.096890e-01 1 1  ON 32
eH1_3                -5.436770e-02 1 1  ON 33
eH1_4                -3.900233e-03 1 1  ON 34
eH1_5                 3.329279e-02 1 1  ON 35
eH1_6                 9.615575e-02 1 1  ON 36
eH1_7                 1.601511e-01 1 1  ON 37
eH1_8                 1.990792e-01 1 1  ON 38
eH1_9                 1.021447e-01 1 1  ON 39
eH2_0                -2.606647e-01 1 1  ON 40
eH2_1                -1.551854e-01 1 1  ON 41
eH2_2                -1.060508e-01 1 1  ON 42
eH2_3                -5.085487e-02 1 1  ON 43
eH2_4                -6.095250e-04 1 1  ON 44
eH2_5                 3.508374e-02 1 1  ON 45
eH2_6                 9.763619e-02 1 1  ON 46
eH2_7                 1.598680e-01 1 1  ON 47
eH2_8                 2.003480e-01 1 1  ON 48
eH2_9                 9.237096e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6466e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6932e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8995
    reference variance = 0.177411
====================================================
  Execution time = 2.0769e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4241e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342503177556
                                         uncertainty =       0.005654066386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342503177556
                                         uncertainty =       0.005654066386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413772079
  error estimate for blocks of size 2^( 2) =       0.000426688460
  error estimate for blocks of size 2^( 3) =       0.000439349570
  error estimate for blocks of size 2^( 4) =       0.000451272699
  error estimate for blocks of size 2^( 5) =       0.000461504087
  error estimate for blocks of size 2^( 6) =       0.000469425609
  error estimate for blocks of size 2^( 7) =       0.000474738866

      target function =                  N/A
              le_mean =     -16.906172670927
             les_mean =     286.161088873972
             stat err =       0.000464235315
             autocorr =       1.258792040346
              std dev =       0.585162085213
             le_variance =       0.342414665970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617267093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906172670927       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906172715513       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906172935414       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906173157658       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906173255256       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906173265067       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906173299602       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906173286974       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 7.709269e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906172670927       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906172682657       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906172746395       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906172809568       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906172829189       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906172830187       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906172836876       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906172836556       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.935635e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906172670927       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906172673899       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906172690463       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906172706878       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906172711316       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906172711509       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906172713050       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 4.653147e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230300 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6333e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.115421e-01 1 1  ON 0
 uu_1                 1.442760e-01 1 1  ON 1
 uu_2                 4.237706e-02 1 1  ON 2
 uu_3                -2.050593e-02 1 1  ON 3
 uu_4                -6.677849e-02 1 1  ON 4
 uu_5                -1.028213e-01 1 1  ON 5
 uu_6                -1.318053e-01 1 1  ON 6
 uu_7                -1.469845e-01 1 1  ON 7
 uu_8                -1.400249e-01 1 1  ON 8
 uu_9                -1.124513e-01 1 1  ON 9
 ud_0                 4.542485e-01 1 1  ON 10
 ud_1                 1.880781e-01 1 1  ON 11
 ud_2                 6.722662e-02 1 1  ON 12
 ud_3                -4.469266e-03 1 1  ON 13
 ud_4                -6.195687e-02 1 1  ON 14
 ud_5                -1.044826e-01 1 1  ON 15
 ud_6                -1.334159e-01 1 1  ON 16
 ud_7                -1.515841e-01 1 1  ON 17
 ud_8                -1.538442e-01 1 1  ON 18
 ud_9                -1.462268e-01 1 1  ON 19
 eO_0                -7.512956e-01 1 1  ON 20
 eO_1                -4.296139e-01 1 1  ON 21
 eO_2                -1.420606e-02 1 1  ON 22
 eO_3                 3.032149e-01 1 1  ON 23
 eO_4                 5.304607e-01 1 1  ON 24
 eO_5                 4.939029e-01 1 1  ON 25
 eO_6                 2.653309e-01 1 1  ON 26
 eO_7                -4.103434e-02 1 1  ON 27
 eO_8                -2.397544e-01 1 1  ON 28
 eO_9                -1.107874e-01 1 1  ON 29
eH1_0                -2.644272e-01 1 1  ON 30
eH1_1                -1.593293e-01 1 1  ON 31
eH1_2                -1.096961e-01 1 1  ON 32
eH1_3                -5.437320e-02 1 1  ON 33
eH1_4                -3.904886e-03 1 1  ON 34
eH1_5                 3.327953e-02 1 1  ON 35
eH1_6                 9.616381e-02 1 1  ON 36
eH1_7                 1.601593e-01 1 1  ON 37
eH1_8                 1.990850e-01 1 1  ON 38
eH1_9                 1.021581e-01 1 1  ON 39
eH2_0                -2.606688e-01 1 1  ON 40
eH2_1                -1.551883e-01 1 1  ON 41
eH2_2                -1.060551e-01 1 1  ON 42
eH2_3                -5.085271e-02 1 1  ON 43
eH2_4                -6.217638e-04 1 1  ON 44
eH2_5                 3.507822e-02 1 1  ON 45
eH2_6                 9.763308e-02 1 1  ON 46
eH2_7                 1.598694e-01 1 1  ON 47
eH2_8                 2.003531e-01 1 1  ON 48
eH2_9                 9.239032e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8779
    reference variance = 0.241717
====================================================
  Execution time = 2.0059e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3886e-01
  Total weights = 2.0000e+06
  Execution time = 1.8863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338936972952
                                         uncertainty =       0.004436882946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338936972952
                                         uncertainty =       0.004436882946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411620595
  error estimate for blocks of size 2^( 2) =       0.000424134303
  error estimate for blocks of size 2^( 3) =       0.000437012981
  error estimate for blocks of size 2^( 4) =       0.000447884354
  error estimate for blocks of size 2^( 5) =       0.000457341996
  error estimate for blocks of size 2^( 6) =       0.000463007120
  error estimate for blocks of size 2^( 7) =       0.000467317357

      target function =                  N/A
              le_mean =     -16.906646854005
             les_mean =     286.173570705691
             stat err =       0.000458887707
             autocorr =       1.242849821139
              std dev =       0.582119428546
             le_variance =       0.338863029090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338916782375
                                         uncertainty =       0.004436762041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338916782375
                                         uncertainty =       0.004436762041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411608334
  error estimate for blocks of size 2^( 2) =       0.000424122852
  error estimate for blocks of size 2^( 3) =       0.000437001857
  error estimate for blocks of size 2^( 4) =       0.000447873606
  error estimate for blocks of size 2^( 5) =       0.000457331053
  error estimate for blocks of size 2^( 6) =       0.000462996756
  error estimate for blocks of size 2^( 7) =       0.000467307834

      target function =                  N/A
              le_mean =     -16.906646934343
             les_mean =     286.173553234875
             stat err =       0.000458877312
             autocorr =       1.242867558650
              std dev =       0.582102088789
             le_variance =       0.338842841772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338924841900
                                         uncertainty =       0.004436803756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338924841900
                                         uncertainty =       0.004436803756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411613228
  error estimate for blocks of size 2^( 2) =       0.000424127414
  error estimate for blocks of size 2^( 3) =       0.000437006299
  error estimate for blocks of size 2^( 4) =       0.000447877903
  error estimate for blocks of size 2^( 5) =       0.000457335441
  error estimate for blocks of size 2^( 6) =       0.000463000882
  error estimate for blocks of size 2^( 7) =       0.000467311570

      target function =                  N/A
              le_mean =     -16.906646894453
             les_mean =     286.173559943846
             stat err =       0.000458881449
             autocorr =       1.242860411822
              std dev =       0.582109010020
             le_variance =       0.338850899546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338935389680
                                         uncertainty =       0.004436872132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338935389680
                                         uncertainty =       0.004436872132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411619634
  error estimate for blocks of size 2^( 2) =       0.000424133401
  error estimate for blocks of size 2^( 3) =       0.000437012105
  error estimate for blocks of size 2^( 4) =       0.000447883508
  error estimate for blocks of size 2^( 5) =       0.000457341137
  error estimate for blocks of size 2^( 6) =       0.000463006308
  error estimate for blocks of size 2^( 7) =       0.000467316603

      target function =                  N/A
              le_mean =     -16.906646858453
             les_mean =     286.173569273060
             stat err =       0.000458886889
             autocorr =       1.242851197497
              std dev =       0.582118068837
             le_variance =       0.338861446067


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906646854005        initial
     2.5000e+00     2.5000e+01             7.7093e-05       -16.906646934343  <--
     1.0000e+01     1.0000e+02             1.9356e-05       -16.906646894453
     4.0000e+01     4.0000e+02             4.6531e-06       -16.906646858453

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.9547e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.115932e-01 1 1  ON 0
 uu_1                 1.442790e-01 1 1  ON 1
 uu_2                 4.237368e-02 1 1  ON 2
 uu_3                -2.052673e-02 1 1  ON 3
 uu_4                -6.678554e-02 1 1  ON 4
 uu_5                -1.028390e-01 1 1  ON 5
 uu_6                -1.318023e-01 1 1  ON 6
 uu_7                -1.470162e-01 1 1  ON 7
 uu_8                -1.400582e-01 1 1  ON 8
 uu_9                -1.124548e-01 1 1  ON 9
 ud_0                 4.542251e-01 1 1  ON 10
 ud_1                 1.880841e-01 1 1  ON 11
 ud_2                 6.724110e-02 1 1  ON 12
 ud_3                -4.466927e-03 1 1  ON 13
 ud_4                -6.196972e-02 1 1  ON 14
 ud_5                -1.044786e-01 1 1  ON 15
 ud_6                -1.334307e-01 1 1  ON 16
 ud_7                -1.515562e-01 1 1  ON 17
 ud_8                -1.538130e-01 1 1  ON 18
 ud_9                -1.462292e-01 1 1  ON 19
 eO_0                -7.512731e-01 1 1  ON 20
 eO_1                -4.296355e-01 1 1  ON 21
 eO_2                -1.419953e-02 1 1  ON 22
 eO_3                 3.032271e-01 1 1  ON 23
 eO_4                 5.304698e-01 1 1  ON 24
 eO_5                 4.939310e-01 1 1  ON 25
 eO_6                 2.653434e-01 1 1  ON 26
 eO_7                -4.103869e-02 1 1  ON 27
 eO_8                -2.397763e-01 1 1  ON 28
 eO_9                -1.108246e-01 1 1  ON 29
eH1_0                -2.644525e-01 1 1  ON 30
eH1_1                -1.593268e-01 1 1  ON 31
eH1_2                -1.097168e-01 1 1  ON 32
eH1_3                -5.438944e-02 1 1  ON 33
eH1_4                -3.919436e-03 1 1  ON 34
eH1_5                 3.324077e-02 1 1  ON 35
eH1_6                 9.618762e-02 1 1  ON 36
eH1_7                 1.601840e-01 1 1  ON 37
eH1_8                 1.991025e-01 1 1  ON 38
eH1_9                 1.021982e-01 1 1  ON 39
eH2_0                -2.606817e-01 1 1  ON 40
eH2_1                -1.551962e-01 1 1  ON 41
eH2_2                -1.060677e-01 1 1  ON 42
eH2_3                -5.084709e-02 1 1  ON 43
eH2_4                -6.570158e-04 1 1  ON 44
eH2_5                 3.506140e-02 1 1  ON 45
eH2_6                 9.762350e-02 1 1  ON 46
eH2_7                 1.598738e-01 1 1  ON 47
eH2_8                 2.003685e-01 1 1  ON 48
eH2_9                 9.244805e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5888e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9133
    reference variance = 0.137039
====================================================
  Execution time = 2.0540e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3224e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332257879500
                                         uncertainty =       0.002467232708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332257879500
                                         uncertainty =       0.002467232708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407580908
  error estimate for blocks of size 2^( 2) =       0.000420262912
  error estimate for blocks of size 2^( 3) =       0.000433147502
  error estimate for blocks of size 2^( 4) =       0.000444595454
  error estimate for blocks of size 2^( 5) =       0.000455216194
  error estimate for blocks of size 2^( 6) =       0.000463712316
  error estimate for blocks of size 2^( 7) =       0.000466592356

      target function =                  N/A
              le_mean =     -16.905988553863
             les_mean =     286.144693210445
             stat err =       0.000457529080
             autocorr =       1.260113717810
              std dev =       0.576406447946
             le_variance =       0.332244393234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598855386e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988553863       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905987708040       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905987780047       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905988080322       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905988228001       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905988121577       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905988387360       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905988423811       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905988354903       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.822933e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988553863       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988296057       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905988275656       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905988331289       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905988267102       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905988356778       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905988386777       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905988378409       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 6.858135e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988553863       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988485674       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905988476931       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905988487927       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905988462422       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905988467623       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905988495222       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905988493202       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.738506e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233179 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6086e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.115713e-01 1 1  ON 0
 uu_1                 1.443124e-01 1 1  ON 1
 uu_2                 4.239678e-02 1 1  ON 2
 uu_3                -2.052436e-02 1 1  ON 3
 uu_4                -6.677838e-02 1 1  ON 4
 uu_5                -1.028022e-01 1 1  ON 5
 uu_6                -1.318203e-01 1 1  ON 6
 uu_7                -1.470467e-01 1 1  ON 7
 uu_8                -1.401105e-01 1 1  ON 8
 uu_9                -1.124852e-01 1 1  ON 9
 ud_0                 4.542347e-01 1 1  ON 10
 ud_1                 1.881117e-01 1 1  ON 11
 ud_2                 6.724994e-02 1 1  ON 12
 ud_3                -4.449280e-03 1 1  ON 13
 ud_4                -6.197745e-02 1 1  ON 14
 ud_5                -1.044523e-01 1 1  ON 15
 ud_6                -1.333958e-01 1 1  ON 16
 ud_7                -1.515955e-01 1 1  ON 17
 ud_8                -1.538632e-01 1 1  ON 18
 ud_9                -1.462311e-01 1 1  ON 19
 eO_0                -7.512596e-01 1 1  ON 20
 eO_1                -4.296067e-01 1 1  ON 21
 eO_2                -1.420186e-02 1 1  ON 22
 eO_3                 3.032172e-01 1 1  ON 23
 eO_4                 5.305092e-01 1 1  ON 24
 eO_5                 4.939667e-01 1 1  ON 25
 eO_6                 2.653476e-01 1 1  ON 26
 eO_7                -4.105335e-02 1 1  ON 27
 eO_8                -2.398134e-01 1 1  ON 28
 eO_9                -1.108735e-01 1 1  ON 29
eH1_0                -2.644865e-01 1 1  ON 30
eH1_1                -1.593249e-01 1 1  ON 31
eH1_2                -1.097073e-01 1 1  ON 32
eH1_3                -5.440049e-02 1 1  ON 33
eH1_4                -3.906110e-03 1 1  ON 34
eH1_5                 3.321529e-02 1 1  ON 35
eH1_6                 9.615976e-02 1 1  ON 36
eH1_7                 1.601596e-01 1 1  ON 37
eH1_8                 1.991137e-01 1 1  ON 38
eH1_9                 1.022667e-01 1 1  ON 39
eH2_0                -2.606798e-01 1 1  ON 40
eH2_1                -1.552394e-01 1 1  ON 41
eH2_2                -1.060980e-01 1 1  ON 42
eH2_3                -5.085723e-02 1 1  ON 43
eH2_4                -6.737794e-04 1 1  ON 44
eH2_5                 3.503393e-02 1 1  ON 45
eH2_6                 9.765287e-02 1 1  ON 46
eH2_7                 1.598884e-01 1 1  ON 47
eH2_8                 2.003733e-01 1 1  ON 48
eH2_9                 9.251175e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9381
    reference variance = 0.21857
====================================================
  Execution time = 2.2559e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5301e-01
  Total weights = 2.0000e+06
  Execution time = 1.8934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353133219675
                                         uncertainty =       0.015715819352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353133219675
                                         uncertainty =       0.015715819352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420129945
  error estimate for blocks of size 2^( 2) =       0.000432650311
  error estimate for blocks of size 2^( 3) =       0.000445772324
  error estimate for blocks of size 2^( 4) =       0.000457717474
  error estimate for blocks of size 2^( 5) =       0.000467687841
  error estimate for blocks of size 2^( 6) =       0.000474910968
  error estimate for blocks of size 2^( 7) =       0.000483717876

      target function =                  N/A
              le_mean =     -16.906038736367
             les_mean =     286.167163921164
             stat err =       0.000471008540
             autocorr =       1.256869788185
              std dev =       0.594153466818
             le_variance =       0.353018342132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353126719581
                                         uncertainty =       0.015722355778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353126719581
                                         uncertainty =       0.015722355778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420126067
  error estimate for blocks of size 2^( 2) =       0.000432643961
  error estimate for blocks of size 2^( 3) =       0.000445761654
  error estimate for blocks of size 2^( 4) =       0.000457705698
  error estimate for blocks of size 2^( 5) =       0.000467674874
  error estimate for blocks of size 2^( 6) =       0.000474903499
  error estimate for blocks of size 2^( 7) =       0.000483709797

      target function =                  N/A
              le_mean =     -16.906038942518
             les_mean =     286.167164373466
             stat err =       0.000470998467
             autocorr =       1.256839237587
              std dev =       0.594147981592
             le_variance =       0.353011824030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353119336087
                                         uncertainty =       0.015719412073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353119336087
                                         uncertainty =       0.015719412073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420121678
  error estimate for blocks of size 2^( 2) =       0.000432640804
  error estimate for blocks of size 2^( 3) =       0.000445760400
  error estimate for blocks of size 2^( 4) =       0.000457705258
  error estimate for blocks of size 2^( 5) =       0.000467674918
  error estimate for blocks of size 2^( 6) =       0.000474901768
  error estimate for blocks of size 2^( 7) =       0.000483707606

      target function =                  N/A
              le_mean =     -16.906038827499
             les_mean =     286.167153109665
             stat err =       0.000470997388
             autocorr =       1.256859733603
              std dev =       0.594141775404
             le_variance =       0.353004449280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353131012548
                                         uncertainty =       0.015716316770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353131012548
                                         uncertainty =       0.015716316770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420128631
  error estimate for blocks of size 2^( 2) =       0.000432648834
  error estimate for blocks of size 2^( 3) =       0.000445770523
  error estimate for blocks of size 2^( 4) =       0.000457715642
  error estimate for blocks of size 2^( 5) =       0.000467685904
  error estimate for blocks of size 2^( 6) =       0.000474909538
  error estimate for blocks of size 2^( 7) =       0.000483716279

      target function =                  N/A
              le_mean =     -16.906038741266
             les_mean =     286.167161878276
             stat err =       0.000471006841
             autocorr =       1.256868585461
              std dev =       0.594151608256
             le_variance =       0.353016133594


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906038736367        initial
     6.2500e-01     6.2500e+00             2.8229e-04       -16.906038942518  <--
     2.5000e+00     2.5000e+01             6.8581e-05       -16.906038827499
     1.0000e+01     1.0000e+02             1.7385e-05       -16.906038741266

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.2099e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.115416e-01 1 1  ON 0
 uu_1                 1.443827e-01 1 1  ON 1
 uu_2                 4.244884e-02 1 1  ON 2
 uu_3                -2.050370e-02 1 1  ON 3
 uu_4                -6.675377e-02 1 1  ON 4
 uu_5                -1.027292e-01 1 1  ON 5
 uu_6                -1.318619e-01 1 1  ON 6
 uu_7                -1.471237e-01 1 1  ON 7
 uu_8                -1.402639e-01 1 1  ON 8
 uu_9                -1.125799e-01 1 1  ON 9
 ud_0                 4.542803e-01 1 1  ON 10
 ud_1                 1.881800e-01 1 1  ON 11
 ud_2                 6.727846e-02 1 1  ON 12
 ud_3                -4.407717e-03 1 1  ON 13
 ud_4                -6.198513e-02 1 1  ON 14
 ud_5                -1.043903e-01 1 1  ON 15
 ud_6                -1.333189e-01 1 1  ON 16
 ud_7                -1.516821e-01 1 1  ON 17
 ud_8                -1.540026e-01 1 1  ON 18
 ud_9                -1.462389e-01 1 1  ON 19
 eO_0                -7.512106e-01 1 1  ON 20
 eO_1                -4.295309e-01 1 1  ON 21
 eO_2                -1.419334e-02 1 1  ON 22
 eO_3                 3.031821e-01 1 1  ON 23
 eO_4                 5.306180e-01 1 1  ON 24
 eO_5                 4.940764e-01 1 1  ON 25
 eO_6                 2.653663e-01 1 1  ON 26
 eO_7                -4.109344e-02 1 1  ON 27
 eO_8                -2.399285e-01 1 1  ON 28
 eO_9                -1.110266e-01 1 1  ON 29
eH1_0                -2.645767e-01 1 1  ON 30
eH1_1                -1.593297e-01 1 1  ON 31
eH1_2                -1.096943e-01 1 1  ON 32
eH1_3                -5.442186e-02 1 1  ON 33
eH1_4                -3.888745e-03 1 1  ON 34
eH1_5                 3.314350e-02 1 1  ON 35
eH1_6                 9.608253e-02 1 1  ON 36
eH1_7                 1.600886e-01 1 1  ON 37
eH1_8                 1.991495e-01 1 1  ON 38
eH1_9                 1.024805e-01 1 1  ON 39
eH2_0                -2.606911e-01 1 1  ON 40
eH2_1                -1.553601e-01 1 1  ON 41
eH2_2                -1.061810e-01 1 1  ON 42
eH2_3                -5.089439e-02 1 1  ON 43
eH2_4                -7.158034e-04 1 1  ON 44
eH2_5                 3.494761e-02 1 1  ON 45
eH2_6                 9.773156e-02 1 1  ON 46
eH2_7                 1.599319e-01 1 1  ON 47
eH2_8                 2.003906e-01 1 1  ON 48
eH2_9                 9.271101e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8194e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8257
    reference variance = 0.278297
====================================================
  Execution time = 2.0522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3954e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339431163169
                                         uncertainty =       0.002684330655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339431163169
                                         uncertainty =       0.002684330655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412032879
  error estimate for blocks of size 2^( 2) =       0.000424477258
  error estimate for blocks of size 2^( 3) =       0.000437112923
  error estimate for blocks of size 2^( 4) =       0.000448693773
  error estimate for blocks of size 2^( 5) =       0.000458722074
  error estimate for blocks of size 2^( 6) =       0.000466558772
  error estimate for blocks of size 2^( 7) =       0.000472124500

      target function =                  N/A
              le_mean =     -16.906273459581
             les_mean =     286.161624307853
             stat err =       0.000461524780
             autocorr =       1.254660716987
              std dev =       0.582702486248
             le_variance =       0.339542187479


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627345958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906273459581       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906275153136       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906275739506       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906276066021       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906275557900       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906276685404       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906275298525       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906275690579       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906275698602       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906276101321       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906276055186       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 9.923598e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906273459581       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906274098473       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906274193434       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906273939309       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906274322506       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906274619139       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906274192216       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906274215688       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906274270840       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.501938e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906273459581       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906273642592       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906273656638       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906273547302       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906273755176       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906273770697       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906273675852       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906273670996       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 6.226768e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6200e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.116095e-01 1 1  ON 0
 uu_1                 1.444105e-01 1 1  ON 1
 uu_2                 4.247416e-02 1 1  ON 2
 uu_3                -2.045373e-02 1 1  ON 3
 uu_4                -6.670333e-02 1 1  ON 4
 uu_5                -1.027321e-01 1 1  ON 5
 uu_6                -1.318355e-01 1 1  ON 6
 uu_7                -1.472486e-01 1 1  ON 7
 uu_8                -1.404870e-01 1 1  ON 8
 uu_9                -1.126669e-01 1 1  ON 9
 ud_0                 4.542605e-01 1 1  ON 10
 ud_1                 1.882541e-01 1 1  ON 11
 ud_2                 6.737028e-02 1 1  ON 12
 ud_3                -4.328303e-03 1 1  ON 13
 ud_4                -6.200264e-02 1 1  ON 14
 ud_5                -1.044140e-01 1 1  ON 15
 ud_6                -1.331886e-01 1 1  ON 16
 ud_7                -1.516585e-01 1 1  ON 17
 ud_8                -1.540461e-01 1 1  ON 18
 ud_9                -1.463166e-01 1 1  ON 19
 eO_0                -7.512184e-01 1 1  ON 20
 eO_1                -4.294878e-01 1 1  ON 21
 eO_2                -1.414716e-02 1 1  ON 22
 eO_3                 3.033381e-01 1 1  ON 23
 eO_4                 5.307421e-01 1 1  ON 24
 eO_5                 4.941296e-01 1 1  ON 25
 eO_6                 2.654305e-01 1 1  ON 26
 eO_7                -4.112079e-02 1 1  ON 27
 eO_8                -2.401297e-01 1 1  ON 28
 eO_9                -1.112387e-01 1 1  ON 29
eH1_0                -2.646543e-01 1 1  ON 30
eH1_1                -1.592910e-01 1 1  ON 31
eH1_2                -1.098332e-01 1 1  ON 32
eH1_3                -5.447676e-02 1 1  ON 33
eH1_4                -4.081042e-03 1 1  ON 34
eH1_5                 3.318797e-02 1 1  ON 35
eH1_6                 9.611120e-02 1 1  ON 36
eH1_7                 1.600601e-01 1 1  ON 37
eH1_8                 1.992740e-01 1 1  ON 38
eH1_9                 1.027228e-01 1 1  ON 39
eH2_0                -2.606836e-01 1 1  ON 40
eH2_1                -1.552500e-01 1 1  ON 41
eH2_2                -1.062268e-01 1 1  ON 42
eH2_3                -5.094768e-02 1 1  ON 43
eH2_4                -9.171234e-04 1 1  ON 44
eH2_5                 3.496333e-02 1 1  ON 45
eH2_6                 9.756103e-02 1 1  ON 46
eH2_7                 1.598908e-01 1 1  ON 47
eH2_8                 2.005070e-01 1 1  ON 48
eH2_9                 9.296120e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9125
    reference variance = 0.251066
====================================================
  Execution time = 2.0193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3439e-01
  Total weights = 2.0000e+06
  Execution time = 1.8904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331364636
                                         uncertainty =       0.002654745192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334331364636
                                         uncertainty =       0.002654745192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408929085
  error estimate for blocks of size 2^( 2) =       0.000421953942
  error estimate for blocks of size 2^( 3) =       0.000435148323
  error estimate for blocks of size 2^( 4) =       0.000447350690
  error estimate for blocks of size 2^( 5) =       0.000457665888
  error estimate for blocks of size 2^( 6) =       0.000465832324
  error estimate for blocks of size 2^( 7) =       0.000470851518

      target function =                  N/A
              le_mean =     -16.906370212920
             les_mean =     286.159799602506
             stat err =       0.000460425105
             autocorr =       1.267716052096
              std dev =       0.578313058328
             le_variance =       0.334445993432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334251785300
                                         uncertainty =       0.002652872569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334251785300
                                         uncertainty =       0.002652872569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408880447
  error estimate for blocks of size 2^( 2) =       0.000421908018
  error estimate for blocks of size 2^( 3) =       0.000435103253
  error estimate for blocks of size 2^( 4) =       0.000447306425
  error estimate for blocks of size 2^( 5) =       0.000457619379
  error estimate for blocks of size 2^( 6) =       0.000465785764
  error estimate for blocks of size 2^( 7) =       0.000470801425

      target function =                  N/A
              le_mean =     -16.906369939286
             les_mean =     286.159710796705
             stat err =       0.000460378248
             autocorr =       1.267759596894
              std dev =       0.578244273547
             le_variance =       0.334366439890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334213712364
                                         uncertainty =       0.002652514347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334213712364
                                         uncertainty =       0.002652514347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408857150
  error estimate for blocks of size 2^( 2) =       0.000421886296
  error estimate for blocks of size 2^( 3) =       0.000435083546
  error estimate for blocks of size 2^( 4) =       0.000447288330
  error estimate for blocks of size 2^( 5) =       0.000457602243
  error estimate for blocks of size 2^( 6) =       0.000465769652
  error estimate for blocks of size 2^( 7) =       0.000470784723

      target function =                  N/A
              le_mean =     -16.906370029940
             les_mean =     286.159675760721
             stat err =       0.000460361237
             autocorr =       1.267810376802
              std dev =       0.578211326979
             le_variance =       0.334328338647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334305179336
                                         uncertainty =       0.002654319478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334305179336
                                         uncertainty =       0.002654319478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408913076
  error estimate for blocks of size 2^( 2) =       0.000421938850
  error estimate for blocks of size 2^( 3) =       0.000435133923
  error estimate for blocks of size 2^( 4) =       0.000447336833
  error estimate for blocks of size 2^( 5) =       0.000457651880
  error estimate for blocks of size 2^( 6) =       0.000465818528
  error estimate for blocks of size 2^( 7) =       0.000470837125

      target function =                  N/A
              le_mean =     -16.906370172168
             les_mean =     286.159772037922
             stat err =       0.000460411092
             autocorr =       1.267738147786
              std dev =       0.578290417303
             le_variance =       0.334419806744


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906370212920        initial  <--
     1.5625e-01     1.5625e+00             9.9236e-04       -16.906369939286
     6.2500e-01     6.2500e+00             2.5019e-04       -16.906370029940
     2.5000e+00     2.5000e+01             6.2268e-05       -16.906370172168

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7352
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.115416e-01 1 1  ON 0
 uu_1                 1.443827e-01 1 1  ON 1
 uu_2                 4.244884e-02 1 1  ON 2
 uu_3                -2.050370e-02 1 1  ON 3
 uu_4                -6.675377e-02 1 1  ON 4
 uu_5                -1.027292e-01 1 1  ON 5
 uu_6                -1.318619e-01 1 1  ON 6
 uu_7                -1.471237e-01 1 1  ON 7
 uu_8                -1.402639e-01 1 1  ON 8
 uu_9                -1.125799e-01 1 1  ON 9
 ud_0                 4.542803e-01 1 1  ON 10
 ud_1                 1.881800e-01 1 1  ON 11
 ud_2                 6.727846e-02 1 1  ON 12
 ud_3                -4.407717e-03 1 1  ON 13
 ud_4                -6.198513e-02 1 1  ON 14
 ud_5                -1.043903e-01 1 1  ON 15
 ud_6                -1.333189e-01 1 1  ON 16
 ud_7                -1.516821e-01 1 1  ON 17
 ud_8                -1.540026e-01 1 1  ON 18
 ud_9                -1.462389e-01 1 1  ON 19
 eO_0                -7.512106e-01 1 1  ON 20
 eO_1                -4.295309e-01 1 1  ON 21
 eO_2                -1.419334e-02 1 1  ON 22
 eO_3                 3.031821e-01 1 1  ON 23
 eO_4                 5.306180e-01 1 1  ON 24
 eO_5                 4.940764e-01 1 1  ON 25
 eO_6                 2.653663e-01 1 1  ON 26
 eO_7                -4.109344e-02 1 1  ON 27
 eO_8                -2.399285e-01 1 1  ON 28
 eO_9                -1.110266e-01 1 1  ON 29
eH1_0                -2.645767e-01 1 1  ON 30
eH1_1                -1.593297e-01 1 1  ON 31
eH1_2                -1.096943e-01 1 1  ON 32
eH1_3                -5.442186e-02 1 1  ON 33
eH1_4                -3.888745e-03 1 1  ON 34
eH1_5                 3.314350e-02 1 1  ON 35
eH1_6                 9.608253e-02 1 1  ON 36
eH1_7                 1.600886e-01 1 1  ON 37
eH1_8                 1.991495e-01 1 1  ON 38
eH1_9                 1.024805e-01 1 1  ON 39
eH2_0                -2.606911e-01 1 1  ON 40
eH2_1                -1.553601e-01 1 1  ON 41
eH2_2                -1.061810e-01 1 1  ON 42
eH2_3                -5.089439e-02 1 1  ON 43
eH2_4                -7.158034e-04 1 1  ON 44
eH2_5                 3.494761e-02 1 1  ON 45
eH2_6                 9.773156e-02 1 1  ON 46
eH2_7                 1.599319e-01 1 1  ON 47
eH2_8                 2.003906e-01 1 1  ON 48
eH2_9                 9.271101e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5942e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9275
    reference variance = 0.224931
====================================================
  Execution time = 2.0449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4361e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343699692249
                                         uncertainty =       0.003431533136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343699692249
                                         uncertainty =       0.003431533136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414496088
  error estimate for blocks of size 2^( 2) =       0.000427351035
  error estimate for blocks of size 2^( 3) =       0.000440355825
  error estimate for blocks of size 2^( 4) =       0.000452589169
  error estimate for blocks of size 2^( 5) =       0.000463782047
  error estimate for blocks of size 2^( 6) =       0.000470018420
  error estimate for blocks of size 2^( 7) =       0.000475006696

      target function =                  N/A
              le_mean =     -16.907012854332
             les_mean =     286.190697498618
             stat err =       0.000465349083
             autocorr =       1.260424547260
              std dev =       0.586185989155
             le_variance =       0.343614013881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690701285433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907012854332       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907012716978       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907012883167       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907013007986       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907013116688       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907013194843       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907013132359       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907013160568       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.286822e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907012854332       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907012816781       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907012860828       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907012891861       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907012937485       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907012925396       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907012940647       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907012932370       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.240592e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907012854332       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907012844719       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907012855879       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907012863613       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907012876318       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907012871941       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907012875901       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907012874216       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.114546e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239869 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6026e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.115532e-01 1 1  ON 0
 uu_1                 1.443831e-01 1 1  ON 1
 uu_2                 4.244487e-02 1 1  ON 2
 uu_3                -2.049953e-02 1 1  ON 3
 uu_4                -6.675018e-02 1 1  ON 4
 uu_5                -1.027297e-01 1 1  ON 5
 uu_6                -1.318793e-01 1 1  ON 6
 uu_7                -1.471405e-01 1 1  ON 7
 uu_8                -1.402873e-01 1 1  ON 8
 uu_9                -1.125808e-01 1 1  ON 9
 ud_0                 4.542845e-01 1 1  ON 10
 ud_1                 1.881749e-01 1 1  ON 11
 ud_2                 6.727679e-02 1 1  ON 12
 ud_3                -4.402799e-03 1 1  ON 13
 ud_4                -6.198895e-02 1 1  ON 14
 ud_5                -1.044050e-01 1 1  ON 15
 ud_6                -1.333200e-01 1 1  ON 16
 ud_7                -1.516605e-01 1 1  ON 17
 ud_8                -1.539905e-01 1 1  ON 18
 ud_9                -1.462364e-01 1 1  ON 19
 eO_0                -7.512102e-01 1 1  ON 20
 eO_1                -4.295175e-01 1 1  ON 21
 eO_2                -1.418375e-02 1 1  ON 22
 eO_3                 3.031699e-01 1 1  ON 23
 eO_4                 5.306343e-01 1 1  ON 24
 eO_5                 4.940938e-01 1 1  ON 25
 eO_6                 2.653580e-01 1 1  ON 26
 eO_7                -4.109705e-02 1 1  ON 27
 eO_8                -2.399394e-01 1 1  ON 28
 eO_9                -1.110444e-01 1 1  ON 29
eH1_0                -2.645797e-01 1 1  ON 30
eH1_1                -1.593261e-01 1 1  ON 31
eH1_2                -1.097187e-01 1 1  ON 32
eH1_3                -5.443607e-02 1 1  ON 33
eH1_4                -3.902877e-03 1 1  ON 34
eH1_5                 3.314417e-02 1 1  ON 35
eH1_6                 9.608380e-02 1 1  ON 36
eH1_7                 1.600838e-01 1 1  ON 37
eH1_8                 1.991655e-01 1 1  ON 38
eH1_9                 1.025129e-01 1 1  ON 39
eH2_0                -2.607078e-01 1 1  ON 40
eH2_1                -1.553657e-01 1 1  ON 41
eH2_2                -1.061874e-01 1 1  ON 42
eH2_3                -5.090895e-02 1 1  ON 43
eH2_4                -7.277837e-04 1 1  ON 44
eH2_5                 3.494674e-02 1 1  ON 45
eH2_6                 9.773524e-02 1 1  ON 46
eH2_7                 1.599436e-01 1 1  ON 47
eH2_8                 2.004042e-01 1 1  ON 48
eH2_9                 9.273724e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9694
    reference variance = 0.341054
====================================================
  Execution time = 2.0231e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3096e-01
  Total weights = 2.0000e+06
  Execution time = 1.8858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331051201184
                                         uncertainty =       0.002763542655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331051201184
                                         uncertainty =       0.002763542655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406785455
  error estimate for blocks of size 2^( 2) =       0.000419596026
  error estimate for blocks of size 2^( 3) =       0.000432512005
  error estimate for blocks of size 2^( 4) =       0.000445368990
  error estimate for blocks of size 2^( 5) =       0.000456373724
  error estimate for blocks of size 2^( 6) =       0.000463045634
  error estimate for blocks of size 2^( 7) =       0.000468487362

      target function =                  N/A
              le_mean =     -16.905947129228
             les_mean =     286.141996984320
             stat err =       0.000458318927
             autocorr =       1.269418294722
              std dev =       0.575281508071
             le_variance =       0.330948813529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331094914883
                                         uncertainty =       0.002763780374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331094914883
                                         uncertainty =       0.002763780374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406812316
  error estimate for blocks of size 2^( 2) =       0.000419621711
  error estimate for blocks of size 2^( 3) =       0.000432536532
  error estimate for blocks of size 2^( 4) =       0.000445392694
  error estimate for blocks of size 2^( 5) =       0.000456396698
  error estimate for blocks of size 2^( 6) =       0.000463067173
  error estimate for blocks of size 2^( 7) =       0.000468506343

      target function =                  N/A
              le_mean =     -16.905947204573
             les_mean =     286.142043238825
             stat err =       0.000458340727
             autocorr =       1.269371414222
              std dev =       0.575319494281
             le_variance =       0.330992520499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331076730428
                                         uncertainty =       0.002763698496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331076730428
                                         uncertainty =       0.002763698496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406801142
  error estimate for blocks of size 2^( 2) =       0.000419611013
  error estimate for blocks of size 2^( 3) =       0.000432526308
  error estimate for blocks of size 2^( 4) =       0.000445382843
  error estimate for blocks of size 2^( 5) =       0.000456387188
  error estimate for blocks of size 2^( 6) =       0.000463058276
  error estimate for blocks of size 2^( 7) =       0.000468498596

      target function =                  N/A
              le_mean =     -16.905947157189
             les_mean =     286.142023454936
             stat err =       0.000458331726
             autocorr =       1.269391286909
              std dev =       0.575303692631
             le_variance =       0.330974338755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331054544258
                                         uncertainty =       0.002763563577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331054544258
                                         uncertainty =       0.002763563577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406787510
  error estimate for blocks of size 2^( 2) =       0.000419597987
  error estimate for blocks of size 2^( 3) =       0.000432513877
  error estimate for blocks of size 2^( 4) =       0.000445370803
  error estimate for blocks of size 2^( 5) =       0.000456375487
  error estimate for blocks of size 2^( 6) =       0.000463047291
  error estimate for blocks of size 2^( 7) =       0.000468488838

      target function =                  N/A
              le_mean =     -16.905947131927
             les_mean =     286.142000418114
             stat err =       0.000458320605
             autocorr =       1.269414766207
              std dev =       0.575284413200
             le_variance =       0.330952156070


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905947129228        initial
     1.5625e+00     1.5625e+01             1.2868e-04       -16.905947204573  <--
     6.2500e+00     6.2500e+01             3.2406e-05       -16.905947157189
     2.5000e+01     2.5000e+02             8.1145e-06       -16.905947131927

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.9756e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.115853e-01 1 1  ON 0
 uu_1                 1.443846e-01 1 1  ON 1
 uu_2                 4.243729e-02 1 1  ON 2
 uu_3                -2.048819e-02 1 1  ON 3
 uu_4                -6.674072e-02 1 1  ON 4
 uu_5                -1.027330e-01 1 1  ON 5
 uu_6                -1.319285e-01 1 1  ON 6
 uu_7                -1.471906e-01 1 1  ON 7
 uu_8                -1.403570e-01 1 1  ON 8
 uu_9                -1.125832e-01 1 1  ON 9
 ud_0                 4.542931e-01 1 1  ON 10
 ud_1                 1.881631e-01 1 1  ON 11
 ud_2                 6.727133e-02 1 1  ON 12
 ud_3                -4.390361e-03 1 1  ON 13
 ud_4                -6.199882e-02 1 1  ON 14
 ud_5                -1.044439e-01 1 1  ON 15
 ud_6                -1.333240e-01 1 1  ON 16
 ud_7                -1.515995e-01 1 1  ON 17
 ud_8                -1.539539e-01 1 1  ON 18
 ud_9                -1.462285e-01 1 1  ON 19
 eO_0                -7.512049e-01 1 1  ON 20
 eO_1                -4.294838e-01 1 1  ON 21
 eO_2                -1.415670e-02 1 1  ON 22
 eO_3                 3.031393e-01 1 1  ON 23
 eO_4                 5.306809e-01 1 1  ON 24
 eO_5                 4.941442e-01 1 1  ON 25
 eO_6                 2.653335e-01 1 1  ON 26
 eO_7                -4.110793e-02 1 1  ON 27
 eO_8                -2.399713e-01 1 1  ON 28
 eO_9                -1.110973e-01 1 1  ON 29
eH1_0                -2.645888e-01 1 1  ON 30
eH1_1                -1.593223e-01 1 1  ON 31
eH1_2                -1.097852e-01 1 1  ON 32
eH1_3                -5.447907e-02 1 1  ON 33
eH1_4                -3.943404e-03 1 1  ON 34
eH1_5                 3.314611e-02 1 1  ON 35
eH1_6                 9.608751e-02 1 1  ON 36
eH1_7                 1.600697e-01 1 1  ON 37
eH1_8                 1.992131e-01 1 1  ON 38
eH1_9                 1.026091e-01 1 1  ON 39
eH2_0                -2.607566e-01 1 1  ON 40
eH2_1                -1.553833e-01 1 1  ON 41
eH2_2                -1.062085e-01 1 1  ON 42
eH2_3                -5.095055e-02 1 1  ON 43
eH2_4                -7.622845e-04 1 1  ON 44
eH2_5                 3.494348e-02 1 1  ON 45
eH2_6                 9.774603e-02 1 1  ON 46
eH2_7                 1.599786e-01 1 1  ON 47
eH2_8                 2.004445e-01 1 1  ON 48
eH2_9                 9.281522e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5793e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9427
    reference variance = 0.273393
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3892e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339015548997
                                         uncertainty =       0.005121484550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339015548997
                                         uncertainty =       0.005121484550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411655551
  error estimate for blocks of size 2^( 2) =       0.000424377074
  error estimate for blocks of size 2^( 3) =       0.000436830850
  error estimate for blocks of size 2^( 4) =       0.000449205129
  error estimate for blocks of size 2^( 5) =       0.000459896567
  error estimate for blocks of size 2^( 6) =       0.000466482082
  error estimate for blocks of size 2^( 7) =       0.000472978048

      target function =                  N/A
              le_mean =     -16.905775619797
             les_mean =     286.144169722156
             stat err =       0.000462140457
             autocorr =       1.260317674557
              std dev =       0.582168862691
             le_variance =       0.338920584687


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577561980e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905775619797       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905776461732       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905776830787       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905776193556       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905775719517       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905775282520       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905775581670       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905776048870       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905775923989       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.015446e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905775619797       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905775880974       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905776003823       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905775808789       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905775683304       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905775659433       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905775610757       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.179634e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905775619797       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905775689275       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905775723167       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905775673226       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905775637850       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905775638514       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905775623521       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.011291e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242576 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6196e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.115979e-01 1 1  ON 0
 uu_1                 1.443703e-01 1 1  ON 1
 uu_2                 4.241931e-02 1 1  ON 2
 uu_3                -2.049873e-02 1 1  ON 3
 uu_4                -6.674900e-02 1 1  ON 4
 uu_5                -1.027689e-01 1 1  ON 5
 uu_6                -1.319244e-01 1 1  ON 6
 uu_7                -1.471651e-01 1 1  ON 7
 uu_8                -1.403356e-01 1 1  ON 8
 uu_9                -1.126089e-01 1 1  ON 9
 ud_0                 4.543254e-01 1 1  ON 10
 ud_1                 1.882075e-01 1 1  ON 11
 ud_2                 6.729914e-02 1 1  ON 12
 ud_3                -4.371582e-03 1 1  ON 13
 ud_4                -6.202220e-02 1 1  ON 14
 ud_5                -1.044952e-01 1 1  ON 15
 ud_6                -1.332768e-01 1 1  ON 16
 ud_7                -1.516089e-01 1 1  ON 17
 ud_8                -1.539935e-01 1 1  ON 18
 ud_9                -1.462250e-01 1 1  ON 19
 eO_0                -7.511523e-01 1 1  ON 20
 eO_1                -4.294708e-01 1 1  ON 21
 eO_2                -1.411229e-02 1 1  ON 22
 eO_3                 3.031491e-01 1 1  ON 23
 eO_4                 5.307206e-01 1 1  ON 24
 eO_5                 4.941282e-01 1 1  ON 25
 eO_6                 2.653071e-01 1 1  ON 26
 eO_7                -4.109075e-02 1 1  ON 27
 eO_8                -2.400093e-01 1 1  ON 28
 eO_9                -1.111728e-01 1 1  ON 29
eH1_0                -2.646119e-01 1 1  ON 30
eH1_1                -1.593166e-01 1 1  ON 31
eH1_2                -1.098408e-01 1 1  ON 32
eH1_3                -5.444270e-02 1 1  ON 33
eH1_4                -3.968439e-03 1 1  ON 34
eH1_5                 3.309340e-02 1 1  ON 35
eH1_6                 9.601455e-02 1 1  ON 36
eH1_7                 1.600561e-01 1 1  ON 37
eH1_8                 1.992860e-01 1 1  ON 38
eH1_9                 1.027271e-01 1 1  ON 39
eH2_0                -2.607149e-01 1 1  ON 40
eH2_1                -1.554689e-01 1 1  ON 41
eH2_2                -1.062492e-01 1 1  ON 42
eH2_3                -5.096466e-02 1 1  ON 43
eH2_4                -7.927202e-04 1 1  ON 44
eH2_5                 3.492264e-02 1 1  ON 45
eH2_6                 9.775002e-02 1 1  ON 46
eH2_7                 1.600074e-01 1 1  ON 47
eH2_8                 2.004664e-01 1 1  ON 48
eH2_9                 9.290239e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9046
    reference variance = 0.22928
====================================================
  Execution time = 2.0135e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3784e-01
  Total weights = 2.0000e+06
  Execution time = 1.8921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337904752631
                                         uncertainty =       0.003582945350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337904752631
                                         uncertainty =       0.003582945350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410987920
  error estimate for blocks of size 2^( 2) =       0.000423232155
  error estimate for blocks of size 2^( 3) =       0.000436320820
  error estimate for blocks of size 2^( 4) =       0.000448763786
  error estimate for blocks of size 2^( 5) =       0.000459190480
  error estimate for blocks of size 2^( 6) =       0.000468103311
  error estimate for blocks of size 2^( 7) =       0.000474984325

      target function =                  N/A
              le_mean =     -16.906048513377
             les_mean =     286.152298307816
             stat err =       0.000462760475
             autocorr =       1.267810673966
              std dev =       0.581224689830
             le_variance =       0.337822140068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337959912680
                                         uncertainty =       0.003584200492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337959912680
                                         uncertainty =       0.003584200492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411021443
  error estimate for blocks of size 2^( 2) =       0.000423261804
  error estimate for blocks of size 2^( 3) =       0.000436345535
  error estimate for blocks of size 2^( 4) =       0.000448785202
  error estimate for blocks of size 2^( 5) =       0.000459213963
  error estimate for blocks of size 2^( 6) =       0.000468128702
  error estimate for blocks of size 2^( 7) =       0.000475005996

      target function =                  N/A
              le_mean =     -16.906049067322
             les_mean =     286.152372150157
             stat err =       0.000462783466
             autocorr =       1.267729831469
              std dev =       0.581272098414
             le_variance =       0.337877252394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337936087368
                                         uncertainty =       0.003583795029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337936087368
                                         uncertainty =       0.003583795029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411006961
  error estimate for blocks of size 2^( 2) =       0.000423248902
  error estimate for blocks of size 2^( 3) =       0.000436334427
  error estimate for blocks of size 2^( 4) =       0.000448775210
  error estimate for blocks of size 2^( 5) =       0.000459203680
  error estimate for blocks of size 2^( 6) =       0.000468117568
  error estimate for blocks of size 2^( 7) =       0.000474996216

      target function =                  N/A
              le_mean =     -16.906048823012
             les_mean =     286.152340080562
             stat err =       0.000462773169
             autocorr =       1.267762751977
              std dev =       0.581251618010
             le_variance =       0.337853443440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337908367561
                                         uncertainty =       0.003583053209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337908367561
                                         uncertainty =       0.003583053209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410990116
  error estimate for blocks of size 2^( 2) =       0.000423234047
  error estimate for blocks of size 2^( 3) =       0.000436322284
  error estimate for blocks of size 2^( 4) =       0.000448764957
  error estimate for blocks of size 2^( 5) =       0.000459191911
  error estimate for blocks of size 2^( 6) =       0.000468104908
  error estimate for blocks of size 2^( 7) =       0.000474985644

      target function =                  N/A
              le_mean =     -16.906048539958
             les_mean =     286.152302816713
             stat err =       0.000462761855
             autocorr =       1.267804685264
              std dev =       0.581227795446
             le_variance =       0.337825750199


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906048513377        initial
     3.9062e-01     3.9062e+00             5.0154e-04       -16.906049067322  <--
     1.5625e+00     1.5625e+01             1.1796e-04       -16.906048823012
     6.2500e+00     6.2500e+01             3.0113e-05       -16.906048539958

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9672e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.115950e-01 1 1  ON 0
 uu_1                 1.443343e-01 1 1  ON 1
 uu_2                 4.237125e-02 1 1  ON 2
 uu_3                -2.053002e-02 1 1  ON 3
 uu_4                -6.677619e-02 1 1  ON 4
 uu_5                -1.028337e-01 1 1  ON 5
 uu_6                -1.319211e-01 1 1  ON 6
 uu_7                -1.471090e-01 1 1  ON 7
 uu_8                -1.402680e-01 1 1  ON 8
 uu_9                -1.126863e-01 1 1  ON 9
 ud_0                 4.544139e-01 1 1  ON 10
 ud_1                 1.883128e-01 1 1  ON 11
 ud_2                 6.736783e-02 1 1  ON 12
 ud_3                -4.323623e-03 1 1  ON 13
 ud_4                -6.206960e-02 1 1  ON 14
 ud_5                -1.045720e-01 1 1  ON 15
 ud_6                -1.332015e-01 1 1  ON 16
 ud_7                -1.516217e-01 1 1  ON 17
 ud_8                -1.540933e-01 1 1  ON 18
 ud_9                -1.462102e-01 1 1  ON 19
 eO_0                -7.510291e-01 1 1  ON 20
 eO_1                -4.293761e-01 1 1  ON 21
 eO_2                -1.398205e-02 1 1  ON 22
 eO_3                 3.032092e-01 1 1  ON 23
 eO_4                 5.308167e-01 1 1  ON 24
 eO_5                 4.940825e-01 1 1  ON 25
 eO_6                 2.652254e-01 1 1  ON 26
 eO_7                -4.103394e-02 1 1  ON 27
 eO_8                -2.401297e-01 1 1  ON 28
 eO_9                -1.114181e-01 1 1  ON 29
eH1_0                -2.646898e-01 1 1  ON 30
eH1_1                -1.593484e-01 1 1  ON 31
eH1_2                -1.099602e-01 1 1  ON 32
eH1_3                -5.441171e-02 1 1  ON 33
eH1_4                -4.020810e-03 1 1  ON 34
eH1_5                 3.295329e-02 1 1  ON 35
eH1_6                 9.579835e-02 1 1  ON 36
eH1_7                 1.600135e-01 1 1  ON 37
eH1_8                 1.995186e-01 1 1  ON 38
eH1_9                 1.031107e-01 1 1  ON 39
eH2_0                -2.606509e-01 1 1  ON 40
eH2_1                -1.556449e-01 1 1  ON 41
eH2_2                -1.063723e-01 1 1  ON 42
eH2_3                -5.102235e-02 1 1  ON 43
eH2_4                -8.750734e-04 1 1  ON 44
eH2_5                 3.482929e-02 1 1  ON 45
eH2_6                 9.774174e-02 1 1  ON 46
eH2_7                 1.600974e-01 1 1  ON 47
eH2_8                 2.005403e-01 1 1  ON 48
eH2_9                 9.318790e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5875e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9772
    reference variance = 0.322797
====================================================
  Execution time = 2.0625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3976e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339710782724
                                         uncertainty =       0.003873322150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339710782724
                                         uncertainty =       0.003873322150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412164958
  error estimate for blocks of size 2^( 2) =       0.000424798943
  error estimate for blocks of size 2^( 3) =       0.000437004955
  error estimate for blocks of size 2^( 4) =       0.000448744481
  error estimate for blocks of size 2^( 5) =       0.000458620342
  error estimate for blocks of size 2^( 6) =       0.000463912239
  error estimate for blocks of size 2^( 7) =       0.000467318847

      target function =                  N/A
              le_mean =     -16.906290499802
             les_mean =     286.162418198906
             stat err =       0.000459648977
             autocorr =       1.243685197723
              std dev =       0.582889273425
             le_variance =       0.339759905074


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690629049980e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906290499802       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906290965961       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906294246373       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906295126926       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906295889024       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906295380836       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906294787618       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906296249483       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906296034216       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906295667975       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906295413861       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906295623142       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.461522e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906290499802       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906290709375       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906292114865       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906292362167       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906292505341       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906292329372       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906291926461       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906292269676       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906292357052       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.486912e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906290499802       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906290565259       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906291002831       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906291029401       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906291027878       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906290988301       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906290873476       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906290916968       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.197594e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246300 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6208e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.116641e-01 1 1  ON 0
 uu_1                 1.444000e-01 1 1  ON 1
 uu_2                 4.239246e-02 1 1  ON 2
 uu_3                -2.053949e-02 1 1  ON 3
 uu_4                -6.682370e-02 1 1  ON 4
 uu_5                -1.028602e-01 1 1  ON 5
 uu_6                -1.319736e-01 1 1  ON 6
 uu_7                -1.470947e-01 1 1  ON 7
 uu_8                -1.403538e-01 1 1  ON 8
 uu_9                -1.129117e-01 1 1  ON 9
 ud_0                 4.544605e-01 1 1  ON 10
 ud_1                 1.885131e-01 1 1  ON 11
 ud_2                 6.752483e-02 1 1  ON 12
 ud_3                -4.151763e-03 1 1  ON 13
 ud_4                -6.182648e-02 1 1  ON 14
 ud_5                -1.043718e-01 1 1  ON 15
 ud_6                -1.330660e-01 1 1  ON 16
 ud_7                -1.516816e-01 1 1  ON 17
 ud_8                -1.545420e-01 1 1  ON 18
 ud_9                -1.465370e-01 1 1  ON 19
 eO_0                -7.511572e-01 1 1  ON 20
 eO_1                -4.293401e-01 1 1  ON 21
 eO_2                -1.365214e-02 1 1  ON 22
 eO_3                 3.031767e-01 1 1  ON 23
 eO_4                 5.310431e-01 1 1  ON 24
 eO_5                 4.942967e-01 1 1  ON 25
 eO_6                 2.654734e-01 1 1  ON 26
 eO_7                -4.113867e-02 1 1  ON 27
 eO_8                -2.404881e-01 1 1  ON 28
 eO_9                -1.117633e-01 1 1  ON 29
eH1_0                -2.646736e-01 1 1  ON 30
eH1_1                -1.593696e-01 1 1  ON 31
eH1_2                -1.100000e-01 1 1  ON 32
eH1_3                -5.459488e-02 1 1  ON 33
eH1_4                -4.010416e-03 1 1  ON 34
eH1_5                 3.258694e-02 1 1  ON 35
eH1_6                 9.586415e-02 1 1  ON 36
eH1_7                 1.600730e-01 1 1  ON 37
eH1_8                 1.995275e-01 1 1  ON 38
eH1_9                 1.034537e-01 1 1  ON 39
eH2_0                -2.609333e-01 1 1  ON 40
eH2_1                -1.555712e-01 1 1  ON 41
eH2_2                -1.063771e-01 1 1  ON 42
eH2_3                -5.133403e-02 1 1  ON 43
eH2_4                -1.260111e-03 1 1  ON 44
eH2_5                 3.506153e-02 1 1  ON 45
eH2_6                 9.790392e-02 1 1  ON 46
eH2_7                 1.602401e-01 1 1  ON 47
eH2_8                 2.006243e-01 1 1  ON 48
eH2_9                 9.354513e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9434
    reference variance = 0.25982
====================================================
  Execution time = 2.0407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6980e-01
  Total weights = 2.0000e+06
  Execution time = 1.8935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369983121841
                                         uncertainty =       0.033828852813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369983121841
                                         uncertainty =       0.033828852813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430061594
  error estimate for blocks of size 2^( 2) =       0.000442318159
  error estimate for blocks of size 2^( 3) =       0.000454472860
  error estimate for blocks of size 2^( 4) =       0.000466322171
  error estimate for blocks of size 2^( 5) =       0.000476808263
  error estimate for blocks of size 2^( 6) =       0.000483285887
  error estimate for blocks of size 2^( 7) =       0.000488617319

      target function =                  N/A
              le_mean =     -16.906246627836
             les_mean =     286.191080806207
             stat err =       0.000478758410
             autocorr =       1.239285906346
              std dev =       0.608198939460
             le_variance =       0.369905949960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369874807851
                                         uncertainty =       0.033806977019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369874807851
                                         uncertainty =       0.033806977019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000429998654
  error estimate for blocks of size 2^( 2) =       0.000442253763
  error estimate for blocks of size 2^( 3) =       0.000454407442
  error estimate for blocks of size 2^( 4) =       0.000466257137
  error estimate for blocks of size 2^( 5) =       0.000476743029
  error estimate for blocks of size 2^( 6) =       0.000483228873
  error estimate for blocks of size 2^( 7) =       0.000488577126

      target function =                  N/A
              le_mean =     -16.906244175345
             les_mean =     286.190889615709
             stat err =       0.000478701541
             autocorr =       1.239354249094
              std dev =       0.608109927748
             le_variance =       0.369797684226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369775633187
                                         uncertainty =       0.033800769709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369775633187
                                         uncertainty =       0.033800769709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000429941016
  error estimate for blocks of size 2^( 2) =       0.000442199596
  error estimate for blocks of size 2^( 3) =       0.000454357165
  error estimate for blocks of size 2^( 4) =       0.000466209684
  error estimate for blocks of size 2^( 5) =       0.000476698668
  error estimate for blocks of size 2^( 6) =       0.000483184081
  error estimate for blocks of size 2^( 7) =       0.000488526928

      target function =                  N/A
              le_mean =     -16.906244687657
             les_mean =     286.190807808070
             stat err =       0.000478654840
             autocorr =       1.239444695580
              std dev =       0.608028415450
             le_variance =       0.369698553994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369926682033
                                         uncertainty =       0.033822598496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369926682033
                                         uncertainty =       0.033822598496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430028796
  error estimate for blocks of size 2^( 2) =       0.000442286276
  error estimate for blocks of size 2^( 3) =       0.000454441890
  error estimate for blocks of size 2^( 4) =       0.000466292062
  error estimate for blocks of size 2^( 5) =       0.000476779112
  error estimate for blocks of size 2^( 6) =       0.000483258294
  error estimate for blocks of size 2^( 7) =       0.000488591559

      target function =                  N/A
              le_mean =     -16.906246227214
             les_mean =     286.191010840974
             stat err =       0.000478730257
             autocorr =       1.239329184897
              std dev =       0.608152555468
             le_variance =       0.369849530723


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906246627836        initial  <--
     9.7656e-02     9.7656e-01             1.4615e-03       -16.906244175345
     3.9062e-01     3.9062e+00             4.4869e-04       -16.906244687657
     1.5625e+00     1.5625e+01             1.1976e-04       -16.906246227214

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9474
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.115950e-01 1 1  ON 0
 uu_1                 1.443343e-01 1 1  ON 1
 uu_2                 4.237125e-02 1 1  ON 2
 uu_3                -2.053002e-02 1 1  ON 3
 uu_4                -6.677619e-02 1 1  ON 4
 uu_5                -1.028337e-01 1 1  ON 5
 uu_6                -1.319211e-01 1 1  ON 6
 uu_7                -1.471090e-01 1 1  ON 7
 uu_8                -1.402680e-01 1 1  ON 8
 uu_9                -1.126863e-01 1 1  ON 9
 ud_0                 4.544139e-01 1 1  ON 10
 ud_1                 1.883128e-01 1 1  ON 11
 ud_2                 6.736783e-02 1 1  ON 12
 ud_3                -4.323623e-03 1 1  ON 13
 ud_4                -6.206960e-02 1 1  ON 14
 ud_5                -1.045720e-01 1 1  ON 15
 ud_6                -1.332015e-01 1 1  ON 16
 ud_7                -1.516217e-01 1 1  ON 17
 ud_8                -1.540933e-01 1 1  ON 18
 ud_9                -1.462102e-01 1 1  ON 19
 eO_0                -7.510291e-01 1 1  ON 20
 eO_1                -4.293761e-01 1 1  ON 21
 eO_2                -1.398205e-02 1 1  ON 22
 eO_3                 3.032092e-01 1 1  ON 23
 eO_4                 5.308167e-01 1 1  ON 24
 eO_5                 4.940825e-01 1 1  ON 25
 eO_6                 2.652254e-01 1 1  ON 26
 eO_7                -4.103394e-02 1 1  ON 27
 eO_8                -2.401297e-01 1 1  ON 28
 eO_9                -1.114181e-01 1 1  ON 29
eH1_0                -2.646898e-01 1 1  ON 30
eH1_1                -1.593484e-01 1 1  ON 31
eH1_2                -1.099602e-01 1 1  ON 32
eH1_3                -5.441171e-02 1 1  ON 33
eH1_4                -4.020810e-03 1 1  ON 34
eH1_5                 3.295329e-02 1 1  ON 35
eH1_6                 9.579835e-02 1 1  ON 36
eH1_7                 1.600135e-01 1 1  ON 37
eH1_8                 1.995186e-01 1 1  ON 38
eH1_9                 1.031107e-01 1 1  ON 39
eH2_0                -2.606509e-01 1 1  ON 40
eH2_1                -1.556449e-01 1 1  ON 41
eH2_2                -1.063723e-01 1 1  ON 42
eH2_3                -5.102235e-02 1 1  ON 43
eH2_4                -8.750734e-04 1 1  ON 44
eH2_5                 3.482929e-02 1 1  ON 45
eH2_6                 9.774174e-02 1 1  ON 46
eH2_7                 1.600974e-01 1 1  ON 47
eH2_8                 2.005403e-01 1 1  ON 48
eH2_9                 9.318790e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6163e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9139
    reference variance = 0.244575
====================================================
  Execution time = 2.0646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3982e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339912036526
                                         uncertainty =       0.003263208521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339912036526
                                         uncertainty =       0.003263208521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412198552
  error estimate for blocks of size 2^( 2) =       0.000424787093
  error estimate for blocks of size 2^( 3) =       0.000437553167
  error estimate for blocks of size 2^( 4) =       0.000449999757
  error estimate for blocks of size 2^( 5) =       0.000461113076
  error estimate for blocks of size 2^( 6) =       0.000467982197
  error estimate for blocks of size 2^( 7) =       0.000473695170

      target function =                  N/A
              le_mean =     -16.906269177783
             les_mean =     286.161752634944
             stat err =       0.000463197550
             autocorr =       1.262756412338
              std dev =       0.582936783187
             le_variance =       0.339815293193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626917778e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906269177783       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906269180539       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906269342548       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906269377383       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906269326546       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906268882269       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906268788361       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906268975596       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.081275e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906269177783       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906269178550       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906269224330       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906269228744       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906269212721       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906269114780       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906269066381       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906269078808       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.204844e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906269177783       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906269177980       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906269189803       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906269190527       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906269186131       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906269162767       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906269149222       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906269149466       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.299623e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6247e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.116039e-01 1 1  ON 0
 uu_1                 1.443131e-01 1 1  ON 1
 uu_2                 4.235994e-02 1 1  ON 2
 uu_3                -2.053962e-02 1 1  ON 3
 uu_4                -6.678462e-02 1 1  ON 4
 uu_5                -1.028308e-01 1 1  ON 5
 uu_6                -1.319132e-01 1 1  ON 6
 uu_7                -1.471103e-01 1 1  ON 7
 uu_8                -1.402568e-01 1 1  ON 8
 uu_9                -1.126993e-01 1 1  ON 9
 ud_0                 4.543917e-01 1 1  ON 10
 ud_1                 1.883139e-01 1 1  ON 11
 ud_2                 6.736414e-02 1 1  ON 12
 ud_3                -4.314800e-03 1 1  ON 13
 ud_4                -6.204948e-02 1 1  ON 14
 ud_5                -1.045778e-01 1 1  ON 15
 ud_6                -1.332320e-01 1 1  ON 16
 ud_7                -1.516191e-01 1 1  ON 17
 ud_8                -1.540754e-01 1 1  ON 18
 ud_9                -1.461986e-01 1 1  ON 19
 eO_0                -7.510401e-01 1 1  ON 20
 eO_1                -4.293416e-01 1 1  ON 21
 eO_2                -1.397217e-02 1 1  ON 22
 eO_3                 3.032062e-01 1 1  ON 23
 eO_4                 5.308164e-01 1 1  ON 24
 eO_5                 4.940914e-01 1 1  ON 25
 eO_6                 2.652348e-01 1 1  ON 26
 eO_7                -4.103018e-02 1 1  ON 27
 eO_8                -2.401453e-01 1 1  ON 28
 eO_9                -1.114501e-01 1 1  ON 29
eH1_0                -2.647120e-01 1 1  ON 30
eH1_1                -1.593392e-01 1 1  ON 31
eH1_2                -1.099548e-01 1 1  ON 32
eH1_3                -5.443551e-02 1 1  ON 33
eH1_4                -4.065158e-03 1 1  ON 34
eH1_5                 3.293269e-02 1 1  ON 35
eH1_6                 9.578096e-02 1 1  ON 36
eH1_7                 1.600319e-01 1 1  ON 37
eH1_8                 1.995468e-01 1 1  ON 38
eH1_9                 1.031627e-01 1 1  ON 39
eH2_0                -2.606760e-01 1 1  ON 40
eH2_1                -1.556205e-01 1 1  ON 41
eH2_2                -1.063860e-01 1 1  ON 42
eH2_3                -5.103630e-02 1 1  ON 43
eH2_4                -9.157137e-04 1 1  ON 44
eH2_5                 3.480630e-02 1 1  ON 45
eH2_6                 9.775068e-02 1 1  ON 46
eH2_7                 1.601124e-01 1 1  ON 47
eH2_8                 2.005606e-01 1 1  ON 48
eH2_9                 9.323268e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9351
    reference variance = 0.201446
====================================================
  Execution time = 2.1610e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3585e-01
  Total weights = 2.0000e+06
  Execution time = 2.1526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335947228443
                                         uncertainty =       0.003605445342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335947228443
                                         uncertainty =       0.003605445342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409795347
  error estimate for blocks of size 2^( 2) =       0.000422075037
  error estimate for blocks of size 2^( 3) =       0.000434848686
  error estimate for blocks of size 2^( 4) =       0.000446340420
  error estimate for blocks of size 2^( 5) =       0.000455575007
  error estimate for blocks of size 2^( 6) =       0.000461666087
  error estimate for blocks of size 2^( 7) =       0.000467405603

      target function =                  N/A
              le_mean =     -16.905861758046
             les_mean =     286.144026066444
             stat err =       0.000457746779
             autocorr =       1.247718313665
              std dev =       0.579538136991
             le_variance =       0.335864452227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335908595250
                                         uncertainty =       0.003605318481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335908595250
                                         uncertainty =       0.003605318481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409771786
  error estimate for blocks of size 2^( 2) =       0.000422053060
  error estimate for blocks of size 2^( 3) =       0.000434829203
  error estimate for blocks of size 2^( 4) =       0.000446322878
  error estimate for blocks of size 2^( 5) =       0.000455557931
  error estimate for blocks of size 2^( 6) =       0.000461649482
  error estimate for blocks of size 2^( 7) =       0.000467386020

      target function =                  N/A
              le_mean =     -16.905861579507
             les_mean =     286.143981411279
             stat err =       0.000457729078
             autocorr =       1.247765284408
              std dev =       0.579504817693
             le_variance =       0.335825833729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335921876460
                                         uncertainty =       0.003605337999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335921876460
                                         uncertainty =       0.003605337999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409779887
  error estimate for blocks of size 2^( 2) =       0.000422060483
  error estimate for blocks of size 2^( 3) =       0.000434835517
  error estimate for blocks of size 2^( 4) =       0.000446328320
  error estimate for blocks of size 2^( 5) =       0.000455563350
  error estimate for blocks of size 2^( 6) =       0.000461654649
  error estimate for blocks of size 2^( 7) =       0.000467392393

      target function =                  N/A
              le_mean =     -16.905861627730
             les_mean =     286.143996319811
             stat err =       0.000457734678
             autocorr =       1.247746484445
              std dev =       0.579516273944
             le_variance =       0.335839111765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335943770072
                                         uncertainty =       0.003605430017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335943770072
                                         uncertainty =       0.003605430017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409793238
  error estimate for blocks of size 2^( 2) =       0.000422073047
  error estimate for blocks of size 2^( 3) =       0.000434846875
  error estimate for blocks of size 2^( 4) =       0.000446338747
  error estimate for blocks of size 2^( 5) =       0.000455573399
  error estimate for blocks of size 2^( 6) =       0.000461664505
  error estimate for blocks of size 2^( 7) =       0.000467403787

      target function =                  N/A
              le_mean =     -16.905861738518
             les_mean =     286.144021949460
             stat err =       0.000457745110
             autocorr =       1.247722053285
              std dev =       0.579535154665
             le_variance =       0.335860995493


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905861758046        initial  <--
     9.7656e-01     9.7656e+00             2.0813e-04       -16.905861579507
     3.9062e+00     3.9062e+01             5.2048e-05       -16.905861627730
     1.5625e+01     1.5625e+02             1.2996e-05       -16.905861738518

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4067
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.115950e-01 1 1  ON 0
 uu_1                 1.443343e-01 1 1  ON 1
 uu_2                 4.237125e-02 1 1  ON 2
 uu_3                -2.053002e-02 1 1  ON 3
 uu_4                -6.677619e-02 1 1  ON 4
 uu_5                -1.028337e-01 1 1  ON 5
 uu_6                -1.319211e-01 1 1  ON 6
 uu_7                -1.471090e-01 1 1  ON 7
 uu_8                -1.402680e-01 1 1  ON 8
 uu_9                -1.126863e-01 1 1  ON 9
 ud_0                 4.544139e-01 1 1  ON 10
 ud_1                 1.883128e-01 1 1  ON 11
 ud_2                 6.736783e-02 1 1  ON 12
 ud_3                -4.323623e-03 1 1  ON 13
 ud_4                -6.206960e-02 1 1  ON 14
 ud_5                -1.045720e-01 1 1  ON 15
 ud_6                -1.332015e-01 1 1  ON 16
 ud_7                -1.516217e-01 1 1  ON 17
 ud_8                -1.540933e-01 1 1  ON 18
 ud_9                -1.462102e-01 1 1  ON 19
 eO_0                -7.510291e-01 1 1  ON 20
 eO_1                -4.293761e-01 1 1  ON 21
 eO_2                -1.398205e-02 1 1  ON 22
 eO_3                 3.032092e-01 1 1  ON 23
 eO_4                 5.308167e-01 1 1  ON 24
 eO_5                 4.940825e-01 1 1  ON 25
 eO_6                 2.652254e-01 1 1  ON 26
 eO_7                -4.103394e-02 1 1  ON 27
 eO_8                -2.401297e-01 1 1  ON 28
 eO_9                -1.114181e-01 1 1  ON 29
eH1_0                -2.646898e-01 1 1  ON 30
eH1_1                -1.593484e-01 1 1  ON 31
eH1_2                -1.099602e-01 1 1  ON 32
eH1_3                -5.441171e-02 1 1  ON 33
eH1_4                -4.020810e-03 1 1  ON 34
eH1_5                 3.295329e-02 1 1  ON 35
eH1_6                 9.579835e-02 1 1  ON 36
eH1_7                 1.600135e-01 1 1  ON 37
eH1_8                 1.995186e-01 1 1  ON 38
eH1_9                 1.031107e-01 1 1  ON 39
eH2_0                -2.606509e-01 1 1  ON 40
eH2_1                -1.556449e-01 1 1  ON 41
eH2_2                -1.063723e-01 1 1  ON 42
eH2_3                -5.102235e-02 1 1  ON 43
eH2_4                -8.750734e-04 1 1  ON 44
eH2_5                 3.482929e-02 1 1  ON 45
eH2_6                 9.774174e-02 1 1  ON 46
eH2_7                 1.600974e-01 1 1  ON 47
eH2_8                 2.005403e-01 1 1  ON 48
eH2_9                 9.318790e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7663e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8532
    reference variance = 0.200821
====================================================
  Execution time = 2.0838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4592e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345846439666
                                         uncertainty =       0.007804009067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345846439666
                                         uncertainty =       0.007804009067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415886087
  error estimate for blocks of size 2^( 2) =       0.000428375534
  error estimate for blocks of size 2^( 3) =       0.000440957419
  error estimate for blocks of size 2^( 4) =       0.000452107385
  error estimate for blocks of size 2^( 5) =       0.000460734827
  error estimate for blocks of size 2^( 6) =       0.000466021555
  error estimate for blocks of size 2^( 7) =       0.000468499744

      target function =                  N/A
              le_mean =     -16.906948579205
             les_mean =     286.190832561602
             stat err =       0.000461840878
             autocorr =       1.233206928724
              std dev =       0.588151744610
             le_variance =       0.345922474688


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690694857920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906948579205       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906948629544       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906948628244       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906948632517       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906948639266       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906948649540       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906948652351       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906948640929       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.884078e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906948579205       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906948591913       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906948591561       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906948592664       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906948594555       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906948597137       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906948598117       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906948595311       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 4.739453e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906948579205       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906948582390       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906948582300       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906948582578       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906948583063       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906948583710       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906948583973       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906948583275       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.186713e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251558 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6440e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.115939e-01 1 1  ON 0
 uu_1                 1.443340e-01 1 1  ON 1
 uu_2                 4.237117e-02 1 1  ON 2
 uu_3                -2.052656e-02 1 1  ON 3
 uu_4                -6.677866e-02 1 1  ON 4
 uu_5                -1.028327e-01 1 1  ON 5
 uu_6                -1.319181e-01 1 1  ON 6
 uu_7                -1.471118e-01 1 1  ON 7
 uu_8                -1.402700e-01 1 1  ON 8
 uu_9                -1.126878e-01 1 1  ON 9
 ud_0                 4.544125e-01 1 1  ON 10
 ud_1                 1.883157e-01 1 1  ON 11
 ud_2                 6.736996e-02 1 1  ON 12
 ud_3                -4.323402e-03 1 1  ON 13
 ud_4                -6.206891e-02 1 1  ON 14
 ud_5                -1.045710e-01 1 1  ON 15
 ud_6                -1.332016e-01 1 1  ON 16
 ud_7                -1.516224e-01 1 1  ON 17
 ud_8                -1.540939e-01 1 1  ON 18
 ud_9                -1.462122e-01 1 1  ON 19
 eO_0                -7.510275e-01 1 1  ON 20
 eO_1                -4.293756e-01 1 1  ON 21
 eO_2                -1.398181e-02 1 1  ON 22
 eO_3                 3.032091e-01 1 1  ON 23
 eO_4                 5.308193e-01 1 1  ON 24
 eO_5                 4.940848e-01 1 1  ON 25
 eO_6                 2.652254e-01 1 1  ON 26
 eO_7                -4.103485e-02 1 1  ON 27
 eO_8                -2.401324e-01 1 1  ON 28
 eO_9                -1.114210e-01 1 1  ON 29
eH1_0                -2.646904e-01 1 1  ON 30
eH1_1                -1.593488e-01 1 1  ON 31
eH1_2                -1.099593e-01 1 1  ON 32
eH1_3                -5.441298e-02 1 1  ON 33
eH1_4                -4.019987e-03 1 1  ON 34
eH1_5                 3.295108e-02 1 1  ON 35
eH1_6                 9.579444e-02 1 1  ON 36
eH1_7                 1.600132e-01 1 1  ON 37
eH1_8                 1.995209e-01 1 1  ON 38
eH1_9                 1.031145e-01 1 1  ON 39
eH2_0                -2.606556e-01 1 1  ON 40
eH2_1                -1.556443e-01 1 1  ON 41
eH2_2                -1.063721e-01 1 1  ON 42
eH2_3                -5.102304e-02 1 1  ON 43
eH2_4                -8.743171e-04 1 1  ON 44
eH2_5                 3.482939e-02 1 1  ON 45
eH2_6                 9.774128e-02 1 1  ON 46
eH2_7                 1.600964e-01 1 1  ON 47
eH2_8                 2.005411e-01 1 1  ON 48
eH2_9                 9.319189e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8841
    reference variance = 0.252944
====================================================
  Execution time = 2.0539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4981e-01
  Total weights = 2.0000e+06
  Execution time = 1.8859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349730434783
                                         uncertainty =       0.006815009376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349730434783
                                         uncertainty =       0.006815009376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418220160
  error estimate for blocks of size 2^( 2) =       0.000430516529
  error estimate for blocks of size 2^( 3) =       0.000443848153
  error estimate for blocks of size 2^( 4) =       0.000456168889
  error estimate for blocks of size 2^( 5) =       0.000467430013
  error estimate for blocks of size 2^( 6) =       0.000475020878
  error estimate for blocks of size 2^( 7) =       0.000480080934

      target function =                  N/A
              le_mean =     -16.906784272263
             les_mean =     286.189170458389
             stat err =       0.000469675178
             autocorr =       1.261203857345
              std dev =       0.591452622319
             le_variance =       0.349816204447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349712835445
                                         uncertainty =       0.006814602388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349712835445
                                         uncertainty =       0.006814602388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418209638
  error estimate for blocks of size 2^( 2) =       0.000430506496
  error estimate for blocks of size 2^( 3) =       0.000443838477
  error estimate for blocks of size 2^( 4) =       0.000456159701
  error estimate for blocks of size 2^( 5) =       0.000467421032
  error estimate for blocks of size 2^( 6) =       0.000475012165
  error estimate for blocks of size 2^( 7) =       0.000480072059

      target function =                  N/A
              le_mean =     -16.906784110318
             les_mean =     286.189147379946
             stat err =       0.000469666239
             autocorr =       1.261219313685
              std dev =       0.591437741383
             le_variance =       0.349798601932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349721345198
                                         uncertainty =       0.006814798563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349721345198
                                         uncertainty =       0.006814798563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418214725
  error estimate for blocks of size 2^( 2) =       0.000430511348
  error estimate for blocks of size 2^( 3) =       0.000443843157
  error estimate for blocks of size 2^( 4) =       0.000456164147
  error estimate for blocks of size 2^( 5) =       0.000467425378
  error estimate for blocks of size 2^( 6) =       0.000475016379
  error estimate for blocks of size 2^( 7) =       0.000480076347

      target function =                  N/A
              le_mean =     -16.906784188214
             les_mean =     286.189158525117
             stat err =       0.000469670562
             autocorr =       1.261211844694
              std dev =       0.591444936725
             le_variance =       0.349807113177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349729288952
                                         uncertainty =       0.006814982786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349729288952
                                         uncertainty =       0.006814982786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418219475
  error estimate for blocks of size 2^( 2) =       0.000430515876
  error estimate for blocks of size 2^( 3) =       0.000443847523
  error estimate for blocks of size 2^( 4) =       0.000456168291
  error estimate for blocks of size 2^( 5) =       0.000467429429
  error estimate for blocks of size 2^( 6) =       0.000475020311
  error estimate for blocks of size 2^( 7) =       0.000480080356

      target function =                  N/A
              le_mean =     -16.906784261632
             les_mean =     286.189168952849
             stat err =       0.000469674597
             autocorr =       1.261204864199
              std dev =       0.591451653479
             le_variance =       0.349815058403


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906784272263        initial  <--
     9.7656e+00     9.7656e+01             1.8841e-05       -16.906784110318
     3.9062e+01     3.9062e+02             4.7395e-06       -16.906784188214
     1.5625e+02     1.5625e+03             1.1867e-06       -16.906784261632

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1186
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.115950e-01 1 1  ON 0
 uu_1                 1.443343e-01 1 1  ON 1
 uu_2                 4.237125e-02 1 1  ON 2
 uu_3                -2.053002e-02 1 1  ON 3
 uu_4                -6.677619e-02 1 1  ON 4
 uu_5                -1.028337e-01 1 1  ON 5
 uu_6                -1.319211e-01 1 1  ON 6
 uu_7                -1.471090e-01 1 1  ON 7
 uu_8                -1.402680e-01 1 1  ON 8
 uu_9                -1.126863e-01 1 1  ON 9
 ud_0                 4.544139e-01 1 1  ON 10
 ud_1                 1.883128e-01 1 1  ON 11
 ud_2                 6.736783e-02 1 1  ON 12
 ud_3                -4.323623e-03 1 1  ON 13
 ud_4                -6.206960e-02 1 1  ON 14
 ud_5                -1.045720e-01 1 1  ON 15
 ud_6                -1.332015e-01 1 1  ON 16
 ud_7                -1.516217e-01 1 1  ON 17
 ud_8                -1.540933e-01 1 1  ON 18
 ud_9                -1.462102e-01 1 1  ON 19
 eO_0                -7.510291e-01 1 1  ON 20
 eO_1                -4.293761e-01 1 1  ON 21
 eO_2                -1.398205e-02 1 1  ON 22
 eO_3                 3.032092e-01 1 1  ON 23
 eO_4                 5.308167e-01 1 1  ON 24
 eO_5                 4.940825e-01 1 1  ON 25
 eO_6                 2.652254e-01 1 1  ON 26
 eO_7                -4.103394e-02 1 1  ON 27
 eO_8                -2.401297e-01 1 1  ON 28
 eO_9                -1.114181e-01 1 1  ON 29
eH1_0                -2.646898e-01 1 1  ON 30
eH1_1                -1.593484e-01 1 1  ON 31
eH1_2                -1.099602e-01 1 1  ON 32
eH1_3                -5.441171e-02 1 1  ON 33
eH1_4                -4.020810e-03 1 1  ON 34
eH1_5                 3.295329e-02 1 1  ON 35
eH1_6                 9.579835e-02 1 1  ON 36
eH1_7                 1.600135e-01 1 1  ON 37
eH1_8                 1.995186e-01 1 1  ON 38
eH1_9                 1.031107e-01 1 1  ON 39
eH2_0                -2.606509e-01 1 1  ON 40
eH2_1                -1.556449e-01 1 1  ON 41
eH2_2                -1.063723e-01 1 1  ON 42
eH2_3                -5.102235e-02 1 1  ON 43
eH2_4                -8.750734e-04 1 1  ON 44
eH2_5                 3.482929e-02 1 1  ON 45
eH2_6                 9.774174e-02 1 1  ON 46
eH2_7                 1.600974e-01 1 1  ON 47
eH2_8                 2.005403e-01 1 1  ON 48
eH2_9                 9.318790e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6568e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8878
    reference variance = 0.243448
====================================================
  Execution time = 2.0912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5103e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5583e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351093224726
                                         uncertainty =       0.014770919877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351093224726
                                         uncertainty =       0.014770919877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418943210
  error estimate for blocks of size 2^( 2) =       0.000431297996
  error estimate for blocks of size 2^( 3) =       0.000443987250
  error estimate for blocks of size 2^( 4) =       0.000455252434
  error estimate for blocks of size 2^( 5) =       0.000464962956
  error estimate for blocks of size 2^( 6) =       0.000473552571
  error estimate for blocks of size 2^( 7) =       0.000481186781

      target function =                  N/A
              le_mean =     -16.906534097479
             les_mean =     286.181921840100
             stat err =       0.000468738686
             autocorr =       1.251847088389
              std dev =       0.592475169440
             le_variance =       0.351026826402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653409748e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534097479       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534094742       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534098576       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906534100889       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906534103019       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906534105969       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906534105018       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.006677e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534097479       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534096794       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534097753       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906534098330       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906534098860       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906534099598       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906534099365       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.021199e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906534097479       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534097307       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906534097547       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906534097691       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906534097825       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906534098008       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906534097950       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.255581e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253800 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6483e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.115952e-01 1 1  ON 0
 uu_1                 1.443345e-01 1 1  ON 1
 uu_2                 4.237122e-02 1 1  ON 2
 uu_3                -2.052998e-02 1 1  ON 3
 uu_4                -6.677634e-02 1 1  ON 4
 uu_5                -1.028339e-01 1 1  ON 5
 uu_6                -1.319212e-01 1 1  ON 6
 uu_7                -1.471092e-01 1 1  ON 7
 uu_8                -1.402681e-01 1 1  ON 8
 uu_9                -1.126863e-01 1 1  ON 9
 ud_0                 4.544139e-01 1 1  ON 10
 ud_1                 1.883126e-01 1 1  ON 11
 ud_2                 6.736780e-02 1 1  ON 12
 ud_3                -4.323953e-03 1 1  ON 13
 ud_4                -6.206948e-02 1 1  ON 14
 ud_5                -1.045720e-01 1 1  ON 15
 ud_6                -1.332015e-01 1 1  ON 16
 ud_7                -1.516218e-01 1 1  ON 17
 ud_8                -1.540930e-01 1 1  ON 18
 ud_9                -1.462100e-01 1 1  ON 19
 eO_0                -7.510292e-01 1 1  ON 20
 eO_1                -4.293760e-01 1 1  ON 21
 eO_2                -1.398155e-02 1 1  ON 22
 eO_3                 3.032091e-01 1 1  ON 23
 eO_4                 5.308167e-01 1 1  ON 24
 eO_5                 4.940825e-01 1 1  ON 25
 eO_6                 2.652255e-01 1 1  ON 26
 eO_7                -4.103399e-02 1 1  ON 27
 eO_8                -2.401298e-01 1 1  ON 28
 eO_9                -1.114183e-01 1 1  ON 29
eH1_0                -2.646901e-01 1 1  ON 30
eH1_1                -1.593483e-01 1 1  ON 31
eH1_2                -1.099601e-01 1 1  ON 32
eH1_3                -5.441175e-02 1 1  ON 33
eH1_4                -4.021054e-03 1 1  ON 34
eH1_5                 3.295291e-02 1 1  ON 35
eH1_6                 9.579826e-02 1 1  ON 36
eH1_7                 1.600137e-01 1 1  ON 37
eH1_8                 1.995188e-01 1 1  ON 38
eH1_9                 1.031111e-01 1 1  ON 39
eH2_0                -2.606510e-01 1 1  ON 40
eH2_1                -1.556449e-01 1 1  ON 41
eH2_2                -1.063723e-01 1 1  ON 42
eH2_3                -5.102258e-02 1 1  ON 43
eH2_4                -8.753155e-04 1 1  ON 44
eH2_5                 3.482935e-02 1 1  ON 45
eH2_6                 9.774169e-02 1 1  ON 46
eH2_7                 1.600975e-01 1 1  ON 47
eH2_8                 2.005404e-01 1 1  ON 48
eH2_9                 9.318829e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9063
    reference variance = 0.253034
====================================================
  Execution time = 2.0374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4667e-01
  Total weights = 2.0000e+06
  Execution time = 1.8917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346728114319
                                         uncertainty =       0.006804576123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346728114319
                                         uncertainty =       0.006804576123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416337283
  error estimate for blocks of size 2^( 2) =       0.000429339747
  error estimate for blocks of size 2^( 3) =       0.000442134718
  error estimate for blocks of size 2^( 4) =       0.000454904153
  error estimate for blocks of size 2^( 5) =       0.000467110434
  error estimate for blocks of size 2^( 6) =       0.000476172411
  error estimate for blocks of size 2^( 7) =       0.000481788930

      target function =                  N/A
              le_mean =     -16.905742352108
             les_mean =     286.150797768417
             stat err =       0.000469993982
             autocorr =       1.274365447238
              std dev =       0.588789831687
             le_variance =       0.346673465898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346728557666
                                         uncertainty =       0.006804581109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346728557666
                                         uncertainty =       0.006804581109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416337549
  error estimate for blocks of size 2^( 2) =       0.000429340003
  error estimate for blocks of size 2^( 3) =       0.000442134960
  error estimate for blocks of size 2^( 4) =       0.000454904414
  error estimate for blocks of size 2^( 5) =       0.000467110688
  error estimate for blocks of size 2^( 6) =       0.000476172679
  error estimate for blocks of size 2^( 7) =       0.000481789220

      target function =                  N/A
              le_mean =     -16.905742362093
             les_mean =     286.150798549425
             stat err =       0.000469994250
             autocorr =       1.274365271570
              std dev =       0.588790208210
             le_variance =       0.346673909284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346728336184
                                         uncertainty =       0.006804578603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346728336184
                                         uncertainty =       0.006804578603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416337416
  error estimate for blocks of size 2^( 2) =       0.000429339875
  error estimate for blocks of size 2^( 3) =       0.000442134839
  error estimate for blocks of size 2^( 4) =       0.000454904284
  error estimate for blocks of size 2^( 5) =       0.000467110561
  error estimate for blocks of size 2^( 6) =       0.000476172545
  error estimate for blocks of size 2^( 7) =       0.000481789075

      target function =                  N/A
              le_mean =     -16.905742357105
             les_mean =     286.150798159261
             stat err =       0.000469994116
             autocorr =       1.274365359702
              std dev =       0.588790020111
             le_variance =       0.346673687782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346728142056
                                         uncertainty =       0.006804576433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346728142056
                                         uncertainty =       0.006804576433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416337299
  error estimate for blocks of size 2^( 2) =       0.000429339763
  error estimate for blocks of size 2^( 3) =       0.000442134733
  error estimate for blocks of size 2^( 4) =       0.000454904170
  error estimate for blocks of size 2^( 5) =       0.000467110450
  error estimate for blocks of size 2^( 6) =       0.000476172428
  error estimate for blocks of size 2^( 7) =       0.000481788948

      target function =                  N/A
              le_mean =     -16.905742352733
             les_mean =     286.150797817276
             stat err =       0.000469993999
             autocorr =       1.274365436310
              std dev =       0.588789855244
             le_variance =       0.346673493638


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905742352108        initial
     9.7656e+01     9.7656e+02             2.0067e-06       -16.905742362093  <--
     3.9062e+02     3.9062e+03             5.0212e-07       -16.905742357105
     1.5625e+03     1.5625e+04             1.2556e-07       -16.905742352733

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 2.9921e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.115956e-01 1 1  ON 0
 uu_1                 1.443349e-01 1 1  ON 1
 uu_2                 4.237111e-02 1 1  ON 2
 uu_3                -2.052985e-02 1 1  ON 3
 uu_4                -6.677677e-02 1 1  ON 4
 uu_5                -1.028345e-01 1 1  ON 5
 uu_6                -1.319213e-01 1 1  ON 6
 uu_7                -1.471100e-01 1 1  ON 7
 uu_8                -1.402682e-01 1 1  ON 8
 uu_9                -1.126864e-01 1 1  ON 9
 ud_0                 4.544139e-01 1 1  ON 10
 ud_1                 1.883120e-01 1 1  ON 11
 ud_2                 6.736774e-02 1 1  ON 12
 ud_3                -4.324939e-03 1 1  ON 13
 ud_4                -6.206914e-02 1 1  ON 14
 ud_5                -1.045721e-01 1 1  ON 15
 ud_6                -1.332014e-01 1 1  ON 16
 ud_7                -1.516221e-01 1 1  ON 17
 ud_8                -1.540923e-01 1 1  ON 18
 ud_9                -1.462092e-01 1 1  ON 19
 eO_0                -7.510295e-01 1 1  ON 20
 eO_1                -4.293759e-01 1 1  ON 21
 eO_2                -1.398005e-02 1 1  ON 22
 eO_3                 3.032089e-01 1 1  ON 23
 eO_4                 5.308164e-01 1 1  ON 24
 eO_5                 4.940827e-01 1 1  ON 25
 eO_6                 2.652256e-01 1 1  ON 26
 eO_7                -4.103415e-02 1 1  ON 27
 eO_8                -2.401300e-01 1 1  ON 28
 eO_9                -1.114190e-01 1 1  ON 29
eH1_0                -2.646908e-01 1 1  ON 30
eH1_1                -1.593479e-01 1 1  ON 31
eH1_2                -1.099601e-01 1 1  ON 32
eH1_3                -5.441188e-02 1 1  ON 33
eH1_4                -4.021785e-03 1 1  ON 34
eH1_5                 3.295180e-02 1 1  ON 35
eH1_6                 9.579799e-02 1 1  ON 36
eH1_7                 1.600141e-01 1 1  ON 37
eH1_8                 1.995194e-01 1 1  ON 38
eH1_9                 1.031123e-01 1 1  ON 39
eH2_0                -2.606515e-01 1 1  ON 40
eH2_1                -1.556448e-01 1 1  ON 41
eH2_2                -1.063722e-01 1 1  ON 42
eH2_3                -5.102329e-02 1 1  ON 43
eH2_4                -8.760416e-04 1 1  ON 44
eH2_5                 3.482950e-02 1 1  ON 45
eH2_6                 9.774157e-02 1 1  ON 46
eH2_7                 1.600977e-01 1 1  ON 47
eH2_8                 2.005407e-01 1 1  ON 48
eH2_9                 9.318945e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6412e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.854
    reference variance = 0.171205
====================================================
  Execution time = 2.0815e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3572e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5369e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335774477415
                                         uncertainty =       0.002778080189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335774477415
                                         uncertainty =       0.002778080189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409705274
  error estimate for blocks of size 2^( 2) =       0.000422673482
  error estimate for blocks of size 2^( 3) =       0.000435452905
  error estimate for blocks of size 2^( 4) =       0.000447493232
  error estimate for blocks of size 2^( 5) =       0.000458964482
  error estimate for blocks of size 2^( 6) =       0.000465291755
  error estimate for blocks of size 2^( 7) =       0.000470096140

      target function =                  N/A
              le_mean =     -16.906140458796
             les_mean =     286.153301868248
             stat err =       0.000460461402
             autocorr =       1.263116341162
              std dev =       0.579410755486
             le_variance =       0.335716823573


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614045880e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906140458796       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906140486344       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906140494294       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906140500495       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906140506275       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906140514991       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906140513916       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 8.302527e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906140458796       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906140465702       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906140467699       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906140469258       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906140470693       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906140472870       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906140472606       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.077929e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906140458796       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906140460524       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906140461023       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906140461414       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906140461772       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906140462316       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906140462251       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.196243e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256034 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6358e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.115957e-01 1 1  ON 0
 uu_1                 1.443344e-01 1 1  ON 1
 uu_2                 4.237159e-02 1 1  ON 2
 uu_3                -2.053018e-02 1 1  ON 3
 uu_4                -6.677687e-02 1 1  ON 4
 uu_5                -1.028341e-01 1 1  ON 5
 uu_6                -1.319218e-01 1 1  ON 6
 uu_7                -1.471093e-01 1 1  ON 7
 uu_8                -1.402687e-01 1 1  ON 8
 uu_9                -1.126875e-01 1 1  ON 9
 ud_0                 4.544132e-01 1 1  ON 10
 ud_1                 1.883117e-01 1 1  ON 11
 ud_2                 6.736722e-02 1 1  ON 12
 ud_3                -4.324897e-03 1 1  ON 13
 ud_4                -6.206927e-02 1 1  ON 14
 ud_5                -1.045723e-01 1 1  ON 15
 ud_6                -1.332004e-01 1 1  ON 16
 ud_7                -1.516216e-01 1 1  ON 17
 ud_8                -1.540915e-01 1 1  ON 18
 ud_9                -1.462085e-01 1 1  ON 19
 eO_0                -7.510295e-01 1 1  ON 20
 eO_1                -4.293755e-01 1 1  ON 21
 eO_2                -1.398058e-02 1 1  ON 22
 eO_3                 3.032095e-01 1 1  ON 23
 eO_4                 5.308169e-01 1 1  ON 24
 eO_5                 4.940835e-01 1 1  ON 25
 eO_6                 2.652261e-01 1 1  ON 26
 eO_7                -4.103381e-02 1 1  ON 27
 eO_8                -2.401307e-01 1 1  ON 28
 eO_9                -1.114205e-01 1 1  ON 29
eH1_0                -2.646905e-01 1 1  ON 30
eH1_1                -1.593472e-01 1 1  ON 31
eH1_2                -1.099614e-01 1 1  ON 32
eH1_3                -5.441218e-02 1 1  ON 33
eH1_4                -4.022013e-03 1 1  ON 34
eH1_5                 3.295055e-02 1 1  ON 35
eH1_6                 9.579775e-02 1 1  ON 36
eH1_7                 1.600140e-01 1 1  ON 37
eH1_8                 1.995203e-01 1 1  ON 38
eH1_9                 1.031137e-01 1 1  ON 39
eH2_0                -2.606533e-01 1 1  ON 40
eH2_1                -1.556447e-01 1 1  ON 41
eH2_2                -1.063730e-01 1 1  ON 42
eH2_3                -5.102403e-02 1 1  ON 43
eH2_4                -8.766719e-04 1 1  ON 44
eH2_5                 3.482944e-02 1 1  ON 45
eH2_6                 9.774189e-02 1 1  ON 46
eH2_7                 1.600981e-01 1 1  ON 47
eH2_8                 2.005417e-01 1 1  ON 48
eH2_9                 9.319153e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8558
    reference variance = 0.282195
====================================================
  Execution time = 2.0747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3578e-01
  Total weights = 2.0000e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335702564526
                                         uncertainty =       0.002466940234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335702564526
                                         uncertainty =       0.002466940234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409741096
  error estimate for blocks of size 2^( 2) =       0.000422138494
  error estimate for blocks of size 2^( 3) =       0.000434932750
  error estimate for blocks of size 2^( 4) =       0.000447199980
  error estimate for blocks of size 2^( 5) =       0.000457577973
  error estimate for blocks of size 2^( 6) =       0.000465225901
  error estimate for blocks of size 2^( 7) =       0.000472644244

      target function =                  N/A
              le_mean =     -16.907089079132
             les_mean =     286.185436493877
             stat err =       0.000460662025
             autocorr =       1.263996216058
              std dev =       0.579461415507
             le_variance =       0.335775532062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335701758620
                                         uncertainty =       0.002466937937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335701758620
                                         uncertainty =       0.002466937937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409740605
  error estimate for blocks of size 2^( 2) =       0.000422138036
  error estimate for blocks of size 2^( 3) =       0.000434932316
  error estimate for blocks of size 2^( 4) =       0.000447199618
  error estimate for blocks of size 2^( 5) =       0.000457577515
  error estimate for blocks of size 2^( 6) =       0.000465225326
  error estimate for blocks of size 2^( 7) =       0.000472643463

      target function =                  N/A
              le_mean =     -16.907089097112
             les_mean =     286.185436296111
             stat err =       0.000460661480
             autocorr =       1.263996262702
              std dev =       0.579460720264
             le_variance =       0.335774726329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335702154965
                                         uncertainty =       0.002466939041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335702154965
                                         uncertainty =       0.002466939041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409740847
  error estimate for blocks of size 2^( 2) =       0.000422138261
  error estimate for blocks of size 2^( 3) =       0.000434932529
  error estimate for blocks of size 2^( 4) =       0.000447199796
  error estimate for blocks of size 2^( 5) =       0.000457577740
  error estimate for blocks of size 2^( 6) =       0.000465225609
  error estimate for blocks of size 2^( 7) =       0.000472643848

      target function =                  N/A
              le_mean =     -16.907089088135
             les_mean =     286.185436388838
             stat err =       0.000460661748
             autocorr =       1.263996240996
              std dev =       0.579461062185
             le_variance =       0.335775122589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335702513103
                                         uncertainty =       0.002466940083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335702513103
                                         uncertainty =       0.002466940083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409741065
  error estimate for blocks of size 2^( 2) =       0.000422138465
  error estimate for blocks of size 2^( 3) =       0.000434932722
  error estimate for blocks of size 2^( 4) =       0.000447199957
  error estimate for blocks of size 2^( 5) =       0.000457577943
  error estimate for blocks of size 2^( 6) =       0.000465225865
  error estimate for blocks of size 2^( 7) =       0.000472644195

      target function =                  N/A
              le_mean =     -16.907089080256
             les_mean =     286.185436480461
             stat err =       0.000460661990
             autocorr =       1.263996219240
              std dev =       0.579461371145
             le_variance =       0.335775480650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907089079132        initial
     2.4414e+01     2.4414e+02             8.3025e-06       -16.907089097112  <--
     9.7656e+01     9.7656e+02             2.0779e-06       -16.907089088135
     3.9062e+02     3.9062e+03             5.1962e-07       -16.907089080256

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 3.0260e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.115962e-01 1 1  ON 0
 uu_1                 1.443330e-01 1 1  ON 1
 uu_2                 4.237298e-02 1 1  ON 2
 uu_3                -2.053116e-02 1 1  ON 3
 uu_4                -6.677719e-02 1 1  ON 4
 uu_5                -1.028328e-01 1 1  ON 5
 uu_6                -1.319235e-01 1 1  ON 6
 uu_7                -1.471070e-01 1 1  ON 7
 uu_8                -1.402701e-01 1 1  ON 8
 uu_9                -1.126906e-01 1 1  ON 9
 ud_0                 4.544111e-01 1 1  ON 10
 ud_1                 1.883110e-01 1 1  ON 11
 ud_2                 6.736567e-02 1 1  ON 12
 ud_3                -4.324790e-03 1 1  ON 13
 ud_4                -6.206965e-02 1 1  ON 14
 ud_5                -1.045732e-01 1 1  ON 15
 ud_6                -1.331974e-01 1 1  ON 16
 ud_7                -1.516201e-01 1 1  ON 17
 ud_8                -1.540890e-01 1 1  ON 18
 ud_9                -1.462066e-01 1 1  ON 19
 eO_0                -7.510293e-01 1 1  ON 20
 eO_1                -4.293746e-01 1 1  ON 21
 eO_2                -1.398216e-02 1 1  ON 22
 eO_3                 3.032112e-01 1 1  ON 23
 eO_4                 5.308182e-01 1 1  ON 24
 eO_5                 4.940859e-01 1 1  ON 25
 eO_6                 2.652276e-01 1 1  ON 26
 eO_7                -4.103277e-02 1 1  ON 27
 eO_8                -2.401327e-01 1 1  ON 28
 eO_9                -1.114251e-01 1 1  ON 29
eH1_0                -2.646895e-01 1 1  ON 30
eH1_1                -1.593451e-01 1 1  ON 31
eH1_2                -1.099652e-01 1 1  ON 32
eH1_3                -5.441308e-02 1 1  ON 33
eH1_4                -4.022704e-03 1 1  ON 34
eH1_5                 3.294681e-02 1 1  ON 35
eH1_6                 9.579703e-02 1 1  ON 36
eH1_7                 1.600135e-01 1 1  ON 37
eH1_8                 1.995227e-01 1 1  ON 38
eH1_9                 1.031180e-01 1 1  ON 39
eH2_0                -2.606588e-01 1 1  ON 40
eH2_1                -1.556443e-01 1 1  ON 41
eH2_2                -1.063755e-01 1 1  ON 42
eH2_3                -5.102623e-02 1 1  ON 43
eH2_4                -8.785646e-04 1 1  ON 44
eH2_5                 3.482925e-02 1 1  ON 45
eH2_6                 9.774288e-02 1 1  ON 46
eH2_7                 1.600993e-01 1 1  ON 47
eH2_8                 2.005444e-01 1 1  ON 48
eH2_9                 9.319775e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6626e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8423
    reference variance = 0.21446
====================================================
  Execution time = 2.1056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4094e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341000125769
                                         uncertainty =       0.003458292902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341000125769
                                         uncertainty =       0.003458292902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412878442
  error estimate for blocks of size 2^( 2) =       0.000425665213
  error estimate for blocks of size 2^( 3) =       0.000438783756
  error estimate for blocks of size 2^( 4) =       0.000451740444
  error estimate for blocks of size 2^( 5) =       0.000463101366
  error estimate for blocks of size 2^( 6) =       0.000471913320
  error estimate for blocks of size 2^( 7) =       0.000475777038

      target function =                  N/A
              le_mean =     -16.906628363404
             les_mean =     286.175019662847
             stat err =       0.000465633042
             autocorr =       1.271871301256
              std dev =       0.583898291716
             le_variance =       0.340937215069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690662836340e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906628363404       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906628415498       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906628432741       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906628444067       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906628424925       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906628480407       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906628478298       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906628473166       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.292048e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906628363404       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906628376550       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906628381184       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906628384163       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906628379930       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906628394534       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906628393548       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906628392388       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 8.243490e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906628363404       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906628366698       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906628367878       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906628368632       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906628367612       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906628371313       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906628371040       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906628370757       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.061739e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6764e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.115947e-01 1 1  ON 0
 uu_1                 1.443345e-01 1 1  ON 1
 uu_2                 4.237223e-02 1 1  ON 2
 uu_3                -2.053025e-02 1 1  ON 3
 uu_4                -6.677516e-02 1 1  ON 4
 uu_5                -1.028369e-01 1 1  ON 5
 uu_6                -1.319229e-01 1 1  ON 6
 uu_7                -1.471120e-01 1 1  ON 7
 uu_8                -1.402671e-01 1 1  ON 8
 uu_9                -1.126915e-01 1 1  ON 9
 ud_0                 4.544155e-01 1 1  ON 10
 ud_1                 1.883102e-01 1 1  ON 11
 ud_2                 6.736712e-02 1 1  ON 12
 ud_3                -4.325848e-03 1 1  ON 13
 ud_4                -6.206685e-02 1 1  ON 14
 ud_5                -1.045736e-01 1 1  ON 15
 ud_6                -1.332009e-01 1 1  ON 16
 ud_7                -1.516214e-01 1 1  ON 17
 ud_8                -1.540907e-01 1 1  ON 18
 ud_9                -1.462064e-01 1 1  ON 19
 eO_0                -7.510294e-01 1 1  ON 20
 eO_1                -4.293709e-01 1 1  ON 21
 eO_2                -1.398021e-02 1 1  ON 22
 eO_3                 3.032112e-01 1 1  ON 23
 eO_4                 5.308182e-01 1 1  ON 24
 eO_5                 4.940914e-01 1 1  ON 25
 eO_6                 2.652268e-01 1 1  ON 26
 eO_7                -4.103504e-02 1 1  ON 27
 eO_8                -2.401348e-01 1 1  ON 28
 eO_9                -1.114299e-01 1 1  ON 29
eH1_0                -2.646935e-01 1 1  ON 30
eH1_1                -1.593465e-01 1 1  ON 31
eH1_2                -1.099642e-01 1 1  ON 32
eH1_3                -5.441799e-02 1 1  ON 33
eH1_4                -4.022112e-03 1 1  ON 34
eH1_5                 3.294621e-02 1 1  ON 35
eH1_6                 9.579414e-02 1 1  ON 36
eH1_7                 1.600135e-01 1 1  ON 37
eH1_8                 1.995258e-01 1 1  ON 38
eH1_9                 1.031255e-01 1 1  ON 39
eH2_0                -2.606648e-01 1 1  ON 40
eH2_1                -1.556463e-01 1 1  ON 41
eH2_2                -1.063802e-01 1 1  ON 42
eH2_3                -5.102509e-02 1 1  ON 43
eH2_4                -8.789276e-04 1 1  ON 44
eH2_5                 3.482729e-02 1 1  ON 45
eH2_6                 9.774272e-02 1 1  ON 46
eH2_7                 1.601006e-01 1 1  ON 47
eH2_8                 2.005472e-01 1 1  ON 48
eH2_9                 9.320600e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8483
    reference variance = 0.344026
====================================================
  Execution time = 2.0812e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4815e-01
  Total weights = 2.0000e+06
  Execution time = 1.8870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348264120497
                                         uncertainty =       0.011199994234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348264120497
                                         uncertainty =       0.011199994234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417218995
  error estimate for blocks of size 2^( 2) =       0.000429145940
  error estimate for blocks of size 2^( 3) =       0.000441881161
  error estimate for blocks of size 2^( 4) =       0.000453199195
  error estimate for blocks of size 2^( 5) =       0.000462769775
  error estimate for blocks of size 2^( 6) =       0.000469089958
  error estimate for blocks of size 2^( 7) =       0.000474524209

      target function =                  N/A
              le_mean =     -16.906660145522
             les_mean =     286.183300481380
             stat err =       0.000464895784
             autocorr =       1.241603908723
              std dev =       0.590036760949
             le_variance =       0.348143379271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348277244596
                                         uncertainty =       0.011200957520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348277244596
                                         uncertainty =       0.011200957520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417226855
  error estimate for blocks of size 2^( 2) =       0.000429153435
  error estimate for blocks of size 2^( 3) =       0.000441888519
  error estimate for blocks of size 2^( 4) =       0.000453206399
  error estimate for blocks of size 2^( 5) =       0.000462776616
  error estimate for blocks of size 2^( 6) =       0.000469096094
  error estimate for blocks of size 2^( 7) =       0.000474529950

      target function =                  N/A
              le_mean =     -16.906660168946
             les_mean =     286.183314391103
             stat err =       0.000464902265
             autocorr =       1.241591742569
              std dev =       0.590047876843
             le_variance =       0.348156496967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348271075578
                                         uncertainty =       0.011200500146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348271075578
                                         uncertainty =       0.011200500146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417223160
  error estimate for blocks of size 2^( 2) =       0.000429149911
  error estimate for blocks of size 2^( 3) =       0.000441885060
  error estimate for blocks of size 2^( 4) =       0.000453203017
  error estimate for blocks of size 2^( 5) =       0.000462773407
  error estimate for blocks of size 2^( 6) =       0.000469093224
  error estimate for blocks of size 2^( 7) =       0.000474527271

      target function =                  N/A
              le_mean =     -16.906660157203
             les_mean =     286.183307828102
             stat err =       0.000464899230
             autocorr =       1.241597520223
              std dev =       0.590042651873
             le_variance =       0.348150331030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348265002468
                                         uncertainty =       0.011200058283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348265002468
                                         uncertainty =       0.011200058283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417219523
  error estimate for blocks of size 2^( 2) =       0.000429146444
  error estimate for blocks of size 2^( 3) =       0.000441881655
  error estimate for blocks of size 2^( 4) =       0.000453199680
  error estimate for blocks of size 2^( 5) =       0.000462770236
  error estimate for blocks of size 2^( 6) =       0.000469090373
  error estimate for blocks of size 2^( 7) =       0.000474524598

      target function =                  N/A
              le_mean =     -16.906660146942
             les_mean =     286.183301410955
             stat err =       0.000464896222
             autocorr =       1.241603100373
              std dev =       0.590037507979
             le_variance =       0.348144260822


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906660145522        initial
     6.1035e+00     6.1035e+01             3.2920e-05       -16.906660168946  <--
     2.4414e+01     2.4414e+02             8.2435e-06       -16.906660157203
     9.7656e+01     9.7656e+02             2.0617e-06       -16.906660146942

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 3.0332e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.115905e-01 1 1  ON 0
 uu_1                 1.443388e-01 1 1  ON 1
 uu_2                 4.237017e-02 1 1  ON 2
 uu_3                -2.052775e-02 1 1  ON 3
 uu_4                -6.676935e-02 1 1  ON 4
 uu_5                -1.028487e-01 1 1  ON 5
 uu_6                -1.319213e-01 1 1  ON 6
 uu_7                -1.471268e-01 1 1  ON 7
 uu_8                -1.402581e-01 1 1  ON 8
 uu_9                -1.126941e-01 1 1  ON 9
 ud_0                 4.544282e-01 1 1  ON 10
 ud_1                 1.883085e-01 1 1  ON 11
 ud_2                 6.737129e-02 1 1  ON 12
 ud_3                -4.328468e-03 1 1  ON 13
 ud_4                -6.205891e-02 1 1  ON 14
 ud_5                -1.045745e-01 1 1  ON 15
 ud_6                -1.332111e-01 1 1  ON 16
 ud_7                -1.516254e-01 1 1  ON 17
 ud_8                -1.540960e-01 1 1  ON 18
 ud_9                -1.462059e-01 1 1  ON 19
 eO_0                -7.510293e-01 1 1  ON 20
 eO_1                -4.293602e-01 1 1  ON 21
 eO_2                -1.397446e-02 1 1  ON 22
 eO_3                 3.032112e-01 1 1  ON 23
 eO_4                 5.308184e-01 1 1  ON 24
 eO_5                 4.941076e-01 1 1  ON 25
 eO_6                 2.652246e-01 1 1  ON 26
 eO_7                -4.104184e-02 1 1  ON 27
 eO_8                -2.401410e-01 1 1  ON 28
 eO_9                -1.114441e-01 1 1  ON 29
eH1_0                -2.647054e-01 1 1  ON 30
eH1_1                -1.593504e-01 1 1  ON 31
eH1_2                -1.099615e-01 1 1  ON 32
eH1_3                -5.443222e-02 1 1  ON 33
eH1_4                -4.020519e-03 1 1  ON 34
eH1_5                 3.294446e-02 1 1  ON 35
eH1_6                 9.578554e-02 1 1  ON 36
eH1_7                 1.600135e-01 1 1  ON 37
eH1_8                 1.995352e-01 1 1  ON 38
eH1_9                 1.031481e-01 1 1  ON 39
eH2_0                -2.606826e-01 1 1  ON 40
eH2_1                -1.556527e-01 1 1  ON 41
eH2_2                -1.063937e-01 1 1  ON 42
eH2_3                -5.102214e-02 1 1  ON 43
eH2_4                -8.799124e-04 1 1  ON 44
eH2_5                 3.482152e-02 1 1  ON 45
eH2_6                 9.774222e-02 1 1  ON 46
eH2_7                 1.601043e-01 1 1  ON 47
eH2_8                 2.005555e-01 1 1  ON 48
eH2_9                 9.323067e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7106e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9473
    reference variance = 0.268311
====================================================
  Execution time = 2.1398e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3787e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337833375983
                                         uncertainty =       0.003698090490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337833375983
                                         uncertainty =       0.003698090490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411016676
  error estimate for blocks of size 2^( 2) =       0.000423708455
  error estimate for blocks of size 2^( 3) =       0.000436611114
  error estimate for blocks of size 2^( 4) =       0.000448145256
  error estimate for blocks of size 2^( 5) =       0.000458519002
  error estimate for blocks of size 2^( 6) =       0.000464790177
  error estimate for blocks of size 2^( 7) =       0.000466620712

      target function =                  N/A
              le_mean =     -16.905996105950
             les_mean =     286.150573581293
             stat err =       0.000459518787
             autocorr =       1.249935658474
              std dev =       0.581265357508
             le_variance =       0.337869415839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599610595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905996105950       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905996041447       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905996105585       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905996091513       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905996227690       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905996298181       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905996283705       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905996297635       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.412354e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905996105950       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905996088480       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905996104431       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905996098383       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905996133125       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905996149131       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905996142354       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905996147883       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.674107e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905996105950       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905996101490       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905996105454       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905996103763       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905996112454       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905996116382       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905996114424       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905996115855       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.285192e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261430 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7024e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.115911e-01 1 1  ON 0
 uu_1                 1.443390e-01 1 1  ON 1
 uu_2                 4.236568e-02 1 1  ON 2
 uu_3                -2.052412e-02 1 1  ON 3
 uu_4                -6.677349e-02 1 1  ON 4
 uu_5                -1.028464e-01 1 1  ON 5
 uu_6                -1.319134e-01 1 1  ON 6
 uu_7                -1.471228e-01 1 1  ON 7
 uu_8                -1.402727e-01 1 1  ON 8
 uu_9                -1.127136e-01 1 1  ON 9
 ud_0                 4.544094e-01 1 1  ON 10
 ud_1                 1.883280e-01 1 1  ON 11
 ud_2                 6.737966e-02 1 1  ON 12
 ud_3                -4.324848e-03 1 1  ON 13
 ud_4                -6.205123e-02 1 1  ON 14
 ud_5                -1.045663e-01 1 1  ON 15
 ud_6                -1.332198e-01 1 1  ON 16
 ud_7                -1.516287e-01 1 1  ON 17
 ud_8                -1.540904e-01 1 1  ON 18
 ud_9                -1.462056e-01 1 1  ON 19
 eO_0                -7.510222e-01 1 1  ON 20
 eO_1                -4.293698e-01 1 1  ON 21
 eO_2                -1.395980e-02 1 1  ON 22
 eO_3                 3.032230e-01 1 1  ON 23
 eO_4                 5.308272e-01 1 1  ON 24
 eO_5                 4.941228e-01 1 1  ON 25
 eO_6                 2.652309e-01 1 1  ON 26
 eO_7                -4.105331e-02 1 1  ON 27
 eO_8                -2.401609e-01 1 1  ON 28
 eO_9                -1.114644e-01 1 1  ON 29
eH1_0                -2.647132e-01 1 1  ON 30
eH1_1                -1.593543e-01 1 1  ON 31
eH1_2                -1.099760e-01 1 1  ON 32
eH1_3                -5.443901e-02 1 1  ON 33
eH1_4                -4.043041e-03 1 1  ON 34
eH1_5                 3.293351e-02 1 1  ON 35
eH1_6                 9.580871e-02 1 1  ON 36
eH1_7                 1.600258e-01 1 1  ON 37
eH1_8                 1.995488e-01 1 1  ON 38
eH1_9                 1.031672e-01 1 1  ON 39
eH2_0                -2.606895e-01 1 1  ON 40
eH2_1                -1.556554e-01 1 1  ON 41
eH2_2                -1.063937e-01 1 1  ON 42
eH2_3                -5.102632e-02 1 1  ON 43
eH2_4                -9.166535e-04 1 1  ON 44
eH2_5                 3.482444e-02 1 1  ON 45
eH2_6                 9.773137e-02 1 1  ON 46
eH2_7                 1.601109e-01 1 1  ON 47
eH2_8                 2.005664e-01 1 1  ON 48
eH2_9                 9.326236e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9136
    reference variance = 0.268053
====================================================
  Execution time = 2.0712e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4605e-01
  Total weights = 2.0000e+06
  Execution time = 1.8957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346122859028
                                         uncertainty =       0.006524271568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346122859028
                                         uncertainty =       0.006524271568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415978527
  error estimate for blocks of size 2^( 2) =       0.000429081046
  error estimate for blocks of size 2^( 3) =       0.000443124522
  error estimate for blocks of size 2^( 4) =       0.000456382086
  error estimate for blocks of size 2^( 5) =       0.000467703067
  error estimate for blocks of size 2^( 6) =       0.000477184879
  error estimate for blocks of size 2^( 7) =       0.000482717908

      target function =                  N/A
              le_mean =     -16.906269397835
             les_mean =     286.168021049777
             stat err =       0.000470996985
             autocorr =       1.282018899930
              std dev =       0.588282475213
             le_variance =       0.346076270642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346041725415
                                         uncertainty =       0.006523319031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346041725415
                                         uncertainty =       0.006523319031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415929771
  error estimate for blocks of size 2^( 2) =       0.000429034707
  error estimate for blocks of size 2^( 3) =       0.000443079783
  error estimate for blocks of size 2^( 4) =       0.000456338148
  error estimate for blocks of size 2^( 5) =       0.000467660433
  error estimate for blocks of size 2^( 6) =       0.000477143643
  error estimate for blocks of size 2^( 7) =       0.000482675556

      target function =                  N/A
              le_mean =     -16.906269018435
             les_mean =     286.167927099459
             stat err =       0.000470954445
             autocorr =       1.282087857235
              std dev =       0.588213523115
             le_variance =       0.345995148776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346072014127
                                         uncertainty =       0.006523680805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346072014127
                                         uncertainty =       0.006523680805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415947974
  error estimate for blocks of size 2^( 2) =       0.000429051997
  error estimate for blocks of size 2^( 3) =       0.000443096469
  error estimate for blocks of size 2^( 4) =       0.000456354555
  error estimate for blocks of size 2^( 5) =       0.000467676353
  error estimate for blocks of size 2^( 6) =       0.000477158981
  error estimate for blocks of size 2^( 7) =       0.000482691412

      target function =                  N/A
              le_mean =     -16.906269182386
             les_mean =     286.167962929219
             stat err =       0.000470970325
             autocorr =       1.282062096149
              std dev =       0.588239266752
             le_variance =       0.346025434949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346116097030
                                         uncertainty =       0.006524193533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346116097030
                                         uncertainty =       0.006524193533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415974464
  error estimate for blocks of size 2^( 2) =       0.000429077182
  error estimate for blocks of size 2^( 3) =       0.000443120791
  error estimate for blocks of size 2^( 4) =       0.000456378424
  error estimate for blocks of size 2^( 5) =       0.000467699514
  error estimate for blocks of size 2^( 6) =       0.000477181433
  error estimate for blocks of size 2^( 7) =       0.000482714384

      target function =                  N/A
              le_mean =     -16.906269369171
             les_mean =     286.168013319894
             stat err =       0.000470993439
             autocorr =       1.282024639297
              std dev =       0.588276729057
             le_variance =       0.346069509950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906269397835        initial  <--
     1.5259e+00     1.5259e+01             1.4124e-04       -16.906269018435
     6.1035e+00     6.1035e+01             3.6741e-05       -16.906269182386
     2.4414e+01     2.4414e+02             9.2852e-06       -16.906269369171

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2801
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.115905e-01 1 1  ON 0
 uu_1                 1.443388e-01 1 1  ON 1
 uu_2                 4.237017e-02 1 1  ON 2
 uu_3                -2.052775e-02 1 1  ON 3
 uu_4                -6.676935e-02 1 1  ON 4
 uu_5                -1.028487e-01 1 1  ON 5
 uu_6                -1.319213e-01 1 1  ON 6
 uu_7                -1.471268e-01 1 1  ON 7
 uu_8                -1.402581e-01 1 1  ON 8
 uu_9                -1.126941e-01 1 1  ON 9
 ud_0                 4.544282e-01 1 1  ON 10
 ud_1                 1.883085e-01 1 1  ON 11
 ud_2                 6.737129e-02 1 1  ON 12
 ud_3                -4.328468e-03 1 1  ON 13
 ud_4                -6.205891e-02 1 1  ON 14
 ud_5                -1.045745e-01 1 1  ON 15
 ud_6                -1.332111e-01 1 1  ON 16
 ud_7                -1.516254e-01 1 1  ON 17
 ud_8                -1.540960e-01 1 1  ON 18
 ud_9                -1.462059e-01 1 1  ON 19
 eO_0                -7.510293e-01 1 1  ON 20
 eO_1                -4.293602e-01 1 1  ON 21
 eO_2                -1.397446e-02 1 1  ON 22
 eO_3                 3.032112e-01 1 1  ON 23
 eO_4                 5.308184e-01 1 1  ON 24
 eO_5                 4.941076e-01 1 1  ON 25
 eO_6                 2.652246e-01 1 1  ON 26
 eO_7                -4.104184e-02 1 1  ON 27
 eO_8                -2.401410e-01 1 1  ON 28
 eO_9                -1.114441e-01 1 1  ON 29
eH1_0                -2.647054e-01 1 1  ON 30
eH1_1                -1.593504e-01 1 1  ON 31
eH1_2                -1.099615e-01 1 1  ON 32
eH1_3                -5.443222e-02 1 1  ON 33
eH1_4                -4.020519e-03 1 1  ON 34
eH1_5                 3.294446e-02 1 1  ON 35
eH1_6                 9.578554e-02 1 1  ON 36
eH1_7                 1.600135e-01 1 1  ON 37
eH1_8                 1.995352e-01 1 1  ON 38
eH1_9                 1.031481e-01 1 1  ON 39
eH2_0                -2.606826e-01 1 1  ON 40
eH2_1                -1.556527e-01 1 1  ON 41
eH2_2                -1.063937e-01 1 1  ON 42
eH2_3                -5.102214e-02 1 1  ON 43
eH2_4                -8.799124e-04 1 1  ON 44
eH2_5                 3.482152e-02 1 1  ON 45
eH2_6                 9.774222e-02 1 1  ON 46
eH2_7                 1.601043e-01 1 1  ON 47
eH2_8                 2.005555e-01 1 1  ON 48
eH2_9                 9.323067e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7315e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9279
    reference variance = 0.197598
====================================================
  Execution time = 2.3035e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5196e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6667e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351797336799
                                         uncertainty =       0.005894411274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351797336799
                                         uncertainty =       0.005894411274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419499479
  error estimate for blocks of size 2^( 2) =       0.000432289859
  error estimate for blocks of size 2^( 3) =       0.000445698986
  error estimate for blocks of size 2^( 4) =       0.000459381474
  error estimate for blocks of size 2^( 5) =       0.000470173545
  error estimate for blocks of size 2^( 6) =       0.000480120700
  error estimate for blocks of size 2^( 7) =       0.000485066044

      target function =                  N/A
              le_mean =     -16.906371307837
             les_mean =     286.177350248330
             stat err =       0.000473685441
             autocorr =       1.275020658874
              std dev =       0.593261852691
             le_variance =       0.351959625858


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637130784e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371307837       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906371305215       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906371289852       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371266647       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906371247330       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906371253162       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906371265513       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906371267273       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.448982e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371307837       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906371307172       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906371303277       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371297351       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906371292311       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906371293513       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906371296564       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906371297003       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.627207e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371307837       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906371307670       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906371306693       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371305203       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906371303930       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906371304214       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906371304974       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906371305083       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 9.071010e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8708e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.115929e-01 1 1  ON 0
 uu_1                 1.443404e-01 1 1  ON 1
 uu_2                 4.236795e-02 1 1  ON 2
 uu_3                -2.052693e-02 1 1  ON 3
 uu_4                -6.677114e-02 1 1  ON 4
 uu_5                -1.028496e-01 1 1  ON 5
 uu_6                -1.319231e-01 1 1  ON 6
 uu_7                -1.471283e-01 1 1  ON 7
 uu_8                -1.402581e-01 1 1  ON 8
 uu_9                -1.126935e-01 1 1  ON 9
 ud_0                 4.544302e-01 1 1  ON 10
 ud_1                 1.883069e-01 1 1  ON 11
 ud_2                 6.737021e-02 1 1  ON 12
 ud_3                -4.328850e-03 1 1  ON 13
 ud_4                -6.205896e-02 1 1  ON 14
 ud_5                -1.045744e-01 1 1  ON 15
 ud_6                -1.332113e-01 1 1  ON 16
 ud_7                -1.516265e-01 1 1  ON 17
 ud_8                -1.540937e-01 1 1  ON 18
 ud_9                -1.462056e-01 1 1  ON 19
 eO_0                -7.510295e-01 1 1  ON 20
 eO_1                -4.293582e-01 1 1  ON 21
 eO_2                -1.397435e-02 1 1  ON 22
 eO_3                 3.032129e-01 1 1  ON 23
 eO_4                 5.308166e-01 1 1  ON 24
 eO_5                 4.941086e-01 1 1  ON 25
 eO_6                 2.652247e-01 1 1  ON 26
 eO_7                -4.104230e-02 1 1  ON 27
 eO_8                -2.401415e-01 1 1  ON 28
 eO_9                -1.114458e-01 1 1  ON 29
eH1_0                -2.647058e-01 1 1  ON 30
eH1_1                -1.593512e-01 1 1  ON 31
eH1_2                -1.099627e-01 1 1  ON 32
eH1_3                -5.443239e-02 1 1  ON 33
eH1_4                -4.021086e-03 1 1  ON 34
eH1_5                 3.294428e-02 1 1  ON 35
eH1_6                 9.578571e-02 1 1  ON 36
eH1_7                 1.600134e-01 1 1  ON 37
eH1_8                 1.995357e-01 1 1  ON 38
eH1_9                 1.031505e-01 1 1  ON 39
eH2_0                -2.606839e-01 1 1  ON 40
eH2_1                -1.556543e-01 1 1  ON 41
eH2_2                -1.063935e-01 1 1  ON 42
eH2_3                -5.102360e-02 1 1  ON 43
eH2_4                -8.808251e-04 1 1  ON 44
eH2_5                 3.481898e-02 1 1  ON 45
eH2_6                 9.774075e-02 1 1  ON 46
eH2_7                 1.601061e-01 1 1  ON 47
eH2_8                 2.005582e-01 1 1  ON 48
eH2_9                 9.323430e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.0014
    reference variance = 1.41658
====================================================
  Execution time = 2.0706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4125e-01
  Total weights = 2.0000e+06
  Execution time = 1.8850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341208984440
                                         uncertainty =       0.004852402792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341208984440
                                         uncertainty =       0.004852402792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413068040
  error estimate for blocks of size 2^( 2) =       0.000425843787
  error estimate for blocks of size 2^( 3) =       0.000439067027
  error estimate for blocks of size 2^( 4) =       0.000450567757
  error estimate for blocks of size 2^( 5) =       0.000460806308
  error estimate for blocks of size 2^( 6) =       0.000467873800
  error estimate for blocks of size 2^( 7) =       0.000473717783

      target function =                  N/A
              le_mean =     -16.906017679349
             les_mean =     286.154684014601
             stat err =       0.000463241412
             autocorr =       1.257684088894
              std dev =       0.584166423848
             le_variance =       0.341250410751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341225370642
                                         uncertainty =       0.004852620809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341225370642
                                         uncertainty =       0.004852620809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413077960
  error estimate for blocks of size 2^( 2) =       0.000425853222
  error estimate for blocks of size 2^( 3) =       0.000439076090
  error estimate for blocks of size 2^( 4) =       0.000450576577
  error estimate for blocks of size 2^( 5) =       0.000460814961
  error estimate for blocks of size 2^( 6) =       0.000467882445
  error estimate for blocks of size 2^( 7) =       0.000473726554

      target function =                  N/A
              le_mean =     -16.906017749822
             les_mean =     286.154702788853
             stat err =       0.000463250134
             autocorr =       1.257671039805
              std dev =       0.584180453436
             le_variance =       0.341266802177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341217358682
                                         uncertainty =       0.004852513429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341217358682
                                         uncertainty =       0.004852513429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413073110
  error estimate for blocks of size 2^( 2) =       0.000425848608
  error estimate for blocks of size 2^( 3) =       0.000439071658
  error estimate for blocks of size 2^( 4) =       0.000450572264
  error estimate for blocks of size 2^( 5) =       0.000460810730
  error estimate for blocks of size 2^( 6) =       0.000467878218
  error estimate for blocks of size 2^( 7) =       0.000473722266

      target function =                  N/A
              le_mean =     -16.906017715879
             les_mean =     286.154693626697
             stat err =       0.000463245869
             autocorr =       1.257677417341
              std dev =       0.584173593819
             le_variance =       0.341258787715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341210036884
                                         uncertainty =       0.004852416673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341210036884
                                         uncertainty =       0.004852416673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413068677
  error estimate for blocks of size 2^( 2) =       0.000425844393
  error estimate for blocks of size 2^( 3) =       0.000439067609
  error estimate for blocks of size 2^( 4) =       0.000450568324
  error estimate for blocks of size 2^( 5) =       0.000460806863
  error estimate for blocks of size 2^( 6) =       0.000467874355
  error estimate for blocks of size 2^( 7) =       0.000473718347

      target function =                  N/A
              le_mean =     -16.906017683941
             les_mean =     286.154685222645
             stat err =       0.000463241972
             autocorr =       1.257683250254
              std dev =       0.584167324950
             le_variance =       0.341251463539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906017679349        initial
     1.5259e+01     1.5259e+02             1.4490e-05       -16.906017749822  <--
     6.1035e+01     6.1035e+02             3.6272e-06       -16.906017715879
     2.4414e+02     2.4414e+03             9.0710e-07       -16.906017683941

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 3.0245e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.116001e-01 1 1  ON 0
 uu_1                 1.443449e-01 1 1  ON 1
 uu_2                 4.236157e-02 1 1  ON 2
 uu_3                -2.052466e-02 1 1  ON 3
 uu_4                -6.677634e-02 1 1  ON 4
 uu_5                -1.028521e-01 1 1  ON 5
 uu_6                -1.319285e-01 1 1  ON 6
 uu_7                -1.471329e-01 1 1  ON 7
 uu_8                -1.402582e-01 1 1  ON 8
 uu_9                -1.126918e-01 1 1  ON 9
 ud_0                 4.544358e-01 1 1  ON 10
 ud_1                 1.883022e-01 1 1  ON 11
 ud_2                 6.736702e-02 1 1  ON 12
 ud_3                -4.330007e-03 1 1  ON 13
 ud_4                -6.205908e-02 1 1  ON 14
 ud_5                -1.045743e-01 1 1  ON 15
 ud_6                -1.332121e-01 1 1  ON 16
 ud_7                -1.516299e-01 1 1  ON 17
 ud_8                -1.540867e-01 1 1  ON 18
 ud_9                -1.462047e-01 1 1  ON 19
 eO_0                -7.510300e-01 1 1  ON 20
 eO_1                -4.293522e-01 1 1  ON 21
 eO_2                -1.397401e-02 1 1  ON 22
 eO_3                 3.032179e-01 1 1  ON 23
 eO_4                 5.308113e-01 1 1  ON 24
 eO_5                 4.941115e-01 1 1  ON 25
 eO_6                 2.652248e-01 1 1  ON 26
 eO_7                -4.104368e-02 1 1  ON 27
 eO_8                -2.401428e-01 1 1  ON 28
 eO_9                -1.114508e-01 1 1  ON 29
eH1_0                -2.647071e-01 1 1  ON 30
eH1_1                -1.593536e-01 1 1  ON 31
eH1_2                -1.099664e-01 1 1  ON 32
eH1_3                -5.443293e-02 1 1  ON 33
eH1_4                -4.022767e-03 1 1  ON 34
eH1_5                 3.294373e-02 1 1  ON 35
eH1_6                 9.578622e-02 1 1  ON 36
eH1_7                 1.600130e-01 1 1  ON 37
eH1_8                 1.995372e-01 1 1  ON 38
eH1_9                 1.031578e-01 1 1  ON 39
eH2_0                -2.606875e-01 1 1  ON 40
eH2_1                -1.556591e-01 1 1  ON 41
eH2_2                -1.063927e-01 1 1  ON 42
eH2_3                -5.102792e-02 1 1  ON 43
eH2_4                -8.835541e-04 1 1  ON 44
eH2_5                 3.481138e-02 1 1  ON 45
eH2_6                 9.773638e-02 1 1  ON 46
eH2_7                 1.601113e-01 1 1  ON 47
eH2_8                 2.005666e-01 1 1  ON 48
eH2_9                 9.324516e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8961e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9018
    reference variance = 0.24789
====================================================
  Execution time = 2.1149e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3257e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332546004953
                                         uncertainty =       0.002666324067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332546004953
                                         uncertainty =       0.002666324067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407778611
  error estimate for blocks of size 2^( 2) =       0.000420827977
  error estimate for blocks of size 2^( 3) =       0.000433933553
  error estimate for blocks of size 2^( 4) =       0.000446059096
  error estimate for blocks of size 2^( 5) =       0.000457007941
  error estimate for blocks of size 2^( 6) =       0.000466097411
  error estimate for blocks of size 2^( 7) =       0.000470323973

      target function =                  N/A
              le_mean =     -16.905753750459
             les_mean =     286.137076495416
             stat err =       0.000459872105
             autocorr =       1.271818830041
              std dev =       0.576686041570
             le_variance =       0.332566790541


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575375046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905753750459       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905753806146       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905753739612       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905753831856       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905753873086       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905753899653       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905753877624       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905753878604       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.152906e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905753750459       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905753765047       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905753747746       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905753771628       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905753782596       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905753789550       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905753784663       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.309795e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905753750459       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905753754150       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905753749781       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905753755807       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905753758595       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905753760355       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905753759185       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.301787e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6738e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.115959e-01 1 1  ON 0
 uu_1                 1.443496e-01 1 1  ON 1
 uu_2                 4.236022e-02 1 1  ON 2
 uu_3                -2.052684e-02 1 1  ON 3
 uu_4                -6.677748e-02 1 1  ON 4
 uu_5                -1.028652e-01 1 1  ON 5
 uu_6                -1.319335e-01 1 1  ON 6
 uu_7                -1.471308e-01 1 1  ON 7
 uu_8                -1.402510e-01 1 1  ON 8
 uu_9                -1.126881e-01 1 1  ON 9
 ud_0                 4.544360e-01 1 1  ON 10
 ud_1                 1.883014e-01 1 1  ON 11
 ud_2                 6.736264e-02 1 1  ON 12
 ud_3                -4.333319e-03 1 1  ON 13
 ud_4                -6.205121e-02 1 1  ON 14
 ud_5                -1.045744e-01 1 1  ON 15
 ud_6                -1.332114e-01 1 1  ON 16
 ud_7                -1.516320e-01 1 1  ON 17
 ud_8                -1.540782e-01 1 1  ON 18
 ud_9                -1.462027e-01 1 1  ON 19
 eO_0                -7.510334e-01 1 1  ON 20
 eO_1                -4.293502e-01 1 1  ON 21
 eO_2                -1.396599e-02 1 1  ON 22
 eO_3                 3.032198e-01 1 1  ON 23
 eO_4                 5.308094e-01 1 1  ON 24
 eO_5                 4.941140e-01 1 1  ON 25
 eO_6                 2.652258e-01 1 1  ON 26
 eO_7                -4.104521e-02 1 1  ON 27
 eO_8                -2.401429e-01 1 1  ON 28
 eO_9                -1.114579e-01 1 1  ON 29
eH1_0                -2.647115e-01 1 1  ON 30
eH1_1                -1.593602e-01 1 1  ON 31
eH1_2                -1.099660e-01 1 1  ON 32
eH1_3                -5.442856e-02 1 1  ON 33
eH1_4                -4.022405e-03 1 1  ON 34
eH1_5                 3.293551e-02 1 1  ON 35
eH1_6                 9.578821e-02 1 1  ON 36
eH1_7                 1.600137e-01 1 1  ON 37
eH1_8                 1.995413e-01 1 1  ON 38
eH1_9                 1.031653e-01 1 1  ON 39
eH2_0                -2.607004e-01 1 1  ON 40
eH2_1                -1.556596e-01 1 1  ON 41
eH2_2                -1.063949e-01 1 1  ON 42
eH2_3                -5.103224e-02 1 1  ON 43
eH2_4                -8.857902e-04 1 1  ON 44
eH2_5                 3.480556e-02 1 1  ON 45
eH2_6                 9.773766e-02 1 1  ON 46
eH2_7                 1.601177e-01 1 1  ON 47
eH2_8                 2.005723e-01 1 1  ON 48
eH2_9                 9.325717e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8636
    reference variance = 0.275734
====================================================
  Execution time = 2.0999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3368e-01
  Total weights = 2.0000e+06
  Execution time = 1.8901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333722688272
                                         uncertainty =       0.002709327378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333722688272
                                         uncertainty =       0.002709327378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408461342
  error estimate for blocks of size 2^( 2) =       0.000421527513
  error estimate for blocks of size 2^( 3) =       0.000434860431
  error estimate for blocks of size 2^( 4) =       0.000447426487
  error estimate for blocks of size 2^( 5) =       0.000459827914
  error estimate for blocks of size 2^( 6) =       0.000470171989
  error estimate for blocks of size 2^( 7) =       0.000477166160

      target function =                  N/A
              le_mean =     -16.905551899326
             les_mean =     286.131366190222
             stat err =       0.000463648137
             autocorr =       1.288472394926
              std dev =       0.577651569937
             le_variance =       0.333681336251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333732343601
                                         uncertainty =       0.002709383409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333732343601
                                         uncertainty =       0.002709383409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408467260
  error estimate for blocks of size 2^( 2) =       0.000421533114
  error estimate for blocks of size 2^( 3) =       0.000434865914
  error estimate for blocks of size 2^( 4) =       0.000447431975
  error estimate for blocks of size 2^( 5) =       0.000459833274
  error estimate for blocks of size 2^( 6) =       0.000470177430
  error estimate for blocks of size 2^( 7) =       0.000477171109

      target function =                  N/A
              le_mean =     -16.905552072390
             les_mean =     286.131381710812
             stat err =       0.000463653447
             autocorr =       1.288464570559
              std dev =       0.577659939198
             le_variance =       0.333691005354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333728092464
                                         uncertainty =       0.002709364113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333728092464
                                         uncertainty =       0.002709364113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408464654
  error estimate for blocks of size 2^( 2) =       0.000421530636
  error estimate for blocks of size 2^( 3) =       0.000434863467
  error estimate for blocks of size 2^( 4) =       0.000447429512
  error estimate for blocks of size 2^( 5) =       0.000459830889
  error estimate for blocks of size 2^( 6) =       0.000470175018
  error estimate for blocks of size 2^( 7) =       0.000477168913

      target function =                  N/A
              le_mean =     -16.905551979385
             les_mean =     286.131374308334
             stat err =       0.000463651083
             autocorr =       1.288467871176
              std dev =       0.577656253737
             le_variance =       0.333686747482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333723371908
                                         uncertainty =       0.002709332059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333723371908
                                         uncertainty =       0.002709332059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408461761
  error estimate for blocks of size 2^( 2) =       0.000421527908
  error estimate for blocks of size 2^( 3) =       0.000434860815
  error estimate for blocks of size 2^( 4) =       0.000447426869
  error estimate for blocks of size 2^( 5) =       0.000459828290
  error estimate for blocks of size 2^( 6) =       0.000470172372
  error estimate for blocks of size 2^( 7) =       0.000477166507

      target function =                  N/A
              le_mean =     -16.905551909285
             les_mean =     286.131367211467
             stat err =       0.000463648509
             autocorr =       1.288471819107
              std dev =       0.577652162456
             le_variance =       0.333682020790


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905551899326        initial
     3.8147e+00     3.8147e+01             5.1529e-05       -16.905552072390  <--
     1.5259e+01     1.5259e+02             1.3098e-05       -16.905551979385
     6.1035e+01     6.1035e+02             3.3018e-06       -16.905551909285

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 3.0556e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.115845e-01 1 1  ON 0
 uu_1                 1.443623e-01 1 1  ON 1
 uu_2                 4.235433e-02 1 1  ON 2
 uu_3                -2.053381e-02 1 1  ON 3
 uu_4                -6.678205e-02 1 1  ON 4
 uu_5                -1.029010e-01 1 1  ON 5
 uu_6                -1.319483e-01 1 1  ON 6
 uu_7                -1.471258e-01 1 1  ON 7
 uu_8                -1.402301e-01 1 1  ON 8
 uu_9                -1.126769e-01 1 1  ON 9
 ud_0                 4.544364e-01 1 1  ON 10
 ud_1                 1.882989e-01 1 1  ON 11
 ud_2                 6.735255e-02 1 1  ON 12
 ud_3                -4.341079e-03 1 1  ON 13
 ud_4                -6.203020e-02 1 1  ON 14
 ud_5                -1.045746e-01 1 1  ON 15
 ud_6                -1.332092e-01 1 1  ON 16
 ud_7                -1.516388e-01 1 1  ON 17
 ud_8                -1.540527e-01 1 1  ON 18
 ud_9                -1.461970e-01 1 1  ON 19
 eO_0                -7.510417e-01 1 1  ON 20
 eO_1                -4.293440e-01 1 1  ON 21
 eO_2                -1.394421e-02 1 1  ON 22
 eO_3                 3.032267e-01 1 1  ON 23
 eO_4                 5.308051e-01 1 1  ON 24
 eO_5                 4.941216e-01 1 1  ON 25
 eO_6                 2.652289e-01 1 1  ON 26
 eO_7                -4.105044e-02 1 1  ON 27
 eO_8                -2.401436e-01 1 1  ON 28
 eO_9                -1.114806e-01 1 1  ON 29
eH1_0                -2.647253e-01 1 1  ON 30
eH1_1                -1.593804e-01 1 1  ON 31
eH1_2                -1.099651e-01 1 1  ON 32
eH1_3                -5.441524e-02 1 1  ON 33
eH1_4                -4.021443e-03 1 1  ON 34
eH1_5                 3.291077e-02 1 1  ON 35
eH1_6                 9.579418e-02 1 1  ON 36
eH1_7                 1.600157e-01 1 1  ON 37
eH1_8                 1.995541e-01 1 1  ON 38
eH1_9                 1.031890e-01 1 1  ON 39
eH2_0                -2.607391e-01 1 1  ON 40
eH2_1                -1.556613e-01 1 1  ON 41
eH2_2                -1.064027e-01 1 1  ON 42
eH2_3                -5.104686e-02 1 1  ON 43
eH2_4                -8.935531e-04 1 1  ON 44
eH2_5                 3.478875e-02 1 1  ON 45
eH2_6                 9.774151e-02 1 1  ON 46
eH2_7                 1.601373e-01 1 1  ON 47
eH2_8                 2.005901e-01 1 1  ON 48
eH2_9                 9.329506e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7301e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9014
    reference variance = 0.204921
====================================================
  Execution time = 2.1239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4010e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340094850736
                                         uncertainty =       0.003677283649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340094850736
                                         uncertainty =       0.003677283649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412373481
  error estimate for blocks of size 2^( 2) =       0.000425354804
  error estimate for blocks of size 2^( 3) =       0.000439082744
  error estimate for blocks of size 2^( 4) =       0.000451912104
  error estimate for blocks of size 2^( 5) =       0.000463331979
  error estimate for blocks of size 2^( 6) =       0.000472053434
  error estimate for blocks of size 2^( 7) =       0.000479471141

      target function =                  N/A
              le_mean =     -16.906200486266
             les_mean =     286.159718486904
             stat err =       0.000466692164
             autocorr =       1.280794817935
              std dev =       0.583184169151
             le_variance =       0.340103775148


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620048627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200486266       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200629694       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200804495       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906200646445       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200747222       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200907615       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200987810       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906201012791       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.208665e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200486266       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200525275       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200569992       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906200522390       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200549327       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200593503       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200614797       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906200618587       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.552038e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906200486266       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906200496237       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906200507296       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906200494853       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906200501767       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906200512968       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906200518688       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.347303e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6927e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.115806e-01 1 1  ON 0
 uu_1                 1.443487e-01 1 1  ON 1
 uu_2                 4.236306e-02 1 1  ON 2
 uu_3                -2.055996e-02 1 1  ON 3
 uu_4                -6.677039e-02 1 1  ON 4
 uu_5                -1.028994e-01 1 1  ON 5
 uu_6                -1.319393e-01 1 1  ON 6
 uu_7                -1.471383e-01 1 1  ON 7
 uu_8                -1.402382e-01 1 1  ON 8
 uu_9                -1.126803e-01 1 1  ON 9
 ud_0                 4.544571e-01 1 1  ON 10
 ud_1                 1.882822e-01 1 1  ON 11
 ud_2                 6.736730e-02 1 1  ON 12
 ud_3                -4.368080e-03 1 1  ON 13
 ud_4                -6.201716e-02 1 1  ON 14
 ud_5                -1.045970e-01 1 1  ON 15
 ud_6                -1.332063e-01 1 1  ON 16
 ud_7                -1.516268e-01 1 1  ON 17
 ud_8                -1.540415e-01 1 1  ON 18
 ud_9                -1.461912e-01 1 1  ON 19
 eO_0                -7.510382e-01 1 1  ON 20
 eO_1                -4.293547e-01 1 1  ON 21
 eO_2                -1.393280e-02 1 1  ON 22
 eO_3                 3.032498e-01 1 1  ON 23
 eO_4                 5.308085e-01 1 1  ON 24
 eO_5                 4.941429e-01 1 1  ON 25
 eO_6                 2.652455e-01 1 1  ON 26
 eO_7                -4.106729e-02 1 1  ON 27
 eO_8                -2.401613e-01 1 1  ON 28
 eO_9                -1.115093e-01 1 1  ON 29
eH1_0                -2.647389e-01 1 1  ON 30
eH1_1                -1.594065e-01 1 1  ON 31
eH1_2                -1.099654e-01 1 1  ON 32
eH1_3                -5.442999e-02 1 1  ON 33
eH1_4                -4.055994e-03 1 1  ON 34
eH1_5                 3.292418e-02 1 1  ON 35
eH1_6                 9.578717e-02 1 1  ON 36
eH1_7                 1.600195e-01 1 1  ON 37
eH1_8                 1.995828e-01 1 1  ON 38
eH1_9                 1.032315e-01 1 1  ON 39
eH2_0                -2.607647e-01 1 1  ON 40
eH2_1                -1.556910e-01 1 1  ON 41
eH2_2                -1.064211e-01 1 1  ON 42
eH2_3                -5.103904e-02 1 1  ON 43
eH2_4                -9.239438e-04 1 1  ON 44
eH2_5                 3.479213e-02 1 1  ON 45
eH2_6                 9.773795e-02 1 1  ON 46
eH2_7                 1.601409e-01 1 1  ON 47
eH2_8                 2.006116e-01 1 1  ON 48
eH2_9                 9.335058e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8317
    reference variance = 0.302074
====================================================
  Execution time = 2.0889e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3622e-01
  Total weights = 2.0000e+06
  Execution time = 1.8832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336270487014
                                         uncertainty =       0.003707580969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336270487014
                                         uncertainty =       0.003707580969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410006296
  error estimate for blocks of size 2^( 2) =       0.000422944912
  error estimate for blocks of size 2^( 3) =       0.000436835209
  error estimate for blocks of size 2^( 4) =       0.000449489053
  error estimate for blocks of size 2^( 5) =       0.000460820207
  error estimate for blocks of size 2^( 6) =       0.000470308665
  error estimate for blocks of size 2^( 7) =       0.000473367160

      target function =                  N/A
              le_mean =     -16.906191256568
             les_mean =     286.155512961017
             stat err =       0.000463496271
             autocorr =       1.277942866049
              std dev =       0.579836464428
             le_variance =       0.336210325480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336295469258
                                         uncertainty =       0.003707679817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336295469258
                                         uncertainty =       0.003707679817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410021520
  error estimate for blocks of size 2^( 2) =       0.000422960443
  error estimate for blocks of size 2^( 3) =       0.000436850606
  error estimate for blocks of size 2^( 4) =       0.000449504580
  error estimate for blocks of size 2^( 5) =       0.000460835323
  error estimate for blocks of size 2^( 6) =       0.000470323514
  error estimate for blocks of size 2^( 7) =       0.000473379623

      target function =                  N/A
              le_mean =     -16.906191021874
             les_mean =     286.155529993996
             stat err =       0.000463510760
             autocorr =       1.277927858292
              std dev =       0.579857994713
             le_variance =       0.336235294032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336284538783
                                         uncertainty =       0.003707621454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336284538783
                                         uncertainty =       0.003707621454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410014859
  error estimate for blocks of size 2^( 2) =       0.000422953802
  error estimate for blocks of size 2^( 3) =       0.000436844093
  error estimate for blocks of size 2^( 4) =       0.000449498236
  error estimate for blocks of size 2^( 5) =       0.000460829356
  error estimate for blocks of size 2^( 6) =       0.000470317728
  error estimate for blocks of size 2^( 7) =       0.000473374665

      target function =                  N/A
              le_mean =     -16.906191052779
             les_mean =     286.155520114117
             stat err =       0.000463504996
             autocorr =       1.277937598675
              std dev =       0.579848574338
             le_variance =       0.336224369162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336272378290
                                         uncertainty =       0.003707586270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336272378290
                                         uncertainty =       0.003707586270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410007448
  error estimate for blocks of size 2^( 2) =       0.000422946114
  error estimate for blocks of size 2^( 3) =       0.000436836414
  error estimate for blocks of size 2^( 4) =       0.000449490308
  error estimate for blocks of size 2^( 5) =       0.000460821482
  error estimate for blocks of size 2^( 6) =       0.000470309937
  error estimate for blocks of size 2^( 7) =       0.000473368222

      target function =                  N/A
              le_mean =     -16.906191223311
             les_mean =     286.155513726361
             stat err =       0.000463497487
             autocorr =       1.277942387189
              std dev =       0.579838094057
             le_variance =       0.336212215320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906191256568        initial  <--
     9.5367e-01     9.5367e+00             2.2087e-04       -16.906191021874
     3.8147e+00     3.8147e+01             5.5520e-05       -16.906191052779
     1.5259e+01     1.5259e+02             1.3473e-05       -16.906191223311

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4127
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.115845e-01 1 1  ON 0
 uu_1                 1.443623e-01 1 1  ON 1
 uu_2                 4.235433e-02 1 1  ON 2
 uu_3                -2.053381e-02 1 1  ON 3
 uu_4                -6.678205e-02 1 1  ON 4
 uu_5                -1.029010e-01 1 1  ON 5
 uu_6                -1.319483e-01 1 1  ON 6
 uu_7                -1.471258e-01 1 1  ON 7
 uu_8                -1.402301e-01 1 1  ON 8
 uu_9                -1.126769e-01 1 1  ON 9
 ud_0                 4.544364e-01 1 1  ON 10
 ud_1                 1.882989e-01 1 1  ON 11
 ud_2                 6.735255e-02 1 1  ON 12
 ud_3                -4.341079e-03 1 1  ON 13
 ud_4                -6.203020e-02 1 1  ON 14
 ud_5                -1.045746e-01 1 1  ON 15
 ud_6                -1.332092e-01 1 1  ON 16
 ud_7                -1.516388e-01 1 1  ON 17
 ud_8                -1.540527e-01 1 1  ON 18
 ud_9                -1.461970e-01 1 1  ON 19
 eO_0                -7.510417e-01 1 1  ON 20
 eO_1                -4.293440e-01 1 1  ON 21
 eO_2                -1.394421e-02 1 1  ON 22
 eO_3                 3.032267e-01 1 1  ON 23
 eO_4                 5.308051e-01 1 1  ON 24
 eO_5                 4.941216e-01 1 1  ON 25
 eO_6                 2.652289e-01 1 1  ON 26
 eO_7                -4.105044e-02 1 1  ON 27
 eO_8                -2.401436e-01 1 1  ON 28
 eO_9                -1.114806e-01 1 1  ON 29
eH1_0                -2.647253e-01 1 1  ON 30
eH1_1                -1.593804e-01 1 1  ON 31
eH1_2                -1.099651e-01 1 1  ON 32
eH1_3                -5.441524e-02 1 1  ON 33
eH1_4                -4.021443e-03 1 1  ON 34
eH1_5                 3.291077e-02 1 1  ON 35
eH1_6                 9.579418e-02 1 1  ON 36
eH1_7                 1.600157e-01 1 1  ON 37
eH1_8                 1.995541e-01 1 1  ON 38
eH1_9                 1.031890e-01 1 1  ON 39
eH2_0                -2.607391e-01 1 1  ON 40
eH2_1                -1.556613e-01 1 1  ON 41
eH2_2                -1.064027e-01 1 1  ON 42
eH2_3                -5.104686e-02 1 1  ON 43
eH2_4                -8.935531e-04 1 1  ON 44
eH2_5                 3.478875e-02 1 1  ON 45
eH2_6                 9.774151e-02 1 1  ON 46
eH2_7                 1.601373e-01 1 1  ON 47
eH2_8                 2.005901e-01 1 1  ON 48
eH2_9                 9.329506e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7347e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.317682
====================================================
  Execution time = 2.1130e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3325e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333232619338
                                         uncertainty =       0.005144107140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333232619338
                                         uncertainty =       0.005144107140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408197004
  error estimate for blocks of size 2^( 2) =       0.000420977809
  error estimate for blocks of size 2^( 3) =       0.000434523357
  error estimate for blocks of size 2^( 4) =       0.000445892020
  error estimate for blocks of size 2^( 5) =       0.000457053941
  error estimate for blocks of size 2^( 6) =       0.000463877610
  error estimate for blocks of size 2^( 7) =       0.000467442229

      target function =                  N/A
              le_mean =     -16.906881897454
             les_mean =     286.175904916179
             stat err =       0.000458566450
             autocorr =       1.262016196081
              std dev =       0.577277739347
             le_variance =       0.333249588345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690688189745e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906881897454       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906881901123       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906881958602       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906881937122       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906881959145       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906881985969       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906881977268       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906881972765       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.869360e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906881897454       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906881898382       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906881912888       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906881907391       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906881913393       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906881920005       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906881917408       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906881916581       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.687200e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906881897454       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906881897687       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906881901322       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906881899940       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906881901471       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906881903116       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906881902438       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906881902256       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.172697e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6916e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.115866e-01 1 1  ON 0
 uu_1                 1.443628e-01 1 1  ON 1
 uu_2                 4.235635e-02 1 1  ON 2
 uu_3                -2.053305e-02 1 1  ON 3
 uu_4                -6.678370e-02 1 1  ON 4
 uu_5                -1.028981e-01 1 1  ON 5
 uu_6                -1.319484e-01 1 1  ON 6
 uu_7                -1.471257e-01 1 1  ON 7
 uu_8                -1.402327e-01 1 1  ON 8
 uu_9                -1.126812e-01 1 1  ON 9
 ud_0                 4.544350e-01 1 1  ON 10
 ud_1                 1.882991e-01 1 1  ON 11
 ud_2                 6.735629e-02 1 1  ON 12
 ud_3                -4.339474e-03 1 1  ON 13
 ud_4                -6.202793e-02 1 1  ON 14
 ud_5                -1.045737e-01 1 1  ON 15
 ud_6                -1.332087e-01 1 1  ON 16
 ud_7                -1.516363e-01 1 1  ON 17
 ud_8                -1.540545e-01 1 1  ON 18
 ud_9                -1.462011e-01 1 1  ON 19
 eO_0                -7.510390e-01 1 1  ON 20
 eO_1                -4.293426e-01 1 1  ON 21
 eO_2                -1.394547e-02 1 1  ON 22
 eO_3                 3.032293e-01 1 1  ON 23
 eO_4                 5.308040e-01 1 1  ON 24
 eO_5                 4.941233e-01 1 1  ON 25
 eO_6                 2.652315e-01 1 1  ON 26
 eO_7                -4.104949e-02 1 1  ON 27
 eO_8                -2.401474e-01 1 1  ON 28
 eO_9                -1.114853e-01 1 1  ON 29
eH1_0                -2.647294e-01 1 1  ON 30
eH1_1                -1.593801e-01 1 1  ON 31
eH1_2                -1.099661e-01 1 1  ON 32
eH1_3                -5.441365e-02 1 1  ON 33
eH1_4                -4.021881e-03 1 1  ON 34
eH1_5                 3.291195e-02 1 1  ON 35
eH1_6                 9.579586e-02 1 1  ON 36
eH1_7                 1.600145e-01 1 1  ON 37
eH1_8                 1.995538e-01 1 1  ON 38
eH1_9                 1.031918e-01 1 1  ON 39
eH2_0                -2.607388e-01 1 1  ON 40
eH2_1                -1.556639e-01 1 1  ON 41
eH2_2                -1.064019e-01 1 1  ON 42
eH2_3                -5.104670e-02 1 1  ON 43
eH2_4                -8.927462e-04 1 1  ON 44
eH2_5                 3.478626e-02 1 1  ON 45
eH2_6                 9.773827e-02 1 1  ON 46
eH2_7                 1.601377e-01 1 1  ON 47
eH2_8                 2.005915e-01 1 1  ON 48
eH2_9                 9.329895e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8655
    reference variance = 0.218184
====================================================
  Execution time = 2.0815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4332e-01
  Total weights = 2.0000e+06
  Execution time = 1.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343403175837
                                         uncertainty =       0.010203521893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343403175837
                                         uncertainty =       0.010203521893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414321120
  error estimate for blocks of size 2^( 2) =       0.000426453116
  error estimate for blocks of size 2^( 3) =       0.000439740698
  error estimate for blocks of size 2^( 4) =       0.000451546276
  error estimate for blocks of size 2^( 5) =       0.000462073523
  error estimate for blocks of size 2^( 6) =       0.000470610332
  error estimate for blocks of size 2^( 7) =       0.000474845724

      target function =                  N/A
              le_mean =     -16.906452541801
             les_mean =     286.171461357545
             stat err =       0.000464768963
             autocorr =       1.258346059582
              std dev =       0.585938547163
             le_variance =       0.343323981052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343385215539
                                         uncertainty =       0.010201214516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343385215539
                                         uncertainty =       0.010201214516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414310284
  error estimate for blocks of size 2^( 2) =       0.000426442836
  error estimate for blocks of size 2^( 3) =       0.000439730872
  error estimate for blocks of size 2^( 4) =       0.000451536895
  error estimate for blocks of size 2^( 5) =       0.000462064682
  error estimate for blocks of size 2^( 6) =       0.000470601778
  error estimate for blocks of size 2^( 7) =       0.000474836849

      target function =                  N/A
              le_mean =     -16.906452542008
             les_mean =     286.171443406823
             stat err =       0.000464760051
             autocorr =       1.258363619834
              std dev =       0.585923223056
             le_variance =       0.343306023316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343393944434
                                         uncertainty =       0.010202326493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343393944434
                                         uncertainty =       0.010202326493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414315551
  error estimate for blocks of size 2^( 2) =       0.000426447835
  error estimate for blocks of size 2^( 3) =       0.000439735651
  error estimate for blocks of size 2^( 4) =       0.000451541458
  error estimate for blocks of size 2^( 5) =       0.000462068982
  error estimate for blocks of size 2^( 6) =       0.000470605941
  error estimate for blocks of size 2^( 7) =       0.000474841167

      target function =                  N/A
              le_mean =     -16.906452542439
             les_mean =     286.171452149060
             stat err =       0.000464764387
             autocorr =       1.258355108547
              std dev =       0.585930670783
             le_variance =       0.343314750964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343402013646
                                         uncertainty =       0.010203371100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343402013646
                                         uncertainty =       0.010203371100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414320419
  error estimate for blocks of size 2^( 2) =       0.000426452451
  error estimate for blocks of size 2^( 3) =       0.000439740063
  error estimate for blocks of size 2^( 4) =       0.000451545669
  error estimate for blocks of size 2^( 5) =       0.000462072951
  error estimate for blocks of size 2^( 6) =       0.000470609779
  error estimate for blocks of size 2^( 7) =       0.000474845150

      target function =                  N/A
              le_mean =     -16.906452541875
             les_mean =     286.171460198044
             stat err =       0.000464768387
             autocorr =       1.258347199415
              std dev =       0.585937555569
             le_variance =       0.343322819026


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906452541801        initial
     9.5367e+00     9.5367e+01             1.8694e-05       -16.906452542008
     3.8147e+01     3.8147e+02             4.6872e-06       -16.906452542439  <--
     1.5259e+02     1.5259e+03             1.1727e-06       -16.906452541875

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 3.0348e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.115866e-01 1 1  ON 0
 uu_1                 1.443628e-01 1 1  ON 1
 uu_2                 4.235635e-02 1 1  ON 2
 uu_3                -2.053305e-02 1 1  ON 3
 uu_4                -6.678370e-02 1 1  ON 4
 uu_5                -1.028981e-01 1 1  ON 5
 uu_6                -1.319484e-01 1 1  ON 6
 uu_7                -1.471257e-01 1 1  ON 7
 uu_8                -1.402327e-01 1 1  ON 8
 uu_9                -1.126812e-01 1 1  ON 9
 ud_0                 4.544350e-01 1 1  ON 10
 ud_1                 1.882991e-01 1 1  ON 11
 ud_2                 6.735629e-02 1 1  ON 12
 ud_3                -4.339474e-03 1 1  ON 13
 ud_4                -6.202793e-02 1 1  ON 14
 ud_5                -1.045737e-01 1 1  ON 15
 ud_6                -1.332087e-01 1 1  ON 16
 ud_7                -1.516363e-01 1 1  ON 17
 ud_8                -1.540545e-01 1 1  ON 18
 ud_9                -1.462011e-01 1 1  ON 19
 eO_0                -7.510390e-01 1 1  ON 20
 eO_1                -4.293426e-01 1 1  ON 21
 eO_2                -1.394547e-02 1 1  ON 22
 eO_3                 3.032293e-01 1 1  ON 23
 eO_4                 5.308040e-01 1 1  ON 24
 eO_5                 4.941233e-01 1 1  ON 25
 eO_6                 2.652315e-01 1 1  ON 26
 eO_7                -4.104949e-02 1 1  ON 27
 eO_8                -2.401474e-01 1 1  ON 28
 eO_9                -1.114853e-01 1 1  ON 29
eH1_0                -2.647294e-01 1 1  ON 30
eH1_1                -1.593801e-01 1 1  ON 31
eH1_2                -1.099661e-01 1 1  ON 32
eH1_3                -5.441365e-02 1 1  ON 33
eH1_4                -4.021881e-03 1 1  ON 34
eH1_5                 3.291195e-02 1 1  ON 35
eH1_6                 9.579586e-02 1 1  ON 36
eH1_7                 1.600145e-01 1 1  ON 37
eH1_8                 1.995538e-01 1 1  ON 38
eH1_9                 1.031918e-01 1 1  ON 39
eH2_0                -2.607388e-01 1 1  ON 40
eH2_1                -1.556639e-01 1 1  ON 41
eH2_2                -1.064019e-01 1 1  ON 42
eH2_3                -5.104670e-02 1 1  ON 43
eH2_4                -8.927462e-04 1 1  ON 44
eH2_5                 3.478626e-02 1 1  ON 45
eH2_6                 9.773827e-02 1 1  ON 46
eH2_7                 1.601377e-01 1 1  ON 47
eH2_8                 2.005915e-01 1 1  ON 48
eH2_9                 9.329895e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7282e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9989
    reference variance = 0.448028
====================================================
  Execution time = 2.1131e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3863e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338630098081
                                         uncertainty =       0.004050572459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338630098081
                                         uncertainty =       0.004050572459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411476902
  error estimate for blocks of size 2^( 2) =       0.000423855297
  error estimate for blocks of size 2^( 3) =       0.000437395043
  error estimate for blocks of size 2^( 4) =       0.000449367492
  error estimate for blocks of size 2^( 5) =       0.000459814140
  error estimate for blocks of size 2^( 6) =       0.000465926819
  error estimate for blocks of size 2^( 7) =       0.000469095603

      target function =                  N/A
              le_mean =     -16.907128165143
             les_mean =     286.189609105125
             stat err =       0.000461051013
             autocorr =       1.255472021524
              std dev =       0.581916215504
             le_variance =       0.338626481866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690712816514e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907128165143       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907128291683       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907128307063       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907128291282       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907128304671       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907128303069       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907128323284       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907128324628       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.326780e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907128165143       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907128197240       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907128201477       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907128197548       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907128200914       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907128200265       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907128205342       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907128205865       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.827121e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907128165143       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907128173197       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907128174282       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907128173300       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907128174143       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907128173965       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907128175236       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907128175378       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.457431e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6809e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.115868e-01 1 1  ON 0
 uu_1                 1.443628e-01 1 1  ON 1
 uu_2                 4.235392e-02 1 1  ON 2
 uu_3                -2.053335e-02 1 1  ON 3
 uu_4                -6.678644e-02 1 1  ON 4
 uu_5                -1.028960e-01 1 1  ON 5
 uu_6                -1.319453e-01 1 1  ON 6
 uu_7                -1.471282e-01 1 1  ON 7
 uu_8                -1.402343e-01 1 1  ON 8
 uu_9                -1.126805e-01 1 1  ON 9
 ud_0                 4.544316e-01 1 1  ON 10
 ud_1                 1.883022e-01 1 1  ON 11
 ud_2                 6.735628e-02 1 1  ON 12
 ud_3                -4.337764e-03 1 1  ON 13
 ud_4                -6.202955e-02 1 1  ON 14
 ud_5                -1.045736e-01 1 1  ON 15
 ud_6                -1.332122e-01 1 1  ON 16
 ud_7                -1.516347e-01 1 1  ON 17
 ud_8                -1.540506e-01 1 1  ON 18
 ud_9                -1.462010e-01 1 1  ON 19
 eO_0                -7.510377e-01 1 1  ON 20
 eO_1                -4.293404e-01 1 1  ON 21
 eO_2                -1.394692e-02 1 1  ON 22
 eO_3                 3.032322e-01 1 1  ON 23
 eO_4                 5.308023e-01 1 1  ON 24
 eO_5                 4.941250e-01 1 1  ON 25
 eO_6                 2.652317e-01 1 1  ON 26
 eO_7                -4.104906e-02 1 1  ON 27
 eO_8                -2.401491e-01 1 1  ON 28
 eO_9                -1.114885e-01 1 1  ON 29
eH1_0                -2.647303e-01 1 1  ON 30
eH1_1                -1.593792e-01 1 1  ON 31
eH1_2                -1.099686e-01 1 1  ON 32
eH1_3                -5.441505e-02 1 1  ON 33
eH1_4                -4.024532e-03 1 1  ON 34
eH1_5                 3.290865e-02 1 1  ON 35
eH1_6                 9.579579e-02 1 1  ON 36
eH1_7                 1.600146e-01 1 1  ON 37
eH1_8                 1.995558e-01 1 1  ON 38
eH1_9                 1.031977e-01 1 1  ON 39
eH2_0                -2.607394e-01 1 1  ON 40
eH2_1                -1.556643e-01 1 1  ON 41
eH2_2                -1.064041e-01 1 1  ON 42
eH2_3                -5.104852e-02 1 1  ON 43
eH2_4                -8.943940e-04 1 1  ON 44
eH2_5                 3.478630e-02 1 1  ON 45
eH2_6                 9.773758e-02 1 1  ON 46
eH2_7                 1.601385e-01 1 1  ON 47
eH2_8                 2.005932e-01 1 1  ON 48
eH2_9                 9.330304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9745
    reference variance = 0.261698
====================================================
  Execution time = 2.0625e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3756e-01
  Total weights = 2.0000e+06
  Execution time = 1.8863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337582564150
                                         uncertainty =       0.005154715635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337582564150
                                         uncertainty =       0.005154715635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410832305
  error estimate for blocks of size 2^( 2) =       0.000423977453
  error estimate for blocks of size 2^( 3) =       0.000437105182
  error estimate for blocks of size 2^( 4) =       0.000450140473
  error estimate for blocks of size 2^( 5) =       0.000460891778
  error estimate for blocks of size 2^( 6) =       0.000469507510
  error estimate for blocks of size 2^( 7) =       0.000475271321

      target function =                  N/A
              le_mean =     -16.906262520029
             les_mean =     286.159278592939
             stat err =       0.000463952770
             autocorr =       1.275317656818
              std dev =       0.581004617514
             le_variance =       0.337566365573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337573596755
                                         uncertainty =       0.005154499460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337573596755
                                         uncertainty =       0.005154499460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410826844
  error estimate for blocks of size 2^( 2) =       0.000423972195
  error estimate for blocks of size 2^( 3) =       0.000437100091
  error estimate for blocks of size 2^( 4) =       0.000450135400
  error estimate for blocks of size 2^( 5) =       0.000460886942
  error estimate for blocks of size 2^( 6) =       0.000469502570
  error estimate for blocks of size 2^( 7) =       0.000475267072

      target function =                  N/A
              le_mean =     -16.906262476454
             les_mean =     286.159268146194
             stat err =       0.000463947996
             autocorr =       1.275325310691
              std dev =       0.580996895177
             le_variance =       0.337557392205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337577876006
                                         uncertainty =       0.005154602892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337577876006
                                         uncertainty =       0.005154602892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410829450
  error estimate for blocks of size 2^( 2) =       0.000423974703
  error estimate for blocks of size 2^( 3) =       0.000437102520
  error estimate for blocks of size 2^( 4) =       0.000450137821
  error estimate for blocks of size 2^( 5) =       0.000460889250
  error estimate for blocks of size 2^( 6) =       0.000469504925
  error estimate for blocks of size 2^( 7) =       0.000475269096

      target function =                  N/A
              le_mean =     -16.906262497130
             les_mean =     286.159273127412
             stat err =       0.000463950273
             autocorr =       1.275321650293
              std dev =       0.581000580305
             le_variance =       0.337561674315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337581971215
                                         uncertainty =       0.005154701390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337581971215
                                         uncertainty =       0.005154701390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410831944
  error estimate for blocks of size 2^( 2) =       0.000423977105
  error estimate for blocks of size 2^( 3) =       0.000437104845
  error estimate for blocks of size 2^( 4) =       0.000450140138
  error estimate for blocks of size 2^( 5) =       0.000460891458
  error estimate for blocks of size 2^( 6) =       0.000469507183
  error estimate for blocks of size 2^( 7) =       0.000475271039

      target function =                  N/A
              le_mean =     -16.906262517101
             les_mean =     286.159277900583
             stat err =       0.000463952454
             autocorr =       1.275318161444
              std dev =       0.581004106909
             le_variance =       0.337565772245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906262520029        initial  <--
     9.5367e+00     9.5367e+01             2.3268e-05       -16.906262476454
     3.8147e+01     3.8147e+02             5.8271e-06       -16.906262497130
     1.5259e+02     1.5259e+03             1.4574e-06       -16.906262517101

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1539
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.115866e-01 1 1  ON 0
 uu_1                 1.443628e-01 1 1  ON 1
 uu_2                 4.235635e-02 1 1  ON 2
 uu_3                -2.053305e-02 1 1  ON 3
 uu_4                -6.678370e-02 1 1  ON 4
 uu_5                -1.028981e-01 1 1  ON 5
 uu_6                -1.319484e-01 1 1  ON 6
 uu_7                -1.471257e-01 1 1  ON 7
 uu_8                -1.402327e-01 1 1  ON 8
 uu_9                -1.126812e-01 1 1  ON 9
 ud_0                 4.544350e-01 1 1  ON 10
 ud_1                 1.882991e-01 1 1  ON 11
 ud_2                 6.735629e-02 1 1  ON 12
 ud_3                -4.339474e-03 1 1  ON 13
 ud_4                -6.202793e-02 1 1  ON 14
 ud_5                -1.045737e-01 1 1  ON 15
 ud_6                -1.332087e-01 1 1  ON 16
 ud_7                -1.516363e-01 1 1  ON 17
 ud_8                -1.540545e-01 1 1  ON 18
 ud_9                -1.462011e-01 1 1  ON 19
 eO_0                -7.510390e-01 1 1  ON 20
 eO_1                -4.293426e-01 1 1  ON 21
 eO_2                -1.394547e-02 1 1  ON 22
 eO_3                 3.032293e-01 1 1  ON 23
 eO_4                 5.308040e-01 1 1  ON 24
 eO_5                 4.941233e-01 1 1  ON 25
 eO_6                 2.652315e-01 1 1  ON 26
 eO_7                -4.104949e-02 1 1  ON 27
 eO_8                -2.401474e-01 1 1  ON 28
 eO_9                -1.114853e-01 1 1  ON 29
eH1_0                -2.647294e-01 1 1  ON 30
eH1_1                -1.593801e-01 1 1  ON 31
eH1_2                -1.099661e-01 1 1  ON 32
eH1_3                -5.441365e-02 1 1  ON 33
eH1_4                -4.021881e-03 1 1  ON 34
eH1_5                 3.291195e-02 1 1  ON 35
eH1_6                 9.579586e-02 1 1  ON 36
eH1_7                 1.600145e-01 1 1  ON 37
eH1_8                 1.995538e-01 1 1  ON 38
eH1_9                 1.031918e-01 1 1  ON 39
eH2_0                -2.607388e-01 1 1  ON 40
eH2_1                -1.556639e-01 1 1  ON 41
eH2_2                -1.064019e-01 1 1  ON 42
eH2_3                -5.104670e-02 1 1  ON 43
eH2_4                -8.927462e-04 1 1  ON 44
eH2_5                 3.478626e-02 1 1  ON 45
eH2_6                 9.773827e-02 1 1  ON 46
eH2_7                 1.601377e-01 1 1  ON 47
eH2_8                 2.005915e-01 1 1  ON 48
eH2_9                 9.329895e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.812
    reference variance = 0.274424
====================================================
  Execution time = 2.2803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3621e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336222684622
                                         uncertainty =       0.003216422723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336222684622
                                         uncertainty =       0.003216422723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410003403
  error estimate for blocks of size 2^( 2) =       0.000422772924
  error estimate for blocks of size 2^( 3) =       0.000435623895
  error estimate for blocks of size 2^( 4) =       0.000447384584
  error estimate for blocks of size 2^( 5) =       0.000456846882
  error estimate for blocks of size 2^( 6) =       0.000465252376
  error estimate for blocks of size 2^( 7) =       0.000468030892

      target function =                  N/A
              le_mean =     -16.906230801077
             les_mean =     286.156845311810
             stat err =       0.000459378684
             autocorr =       1.255355574537
              std dev =       0.579832372869
             le_variance =       0.336205580627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623080108e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906230801077       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906230799818       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906230800115       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906230798383       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906230801201       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906230805658       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906230804082       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.976646e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906230801077       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906230800762       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906230800835       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906230800398       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906230801100       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906230802219       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906230801828       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.951258e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906230801077       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906230800998       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906230801016       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906230800906       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906230801083       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906230801363       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906230801264       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.238420e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8434e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.115867e-01 1 1  ON 0
 uu_1                 1.443632e-01 1 1  ON 1
 uu_2                 4.235644e-02 1 1  ON 2
 uu_3                -2.053301e-02 1 1  ON 3
 uu_4                -6.678386e-02 1 1  ON 4
 uu_5                -1.028980e-01 1 1  ON 5
 uu_6                -1.319482e-01 1 1  ON 6
 uu_7                -1.471259e-01 1 1  ON 7
 uu_8                -1.402332e-01 1 1  ON 8
 uu_9                -1.126815e-01 1 1  ON 9
 ud_0                 4.544354e-01 1 1  ON 10
 ud_1                 1.882994e-01 1 1  ON 11
 ud_2                 6.735619e-02 1 1  ON 12
 ud_3                -4.339523e-03 1 1  ON 13
 ud_4                -6.202762e-02 1 1  ON 14
 ud_5                -1.045739e-01 1 1  ON 15
 ud_6                -1.332089e-01 1 1  ON 16
 ud_7                -1.516360e-01 1 1  ON 17
 ud_8                -1.540546e-01 1 1  ON 18
 ud_9                -1.462011e-01 1 1  ON 19
 eO_0                -7.510390e-01 1 1  ON 20
 eO_1                -4.293429e-01 1 1  ON 21
 eO_2                -1.394497e-02 1 1  ON 22
 eO_3                 3.032296e-01 1 1  ON 23
 eO_4                 5.308041e-01 1 1  ON 24
 eO_5                 4.941234e-01 1 1  ON 25
 eO_6                 2.652315e-01 1 1  ON 26
 eO_7                -4.104954e-02 1 1  ON 27
 eO_8                -2.401477e-01 1 1  ON 28
 eO_9                -1.114856e-01 1 1  ON 29
eH1_0                -2.647298e-01 1 1  ON 30
eH1_1                -1.593801e-01 1 1  ON 31
eH1_2                -1.099663e-01 1 1  ON 32
eH1_3                -5.441356e-02 1 1  ON 33
eH1_4                -4.021971e-03 1 1  ON 34
eH1_5                 3.291211e-02 1 1  ON 35
eH1_6                 9.579572e-02 1 1  ON 36
eH1_7                 1.600146e-01 1 1  ON 37
eH1_8                 1.995540e-01 1 1  ON 38
eH1_9                 1.031921e-01 1 1  ON 39
eH2_0                -2.607392e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064021e-01 1 1  ON 42
eH2_3                -5.104671e-02 1 1  ON 43
eH2_4                -8.926498e-04 1 1  ON 44
eH2_5                 3.478629e-02 1 1  ON 45
eH2_6                 9.773833e-02 1 1  ON 46
eH2_7                 1.601378e-01 1 1  ON 47
eH2_8                 2.005915e-01 1 1  ON 48
eH2_9                 9.329931e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9359
    reference variance = 0.246931
====================================================
  Execution time = 2.0781e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3723e-01
  Total weights = 2.0000e+06
  Execution time = 1.8839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337330866651
                                         uncertainty =       0.004157785728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337330866651
                                         uncertainty =       0.004157785728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410626578
  error estimate for blocks of size 2^( 2) =       0.000423236301
  error estimate for blocks of size 2^( 3) =       0.000436206561
  error estimate for blocks of size 2^( 4) =       0.000447349409
  error estimate for blocks of size 2^( 5) =       0.000457782183
  error estimate for blocks of size 2^( 6) =       0.000465347349
  error estimate for blocks of size 2^( 7) =       0.000469856503

      target function =                  N/A
              le_mean =     -16.906773290954
             les_mean =     286.176211316748
             stat err =       0.000460083861
             autocorr =       1.255393529874
              std dev =       0.580713676131
             le_variance =       0.337228373646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332096073
                                         uncertainty =       0.004157791127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337332096073
                                         uncertainty =       0.004157791127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410627326
  error estimate for blocks of size 2^( 2) =       0.000423236993
  error estimate for blocks of size 2^( 3) =       0.000436207197
  error estimate for blocks of size 2^( 4) =       0.000447350023
  error estimate for blocks of size 2^( 5) =       0.000457782810
  error estimate for blocks of size 2^( 6) =       0.000465347979
  error estimate for blocks of size 2^( 7) =       0.000469857063

      target function =                  N/A
              le_mean =     -16.906773293275
             les_mean =     286.176212624013
             stat err =       0.000460084469
             autocorr =       1.255392271769
              std dev =       0.580714734114
             le_variance =       0.337229602417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337331482387
                                         uncertainty =       0.004157788413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337331482387
                                         uncertainty =       0.004157788413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410626953
  error estimate for blocks of size 2^( 2) =       0.000423236648
  error estimate for blocks of size 2^( 3) =       0.000436206880
  error estimate for blocks of size 2^( 4) =       0.000447349717
  error estimate for blocks of size 2^( 5) =       0.000457782497
  error estimate for blocks of size 2^( 6) =       0.000465347665
  error estimate for blocks of size 2^( 7) =       0.000469856783

      target function =                  N/A
              le_mean =     -16.906773292114
             les_mean =     286.176211971381
             stat err =       0.000460084165
             autocorr =       1.255392899478
              std dev =       0.580714206005
             le_variance =       0.337228989055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337330943648
                                         uncertainty =       0.004157786063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337330943648
                                         uncertainty =       0.004157786063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410626625
  error estimate for blocks of size 2^( 2) =       0.000423236344
  error estimate for blocks of size 2^( 3) =       0.000436206601
  error estimate for blocks of size 2^( 4) =       0.000447349448
  error estimate for blocks of size 2^( 5) =       0.000457782223
  error estimate for blocks of size 2^( 6) =       0.000465347389
  error estimate for blocks of size 2^( 7) =       0.000469856538

      target function =                  N/A
              le_mean =     -16.906773291099
             les_mean =     286.176211398597
             stat err =       0.000460083899
             autocorr =       1.255393451029
              std dev =       0.580713742391
             le_variance =       0.337228450601


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906773290954        initial
     9.5367e+01     9.5367e+02             1.9766e-06       -16.906773293275  <--
     3.8147e+02     3.8147e+03             4.9513e-07       -16.906773292114
     1.5259e+03     1.5259e+04             1.2384e-07       -16.906773291099

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 3.0310e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.115869e-01 1 1  ON 0
 uu_1                 1.443643e-01 1 1  ON 1
 uu_2                 4.235670e-02 1 1  ON 2
 uu_3                -2.053288e-02 1 1  ON 3
 uu_4                -6.678435e-02 1 1  ON 4
 uu_5                -1.028977e-01 1 1  ON 5
 uu_6                -1.319475e-01 1 1  ON 6
 uu_7                -1.471265e-01 1 1  ON 7
 uu_8                -1.402347e-01 1 1  ON 8
 uu_9                -1.126826e-01 1 1  ON 9
 ud_0                 4.544363e-01 1 1  ON 10
 ud_1                 1.883002e-01 1 1  ON 11
 ud_2                 6.735590e-02 1 1  ON 12
 ud_3                -4.339671e-03 1 1  ON 13
 ud_4                -6.202672e-02 1 1  ON 14
 ud_5                -1.045745e-01 1 1  ON 15
 ud_6                -1.332095e-01 1 1  ON 16
 ud_7                -1.516352e-01 1 1  ON 17
 ud_8                -1.540549e-01 1 1  ON 18
 ud_9                -1.462013e-01 1 1  ON 19
 eO_0                -7.510389e-01 1 1  ON 20
 eO_1                -4.293437e-01 1 1  ON 21
 eO_2                -1.394349e-02 1 1  ON 22
 eO_3                 3.032304e-01 1 1  ON 23
 eO_4                 5.308042e-01 1 1  ON 24
 eO_5                 4.941236e-01 1 1  ON 25
 eO_6                 2.652315e-01 1 1  ON 26
 eO_7                -4.104971e-02 1 1  ON 27
 eO_8                -2.401484e-01 1 1  ON 28
 eO_9                -1.114865e-01 1 1  ON 29
eH1_0                -2.647308e-01 1 1  ON 30
eH1_1                -1.593802e-01 1 1  ON 31
eH1_2                -1.099672e-01 1 1  ON 32
eH1_3                -5.441331e-02 1 1  ON 33
eH1_4                -4.022241e-03 1 1  ON 34
eH1_5                 3.291259e-02 1 1  ON 35
eH1_6                 9.579530e-02 1 1  ON 36
eH1_7                 1.600150e-01 1 1  ON 37
eH1_8                 1.995548e-01 1 1  ON 38
eH1_9                 1.031930e-01 1 1  ON 39
eH2_0                -2.607403e-01 1 1  ON 40
eH2_1                -1.556646e-01 1 1  ON 41
eH2_2                -1.064025e-01 1 1  ON 42
eH2_3                -5.104674e-02 1 1  ON 43
eH2_4                -8.923608e-04 1 1  ON 44
eH2_5                 3.478638e-02 1 1  ON 45
eH2_6                 9.773851e-02 1 1  ON 46
eH2_7                 1.601380e-01 1 1  ON 47
eH2_8                 2.005917e-01 1 1  ON 48
eH2_9                 9.330039e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9352
    reference variance = 0.157531
====================================================
  Execution time = 2.0873e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3834e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338432463910
                                         uncertainty =       0.003951653203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338432463910
                                         uncertainty =       0.003951653203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411304883
  error estimate for blocks of size 2^( 2) =       0.000423655340
  error estimate for blocks of size 2^( 3) =       0.000436507632
  error estimate for blocks of size 2^( 4) =       0.000448778401
  error estimate for blocks of size 2^( 5) =       0.000457594651
  error estimate for blocks of size 2^( 6) =       0.000465672849
  error estimate for blocks of size 2^( 7) =       0.000468465739

      target function =                  N/A
              le_mean =     -16.906611776655
             les_mean =     286.171865010896
             stat err =       0.000460127910
             autocorr =       1.251495876634
              std dev =       0.581672943803
             le_variance =       0.338343413552


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661177665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906611776655       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906611787067       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906611761065       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906611761646       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906611790228       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906611793609       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906611795574       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906611799202       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.096202e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906611776655       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906611779274       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906611772714       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906611772859       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906611780082       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906611780892       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906611781358       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906611782265       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.767327e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906611776655       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906611777311       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906611775667       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906611775703       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906611777514       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906611777714       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906611777829       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906611778055       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 6.935269e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279078 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6504e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.115876e-01 1 1  ON 0
 uu_1                 1.443652e-01 1 1  ON 1
 uu_2                 4.235672e-02 1 1  ON 2
 uu_3                -2.053284e-02 1 1  ON 3
 uu_4                -6.678509e-02 1 1  ON 4
 uu_5                -1.028976e-01 1 1  ON 5
 uu_6                -1.319482e-01 1 1  ON 6
 uu_7                -1.471285e-01 1 1  ON 7
 uu_8                -1.402354e-01 1 1  ON 8
 uu_9                -1.126820e-01 1 1  ON 9
 ud_0                 4.544335e-01 1 1  ON 10
 ud_1                 1.883002e-01 1 1  ON 11
 ud_2                 6.735630e-02 1 1  ON 12
 ud_3                -4.338517e-03 1 1  ON 13
 ud_4                -6.202745e-02 1 1  ON 14
 ud_5                -1.045730e-01 1 1  ON 15
 ud_6                -1.332089e-01 1 1  ON 16
 ud_7                -1.516356e-01 1 1  ON 17
 ud_8                -1.540551e-01 1 1  ON 18
 ud_9                -1.462016e-01 1 1  ON 19
 eO_0                -7.510394e-01 1 1  ON 20
 eO_1                -4.293428e-01 1 1  ON 21
 eO_2                -1.394351e-02 1 1  ON 22
 eO_3                 3.032308e-01 1 1  ON 23
 eO_4                 5.308050e-01 1 1  ON 24
 eO_5                 4.941239e-01 1 1  ON 25
 eO_6                 2.652318e-01 1 1  ON 26
 eO_7                -4.105011e-02 1 1  ON 27
 eO_8                -2.401489e-01 1 1  ON 28
 eO_9                -1.114875e-01 1 1  ON 29
eH1_0                -2.647322e-01 1 1  ON 30
eH1_1                -1.593803e-01 1 1  ON 31
eH1_2                -1.099672e-01 1 1  ON 32
eH1_3                -5.441442e-02 1 1  ON 33
eH1_4                -4.021942e-03 1 1  ON 34
eH1_5                 3.291238e-02 1 1  ON 35
eH1_6                 9.579467e-02 1 1  ON 36
eH1_7                 1.600154e-01 1 1  ON 37
eH1_8                 1.995560e-01 1 1  ON 38
eH1_9                 1.031944e-01 1 1  ON 39
eH2_0                -2.607412e-01 1 1  ON 40
eH2_1                -1.556644e-01 1 1  ON 41
eH2_2                -1.064030e-01 1 1  ON 42
eH2_3                -5.104804e-02 1 1  ON 43
eH2_4                -8.936628e-04 1 1  ON 44
eH2_5                 3.478629e-02 1 1  ON 45
eH2_6                 9.773862e-02 1 1  ON 46
eH2_7                 1.601384e-01 1 1  ON 47
eH2_8                 2.005927e-01 1 1  ON 48
eH2_9                 9.330234e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.7781
    reference variance = 0.310099
====================================================
  Execution time = 2.0665e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4032e-01
  Total weights = 2.0000e+06
  Execution time = 1.8828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340398467243
                                         uncertainty =       0.004107877586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340398467243
                                         uncertainty =       0.004107877586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412507646
  error estimate for blocks of size 2^( 2) =       0.000425159499
  error estimate for blocks of size 2^( 3) =       0.000438212491
  error estimate for blocks of size 2^( 4) =       0.000450694439
  error estimate for blocks of size 2^( 5) =       0.000459928168
  error estimate for blocks of size 2^( 6) =       0.000468426671
  error estimate for blocks of size 2^( 7) =       0.000471728777

      target function =                  N/A
              le_mean =     -16.906350232394
             les_mean =     286.165003126742
             stat err =       0.000462694514
             autocorr =       1.258127611168
              std dev =       0.583373907994
             le_variance =       0.340325116528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340389299785
                                         uncertainty =       0.004107744576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340389299785
                                         uncertainty =       0.004107744576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412502094
  error estimate for blocks of size 2^( 2) =       0.000425154304
  error estimate for blocks of size 2^( 3) =       0.000438207584
  error estimate for blocks of size 2^( 4) =       0.000450689704
  error estimate for blocks of size 2^( 5) =       0.000459923569
  error estimate for blocks of size 2^( 6) =       0.000468422238
  error estimate for blocks of size 2^( 7) =       0.000471724613

      target function =                  N/A
              le_mean =     -16.906350252788
             les_mean =     286.164994654858
             stat err =       0.000462690031
             autocorr =       1.258137102529
              std dev =       0.583366055809
             le_variance =       0.340315955070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340393832659
                                         uncertainty =       0.004107810312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340393832659
                                         uncertainty =       0.004107810312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412504839
  error estimate for blocks of size 2^( 2) =       0.000425156873
  error estimate for blocks of size 2^( 3) =       0.000438210010
  error estimate for blocks of size 2^( 4) =       0.000450692045
  error estimate for blocks of size 2^( 5) =       0.000459925843
  error estimate for blocks of size 2^( 6) =       0.000468424430
  error estimate for blocks of size 2^( 7) =       0.000471726673

      target function =                  N/A
              le_mean =     -16.906350242668
             les_mean =     286.164998842563
             stat err =       0.000462692248
             autocorr =       1.258132411883
              std dev =       0.583369938355
             le_variance =       0.340320484977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340397886265
                                         uncertainty =       0.004107869153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340397886265
                                         uncertainty =       0.004107869153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412507294
  error estimate for blocks of size 2^( 2) =       0.000425159170
  error estimate for blocks of size 2^( 3) =       0.000438212180
  error estimate for blocks of size 2^( 4) =       0.000450694139
  error estimate for blocks of size 2^( 5) =       0.000459927876
  error estimate for blocks of size 2^( 6) =       0.000468426390
  error estimate for blocks of size 2^( 7) =       0.000471728514

      target function =                  N/A
              le_mean =     -16.906350233675
             les_mean =     286.165002589458
             stat err =       0.000462694230
             autocorr =       1.258128213001
              std dev =       0.583373410373
             le_variance =       0.340324535930


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906350232394        initial
     2.3842e+01     2.3842e+02             1.0962e-05       -16.906350252788  <--
     9.5367e+01     9.5367e+02             2.7673e-06       -16.906350242668
     3.8147e+02     3.8147e+03             6.9353e-07       -16.906350233675

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 3.0217e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.0106
    reference variance = 0.612092
====================================================
  Execution time = 2.1069e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3525e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335208945022
                                         uncertainty =       0.002915627105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335208945022
                                         uncertainty =       0.002915627105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409420707
  error estimate for blocks of size 2^( 2) =       0.000421769575
  error estimate for blocks of size 2^( 3) =       0.000433954901
  error estimate for blocks of size 2^( 4) =       0.000446124550
  error estimate for blocks of size 2^( 5) =       0.000455996377
  error estimate for blocks of size 2^( 6) =       0.000463421066
  error estimate for blocks of size 2^( 7) =       0.000468408584

      target function =                  N/A
              le_mean =     -16.906590793132
             les_mean =     286.168062710131
             stat err =       0.000458487645
             autocorr =       1.254052344877
              std dev =       0.579008317156
             le_variance =       0.335250631335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690659079313e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906590793132       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906590878127       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906590864810       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906590901911       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906590930602       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906590980669       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906590966918       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 3.281786e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906590793132       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906590814918       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906590811561       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906590821100       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906590828260       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906590841746       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906590838634       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 8.241566e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906590793132       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906590798613       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906590797773       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906590800175       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906590801966       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906590805399       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906590804648       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.062701e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6778e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.115850e-01 1 1  ON 0
 uu_1                 1.443669e-01 1 1  ON 1
 uu_2                 4.235696e-02 1 1  ON 2
 uu_3                -2.053376e-02 1 1  ON 3
 uu_4                -6.678333e-02 1 1  ON 4
 uu_5                -1.028982e-01 1 1  ON 5
 uu_6                -1.319507e-01 1 1  ON 6
 uu_7                -1.471353e-01 1 1  ON 7
 uu_8                -1.402382e-01 1 1  ON 8
 uu_9                -1.126793e-01 1 1  ON 9
 ud_0                 4.544222e-01 1 1  ON 10
 ud_1                 1.883021e-01 1 1  ON 11
 ud_2                 6.735591e-02 1 1  ON 12
 ud_3                -4.333015e-03 1 1  ON 13
 ud_4                -6.202927e-02 1 1  ON 14
 ud_5                -1.045678e-01 1 1  ON 15
 ud_6                -1.332108e-01 1 1  ON 16
 ud_7                -1.516358e-01 1 1  ON 17
 ud_8                -1.540528e-01 1 1  ON 18
 ud_9                -1.462001e-01 1 1  ON 19
 eO_0                -7.510357e-01 1 1  ON 20
 eO_1                -4.293366e-01 1 1  ON 21
 eO_2                -1.394493e-02 1 1  ON 22
 eO_3                 3.032302e-01 1 1  ON 23
 eO_4                 5.308070e-01 1 1  ON 24
 eO_5                 4.941275e-01 1 1  ON 25
 eO_6                 2.652339e-01 1 1  ON 26
 eO_7                -4.105324e-02 1 1  ON 27
 eO_8                -2.401530e-01 1 1  ON 28
 eO_9                -1.114942e-01 1 1  ON 29
eH1_0                -2.647384e-01 1 1  ON 30
eH1_1                -1.593819e-01 1 1  ON 31
eH1_2                -1.099670e-01 1 1  ON 32
eH1_3                -5.441587e-02 1 1  ON 33
eH1_4                -4.027105e-03 1 1  ON 34
eH1_5                 3.290917e-02 1 1  ON 35
eH1_6                 9.579355e-02 1 1  ON 36
eH1_7                 1.600166e-01 1 1  ON 37
eH1_8                 1.995621e-01 1 1  ON 38
eH1_9                 1.032042e-01 1 1  ON 39
eH2_0                -2.607447e-01 1 1  ON 40
eH2_1                -1.556637e-01 1 1  ON 41
eH2_2                -1.064042e-01 1 1  ON 42
eH2_3                -5.105609e-02 1 1  ON 43
eH2_4                -9.021487e-04 1 1  ON 44
eH2_5                 3.477975e-02 1 1  ON 45
eH2_6                 9.773636e-02 1 1  ON 46
eH2_7                 1.601430e-01 1 1  ON 47
eH2_8                 2.006003e-01 1 1  ON 48
eH2_9                 9.331642e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9832
    reference variance = 0.229403
====================================================
  Execution time = 2.0478e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4606e-01
  Total weights = 2.0000e+06
  Execution time = 1.8903e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346124353839
                                         uncertainty =       0.008223411372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346124353839
                                         uncertainty =       0.008223411372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415971456
  error estimate for blocks of size 2^( 2) =       0.000429143530
  error estimate for blocks of size 2^( 3) =       0.000441924504
  error estimate for blocks of size 2^( 4) =       0.000453609697
  error estimate for blocks of size 2^( 5) =       0.000464574464
  error estimate for blocks of size 2^( 6) =       0.000472975442
  error estimate for blocks of size 2^( 7) =       0.000478537588

      target function =                  N/A
              le_mean =     -16.906663665446
             les_mean =     286.181340628636
             stat err =       0.000467424298
             autocorr =       1.262686410716
              std dev =       0.588272475262
             le_variance =       0.346064505151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346109169690
                                         uncertainty =       0.008222813650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346109169690
                                         uncertainty =       0.008222813650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415962331
  error estimate for blocks of size 2^( 2) =       0.000429134845
  error estimate for blocks of size 2^( 3) =       0.000441916109
  error estimate for blocks of size 2^( 4) =       0.000453601776
  error estimate for blocks of size 2^( 5) =       0.000464566659
  error estimate for blocks of size 2^( 6) =       0.000472968042
  error estimate for blocks of size 2^( 7) =       0.000478529755

      target function =                  N/A
              le_mean =     -16.906663567666
             les_mean =     286.181322138982
             stat err =       0.000467416558
             autocorr =       1.262699996374
              std dev =       0.588259570050
             le_variance =       0.346049321755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346116494746
                                         uncertainty =       0.008223101858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346116494746
                                         uncertainty =       0.008223101858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415966733
  error estimate for blocks of size 2^( 2) =       0.000429139032
  error estimate for blocks of size 2^( 3) =       0.000441920152
  error estimate for blocks of size 2^( 4) =       0.000453605588
  error estimate for blocks of size 2^( 5) =       0.000464570417
  error estimate for blocks of size 2^( 6) =       0.000472971601
  error estimate for blocks of size 2^( 7) =       0.000478533522

      target function =                  N/A
              le_mean =     -16.906663614127
             les_mean =     286.181331034771
             stat err =       0.000467420282
             autocorr =       1.262693389154
              std dev =       0.588265795840
             le_variance =       0.346056646556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346123362123
                                         uncertainty =       0.008223372326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346123362123
                                         uncertainty =       0.008223372326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415970860
  error estimate for blocks of size 2^( 2) =       0.000429142962
  error estimate for blocks of size 2^( 3) =       0.000441923955
  error estimate for blocks of size 2^( 4) =       0.000453609178
  error estimate for blocks of size 2^( 5) =       0.000464573953
  error estimate for blocks of size 2^( 6) =       0.000472974957
  error estimate for blocks of size 2^( 7) =       0.000478537074

      target function =                  N/A
              le_mean =     -16.906663658903
             les_mean =     286.181339415728
             stat err =       0.000467423790
             autocorr =       1.262687289089
              std dev =       0.588271632412
             le_variance =       0.346063513501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906663665446        initial  <--
     5.9605e+00     5.9605e+01             3.2818e-05       -16.906663567666
     2.3842e+01     2.3842e+02             8.2416e-06       -16.906663614127
     9.5367e+01     9.5367e+02             2.0627e-06       -16.906663658903

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0145
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6800e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9873
    reference variance = 0.488545
====================================================
  Execution time = 2.1221e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342493424698
                                         uncertainty =       0.003327884624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342493424698
                                         uncertainty =       0.003327884624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413752354
  error estimate for blocks of size 2^( 2) =       0.000426580905
  error estimate for blocks of size 2^( 3) =       0.000440417205
  error estimate for blocks of size 2^( 4) =       0.000453592271
  error estimate for blocks of size 2^( 5) =       0.000464778126
  error estimate for blocks of size 2^( 6) =       0.000474933795
  error estimate for blocks of size 2^( 7) =       0.000479733065

      target function =                  N/A
              le_mean =     -16.906749982320
             les_mean =     286.180576814381
             stat err =       0.000468259314
             autocorr =       1.280831188536
              std dev =       0.585134190495
             le_variance =       0.342382020887


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690674998232e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906749982320       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906749981073       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906749991380       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906749999442       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906750003470       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906750002818       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906750004106       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906750002655       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 4.398894e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906749982320       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906749982007       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906749984586       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906749986602       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906749987607       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906749987448       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906749987778       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906749987416       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.100146e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906749982320       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906749982242       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906749982887       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906749983391       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906749983642       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906749983602       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906749983684       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906749983595       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.750630e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283906 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6926e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.115892e-01 1 1  ON 0
 uu_1                 1.443681e-01 1 1  ON 1
 uu_2                 4.235679e-02 1 1  ON 2
 uu_3                -2.053273e-02 1 1  ON 3
 uu_4                -6.678730e-02 1 1  ON 4
 uu_5                -1.028975e-01 1 1  ON 5
 uu_6                -1.319507e-01 1 1  ON 6
 uu_7                -1.471355e-01 1 1  ON 7
 uu_8                -1.402375e-01 1 1  ON 8
 uu_9                -1.126801e-01 1 1  ON 9
 ud_0                 4.544245e-01 1 1  ON 10
 ud_1                 1.882999e-01 1 1  ON 11
 ud_2                 6.735750e-02 1 1  ON 12
 ud_3                -4.335363e-03 1 1  ON 13
 ud_4                -6.202940e-02 1 1  ON 14
 ud_5                -1.045687e-01 1 1  ON 15
 ud_6                -1.332068e-01 1 1  ON 16
 ud_7                -1.516368e-01 1 1  ON 17
 ud_8                -1.540551e-01 1 1  ON 18
 ud_9                -1.462013e-01 1 1  ON 19
 eO_0                -7.510411e-01 1 1  ON 20
 eO_1                -4.293396e-01 1 1  ON 21
 eO_2                -1.394334e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308070e-01 1 1  ON 24
 eO_5                 4.941254e-01 1 1  ON 25
 eO_6                 2.652327e-01 1 1  ON 26
 eO_7                -4.105152e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114909e-01 1 1  ON 29
eH1_0                -2.647370e-01 1 1  ON 30
eH1_1                -1.593808e-01 1 1  ON 31
eH1_2                -1.099673e-01 1 1  ON 32
eH1_3                -5.441808e-02 1 1  ON 33
eH1_4                -4.021566e-03 1 1  ON 34
eH1_5                 3.291139e-02 1 1  ON 35
eH1_6                 9.579315e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995600e-01 1 1  ON 38
eH1_9                 1.031995e-01 1 1  ON 39
eH2_0                -2.607444e-01 1 1  ON 40
eH2_1                -1.556640e-01 1 1  ON 41
eH2_2                -1.064045e-01 1 1  ON 42
eH2_3                -5.105231e-02 1 1  ON 43
eH2_4                -8.978488e-04 1 1  ON 44
eH2_5                 3.478555e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601401e-01 1 1  ON 47
eH2_8                 2.005961e-01 1 1  ON 48
eH2_9                 9.330913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8089
    reference variance = 0.25421
====================================================
  Execution time = 2.0639e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3999e-01
  Total weights = 2.0000e+06
  Execution time = 1.8912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340141080053
                                         uncertainty =       0.004565255729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340141080053
                                         uncertainty =       0.004565255729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412306421
  error estimate for blocks of size 2^( 2) =       0.000425030597
  error estimate for blocks of size 2^( 3) =       0.000438324822
  error estimate for blocks of size 2^( 4) =       0.000450991996
  error estimate for blocks of size 2^( 5) =       0.000462023037
  error estimate for blocks of size 2^( 6) =       0.000469275617
  error estimate for blocks of size 2^( 7) =       0.000475083938

      target function =                  N/A
              le_mean =     -16.905602990100
             les_mean =     286.139405458445
             stat err =       0.000464343647
             autocorr =       1.268349143311
              std dev =       0.583089332414
             le_variance =       0.339993169575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340138287378
                                         uncertainty =       0.004565211523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340138287378
                                         uncertainty =       0.004565211523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412304729
  error estimate for blocks of size 2^( 2) =       0.000425029000
  error estimate for blocks of size 2^( 3) =       0.000438323338
  error estimate for blocks of size 2^( 4) =       0.000450990572
  error estimate for blocks of size 2^( 5) =       0.000462021672
  error estimate for blocks of size 2^( 6) =       0.000469274297
  error estimate for blocks of size 2^( 7) =       0.000475082585

      target function =                  N/A
              le_mean =     -16.905602976148
             les_mean =     286.139402196277
             stat err =       0.000464342282
             autocorr =       1.268352092843
              std dev =       0.583086939590
             le_variance =       0.339990379121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340139677052
                                         uncertainty =       0.004565233559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340139677052
                                         uncertainty =       0.004565233559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412305571
  error estimate for blocks of size 2^( 2) =       0.000425029795
  error estimate for blocks of size 2^( 3) =       0.000438324076
  error estimate for blocks of size 2^( 4) =       0.000450991280
  error estimate for blocks of size 2^( 5) =       0.000462022351
  error estimate for blocks of size 2^( 6) =       0.000469274954
  error estimate for blocks of size 2^( 7) =       0.000475083258

      target function =                  N/A
              le_mean =     -16.905602983099
             les_mean =     286.139403819853
             stat err =       0.000464342961
             autocorr =       1.268350624537
              std dev =       0.583088130294
             le_variance =       0.339991767689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340140904463
                                         uncertainty =       0.004565252956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340140904463
                                         uncertainty =       0.004565252956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412306315
  error estimate for blocks of size 2^( 2) =       0.000425030497
  error estimate for blocks of size 2^( 3) =       0.000438324729
  error estimate for blocks of size 2^( 4) =       0.000450991907
  error estimate for blocks of size 2^( 5) =       0.000462022951
  error estimate for blocks of size 2^( 6) =       0.000469275534
  error estimate for blocks of size 2^( 7) =       0.000475083853

      target function =                  N/A
              le_mean =     -16.905602989223
             les_mean =     286.139405253358
             stat err =       0.000464343561
             autocorr =       1.268349328671
              std dev =       0.583089181965
             le_variance =       0.339992994125


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905602990100        initial  <--
     5.9605e+01     5.9605e+02             4.3989e-06       -16.905602976148
     2.3842e+02     2.3842e+03             1.1001e-06       -16.905602983099
     9.5367e+02     9.5367e+03             2.7506e-07       -16.905602989223

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1716
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7126e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9366
    reference variance = 0.209433
====================================================
  Execution time = 2.1353e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3506e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335183457020
                                         uncertainty =       0.002406455213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335183457020
                                         uncertainty =       0.002406455213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409307227
  error estimate for blocks of size 2^( 2) =       0.000421944148
  error estimate for blocks of size 2^( 3) =       0.000434391966
  error estimate for blocks of size 2^( 4) =       0.000445506254
  error estimate for blocks of size 2^( 5) =       0.000454550321
  error estimate for blocks of size 2^( 6) =       0.000462243275
  error estimate for blocks of size 2^( 7) =       0.000464599908

      target function =                  N/A
              le_mean =     -16.906655429047
             les_mean =     286.170062440967
             stat err =       0.000456724940
             autocorr =       1.245118334983
              std dev =       0.578847831459
             le_variance =       0.335064811985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665542905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906655429047       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906655429424       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906655428637       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906655428494       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906655429799       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906655430239       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906655429831       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906655429724       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.335850e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906655429047       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906655429141       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906655428944       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906655428908       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906655429236       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906655429346       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906655429245       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906655429218       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 8.341409e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906655429047       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906655429070       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906655429021       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906655429020       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906655429092       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906655429121       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906655429099       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906655429101       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.085464e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7024e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235684e-02 1 1  ON 2
 uu_3                -2.053274e-02 1 1  ON 3
 uu_4                -6.678733e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319505e-01 1 1  ON 6
 uu_7                -1.471348e-01 1 1  ON 7
 uu_8                -1.402374e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883004e-01 1 1  ON 11
 ud_2                 6.735749e-02 1 1  ON 12
 ud_3                -4.335116e-03 1 1  ON 13
 ud_4                -6.202951e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540560e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394350e-02 1 1  ON 22
 eO_3                 3.032322e-01 1 1  ON 23
 eO_4                 5.308072e-01 1 1  ON 24
 eO_5                 4.941249e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105136e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114906e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099673e-01 1 1  ON 32
eH1_3                -5.441776e-02 1 1  ON 33
eH1_4                -4.021098e-03 1 1  ON 34
eH1_5                 3.291177e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600167e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105194e-02 1 1  ON 43
eH2_4                -8.975743e-04 1 1  ON 44
eH2_5                 3.478600e-02 1 1  ON 45
eH2_6                 9.773896e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330825e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9652
    reference variance = 0.43041
====================================================
  Execution time = 2.0695e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3251e-01
  Total weights = 2.0000e+06
  Execution time = 1.8847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332547546286
                                         uncertainty =       0.003586889980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332547546286
                                         uncertainty =       0.003586889980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407742568
  error estimate for blocks of size 2^( 2) =       0.000420770914
  error estimate for blocks of size 2^( 3) =       0.000433527867
  error estimate for blocks of size 2^( 4) =       0.000445248649
  error estimate for blocks of size 2^( 5) =       0.000454684702
  error estimate for blocks of size 2^( 6) =       0.000458693352
  error estimate for blocks of size 2^( 7) =       0.000462731426

      target function =                  N/A
              le_mean =     -16.906105137455
             les_mean =     286.148898755295
             stat err =       0.000455339532
             autocorr =       1.247092327132
              std dev =       0.576635069054
             le_variance =       0.332508002863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332547463599
                                         uncertainty =       0.003586890805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332547463599
                                         uncertainty =       0.003586890805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407742517
  error estimate for blocks of size 2^( 2) =       0.000420770865
  error estimate for blocks of size 2^( 3) =       0.000433527821
  error estimate for blocks of size 2^( 4) =       0.000445248606
  error estimate for blocks of size 2^( 5) =       0.000454684658
  error estimate for blocks of size 2^( 6) =       0.000458693310
  error estimate for blocks of size 2^( 7) =       0.000462731381

      target function =                  N/A
              le_mean =     -16.906105135523
             les_mean =     286.148898607216
             stat err =       0.000455339489
             autocorr =       1.247092399099
              std dev =       0.576634997316
             le_variance =       0.332507920130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332547504912
                                         uncertainty =       0.003586890393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332547504912
                                         uncertainty =       0.003586890393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407742542
  error estimate for blocks of size 2^( 2) =       0.000420770889
  error estimate for blocks of size 2^( 3) =       0.000433527844
  error estimate for blocks of size 2^( 4) =       0.000445248627
  error estimate for blocks of size 2^( 5) =       0.000454684680
  error estimate for blocks of size 2^( 6) =       0.000458693331
  error estimate for blocks of size 2^( 7) =       0.000462731403

      target function =                  N/A
              le_mean =     -16.906105136489
             les_mean =     286.148898681217
             stat err =       0.000455339510
             autocorr =       1.247092363141
              std dev =       0.576635033158
             le_variance =       0.332507961465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332547541114
                                         uncertainty =       0.003586890032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332547541114
                                         uncertainty =       0.003586890032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407742564
  error estimate for blocks of size 2^( 2) =       0.000420770911
  error estimate for blocks of size 2^( 3) =       0.000433527864
  error estimate for blocks of size 2^( 4) =       0.000445248646
  error estimate for blocks of size 2^( 5) =       0.000454684699
  error estimate for blocks of size 2^( 6) =       0.000458693350
  error estimate for blocks of size 2^( 7) =       0.000462731423

      target function =                  N/A
              le_mean =     -16.906105137334
             les_mean =     286.148898746033
             stat err =       0.000455339529
             autocorr =       1.247092331632
              std dev =       0.576635064566
             le_variance =       0.332507997687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906105137455        initial  <--
     5.9605e+02     5.9605e+03             3.3358e-07       -16.906105135523
     2.3842e+03     2.3842e+04             8.3414e-08       -16.906105136489
     9.5367e+03     9.5367e+04             2.0855e-08       -16.906105137334

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2156
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7247e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9939
    reference variance = 0.878059
====================================================
  Execution time = 2.1173e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4053e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340491324897
                                         uncertainty =       0.003843056361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340491324897
                                         uncertainty =       0.003843056361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412628953
  error estimate for blocks of size 2^( 2) =       0.000425674190
  error estimate for blocks of size 2^( 3) =       0.000439444011
  error estimate for blocks of size 2^( 4) =       0.000451448164
  error estimate for blocks of size 2^( 5) =       0.000462594773
  error estimate for blocks of size 2^( 6) =       0.000471197051
  error estimate for blocks of size 2^( 7) =       0.000475445257

      target function =                  N/A
              le_mean =     -16.906076946419
             les_mean =     286.155962853086
             stat err =       0.000465171311
             autocorr =       1.270885573556
              std dev =       0.583545461054
             le_variance =       0.340525305117


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607694642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906076946419       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906076946468       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906076946589       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906076946646       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906076946654       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906076946695       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906076946691       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906076946702       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.299924e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906076946419       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906076946431       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906076946461       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906076946489       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906076946479       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906076946492       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906076946471       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906076946476       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 8.249829e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906076946419       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906076946422       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906076946429       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906076946433       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906076946426       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906076946437       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906076946448       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906076946467       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.062458e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289139 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6856e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678729e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202957e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441773e-02 1 1  ON 33
eH1_4                -4.021068e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975680e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773894e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8789
    reference variance = 0.196503
====================================================
  Execution time = 2.2689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3334e-01
  Total weights = 2.0000e+06
  Execution time = 1.8855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333270979651
                                         uncertainty =       0.002575773366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333270979651
                                         uncertainty =       0.002575773366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408249653
  error estimate for blocks of size 2^( 2) =       0.000421297391
  error estimate for blocks of size 2^( 3) =       0.000434298062
  error estimate for blocks of size 2^( 4) =       0.000445766469
  error estimate for blocks of size 2^( 5) =       0.000456272759
  error estimate for blocks of size 2^( 6) =       0.000463066636
  error estimate for blocks of size 2^( 7) =       0.000467779929

      target function =                  N/A
              le_mean =     -16.906581773599
             les_mean =     286.165842658665
             stat err =       0.000458221448
             autocorr =       1.259792967059
              std dev =       0.577352195766
             le_variance =       0.333335557956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333270980089
                                         uncertainty =       0.002575773420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333270980089
                                         uncertainty =       0.002575773420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408249653
  error estimate for blocks of size 2^( 2) =       0.000421297391
  error estimate for blocks of size 2^( 3) =       0.000434298062
  error estimate for blocks of size 2^( 4) =       0.000445766469
  error estimate for blocks of size 2^( 5) =       0.000456272759
  error estimate for blocks of size 2^( 6) =       0.000463066637
  error estimate for blocks of size 2^( 7) =       0.000467779929

      target function =                  N/A
              le_mean =     -16.906581773590
             les_mean =     286.165842658838
             stat err =       0.000458221449
             autocorr =       1.259792966227
              std dev =       0.577352196160
             le_variance =       0.333335558410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333270979870
                                         uncertainty =       0.002575773393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333270979870
                                         uncertainty =       0.002575773393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408249653
  error estimate for blocks of size 2^( 2) =       0.000421297391
  error estimate for blocks of size 2^( 3) =       0.000434298062
  error estimate for blocks of size 2^( 4) =       0.000445766469
  error estimate for blocks of size 2^( 5) =       0.000456272759
  error estimate for blocks of size 2^( 6) =       0.000463066636
  error estimate for blocks of size 2^( 7) =       0.000467779929

      target function =                  N/A
              le_mean =     -16.906581773594
             les_mean =     286.165842658751
             stat err =       0.000458221448
             autocorr =       1.259792966640
              std dev =       0.577352195963
             le_variance =       0.333335558183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333270979678
                                         uncertainty =       0.002575773369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333270979678
                                         uncertainty =       0.002575773369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408249653
  error estimate for blocks of size 2^( 2) =       0.000421297391
  error estimate for blocks of size 2^( 3) =       0.000434298062
  error estimate for blocks of size 2^( 4) =       0.000445766469
  error estimate for blocks of size 2^( 5) =       0.000456272759
  error estimate for blocks of size 2^( 6) =       0.000463066636
  error estimate for blocks of size 2^( 7) =       0.000467779929

      target function =                  N/A
              le_mean =     -16.906581773598
             les_mean =     286.165842658676
             stat err =       0.000458221448
             autocorr =       1.259792967006
              std dev =       0.577352195791
             le_variance =       0.333335557984


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906581773599        initial  <--
     5.9605e+03     5.9605e+04             3.2999e-08       -16.906581773590
     2.3842e+04     2.3842e+05             8.2498e-09       -16.906581773594
     9.5367e+04     9.5367e+05             2.0625e-09       -16.906581773598

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2091
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9073e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9905
    reference variance = 0.30962
====================================================
  Execution time = 2.1192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.6665e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366424493616
                                         uncertainty =       0.023034687469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366424493616
                                         uncertainty =       0.023034687469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428167601
  error estimate for blocks of size 2^( 2) =       0.000440695464
  error estimate for blocks of size 2^( 3) =       0.000453148306
  error estimate for blocks of size 2^( 4) =       0.000465447560
  error estimate for blocks of size 2^( 5) =       0.000475499621
  error estimate for blocks of size 2^( 6) =       0.000485254586
  error estimate for blocks of size 2^( 7) =       0.000492319601

      target function =                  N/A
              le_mean =     -16.905480152902
             les_mean =     286.161914006574
             stat err =       0.000479630342
             autocorr =       1.254832316930
              std dev =       0.605520428831
             le_variance =       0.366654989732


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690548015290e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905480152902       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905480152909       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905480152914       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905480152918       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905480152934       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905480152933       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905480152965       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.549693e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905480152902       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905480152904       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905480152905       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905480152906       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905480152908       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905480152996       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905480152902       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 8.874241e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905480152902       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905480152903       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905480152903       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905480153052       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905480152709       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905480153404       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905480150887       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.218563e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291383 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6987e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678729e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975631e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.7436
    reference variance = 0.674766
====================================================
  Execution time = 2.0747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4932e-01
  Total weights = 2.0000e+06
  Execution time = 1.8939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349272401730
                                         uncertainty =       0.011428625769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349272401730
                                         uncertainty =       0.011428625769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417922239
  error estimate for blocks of size 2^( 2) =       0.000430017964
  error estimate for blocks of size 2^( 3) =       0.000442885580
  error estimate for blocks of size 2^( 4) =       0.000454379493
  error estimate for blocks of size 2^( 5) =       0.000465404572
  error estimate for blocks of size 2^( 6) =       0.000471857898
  error estimate for blocks of size 2^( 7) =       0.000477440662

      target function =                  N/A
              le_mean =     -16.906356346323
             les_mean =     286.174202730457
             stat err =       0.000467270656
             autocorr =       1.250103735314
              std dev =       0.591031298884
             le_variance =       0.349317996260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349272404153
                                         uncertainty =       0.011428625852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349272404153
                                         uncertainty =       0.011428625852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417922241
  error estimate for blocks of size 2^( 2) =       0.000430017965
  error estimate for blocks of size 2^( 3) =       0.000442885581
  error estimate for blocks of size 2^( 4) =       0.000454379494
  error estimate for blocks of size 2^( 5) =       0.000465404573
  error estimate for blocks of size 2^( 6) =       0.000471857899
  error estimate for blocks of size 2^( 7) =       0.000477440663

      target function =                  N/A
              le_mean =     -16.906356346315
             les_mean =     286.174202732596
             stat err =       0.000467270657
             autocorr =       1.250103733103
              std dev =       0.591031300934
             le_variance =       0.349317998683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349272402941
                                         uncertainty =       0.011428625811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349272402941
                                         uncertainty =       0.011428625811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417922240
  error estimate for blocks of size 2^( 2) =       0.000430017964
  error estimate for blocks of size 2^( 3) =       0.000442885581
  error estimate for blocks of size 2^( 4) =       0.000454379494
  error estimate for blocks of size 2^( 5) =       0.000465404572
  error estimate for blocks of size 2^( 6) =       0.000471857898
  error estimate for blocks of size 2^( 7) =       0.000477440662

      target function =                  N/A
              le_mean =     -16.906356346319
             les_mean =     286.174202731527
             stat err =       0.000467270657
             autocorr =       1.250103734210
              std dev =       0.591031299909
             le_variance =       0.349317997472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349272401881
                                         uncertainty =       0.011428625774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349272401881
                                         uncertainty =       0.011428625774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417922239
  error estimate for blocks of size 2^( 2) =       0.000430017964
  error estimate for blocks of size 2^( 3) =       0.000442885580
  error estimate for blocks of size 2^( 4) =       0.000454379493
  error estimate for blocks of size 2^( 5) =       0.000465404572
  error estimate for blocks of size 2^( 6) =       0.000471857898
  error estimate for blocks of size 2^( 7) =       0.000477440662

      target function =                  N/A
              le_mean =     -16.906356346322
             les_mean =     286.174202730591
             stat err =       0.000467270656
             autocorr =       1.250103735180
              std dev =       0.591031299012
             le_variance =       0.349317996412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906356346323        initial  <--
     5.9605e+04     5.9605e+05             3.5497e-09       -16.906356346315
     2.3842e+05     2.3842e+06             8.8742e-10       -16.906356346319
     9.5367e+05     9.5367e+06             2.2186e-10       -16.906356346322

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3092
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7304e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8902
    reference variance = 0.234556
====================================================
  Execution time = 2.1097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3754e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6026e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337458465643
                                         uncertainty =       0.003404176013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337458465643
                                         uncertainty =       0.003404176013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410818273
  error estimate for blocks of size 2^( 2) =       0.000423356854
  error estimate for blocks of size 2^( 3) =       0.000436138278
  error estimate for blocks of size 2^( 4) =       0.000447285843
  error estimate for blocks of size 2^( 5) =       0.000457467461
  error estimate for blocks of size 2^( 6) =       0.000464219498
  error estimate for blocks of size 2^( 7) =       0.000470746363

      target function =                  N/A
              le_mean =     -16.906382470316
             les_mean =     286.163311371489
             stat err =       0.000459929791
             autocorr =       1.253382354664
              std dev =       0.580984774025
             le_variance =       0.337543307648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690638247032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906382470316       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906382470318       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906382470319       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906382470918       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906382470109       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906382471027       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906382470055       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.144558e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906382470316       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906382470317       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906382470317       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906382470115       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906382470003       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906382468741       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906382470633       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.036131e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906382470316       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906382470316       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906382470316       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906382472598       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906382467053       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906382469566       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906382472993       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.590337e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6706e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8708
    reference variance = 0.177815
====================================================
  Execution time = 2.0587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.8573e-01
  Total weights = 2.0000e+06
  Execution time = 1.8804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385745907700
                                         uncertainty =       0.031279031970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385745907700
                                         uncertainty =       0.031279031970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439163453
  error estimate for blocks of size 2^( 2) =       0.000451093584
  error estimate for blocks of size 2^( 3) =       0.000463290775
  error estimate for blocks of size 2^( 4) =       0.000474365134
  error estimate for blocks of size 2^( 5) =       0.000484517824
  error estimate for blocks of size 2^( 6) =       0.000492008724
  error estimate for blocks of size 2^( 7) =       0.000488997495

      target function =                  N/A
              le_mean =     -16.905978530908
             les_mean =     286.197838971366
             stat err =       0.000484972294
             autocorr =       1.219499075752
              std dev =       0.621070911167
             le_variance =       0.385729076698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385745907609
                                         uncertainty =       0.031279031953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385745907609
                                         uncertainty =       0.031279031953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439163453
  error estimate for blocks of size 2^( 2) =       0.000451093584
  error estimate for blocks of size 2^( 3) =       0.000463290775
  error estimate for blocks of size 2^( 4) =       0.000474365134
  error estimate for blocks of size 2^( 5) =       0.000484517824
  error estimate for blocks of size 2^( 6) =       0.000492008724
  error estimate for blocks of size 2^( 7) =       0.000488997495

      target function =                  N/A
              le_mean =     -16.905978530906
             les_mean =     286.197838971188
             stat err =       0.000484972294
             autocorr =       1.219499075818
              std dev =       0.621070911094
             le_variance =       0.385729076607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385745907654
                                         uncertainty =       0.031279031962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385745907654
                                         uncertainty =       0.031279031962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439163453
  error estimate for blocks of size 2^( 2) =       0.000451093584
  error estimate for blocks of size 2^( 3) =       0.000463290775
  error estimate for blocks of size 2^( 4) =       0.000474365134
  error estimate for blocks of size 2^( 5) =       0.000484517824
  error estimate for blocks of size 2^( 6) =       0.000492008724
  error estimate for blocks of size 2^( 7) =       0.000488997495

      target function =                  N/A
              le_mean =     -16.905978530907
             les_mean =     286.197838971277
             stat err =       0.000484972294
             autocorr =       1.219499075784
              std dev =       0.621070911131
             le_variance =       0.385729076653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385745907694
                                         uncertainty =       0.031279031969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385745907694
                                         uncertainty =       0.031279031969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439163453
  error estimate for blocks of size 2^( 2) =       0.000451093584
  error estimate for blocks of size 2^( 3) =       0.000463290775
  error estimate for blocks of size 2^( 4) =       0.000474365134
  error estimate for blocks of size 2^( 5) =       0.000484517824
  error estimate for blocks of size 2^( 6) =       0.000492008724
  error estimate for blocks of size 2^( 7) =       0.000488997495

      target function =                  N/A
              le_mean =     -16.905978530908
             les_mean =     286.197838971354
             stat err =       0.000484972294
             autocorr =       1.219499075755
              std dev =       0.621070911163
             le_variance =       0.385729076692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905978530908        initial  <--
     5.9605e+05     5.9605e+06             4.1446e-10       -16.905978530906
     2.3842e+06     2.3842e+07             1.0361e-10       -16.905978530907
     9.5367e+06     9.5367e+07             2.5903e-11       -16.905978530908

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0821
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6796e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.6573
    reference variance = 3.94997
====================================================
  Execution time = 2.1040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3604e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335758207708
                                         uncertainty =       0.002959010074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335758207708
                                         uncertainty =       0.002959010074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409904841
  error estimate for blocks of size 2^( 2) =       0.000422854762
  error estimate for blocks of size 2^( 3) =       0.000435882706
  error estimate for blocks of size 2^( 4) =       0.000448166812
  error estimate for blocks of size 2^( 5) =       0.000457666783
  error estimate for blocks of size 2^( 6) =       0.000464376385
  error estimate for blocks of size 2^( 7) =       0.000469802704

      target function =                  N/A
              le_mean =     -16.906308630019
             les_mean =     286.159315282254
             stat err =       0.000460003171
             autocorr =       1.259376418641
              std dev =       0.579692984967
             le_variance =       0.336043956820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630863002e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906308630019       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906308630019       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906308630019       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906308627762       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906308628746       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906308625775       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906308633540       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 2.677130e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906308630019       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906308630019       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906308630019       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906308630019       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906308638520       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906308630019       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906308633048       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 6.692465e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906308630019       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906308630019       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906308630019       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906308657080       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906308679959       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906308467517       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906308693806       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 1.673217e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6731e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9675
    reference variance = 0.261711
====================================================
  Execution time = 2.0766e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4153e-01
  Total weights = 2.0000e+06
  Execution time = 1.8837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341347211528
                                         uncertainty =       0.004300382529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341347211528
                                         uncertainty =       0.004300382529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413235264
  error estimate for blocks of size 2^( 2) =       0.000426310886
  error estimate for blocks of size 2^( 3) =       0.000439151580
  error estimate for blocks of size 2^( 4) =       0.000451812417
  error estimate for blocks of size 2^( 5) =       0.000464392086
  error estimate for blocks of size 2^( 6) =       0.000474018131
  error estimate for blocks of size 2^( 7) =       0.000477297719

      target function =                  N/A
              le_mean =     -16.906229627391
             les_mean =     286.162126809670
             stat err =       0.000466880088
             autocorr =       1.276485700249
              std dev =       0.584402914396
             le_variance =       0.341526766355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341347211533
                                         uncertainty =       0.004300382530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341347211533
                                         uncertainty =       0.004300382530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413235264
  error estimate for blocks of size 2^( 2) =       0.000426310886
  error estimate for blocks of size 2^( 3) =       0.000439151580
  error estimate for blocks of size 2^( 4) =       0.000451812417
  error estimate for blocks of size 2^( 5) =       0.000464392086
  error estimate for blocks of size 2^( 6) =       0.000474018131
  error estimate for blocks of size 2^( 7) =       0.000477297719

      target function =                  N/A
              le_mean =     -16.906229627391
             les_mean =     286.162126809676
             stat err =       0.000466880088
             autocorr =       1.276485700239
              std dev =       0.584402914401
             le_variance =       0.341526766360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341347211531
                                         uncertainty =       0.004300382530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341347211531
                                         uncertainty =       0.004300382530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413235264
  error estimate for blocks of size 2^( 2) =       0.000426310886
  error estimate for blocks of size 2^( 3) =       0.000439151580
  error estimate for blocks of size 2^( 4) =       0.000451812417
  error estimate for blocks of size 2^( 5) =       0.000464392086
  error estimate for blocks of size 2^( 6) =       0.000474018131
  error estimate for blocks of size 2^( 7) =       0.000477297719

      target function =                  N/A
              le_mean =     -16.906229627391
             les_mean =     286.162126809673
             stat err =       0.000466880088
             autocorr =       1.276485700251
              std dev =       0.584402914398
             le_variance =       0.341526766357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341347211529
                                         uncertainty =       0.004300382529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341347211529
                                         uncertainty =       0.004300382529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413235264
  error estimate for blocks of size 2^( 2) =       0.000426310886
  error estimate for blocks of size 2^( 3) =       0.000439151580
  error estimate for blocks of size 2^( 4) =       0.000451812417
  error estimate for blocks of size 2^( 5) =       0.000464392086
  error estimate for blocks of size 2^( 6) =       0.000474018131
  error estimate for blocks of size 2^( 7) =       0.000477297719

      target function =                  N/A
              le_mean =     -16.906229627391
             les_mean =     286.162126809670
             stat err =       0.000466880088
             autocorr =       1.276485700246
              std dev =       0.584402914397
             le_variance =       0.341526766355


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906229627391        initial
     5.9605e+06     5.9605e+07             2.6771e-11       -16.906229627391  <--
     2.3842e+07     2.3842e+08             6.6925e-12       -16.906229627391
     9.5367e+07     9.5367e+08             1.6732e-12       -16.906229627391

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 3.0285e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7027e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8556
    reference variance = 0.183329
====================================================
  Execution time = 2.1038e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3887e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338933748119
                                         uncertainty =       0.003464664459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338933748119
                                         uncertainty =       0.003464664459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411622999
  error estimate for blocks of size 2^( 2) =       0.000424584669
  error estimate for blocks of size 2^( 3) =       0.000438006435
  error estimate for blocks of size 2^( 4) =       0.000450326756
  error estimate for blocks of size 2^( 5) =       0.000460332371
  error estimate for blocks of size 2^( 6) =       0.000468749131
  error estimate for blocks of size 2^( 7) =       0.000478871140

      target function =                  N/A
              le_mean =     -16.906895378754
             les_mean =     286.181978165022
             stat err =       0.000464569850
             autocorr =       1.273804494977
              std dev =       0.582122827536
             le_variance =       0.338866986338


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690689537875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906895378754       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906895378754       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906895378754       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906895378754       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906895378246       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906895378976       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906895378911       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.028630e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906895378754       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906895378754       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906895378754       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906895378756       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906895382100       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906895378590       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906895378417       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 2.571573e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906895378754       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906895378754       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906895378754       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906895378754       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906895377818       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906895380934       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906895368463       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 6.428949e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.298020 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6684e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9612
    reference variance = 0.757559
====================================================
  Execution time = 2.0649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3899e-01
  Total weights = 2.0000e+06
  Execution time = 1.8771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338980873805
                                         uncertainty =       0.005154242727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338980873805
                                         uncertainty =       0.005154242727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411700657
  error estimate for blocks of size 2^( 2) =       0.000424392472
  error estimate for blocks of size 2^( 3) =       0.000438157994
  error estimate for blocks of size 2^( 4) =       0.000450549755
  error estimate for blocks of size 2^( 5) =       0.000462931011
  error estimate for blocks of size 2^( 6) =       0.000470430949
  error estimate for blocks of size 2^( 7) =       0.000476712715

      target function =                  N/A
              le_mean =     -16.906595475130
             les_mean =     286.171965251802
             stat err =       0.000465156107
             autocorr =       1.276539727908
              std dev =       0.582232652481
             le_variance =       0.338994861615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338980873831
                                         uncertainty =       0.005154242728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338980873831
                                         uncertainty =       0.005154242728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411700657
  error estimate for blocks of size 2^( 2) =       0.000424392472
  error estimate for blocks of size 2^( 3) =       0.000438157994
  error estimate for blocks of size 2^( 4) =       0.000450549755
  error estimate for blocks of size 2^( 5) =       0.000462931011
  error estimate for blocks of size 2^( 6) =       0.000470430949
  error estimate for blocks of size 2^( 7) =       0.000476712715

      target function =                  N/A
              le_mean =     -16.906595475130
             les_mean =     286.171965251824
             stat err =       0.000465156107
             autocorr =       1.276539727876
              std dev =       0.582232652504
             le_variance =       0.338994861642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338980873818
                                         uncertainty =       0.005154242727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338980873818
                                         uncertainty =       0.005154242727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411700657
  error estimate for blocks of size 2^( 2) =       0.000424392472
  error estimate for blocks of size 2^( 3) =       0.000438157994
  error estimate for blocks of size 2^( 4) =       0.000450549755
  error estimate for blocks of size 2^( 5) =       0.000462931011
  error estimate for blocks of size 2^( 6) =       0.000470430949
  error estimate for blocks of size 2^( 7) =       0.000476712715

      target function =                  N/A
              le_mean =     -16.906595475130
             les_mean =     286.171965251813
             stat err =       0.000465156107
             autocorr =       1.276539727890
              std dev =       0.582232652492
             le_variance =       0.338994861628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338980873806
                                         uncertainty =       0.005154242727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338980873806
                                         uncertainty =       0.005154242727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411700657
  error estimate for blocks of size 2^( 2) =       0.000424392472
  error estimate for blocks of size 2^( 3) =       0.000438157994
  error estimate for blocks of size 2^( 4) =       0.000450549755
  error estimate for blocks of size 2^( 5) =       0.000462931011
  error estimate for blocks of size 2^( 6) =       0.000470430949
  error estimate for blocks of size 2^( 7) =       0.000476712715

      target function =                  N/A
              le_mean =     -16.906595475130
             les_mean =     286.171965251803
             stat err =       0.000465156107
             autocorr =       1.276539727903
              std dev =       0.582232652482
             le_variance =       0.338994861617


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906595475130        initial  <--
     1.4901e+06     1.4901e+07             1.0286e-10       -16.906595475130
     5.9605e+06     5.9605e+07             2.5716e-11       -16.906595475130
     2.3842e+07     2.3842e+08             6.4289e-12       -16.906595475130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1189
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6810e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8422
    reference variance = 0.186559
====================================================
  Execution time = 2.0844e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3941e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339503488448
                                         uncertainty =       0.005404168772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339503488448
                                         uncertainty =       0.005404168772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411955770
  error estimate for blocks of size 2^( 2) =       0.000424221534
  error estimate for blocks of size 2^( 3) =       0.000437518069
  error estimate for blocks of size 2^( 4) =       0.000449371806
  error estimate for blocks of size 2^( 5) =       0.000460490430
  error estimate for blocks of size 2^( 6) =       0.000471952670
  error estimate for blocks of size 2^( 7) =       0.000477414331

      target function =                  N/A
              le_mean =     -16.905845614517
             les_mean =     286.147030885205
             stat err =       0.000464807309
             autocorr =       1.273047819686
              std dev =       0.582593437162
             le_variance =       0.339415113025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690584561452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905845614517       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905845614517       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905845614517       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905845613763       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905845614878       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905845629607       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905845612960       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.211248e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905845614517       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905845614517       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905845614517       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905845614517       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905845591259       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905845614573       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905845647016       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 3.028013e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905845614517       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905845614517       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905845614517       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905845514201       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905845614348       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905845585703       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905845680579       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 7.568687e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300246 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6521e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8875
    reference variance = 0.21145
====================================================
  Execution time = 2.2817e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4784e-01
  Total weights = 2.0000e+06
  Execution time = 1.8826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347786261274
                                         uncertainty =       0.012353254193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347786261274
                                         uncertainty =       0.012353254193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417037012
  error estimate for blocks of size 2^( 2) =       0.000429440725
  error estimate for blocks of size 2^( 3) =       0.000442370565
  error estimate for blocks of size 2^( 4) =       0.000454542438
  error estimate for blocks of size 2^( 5) =       0.000464782548
  error estimate for blocks of size 2^( 6) =       0.000472769350
  error estimate for blocks of size 2^( 7) =       0.000477432133

      target function =                  N/A
              le_mean =     -16.905612975512
             les_mean =     286.147589641926
             stat err =       0.000467381617
             autocorr =       1.256012766966
              std dev =       0.589779397782
             le_variance =       0.347839738048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347786261282
                                         uncertainty =       0.012353254193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347786261282
                                         uncertainty =       0.012353254193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417037012
  error estimate for blocks of size 2^( 2) =       0.000429440725
  error estimate for blocks of size 2^( 3) =       0.000442370565
  error estimate for blocks of size 2^( 4) =       0.000454542438
  error estimate for blocks of size 2^( 5) =       0.000464782548
  error estimate for blocks of size 2^( 6) =       0.000472769350
  error estimate for blocks of size 2^( 7) =       0.000477432133

      target function =                  N/A
              le_mean =     -16.905612975512
             les_mean =     286.147589641934
             stat err =       0.000467381617
             autocorr =       1.256012766967
              std dev =       0.589779397789
             le_variance =       0.347839738056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347786261278
                                         uncertainty =       0.012353254193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347786261278
                                         uncertainty =       0.012353254193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417037012
  error estimate for blocks of size 2^( 2) =       0.000429440725
  error estimate for blocks of size 2^( 3) =       0.000442370565
  error estimate for blocks of size 2^( 4) =       0.000454542438
  error estimate for blocks of size 2^( 5) =       0.000464782548
  error estimate for blocks of size 2^( 6) =       0.000472769350
  error estimate for blocks of size 2^( 7) =       0.000477432133

      target function =                  N/A
              le_mean =     -16.905612975512
             les_mean =     286.147589641930
             stat err =       0.000467381617
             autocorr =       1.256012766967
              std dev =       0.589779397786
             le_variance =       0.347839738052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347786261274
                                         uncertainty =       0.012353254193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347786261274
                                         uncertainty =       0.012353254193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417037012
  error estimate for blocks of size 2^( 2) =       0.000429440725
  error estimate for blocks of size 2^( 3) =       0.000442370565
  error estimate for blocks of size 2^( 4) =       0.000454542438
  error estimate for blocks of size 2^( 5) =       0.000464782548
  error estimate for blocks of size 2^( 6) =       0.000472769350
  error estimate for blocks of size 2^( 7) =       0.000477432133

      target function =                  N/A
              le_mean =     -16.905612975512
             les_mean =     286.147589641927
             stat err =       0.000467381617
             autocorr =       1.256012766962
              std dev =       0.589779397783
             le_variance =       0.347839738049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905612975512        initial  <--
     1.4901e+07     1.4901e+08             1.2112e-11       -16.905612975512
     5.9605e+07     5.9605e+08             3.0280e-12       -16.905612975512
     2.3842e+08     2.3842e+09             7.5687e-13       -16.905612975512

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.3229
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8851e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.7965
    reference variance = 0.220373
====================================================
  Execution time = 2.1272e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3940e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339485991231
                                         uncertainty =       0.003966669194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339485991231
                                         uncertainty =       0.003966669194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411944815
  error estimate for blocks of size 2^( 2) =       0.000424791068
  error estimate for blocks of size 2^( 3) =       0.000438432479
  error estimate for blocks of size 2^( 4) =       0.000451833500
  error estimate for blocks of size 2^( 5) =       0.000463660970
  error estimate for blocks of size 2^( 6) =       0.000476583349
  error estimate for blocks of size 2^( 7) =       0.000482877059

      target function =                  N/A
              le_mean =     -16.906145122398
             les_mean =     286.157139791655
             stat err =       0.000468738719
             autocorr =       1.294743012817
              std dev =       0.582577944795
             le_variance =       0.339397061761


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614512240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906145122398       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906145122398       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906145122398       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906145117448       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906145163576       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906144997990       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906145120400       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906145256861       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 1.387363e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906145122398       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906145122398       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906145122398       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906145122398       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906145127948       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906144573288       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906142423831       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906145099937       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+08 is 3.452180e-13

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906145122398       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906145122398       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906145122398       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906145582494       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906145127357       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906144442651       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906144351165       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906145716677       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 8.657659e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6939e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8268
    reference variance = 0.444397
====================================================
  Execution time = 2.0866e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4002e-01
  Total weights = 2.0000e+06
  Execution time = 1.8940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339971470504
                                         uncertainty =       0.004404444733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339971470504
                                         uncertainty =       0.004404444733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412322625
  error estimate for blocks of size 2^( 2) =       0.000425248264
  error estimate for blocks of size 2^( 3) =       0.000438740290
  error estimate for blocks of size 2^( 4) =       0.000450172191
  error estimate for blocks of size 2^( 5) =       0.000461003082
  error estimate for blocks of size 2^( 6) =       0.000470157962
  error estimate for blocks of size 2^( 7) =       0.000473780729

      target function =                  N/A
              le_mean =     -16.905997534367
             les_mean =     286.152772356104
             stat err =       0.000463778491
             autocorr =       1.265164142388
              std dev =       0.583112248263
             le_variance =       0.340019894074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339971470505
                                         uncertainty =       0.004404444733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339971470505
                                         uncertainty =       0.004404444733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412322625
  error estimate for blocks of size 2^( 2) =       0.000425248264
  error estimate for blocks of size 2^( 3) =       0.000438740290
  error estimate for blocks of size 2^( 4) =       0.000450172191
  error estimate for blocks of size 2^( 5) =       0.000461003082
  error estimate for blocks of size 2^( 6) =       0.000470157962
  error estimate for blocks of size 2^( 7) =       0.000473780729

      target function =                  N/A
              le_mean =     -16.905997534367
             les_mean =     286.152772356105
             stat err =       0.000463778491
             autocorr =       1.265164142389
              std dev =       0.583112248264
             le_variance =       0.340019894075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339971470505
                                         uncertainty =       0.004404444733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339971470505
                                         uncertainty =       0.004404444733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412322625
  error estimate for blocks of size 2^( 2) =       0.000425248264
  error estimate for blocks of size 2^( 3) =       0.000438740290
  error estimate for blocks of size 2^( 4) =       0.000450172191
  error estimate for blocks of size 2^( 5) =       0.000461003082
  error estimate for blocks of size 2^( 6) =       0.000470157962
  error estimate for blocks of size 2^( 7) =       0.000473780729

      target function =                  N/A
              le_mean =     -16.905997534367
             les_mean =     286.152772356104
             stat err =       0.000463778491
             autocorr =       1.265164142396
              std dev =       0.583112248263
             le_variance =       0.340019894075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339971470504
                                         uncertainty =       0.004404444733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339971470504
                                         uncertainty =       0.004404444733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412322625
  error estimate for blocks of size 2^( 2) =       0.000425248264
  error estimate for blocks of size 2^( 3) =       0.000438740290
  error estimate for blocks of size 2^( 4) =       0.000450172191
  error estimate for blocks of size 2^( 5) =       0.000461003082
  error estimate for blocks of size 2^( 6) =       0.000470157962
  error estimate for blocks of size 2^( 7) =       0.000473780729

      target function =                  N/A
              le_mean =     -16.905997534367
             les_mean =     286.152772356104
             stat err =       0.000463778491
             autocorr =       1.265164142386
              std dev =       0.583112248263
             le_variance =       0.340019894074


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905997534367        initial
     1.4901e+08     1.4901e+09             1.3874e-12       -16.905997534367
     5.9605e+08     5.9605e+09             3.4522e-13       -16.905997534367  <--
     2.3842e+09     2.3842e+10             8.6577e-14       -16.905997534367

*****************************************************************************
Applying the update for shift_i =   5.9605e+08     and shift_s =   5.9605e+09
*****************************************************************************

  Execution time = 3.0434e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7382e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9454
    reference variance = 0.257588
====================================================
  Execution time = 2.0956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3523e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335326135937
                                         uncertainty =       0.003963096075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335326135937
                                         uncertainty =       0.003963096075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409408661
  error estimate for blocks of size 2^( 2) =       0.000422057573
  error estimate for blocks of size 2^( 3) =       0.000435458856
  error estimate for blocks of size 2^( 4) =       0.000447418100
  error estimate for blocks of size 2^( 5) =       0.000458445862
  error estimate for blocks of size 2^( 6) =       0.000463785860
  error estimate for blocks of size 2^( 7) =       0.000468471377

      target function =                  N/A
              le_mean =     -16.905812428809
             les_mean =     286.141724614465
             stat err =       0.000459530300
             autocorr =       1.259836691585
              std dev =       0.578991281449
             le_variance =       0.335230903993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581242881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905812428809       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905812428809       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905812428809       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905812428809       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905812408656       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905812470890       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905812394899       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905812564101       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 1.287316e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905812428809       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905812428809       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905812428809       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905812428809       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905812428809       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905812260201       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905811983965       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905812772220       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+08 is 3.217254e-13

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905812428809       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905812428809       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905812428809       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905812428809       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905812427562       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905812348295       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905811998716       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905815329078       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 8.021903e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305459 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6577e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9523
    reference variance = 0.353383
====================================================
  Execution time = 2.0959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4477e-01
  Total weights = 2.0000e+06
  Execution time = 1.8844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344863122215
                                         uncertainty =       0.008268594724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344863122215
                                         uncertainty =       0.008268594724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415193079
  error estimate for blocks of size 2^( 2) =       0.000427174212
  error estimate for blocks of size 2^( 3) =       0.000440037833
  error estimate for blocks of size 2^( 4) =       0.000451603768
  error estimate for blocks of size 2^( 5) =       0.000461300411
  error estimate for blocks of size 2^( 6) =       0.000468150492
  error estimate for blocks of size 2^( 7) =       0.000472940562

      target function =                  N/A
              le_mean =     -16.906939153466
             les_mean =     286.189361952987
             stat err =       0.000463498808
             autocorr =       1.246226644298
              std dev =       0.587171683884
             le_variance =       0.344770586355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344863122216
                                         uncertainty =       0.008268594724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344863122216
                                         uncertainty =       0.008268594724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415193079
  error estimate for blocks of size 2^( 2) =       0.000427174212
  error estimate for blocks of size 2^( 3) =       0.000440037833
  error estimate for blocks of size 2^( 4) =       0.000451603768
  error estimate for blocks of size 2^( 5) =       0.000461300411
  error estimate for blocks of size 2^( 6) =       0.000468150492
  error estimate for blocks of size 2^( 7) =       0.000472940562

      target function =                  N/A
              le_mean =     -16.906939153466
             les_mean =     286.189361952987
             stat err =       0.000463498808
             autocorr =       1.246226644300
              std dev =       0.587171683884
             le_variance =       0.344770586355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344863122215
                                         uncertainty =       0.008268594724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344863122215
                                         uncertainty =       0.008268594724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415193079
  error estimate for blocks of size 2^( 2) =       0.000427174212
  error estimate for blocks of size 2^( 3) =       0.000440037833
  error estimate for blocks of size 2^( 4) =       0.000451603768
  error estimate for blocks of size 2^( 5) =       0.000461300411
  error estimate for blocks of size 2^( 6) =       0.000468150492
  error estimate for blocks of size 2^( 7) =       0.000472940562

      target function =                  N/A
              le_mean =     -16.906939153466
             les_mean =     286.189361952987
             stat err =       0.000463498808
             autocorr =       1.246226644291
              std dev =       0.587171683884
             le_variance =       0.344770586355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344863122215
                                         uncertainty =       0.008268594724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344863122215
                                         uncertainty =       0.008268594724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415193079
  error estimate for blocks of size 2^( 2) =       0.000427174212
  error estimate for blocks of size 2^( 3) =       0.000440037833
  error estimate for blocks of size 2^( 4) =       0.000451603768
  error estimate for blocks of size 2^( 5) =       0.000461300411
  error estimate for blocks of size 2^( 6) =       0.000468150492
  error estimate for blocks of size 2^( 7) =       0.000472940562

      target function =                  N/A
              le_mean =     -16.906939153466
             les_mean =     286.189361952987
             stat err =       0.000463498808
             autocorr =       1.246226644295
              std dev =       0.587171683884
             le_variance =       0.344770586355


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906939153466        initial  <--
     1.4901e+08     1.4901e+09             1.2873e-12       -16.906939153466
     5.9605e+08     5.9605e+09             3.2173e-13       -16.906939153466
     2.3842e+09     2.3842e+10             8.0219e-14       -16.906939153466

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4757
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7060e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9448
    reference variance = 0.330016
====================================================
  Execution time = 2.0983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4174e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341733672046
                                         uncertainty =       0.004802948821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341733672046
                                         uncertainty =       0.004802948821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413363807
  error estimate for blocks of size 2^( 2) =       0.000425668752
  error estimate for blocks of size 2^( 3) =       0.000438507629
  error estimate for blocks of size 2^( 4) =       0.000450238606
  error estimate for blocks of size 2^( 5) =       0.000460409405
  error estimate for blocks of size 2^( 6) =       0.000468046892
  error estimate for blocks of size 2^( 7) =       0.000472177063

      target function =                  N/A
              le_mean =     -16.906602843063
             les_mean =     286.174958796004
             stat err =       0.000462717991
             autocorr =       1.253048483964
              std dev =       0.584584701990
             le_variance =       0.341739273801


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660284306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906602843063       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906602843063       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906602843063       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906602848577       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906602907784       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906603856218       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906604447137       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906602646949       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 1.134254e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906602843063       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906602843063       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906602843063       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906602843063       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906602843063       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906598589876       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906600791138       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906603623616       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+09 is 2.818188e-14

solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906602843063       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906602843063       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906602843063       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906602843063       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906608014245       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906598100966       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906607804314       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906592475520       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906612233976       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906623501571       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906618320407       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906506421421       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906624113426       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906562490645       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906587749700       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907104083177       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909062605383       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906256283873       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907144668777       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905959951181       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.903719505978       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.904707007687       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.907840211676       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905527070278       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903424564777       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.908158492889       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905983681491       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906341641086       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.908936308489       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.907400173559       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.905858488854       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.908024002329       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.905637520011       residual = 1.74e-04           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.903180151954       residual = 1.39e-03           smallest_sin_value = 9.94e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+10 is 6.815625e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.352711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6561e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8468
    reference variance = 0.209668
====================================================
  Execution time = 2.0652e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4367e-01
  Total weights = 2.0000e+06
  Execution time = 1.8906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343646209404
                                         uncertainty =       0.005295221535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343646209404
                                         uncertainty =       0.005295221535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414531934
  error estimate for blocks of size 2^( 2) =       0.000427059474
  error estimate for blocks of size 2^( 3) =       0.000439829408
  error estimate for blocks of size 2^( 4) =       0.000452194548
  error estimate for blocks of size 2^( 5) =       0.000462920792
  error estimate for blocks of size 2^( 6) =       0.000469669340
  error estimate for blocks of size 2^( 7) =       0.000472686215

      target function =                  N/A
              le_mean =     -16.906836240670
             les_mean =     286.184784946050
             stat err =       0.000464367724
             autocorr =       1.254896957361
              std dev =       0.586236683481
             le_variance =       0.343673449058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343646209404
                                         uncertainty =       0.005295221535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343646209404
                                         uncertainty =       0.005295221535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414531934
  error estimate for blocks of size 2^( 2) =       0.000427059474
  error estimate for blocks of size 2^( 3) =       0.000439829408
  error estimate for blocks of size 2^( 4) =       0.000452194548
  error estimate for blocks of size 2^( 5) =       0.000462920792
  error estimate for blocks of size 2^( 6) =       0.000469669340
  error estimate for blocks of size 2^( 7) =       0.000472686215

      target function =                  N/A
              le_mean =     -16.906836240670
             les_mean =     286.184784946050
             stat err =       0.000464367724
             autocorr =       1.254896957361
              std dev =       0.586236683481
             le_variance =       0.343673449058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343646209404
                                         uncertainty =       0.005295221535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343646209404
                                         uncertainty =       0.005295221535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414531934
  error estimate for blocks of size 2^( 2) =       0.000427059474
  error estimate for blocks of size 2^( 3) =       0.000439829408
  error estimate for blocks of size 2^( 4) =       0.000452194548
  error estimate for blocks of size 2^( 5) =       0.000462920792
  error estimate for blocks of size 2^( 6) =       0.000469669340
  error estimate for blocks of size 2^( 7) =       0.000472686215

      target function =                  N/A
              le_mean =     -16.906836240670
             les_mean =     286.184784946050
             stat err =       0.000464367724
             autocorr =       1.254896957361
              std dev =       0.586236683481
             le_variance =       0.343673449058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343646209404
                                         uncertainty =       0.005295221535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343646209404
                                         uncertainty =       0.005295221535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414531934
  error estimate for blocks of size 2^( 2) =       0.000427059474
  error estimate for blocks of size 2^( 3) =       0.000439829408
  error estimate for blocks of size 2^( 4) =       0.000452194548
  error estimate for blocks of size 2^( 5) =       0.000462920792
  error estimate for blocks of size 2^( 6) =       0.000469669340
  error estimate for blocks of size 2^( 7) =       0.000472686214

      target function =                  N/A
              le_mean =     -16.906836240670
             les_mean =     286.184784946050
             stat err =       0.000464367724
             autocorr =       1.254896957355
              std dev =       0.586236683481
             le_variance =       0.343673449058


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906836240670        initial  <--
     1.4901e+09     1.4901e+10             1.1343e-13       -16.906836240670
     5.9605e+09     5.9605e+10             2.8182e-14       -16.906836240670
     2.3842e+10     2.3842e+11             6.8156e-15       -16.906836240670

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1803
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6748e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8978
    reference variance = 0.239017
====================================================
  Execution time = 2.0888e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3990e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339789336624
                                         uncertainty =       0.003479366566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339789336624
                                         uncertainty =       0.003479366566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412252807
  error estimate for blocks of size 2^( 2) =       0.000424933901
  error estimate for blocks of size 2^( 3) =       0.000437832372
  error estimate for blocks of size 2^( 4) =       0.000450212913
  error estimate for blocks of size 2^( 5) =       0.000460400792
  error estimate for blocks of size 2^( 6) =       0.000466856110
  error estimate for blocks of size 2^( 7) =       0.000471044376

      target function =                  N/A
              le_mean =     -16.906477515515
             les_mean =     286.168886566631
             stat err =       0.000462128548
             autocorr =       1.256603754087
              std dev =       0.583013510969
             le_variance =       0.339904753972


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690647751551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906477515515       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906477515515       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906477515515       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906477557290       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906494345425       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906477729682       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906470806321       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906478107669       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+10 is 1.143739e-14

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906477515515       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906477515515       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906477515515       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906481349928       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906471449094       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906423965158       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906000866659       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906419673774       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906492285136       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906144472813       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906223680927       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906189495832       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906275501613       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.903614986467       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.901442668376       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906618393899       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904870468315       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909581533108       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.902657124701       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.904119623203       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.913948332324       residual = 7.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905054004129       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905079428885       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.912128836258       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.915706732796       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.903570533113       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905683837126       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906657227239       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.909458867131       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.912059825257       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.914735800782       residual = 1.03e-02           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.910989357373       residual = 3.51e-03           smallest_sin_value = 9.98e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+10 is 2.551395e-15

solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906477515515       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906477515515       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906477515515       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906476687941       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906386762600       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906560049576       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906532006007       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906461915391       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907364869510       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907932630988       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905222380696       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905524448786       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905516050414       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.893970558587       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.896509624711       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.896440341868       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.903567270053       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906951236755       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.920824492726       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.897365871360       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.918608685383       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.892024181735       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.963078475272       residual = 4.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906116282813       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.931053369772       residual = 7.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.892031714095       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.896444121555       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.910502339666       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.913586616809       residual = 8.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.943959418277       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.946087902497       residual = 2.09e-01           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.900747302680       residual = 5.21e-03           smallest_sin_value = 9.99e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+11 is 4.697475e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6523e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8462
    reference variance = 0.301577
====================================================
  Execution time = 2.0775e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4309e-01
  Total weights = 2.0000e+06
  Execution time = 1.8761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343183906487
                                         uncertainty =       0.004738943939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343183906487
                                         uncertainty =       0.004738943939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414179994
  error estimate for blocks of size 2^( 2) =       0.000427669979
  error estimate for blocks of size 2^( 3) =       0.000441277517
  error estimate for blocks of size 2^( 4) =       0.000453836583
  error estimate for blocks of size 2^( 5) =       0.000465804507
  error estimate for blocks of size 2^( 6) =       0.000475987502
  error estimate for blocks of size 2^( 7) =       0.000481796422

      target function =                  N/A
              le_mean =     -16.906236348385
             les_mean =     286.163917430905
             stat err =       0.000469356254
             autocorr =       1.284183195252
              std dev =       0.585738964895
             le_variance =       0.343090134996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343183906487
                                         uncertainty =       0.004738943939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343183906487
                                         uncertainty =       0.004738943939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414179994
  error estimate for blocks of size 2^( 2) =       0.000427669979
  error estimate for blocks of size 2^( 3) =       0.000441277517
  error estimate for blocks of size 2^( 4) =       0.000453836583
  error estimate for blocks of size 2^( 5) =       0.000465804507
  error estimate for blocks of size 2^( 6) =       0.000475987502
  error estimate for blocks of size 2^( 7) =       0.000481796422

      target function =                  N/A
              le_mean =     -16.906236348385
             les_mean =     286.163917430905
             stat err =       0.000469356254
             autocorr =       1.284183195250
              std dev =       0.585738964895
             le_variance =       0.343090134996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343183906487
                                         uncertainty =       0.004738943939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343183906487
                                         uncertainty =       0.004738943939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414179994
  error estimate for blocks of size 2^( 2) =       0.000427669979
  error estimate for blocks of size 2^( 3) =       0.000441277517
  error estimate for blocks of size 2^( 4) =       0.000453836583
  error estimate for blocks of size 2^( 5) =       0.000465804507
  error estimate for blocks of size 2^( 6) =       0.000475987502
  error estimate for blocks of size 2^( 7) =       0.000481796422

      target function =                  N/A
              le_mean =     -16.906236348385
             les_mean =     286.163917430905
             stat err =       0.000469356254
             autocorr =       1.284183195252
              std dev =       0.585738964895
             le_variance =       0.343090134996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343183906487
                                         uncertainty =       0.004738943939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343183906487
                                         uncertainty =       0.004738943939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414179994
  error estimate for blocks of size 2^( 2) =       0.000427669979
  error estimate for blocks of size 2^( 3) =       0.000441277517
  error estimate for blocks of size 2^( 4) =       0.000453836583
  error estimate for blocks of size 2^( 5) =       0.000465804507
  error estimate for blocks of size 2^( 6) =       0.000475987502
  error estimate for blocks of size 2^( 7) =       0.000481796422

      target function =                  N/A
              le_mean =     -16.906236348385
             les_mean =     286.163917430905
             stat err =       0.000469356254
             autocorr =       1.284183195258
              std dev =       0.585738964895
             le_variance =       0.343090134996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906236348385        initial  <--
     1.4901e+10     1.4901e+11             1.1437e-14       -16.906236348385
     5.9605e+10     5.9605e+11             2.5514e-15       -16.906236348385
     2.3842e+11     2.3842e+12             4.6975e-16       -16.906236348385

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2442
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6775e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8962
    reference variance = 0.222175
====================================================
  Execution time = 2.0863e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3792e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337967304376
                                         uncertainty =       0.003306577221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337967304376
                                         uncertainty =       0.003306577221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411044684
  error estimate for blocks of size 2^( 2) =       0.000424100283
  error estimate for blocks of size 2^( 3) =       0.000437612102
  error estimate for blocks of size 2^( 4) =       0.000450580468
  error estimate for blocks of size 2^( 5) =       0.000461896874
  error estimate for blocks of size 2^( 6) =       0.000469290378
  error estimate for blocks of size 2^( 7) =       0.000475254181

      target function =                  N/A
              le_mean =     -16.905914067998
             les_mean =     286.147845770509
             stat err =       0.000464255475
             autocorr =       1.275663108741
              std dev =       0.581304967248
             le_variance =       0.337915464947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591406800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905914067998       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905914067998       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905914067998       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905980289925       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906070580714       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906016075601       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906005213536       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906077795405       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905862332161       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906925911262       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905806383291       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907112005952       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905163734687       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909737512598       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.903986492828       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904121449716       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906648372505       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906190802754       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.920587665633       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.903151499265       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.927129746288       residual = 5.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.916853178203       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.915025557309       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.900248344431       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.892769306545       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.898740037902       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.921177172837       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.896612775032       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.883377498384       residual = 6.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.899568322192       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.918944982598       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.919342024870       residual = 2.65e-02           smallest_sin_value = 9.97e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.906059505793       residual = 5.24e-03           smallest_sin_value = 9.97e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+11 is 1.278603e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905914067998       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905914067998       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905914067998       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905914067998       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905729592468       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906277075042       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905198889081       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905111320396       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905669601064       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905630710240       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.912857921608       residual = 6.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.914490714053       residual = 9.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905721340402       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910737948466       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.972844504888       residual = 5.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.931134359526       residual = 8.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904242294888       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.897186730949       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.884020854644       residual = 5.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.925715731975       residual = 5.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.883826521593       residual = 7.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910249984113       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.895038382033       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.821072307378       residual = 9.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.925060195579       residual = 4.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.916135818058       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.882008134051       residual = 8.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.889613549908       residual = 3.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.903393052555       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.939113028899       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.884603225938       residual = 6.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.912030957378       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.873714096322       residual = 1.45e-01           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.893513031964       residual = 1.90e-02           smallest_sin_value = 9.95e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.09e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+11 is 2.637579e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905914067998       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905914067998       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.414939 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6567e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.895
    reference variance = 0.220453
====================================================
  Execution time = 2.0532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4078e-01
  Total weights = 2.0000e+06
  Execution time = 1.8819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340839098478
                                         uncertainty =       0.003591853542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340839098478
                                         uncertainty =       0.003591853542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412785715
  error estimate for blocks of size 2^( 2) =       0.000425746534
  error estimate for blocks of size 2^( 3) =       0.000438750741
  error estimate for blocks of size 2^( 4) =       0.000451287967
  error estimate for blocks of size 2^( 5) =       0.000462357711
  error estimate for blocks of size 2^( 6) =       0.000469640748
  error estimate for blocks of size 2^( 7) =       0.000475541004

      target function =                  N/A
              le_mean =     -16.905696185078
             les_mean =     286.143347425561
             stat err =       0.000464706858
             autocorr =       1.267385816460
              std dev =       0.583767157174
             le_variance =       0.340784093795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340839098478
                                         uncertainty =       0.003591853542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340839098478
                                         uncertainty =       0.003591853542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412785715
  error estimate for blocks of size 2^( 2) =       0.000425746534
  error estimate for blocks of size 2^( 3) =       0.000438750741
  error estimate for blocks of size 2^( 4) =       0.000451287967
  error estimate for blocks of size 2^( 5) =       0.000462357711
  error estimate for blocks of size 2^( 6) =       0.000469640748
  error estimate for blocks of size 2^( 7) =       0.000475541004

      target function =                  N/A
              le_mean =     -16.905696185078
             les_mean =     286.143347425561
             stat err =       0.000464706858
             autocorr =       1.267385816461
              std dev =       0.583767157174
             le_variance =       0.340784093795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340839098478
                                         uncertainty =       0.003591853542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340839098478
                                         uncertainty =       0.003591853542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412785715
  error estimate for blocks of size 2^( 2) =       0.000425746534
  error estimate for blocks of size 2^( 3) =       0.000438750741
  error estimate for blocks of size 2^( 4) =       0.000451287967
  error estimate for blocks of size 2^( 5) =       0.000462357711
  error estimate for blocks of size 2^( 6) =       0.000469640748
  error estimate for blocks of size 2^( 7) =       0.000475541004

      target function =                  N/A
              le_mean =     -16.905696185078
             les_mean =     286.143347425561
             stat err =       0.000464706858
             autocorr =       1.267385816460
              std dev =       0.583767157174
             le_variance =       0.340784093795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340839098478
                                         uncertainty =       0.003591853542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340839098478
                                         uncertainty =       0.003591853542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412785715
  error estimate for blocks of size 2^( 2) =       0.000425746534
  error estimate for blocks of size 2^( 3) =       0.000438750741
  error estimate for blocks of size 2^( 4) =       0.000451287967
  error estimate for blocks of size 2^( 5) =       0.000462357711
  error estimate for blocks of size 2^( 6) =       0.000469640748
  error estimate for blocks of size 2^( 7) =       0.000475541004

      target function =                  N/A
              le_mean =     -16.905696185078
             les_mean =     286.143347425561
             stat err =       0.000464706858
             autocorr =       1.267385816460
              std dev =       0.583767157174
             le_variance =       0.340784093795


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905696185078        initial  <--
     1.4901e+11     1.4901e+12             1.2786e-15       -16.905696185078
     5.9605e+11     5.9605e+12             2.6376e-16       -16.905696185078
     2.3842e+12     2.3842e+13             0.0000e+00       -16.905696185078

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.0208
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9285
    reference variance = 0.50414
====================================================
  Execution time = 2.0921e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4100e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050852249
                                         uncertainty =       0.004042879742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341050852249
                                         uncertainty =       0.004042879742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412917840
  error estimate for blocks of size 2^( 2) =       0.000425803633
  error estimate for blocks of size 2^( 3) =       0.000438336331
  error estimate for blocks of size 2^( 4) =       0.000450644308
  error estimate for blocks of size 2^( 5) =       0.000463008447
  error estimate for blocks of size 2^( 6) =       0.000472010994
  error estimate for blocks of size 2^( 7) =       0.000481053776

      target function =                  N/A
              le_mean =     -16.906616511328
             les_mean =     286.174683976115
             stat err =       0.000466679381
             autocorr =       1.277350059700
              std dev =       0.583954009743
             le_variance =       0.341002285495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661651133e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906616511328       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906616511328       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906616511328       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906616511328       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906616511328       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906616511328       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.416005 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6530e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9326
    reference variance = 0.140376
====================================================
  Execution time = 2.0890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4028e-01
  Total weights = 2.0000e+06
  Execution time = 1.8893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340275088615
                                         uncertainty =       0.003395377570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340275088615
                                         uncertainty =       0.003395377570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412477612
  error estimate for blocks of size 2^( 2) =       0.000424844460
  error estimate for blocks of size 2^( 3) =       0.000437499232
  error estimate for blocks of size 2^( 4) =       0.000450312086
  error estimate for blocks of size 2^( 5) =       0.000460629406
  error estimate for blocks of size 2^( 6) =       0.000469359679
  error estimate for blocks of size 2^( 7) =       0.000472890689

      target function =                  N/A
              le_mean =     -16.906222768766
             les_mean =     286.160643697480
             stat err =       0.000463297965
             autocorr =       1.261595186447
              std dev =       0.583331432776
             le_variance =       0.340275560465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340275088615
                                         uncertainty =       0.003395377570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340275088615
                                         uncertainty =       0.003395377570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412477612
  error estimate for blocks of size 2^( 2) =       0.000424844460
  error estimate for blocks of size 2^( 3) =       0.000437499232
  error estimate for blocks of size 2^( 4) =       0.000450312086
  error estimate for blocks of size 2^( 5) =       0.000460629406
  error estimate for blocks of size 2^( 6) =       0.000469359679
  error estimate for blocks of size 2^( 7) =       0.000472890689

      target function =                  N/A
              le_mean =     -16.906222768766
             les_mean =     286.160643697480
             stat err =       0.000463297965
             autocorr =       1.261595186447
              std dev =       0.583331432776
             le_variance =       0.340275560465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340275088615
                                         uncertainty =       0.003395377570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340275088615
                                         uncertainty =       0.003395377570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412477612
  error estimate for blocks of size 2^( 2) =       0.000424844460
  error estimate for blocks of size 2^( 3) =       0.000437499232
  error estimate for blocks of size 2^( 4) =       0.000450312086
  error estimate for blocks of size 2^( 5) =       0.000460629406
  error estimate for blocks of size 2^( 6) =       0.000469359679
  error estimate for blocks of size 2^( 7) =       0.000472890689

      target function =                  N/A
              le_mean =     -16.906222768766
             les_mean =     286.160643697480
             stat err =       0.000463297965
             autocorr =       1.261595186447
              std dev =       0.583331432776
             le_variance =       0.340275560465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340275088615
                                         uncertainty =       0.003395377570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340275088615
                                         uncertainty =       0.003395377570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412477612
  error estimate for blocks of size 2^( 2) =       0.000424844460
  error estimate for blocks of size 2^( 3) =       0.000437499232
  error estimate for blocks of size 2^( 4) =       0.000450312086
  error estimate for blocks of size 2^( 5) =       0.000460629406
  error estimate for blocks of size 2^( 6) =       0.000469359679
  error estimate for blocks of size 2^( 7) =       0.000472890689

      target function =                  N/A
              le_mean =     -16.906222768766
             les_mean =     286.160643697480
             stat err =       0.000463297965
             autocorr =       1.261595186447
              std dev =       0.583331432776
             le_variance =       0.340275560465


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906222768766        initial  <--
     1.4901e+12     1.4901e+13             0.0000e+00       -16.906222768766
     5.9605e+12     5.9605e+13             0.0000e+00       -16.906222768766
     2.3842e+13     2.3842e+14             0.0000e+00       -16.906222768766

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4269
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6965e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9692
    reference variance = 0.185574
====================================================
  Execution time = 2.0855e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2996e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330017757975
                                         uncertainty =       0.002334457125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330017757975
                                         uncertainty =       0.002334457125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406175207
  error estimate for blocks of size 2^( 2) =       0.000419116788
  error estimate for blocks of size 2^( 3) =       0.000432772170
  error estimate for blocks of size 2^( 4) =       0.000445161059
  error estimate for blocks of size 2^( 5) =       0.000457491233
  error estimate for blocks of size 2^( 6) =       0.000468422007
  error estimate for blocks of size 2^( 7) =       0.000472114367

      target function =                  N/A
              le_mean =     -16.905876702645
             les_mean =     286.138623517477
             stat err =       0.000460797166
             autocorr =       1.287042175520
              std dev =       0.574418486313
             le_variance =       0.329956597418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587670265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905876702645       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905876702645       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905876702645       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905876702645       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.851092112855       residual = 3.85e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905623564622       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.988541901396       residual = 9.00e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.955648612131       residual = 3.34e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.884808871277       residual = 5.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.017851173448       residual = 1.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.240016250289       residual = 1.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.751561517935       residual = 9.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -15.898327062126       residual = 1.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -15.350124852096       residual = 3.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.091158337393       residual = 8.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -15.677951411749       residual = 1.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -15.893116111875       residual = 1.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -14.444452833831       residual = 7.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.748046835446       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.765721066130       residual = 2.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.900231685350       residual = 1.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -15.924889705786       residual = 1.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -19.390175726410       residual = 8.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.765601448569       residual = 2.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.028941158650       residual = 6.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -18.214731314302       residual = 2.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.410626277429       residual = 3.36e+01           smallest_sin_value = 9.99e-01
davidson iteration   27:   krylov dim =  28   energy =     -17.276392868083       residual = 1.47e+01           smallest_sin_value = 9.97e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+13 is 2.319965e-18

solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905876702645       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905876702645       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905876702645       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905876702645       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905881762593       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.020068928130       residual = 2.27e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.930362922426       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.012013585587       residual = 1.55e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.045364302811       residual = 2.18e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.804248122895       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.086415283725       residual = 4.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -18.904728788818       residual = 5.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.271546966967       residual = 2.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -18.872345919193       residual = 4.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.132522977018       residual = 9.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.281567238027       residual = 1.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.407236819991       residual = 3.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -13.231139614597       residual = 1.77e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -15.370353622340       residual = 2.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -23.529980924804       residual = 6.05e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.270043998022       residual = 8.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.995692746082       residual = 5.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -18.758773864586       residual = 3.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -11.158759445636       residual = 4.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -11.798185799401       residual = 3.74e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -12.028346373847       residual = 3.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -13.351908524383       residual = 1.70e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -13.776487372510       residual = 9.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =      -8.829046268949       residual = 9.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.630851430925       residual = 2.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -12.764430077478       residual = 2.80e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -15.724436343673       residual = 2.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -19.863829730172       residual = 1.50e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -18.623907702620       residual = 9.62e+02           smallest_sin_value = 9.99e-01
davidson iteration   34:   krylov dim =  35   energy =     -16.826276201818       residual = 6.31e+02           smallest_sin_value = 9.97e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+13 is 5.799912e-19

solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905876702645       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905876702645       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905876702645       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905876702648       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -15.756941130128       residual = 1.79e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.235485790741       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.186292072969       residual = 6.72e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.527086137512       residual = 1.86e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.136167568212       residual = 8.02e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.244744542317       residual = 5.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.210320642802       residual = 1.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -13.727529356681       residual = 1.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -21.853141727356       residual = 2.84e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -26.853332973973       residual = 1.26e+04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -21.307980484692       residual = 2.29e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -26.151071794511       residual = 1.09e+04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -18.091507409002       residual = 2.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.347255154984       residual = 1.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -21.723226221287       residual = 3.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.296046264428       residual = 1.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =      -7.122545280176       residual = 1.20e+04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -23.026761770692       residual = 4.05e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -26.534503967873       residual = 1.19e+04           smallest_sin_value = 1.00e+00
davidson iteration   23 stopping due to too large eigenvalue change
davidson solver did not converge after         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+14 is 1.449978e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.451887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6663e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8916
    reference variance = 0.220411
====================================================
  Execution time = 2.0571e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3868e-01
  Total weights = 2.0000e+06
  Execution time = 1.8792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707155603
                                         uncertainty =       0.003915566946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707155603
                                         uncertainty =       0.003915566946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411510358
  error estimate for blocks of size 2^( 2) =       0.000424032874
  error estimate for blocks of size 2^( 3) =       0.000436881844
  error estimate for blocks of size 2^( 4) =       0.000449920873
  error estimate for blocks of size 2^( 5) =       0.000460817206
  error estimate for blocks of size 2^( 6) =       0.000467430889
  error estimate for blocks of size 2^( 7) =       0.000472236856

      target function =                  N/A
              le_mean =     -16.906415608763
             les_mean =     286.165570116898
             stat err =       0.000462601456
             autocorr =       1.263724623382
              std dev =       0.581963529788
             le_variance =       0.338681550003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707155603
                                         uncertainty =       0.003915566946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707155603
                                         uncertainty =       0.003915566946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411510358
  error estimate for blocks of size 2^( 2) =       0.000424032874
  error estimate for blocks of size 2^( 3) =       0.000436881844
  error estimate for blocks of size 2^( 4) =       0.000449920873
  error estimate for blocks of size 2^( 5) =       0.000460817206
  error estimate for blocks of size 2^( 6) =       0.000467430889
  error estimate for blocks of size 2^( 7) =       0.000472236856

      target function =                  N/A
              le_mean =     -16.906415608763
             les_mean =     286.165570116898
             stat err =       0.000462601456
             autocorr =       1.263724623382
              std dev =       0.581963529788
             le_variance =       0.338681550003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707155603
                                         uncertainty =       0.003915566946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707155603
                                         uncertainty =       0.003915566946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411510358
  error estimate for blocks of size 2^( 2) =       0.000424032874
  error estimate for blocks of size 2^( 3) =       0.000436881844
  error estimate for blocks of size 2^( 4) =       0.000449920873
  error estimate for blocks of size 2^( 5) =       0.000460817206
  error estimate for blocks of size 2^( 6) =       0.000467430889
  error estimate for blocks of size 2^( 7) =       0.000472236856

      target function =                  N/A
              le_mean =     -16.906415608763
             les_mean =     286.165570116898
             stat err =       0.000462601456
             autocorr =       1.263724623382
              std dev =       0.581963529788
             le_variance =       0.338681550003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707155603
                                         uncertainty =       0.003915566946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707155603
                                         uncertainty =       0.003915566946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411510358
  error estimate for blocks of size 2^( 2) =       0.000424032874
  error estimate for blocks of size 2^( 3) =       0.000436881844
  error estimate for blocks of size 2^( 4) =       0.000449920873
  error estimate for blocks of size 2^( 5) =       0.000460817206
  error estimate for blocks of size 2^( 6) =       0.000467430889
  error estimate for blocks of size 2^( 7) =       0.000472236856

      target function =                  N/A
              le_mean =     -16.906415608763
             les_mean =     286.165570116898
             stat err =       0.000462601456
             autocorr =       1.263724623382
              std dev =       0.581963529788
             le_variance =       0.338681550003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906415608763        initial  <--
     1.4901e+13     1.4901e+14             2.3200e-18       -16.906415608763
     5.9605e+13     5.9605e+14             5.7999e-19       -16.906415608763
     2.3842e+14     2.3842e+15             1.4500e-19       -16.906415608763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0690
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9405
    reference variance = 0.253484
====================================================
  Execution time = 2.0892e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336484616873
                                         uncertainty =       0.003724683106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336484616873
                                         uncertainty =       0.003724683106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410126357
  error estimate for blocks of size 2^( 2) =       0.000422955735
  error estimate for blocks of size 2^( 3) =       0.000436488362
  error estimate for blocks of size 2^( 4) =       0.000449485193
  error estimate for blocks of size 2^( 5) =       0.000460761822
  error estimate for blocks of size 2^( 6) =       0.000469072039
  error estimate for blocks of size 2^( 7) =       0.000475279814

      target function =                  N/A
              le_mean =     -16.906362049593
             les_mean =     286.161484841906
             stat err =       0.000463649717
             autocorr =       1.278040558304
              std dev =       0.580006257032
             le_variance =       0.336407258197


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636204959e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906362049593       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362049593       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+14, overlap shift 5.9605e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906362049593       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362049593       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906362049593       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362049593       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.452969 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6530e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9261
    reference variance = 0.287344
====================================================
  Execution time = 2.0650e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3688e-01
  Total weights = 2.0000e+06
  Execution time = 1.8900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336928308070
                                         uncertainty =       0.003112711425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336928308070
                                         uncertainty =       0.003112711425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410416887
  error estimate for blocks of size 2^( 2) =       0.000423526625
  error estimate for blocks of size 2^( 3) =       0.000436544926
  error estimate for blocks of size 2^( 4) =       0.000448964294
  error estimate for blocks of size 2^( 5) =       0.000460456657
  error estimate for blocks of size 2^( 6) =       0.000469094890
  error estimate for blocks of size 2^( 7) =       0.000472570391

      target function =                  N/A
              le_mean =     -16.906039110462
             les_mean =     286.151042277968
             stat err =       0.000462771558
             autocorr =       1.271401955318
              std dev =       0.580417127548
             le_variance =       0.336884041951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336928308070
                                         uncertainty =       0.003112711425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336928308070
                                         uncertainty =       0.003112711425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410416887
  error estimate for blocks of size 2^( 2) =       0.000423526625
  error estimate for blocks of size 2^( 3) =       0.000436544926
  error estimate for blocks of size 2^( 4) =       0.000448964294
  error estimate for blocks of size 2^( 5) =       0.000460456657
  error estimate for blocks of size 2^( 6) =       0.000469094890
  error estimate for blocks of size 2^( 7) =       0.000472570391

      target function =                  N/A
              le_mean =     -16.906039110462
             les_mean =     286.151042277968
             stat err =       0.000462771558
             autocorr =       1.271401955318
              std dev =       0.580417127548
             le_variance =       0.336884041951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336928308070
                                         uncertainty =       0.003112711425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336928308070
                                         uncertainty =       0.003112711425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410416887
  error estimate for blocks of size 2^( 2) =       0.000423526625
  error estimate for blocks of size 2^( 3) =       0.000436544926
  error estimate for blocks of size 2^( 4) =       0.000448964294
  error estimate for blocks of size 2^( 5) =       0.000460456657
  error estimate for blocks of size 2^( 6) =       0.000469094890
  error estimate for blocks of size 2^( 7) =       0.000472570391

      target function =                  N/A
              le_mean =     -16.906039110462
             les_mean =     286.151042277968
             stat err =       0.000462771558
             autocorr =       1.271401955318
              std dev =       0.580417127548
             le_variance =       0.336884041951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336928308070
                                         uncertainty =       0.003112711425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336928308070
                                         uncertainty =       0.003112711425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410416887
  error estimate for blocks of size 2^( 2) =       0.000423526625
  error estimate for blocks of size 2^( 3) =       0.000436544926
  error estimate for blocks of size 2^( 4) =       0.000448964294
  error estimate for blocks of size 2^( 5) =       0.000460456657
  error estimate for blocks of size 2^( 6) =       0.000469094890
  error estimate for blocks of size 2^( 7) =       0.000472570391

      target function =                  N/A
              le_mean =     -16.906039110462
             les_mean =     286.151042277968
             stat err =       0.000462771558
             autocorr =       1.271401955318
              std dev =       0.580417127548
             le_variance =       0.336884041951


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906039110462        initial  <--
     1.4901e+14     1.4901e+15             0.0000e+00       -16.906039110462
     5.9605e+14     5.9605e+15             0.0000e+00       -16.906039110462
     2.3842e+15     2.3842e+16             0.0000e+00       -16.906039110462

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2387
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9121
    reference variance = 0.282929
====================================================
  Execution time = 2.0817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3917e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339185616519
                                         uncertainty =       0.003399337428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339185616519
                                         uncertainty =       0.003399337428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411805607
  error estimate for blocks of size 2^( 2) =       0.000424510336
  error estimate for blocks of size 2^( 3) =       0.000437305135
  error estimate for blocks of size 2^( 4) =       0.000449582969
  error estimate for blocks of size 2^( 5) =       0.000460750445
  error estimate for blocks of size 2^( 6) =       0.000467575592
  error estimate for blocks of size 2^( 7) =       0.000472430499

      target function =                  N/A
              le_mean =     -16.906530710341
             les_mean =     286.169948205781
             stat err =       0.000462584876
             autocorr =       1.261822738923
              std dev =       0.582381074266
             le_variance =       0.339167715663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653071034e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+15, overlap shift 1.4901e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906530710341       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906530710341       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.43e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+15, overlap shift 5.9605e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906530710341       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906530710341       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.43e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906530710341       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906530710341       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.454028 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6562e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.841
    reference variance = 0.176279
====================================================
  Execution time = 2.0632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3529e-01
  Total weights = 2.0000e+06
  Execution time = 1.8832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335194355750
                                         uncertainty =       0.003527320800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335194355750
                                         uncertainty =       0.003527320800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409447352
  error estimate for blocks of size 2^( 2) =       0.000422349074
  error estimate for blocks of size 2^( 3) =       0.000435568374
  error estimate for blocks of size 2^( 4) =       0.000449114385
  error estimate for blocks of size 2^( 5) =       0.000459456168
  error estimate for blocks of size 2^( 6) =       0.000470020104
  error estimate for blocks of size 2^( 7) =       0.000477049375

      target function =                  N/A
              le_mean =     -16.905555105746
             les_mean =     286.133087534417
             stat err =       0.000463910008
             autocorr =       1.283723078456
              std dev =       0.579045998725
             le_variance =       0.335294268640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335194355750
                                         uncertainty =       0.003527320800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335194355750
                                         uncertainty =       0.003527320800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409447352
  error estimate for blocks of size 2^( 2) =       0.000422349074
  error estimate for blocks of size 2^( 3) =       0.000435568374
  error estimate for blocks of size 2^( 4) =       0.000449114385
  error estimate for blocks of size 2^( 5) =       0.000459456168
  error estimate for blocks of size 2^( 6) =       0.000470020104
  error estimate for blocks of size 2^( 7) =       0.000477049375

      target function =                  N/A
              le_mean =     -16.905555105746
             les_mean =     286.133087534417
             stat err =       0.000463910008
             autocorr =       1.283723078456
              std dev =       0.579045998725
             le_variance =       0.335294268640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335194355750
                                         uncertainty =       0.003527320800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335194355750
                                         uncertainty =       0.003527320800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409447352
  error estimate for blocks of size 2^( 2) =       0.000422349074
  error estimate for blocks of size 2^( 3) =       0.000435568374
  error estimate for blocks of size 2^( 4) =       0.000449114385
  error estimate for blocks of size 2^( 5) =       0.000459456168
  error estimate for blocks of size 2^( 6) =       0.000470020104
  error estimate for blocks of size 2^( 7) =       0.000477049375

      target function =                  N/A
              le_mean =     -16.905555105746
             les_mean =     286.133087534417
             stat err =       0.000463910008
             autocorr =       1.283723078456
              std dev =       0.579045998725
             le_variance =       0.335294268640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335194355750
                                         uncertainty =       0.003527320800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335194355750
                                         uncertainty =       0.003527320800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409447352
  error estimate for blocks of size 2^( 2) =       0.000422349074
  error estimate for blocks of size 2^( 3) =       0.000435568374
  error estimate for blocks of size 2^( 4) =       0.000449114385
  error estimate for blocks of size 2^( 5) =       0.000459456168
  error estimate for blocks of size 2^( 6) =       0.000470020104
  error estimate for blocks of size 2^( 7) =       0.000477049375

      target function =                  N/A
              le_mean =     -16.905555105746
             les_mean =     286.133087534417
             stat err =       0.000463910008
             autocorr =       1.283723078456
              std dev =       0.579045998725
             le_variance =       0.335294268640


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905555105746        initial  <--
     1.4901e+15     1.4901e+16             0.0000e+00       -16.905555105746
     5.9605e+15     5.9605e+16             0.0000e+00       -16.905555105746
     2.3842e+16     2.3842e+17             0.0000e+00       -16.905555105746

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1483
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6717e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.838
    reference variance = 0.278295
====================================================
  Execution time = 2.0857e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4115e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341243850413
                                         uncertainty =       0.003778369230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341243850413
                                         uncertainty =       0.003778369230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413009058
  error estimate for blocks of size 2^( 2) =       0.000425767643
  error estimate for blocks of size 2^( 3) =       0.000438950578
  error estimate for blocks of size 2^( 4) =       0.000450941441
  error estimate for blocks of size 2^( 5) =       0.000460338113
  error estimate for blocks of size 2^( 6) =       0.000468431636
  error estimate for blocks of size 2^( 7) =       0.000473192548

      target function =                  N/A
              le_mean =     -16.906344061700
             les_mean =     286.165622326606
             stat err =       0.000463225935
             autocorr =       1.257959266583
              std dev =       0.584083011738
             le_variance =       0.341152964601


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634406170e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+16, overlap shift 1.4901e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906344061700       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906344061700       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.16e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+16, overlap shift 5.9605e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906344061700       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906344061700       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906344061700       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906344061700       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.455079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6529e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8369
    reference variance = 0.203734
====================================================
  Execution time = 2.0884e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4758e-01
  Total weights = 2.0000e+06
  Execution time = 1.8902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347675878167
                                         uncertainty =       0.007179652417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347675878167
                                         uncertainty =       0.007179652417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416882245
  error estimate for blocks of size 2^( 2) =       0.000429846845
  error estimate for blocks of size 2^( 3) =       0.000443069492
  error estimate for blocks of size 2^( 4) =       0.000455534290
  error estimate for blocks of size 2^( 5) =       0.000465797510
  error estimate for blocks of size 2^( 6) =       0.000474676334
  error estimate for blocks of size 2^( 7) =       0.000480884162

      target function =                  N/A
              le_mean =     -16.906947852241
             les_mean =     286.192467116375
             stat err =       0.000469223074
             autocorr =       1.266869626757
              std dev =       0.589560524253
             le_variance =       0.347581611757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347675878167
                                         uncertainty =       0.007179652417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347675878167
                                         uncertainty =       0.007179652417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416882245
  error estimate for blocks of size 2^( 2) =       0.000429846845
  error estimate for blocks of size 2^( 3) =       0.000443069492
  error estimate for blocks of size 2^( 4) =       0.000455534290
  error estimate for blocks of size 2^( 5) =       0.000465797510
  error estimate for blocks of size 2^( 6) =       0.000474676334
  error estimate for blocks of size 2^( 7) =       0.000480884162

      target function =                  N/A
              le_mean =     -16.906947852241
             les_mean =     286.192467116375
             stat err =       0.000469223074
             autocorr =       1.266869626757
              std dev =       0.589560524253
             le_variance =       0.347581611757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347675878167
                                         uncertainty =       0.007179652417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347675878167
                                         uncertainty =       0.007179652417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416882245
  error estimate for blocks of size 2^( 2) =       0.000429846845
  error estimate for blocks of size 2^( 3) =       0.000443069492
  error estimate for blocks of size 2^( 4) =       0.000455534290
  error estimate for blocks of size 2^( 5) =       0.000465797510
  error estimate for blocks of size 2^( 6) =       0.000474676334
  error estimate for blocks of size 2^( 7) =       0.000480884162

      target function =                  N/A
              le_mean =     -16.906947852241
             les_mean =     286.192467116375
             stat err =       0.000469223074
             autocorr =       1.266869626757
              std dev =       0.589560524253
             le_variance =       0.347581611757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347675878167
                                         uncertainty =       0.007179652417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347675878167
                                         uncertainty =       0.007179652417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416882245
  error estimate for blocks of size 2^( 2) =       0.000429846845
  error estimate for blocks of size 2^( 3) =       0.000443069492
  error estimate for blocks of size 2^( 4) =       0.000455534290
  error estimate for blocks of size 2^( 5) =       0.000465797510
  error estimate for blocks of size 2^( 6) =       0.000474676334
  error estimate for blocks of size 2^( 7) =       0.000480884162

      target function =                  N/A
              le_mean =     -16.906947852241
             les_mean =     286.192467116375
             stat err =       0.000469223074
             autocorr =       1.266869626757
              std dev =       0.589560524253
             le_variance =       0.347581611757


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906947852241        initial  <--
     1.4901e+16     1.4901e+17             0.0000e+00       -16.906947852241
     5.9605e+16     5.9605e+17             0.0000e+00       -16.906947852241
     2.3842e+17     2.3842e+18             0.0000e+00       -16.906947852241

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4219
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6962e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8883
    reference variance = 0.199764
====================================================
  Execution time = 2.2958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3590e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335943615259
                                         uncertainty =       0.003881595175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335943615259
                                         uncertainty =       0.003881595175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409818163
  error estimate for blocks of size 2^( 2) =       0.000422864067
  error estimate for blocks of size 2^( 3) =       0.000435720963
  error estimate for blocks of size 2^( 4) =       0.000447835426
  error estimate for blocks of size 2^( 5) =       0.000458430212
  error estimate for blocks of size 2^( 6) =       0.000467515706
  error estimate for blocks of size 2^( 7) =       0.000472864193

      target function =                  N/A
              le_mean =     -16.906600570712
             les_mean =     286.169044543561
             stat err =       0.000461661384
             autocorr =       1.269008974850
              std dev =       0.579570404628
             le_variance =       0.335901853920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660057071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+17, overlap shift 1.4901e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906600570712       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906600570712       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+17, overlap shift 5.9605e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906600570712       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906600570712       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906600570712       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906600570712       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.456211 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8613e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.0178
    reference variance = 0.724275
====================================================
  Execution time = 2.0694e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4445e-01
  Total weights = 2.0000e+06
  Execution time = 1.8820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344354462490
                                         uncertainty =       0.004694744639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344354462490
                                         uncertainty =       0.004694744639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414998937
  error estimate for blocks of size 2^( 2) =       0.000427314809
  error estimate for blocks of size 2^( 3) =       0.000440509827
  error estimate for blocks of size 2^( 4) =       0.000453350824
  error estimate for blocks of size 2^( 5) =       0.000463727194
  error estimate for blocks of size 2^( 6) =       0.000472612261
  error estimate for blocks of size 2^( 7) =       0.000482291011

      target function =                  N/A
              le_mean =     -16.906944228532
             les_mean =     286.189211209516
             stat err =       0.000467995322
             autocorr =       1.271712840992
              std dev =       0.586897124747
             le_variance =       0.344448235036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344354462490
                                         uncertainty =       0.004694744639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344354462490
                                         uncertainty =       0.004694744639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414998937
  error estimate for blocks of size 2^( 2) =       0.000427314809
  error estimate for blocks of size 2^( 3) =       0.000440509827
  error estimate for blocks of size 2^( 4) =       0.000453350824
  error estimate for blocks of size 2^( 5) =       0.000463727194
  error estimate for blocks of size 2^( 6) =       0.000472612261
  error estimate for blocks of size 2^( 7) =       0.000482291011

      target function =                  N/A
              le_mean =     -16.906944228532
             les_mean =     286.189211209516
             stat err =       0.000467995322
             autocorr =       1.271712840992
              std dev =       0.586897124747
             le_variance =       0.344448235036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344354462490
                                         uncertainty =       0.004694744639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344354462490
                                         uncertainty =       0.004694744639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414998937
  error estimate for blocks of size 2^( 2) =       0.000427314809
  error estimate for blocks of size 2^( 3) =       0.000440509827
  error estimate for blocks of size 2^( 4) =       0.000453350824
  error estimate for blocks of size 2^( 5) =       0.000463727194
  error estimate for blocks of size 2^( 6) =       0.000472612261
  error estimate for blocks of size 2^( 7) =       0.000482291011

      target function =                  N/A
              le_mean =     -16.906944228532
             les_mean =     286.189211209516
             stat err =       0.000467995322
             autocorr =       1.271712840992
              std dev =       0.586897124747
             le_variance =       0.344448235036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344354462490
                                         uncertainty =       0.004694744639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344354462490
                                         uncertainty =       0.004694744639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414998937
  error estimate for blocks of size 2^( 2) =       0.000427314809
  error estimate for blocks of size 2^( 3) =       0.000440509827
  error estimate for blocks of size 2^( 4) =       0.000453350824
  error estimate for blocks of size 2^( 5) =       0.000463727194
  error estimate for blocks of size 2^( 6) =       0.000472612261
  error estimate for blocks of size 2^( 7) =       0.000482291011

      target function =                  N/A
              le_mean =     -16.906944228532
             les_mean =     286.189211209516
             stat err =       0.000467995322
             autocorr =       1.271712840992
              std dev =       0.586897124747
             le_variance =       0.344448235036


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906944228532        initial  <--
     1.4901e+17     1.4901e+18             0.0000e+00       -16.906944228532
     5.9605e+17     5.9605e+18             0.0000e+00       -16.906944228532
     2.3842e+18     2.3842e+19             0.0000e+00       -16.906944228532

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2061
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.115894e-01 1 1  ON 0
 uu_1                 1.443680e-01 1 1  ON 1
 uu_2                 4.235682e-02 1 1  ON 2
 uu_3                -2.053276e-02 1 1  ON 3
 uu_4                -6.678728e-02 1 1  ON 4
 uu_5                -1.028973e-01 1 1  ON 5
 uu_6                -1.319506e-01 1 1  ON 6
 uu_7                -1.471347e-01 1 1  ON 7
 uu_8                -1.402373e-01 1 1  ON 8
 uu_9                -1.126804e-01 1 1  ON 9
 ud_0                 4.544254e-01 1 1  ON 10
 ud_1                 1.883003e-01 1 1  ON 11
 ud_2                 6.735747e-02 1 1  ON 12
 ud_3                -4.335117e-03 1 1  ON 13
 ud_4                -6.202956e-02 1 1  ON 14
 ud_5                -1.045684e-01 1 1  ON 15
 ud_6                -1.332070e-01 1 1  ON 16
 ud_7                -1.516366e-01 1 1  ON 17
 ud_8                -1.540559e-01 1 1  ON 18
 ud_9                -1.462024e-01 1 1  ON 19
 eO_0                -7.510407e-01 1 1  ON 20
 eO_1                -4.293402e-01 1 1  ON 21
 eO_2                -1.394353e-02 1 1  ON 22
 eO_3                 3.032321e-01 1 1  ON 23
 eO_4                 5.308073e-01 1 1  ON 24
 eO_5                 4.941248e-01 1 1  ON 25
 eO_6                 2.652326e-01 1 1  ON 26
 eO_7                -4.105133e-02 1 1  ON 27
 eO_8                -2.401505e-01 1 1  ON 28
 eO_9                -1.114905e-01 1 1  ON 29
eH1_0                -2.647366e-01 1 1  ON 30
eH1_1                -1.593806e-01 1 1  ON 31
eH1_2                -1.099674e-01 1 1  ON 32
eH1_3                -5.441772e-02 1 1  ON 33
eH1_4                -4.021061e-03 1 1  ON 34
eH1_5                 3.291174e-02 1 1  ON 35
eH1_6                 9.579278e-02 1 1  ON 36
eH1_7                 1.600168e-01 1 1  ON 37
eH1_8                 1.995597e-01 1 1  ON 38
eH1_9                 1.031986e-01 1 1  ON 39
eH2_0                -2.607438e-01 1 1  ON 40
eH2_1                -1.556641e-01 1 1  ON 41
eH2_2                -1.064044e-01 1 1  ON 42
eH2_3                -5.105191e-02 1 1  ON 43
eH2_4                -8.975626e-04 1 1  ON 44
eH2_5                 3.478603e-02 1 1  ON 45
eH2_6                 9.773895e-02 1 1  ON 46
eH2_7                 1.601398e-01 1 1  ON 47
eH2_8                 2.005955e-01 1 1  ON 48
eH2_9                 9.330818e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8828e+01 secs
  Total Execution time = 2.2874e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
