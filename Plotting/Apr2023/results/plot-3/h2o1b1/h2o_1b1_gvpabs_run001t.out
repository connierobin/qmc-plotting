Rank =    0  Free Memory = 77609 MB
Rank =    1  Free Memory = 77608 MB
Rank =    2  Free Memory = 77608 MB
Rank =    3  Free Memory = 77608 MB
Rank =    4  Free Memory = 77608 MB
Rank =    5  Free Memory = 77608 MB
Rank =    6  Free Memory = 77608 MB
Rank =    7  Free Memory = 77608 MB
Rank =    8  Free Memory = 77608 MB
Rank =    9  Free Memory = 77607 MB
Rank =   10  Free Memory = 77606 MB
Rank =   11  Free Memory = 77606 MB
Rank =   12  Free Memory = 77606 MB
Rank =   13  Free Memory = 77606 MB
Rank =   14  Free Memory = 77605 MB
Rank =   15  Free Memory = 77591 MB
Rank =   16  Free Memory = 77590 MB
Rank =   17  Free Memory = 77590 MB
Rank =   18  Free Memory = 77590 MB
Rank =   19  Free Memory = 77590 MB
Rank =   20  Free Memory = 77590 MB
Rank =   21  Free Memory = 77590 MB
Rank =   22  Free Memory = 77590 MB
Rank =   23  Free Memory = 77590 MB
Rank =   24  Free Memory = 77590 MB
Rank =   25  Free Memory = 77590 MB
Rank =   26  Free Memory = 77590 MB
Rank =   27  Free Memory = 77590 MB
Rank =   28  Free Memory = 77590 MB
Rank =   29  Free Memory = 77590 MB
Rank =   30  Free Memory = 77590 MB
Rank =   31  Free Memory = 77590 MB
Rank =   32  Free Memory = 74469 MB
Rank =   33  Free Memory = 74469 MB
Rank =   34  Free Memory = 74469 MB
Rank =   35  Free Memory = 74469 MB
Rank =   36  Free Memory = 74469 MB
Rank =   37  Free Memory = 74469 MB
Rank =   38  Free Memory = 74469 MB
Rank =   39  Free Memory = 74469 MB
Rank =   40  Free Memory = 74469 MB
Rank =   41  Free Memory = 74469 MB
Rank =   42  Free Memory = 74469 MB
Rank =   43  Free Memory = 74469 MB
Rank =   44  Free Memory = 74469 MB
Rank =   45  Free Memory = 74469 MB
Rank =   46  Free Memory = 74469 MB
Rank =   47  Free Memory = 74469 MB
Rank =   48  Free Memory = 74469 MB
Rank =   49  Free Memory = 74469 MB
Rank =   50  Free Memory = 74469 MB
Rank =   51  Free Memory = 74469 MB
Rank =   52  Free Memory = 74469 MB
Rank =   53  Free Memory = 74469 MB
Rank =   54  Free Memory = 74469 MB
Rank =   55  Free Memory = 74469 MB
Rank =   56  Free Memory = 74469 MB
Rank =   57  Free Memory = 74469 MB
Rank =   58  Free Memory = 74469 MB
Rank =   59  Free Memory = 74469 MB
Rank =   60  Free Memory = 74469 MB
Rank =   61  Free Memory = 74469 MB
Rank =   62  Free Memory = 74469 MB
Rank =   63  Free Memory = 74469 MB
Rank =   64  Free Memory = 72714 MB
Rank =   65  Free Memory = 72713 MB
Rank =   66  Free Memory = 72713 MB
Rank =   67  Free Memory = 72713 MB
Rank =   68  Free Memory = 72713 MB
Rank =   69  Free Memory = 72713 MB
Rank =   70  Free Memory = 72713 MB
Rank =   71  Free Memory = 72713 MB
Rank =   72  Free Memory = 72713 MB
Rank =   73  Free Memory = 72713 MB
Rank =   74  Free Memory = 72713 MB
Rank =   75  Free Memory = 72713 MB
Rank =   76  Free Memory = 72713 MB
Rank =   77  Free Memory = 72713 MB
Rank =   78  Free Memory = 72713 MB
Rank =   79  Free Memory = 72713 MB
Rank =   80  Free Memory = 72713 MB
Rank =   81  Free Memory = 72713 MB
Rank =   82  Free Memory = 72713 MB
Rank =   83  Free Memory = 72713 MB
Rank =   84  Free Memory = 72713 MB
Rank =   85  Free Memory = 72713 MB
Rank =   86  Free Memory = 72713 MB
Rank =   87  Free Memory = 72713 MB
Rank =   88  Free Memory = 72713 MB
Rank =   89  Free Memory = 72713 MB
Rank =   90  Free Memory = 72713 MB
Rank =   91  Free Memory = 72713 MB
Rank =   92  Free Memory = 72713 MB
Rank =   93  Free Memory = 72713 MB
Rank =   94  Free Memory = 72713 MB
Rank =   95  Free Memory = 72713 MB
Rank =   96  Free Memory = 75756 MB
Rank =   97  Free Memory = 75756 MB
Rank =   98  Free Memory = 75756 MB
Rank =   99  Free Memory = 75756 MB
Rank =  100  Free Memory = 75756 MB
Rank =  101  Free Memory = 75756 MB
Rank =  102  Free Memory = 75756 MB
Rank =  103  Free Memory = 75756 MB
Rank =  104  Free Memory = 75756 MB
Rank =  105  Free Memory = 75756 MB
Rank =  106  Free Memory = 75756 MB
Rank =  107  Free Memory = 75756 MB
Rank =  108  Free Memory = 75756 MB
Rank =  109  Free Memory = 75756 MB
Rank =  110  Free Memory = 75756 MB
Rank =  111  Free Memory = 75756 MB
Rank =  112  Free Memory = 75756 MB
Rank =  113  Free Memory = 75756 MB
Rank =  114  Free Memory = 75756 MB
Rank =  115  Free Memory = 75756 MB
Rank =  116  Free Memory = 75756 MB
Rank =  117  Free Memory = 75756 MB
Rank =  118  Free Memory = 75756 MB
Rank =  119  Free Memory = 75756 MB
Rank =  120  Free Memory = 75756 MB
Rank =  121  Free Memory = 75756 MB
Rank =  122  Free Memory = 75756 MB
Rank =  123  Free Memory = 75756 MB
Rank =  124  Free Memory = 75756 MB
Rank =  125  Free Memory = 75756 MB
Rank =  126  Free Memory = 75756 MB
Rank =  127  Free Memory = 75756 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001t.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001t.xml

  Project = H2O
  date    = 2023-04-19 10:15:44 PDT
  host    = n0102.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 448

  Range of prime numbers to use as seeds over processors and threads = 3181-4219


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.105499e-01    1         1  ON     0
     uu_1                 1.435169e-01    1         1  ON     1
     uu_2                 4.163781e-02    1         1  ON     2
     uu_3                -2.107832e-02    1         1  ON     3
     uu_4                -6.679031e-02    1         1  ON     4
     uu_5                -1.020169e-01    1         1  ON     5
     uu_6                -1.297253e-01    1         1  ON     6
     uu_7                -1.433469e-01    1         1  ON     7
     uu_8                -1.358422e-01    1         1  ON     8
     uu_9                -1.064395e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.503978e-01    1         1  ON     0
     ud_1                 1.843565e-01    1         1  ON     1
     ud_2                 6.372654e-02    1         1  ON     2
     ud_3                -7.851415e-03    1         1  ON     3
     ud_4                -6.538381e-02    1         1  ON     4
     ud_5                -1.075022e-01    1         1  ON     5
     ud_6                -1.356495e-01    1         1  ON     6
     ud_7                -1.522290e-01    1         1  ON     7
     ud_8                -1.534242e-01    1         1  ON     8
     ud_9                -1.444923e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.594644e-01    1         1  ON     0
     eO_1                -4.375015e-01    1         1  ON     1
     eO_2                -2.095566e-02    1         1  ON     2
     eO_3                 2.978489e-01    1         1  ON     3
     eO_4                 5.255749e-01    1         1  ON     4
     eO_5                 4.892200e-01    1         1  ON     5
     eO_6                 2.616892e-01    1         1  ON     6
     eO_7                -4.048244e-02    1         1  ON     7
     eO_8                -2.240866e-01    1         1  ON     8
     eO_9                -8.985011e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.510282e-01    1         1  ON     0
     eH1_1                -1.477987e-01    1         1  ON     1
     eH1_2                -9.932062e-02    1         1  ON     2
     eH1_3                -4.475800e-02    1         1  ON     3
     eH1_4                 3.650286e-03    1         1  ON     4
     eH1_5                 3.801546e-02    1         1  ON     5
     eH1_6                 9.670962e-02    1         1  ON     6
     eH1_7                 1.544749e-01    1         1  ON     7
     eH1_8                 1.807630e-01    1         1  ON     8
     eH1_9                 7.279657e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.490034e-01    1         1  ON     0
     eH2_1                -1.455784e-01    1         1  ON     1
     eH2_2                -9.723307e-02    1         1  ON     2
     eH2_3                -4.258757e-02    1         1  ON     3
     eH2_4                 6.513212e-03    1         1  ON     4
     eH2_5                 4.071767e-02    1         1  ON     5
     eH2_6                 9.941915e-02    1         1  ON     6
     eH2_7                 1.556200e-01    1         1  ON     7
     eH2_8                 1.854390e-01    1         1  ON     8
     eH2_9                 6.279383e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.743586e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.7967e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8564
    reference variance = 0.270447
====================================================
  Execution time = 3.4728e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3596e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336036238416
                                         uncertainty =       0.002794657998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336036238416
                                         uncertainty =       0.002794657998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409853379
  error estimate for blocks of size 2^( 2) =       0.000423410944
  error estimate for blocks of size 2^( 3) =       0.000437246002
  error estimate for blocks of size 2^( 4) =       0.000450907397
  error estimate for blocks of size 2^( 5) =       0.000464341304
  error estimate for blocks of size 2^( 6) =       0.000476331257
  error estimate for blocks of size 2^( 7) =       0.000487277832

      target function =                  N/A
              le_mean =     -16.905284896362
             les_mean =     286.124616843403
             stat err =       0.000469714448
             autocorr =       1.313441691465
              std dev =       0.579620206861
             le_variance =       0.335959584201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690528489636e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905284896362       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905284577709       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905282970774       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905283947677       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905284101457       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905284810933       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905286025599       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905286558349       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905286106121       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905286031497       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905286017757       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.269342e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905284896362       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905284774855       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905284176542       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905284332155       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905284481300       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905284464865       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905284791635       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905284985064       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905284913949       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.673071e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905284896362       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905284861394       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905284684959       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905284704719       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905284772472       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905284744169       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905284816088       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905284867674       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905284855024       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 9.524958e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.007472 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3984e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.107222e-01                 1 1 ON  0
uu_1  1.435061e-01                 1 1 ON  1
uu_2  4.157285e-02                 1 1 ON  2
uu_3  -2.115685e-02                1 1 ON  3
uu_4  -6.690005e-02                1 1 ON  4
uu_5  -1.020709e-01                1 1 ON  5
uu_6  -1.299103e-01                1 1 ON  6
uu_7  -1.435171e-01                1 1 ON  7
uu_8  -1.357695e-01                1 1 ON  8
uu_9  -1.063167e-01                1 1 ON  9
ud_0  4.504170e-01                 1 1 ON  10
ud_1  1.843117e-01                 1 1 ON  11
ud_2  6.363174e-02                 1 1 ON  12
ud_3  -7.905746e-03                1 1 ON  13
ud_4  -6.550781e-02                1 1 ON  14
ud_5  -1.075382e-01                1 1 ON  15
ud_6  -1.356685e-01                1 1 ON  16
ud_7  -1.522603e-01                1 1 ON  17
ud_8  -1.532558e-01                1 1 ON  18
ud_9  -1.443484e-01                1 1 ON  19
eO_0  -7.593357e-01                1 1 ON  20
eO_1  -4.375157e-01                1 1 ON  21
eO_2  -2.106468e-02                1 1 ON  22
eO_3  2.977925e-01                 1 1 ON  23
eO_4  5.256237e-01                 1 1 ON  24
eO_5  4.892619e-01                 1 1 ON  25
eO_6  2.616592e-01                 1 1 ON  26
eO_7  -4.044454e-02                1 1 ON  27
eO_8  -2.240228e-01                1 1 ON  28
eO_9  -8.994183e-02                1 1 ON  29
eH1_0 -2.512186e-01                1 1 ON  30
eH1_1 -1.479410e-01                1 1 ON  31
eH1_2 -9.948920e-02                1 1 ON  32
eH1_3 -4.482074e-02                1 1 ON  33
eH1_4 3.661363e-03                 1 1 ON  34
eH1_5 3.793736e-02                 1 1 ON  35
eH1_6 9.676523e-02                 1 1 ON  36
eH1_7 1.545807e-01                 1 1 ON  37
eH1_8 1.809396e-01                 1 1 ON  38
eH1_9 7.303367e-02                 1 1 ON  39
eH2_0 -2.493707e-01                1 1 ON  40
eH2_1 -1.456948e-01                1 1 ON  41
eH2_2 -9.718905e-02                1 1 ON  42
eH2_3 -4.261354e-02                1 1 ON  43
eH2_4 6.489351e-03                 1 1 ON  44
eH2_5 4.061573e-02                 1 1 ON  45
eH2_6 9.944873e-02                 1 1 ON  46
eH2_7 1.556819e-01                 1 1 ON  47
eH2_8 1.856090e-01                 1 1 ON  48
eH2_9 6.307240e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8676
    reference variance = 0.351967
====================================================
  Execution time = 3.3988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3441e-01
  Total weights = 2.0000e+06
  Execution time = 3.4975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334296985452
                                         uncertainty =       0.002939106479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334296985452
                                         uncertainty =       0.002939106479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408827832
  error estimate for blocks of size 2^( 2) =       0.000421545582
  error estimate for blocks of size 2^( 3) =       0.000434841027
  error estimate for blocks of size 2^( 4) =       0.000447101811
  error estimate for blocks of size 2^( 5) =       0.000457423708
  error estimate for blocks of size 2^( 6) =       0.000465407603
  error estimate for blocks of size 2^( 7) =       0.000471004306

      target function =                  N/A
              le_mean =     -16.906553127918
             les_mean =     286.165818892931
             stat err =       0.000460234357
             autocorr =       1.267293373108
              std dev =       0.578169865136
             le_variance =       0.334280392952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334590506824
                                         uncertainty =       0.002941620255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334590506824
                                         uncertainty =       0.002941620255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409007199
  error estimate for blocks of size 2^( 2) =       0.000421717176
  error estimate for blocks of size 2^( 3) =       0.000435008538
  error estimate for blocks of size 2^( 4) =       0.000447269043
  error estimate for blocks of size 2^( 5) =       0.000457580599
  error estimate for blocks of size 2^( 6) =       0.000465561358
  error estimate for blocks of size 2^( 7) =       0.000471154907

      target function =                  N/A
              le_mean =     -16.906557454961
             les_mean =     286.166258587754
             stat err =       0.000460391477
             autocorr =       1.267046769892
              std dev =       0.578423527493
             le_variance =       0.334573777158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334563277095
                                         uncertainty =       0.002941258747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334563277095
                                         uncertainty =       0.002941258747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408990585
  error estimate for blocks of size 2^( 2) =       0.000421700159
  error estimate for blocks of size 2^( 3) =       0.000434990986
  error estimate for blocks of size 2^( 4) =       0.000447250321
  error estimate for blocks of size 2^( 5) =       0.000457564418
  error estimate for blocks of size 2^( 6) =       0.000465546334
  error estimate for blocks of size 2^( 7) =       0.000471143803

      target function =                  N/A
              le_mean =     -16.906556401243
             les_mean =     286.166195778669
             stat err =       0.000460376219
             autocorr =       1.267065721240
              std dev =       0.578400032431
             le_variance =       0.334546597517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334340016441
                                         uncertainty =       0.002939453109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334340016441
                                         uncertainty =       0.002939453109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408854137
  error estimate for blocks of size 2^( 2) =       0.000421570425
  error estimate for blocks of size 2^( 3) =       0.000434865022
  error estimate for blocks of size 2^( 4) =       0.000447125491
  error estimate for blocks of size 2^( 5) =       0.000457446194
  error estimate for blocks of size 2^( 6) =       0.000465429753
  error estimate for blocks of size 2^( 7) =       0.000471026794

      target function =                  N/A
              le_mean =     -16.906553527786
             les_mean =     286.165875431630
             stat err =       0.000460257058
             autocorr =       1.267255313793
              std dev =       0.578207065754
             le_variance =       0.334323410888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906553127918        initial
     2.5000e-01     2.5000e+00             1.2693e-03       -16.906557454961  <--
     1.0000e+00     1.0000e+01             3.6731e-04       -16.906556401243
     4.0000e+00     4.0000e+01             9.5250e-05       -16.906553527786

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.0593e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.109278e-01 1 1  ON 0
 uu_1                 1.434465e-01 1 1  ON 1
 uu_2                 4.146947e-02 1 1  ON 2
 uu_3                -2.132172e-02 1 1  ON 3
 uu_4                -6.711775e-02 1 1  ON 4
 uu_5                -1.022977e-01 1 1  ON 5
 uu_6                -1.302758e-01 1 1  ON 6
 uu_7                -1.439664e-01 1 1  ON 7
 uu_8                -1.356576e-01 1 1  ON 8
 uu_9                -1.059800e-01 1 1  ON 9
 ud_0                 4.503568e-01 1 1  ON 10
 ud_1                 1.841560e-01 1 1  ON 11
 ud_2                 6.344572e-02 1 1  ON 12
 ud_3                -8.079380e-03 1 1  ON 13
 ud_4                -6.573970e-02 1 1  ON 14
 ud_5                -1.076846e-01 1 1  ON 15
 ud_6                -1.356864e-01 1 1  ON 16
 ud_7                -1.523207e-01 1 1  ON 17
 ud_8                -1.528598e-01 1 1  ON 18
 ud_9                -1.439399e-01 1 1  ON 19
 eO_0                -7.591577e-01 1 1  ON 20
 eO_1                -4.374728e-01 1 1  ON 21
 eO_2                -2.125528e-02 1 1  ON 22
 eO_3                 2.976125e-01 1 1  ON 23
 eO_4                 5.257332e-01 1 1  ON 24
 eO_5                 4.893955e-01 1 1  ON 25
 eO_6                 2.616300e-01 1 1  ON 26
 eO_7                -4.034217e-02 1 1  ON 27
 eO_8                -2.238505e-01 1 1  ON 28
 eO_9                -9.022119e-02 1 1  ON 29
eH1_0                -2.517889e-01 1 1  ON 30
eH1_1                -1.483756e-01 1 1  ON 31
eH1_2                -9.989975e-02 1 1  ON 32
eH1_3                -4.502122e-02 1 1  ON 33
eH1_4                 3.578173e-03 1 1  ON 34
eH1_5                 3.774340e-02 1 1  ON 35
eH1_6                 9.691248e-02 1 1  ON 36
eH1_7                 1.549032e-01 1 1  ON 37
eH1_8                 1.814751e-01 1 1  ON 38
eH1_9                 7.375026e-02 1 1  ON 39
eH2_0                -2.502727e-01 1 1  ON 40
eH2_1                -1.459856e-01 1 1  ON 41
eH2_2                -9.727058e-02 1 1  ON 42
eH2_3                -4.271058e-02 1 1  ON 43
eH2_4                 6.365337e-03 1 1  ON 44
eH2_5                 4.034836e-02 1 1  ON 45
eH2_6                 9.951233e-02 1 1  ON 46
eH2_7                 1.558707e-01 1 1  ON 47
eH2_8                 1.861215e-01 1 1  ON 48
eH2_9                 6.391377e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4586e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6862e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9249
    reference variance = 0.344449
====================================================
  Execution time = 3.4049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4930e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349352719279
                                         uncertainty =       0.008507622408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349352719279
                                         uncertainty =       0.008507622408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417911646
  error estimate for blocks of size 2^( 2) =       0.000430277180
  error estimate for blocks of size 2^( 3) =       0.000442549733
  error estimate for blocks of size 2^( 4) =       0.000454726927
  error estimate for blocks of size 2^( 5) =       0.000464942864
  error estimate for blocks of size 2^( 6) =       0.000472796906
  error estimate for blocks of size 2^( 7) =       0.000475740049

      target function =                  N/A
              le_mean =     -16.906235835004
             les_mean =     286.170110221317
             stat err =       0.000467051687
             autocorr =       1.248995698959
              std dev =       0.591016317210
             le_variance =       0.349300287209


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623583500e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906235835004       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238207607       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906241020162       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906243006015       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906246322827       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906249096342       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906251287805       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906250087377       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906253579036       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906253843801       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906252519279       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906252814425       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906252592916       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906252852973       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.550141e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906235835004       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906237110541       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906238347053       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906239097488       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906241022501       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906241595112       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906240922651       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906241456037       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906242079346       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906241783503       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.021812e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906235835004       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906236282630       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906236664027       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906236782793       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906237531414       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906237377478       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906237234979       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906237313476       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906237450336       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.880580e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3230e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.112577e-01 1 1  ON 0
 uu_1                 1.437666e-01 1 1  ON 1
 uu_2                 4.176485e-02 1 1  ON 2
 uu_3                -2.113008e-02 1 1  ON 3
 uu_4                -6.732741e-02 1 1  ON 4
 uu_5                -1.023902e-01 1 1  ON 5
 uu_6                -1.300947e-01 1 1  ON 6
 uu_7                -1.439755e-01 1 1  ON 7
 uu_8                -1.366794e-01 1 1  ON 8
 uu_9                -1.066398e-01 1 1  ON 9
 ud_0                 4.503703e-01 1 1  ON 10
 ud_1                 1.844078e-01 1 1  ON 11
 ud_2                 6.367176e-02 1 1  ON 12
 ud_3                -7.842691e-03 1 1  ON 13
 ud_4                -6.536713e-02 1 1  ON 14
 ud_5                -1.075299e-01 1 1  ON 15
 ud_6                -1.355667e-01 1 1  ON 16
 ud_7                -1.522117e-01 1 1  ON 17
 ud_8                -1.532888e-01 1 1  ON 18
 ud_9                -1.445490e-01 1 1  ON 19
 eO_0                -7.588815e-01 1 1  ON 20
 eO_1                -4.370290e-01 1 1  ON 21
 eO_2                -2.096278e-02 1 1  ON 22
 eO_3                 2.976604e-01 1 1  ON 23
 eO_4                 5.258548e-01 1 1  ON 24
 eO_5                 4.892856e-01 1 1  ON 25
 eO_6                 2.620324e-01 1 1  ON 26
 eO_7                -4.040290e-02 1 1  ON 27
 eO_8                -2.245223e-01 1 1  ON 28
 eO_9                -9.085208e-02 1 1  ON 29
eH1_0                -2.521566e-01 1 1  ON 30
eH1_1                -1.488677e-01 1 1  ON 31
eH1_2                -1.001413e-01 1 1  ON 32
eH1_3                -4.521231e-02 1 1  ON 33
eH1_4                 3.420849e-03 1 1  ON 34
eH1_5                 3.778876e-02 1 1  ON 35
eH1_6                 9.681372e-02 1 1  ON 36
eH1_7                 1.548274e-01 1 1  ON 37
eH1_8                 1.821993e-01 1 1  ON 38
eH1_9                 7.461817e-02 1 1  ON 39
eH2_0                -2.505427e-01 1 1  ON 40
eH2_1                -1.464840e-01 1 1  ON 41
eH2_2                -9.762313e-02 1 1  ON 42
eH2_3                -4.296758e-02 1 1  ON 43
eH2_4                 6.008696e-03 1 1  ON 44
eH2_5                 4.038842e-02 1 1  ON 45
eH2_6                 9.981415e-02 1 1  ON 46
eH2_7                 1.560270e-01 1 1  ON 47
eH2_8                 1.865353e-01 1 1  ON 48
eH2_9                 6.466603e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9301
    reference variance = 0.174018
====================================================
  Execution time = 3.3246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3834e-01
  Total weights = 2.0000e+06
  Execution time = 3.1663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337709752170
                                         uncertainty =       0.004059995822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337709752170
                                         uncertainty =       0.004059995822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411405475
  error estimate for blocks of size 2^( 2) =       0.000423752136
  error estimate for blocks of size 2^( 3) =       0.000436641290
  error estimate for blocks of size 2^( 4) =       0.000448500349
  error estimate for blocks of size 2^( 5) =       0.000459345950
  error estimate for blocks of size 2^( 6) =       0.000466092166
  error estimate for blocks of size 2^( 7) =       0.000474307663

      target function =                  N/A
              le_mean =     -16.906149723571
             les_mean =     286.156407235570
             stat err =       0.000462061532
             autocorr =       1.261419367348
              std dev =       0.581815201776
             le_variance =       0.338508929018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337502000558
                                         uncertainty =       0.004058846991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337502000558
                                         uncertainty =       0.004058846991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411279597
  error estimate for blocks of size 2^( 2) =       0.000423615702
  error estimate for blocks of size 2^( 3) =       0.000436489808
  error estimate for blocks of size 2^( 4) =       0.000448341145
  error estimate for blocks of size 2^( 5) =       0.000459196003
  error estimate for blocks of size 2^( 6) =       0.000465952180
  error estimate for blocks of size 2^( 7) =       0.000474172408

      target function =                  N/A
              le_mean =     -16.906154458433
             les_mean =     286.156360217533
             stat err =       0.000461915434
             autocorr =       1.261393578916
              std dev =       0.581637184412
             le_variance =       0.338301814291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337373595917
                                         uncertainty =       0.004057380391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337373595917
                                         uncertainty =       0.004057380391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411201153
  error estimate for blocks of size 2^( 2) =       0.000423543692
  error estimate for blocks of size 2^( 3) =       0.000436425662
  error estimate for blocks of size 2^( 4) =       0.000448281815
  error estimate for blocks of size 2^( 5) =       0.000459141950
  error estimate for blocks of size 2^( 6) =       0.000465896684
  error estimate for blocks of size 2^( 7) =       0.000474116604

      target function =                  N/A
              le_mean =     -16.906155907942
             les_mean =     286.156280191279
             stat err =       0.000461859263
             autocorr =       1.261568012500
              std dev =       0.581526247662
             le_variance =       0.338172776720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337611389307
                                         uncertainty =       0.004058987933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337611389307
                                         uncertainty =       0.004058987933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411345616
  error estimate for blocks of size 2^( 2) =       0.000423692873
  error estimate for blocks of size 2^( 3) =       0.000436582219
  error estimate for blocks of size 2^( 4) =       0.000448441718
  error estimate for blocks of size 2^( 5) =       0.000459290949
  error estimate for blocks of size 2^( 6) =       0.000466038794
  error estimate for blocks of size 2^( 7) =       0.000474254737

      target function =                  N/A
              le_mean =     -16.906150466157
             les_mean =     286.156333847140
             stat err =       0.000462006549
             autocorr =       1.261486239516
              std dev =       0.581730549321
             le_variance =       0.338410432013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906149723571        initial
     6.2500e-02     6.2500e-01             3.5501e-03       -16.906154458433
     2.5000e-01     2.5000e+00             1.0218e-03       -16.906155907942  <--
     1.0000e+00     1.0000e+01             2.8806e-04       -16.906150466157

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.9223e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.112577e-01 1 1  ON 0
 uu_1                 1.437666e-01 1 1  ON 1
 uu_2                 4.176485e-02 1 1  ON 2
 uu_3                -2.113008e-02 1 1  ON 3
 uu_4                -6.732741e-02 1 1  ON 4
 uu_5                -1.023902e-01 1 1  ON 5
 uu_6                -1.300947e-01 1 1  ON 6
 uu_7                -1.439755e-01 1 1  ON 7
 uu_8                -1.366794e-01 1 1  ON 8
 uu_9                -1.066398e-01 1 1  ON 9
 ud_0                 4.503703e-01 1 1  ON 10
 ud_1                 1.844078e-01 1 1  ON 11
 ud_2                 6.367176e-02 1 1  ON 12
 ud_3                -7.842691e-03 1 1  ON 13
 ud_4                -6.536713e-02 1 1  ON 14
 ud_5                -1.075299e-01 1 1  ON 15
 ud_6                -1.355667e-01 1 1  ON 16
 ud_7                -1.522117e-01 1 1  ON 17
 ud_8                -1.532888e-01 1 1  ON 18
 ud_9                -1.445490e-01 1 1  ON 19
 eO_0                -7.588815e-01 1 1  ON 20
 eO_1                -4.370290e-01 1 1  ON 21
 eO_2                -2.096278e-02 1 1  ON 22
 eO_3                 2.976604e-01 1 1  ON 23
 eO_4                 5.258548e-01 1 1  ON 24
 eO_5                 4.892856e-01 1 1  ON 25
 eO_6                 2.620324e-01 1 1  ON 26
 eO_7                -4.040290e-02 1 1  ON 27
 eO_8                -2.245223e-01 1 1  ON 28
 eO_9                -9.085208e-02 1 1  ON 29
eH1_0                -2.521566e-01 1 1  ON 30
eH1_1                -1.488677e-01 1 1  ON 31
eH1_2                -1.001413e-01 1 1  ON 32
eH1_3                -4.521231e-02 1 1  ON 33
eH1_4                 3.420849e-03 1 1  ON 34
eH1_5                 3.778876e-02 1 1  ON 35
eH1_6                 9.681372e-02 1 1  ON 36
eH1_7                 1.548274e-01 1 1  ON 37
eH1_8                 1.821993e-01 1 1  ON 38
eH1_9                 7.461817e-02 1 1  ON 39
eH2_0                -2.505427e-01 1 1  ON 40
eH2_1                -1.464840e-01 1 1  ON 41
eH2_2                -9.762313e-02 1 1  ON 42
eH2_3                -4.296758e-02 1 1  ON 43
eH2_4                 6.008696e-03 1 1  ON 44
eH2_5                 4.038842e-02 1 1  ON 45
eH2_6                 9.981415e-02 1 1  ON 46
eH2_7                 1.560270e-01 1 1  ON 47
eH2_8                 1.865353e-01 1 1  ON 48
eH2_9                 6.466603e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2463e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8471
    reference variance = 0.15794
====================================================
  Execution time = 3.3734e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3654e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336629606941
                                         uncertainty =       0.003150849566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336629606941
                                         uncertainty =       0.003150849566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410209945
  error estimate for blocks of size 2^( 2) =       0.000422897436
  error estimate for blocks of size 2^( 3) =       0.000435089133
  error estimate for blocks of size 2^( 4) =       0.000446245319
  error estimate for blocks of size 2^( 5) =       0.000455117247
  error estimate for blocks of size 2^( 6) =       0.000461424413
  error estimate for blocks of size 2^( 7) =       0.000464423673

      target function =                  N/A
              le_mean =     -16.906631645573
             les_mean =     286.170737828888
             stat err =       0.000456802663
             autocorr =       1.240066238677
              std dev =       0.580124467736
             le_variance =       0.336544398066


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663164557e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906631645573       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906636946048       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906636442036       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906638111750       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906640448880       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906640378467       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906642067414       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906642859670       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906643814372       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906643568352       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906644454778       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906644170237       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906644096030       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906644378314       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.674146e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906631645573       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906634257951       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906633940911       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906634813204       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906635273688       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906634996503       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906635459300       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906636095107       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906635985586       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906636067007       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.927035e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906631645573       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906632508150       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906632411524       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906632759921       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906632734093       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906632738029       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906632812726       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906632949159       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906632916544       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.058477e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2901e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.116326e-01 1 1  ON 0
 uu_1                 1.441044e-01 1 1  ON 1
 uu_2                 4.196041e-02 1 1  ON 2
 uu_3                -2.104797e-02 1 1  ON 3
 uu_4                -6.710591e-02 1 1  ON 4
 uu_5                -1.023742e-01 1 1  ON 5
 uu_6                -1.304310e-01 1 1  ON 6
 uu_7                -1.445003e-01 1 1  ON 7
 uu_8                -1.372690e-01 1 1  ON 8
 uu_9                -1.069094e-01 1 1  ON 9
 ud_0                 4.502310e-01 1 1  ON 10
 ud_1                 1.844666e-01 1 1  ON 11
 ud_2                 6.386995e-02 1 1  ON 12
 ud_3                -7.675436e-03 1 1  ON 13
 ud_4                -6.520418e-02 1 1  ON 14
 ud_5                -1.075548e-01 1 1  ON 15
 ud_6                -1.354477e-01 1 1  ON 16
 ud_7                -1.524123e-01 1 1  ON 17
 ud_8                -1.533162e-01 1 1  ON 18
 ud_9                -1.444203e-01 1 1  ON 19
 eO_0                -7.585871e-01 1 1  ON 20
 eO_1                -4.365721e-01 1 1  ON 21
 eO_2                -2.052021e-02 1 1  ON 22
 eO_3                 2.977200e-01 1 1  ON 23
 eO_4                 5.253913e-01 1 1  ON 24
 eO_5                 4.894675e-01 1 1  ON 25
 eO_6                 2.622269e-01 1 1  ON 26
 eO_7                -4.052130e-02 1 1  ON 27
 eO_8                -2.250249e-01 1 1  ON 28
 eO_9                -9.132105e-02 1 1  ON 29
eH1_0                -2.531493e-01 1 1  ON 30
eH1_1                -1.488992e-01 1 1  ON 31
eH1_2                -9.996215e-02 1 1  ON 32
eH1_3                -4.517114e-02 1 1  ON 33
eH1_4                 3.371419e-03 1 1  ON 34
eH1_5                 3.754003e-02 1 1  ON 35
eH1_6                 9.664791e-02 1 1  ON 36
eH1_7                 1.548418e-01 1 1  ON 37
eH1_8                 1.826581e-01 1 1  ON 38
eH1_9                 7.528448e-02 1 1  ON 39
eH2_0                -2.511687e-01 1 1  ON 40
eH2_1                -1.469240e-01 1 1  ON 41
eH2_2                -9.775301e-02 1 1  ON 42
eH2_3                -4.312941e-02 1 1  ON 43
eH2_4                 6.076693e-03 1 1  ON 44
eH2_5                 4.061586e-02 1 1  ON 45
eH2_6                 1.000259e-01 1 1  ON 46
eH2_7                 1.561991e-01 1 1  ON 47
eH2_8                 1.868087e-01 1 1  ON 48
eH2_9                 6.514719e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.184479
====================================================
  Execution time = 3.3508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3827e-01
  Total weights = 2.0000e+06
  Execution time = 3.1755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338486219351
                                         uncertainty =       0.005879658336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338486219351
                                         uncertainty =       0.005879658336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411425735
  error estimate for blocks of size 2^( 2) =       0.000424339346
  error estimate for blocks of size 2^( 3) =       0.000437776880
  error estimate for blocks of size 2^( 4) =       0.000450588456
  error estimate for blocks of size 2^( 5) =       0.000461653061
  error estimate for blocks of size 2^( 6) =       0.000471147393
  error estimate for blocks of size 2^( 7) =       0.000478570480

      target function =                  N/A
              le_mean =     -16.907116404205
             les_mean =     286.189127207202
             stat err =       0.000465489847
             autocorr =       1.280081198362
              std dev =       0.581843854610
             le_variance =       0.338542271147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338121940740
                                         uncertainty =       0.005889048002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338121940740
                                         uncertainty =       0.005889048002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411204226
  error estimate for blocks of size 2^( 2) =       0.000424125495
  error estimate for blocks of size 2^( 3) =       0.000437567646
  error estimate for blocks of size 2^( 4) =       0.000450385727
  error estimate for blocks of size 2^( 5) =       0.000461466053
  error estimate for blocks of size 2^( 6) =       0.000470986949
  error estimate for blocks of size 2^( 7) =       0.000478422121

      target function =                  N/A
              le_mean =     -16.907116106652
             les_mean =     286.188752705272
             stat err =       0.000465315213
             autocorr =       1.280499355980
              std dev =       0.581530592949
             le_variance =       0.338177830536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337957812511
                                         uncertainty =       0.005878966323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337957812511
                                         uncertainty =       0.005878966323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411104416
  error estimate for blocks of size 2^( 2) =       0.000424033409
  error estimate for blocks of size 2^( 3) =       0.000437483649
  error estimate for blocks of size 2^( 4) =       0.000450309820
  error estimate for blocks of size 2^( 5) =       0.000461394423
  error estimate for blocks of size 2^( 6) =       0.000470915835
  error estimate for blocks of size 2^( 7) =       0.000478350710

      target function =                  N/A
              le_mean =     -16.907114781977
             les_mean =     286.188543762940
             stat err =       0.000465242697
             autocorr =       1.280721930524
              std dev =       0.581389440055
             le_variance =       0.338013681008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338362645679
                                         uncertainty =       0.005877391325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338362645679
                                         uncertainty =       0.005877391325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411350619
  error estimate for blocks of size 2^( 2) =       0.000424267889
  error estimate for blocks of size 2^( 3) =       0.000437708518
  error estimate for blocks of size 2^( 4) =       0.000450523262
  error estimate for blocks of size 2^( 5) =       0.000461591978
  error estimate for blocks of size 2^( 6) =       0.000471091412
  error estimate for blocks of size 2^( 7) =       0.000478516377

      target function =                  N/A
              le_mean =     -16.907115507849
             les_mean =     286.188973289879
             stat err =       0.000465430757
             autocorr =       1.280223659081
              std dev =       0.581737624130
             le_variance =       0.338418663328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907116404205        initial  <--
     6.2500e-02     6.2500e-01             2.6741e-03       -16.907116106652
     2.5000e-01     2.5000e+00             9.9270e-04       -16.907114781977
     1.0000e+00     1.0000e+01             3.0585e-04       -16.907115507849

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.4631
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.112577e-01 1 1  ON 0
 uu_1                 1.437666e-01 1 1  ON 1
 uu_2                 4.176485e-02 1 1  ON 2
 uu_3                -2.113008e-02 1 1  ON 3
 uu_4                -6.732741e-02 1 1  ON 4
 uu_5                -1.023902e-01 1 1  ON 5
 uu_6                -1.300947e-01 1 1  ON 6
 uu_7                -1.439755e-01 1 1  ON 7
 uu_8                -1.366794e-01 1 1  ON 8
 uu_9                -1.066398e-01 1 1  ON 9
 ud_0                 4.503703e-01 1 1  ON 10
 ud_1                 1.844078e-01 1 1  ON 11
 ud_2                 6.367176e-02 1 1  ON 12
 ud_3                -7.842691e-03 1 1  ON 13
 ud_4                -6.536713e-02 1 1  ON 14
 ud_5                -1.075299e-01 1 1  ON 15
 ud_6                -1.355667e-01 1 1  ON 16
 ud_7                -1.522117e-01 1 1  ON 17
 ud_8                -1.532888e-01 1 1  ON 18
 ud_9                -1.445490e-01 1 1  ON 19
 eO_0                -7.588815e-01 1 1  ON 20
 eO_1                -4.370290e-01 1 1  ON 21
 eO_2                -2.096278e-02 1 1  ON 22
 eO_3                 2.976604e-01 1 1  ON 23
 eO_4                 5.258548e-01 1 1  ON 24
 eO_5                 4.892856e-01 1 1  ON 25
 eO_6                 2.620324e-01 1 1  ON 26
 eO_7                -4.040290e-02 1 1  ON 27
 eO_8                -2.245223e-01 1 1  ON 28
 eO_9                -9.085208e-02 1 1  ON 29
eH1_0                -2.521566e-01 1 1  ON 30
eH1_1                -1.488677e-01 1 1  ON 31
eH1_2                -1.001413e-01 1 1  ON 32
eH1_3                -4.521231e-02 1 1  ON 33
eH1_4                 3.420849e-03 1 1  ON 34
eH1_5                 3.778876e-02 1 1  ON 35
eH1_6                 9.681372e-02 1 1  ON 36
eH1_7                 1.548274e-01 1 1  ON 37
eH1_8                 1.821993e-01 1 1  ON 38
eH1_9                 7.461817e-02 1 1  ON 39
eH2_0                -2.505427e-01 1 1  ON 40
eH2_1                -1.464840e-01 1 1  ON 41
eH2_2                -9.762313e-02 1 1  ON 42
eH2_3                -4.296758e-02 1 1  ON 43
eH2_4                 6.008696e-03 1 1  ON 44
eH2_5                 4.038842e-02 1 1  ON 45
eH2_6                 9.981415e-02 1 1  ON 46
eH2_7                 1.560270e-01 1 1  ON 47
eH2_8                 1.865353e-01 1 1  ON 48
eH2_9                 6.466603e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2372e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9041
    reference variance = 0.219293
====================================================
  Execution time = 3.3754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3419e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334285417471
                                         uncertainty =       0.003147779609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334285417471
                                         uncertainty =       0.003147779609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408771085
  error estimate for blocks of size 2^( 2) =       0.000421538473
  error estimate for blocks of size 2^( 3) =       0.000434835897
  error estimate for blocks of size 2^( 4) =       0.000446600407
  error estimate for blocks of size 2^( 5) =       0.000456308454
  error estimate for blocks of size 2^( 6) =       0.000465601989
  error estimate for blocks of size 2^( 7) =       0.000470129479

      target function =                  N/A
              le_mean =     -16.905236144379
             les_mean =     286.121196530023
             stat err =       0.000459660082
             autocorr =       1.264483729134
              std dev =       0.578089612349
             le_variance =       0.334187599906


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690523614438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905236144379       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905236261150       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905236115154       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905236759145       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905236957177       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905237066892       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905236958590       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905236852338       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905236953484       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.465315e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905236144379       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905236182000       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905236128587       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905236338523       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905236434501       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905236483406       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905236466146       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905236454392       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.603135e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905236144379       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905236154516       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905236139600       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905236196373       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905236224840       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905236239466       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905236238273       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905236237206       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.160180e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3106e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.112533e-01 1 1  ON 0
 uu_1                 1.437791e-01 1 1  ON 1
 uu_2                 4.176346e-02 1 1  ON 2
 uu_3                -2.111522e-02 1 1  ON 3
 uu_4                -6.729079e-02 1 1  ON 4
 uu_5                -1.024237e-01 1 1  ON 5
 uu_6                -1.301451e-01 1 1  ON 6
 uu_7                -1.440230e-01 1 1  ON 7
 uu_8                -1.366903e-01 1 1  ON 8
 uu_9                -1.066276e-01 1 1  ON 9
 ud_0                 4.504087e-01 1 1  ON 10
 ud_1                 1.843866e-01 1 1  ON 11
 ud_2                 6.367173e-02 1 1  ON 12
 ud_3                -7.873924e-03 1 1  ON 13
 ud_4                -6.535492e-02 1 1  ON 14
 ud_5                -1.075767e-01 1 1  ON 15
 ud_6                -1.355363e-01 1 1  ON 16
 ud_7                -1.522175e-01 1 1  ON 17
 ud_8                -1.532521e-01 1 1  ON 18
 ud_9                -1.445302e-01 1 1  ON 19
 eO_0                -7.588201e-01 1 1  ON 20
 eO_1                -4.370418e-01 1 1  ON 21
 eO_2                -2.093731e-02 1 1  ON 22
 eO_3                 2.976417e-01 1 1  ON 23
 eO_4                 5.258279e-01 1 1  ON 24
 eO_5                 4.892972e-01 1 1  ON 25
 eO_6                 2.620461e-01 1 1  ON 26
 eO_7                -4.038036e-02 1 1  ON 27
 eO_8                -2.245462e-01 1 1  ON 28
 eO_9                -9.089367e-02 1 1  ON 29
eH1_0                -2.522138e-01 1 1  ON 30
eH1_1                -1.489152e-01 1 1  ON 31
eH1_2                -1.001472e-01 1 1  ON 32
eH1_3                -4.525806e-02 1 1  ON 33
eH1_4                 3.399122e-03 1 1  ON 34
eH1_5                 3.779093e-02 1 1  ON 35
eH1_6                 9.681064e-02 1 1  ON 36
eH1_7                 1.548517e-01 1 1  ON 37
eH1_8                 1.822517e-01 1 1  ON 38
eH1_9                 7.470420e-02 1 1  ON 39
eH2_0                -2.505785e-01 1 1  ON 40
eH2_1                -1.465139e-01 1 1  ON 41
eH2_2                -9.766871e-02 1 1  ON 42
eH2_3                -4.298724e-02 1 1  ON 43
eH2_4                 5.977916e-03 1 1  ON 44
eH2_5                 4.040446e-02 1 1  ON 45
eH2_6                 9.982957e-02 1 1  ON 46
eH2_7                 1.560631e-01 1 1  ON 47
eH2_8                 1.865632e-01 1 1  ON 48
eH2_9                 6.473239e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9604
    reference variance = 0.189098
====================================================
  Execution time = 3.3282e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.7177e-01
  Total weights = 2.0000e+06
  Execution time = 3.1643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371693296735
                                         uncertainty =       0.033367456555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371693296735
                                         uncertainty =       0.033367456555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431119889
  error estimate for blocks of size 2^( 2) =       0.000443312914
  error estimate for blocks of size 2^( 3) =       0.000455709010
  error estimate for blocks of size 2^( 4) =       0.000467165480
  error estimate for blocks of size 2^( 5) =       0.000476701256
  error estimate for blocks of size 2^( 6) =       0.000481993920
  error estimate for blocks of size 2^( 7) =       0.000486151597

      target function =                  N/A
              le_mean =     -16.907049731921
             les_mean =     286.220059168913
             stat err =       0.000478003063
             autocorr =       1.229320835095
              std dev =       0.609695593816
             le_variance =       0.371728717119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371774570808
                                         uncertainty =       0.033385092751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371774570808
                                         uncertainty =       0.033385092751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431167011
  error estimate for blocks of size 2^( 2) =       0.000443359019
  error estimate for blocks of size 2^( 3) =       0.000455754895
  error estimate for blocks of size 2^( 4) =       0.000467209694
  error estimate for blocks of size 2^( 5) =       0.000476744500
  error estimate for blocks of size 2^( 6) =       0.000482034998
  error estimate for blocks of size 2^( 7) =       0.000486196755

      target function =                  N/A
              le_mean =     -16.907048198812
             les_mean =     286.220088593347
             stat err =       0.000478046487
             autocorr =       1.229275459593
              std dev =       0.609762234234
             le_variance =       0.371809982298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371776527538
                                         uncertainty =       0.033386907825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371776527538
                                         uncertainty =       0.033386907825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431168145
  error estimate for blocks of size 2^( 2) =       0.000443359765
  error estimate for blocks of size 2^( 3) =       0.000455755086
  error estimate for blocks of size 2^( 4) =       0.000467210052
  error estimate for blocks of size 2^( 5) =       0.000476744954
  error estimate for blocks of size 2^( 6) =       0.000482036199
  error estimate for blocks of size 2^( 7) =       0.000486196774

      target function =                  N/A
              le_mean =     -16.907048728800
             les_mean =     286.220108470847
             stat err =       0.000478046995
             autocorr =       1.229271604177
              std dev =       0.609763838483
             le_variance =       0.371811938722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371705384316
                                         uncertainty =       0.033370399061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371705384316
                                         uncertainty =       0.033370399061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431126897
  error estimate for blocks of size 2^( 2) =       0.000443319718
  error estimate for blocks of size 2^( 3) =       0.000455715695
  error estimate for blocks of size 2^( 4) =       0.000467171940
  error estimate for blocks of size 2^( 5) =       0.000476707592
  error estimate for blocks of size 2^( 6) =       0.000482000055
  error estimate for blocks of size 2^( 7) =       0.000486158126

      target function =                  N/A
              le_mean =     -16.907049588258
             les_mean =     286.220066396998
             stat err =       0.000478009428
             autocorr =       1.229313605369
              std dev =       0.609705505182
             le_variance =       0.371740803049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907049731921        initial  <--
     6.2500e-01     6.2500e+00             3.4653e-04       -16.907048198812
     2.5000e+00     2.5000e+01             8.6031e-05       -16.907048728800
     1.0000e+01     1.0000e+02             2.1602e-05       -16.907049588258

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.1832
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.112577e-01 1 1  ON 0
 uu_1                 1.437666e-01 1 1  ON 1
 uu_2                 4.176485e-02 1 1  ON 2
 uu_3                -2.113008e-02 1 1  ON 3
 uu_4                -6.732741e-02 1 1  ON 4
 uu_5                -1.023902e-01 1 1  ON 5
 uu_6                -1.300947e-01 1 1  ON 6
 uu_7                -1.439755e-01 1 1  ON 7
 uu_8                -1.366794e-01 1 1  ON 8
 uu_9                -1.066398e-01 1 1  ON 9
 ud_0                 4.503703e-01 1 1  ON 10
 ud_1                 1.844078e-01 1 1  ON 11
 ud_2                 6.367176e-02 1 1  ON 12
 ud_3                -7.842691e-03 1 1  ON 13
 ud_4                -6.536713e-02 1 1  ON 14
 ud_5                -1.075299e-01 1 1  ON 15
 ud_6                -1.355667e-01 1 1  ON 16
 ud_7                -1.522117e-01 1 1  ON 17
 ud_8                -1.532888e-01 1 1  ON 18
 ud_9                -1.445490e-01 1 1  ON 19
 eO_0                -7.588815e-01 1 1  ON 20
 eO_1                -4.370290e-01 1 1  ON 21
 eO_2                -2.096278e-02 1 1  ON 22
 eO_3                 2.976604e-01 1 1  ON 23
 eO_4                 5.258548e-01 1 1  ON 24
 eO_5                 4.892856e-01 1 1  ON 25
 eO_6                 2.620324e-01 1 1  ON 26
 eO_7                -4.040290e-02 1 1  ON 27
 eO_8                -2.245223e-01 1 1  ON 28
 eO_9                -9.085208e-02 1 1  ON 29
eH1_0                -2.521566e-01 1 1  ON 30
eH1_1                -1.488677e-01 1 1  ON 31
eH1_2                -1.001413e-01 1 1  ON 32
eH1_3                -4.521231e-02 1 1  ON 33
eH1_4                 3.420849e-03 1 1  ON 34
eH1_5                 3.778876e-02 1 1  ON 35
eH1_6                 9.681372e-02 1 1  ON 36
eH1_7                 1.548274e-01 1 1  ON 37
eH1_8                 1.821993e-01 1 1  ON 38
eH1_9                 7.461817e-02 1 1  ON 39
eH2_0                -2.505427e-01 1 1  ON 40
eH2_1                -1.464840e-01 1 1  ON 41
eH2_2                -9.762313e-02 1 1  ON 42
eH2_3                -4.296758e-02 1 1  ON 43
eH2_4                 6.008696e-03 1 1  ON 44
eH2_5                 4.038842e-02 1 1  ON 45
eH2_6                 9.981415e-02 1 1  ON 46
eH2_7                 1.560270e-01 1 1  ON 47
eH2_8                 1.865353e-01 1 1  ON 48
eH2_9                 6.466603e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.96
    reference variance = 0.316034
====================================================
  Execution time = 3.6602e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4360e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343669230752
                                         uncertainty =       0.005882962108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343669230752
                                         uncertainty =       0.005882962108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414484934
  error estimate for blocks of size 2^( 2) =       0.000426712602
  error estimate for blocks of size 2^( 3) =       0.000438644187
  error estimate for blocks of size 2^( 4) =       0.000450422814
  error estimate for blocks of size 2^( 5) =       0.000461625803
  error estimate for blocks of size 2^( 6) =       0.000469031060
  error estimate for blocks of size 2^( 7) =       0.000474614340

      target function =                  N/A
              le_mean =     -16.906320256525
             les_mean =     286.167259965324
             stat err =       0.000463923504
             autocorr =       1.252781277884
              std dev =       0.586170214982
             le_variance =       0.343595520932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632025653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906320256525       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906320297208       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906320347875       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906320310922       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906320310330       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906320281024       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906320317262       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906320325259       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.302568e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906320256525       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906320266961       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906320279884       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906320270491       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906320270300       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906320262263       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906320271258       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906320272975       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.081106e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906320256525       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906320259151       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906320262398       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906320260041       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906320259991       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906320257935       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906320260178       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906320260587       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.705950e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023059 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.6049e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.112580e-01 1 1  ON 0
 uu_1                 1.437688e-01 1 1  ON 1
 uu_2                 4.176591e-02 1 1  ON 2
 uu_3                -2.112944e-02 1 1  ON 3
 uu_4                -6.732359e-02 1 1  ON 4
 uu_5                -1.023933e-01 1 1  ON 5
 uu_6                -1.300943e-01 1 1  ON 6
 uu_7                -1.439746e-01 1 1  ON 7
 uu_8                -1.366842e-01 1 1  ON 8
 uu_9                -1.066457e-01 1 1  ON 9
 ud_0                 4.503698e-01 1 1  ON 10
 ud_1                 1.844095e-01 1 1  ON 11
 ud_2                 6.367476e-02 1 1  ON 12
 ud_3                -7.838837e-03 1 1  ON 13
 ud_4                -6.536739e-02 1 1  ON 14
 ud_5                -1.075225e-01 1 1  ON 15
 ud_6                -1.355619e-01 1 1  ON 16
 ud_7                -1.522170e-01 1 1  ON 17
 ud_8                -1.532961e-01 1 1  ON 18
 ud_9                -1.445542e-01 1 1  ON 19
 eO_0                -7.588744e-01 1 1  ON 20
 eO_1                -4.370263e-01 1 1  ON 21
 eO_2                -2.096268e-02 1 1  ON 22
 eO_3                 2.976578e-01 1 1  ON 23
 eO_4                 5.258537e-01 1 1  ON 24
 eO_5                 4.892875e-01 1 1  ON 25
 eO_6                 2.620351e-01 1 1  ON 26
 eO_7                -4.040017e-02 1 1  ON 27
 eO_8                -2.245284e-01 1 1  ON 28
 eO_9                -9.085822e-02 1 1  ON 29
eH1_0                -2.521674e-01 1 1  ON 30
eH1_1                -1.488751e-01 1 1  ON 31
eH1_2                -1.001369e-01 1 1  ON 32
eH1_3                -4.521184e-02 1 1  ON 33
eH1_4                 3.422525e-03 1 1  ON 34
eH1_5                 3.779217e-02 1 1  ON 35
eH1_6                 9.681273e-02 1 1  ON 36
eH1_7                 1.548253e-01 1 1  ON 37
eH1_8                 1.822033e-01 1 1  ON 38
eH1_9                 7.462521e-02 1 1  ON 39
eH2_0                -2.505481e-01 1 1  ON 40
eH2_1                -1.464859e-01 1 1  ON 41
eH2_2                -9.762670e-02 1 1  ON 42
eH2_3                -4.296641e-02 1 1  ON 43
eH2_4                 6.008172e-03 1 1  ON 44
eH2_5                 4.038977e-02 1 1  ON 45
eH2_6                 9.981282e-02 1 1  ON 46
eH2_7                 1.560249e-01 1 1  ON 47
eH2_8                 1.865397e-01 1 1  ON 48
eH2_9                 6.467383e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8061
    reference variance = 0.180756
====================================================
  Execution time = 3.3619e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3675e-01
  Total weights = 2.0000e+06
  Execution time = 3.1524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336282898178
                                         uncertainty =       0.003662319213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336282898178
                                         uncertainty =       0.003662319213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410339484
  error estimate for blocks of size 2^( 2) =       0.000422741054
  error estimate for blocks of size 2^( 3) =       0.000435257872
  error estimate for blocks of size 2^( 4) =       0.000446013251
  error estimate for blocks of size 2^( 5) =       0.000455895413
  error estimate for blocks of size 2^( 6) =       0.000463409836
  error estimate for blocks of size 2^( 7) =       0.000465869359

      target function =                  N/A
              le_mean =     -16.905809980957
             les_mean =     286.143167928389
             stat err =       0.000457796965
             autocorr =       1.244684272046
              std dev =       0.580307663707
             le_variance =       0.336756984557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336265863677
                                         uncertainty =       0.003662136881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336265863677
                                         uncertainty =       0.003662136881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410329088
  error estimate for blocks of size 2^( 2) =       0.000422731032
  error estimate for blocks of size 2^( 3) =       0.000435247923
  error estimate for blocks of size 2^( 4) =       0.000446003640
  error estimate for blocks of size 2^( 5) =       0.000455886248
  error estimate for blocks of size 2^( 6) =       0.000463401328
  error estimate for blocks of size 2^( 7) =       0.000465861499

      target function =                  N/A
              le_mean =     -16.905809763008
             les_mean =     286.143143496101
             stat err =       0.000457788179
             autocorr =       1.244699562174
              std dev =       0.580292961746
             le_variance =       0.336739921452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336274152654
                                         uncertainty =       0.003662225580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336274152654
                                         uncertainty =       0.003662225580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410334147
  error estimate for blocks of size 2^( 2) =       0.000422735912
  error estimate for blocks of size 2^( 3) =       0.000435252769
  error estimate for blocks of size 2^( 4) =       0.000446008326
  error estimate for blocks of size 2^( 5) =       0.000455890713
  error estimate for blocks of size 2^( 6) =       0.000463405465
  error estimate for blocks of size 2^( 7) =       0.000465865318

      target function =                  N/A
              le_mean =     -16.905809865310
             les_mean =     286.143155258272
             stat err =       0.000457792455
             autocorr =       1.244692128793
              std dev =       0.580300115990
             le_variance =       0.336748224618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336281796899
                                         uncertainty =       0.003662307428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336281796899
                                         uncertainty =       0.003662307428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410338812
  error estimate for blocks of size 2^( 2) =       0.000422740406
  error estimate for blocks of size 2^( 3) =       0.000435257229
  error estimate for blocks of size 2^( 4) =       0.000446012631
  error estimate for blocks of size 2^( 5) =       0.000455894821
  error estimate for blocks of size 2^( 6) =       0.000463409286
  error estimate for blocks of size 2^( 7) =       0.000465868850

      target function =                  N/A
              le_mean =     -16.905809966197
             les_mean =     286.143166326244
             stat err =       0.000457796397
             autocorr =       1.244685260870
              std dev =       0.580306713275
             le_variance =       0.336755881472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905809980957        initial  <--
     6.2500e+00     6.2500e+01             4.3026e-05       -16.905809763008
     2.5000e+01     2.5000e+02             1.0811e-05       -16.905809865310
     1.0000e+02     1.0000e+03             2.7060e-06       -16.905809966197

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.5311
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.112577e-01 1 1  ON 0
 uu_1                 1.437666e-01 1 1  ON 1
 uu_2                 4.176485e-02 1 1  ON 2
 uu_3                -2.113008e-02 1 1  ON 3
 uu_4                -6.732741e-02 1 1  ON 4
 uu_5                -1.023902e-01 1 1  ON 5
 uu_6                -1.300947e-01 1 1  ON 6
 uu_7                -1.439755e-01 1 1  ON 7
 uu_8                -1.366794e-01 1 1  ON 8
 uu_9                -1.066398e-01 1 1  ON 9
 ud_0                 4.503703e-01 1 1  ON 10
 ud_1                 1.844078e-01 1 1  ON 11
 ud_2                 6.367176e-02 1 1  ON 12
 ud_3                -7.842691e-03 1 1  ON 13
 ud_4                -6.536713e-02 1 1  ON 14
 ud_5                -1.075299e-01 1 1  ON 15
 ud_6                -1.355667e-01 1 1  ON 16
 ud_7                -1.522117e-01 1 1  ON 17
 ud_8                -1.532888e-01 1 1  ON 18
 ud_9                -1.445490e-01 1 1  ON 19
 eO_0                -7.588815e-01 1 1  ON 20
 eO_1                -4.370290e-01 1 1  ON 21
 eO_2                -2.096278e-02 1 1  ON 22
 eO_3                 2.976604e-01 1 1  ON 23
 eO_4                 5.258548e-01 1 1  ON 24
 eO_5                 4.892856e-01 1 1  ON 25
 eO_6                 2.620324e-01 1 1  ON 26
 eO_7                -4.040290e-02 1 1  ON 27
 eO_8                -2.245223e-01 1 1  ON 28
 eO_9                -9.085208e-02 1 1  ON 29
eH1_0                -2.521566e-01 1 1  ON 30
eH1_1                -1.488677e-01 1 1  ON 31
eH1_2                -1.001413e-01 1 1  ON 32
eH1_3                -4.521231e-02 1 1  ON 33
eH1_4                 3.420849e-03 1 1  ON 34
eH1_5                 3.778876e-02 1 1  ON 35
eH1_6                 9.681372e-02 1 1  ON 36
eH1_7                 1.548274e-01 1 1  ON 37
eH1_8                 1.821993e-01 1 1  ON 38
eH1_9                 7.461817e-02 1 1  ON 39
eH2_0                -2.505427e-01 1 1  ON 40
eH2_1                -1.464840e-01 1 1  ON 41
eH2_2                -9.762313e-02 1 1  ON 42
eH2_3                -4.296758e-02 1 1  ON 43
eH2_4                 6.008696e-03 1 1  ON 44
eH2_5                 4.038842e-02 1 1  ON 45
eH2_6                 9.981415e-02 1 1  ON 46
eH2_7                 1.560270e-01 1 1  ON 47
eH2_8                 1.865353e-01 1 1  ON 48
eH2_9                 6.466603e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5589e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9241
    reference variance = 0.193599
====================================================
  Execution time = 3.3881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.6263e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.4356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362789106785
                                         uncertainty =       0.018096868834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362789106785
                                         uncertainty =       0.018096868834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425808928
  error estimate for blocks of size 2^( 2) =       0.000438162574
  error estimate for blocks of size 2^( 3) =       0.000451110838
  error estimate for blocks of size 2^( 4) =       0.000463338916
  error estimate for blocks of size 2^( 5) =       0.000474837335
  error estimate for blocks of size 2^( 6) =       0.000483989883
  error estimate for blocks of size 2^( 7) =       0.000491478943

      target function =                  N/A
              le_mean =     -16.905197086420
             les_mean =     286.148314834896
             stat err =       0.000478411269
             autocorr =       1.262331085397
              std dev =       0.602184760281
             le_variance =       0.362626485515


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690519708642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905197086420       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905197100668       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905197120233       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905197131911       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905197138092       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905197134228       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905197127824       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905197128974       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 5.013650e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905197086420       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905197089992       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905197094900       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905197097832       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905197099397       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905197098442       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905197096832       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905197097119       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.254014e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905197086420       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905197087313       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905197088541       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905197089275       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905197089668       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905197089430       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905197089026       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905197089099       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 3.135411e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025770 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3324e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.112580e-01 1 1  ON 0
 uu_1                 1.437667e-01 1 1  ON 1
 uu_2                 4.176489e-02 1 1  ON 2
 uu_3                -2.113016e-02 1 1  ON 3
 uu_4                -6.732719e-02 1 1  ON 4
 uu_5                -1.023905e-01 1 1  ON 5
 uu_6                -1.300954e-01 1 1  ON 6
 uu_7                -1.439755e-01 1 1  ON 7
 uu_8                -1.366794e-01 1 1  ON 8
 uu_9                -1.066401e-01 1 1  ON 9
 ud_0                 4.503706e-01 1 1  ON 10
 ud_1                 1.844073e-01 1 1  ON 11
 ud_2                 6.367207e-02 1 1  ON 12
 ud_3                -7.842942e-03 1 1  ON 13
 ud_4                -6.536693e-02 1 1  ON 14
 ud_5                -1.075299e-01 1 1  ON 15
 ud_6                -1.355666e-01 1 1  ON 16
 ud_7                -1.522115e-01 1 1  ON 17
 ud_8                -1.532889e-01 1 1  ON 18
 ud_9                -1.445490e-01 1 1  ON 19
 eO_0                -7.588808e-01 1 1  ON 20
 eO_1                -4.370288e-01 1 1  ON 21
 eO_2                -2.096308e-02 1 1  ON 22
 eO_3                 2.976602e-01 1 1  ON 23
 eO_4                 5.258549e-01 1 1  ON 24
 eO_5                 4.892858e-01 1 1  ON 25
 eO_6                 2.620324e-01 1 1  ON 26
 eO_7                -4.040255e-02 1 1  ON 27
 eO_8                -2.245226e-01 1 1  ON 28
 eO_9                -9.085262e-02 1 1  ON 29
eH1_0                -2.521578e-01 1 1  ON 30
eH1_1                -1.488683e-01 1 1  ON 31
eH1_2                -1.001412e-01 1 1  ON 32
eH1_3                -4.521238e-02 1 1  ON 33
eH1_4                 3.420991e-03 1 1  ON 34
eH1_5                 3.778915e-02 1 1  ON 35
eH1_6                 9.681351e-02 1 1  ON 36
eH1_7                 1.548276e-01 1 1  ON 37
eH1_8                 1.821999e-01 1 1  ON 38
eH1_9                 7.461882e-02 1 1  ON 39
eH2_0                -2.505432e-01 1 1  ON 40
eH2_1                -1.464844e-01 1 1  ON 41
eH2_2                -9.762344e-02 1 1  ON 42
eH2_3                -4.296790e-02 1 1  ON 43
eH2_4                 6.008617e-03 1 1  ON 44
eH2_5                 4.038808e-02 1 1  ON 45
eH2_6                 9.981431e-02 1 1  ON 46
eH2_7                 1.560275e-01 1 1  ON 47
eH2_8                 1.865357e-01 1 1  ON 48
eH2_9                 6.466684e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.0255
    reference variance = 0.886597
====================================================
  Execution time = 3.3508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4937e-01
  Total weights = 2.0000e+06
  Execution time = 3.1740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349194756178
                                         uncertainty =       0.006127401093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349194756178
                                         uncertainty =       0.006127401093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417954168
  error estimate for blocks of size 2^( 2) =       0.000430522464
  error estimate for blocks of size 2^( 3) =       0.000443818387
  error estimate for blocks of size 2^( 4) =       0.000457090275
  error estimate for blocks of size 2^( 5) =       0.000468046195
  error estimate for blocks of size 2^( 6) =       0.000478058425
  error estimate for blocks of size 2^( 7) =       0.000483517606

      target function =                  N/A
              le_mean =     -16.906244499682
             les_mean =     286.170474281678
             stat err =       0.000471678125
             autocorr =       1.273603223532
              std dev =       0.591076453039
             le_variance =       0.349371373337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349195261713
                                         uncertainty =       0.006127424191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349195261713
                                         uncertainty =       0.006127424191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417954473
  error estimate for blocks of size 2^( 2) =       0.000430522787
  error estimate for blocks of size 2^( 3) =       0.000443818747
  error estimate for blocks of size 2^( 4) =       0.000457090623
  error estimate for blocks of size 2^( 5) =       0.000468046542
  error estimate for blocks of size 2^( 6) =       0.000478058750
  error estimate for blocks of size 2^( 7) =       0.000483517826

      target function =                  N/A
              le_mean =     -16.906244514464
             les_mean =     286.170475290442
             stat err =       0.000471678435
             autocorr =       1.273603043759
              std dev =       0.591076883559
             le_variance =       0.349371882278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349195012284
                                         uncertainty =       0.006127412750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349195012284
                                         uncertainty =       0.006127412750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417954322
  error estimate for blocks of size 2^( 2) =       0.000430522627
  error estimate for blocks of size 2^( 3) =       0.000443818569
  error estimate for blocks of size 2^( 4) =       0.000457090451
  error estimate for blocks of size 2^( 5) =       0.000468046371
  error estimate for blocks of size 2^( 6) =       0.000478058589
  error estimate for blocks of size 2^( 7) =       0.000483517717

      target function =                  N/A
              le_mean =     -16.906244507159
             les_mean =     286.170474792306
             stat err =       0.000471678282
             autocorr =       1.273603132124
              std dev =       0.591076671135
             le_variance =       0.349371631160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349194788289
                                         uncertainty =       0.006127402553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349194788289
                                         uncertainty =       0.006127402553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417954187
  error estimate for blocks of size 2^( 2) =       0.000430522484
  error estimate for blocks of size 2^( 3) =       0.000443818410
  error estimate for blocks of size 2^( 4) =       0.000457090297
  error estimate for blocks of size 2^( 5) =       0.000468046218
  error estimate for blocks of size 2^( 6) =       0.000478058445
  error estimate for blocks of size 2^( 7) =       0.000483517620

      target function =                  N/A
              le_mean =     -16.906244500618
             les_mean =     286.170474345670
             stat err =       0.000471678145
             autocorr =       1.273603212070
              std dev =       0.591076480384
             le_variance =       0.349371405664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906244499682        initial
     6.2500e+01     6.2500e+02             5.0136e-06       -16.906244514464  <--
     2.5000e+02     2.5000e+03             1.2540e-06       -16.906244507159
     1.0000e+03     1.0000e+04             3.1354e-07       -16.906244500618

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 4.9460e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.112588e-01 1 1  ON 0
 uu_1                 1.437673e-01 1 1  ON 1
 uu_2                 4.176500e-02 1 1  ON 2
 uu_3                -2.113041e-02 1 1  ON 3
 uu_4                -6.732656e-02 1 1  ON 4
 uu_5                -1.023913e-01 1 1  ON 5
 uu_6                -1.300976e-01 1 1  ON 6
 uu_7                -1.439757e-01 1 1  ON 7
 uu_8                -1.366794e-01 1 1  ON 8
 uu_9                -1.066409e-01 1 1  ON 9
 ud_0                 4.503713e-01 1 1  ON 10
 ud_1                 1.844061e-01 1 1  ON 11
 ud_2                 6.367301e-02 1 1  ON 12
 ud_3                -7.843684e-03 1 1  ON 13
 ud_4                -6.536634e-02 1 1  ON 14
 ud_5                -1.075298e-01 1 1  ON 15
 ud_6                -1.355665e-01 1 1  ON 16
 ud_7                -1.522110e-01 1 1  ON 17
 ud_8                -1.532892e-01 1 1  ON 18
 ud_9                -1.445489e-01 1 1  ON 19
 eO_0                -7.588789e-01 1 1  ON 20
 eO_1                -4.370281e-01 1 1  ON 21
 eO_2                -2.096396e-02 1 1  ON 22
 eO_3                 2.976594e-01 1 1  ON 23
 eO_4                 5.258552e-01 1 1  ON 24
 eO_5                 4.892864e-01 1 1  ON 25
 eO_6                 2.620326e-01 1 1  ON 26
 eO_7                -4.040151e-02 1 1  ON 27
 eO_8                -2.245235e-01 1 1  ON 28
 eO_9                -9.085425e-02 1 1  ON 29
eH1_0                -2.521616e-01 1 1  ON 30
eH1_1                -1.488700e-01 1 1  ON 31
eH1_2                -1.001409e-01 1 1  ON 32
eH1_3                -4.521261e-02 1 1  ON 33
eH1_4                 3.421416e-03 1 1  ON 34
eH1_5                 3.779033e-02 1 1  ON 35
eH1_6                 9.681291e-02 1 1  ON 36
eH1_7                 1.548280e-01 1 1  ON 37
eH1_8                 1.822017e-01 1 1  ON 38
eH1_9                 7.462076e-02 1 1  ON 39
eH2_0                -2.505448e-01 1 1  ON 40
eH2_1                -1.464856e-01 1 1  ON 41
eH2_2                -9.762435e-02 1 1  ON 42
eH2_3                -4.296885e-02 1 1  ON 43
eH2_4                 6.008381e-03 1 1  ON 44
eH2_5                 4.038707e-02 1 1  ON 45
eH2_6                 9.981480e-02 1 1  ON 46
eH2_7                 1.560288e-01 1 1  ON 47
eH2_8                 1.865366e-01 1 1  ON 48
eH2_9                 6.466928e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2794e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8715
    reference variance = 0.205655
====================================================
  Execution time = 3.4370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4278e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342818066151
                                         uncertainty =       0.004266796985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342818066151
                                         uncertainty =       0.004266796985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413994801
  error estimate for blocks of size 2^( 2) =       0.000426796363
  error estimate for blocks of size 2^( 3) =       0.000439683654
  error estimate for blocks of size 2^( 4) =       0.000452112082
  error estimate for blocks of size 2^( 5) =       0.000462006395
  error estimate for blocks of size 2^( 6) =       0.000472325068
  error estimate for blocks of size 2^( 7) =       0.000478077002

      target function =                  N/A
              le_mean =     -16.906204250403
             les_mean =     286.162525375836
             stat err =       0.000466130137
             autocorr =       1.267723642866
              std dev =       0.585477062634
             le_variance =       0.342783390870


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620425040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204250403       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204288140       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906204347420       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906204336607       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906204426528       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906204411156       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906204392069       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906204403576       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.431491e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204250403       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204259921       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906204274695       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906204272239       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906204294983       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906204291199       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906204286292       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906204289103       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.602677e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204250403       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204252788       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906204256478       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906204255880       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906204261583       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906204260641       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906204259407       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906204260105       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 9.021956e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3710e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.112588e-01 1 1  ON 0
 uu_1                 1.437691e-01 1 1  ON 1
 uu_2                 4.176672e-02 1 1  ON 2
 uu_3                -2.112982e-02 1 1  ON 3
 uu_4                -6.732386e-02 1 1  ON 4
 uu_5                -1.023938e-01 1 1  ON 5
 uu_6                -1.300984e-01 1 1  ON 6
 uu_7                -1.439764e-01 1 1  ON 7
 uu_8                -1.366822e-01 1 1  ON 8
 uu_9                -1.066430e-01 1 1  ON 9
 ud_0                 4.503694e-01 1 1  ON 10
 ud_1                 1.844076e-01 1 1  ON 11
 ud_2                 6.367514e-02 1 1  ON 12
 ud_3                -7.844004e-03 1 1  ON 13
 ud_4                -6.536525e-02 1 1  ON 14
 ud_5                -1.075274e-01 1 1  ON 15
 ud_6                -1.355629e-01 1 1  ON 16
 ud_7                -1.522124e-01 1 1  ON 17
 ud_8                -1.532926e-01 1 1  ON 18
 ud_9                -1.445509e-01 1 1  ON 19
 eO_0                -7.588782e-01 1 1  ON 20
 eO_1                -4.370251e-01 1 1  ON 21
 eO_2                -2.096550e-02 1 1  ON 22
 eO_3                 2.976597e-01 1 1  ON 23
 eO_4                 5.258554e-01 1 1  ON 24
 eO_5                 4.892873e-01 1 1  ON 25
 eO_6                 2.620345e-01 1 1  ON 26
 eO_7                -4.040181e-02 1 1  ON 27
 eO_8                -2.245261e-01 1 1  ON 28
 eO_9                -9.085651e-02 1 1  ON 29
eH1_0                -2.521646e-01 1 1  ON 30
eH1_1                -1.488704e-01 1 1  ON 31
eH1_2                -1.001429e-01 1 1  ON 32
eH1_3                -4.521322e-02 1 1  ON 33
eH1_4                 3.421881e-03 1 1  ON 34
eH1_5                 3.778933e-02 1 1  ON 35
eH1_6                 9.681343e-02 1 1  ON 36
eH1_7                 1.548291e-01 1 1  ON 37
eH1_8                 1.822035e-01 1 1  ON 38
eH1_9                 7.462342e-02 1 1  ON 39
eH2_0                -2.505454e-01 1 1  ON 40
eH2_1                -1.464867e-01 1 1  ON 41
eH2_2                -9.762398e-02 1 1  ON 42
eH2_3                -4.296851e-02 1 1  ON 43
eH2_4                 6.009111e-03 1 1  ON 44
eH2_5                 4.038550e-02 1 1  ON 45
eH2_6                 9.981394e-02 1 1  ON 46
eH2_7                 1.560282e-01 1 1  ON 47
eH2_8                 1.865378e-01 1 1  ON 48
eH2_9                 6.467175e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8821
    reference variance = 0.289428
====================================================
  Execution time = 3.3396e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3984e-01
  Total weights = 2.0000e+06
  Execution time = 3.1708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339782500422
                                         uncertainty =       0.004848650627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339782500422
                                         uncertainty =       0.004848650627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412218642
  error estimate for blocks of size 2^( 2) =       0.000425040310
  error estimate for blocks of size 2^( 3) =       0.000437945154
  error estimate for blocks of size 2^( 4) =       0.000450810998
  error estimate for blocks of size 2^( 5) =       0.000461973939
  error estimate for blocks of size 2^( 6) =       0.000471127284
  error estimate for blocks of size 2^( 7) =       0.000479487231

      target function =                  N/A
              le_mean =     -16.906271886145
             les_mean =     286.161877336012
             stat err =       0.000465849863
             autocorr =       1.277134649226
              std dev =       0.582965194219
             le_variance =       0.339848417670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339768747357
                                         uncertainty =       0.004848482962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339768747357
                                         uncertainty =       0.004848482962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412210293
  error estimate for blocks of size 2^( 2) =       0.000425032254
  error estimate for blocks of size 2^( 3) =       0.000437937379
  error estimate for blocks of size 2^( 4) =       0.000450803374
  error estimate for blocks of size 2^( 5) =       0.000461966686
  error estimate for blocks of size 2^( 6) =       0.000471120061
  error estimate for blocks of size 2^( 7) =       0.000479480121

      target function =                  N/A
              le_mean =     -16.906271828981
             les_mean =     286.161861635964
             stat err =       0.000465842560
             autocorr =       1.277146346591
              std dev =       0.582953386204
             le_variance =       0.339834650487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339775467623
                                         uncertainty =       0.004848565683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339775467623
                                         uncertainty =       0.004848565683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412214372
  error estimate for blocks of size 2^( 2) =       0.000425036192
  error estimate for blocks of size 2^( 3) =       0.000437941180
  error estimate for blocks of size 2^( 4) =       0.000450807102
  error estimate for blocks of size 2^( 5) =       0.000461970232
  error estimate for blocks of size 2^( 6) =       0.000471123591
  error estimate for blocks of size 2^( 7) =       0.000479483594

      target function =                  N/A
              le_mean =     -16.906271856876
             les_mean =     286.161869306341
             stat err =       0.000465846130
             autocorr =       1.277140637134
              std dev =       0.582959156086
             le_variance =       0.339841377664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339781616143
                                         uncertainty =       0.004848639973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339781616143
                                         uncertainty =       0.004848639973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412218105
  error estimate for blocks of size 2^( 2) =       0.000425039792
  error estimate for blocks of size 2^( 3) =       0.000437944654
  error estimate for blocks of size 2^( 4) =       0.000450810508
  error estimate for blocks of size 2^( 5) =       0.000461973473
  error estimate for blocks of size 2^( 6) =       0.000471126819
  error estimate for blocks of size 2^( 7) =       0.000479486774

      target function =                  N/A
              le_mean =     -16.906271882442
             les_mean =     286.161876325610
             stat err =       0.000465849394
             autocorr =       1.277135402176
              std dev =       0.582964435009
             le_variance =       0.339847532485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906271886145        initial  <--
     1.5625e+01     1.5625e+02             1.4315e-05       -16.906271828981
     6.2500e+01     6.2500e+02             3.6027e-06       -16.906271856876
     2.5000e+02     2.5000e+03             9.0220e-07       -16.906271882442

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.3940
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.112588e-01 1 1  ON 0
 uu_1                 1.437673e-01 1 1  ON 1
 uu_2                 4.176500e-02 1 1  ON 2
 uu_3                -2.113041e-02 1 1  ON 3
 uu_4                -6.732656e-02 1 1  ON 4
 uu_5                -1.023913e-01 1 1  ON 5
 uu_6                -1.300976e-01 1 1  ON 6
 uu_7                -1.439757e-01 1 1  ON 7
 uu_8                -1.366794e-01 1 1  ON 8
 uu_9                -1.066409e-01 1 1  ON 9
 ud_0                 4.503713e-01 1 1  ON 10
 ud_1                 1.844061e-01 1 1  ON 11
 ud_2                 6.367301e-02 1 1  ON 12
 ud_3                -7.843684e-03 1 1  ON 13
 ud_4                -6.536634e-02 1 1  ON 14
 ud_5                -1.075298e-01 1 1  ON 15
 ud_6                -1.355665e-01 1 1  ON 16
 ud_7                -1.522110e-01 1 1  ON 17
 ud_8                -1.532892e-01 1 1  ON 18
 ud_9                -1.445489e-01 1 1  ON 19
 eO_0                -7.588789e-01 1 1  ON 20
 eO_1                -4.370281e-01 1 1  ON 21
 eO_2                -2.096396e-02 1 1  ON 22
 eO_3                 2.976594e-01 1 1  ON 23
 eO_4                 5.258552e-01 1 1  ON 24
 eO_5                 4.892864e-01 1 1  ON 25
 eO_6                 2.620326e-01 1 1  ON 26
 eO_7                -4.040151e-02 1 1  ON 27
 eO_8                -2.245235e-01 1 1  ON 28
 eO_9                -9.085425e-02 1 1  ON 29
eH1_0                -2.521616e-01 1 1  ON 30
eH1_1                -1.488700e-01 1 1  ON 31
eH1_2                -1.001409e-01 1 1  ON 32
eH1_3                -4.521261e-02 1 1  ON 33
eH1_4                 3.421416e-03 1 1  ON 34
eH1_5                 3.779033e-02 1 1  ON 35
eH1_6                 9.681291e-02 1 1  ON 36
eH1_7                 1.548280e-01 1 1  ON 37
eH1_8                 1.822017e-01 1 1  ON 38
eH1_9                 7.462076e-02 1 1  ON 39
eH2_0                -2.505448e-01 1 1  ON 40
eH2_1                -1.464856e-01 1 1  ON 41
eH2_2                -9.762435e-02 1 1  ON 42
eH2_3                -4.296885e-02 1 1  ON 43
eH2_4                 6.008381e-03 1 1  ON 44
eH2_5                 4.038707e-02 1 1  ON 45
eH2_6                 9.981480e-02 1 1  ON 46
eH2_7                 1.560288e-01 1 1  ON 47
eH2_8                 1.865366e-01 1 1  ON 48
eH2_9                 6.466928e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3112e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8941
    reference variance = 0.267679
====================================================
  Execution time = 3.6371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4307e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342998422854
                                         uncertainty =       0.005136857360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342998422854
                                         uncertainty =       0.005136857360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414169571
  error estimate for blocks of size 2^( 2) =       0.000426057400
  error estimate for blocks of size 2^( 3) =       0.000439028799
  error estimate for blocks of size 2^( 4) =       0.000451057136
  error estimate for blocks of size 2^( 5) =       0.000461279529
  error estimate for blocks of size 2^( 6) =       0.000469493337
  error estimate for blocks of size 2^( 7) =       0.000473450492

      target function =                  N/A
              le_mean =     -16.907039748943
             les_mean =     286.191065767429
             stat err =       0.000463820124
             autocorr =       1.254130699853
              std dev =       0.585724224039
             le_variance =       0.343072866626


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690703974894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907039748943       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907039753174       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907039756647       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907039758043       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907039757333       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907039759682       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907039759385       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907039758746       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.690134e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907039748943       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907039750001       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907039750871       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907039751220       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907039751043       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907039751631       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907039751556       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907039751399       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 4.226382e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907039748943       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907039749208       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907039749425       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907039749514       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907039749468       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907039749615       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907039749595       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907039749555       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.056661e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5772e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.112585e-01 1 1  ON 0
 uu_1                 1.437675e-01 1 1  ON 1
 uu_2                 4.176512e-02 1 1  ON 2
 uu_3                -2.113033e-02 1 1  ON 3
 uu_4                -6.732653e-02 1 1  ON 4
 uu_5                -1.023914e-01 1 1  ON 5
 uu_6                -1.300975e-01 1 1  ON 6
 uu_7                -1.439757e-01 1 1  ON 7
 uu_8                -1.366797e-01 1 1  ON 8
 uu_9                -1.066410e-01 1 1  ON 9
 ud_0                 4.503713e-01 1 1  ON 10
 ud_1                 1.844061e-01 1 1  ON 11
 ud_2                 6.367309e-02 1 1  ON 12
 ud_3                -7.843582e-03 1 1  ON 13
 ud_4                -6.536622e-02 1 1  ON 14
 ud_5                -1.075297e-01 1 1  ON 15
 ud_6                -1.355663e-01 1 1  ON 16
 ud_7                -1.522112e-01 1 1  ON 17
 ud_8                -1.532895e-01 1 1  ON 18
 ud_9                -1.445491e-01 1 1  ON 19
 eO_0                -7.588787e-01 1 1  ON 20
 eO_1                -4.370279e-01 1 1  ON 21
 eO_2                -2.096399e-02 1 1  ON 22
 eO_3                 2.976594e-01 1 1  ON 23
 eO_4                 5.258551e-01 1 1  ON 24
 eO_5                 4.892864e-01 1 1  ON 25
 eO_6                 2.620327e-01 1 1  ON 26
 eO_7                -4.040155e-02 1 1  ON 27
 eO_8                -2.245237e-01 1 1  ON 28
 eO_9                -9.085446e-02 1 1  ON 29
eH1_0                -2.521620e-01 1 1  ON 30
eH1_1                -1.488702e-01 1 1  ON 31
eH1_2                -1.001411e-01 1 1  ON 32
eH1_3                -4.521288e-02 1 1  ON 33
eH1_4                 3.421624e-03 1 1  ON 34
eH1_5                 3.779041e-02 1 1  ON 35
eH1_6                 9.681297e-02 1 1  ON 36
eH1_7                 1.548282e-01 1 1  ON 37
eH1_8                 1.822020e-01 1 1  ON 38
eH1_9                 7.462100e-02 1 1  ON 39
eH2_0                -2.505451e-01 1 1  ON 40
eH2_1                -1.464854e-01 1 1  ON 41
eH2_2                -9.762442e-02 1 1  ON 42
eH2_3                -4.296898e-02 1 1  ON 43
eH2_4                 6.008405e-03 1 1  ON 44
eH2_5                 4.038690e-02 1 1  ON 45
eH2_6                 9.981467e-02 1 1  ON 46
eH2_7                 1.560290e-01 1 1  ON 47
eH2_8                 1.865368e-01 1 1  ON 48
eH2_9                 6.466955e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9663
    reference variance = 0.204029
====================================================
  Execution time = 3.3596e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3479e-01
  Total weights = 2.0000e+06
  Execution time = 3.1508e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334865641950
                                         uncertainty =       0.003072981594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334865641950
                                         uncertainty =       0.003072981594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409137101
  error estimate for blocks of size 2^( 2) =       0.000421396156
  error estimate for blocks of size 2^( 3) =       0.000434105518
  error estimate for blocks of size 2^( 4) =       0.000445570226
  error estimate for blocks of size 2^( 5) =       0.000454924069
  error estimate for blocks of size 2^( 6) =       0.000461559936
  error estimate for blocks of size 2^( 7) =       0.000467387070

      target function =                  N/A
              le_mean =     -16.906397966200
             les_mean =     286.161078358455
             stat err =       0.000457360325
             autocorr =       1.249623688887
              std dev =       0.578607236648
             le_variance =       0.334786334301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334865167167
                                         uncertainty =       0.003072978052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334865167167
                                         uncertainty =       0.003072978052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409136810
  error estimate for blocks of size 2^( 2) =       0.000421395864
  error estimate for blocks of size 2^( 3) =       0.000434105238
  error estimate for blocks of size 2^( 4) =       0.000445569961
  error estimate for blocks of size 2^( 5) =       0.000454923809
  error estimate for blocks of size 2^( 6) =       0.000461559672
  error estimate for blocks of size 2^( 7) =       0.000467386811

      target function =                  N/A
              le_mean =     -16.906397977902
             les_mean =     286.161078278880
             stat err =       0.000457360063
             autocorr =       1.249624032138
              std dev =       0.578606825969
             le_variance =       0.334785859058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334865404534
                                         uncertainty =       0.003072979822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334865404534
                                         uncertainty =       0.003072979822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409136955
  error estimate for blocks of size 2^( 2) =       0.000421396010
  error estimate for blocks of size 2^( 3) =       0.000434105378
  error estimate for blocks of size 2^( 4) =       0.000445570094
  error estimate for blocks of size 2^( 5) =       0.000454923939
  error estimate for blocks of size 2^( 6) =       0.000461559804
  error estimate for blocks of size 2^( 7) =       0.000467386940

      target function =                  N/A
              le_mean =     -16.906397972058
             les_mean =     286.161078318853
             stat err =       0.000457360194
             autocorr =       1.249623860554
              std dev =       0.578607031287
             le_variance =       0.334786096655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334865612272
                                         uncertainty =       0.003072981372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334865612272
                                         uncertainty =       0.003072981372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409137083
  error estimate for blocks of size 2^( 2) =       0.000421396138
  error estimate for blocks of size 2^( 3) =       0.000434105501
  error estimate for blocks of size 2^( 4) =       0.000445570209
  error estimate for blocks of size 2^( 5) =       0.000454924053
  error estimate for blocks of size 2^( 6) =       0.000461559920
  error estimate for blocks of size 2^( 7) =       0.000467387054

      target function =                  N/A
              le_mean =     -16.906397966933
             les_mean =     286.161078353507
             stat err =       0.000457360309
             autocorr =       1.249623710339
              std dev =       0.578607210976
             le_variance =       0.334786304594


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906397966200        initial
     1.5625e+02     1.5625e+03             1.6901e-06       -16.906397977902  <--
     6.2500e+02     6.2500e+03             4.2264e-07       -16.906397972058
     2.5000e+03     2.5000e+04             1.0567e-07       -16.906397966933

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 4.9505e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.112577e-01 1 1  ON 0
 uu_1                 1.437681e-01 1 1  ON 1
 uu_2                 4.176549e-02 1 1  ON 2
 uu_3                -2.113010e-02 1 1  ON 3
 uu_4                -6.732642e-02 1 1  ON 4
 uu_5                -1.023918e-01 1 1  ON 5
 uu_6                -1.300974e-01 1 1  ON 6
 uu_7                -1.439759e-01 1 1  ON 7
 uu_8                -1.366807e-01 1 1  ON 8
 uu_9                -1.066413e-01 1 1  ON 9
 ud_0                 4.503715e-01 1 1  ON 10
 ud_1                 1.844059e-01 1 1  ON 11
 ud_2                 6.367333e-02 1 1  ON 12
 ud_3                -7.843275e-03 1 1  ON 13
 ud_4                -6.536587e-02 1 1  ON 14
 ud_5                -1.075293e-01 1 1  ON 15
 ud_6                -1.355656e-01 1 1  ON 16
 ud_7                -1.522117e-01 1 1  ON 17
 ud_8                -1.532902e-01 1 1  ON 18
 ud_9                -1.445495e-01 1 1  ON 19
 eO_0                -7.588782e-01 1 1  ON 20
 eO_1                -4.370273e-01 1 1  ON 21
 eO_2                -2.096406e-02 1 1  ON 22
 eO_3                 2.976594e-01 1 1  ON 23
 eO_4                 5.258549e-01 1 1  ON 24
 eO_5                 4.892866e-01 1 1  ON 25
 eO_6                 2.620332e-01 1 1  ON 26
 eO_7                -4.040167e-02 1 1  ON 27
 eO_8                -2.245243e-01 1 1  ON 28
 eO_9                -9.085508e-02 1 1  ON 29
eH1_0                -2.521633e-01 1 1  ON 30
eH1_1                -1.488707e-01 1 1  ON 31
eH1_2                -1.001417e-01 1 1  ON 32
eH1_3                -4.521368e-02 1 1  ON 33
eH1_4                 3.422247e-03 1 1  ON 34
eH1_5                 3.779066e-02 1 1  ON 35
eH1_6                 9.681316e-02 1 1  ON 36
eH1_7                 1.548285e-01 1 1  ON 37
eH1_8                 1.822029e-01 1 1  ON 38
eH1_9                 7.462172e-02 1 1  ON 39
eH2_0                -2.505460e-01 1 1  ON 40
eH2_1                -1.464849e-01 1 1  ON 41
eH2_2                -9.762465e-02 1 1  ON 42
eH2_3                -4.296937e-02 1 1  ON 43
eH2_4                 6.008477e-03 1 1  ON 44
eH2_5                 4.038639e-02 1 1  ON 45
eH2_6                 9.981427e-02 1 1  ON 46
eH2_7                 1.560294e-01 1 1  ON 47
eH2_8                 1.865373e-01 1 1  ON 48
eH2_9                 6.467035e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.349251
====================================================
  Execution time = 3.4247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3819e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338154585676
                                         uncertainty =       0.003468068615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338154585676
                                         uncertainty =       0.003468068615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411213817
  error estimate for blocks of size 2^( 2) =       0.000423895089
  error estimate for blocks of size 2^( 3) =       0.000436952080
  error estimate for blocks of size 2^( 4) =       0.000448994427
  error estimate for blocks of size 2^( 5) =       0.000459923792
  error estimate for blocks of size 2^( 6) =       0.000466543089
  error estimate for blocks of size 2^( 7) =       0.000471087033

      target function =                  N/A
              le_mean =     -16.905670727911
             les_mean =     286.139896198334
             stat err =       0.000461637085
             autocorr =       1.260276919773
              std dev =       0.581544157288
             le_variance =       0.338193606875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567072791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905670727911       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905670741285       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905670740209       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905670751439       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905670757473       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905670751249       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905670747714       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905670747484       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 6.067645e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905670727911       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905670731270       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905670731001       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905670733811       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905670735329       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905670733771       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905670732898       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905670732833       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.523033e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905670727911       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905670728752       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905670728685       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905670729387       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905670729767       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905670729378       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905670729160       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905670729143       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.811439e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3567e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.112578e-01 1 1  ON 0
 uu_1                 1.437682e-01 1 1  ON 1
 uu_2                 4.176572e-02 1 1  ON 2
 uu_3                -2.113011e-02 1 1  ON 3
 uu_4                -6.732571e-02 1 1  ON 4
 uu_5                -1.023928e-01 1 1  ON 5
 uu_6                -1.300980e-01 1 1  ON 6
 uu_7                -1.439764e-01 1 1  ON 7
 uu_8                -1.366808e-01 1 1  ON 8
 uu_9                -1.066411e-01 1 1  ON 9
 ud_0                 4.503719e-01 1 1  ON 10
 ud_1                 1.844060e-01 1 1  ON 11
 ud_2                 6.367316e-02 1 1  ON 12
 ud_3                -7.843818e-03 1 1  ON 13
 ud_4                -6.536531e-02 1 1  ON 14
 ud_5                -1.075292e-01 1 1  ON 15
 ud_6                -1.355651e-01 1 1  ON 16
 ud_7                -1.522121e-01 1 1  ON 17
 ud_8                -1.532902e-01 1 1  ON 18
 ud_9                -1.445495e-01 1 1  ON 19
 eO_0                -7.588767e-01 1 1  ON 20
 eO_1                -4.370277e-01 1 1  ON 21
 eO_2                -2.096382e-02 1 1  ON 22
 eO_3                 2.976591e-01 1 1  ON 23
 eO_4                 5.258547e-01 1 1  ON 24
 eO_5                 4.892867e-01 1 1  ON 25
 eO_6                 2.620336e-01 1 1  ON 26
 eO_7                -4.040151e-02 1 1  ON 27
 eO_8                -2.245248e-01 1 1  ON 28
 eO_9                -9.085592e-02 1 1  ON 29
eH1_0                -2.521645e-01 1 1  ON 30
eH1_1                -1.488706e-01 1 1  ON 31
eH1_2                -1.001420e-01 1 1  ON 32
eH1_3                -4.521390e-02 1 1  ON 33
eH1_4                 3.422210e-03 1 1  ON 34
eH1_5                 3.778957e-02 1 1  ON 35
eH1_6                 9.681324e-02 1 1  ON 36
eH1_7                 1.548288e-01 1 1  ON 37
eH1_8                 1.822036e-01 1 1  ON 38
eH1_9                 7.462301e-02 1 1  ON 39
eH2_0                -2.505466e-01 1 1  ON 40
eH2_1                -1.464852e-01 1 1  ON 41
eH2_2                -9.762485e-02 1 1  ON 42
eH2_3                -4.296953e-02 1 1  ON 43
eH2_4                 6.008256e-03 1 1  ON 44
eH2_5                 4.038581e-02 1 1  ON 45
eH2_6                 9.981417e-02 1 1  ON 46
eH2_7                 1.560294e-01 1 1  ON 47
eH2_8                 1.865381e-01 1 1  ON 48
eH2_9                 6.467164e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.7751
    reference variance = 0.429111
====================================================
  Execution time = 3.3985e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3797e-01
  Total weights = 2.0000e+06
  Execution time = 3.1503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337795609687
                                         uncertainty =       0.005266646194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337795609687
                                         uncertainty =       0.005266646194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411076217
  error estimate for blocks of size 2^( 2) =       0.000423454858
  error estimate for blocks of size 2^( 3) =       0.000435875204
  error estimate for blocks of size 2^( 4) =       0.000446807589
  error estimate for blocks of size 2^( 5) =       0.000456192385
  error estimate for blocks of size 2^( 6) =       0.000461552567
  error estimate for blocks of size 2^( 7) =       0.000466006514

      target function =                  N/A
              le_mean =     -16.905956360989
             les_mean =     286.149327623776
             stat err =       0.000457639764
             autocorr =       1.239375201521
              std dev =       0.581349561865
             le_variance =       0.337967313080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337796470562
                                         uncertainty =       0.005266670868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337796470562
                                         uncertainty =       0.005266670868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411076741
  error estimate for blocks of size 2^( 2) =       0.000423455326
  error estimate for blocks of size 2^( 3) =       0.000435875620
  error estimate for blocks of size 2^( 4) =       0.000446807977
  error estimate for blocks of size 2^( 5) =       0.000456192677
  error estimate for blocks of size 2^( 6) =       0.000461552859
  error estimate for blocks of size 2^( 7) =       0.000466006699

      target function =                  N/A
              le_mean =     -16.905956360629
             les_mean =     286.149328473254
             stat err =       0.000457640053
             autocorr =       1.239373609669
              std dev =       0.581350302961
             le_variance =       0.337968174753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337796044837
                                         uncertainty =       0.005266658649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337796044837
                                         uncertainty =       0.005266658649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411076482
  error estimate for blocks of size 2^( 2) =       0.000423455095
  error estimate for blocks of size 2^( 3) =       0.000435875415
  error estimate for blocks of size 2^( 4) =       0.000446807786
  error estimate for blocks of size 2^( 5) =       0.000456192533
  error estimate for blocks of size 2^( 6) =       0.000461552715
  error estimate for blocks of size 2^( 7) =       0.000466006608

      target function =                  N/A
              le_mean =     -16.905956360773
             les_mean =     286.149328052021
             stat err =       0.000457639910
             autocorr =       1.239374398687
              std dev =       0.581349936468
             le_variance =       0.337967748631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337795664214
                                         uncertainty =       0.005266647754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337795664214
                                         uncertainty =       0.005266647754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411076251
  error estimate for blocks of size 2^( 2) =       0.000423454887
  error estimate for blocks of size 2^( 3) =       0.000435875231
  error estimate for blocks of size 2^( 4) =       0.000446807614
  error estimate for blocks of size 2^( 5) =       0.000456192403
  error estimate for blocks of size 2^( 6) =       0.000461552585
  error estimate for blocks of size 2^( 7) =       0.000466006526

      target function =                  N/A
              le_mean =     -16.905956360959
             les_mean =     286.149327677338
             stat err =       0.000457639782
             autocorr =       1.239375100945
              std dev =       0.581349608804
             le_variance =       0.337967367656


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905956360989        initial  <--
     3.9062e+01     3.9062e+02             6.0676e-06       -16.905956360629
     1.5625e+02     1.5625e+03             1.5230e-06       -16.905956360773
     6.2500e+02     6.2500e+03             3.8114e-07       -16.905956360959

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.8899
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.112577e-01 1 1  ON 0
 uu_1                 1.437681e-01 1 1  ON 1
 uu_2                 4.176549e-02 1 1  ON 2
 uu_3                -2.113010e-02 1 1  ON 3
 uu_4                -6.732642e-02 1 1  ON 4
 uu_5                -1.023918e-01 1 1  ON 5
 uu_6                -1.300974e-01 1 1  ON 6
 uu_7                -1.439759e-01 1 1  ON 7
 uu_8                -1.366807e-01 1 1  ON 8
 uu_9                -1.066413e-01 1 1  ON 9
 ud_0                 4.503715e-01 1 1  ON 10
 ud_1                 1.844059e-01 1 1  ON 11
 ud_2                 6.367333e-02 1 1  ON 12
 ud_3                -7.843275e-03 1 1  ON 13
 ud_4                -6.536587e-02 1 1  ON 14
 ud_5                -1.075293e-01 1 1  ON 15
 ud_6                -1.355656e-01 1 1  ON 16
 ud_7                -1.522117e-01 1 1  ON 17
 ud_8                -1.532902e-01 1 1  ON 18
 ud_9                -1.445495e-01 1 1  ON 19
 eO_0                -7.588782e-01 1 1  ON 20
 eO_1                -4.370273e-01 1 1  ON 21
 eO_2                -2.096406e-02 1 1  ON 22
 eO_3                 2.976594e-01 1 1  ON 23
 eO_4                 5.258549e-01 1 1  ON 24
 eO_5                 4.892866e-01 1 1  ON 25
 eO_6                 2.620332e-01 1 1  ON 26
 eO_7                -4.040167e-02 1 1  ON 27
 eO_8                -2.245243e-01 1 1  ON 28
 eO_9                -9.085508e-02 1 1  ON 29
eH1_0                -2.521633e-01 1 1  ON 30
eH1_1                -1.488707e-01 1 1  ON 31
eH1_2                -1.001417e-01 1 1  ON 32
eH1_3                -4.521368e-02 1 1  ON 33
eH1_4                 3.422247e-03 1 1  ON 34
eH1_5                 3.779066e-02 1 1  ON 35
eH1_6                 9.681316e-02 1 1  ON 36
eH1_7                 1.548285e-01 1 1  ON 37
eH1_8                 1.822029e-01 1 1  ON 38
eH1_9                 7.462172e-02 1 1  ON 39
eH2_0                -2.505460e-01 1 1  ON 40
eH2_1                -1.464849e-01 1 1  ON 41
eH2_2                -9.762465e-02 1 1  ON 42
eH2_3                -4.296937e-02 1 1  ON 43
eH2_4                 6.008477e-03 1 1  ON 44
eH2_5                 4.038639e-02 1 1  ON 45
eH2_6                 9.981427e-02 1 1  ON 46
eH2_7                 1.560294e-01 1 1  ON 47
eH2_8                 1.865373e-01 1 1  ON 48
eH2_9                 6.467035e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3464e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8402
    reference variance = 0.206807
====================================================
  Execution time = 3.4313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3990e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339992778226
                                         uncertainty =       0.002845773592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339992778226
                                         uncertainty =       0.002845773592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412251062
  error estimate for blocks of size 2^( 2) =       0.000424843279
  error estimate for blocks of size 2^( 3) =       0.000438294659
  error estimate for blocks of size 2^( 4) =       0.000451687806
  error estimate for blocks of size 2^( 5) =       0.000463884027
  error estimate for blocks of size 2^( 6) =       0.000473533231
  error estimate for blocks of size 2^( 7) =       0.000478789664

      target function =                  N/A
              le_mean =     -16.905393072505
             les_mean =     286.132216641841
             stat err =       0.000466973682
             autocorr =       1.283102185066
              std dev =       0.583011042697
             le_variance =       0.339901875906


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690539307250e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905393072505       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905393071405       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905393070172       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905393070147       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905393069824       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905393069540       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905393070345       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905393070313       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 8.854782e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905393072505       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905393072230       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905393071921       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905393071915       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905393071834       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905393071763       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905393071965       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905393071955       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.213982e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905393072505       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905393072436       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905393072359       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905393072357       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905393072337       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905393072322       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905393072369       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905393072368       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 5.535133e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036461 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3585e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.112578e-01 1 1  ON 0
 uu_1                 1.437681e-01 1 1  ON 1
 uu_2                 4.176540e-02 1 1  ON 2
 uu_3                -2.113013e-02 1 1  ON 3
 uu_4                -6.732645e-02 1 1  ON 4
 uu_5                -1.023918e-01 1 1  ON 5
 uu_6                -1.300975e-01 1 1  ON 6
 uu_7                -1.439759e-01 1 1  ON 7
 uu_8                -1.366807e-01 1 1  ON 8
 uu_9                -1.066413e-01 1 1  ON 9
 ud_0                 4.503715e-01 1 1  ON 10
 ud_1                 1.844059e-01 1 1  ON 11
 ud_2                 6.367327e-02 1 1  ON 12
 ud_3                -7.843242e-03 1 1  ON 13
 ud_4                -6.536589e-02 1 1  ON 14
 ud_5                -1.075292e-01 1 1  ON 15
 ud_6                -1.355656e-01 1 1  ON 16
 ud_7                -1.522117e-01 1 1  ON 17
 ud_8                -1.532903e-01 1 1  ON 18
 ud_9                -1.445495e-01 1 1  ON 19
 eO_0                -7.588781e-01 1 1  ON 20
 eO_1                -4.370272e-01 1 1  ON 21
 eO_2                -2.096405e-02 1 1  ON 22
 eO_3                 2.976594e-01 1 1  ON 23
 eO_4                 5.258548e-01 1 1  ON 24
 eO_5                 4.892866e-01 1 1  ON 25
 eO_6                 2.620332e-01 1 1  ON 26
 eO_7                -4.040163e-02 1 1  ON 27
 eO_8                -2.245244e-01 1 1  ON 28
 eO_9                -9.085514e-02 1 1  ON 29
eH1_0                -2.521635e-01 1 1  ON 30
eH1_1                -1.488707e-01 1 1  ON 31
eH1_2                -1.001417e-01 1 1  ON 32
eH1_3                -4.521365e-02 1 1  ON 33
eH1_4                 3.422251e-03 1 1  ON 34
eH1_5                 3.779059e-02 1 1  ON 35
eH1_6                 9.681315e-02 1 1  ON 36
eH1_7                 1.548286e-01 1 1  ON 37
eH1_8                 1.822030e-01 1 1  ON 38
eH1_9                 7.462184e-02 1 1  ON 39
eH2_0                -2.505461e-01 1 1  ON 40
eH2_1                -1.464849e-01 1 1  ON 41
eH2_2                -9.762472e-02 1 1  ON 42
eH2_3                -4.296941e-02 1 1  ON 43
eH2_4                 6.008480e-03 1 1  ON 44
eH2_5                 4.038636e-02 1 1  ON 45
eH2_6                 9.981423e-02 1 1  ON 46
eH2_7                 1.560294e-01 1 1  ON 47
eH2_8                 1.865373e-01 1 1  ON 48
eH2_9                 6.467049e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8739
    reference variance = 0.165653
====================================================
  Execution time = 3.3667e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5380e-01
  Total weights = 2.0000e+06
  Execution time = 3.1533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353773521016
                                         uncertainty =       0.008047343343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353773521016
                                         uncertainty =       0.008047343343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420592628
  error estimate for blocks of size 2^( 2) =       0.000433092183
  error estimate for blocks of size 2^( 3) =       0.000445730950
  error estimate for blocks of size 2^( 4) =       0.000456954574
  error estimate for blocks of size 2^( 5) =       0.000466626251
  error estimate for blocks of size 2^( 6) =       0.000472596565
  error estimate for blocks of size 2^( 7) =       0.000477513596

      target function =                  N/A
              le_mean =     -16.906496419215
             les_mean =     286.183417312669
             stat err =       0.000468422746
             autocorr =       1.240373960463
              std dev =       0.594807798065
             le_variance =       0.353796316639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353773981784
                                         uncertainty =       0.008047365140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353773981784
                                         uncertainty =       0.008047365140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420592901
  error estimate for blocks of size 2^( 2) =       0.000433092445
  error estimate for blocks of size 2^( 3) =       0.000445731205
  error estimate for blocks of size 2^( 4) =       0.000456954824
  error estimate for blocks of size 2^( 5) =       0.000466626501
  error estimate for blocks of size 2^( 6) =       0.000472596807
  error estimate for blocks of size 2^( 7) =       0.000477513831

      target function =                  N/A
              le_mean =     -16.906496421408
             les_mean =     286.183417847404
             stat err =       0.000468422991
             autocorr =       1.240373640618
              std dev =       0.594808185232
             le_variance =       0.353796777219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353773751662
                                         uncertainty =       0.008047354254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353773751662
                                         uncertainty =       0.008047354254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420592765
  error estimate for blocks of size 2^( 2) =       0.000433092314
  error estimate for blocks of size 2^( 3) =       0.000445731078
  error estimate for blocks of size 2^( 4) =       0.000456954699
  error estimate for blocks of size 2^( 5) =       0.000466626376
  error estimate for blocks of size 2^( 6) =       0.000472596686
  error estimate for blocks of size 2^( 7) =       0.000477513714

      target function =                  N/A
              le_mean =     -16.906496420312
             les_mean =     286.183417580325
             stat err =       0.000468422869
             autocorr =       1.240373800331
              std dev =       0.594807991869
             le_variance =       0.353796547191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353773549855
                                         uncertainty =       0.008047344708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353773549855
                                         uncertainty =       0.008047344708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420592645
  error estimate for blocks of size 2^( 2) =       0.000433092199
  error estimate for blocks of size 2^( 3) =       0.000445730966
  error estimate for blocks of size 2^( 4) =       0.000456954589
  error estimate for blocks of size 2^( 5) =       0.000466626266
  error estimate for blocks of size 2^( 6) =       0.000472596580
  error estimate for blocks of size 2^( 7) =       0.000477513611

      target function =                  N/A
              le_mean =     -16.906496419352
             les_mean =     286.183417346134
             stat err =       0.000468422762
             autocorr =       1.240373940442
              std dev =       0.594807822298
             le_variance =       0.353796345466


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906496419215        initial
     3.9062e+02     3.9062e+03             8.8548e-07       -16.906496421408  <--
     1.5625e+03     1.5625e+04             2.2140e-07       -16.906496420312
     6.2500e+03     6.2500e+04             5.5351e-08       -16.906496419352

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 4.9593e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.112581e-01 1 1  ON 0
 uu_1                 1.437681e-01 1 1  ON 1
 uu_2                 4.176514e-02 1 1  ON 2
 uu_3                -2.113023e-02 1 1  ON 3
 uu_4                -6.732653e-02 1 1  ON 4
 uu_5                -1.023919e-01 1 1  ON 5
 uu_6                -1.300978e-01 1 1  ON 6
 uu_7                -1.439758e-01 1 1  ON 7
 uu_8                -1.366805e-01 1 1  ON 8
 uu_9                -1.066413e-01 1 1  ON 9
 ud_0                 4.503716e-01 1 1  ON 10
 ud_1                 1.844057e-01 1 1  ON 11
 ud_2                 6.367312e-02 1 1  ON 12
 ud_3                -7.843143e-03 1 1  ON 13
 ud_4                -6.536597e-02 1 1  ON 14
 ud_5                -1.075292e-01 1 1  ON 15
 ud_6                -1.355656e-01 1 1  ON 16
 ud_7                -1.522117e-01 1 1  ON 17
 ud_8                -1.532903e-01 1 1  ON 18
 ud_9                -1.445494e-01 1 1  ON 19
 eO_0                -7.588779e-01 1 1  ON 20
 eO_1                -4.370272e-01 1 1  ON 21
 eO_2                -2.096403e-02 1 1  ON 22
 eO_3                 2.976592e-01 1 1  ON 23
 eO_4                 5.258547e-01 1 1  ON 24
 eO_5                 4.892867e-01 1 1  ON 25
 eO_6                 2.620332e-01 1 1  ON 26
 eO_7                -4.040148e-02 1 1  ON 27
 eO_8                -2.245245e-01 1 1  ON 28
 eO_9                -9.085532e-02 1 1  ON 29
eH1_0                -2.521642e-01 1 1  ON 30
eH1_1                -1.488708e-01 1 1  ON 31
eH1_2                -1.001418e-01 1 1  ON 32
eH1_3                -4.521356e-02 1 1  ON 33
eH1_4                 3.422264e-03 1 1  ON 34
eH1_5                 3.779040e-02 1 1  ON 35
eH1_6                 9.681314e-02 1 1  ON 36
eH1_7                 1.548288e-01 1 1  ON 37
eH1_8                 1.822032e-01 1 1  ON 38
eH1_9                 7.462222e-02 1 1  ON 39
eH2_0                -2.505465e-01 1 1  ON 40
eH2_1                -1.464849e-01 1 1  ON 41
eH2_2                -9.762494e-02 1 1  ON 42
eH2_3                -4.296952e-02 1 1  ON 43
eH2_4                 6.008489e-03 1 1  ON 44
eH2_5                 4.038629e-02 1 1  ON 45
eH2_6                 9.981410e-02 1 1  ON 46
eH2_7                 1.560296e-01 1 1  ON 47
eH2_8                 1.865376e-01 1 1  ON 48
eH2_9                 6.467092e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3186e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8523
    reference variance = 0.32293
====================================================
  Execution time = 3.4339e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5565e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355744382387
                                         uncertainty =       0.011118346584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355744382387
                                         uncertainty =       0.011118346584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421694477
  error estimate for blocks of size 2^( 2) =       0.000433557980
  error estimate for blocks of size 2^( 3) =       0.000446671786
  error estimate for blocks of size 2^( 4) =       0.000459027994
  error estimate for blocks of size 2^( 5) =       0.000469400083
  error estimate for blocks of size 2^( 6) =       0.000475955951
  error estimate for blocks of size 2^( 7) =       0.000480301464

      target function =                  N/A
              le_mean =     -16.905532120541
             les_mean =     286.152668565035
             stat err =       0.000471171373
             autocorr =       1.248423589445
              std dev =       0.596366048840
             le_variance =       0.355652464209


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553212054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905532120541       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905532120239       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905532126458       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905532128971       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905532125110       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905532122807       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905532121786       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905532123686       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.234244e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905532120541       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905532120466       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905532122024       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905532122652       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905532121683       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905532121107       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905532120849       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905532121321       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 8.087982e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905532120541       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905532120522       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905532120912       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905532121069       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905532120827       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905532120681       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905532120618       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905532120737       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.022144e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5280e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.112580e-01 1 1  ON 0
 uu_1                 1.437680e-01 1 1  ON 1
 uu_2                 4.176502e-02 1 1  ON 2
 uu_3                -2.113042e-02 1 1  ON 3
 uu_4                -6.732641e-02 1 1  ON 4
 uu_5                -1.023920e-01 1 1  ON 5
 uu_6                -1.300979e-01 1 1  ON 6
 uu_7                -1.439757e-01 1 1  ON 7
 uu_8                -1.366807e-01 1 1  ON 8
 uu_9                -1.066413e-01 1 1  ON 9
 ud_0                 4.503720e-01 1 1  ON 10
 ud_1                 1.844057e-01 1 1  ON 11
 ud_2                 6.367305e-02 1 1  ON 12
 ud_3                -7.843230e-03 1 1  ON 13
 ud_4                -6.536624e-02 1 1  ON 14
 ud_5                -1.075294e-01 1 1  ON 15
 ud_6                -1.355656e-01 1 1  ON 16
 ud_7                -1.522117e-01 1 1  ON 17
 ud_8                -1.532901e-01 1 1  ON 18
 ud_9                -1.445494e-01 1 1  ON 19
 eO_0                -7.588775e-01 1 1  ON 20
 eO_1                -4.370273e-01 1 1  ON 21
 eO_2                -2.096403e-02 1 1  ON 22
 eO_3                 2.976592e-01 1 1  ON 23
 eO_4                 5.258547e-01 1 1  ON 24
 eO_5                 4.892867e-01 1 1  ON 25
 eO_6                 2.620333e-01 1 1  ON 26
 eO_7                -4.040136e-02 1 1  ON 27
 eO_8                -2.245247e-01 1 1  ON 28
 eO_9                -9.085565e-02 1 1  ON 29
eH1_0                -2.521650e-01 1 1  ON 30
eH1_1                -1.488711e-01 1 1  ON 31
eH1_2                -1.001421e-01 1 1  ON 32
eH1_3                -4.521377e-02 1 1  ON 33
eH1_4                 3.422668e-03 1 1  ON 34
eH1_5                 3.779054e-02 1 1  ON 35
eH1_6                 9.681311e-02 1 1  ON 36
eH1_7                 1.548289e-01 1 1  ON 37
eH1_8                 1.822036e-01 1 1  ON 38
eH1_9                 7.462269e-02 1 1  ON 39
eH2_0                -2.505469e-01 1 1  ON 40
eH2_1                -1.464853e-01 1 1  ON 41
eH2_2                -9.762482e-02 1 1  ON 42
eH2_3                -4.296955e-02 1 1  ON 43
eH2_4                 6.008405e-03 1 1  ON 44
eH2_5                 4.038604e-02 1 1  ON 45
eH2_6                 9.981410e-02 1 1  ON 46
eH2_7                 1.560298e-01 1 1  ON 47
eH2_8                 1.865379e-01 1 1  ON 48
eH2_9                 6.467143e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8545
    reference variance = 0.25454
====================================================
  Execution time = 3.4373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3854e-01
  Total weights = 2.0000e+06
  Execution time = 3.1432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338563658674
                                         uncertainty =       0.003433654418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338563658674
                                         uncertainty =       0.003433654418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411427028
  error estimate for blocks of size 2^( 2) =       0.000424023133
  error estimate for blocks of size 2^( 3) =       0.000437080930
  error estimate for blocks of size 2^( 4) =       0.000449368956
  error estimate for blocks of size 2^( 5) =       0.000460952488
  error estimate for blocks of size 2^( 6) =       0.000471002361
  error estimate for blocks of size 2^( 7) =       0.000476648738

      target function =                  N/A
              le_mean =     -16.905775812390
             les_mean =     286.143800047908
             stat err =       0.000464493136
             autocorr =       1.274597212267
              std dev =       0.581845682625
             le_variance =       0.338544398389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338564909074
                                         uncertainty =       0.003433658311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338564909074
                                         uncertainty =       0.003433658311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411427787
  error estimate for blocks of size 2^( 2) =       0.000424023859
  error estimate for blocks of size 2^( 3) =       0.000437081642
  error estimate for blocks of size 2^( 4) =       0.000449369661
  error estimate for blocks of size 2^( 5) =       0.000460953191
  error estimate for blocks of size 2^( 6) =       0.000471003009
  error estimate for blocks of size 2^( 7) =       0.000476649422

      target function =                  N/A
              le_mean =     -16.905775832457
             les_mean =     286.143801976277
             stat err =       0.000464493821
             autocorr =       1.274596265610
              std dev =       0.581846756691
             le_variance =       0.338545648272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338564286138
                                         uncertainty =       0.003433656363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338564286138
                                         uncertainty =       0.003433656363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411427409
  error estimate for blocks of size 2^( 2) =       0.000424023497
  error estimate for blocks of size 2^( 3) =       0.000437081287
  error estimate for blocks of size 2^( 4) =       0.000449369310
  error estimate for blocks of size 2^( 5) =       0.000460952841
  error estimate for blocks of size 2^( 6) =       0.000471002686
  error estimate for blocks of size 2^( 7) =       0.000476649082

      target function =                  N/A
              le_mean =     -16.905775822447
             les_mean =     286.143801015163
             stat err =       0.000464493479
             autocorr =       1.274596737121
              std dev =       0.581846221603
             le_variance =       0.338545025594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338563737176
                                         uncertainty =       0.003433654661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338563737176
                                         uncertainty =       0.003433654661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411427075
  error estimate for blocks of size 2^( 2) =       0.000424023178
  error estimate for blocks of size 2^( 3) =       0.000437080975
  error estimate for blocks of size 2^( 4) =       0.000449369000
  error estimate for blocks of size 2^( 5) =       0.000460952532
  error estimate for blocks of size 2^( 6) =       0.000471002401
  error estimate for blocks of size 2^( 7) =       0.000476648781

      target function =                  N/A
              le_mean =     -16.905775813648
             les_mean =     286.143800168897
             stat err =       0.000464493179
             autocorr =       1.274597152816
              std dev =       0.581845750056
             le_variance =       0.338544476858


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905775812390        initial
     9.7656e+01     9.7656e+02             3.2342e-06       -16.905775832457  <--
     3.9062e+02     3.9062e+03             8.0880e-07       -16.905775822447
     1.5625e+03     1.5625e+04             2.0221e-07       -16.905775813648

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 5.0226e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.112579e-01 1 1  ON 0
 uu_1                 1.437678e-01 1 1  ON 1
 uu_2                 4.176465e-02 1 1  ON 2
 uu_3                -2.113098e-02 1 1  ON 3
 uu_4                -6.732606e-02 1 1  ON 4
 uu_5                -1.023922e-01 1 1  ON 5
 uu_6                -1.300980e-01 1 1  ON 6
 uu_7                -1.439754e-01 1 1  ON 7
 uu_8                -1.366810e-01 1 1  ON 8
 uu_9                -1.066414e-01 1 1  ON 9
 ud_0                 4.503731e-01 1 1  ON 10
 ud_1                 1.844055e-01 1 1  ON 11
 ud_2                 6.367285e-02 1 1  ON 12
 ud_3                -7.843491e-03 1 1  ON 13
 ud_4                -6.536707e-02 1 1  ON 14
 ud_5                -1.075299e-01 1 1  ON 15
 ud_6                -1.355654e-01 1 1  ON 16
 ud_7                -1.522115e-01 1 1  ON 17
 ud_8                -1.532894e-01 1 1  ON 18
 ud_9                -1.445494e-01 1 1  ON 19
 eO_0                -7.588762e-01 1 1  ON 20
 eO_1                -4.370277e-01 1 1  ON 21
 eO_2                -2.096402e-02 1 1  ON 22
 eO_3                 2.976593e-01 1 1  ON 23
 eO_4                 5.258547e-01 1 1  ON 24
 eO_5                 4.892869e-01 1 1  ON 25
 eO_6                 2.620337e-01 1 1  ON 26
 eO_7                -4.040100e-02 1 1  ON 27
 eO_8                -2.245253e-01 1 1  ON 28
 eO_9                -9.085664e-02 1 1  ON 29
eH1_0                -2.521674e-01 1 1  ON 30
eH1_1                -1.488720e-01 1 1  ON 31
eH1_2                -1.001428e-01 1 1  ON 32
eH1_3                -4.521443e-02 1 1  ON 33
eH1_4                 3.423877e-03 1 1  ON 34
eH1_5                 3.779095e-02 1 1  ON 35
eH1_6                 9.681299e-02 1 1  ON 36
eH1_7                 1.548294e-01 1 1  ON 37
eH1_8                 1.822049e-01 1 1  ON 38
eH1_9                 7.462413e-02 1 1  ON 39
eH2_0                -2.505481e-01 1 1  ON 40
eH2_1                -1.464865e-01 1 1  ON 41
eH2_2                -9.762446e-02 1 1  ON 42
eH2_3                -4.296962e-02 1 1  ON 43
eH2_4                 6.008153e-03 1 1  ON 44
eH2_5                 4.038528e-02 1 1  ON 45
eH2_6                 9.981409e-02 1 1  ON 46
eH2_7                 1.560302e-01 1 1  ON 47
eH2_8                 1.865388e-01 1 1  ON 48
eH2_9                 6.467297e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5515e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9282
    reference variance = 0.219237
====================================================
  Execution time = 3.4253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3502e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334786707464
                                         uncertainty =       0.002717481667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334786707464
                                         uncertainty =       0.002717481667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409281507
  error estimate for blocks of size 2^( 2) =       0.000421916438
  error estimate for blocks of size 2^( 3) =       0.000435146589
  error estimate for blocks of size 2^( 4) =       0.000447161359
  error estimate for blocks of size 2^( 5) =       0.000458139905
  error estimate for blocks of size 2^( 6) =       0.000466225095
  error estimate for blocks of size 2^( 7) =       0.000471124179

      target function =                  N/A
              le_mean =     -16.905926436826
             les_mean =     286.145371223679
             stat err =       0.000460662634
             autocorr =       1.266839890358
              std dev =       0.578811457933
             le_variance =       0.335022703834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592643683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926436826       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926450597       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926463525       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926450872       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926458833       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926466996       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926473645       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926469090       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.631466e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926436826       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926440288       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926443545       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926440334       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926442377       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926444314       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926446058       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926444916       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.408790e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905926436826       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926437692       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926438508       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926437702       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926438217       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905926438694       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926439136       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926438850       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 6.022550e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041885 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3547e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.112572e-01 1 1  ON 0
 uu_1                 1.437672e-01 1 1  ON 1
 uu_2                 4.176541e-02 1 1  ON 2
 uu_3                -2.113149e-02 1 1  ON 3
 uu_4                -6.732559e-02 1 1  ON 4
 uu_5                -1.023929e-01 1 1  ON 5
 uu_6                -1.300982e-01 1 1  ON 6
 uu_7                -1.439749e-01 1 1  ON 7
 uu_8                -1.366814e-01 1 1  ON 8
 uu_9                -1.066419e-01 1 1  ON 9
 ud_0                 4.503731e-01 1 1  ON 10
 ud_1                 1.844053e-01 1 1  ON 11
 ud_2                 6.367380e-02 1 1  ON 12
 ud_3                -7.844032e-03 1 1  ON 13
 ud_4                -6.536748e-02 1 1  ON 14
 ud_5                -1.075292e-01 1 1  ON 15
 ud_6                -1.355658e-01 1 1  ON 16
 ud_7                -1.522120e-01 1 1  ON 17
 ud_8                -1.532895e-01 1 1  ON 18
 ud_9                -1.445487e-01 1 1  ON 19
 eO_0                -7.588749e-01 1 1  ON 20
 eO_1                -4.370277e-01 1 1  ON 21
 eO_2                -2.096436e-02 1 1  ON 22
 eO_3                 2.976590e-01 1 1  ON 23
 eO_4                 5.258541e-01 1 1  ON 24
 eO_5                 4.892881e-01 1 1  ON 25
 eO_6                 2.620342e-01 1 1  ON 26
 eO_7                -4.040093e-02 1 1  ON 27
 eO_8                -2.245261e-01 1 1  ON 28
 eO_9                -9.085767e-02 1 1  ON 29
eH1_0                -2.521695e-01 1 1  ON 30
eH1_1                -1.488725e-01 1 1  ON 31
eH1_2                -1.001437e-01 1 1  ON 32
eH1_3                -4.521468e-02 1 1  ON 33
eH1_4                 3.423664e-03 1 1  ON 34
eH1_5                 3.778979e-02 1 1  ON 35
eH1_6                 9.681334e-02 1 1  ON 36
eH1_7                 1.548303e-01 1 1  ON 37
eH1_8                 1.822060e-01 1 1  ON 38
eH1_9                 7.462621e-02 1 1  ON 39
eH2_0                -2.505490e-01 1 1  ON 40
eH2_1                -1.464873e-01 1 1  ON 41
eH2_2                -9.762453e-02 1 1  ON 42
eH2_3                -4.297010e-02 1 1  ON 43
eH2_4                 6.008069e-03 1 1  ON 44
eH2_5                 4.038529e-02 1 1  ON 45
eH2_6                 9.981274e-02 1 1  ON 46
eH2_7                 1.560300e-01 1 1  ON 47
eH2_8                 1.865401e-01 1 1  ON 48
eH2_9                 6.467538e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8717
    reference variance = 0.299016
====================================================
  Execution time = 3.3549e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3475e-01
  Total weights = 2.0000e+06
  Execution time = 3.1533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334422857463
                                         uncertainty =       0.003544997981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334422857463
                                         uncertainty =       0.003544997981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409113741
  error estimate for blocks of size 2^( 2) =       0.000421912009
  error estimate for blocks of size 2^( 3) =       0.000435169607
  error estimate for blocks of size 2^( 4) =       0.000448322651
  error estimate for blocks of size 2^( 5) =       0.000459321299
  error estimate for blocks of size 2^( 6) =       0.000468172416
  error estimate for blocks of size 2^( 7) =       0.000473588352

      target function =                  N/A
              le_mean =     -16.906351921589
             les_mean =     286.159483234825
             stat err =       0.000462351180
             autocorr =       1.277190877837
              std dev =       0.578574200598
             le_variance =       0.334748105597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334418698494
                                         uncertainty =       0.003544992119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334418698494
                                         uncertainty =       0.003544992119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409111196
  error estimate for blocks of size 2^( 2) =       0.000421909590
  error estimate for blocks of size 2^( 3) =       0.000435167294
  error estimate for blocks of size 2^( 4) =       0.000448320433
  error estimate for blocks of size 2^( 5) =       0.000459319168
  error estimate for blocks of size 2^( 6) =       0.000468170371
  error estimate for blocks of size 2^( 7) =       0.000473586311

      target function =                  N/A
              le_mean =     -16.906351922137
             les_mean =     286.159479088771
             stat err =       0.000462349071
             autocorr =       1.277195115965
              std dev =       0.578570601554
             le_variance =       0.334743940982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334420754385
                                         uncertainty =       0.003544995140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334420754385
                                         uncertainty =       0.003544995140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409112454
  error estimate for blocks of size 2^( 2) =       0.000421910786
  error estimate for blocks of size 2^( 3) =       0.000435168438
  error estimate for blocks of size 2^( 4) =       0.000448321530
  error estimate for blocks of size 2^( 5) =       0.000459320222
  error estimate for blocks of size 2^( 6) =       0.000468171383
  error estimate for blocks of size 2^( 7) =       0.000473587321

      target function =                  N/A
              le_mean =     -16.906351921767
             les_mean =     286.159481134877
             stat err =       0.000462350114
             autocorr =       1.277193023565
              std dev =       0.578572380632
             le_variance =       0.334745999631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334422593793
                                         uncertainty =       0.003544997629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334422593793
                                         uncertainty =       0.003544997629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409113579
  error estimate for blocks of size 2^( 2) =       0.000421911855
  error estimate for blocks of size 2^( 3) =       0.000435169461
  error estimate for blocks of size 2^( 4) =       0.000448322511
  error estimate for blocks of size 2^( 5) =       0.000459321164
  error estimate for blocks of size 2^( 6) =       0.000468172287
  error estimate for blocks of size 2^( 7) =       0.000473588223

      target function =                  N/A
              le_mean =     -16.906351921604
             les_mean =     286.159482971311
             stat err =       0.000462351046
             autocorr =       1.277191146915
              std dev =       0.578573972421
             le_variance =       0.334747841564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906351921589        initial
     2.4414e+01     2.4414e+02             9.6315e-06       -16.906351922137  <--
     9.7656e+01     9.7656e+02             2.4088e-06       -16.906351921767
     3.9062e+02     3.9062e+03             6.0225e-07       -16.906351921604

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 4.9482e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.112553e-01 1 1  ON 0
 uu_1                 1.437656e-01 1 1  ON 1
 uu_2                 4.176763e-02 1 1  ON 2
 uu_3                -2.113297e-02 1 1  ON 3
 uu_4                -6.732424e-02 1 1  ON 4
 uu_5                -1.023948e-01 1 1  ON 5
 uu_6                -1.300988e-01 1 1  ON 6
 uu_7                -1.439733e-01 1 1  ON 7
 uu_8                -1.366825e-01 1 1  ON 8
 uu_9                -1.066434e-01 1 1  ON 9
 ud_0                 4.503731e-01 1 1  ON 10
 ud_1                 1.844047e-01 1 1  ON 11
 ud_2                 6.367658e-02 1 1  ON 12
 ud_3                -7.845610e-03 1 1  ON 13
 ud_4                -6.536868e-02 1 1  ON 14
 ud_5                -1.075273e-01 1 1  ON 15
 ud_6                -1.355670e-01 1 1  ON 16
 ud_7                -1.522133e-01 1 1  ON 17
 ud_8                -1.532897e-01 1 1  ON 18
 ud_9                -1.445466e-01 1 1  ON 19
 eO_0                -7.588710e-01 1 1  ON 20
 eO_1                -4.370275e-01 1 1  ON 21
 eO_2                -2.096533e-02 1 1  ON 22
 eO_3                 2.976580e-01 1 1  ON 23
 eO_4                 5.258524e-01 1 1  ON 24
 eO_5                 4.892918e-01 1 1  ON 25
 eO_6                 2.620358e-01 1 1  ON 26
 eO_7                -4.040071e-02 1 1  ON 27
 eO_8                -2.245285e-01 1 1  ON 28
 eO_9                -9.086074e-02 1 1  ON 29
eH1_0                -2.521757e-01 1 1  ON 30
eH1_1                -1.488738e-01 1 1  ON 31
eH1_2                -1.001463e-01 1 1  ON 32
eH1_3                -4.521543e-02 1 1  ON 33
eH1_4                 3.423018e-03 1 1  ON 34
eH1_5                 3.778630e-02 1 1  ON 35
eH1_6                 9.681441e-02 1 1  ON 36
eH1_7                 1.548330e-01 1 1  ON 37
eH1_8                 1.822096e-01 1 1  ON 38
eH1_9                 7.463245e-02 1 1  ON 39
eH2_0                -2.505518e-01 1 1  ON 40
eH2_1                -1.464898e-01 1 1  ON 41
eH2_2                -9.762478e-02 1 1  ON 42
eH2_3                -4.297154e-02 1 1  ON 43
eH2_4                 6.007808e-03 1 1  ON 44
eH2_5                 4.038532e-02 1 1  ON 45
eH2_6                 9.980871e-02 1 1  ON 46
eH2_7                 1.560293e-01 1 1  ON 47
eH2_8                 1.865438e-01 1 1  ON 48
eH2_9                 6.468260e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3037e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9298
    reference variance = 0.169605
====================================================
  Execution time = 3.4036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3976e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339792858949
                                         uncertainty =       0.004912919108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339792858949
                                         uncertainty =       0.004912919108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412166714
  error estimate for blocks of size 2^( 2) =       0.000424788909
  error estimate for blocks of size 2^( 3) =       0.000436948175
  error estimate for blocks of size 2^( 4) =       0.000448976099
  error estimate for blocks of size 2^( 5) =       0.000459062056
  error estimate for blocks of size 2^( 6) =       0.000467825517
  error estimate for blocks of size 2^( 7) =       0.000473169281

      target function =                  N/A
              le_mean =     -16.905374175716
             les_mean =     286.131438650569
             stat err =       0.000462258238
             autocorr =       1.257834461354
              std dev =       0.582891756243
             le_variance =       0.339762799497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690537417572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905374175716       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905374355225       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905374344712       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905374384906       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905374388718       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905374381583       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905374353010       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905374375643       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.645696e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905374175716       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905374221655       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905374219582       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905374230295       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905374231577       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905374230278       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905374221766       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905374227194       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.167303e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905374175716       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905374187269       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905374186789       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905374189511       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905374189855       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905374189566       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905374187351       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905374188687       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.921958e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3304e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.112565e-01 1 1  ON 0
 uu_1                 1.437715e-01 1 1  ON 1
 uu_2                 4.176673e-02 1 1  ON 2
 uu_3                -2.113331e-02 1 1  ON 3
 uu_4                -6.732569e-02 1 1  ON 4
 uu_5                -1.023938e-01 1 1  ON 5
 uu_6                -1.300999e-01 1 1  ON 6
 uu_7                -1.439745e-01 1 1  ON 7
 uu_8                -1.366861e-01 1 1  ON 8
 uu_9                -1.066483e-01 1 1  ON 9
 ud_0                 4.503734e-01 1 1  ON 10
 ud_1                 1.844017e-01 1 1  ON 11
 ud_2                 6.368269e-02 1 1  ON 12
 ud_3                -7.844956e-03 1 1  ON 13
 ud_4                -6.536653e-02 1 1  ON 14
 ud_5                -1.075269e-01 1 1  ON 15
 ud_6                -1.355699e-01 1 1  ON 16
 ud_7                -1.522145e-01 1 1  ON 17
 ud_8                -1.532882e-01 1 1  ON 18
 ud_9                -1.445484e-01 1 1  ON 19
 eO_0                -7.588675e-01 1 1  ON 20
 eO_1                -4.370249e-01 1 1  ON 21
 eO_2                -2.096755e-02 1 1  ON 22
 eO_3                 2.976592e-01 1 1  ON 23
 eO_4                 5.258524e-01 1 1  ON 24
 eO_5                 4.892949e-01 1 1  ON 25
 eO_6                 2.620388e-01 1 1  ON 26
 eO_7                -4.039987e-02 1 1  ON 27
 eO_8                -2.245337e-01 1 1  ON 28
 eO_9                -9.086664e-02 1 1  ON 29
eH1_0                -2.521873e-01 1 1  ON 30
eH1_1                -1.488777e-01 1 1  ON 31
eH1_2                -1.001448e-01 1 1  ON 32
eH1_3                -4.521984e-02 1 1  ON 33
eH1_4                 3.423420e-03 1 1  ON 34
eH1_5                 3.778928e-02 1 1  ON 35
eH1_6                 9.681506e-02 1 1  ON 36
eH1_7                 1.548332e-01 1 1  ON 37
eH1_8                 1.822158e-01 1 1  ON 38
eH1_9                 7.463959e-02 1 1  ON 39
eH2_0                -2.505570e-01 1 1  ON 40
eH2_1                -1.464898e-01 1 1  ON 41
eH2_2                -9.763276e-02 1 1  ON 42
eH2_3                -4.297185e-02 1 1  ON 43
eH2_4                 6.005981e-03 1 1  ON 44
eH2_5                 4.038273e-02 1 1  ON 45
eH2_6                 9.980878e-02 1 1  ON 46
eH2_7                 1.560352e-01 1 1  ON 47
eH2_8                 1.865477e-01 1 1  ON 48
eH2_9                 6.469004e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9573
    reference variance = 0.394615
====================================================
  Execution time = 3.3375e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6469e-01
  Total weights = 2.0000e+06
  Execution time = 3.1326e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364791519381
                                         uncertainty =       0.017249461926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364791519381
                                         uncertainty =       0.017249461926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427021243
  error estimate for blocks of size 2^( 2) =       0.000439490766
  error estimate for blocks of size 2^( 3) =       0.000452041573
  error estimate for blocks of size 2^( 4) =       0.000463566331
  error estimate for blocks of size 2^( 5) =       0.000473753305
  error estimate for blocks of size 2^( 6) =       0.000481604188
  error estimate for blocks of size 2^( 7) =       0.000485835109

      target function =                  N/A
              le_mean =     -16.906210016065
             les_mean =     286.184631209422
             stat err =       0.000476189733
             autocorr =       1.243543819729
              std dev =       0.603899233707
             le_variance =       0.364694284472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364784345504
                                         uncertainty =       0.017248536344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364784345504
                                         uncertainty =       0.017248536344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427017039
  error estimate for blocks of size 2^( 2) =       0.000439486881
  error estimate for blocks of size 2^( 3) =       0.000452037897
  error estimate for blocks of size 2^( 4) =       0.000463563272
  error estimate for blocks of size 2^( 5) =       0.000473750266
  error estimate for blocks of size 2^( 6) =       0.000481600610
  error estimate for blocks of size 2^( 7) =       0.000485831827

      target function =                  N/A
              le_mean =     -16.906210107836
             les_mean =     286.184627131664
             stat err =       0.000476186494
             autocorr =       1.243551386436
              std dev =       0.603893288355
             le_variance =       0.364687103721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364787938767
                                         uncertainty =       0.017248953714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364787938767
                                         uncertainty =       0.017248953714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427019145
  error estimate for blocks of size 2^( 2) =       0.000439488830
  error estimate for blocks of size 2^( 3) =       0.000452039747
  error estimate for blocks of size 2^( 4) =       0.000463564831
  error estimate for blocks of size 2^( 5) =       0.000473751813
  error estimate for blocks of size 2^( 6) =       0.000481602394
  error estimate for blocks of size 2^( 7) =       0.000485833468

      target function =                  N/A
              le_mean =     -16.906210064518
             les_mean =     286.184629263407
             stat err =       0.000476188127
             autocorr =       1.243547651409
              std dev =       0.603896266050
             le_variance =       0.364690700149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364791071223
                                         uncertainty =       0.017249396805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364791071223
                                         uncertainty =       0.017249396805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427020981
  error estimate for blocks of size 2^( 2) =       0.000439490524
  error estimate for blocks of size 2^( 3) =       0.000452041344
  error estimate for blocks of size 2^( 4) =       0.000463566144
  error estimate for blocks of size 2^( 5) =       0.000473753119
  error estimate for blocks of size 2^( 6) =       0.000481603963
  error estimate for blocks of size 2^( 7) =       0.000485834903

      target function =                  N/A
              le_mean =     -16.906210022109
             les_mean =     286.184630965166
             stat err =       0.000476189532
             autocorr =       1.243544300266
              std dev =       0.603898862261
             le_variance =       0.364693835840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906210016065        initial
     6.1035e+00     6.1035e+01             4.6457e-05       -16.906210107836  <--
     2.4414e+01     2.4414e+02             1.1673e-05       -16.906210064518
     9.7656e+01     9.7656e+02             2.9220e-06       -16.906210022109

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 4.9183e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.112602e-01 1 1  ON 0
 uu_1                 1.437882e-01 1 1  ON 1
 uu_2                 4.176467e-02 1 1  ON 2
 uu_3                -2.113443e-02 1 1  ON 3
 uu_4                -6.732971e-02 1 1  ON 4
 uu_5                -1.023908e-01 1 1  ON 5
 uu_6                -1.301031e-01 1 1  ON 6
 uu_7                -1.439779e-01 1 1  ON 7
 uu_8                -1.366968e-01 1 1  ON 8
 uu_9                -1.066630e-01 1 1  ON 9
 ud_0                 4.503737e-01 1 1  ON 10
 ud_1                 1.843941e-01 1 1  ON 11
 ud_2                 6.369975e-02 1 1  ON 12
 ud_3                -7.842382e-03 1 1  ON 13
 ud_4                -6.536042e-02 1 1  ON 14
 ud_5                -1.075257e-01 1 1  ON 15
 ud_6                -1.355783e-01 1 1  ON 16
 ud_7                -1.522182e-01 1 1  ON 17
 ud_8                -1.532838e-01 1 1  ON 18
 ud_9                -1.445539e-01 1 1  ON 19
 eO_0                -7.588570e-01 1 1  ON 20
 eO_1                -4.370172e-01 1 1  ON 21
 eO_2                -2.097372e-02 1 1  ON 22
 eO_3                 2.976625e-01 1 1  ON 23
 eO_4                 5.258522e-01 1 1  ON 24
 eO_5                 4.893041e-01 1 1  ON 25
 eO_6                 2.620477e-01 1 1  ON 26
 eO_7                -4.039738e-02 1 1  ON 27
 eO_8                -2.245495e-01 1 1  ON 28
 eO_9                -9.088428e-02 1 1  ON 29
eH1_0                -2.522221e-01 1 1  ON 30
eH1_1                -1.488890e-01 1 1  ON 31
eH1_2                -1.001410e-01 1 1  ON 32
eH1_3                -4.523259e-02 1 1  ON 33
eH1_4                 3.424469e-03 1 1  ON 34
eH1_5                 3.779821e-02 1 1  ON 35
eH1_6                 9.681705e-02 1 1  ON 36
eH1_7                 1.548337e-01 1 1  ON 37
eH1_8                 1.822345e-01 1 1  ON 38
eH1_9                 7.466096e-02 1 1  ON 39
eH2_0                -2.505724e-01 1 1  ON 40
eH2_1                -1.464904e-01 1 1  ON 41
eH2_2                -9.765603e-02 1 1  ON 42
eH2_3                -4.297306e-02 1 1  ON 43
eH2_4                 6.000584e-03 1 1  ON 44
eH2_5                 4.037504e-02 1 1  ON 45
eH2_6                 9.980900e-02 1 1  ON 46
eH2_7                 1.560528e-01 1 1  ON 47
eH2_8                 1.865594e-01 1 1  ON 48
eH2_9                 6.471230e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2496e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9209
    reference variance = 0.145459
====================================================
  Execution time = 3.3942e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5502e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355159439099
                                         uncertainty =       0.011306826557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355159439099
                                         uncertainty =       0.011306826557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421316819
  error estimate for blocks of size 2^( 2) =       0.000433662347
  error estimate for blocks of size 2^( 3) =       0.000446132150
  error estimate for blocks of size 2^( 4) =       0.000457538613
  error estimate for blocks of size 2^( 5) =       0.000467387735
  error estimate for blocks of size 2^( 6) =       0.000472545990
  error estimate for blocks of size 2^( 7) =       0.000477401805

      target function =                  N/A
              le_mean =     -16.906403210817
             les_mean =     286.181485073485
             stat err =       0.000468718536
             autocorr =       1.237675128209
              std dev =       0.595831959754
             le_variance =       0.355015724264


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690640321082e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906403210817       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906403536537       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906403523199       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906403695353       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906403553318       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906403856329       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906403860398       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906403808345       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906403835239       residual = 8.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.797735e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906403210817       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906403295472       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906403291142       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906403335606       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906403295231       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906403371385       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906403377235       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906403364662       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.607634e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906403210817       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906403232193       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906403231044       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906403242246       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906403231748       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906403250717       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906403252587       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906403249518       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.160249e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3125e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.112561e-01 1 1  ON 0
 uu_1                 1.437900e-01 1 1  ON 1
 uu_2                 4.177887e-02 1 1  ON 2
 uu_3                -2.112789e-02 1 1  ON 3
 uu_4                -6.731528e-02 1 1  ON 4
 uu_5                -1.024052e-01 1 1  ON 5
 uu_6                -1.301056e-01 1 1  ON 6
 uu_7                -1.440004e-01 1 1  ON 7
 uu_8                -1.367027e-01 1 1  ON 8
 uu_9                -1.066700e-01 1 1  ON 9
 ud_0                 4.503671e-01 1 1  ON 10
 ud_1                 1.844064e-01 1 1  ON 11
 ud_2                 6.371440e-02 1 1  ON 12
 ud_3                -7.832876e-03 1 1  ON 13
 ud_4                -6.535003e-02 1 1  ON 14
 ud_5                -1.075143e-01 1 1  ON 15
 ud_6                -1.355665e-01 1 1  ON 16
 ud_7                -1.522297e-01 1 1  ON 17
 ud_8                -1.532978e-01 1 1  ON 18
 ud_9                -1.445718e-01 1 1  ON 19
 eO_0                -7.588344e-01 1 1  ON 20
 eO_1                -4.370065e-01 1 1  ON 21
 eO_2                -2.097790e-02 1 1  ON 22
 eO_3                 2.976594e-01 1 1  ON 23
 eO_4                 5.258505e-01 1 1  ON 24
 eO_5                 4.893171e-01 1 1  ON 25
 eO_6                 2.620607e-01 1 1  ON 26
 eO_7                -4.040006e-02 1 1  ON 27
 eO_8                -2.245675e-01 1 1  ON 28
 eO_9                -9.090921e-02 1 1  ON 29
eH1_0                -2.522516e-01 1 1  ON 30
eH1_1                -1.489087e-01 1 1  ON 31
eH1_2                -1.001399e-01 1 1  ON 32
eH1_3                -4.523021e-02 1 1  ON 33
eH1_4                 3.430176e-03 1 1  ON 34
eH1_5                 3.778669e-02 1 1  ON 35
eH1_6                 9.681203e-02 1 1  ON 36
eH1_7                 1.548398e-01 1 1  ON 37
eH1_8                 1.822533e-01 1 1  ON 38
eH1_9                 7.468813e-02 1 1  ON 39
eH2_0                -2.506184e-01 1 1  ON 40
eH2_1                -1.465116e-01 1 1  ON 41
eH2_2                -9.764649e-02 1 1  ON 42
eH2_3                -4.296972e-02 1 1  ON 43
eH2_4                 6.013707e-03 1 1  ON 44
eH2_5                 4.039668e-02 1 1  ON 45
eH2_6                 9.979794e-02 1 1  ON 46
eH2_7                 1.560455e-01 1 1  ON 47
eH2_8                 1.865690e-01 1 1  ON 48
eH2_9                 6.474244e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8513
    reference variance = 0.725432
====================================================
  Execution time = 3.6138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.7757e-01
  Total weights = 2.0000e+06
  Execution time = 3.1354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377662022236
                                         uncertainty =       0.026583821182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377662022236
                                         uncertainty =       0.026583821182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434510151
  error estimate for blocks of size 2^( 2) =       0.000446977432
  error estimate for blocks of size 2^( 3) =       0.000460027696
  error estimate for blocks of size 2^( 4) =       0.000472751425
  error estimate for blocks of size 2^( 5) =       0.000484931074
  error estimate for blocks of size 2^( 6) =       0.000497753653
  error estimate for blocks of size 2^( 7) =       0.000506822928

      target function =                  N/A
              le_mean =     -16.906516555368
             les_mean =     286.207899991335
             stat err =       0.000490564770
             autocorr =       1.274655597576
              std dev =       0.614490148979
             le_variance =       0.377598143192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377562768084
                                         uncertainty =       0.026580698503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377562768084
                                         uncertainty =       0.026580698503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434453030
  error estimate for blocks of size 2^( 2) =       0.000446922717
  error estimate for blocks of size 2^( 3) =       0.000459975261
  error estimate for blocks of size 2^( 4) =       0.000472701427
  error estimate for blocks of size 2^( 5) =       0.000484883408
  error estimate for blocks of size 2^( 6) =       0.000497707422
  error estimate for blocks of size 2^( 7) =       0.000506779083

      target function =                  N/A
              le_mean =     -16.906516327293
             les_mean =     286.207793006024
             stat err =       0.000490517835
             autocorr =       1.274746844363
              std dev =       0.614409366580
             le_variance =       0.377498869742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377600465392
                                         uncertainty =       0.026581284108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377600465392
                                         uncertainty =       0.026581284108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434474727
  error estimate for blocks of size 2^( 2) =       0.000446943549
  error estimate for blocks of size 2^( 3) =       0.000459995245
  error estimate for blocks of size 2^( 4) =       0.000472720480
  error estimate for blocks of size 2^( 5) =       0.000484901465
  error estimate for blocks of size 2^( 6) =       0.000497724931
  error estimate for blocks of size 2^( 7) =       0.000506795513

      target function =                  N/A
              le_mean =     -16.906516420249
             les_mean =     286.207833856165
             stat err =       0.000490535597
             autocorr =       1.274711840211
              std dev =       0.614440051412
             le_variance =       0.377536576779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377653975273
                                         uncertainty =       0.026583481179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377653975273
                                         uncertainty =       0.026583481179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434505521
  error estimate for blocks of size 2^( 2) =       0.000446973004
  error estimate for blocks of size 2^( 3) =       0.000460023455
  error estimate for blocks of size 2^( 4) =       0.000472747381
  error estimate for blocks of size 2^( 5) =       0.000484927201
  error estimate for blocks of size 2^( 6) =       0.000497749896
  error estimate for blocks of size 2^( 7) =       0.000506819336

      target function =                  N/A
              le_mean =     -16.906516536756
             les_mean =     286.207891313840
             stat err =       0.000490560954
             autocorr =       1.274662935131
              std dev =       0.614483600300
             le_variance =       0.377590095037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906516555368        initial  <--
     1.5259e+00     1.5259e+01             1.7977e-04       -16.906516327293
     6.1035e+00     6.1035e+01             4.6076e-05       -16.906516420249
     2.4414e+01     2.4414e+02             1.1602e-05       -16.906516536756

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.8748
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.112602e-01 1 1  ON 0
 uu_1                 1.437882e-01 1 1  ON 1
 uu_2                 4.176467e-02 1 1  ON 2
 uu_3                -2.113443e-02 1 1  ON 3
 uu_4                -6.732971e-02 1 1  ON 4
 uu_5                -1.023908e-01 1 1  ON 5
 uu_6                -1.301031e-01 1 1  ON 6
 uu_7                -1.439779e-01 1 1  ON 7
 uu_8                -1.366968e-01 1 1  ON 8
 uu_9                -1.066630e-01 1 1  ON 9
 ud_0                 4.503737e-01 1 1  ON 10
 ud_1                 1.843941e-01 1 1  ON 11
 ud_2                 6.369975e-02 1 1  ON 12
 ud_3                -7.842382e-03 1 1  ON 13
 ud_4                -6.536042e-02 1 1  ON 14
 ud_5                -1.075257e-01 1 1  ON 15
 ud_6                -1.355783e-01 1 1  ON 16
 ud_7                -1.522182e-01 1 1  ON 17
 ud_8                -1.532838e-01 1 1  ON 18
 ud_9                -1.445539e-01 1 1  ON 19
 eO_0                -7.588570e-01 1 1  ON 20
 eO_1                -4.370172e-01 1 1  ON 21
 eO_2                -2.097372e-02 1 1  ON 22
 eO_3                 2.976625e-01 1 1  ON 23
 eO_4                 5.258522e-01 1 1  ON 24
 eO_5                 4.893041e-01 1 1  ON 25
 eO_6                 2.620477e-01 1 1  ON 26
 eO_7                -4.039738e-02 1 1  ON 27
 eO_8                -2.245495e-01 1 1  ON 28
 eO_9                -9.088428e-02 1 1  ON 29
eH1_0                -2.522221e-01 1 1  ON 30
eH1_1                -1.488890e-01 1 1  ON 31
eH1_2                -1.001410e-01 1 1  ON 32
eH1_3                -4.523259e-02 1 1  ON 33
eH1_4                 3.424469e-03 1 1  ON 34
eH1_5                 3.779821e-02 1 1  ON 35
eH1_6                 9.681705e-02 1 1  ON 36
eH1_7                 1.548337e-01 1 1  ON 37
eH1_8                 1.822345e-01 1 1  ON 38
eH1_9                 7.466096e-02 1 1  ON 39
eH2_0                -2.505724e-01 1 1  ON 40
eH2_1                -1.464904e-01 1 1  ON 41
eH2_2                -9.765603e-02 1 1  ON 42
eH2_3                -4.297306e-02 1 1  ON 43
eH2_4                 6.000584e-03 1 1  ON 44
eH2_5                 4.037504e-02 1 1  ON 45
eH2_6                 9.980900e-02 1 1  ON 46
eH2_7                 1.560528e-01 1 1  ON 47
eH2_8                 1.865594e-01 1 1  ON 48
eH2_9                 6.471230e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5008e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9541
    reference variance = 0.170247
====================================================
  Execution time = 3.3989e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4012e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340179267589
                                         uncertainty =       0.005126892881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340179267589
                                         uncertainty =       0.005126892881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412384017
  error estimate for blocks of size 2^( 2) =       0.000425064605
  error estimate for blocks of size 2^( 3) =       0.000438170336
  error estimate for blocks of size 2^( 4) =       0.000450539429
  error estimate for blocks of size 2^( 5) =       0.000461929502
  error estimate for blocks of size 2^( 6) =       0.000470098411
  error estimate for blocks of size 2^( 7) =       0.000476130346

      target function =                  N/A
              le_mean =     -16.906303993760
             les_mean =     286.163235714510
             stat err =       0.000464674422
             autocorr =       1.269678848316
              std dev =       0.583199069917
             le_variance =       0.340121155152


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630399376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906303993760       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906303981334       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906303969591       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906303939543       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906303942714       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906303983701       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906303995970       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906303997989       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.098306e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906303993760       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906303990637       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906303987416       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906303979762       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906303980606       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906303990882       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906303993999       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906303994509       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 5.269834e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906303993760       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906303992978       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906303992155       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906303990232       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906303990446       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906303993017       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906303993799       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906303993927       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.318974e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050206 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3281e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.112610e-01 1 1  ON 0
 uu_1                 1.437879e-01 1 1  ON 1
 uu_2                 4.176467e-02 1 1  ON 2
 uu_3                -2.113727e-02 1 1  ON 3
 uu_4                -6.732945e-02 1 1  ON 4
 uu_5                -1.023906e-01 1 1  ON 5
 uu_6                -1.301055e-01 1 1  ON 6
 uu_7                -1.439773e-01 1 1  ON 7
 uu_8                -1.366956e-01 1 1  ON 8
 uu_9                -1.066639e-01 1 1  ON 9
 ud_0                 4.503728e-01 1 1  ON 10
 ud_1                 1.843931e-01 1 1  ON 11
 ud_2                 6.369852e-02 1 1  ON 12
 ud_3                -7.841249e-03 1 1  ON 13
 ud_4                -6.536181e-02 1 1  ON 14
 ud_5                -1.075243e-01 1 1  ON 15
 ud_6                -1.355787e-01 1 1  ON 16
 ud_7                -1.522174e-01 1 1  ON 17
 ud_8                -1.532824e-01 1 1  ON 18
 ud_9                -1.445524e-01 1 1  ON 19
 eO_0                -7.588556e-01 1 1  ON 20
 eO_1                -4.370171e-01 1 1  ON 21
 eO_2                -2.097313e-02 1 1  ON 22
 eO_3                 2.976618e-01 1 1  ON 23
 eO_4                 5.258511e-01 1 1  ON 24
 eO_5                 4.893043e-01 1 1  ON 25
 eO_6                 2.620489e-01 1 1  ON 26
 eO_7                -4.039540e-02 1 1  ON 27
 eO_8                -2.245503e-01 1 1  ON 28
 eO_9                -9.088648e-02 1 1  ON 29
eH1_0                -2.522274e-01 1 1  ON 30
eH1_1                -1.488887e-01 1 1  ON 31
eH1_2                -1.001415e-01 1 1  ON 32
eH1_3                -4.523209e-02 1 1  ON 33
eH1_4                 3.425435e-03 1 1  ON 34
eH1_5                 3.779324e-02 1 1  ON 35
eH1_6                 9.681738e-02 1 1  ON 36
eH1_7                 1.548357e-01 1 1  ON 37
eH1_8                 1.822373e-01 1 1  ON 38
eH1_9                 7.466441e-02 1 1  ON 39
eH2_0                -2.505736e-01 1 1  ON 40
eH2_1                -1.464928e-01 1 1  ON 41
eH2_2                -9.765677e-02 1 1  ON 42
eH2_3                -4.297401e-02 1 1  ON 43
eH2_4                 6.001300e-03 1 1  ON 44
eH2_5                 4.037333e-02 1 1  ON 45
eH2_6                 9.980956e-02 1 1  ON 46
eH2_7                 1.560540e-01 1 1  ON 47
eH2_8                 1.865602e-01 1 1  ON 48
eH2_9                 6.471543e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9174
    reference variance = 0.2942
====================================================
  Execution time = 3.3456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5377e-01
  Total weights = 2.0000e+06
  Execution time = 3.1133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353787305674
                                         uncertainty =       0.011432523164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353787305674
                                         uncertainty =       0.011432523164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420579811
  error estimate for blocks of size 2^( 2) =       0.000432665313
  error estimate for blocks of size 2^( 3) =       0.000445211184
  error estimate for blocks of size 2^( 4) =       0.000456778894
  error estimate for blocks of size 2^( 5) =       0.000466316418
  error estimate for blocks of size 2^( 6) =       0.000472446563
  error estimate for blocks of size 2^( 7) =       0.000477144359

      target function =                  N/A
              le_mean =     -16.906501933624
             les_mean =     286.183582209346
             stat err =       0.000468171559
             autocorr =       1.239119555352
              std dev =       0.594789672567
             le_variance =       0.353774754592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353788256474
                                         uncertainty =       0.011432459056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353788256474
                                         uncertainty =       0.011432459056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420580375
  error estimate for blocks of size 2^( 2) =       0.000432665885
  error estimate for blocks of size 2^( 3) =       0.000445211785
  error estimate for blocks of size 2^( 4) =       0.000456779540
  error estimate for blocks of size 2^( 5) =       0.000466316981
  error estimate for blocks of size 2^( 6) =       0.000472446897
  error estimate for blocks of size 2^( 7) =       0.000477144616

      target function =                  N/A
              le_mean =     -16.906501958659
             les_mean =     286.183584005295
             stat err =       0.000468172008
             autocorr =       1.239118610237
              std dev =       0.594790470715
             le_variance =       0.353775704053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353787808950
                                         uncertainty =       0.011432488468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353787808950
                                         uncertainty =       0.011432488468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420580110
  error estimate for blocks of size 2^( 2) =       0.000432665615
  error estimate for blocks of size 2^( 3) =       0.000445211500
  error estimate for blocks of size 2^( 4) =       0.000456779231
  error estimate for blocks of size 2^( 5) =       0.000466316712
  error estimate for blocks of size 2^( 6) =       0.000472446741
  error estimate for blocks of size 2^( 7) =       0.000477144499

      target function =                  N/A
              le_mean =     -16.906501945692
             les_mean =     286.183583120021
             stat err =       0.000468171796
             autocorr =       1.239119051200
              std dev =       0.594790095089
             le_variance =       0.353775257216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353787369380
                                         uncertainty =       0.011432518740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353787369380
                                         uncertainty =       0.011432518740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420579849
  error estimate for blocks of size 2^( 2) =       0.000432665352
  error estimate for blocks of size 2^( 3) =       0.000445211224
  error estimate for blocks of size 2^( 4) =       0.000456778937
  error estimate for blocks of size 2^( 5) =       0.000466316455
  error estimate for blocks of size 2^( 6) =       0.000472446585
  error estimate for blocks of size 2^( 7) =       0.000477144377

      target function =                  N/A
              le_mean =     -16.906501935104
             les_mean =     286.183582323000
             stat err =       0.000468171589
             autocorr =       1.239119491311
              std dev =       0.594789726052
             le_variance =       0.353774818217


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906501933624        initial
     1.5259e+01     1.5259e+02             2.0983e-05       -16.906501958659  <--
     6.1035e+01     6.1035e+02             5.2698e-06       -16.906501945692
     2.4414e+02     2.4414e+03             1.3190e-06       -16.906501935104

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 4.9168e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.112635e-01 1 1  ON 0
 uu_1                 1.437872e-01 1 1  ON 1
 uu_2                 4.176458e-02 1 1  ON 2
 uu_3                -2.114559e-02 1 1  ON 3
 uu_4                -6.732882e-02 1 1  ON 4
 uu_5                -1.023902e-01 1 1  ON 5
 uu_6                -1.301127e-01 1 1  ON 6
 uu_7                -1.439756e-01 1 1  ON 7
 uu_8                -1.366922e-01 1 1  ON 8
 uu_9                -1.066664e-01 1 1  ON 9
 ud_0                 4.503699e-01 1 1  ON 10
 ud_1                 1.843898e-01 1 1  ON 11
 ud_2                 6.369489e-02 1 1  ON 12
 ud_3                -7.837995e-03 1 1  ON 13
 ud_4                -6.536579e-02 1 1  ON 14
 ud_5                -1.075203e-01 1 1  ON 15
 ud_6                -1.355798e-01 1 1  ON 16
 ud_7                -1.522152e-01 1 1  ON 17
 ud_8                -1.532783e-01 1 1  ON 18
 ud_9                -1.445479e-01 1 1  ON 19
 eO_0                -7.588516e-01 1 1  ON 20
 eO_1                -4.370169e-01 1 1  ON 21
 eO_2                -2.097139e-02 1 1  ON 22
 eO_3                 2.976596e-01 1 1  ON 23
 eO_4                 5.258477e-01 1 1  ON 24
 eO_5                 4.893050e-01 1 1  ON 25
 eO_6                 2.620523e-01 1 1  ON 26
 eO_7                -4.038947e-02 1 1  ON 27
 eO_8                -2.245527e-01 1 1  ON 28
 eO_9                -9.089305e-02 1 1  ON 29
eH1_0                -2.522431e-01 1 1  ON 30
eH1_1                -1.488876e-01 1 1  ON 31
eH1_2                -1.001431e-01 1 1  ON 32
eH1_3                -4.523065e-02 1 1  ON 33
eH1_4                 3.428314e-03 1 1  ON 34
eH1_5                 3.777841e-02 1 1  ON 35
eH1_6                 9.681835e-02 1 1  ON 36
eH1_7                 1.548417e-01 1 1  ON 37
eH1_8                 1.822459e-01 1 1  ON 38
eH1_9                 7.467471e-02 1 1  ON 39
eH2_0                -2.505773e-01 1 1  ON 40
eH2_1                -1.465001e-01 1 1  ON 41
eH2_2                -9.765900e-02 1 1  ON 42
eH2_3                -4.297685e-02 1 1  ON 43
eH2_4                 6.003394e-03 1 1  ON 44
eH2_5                 4.036824e-02 1 1  ON 45
eH2_6                 9.981126e-02 1 1  ON 46
eH2_7                 1.560575e-01 1 1  ON 47
eH2_8                 1.865626e-01 1 1  ON 48
eH2_9                 6.472479e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2458e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8928
    reference variance = 0.191186
====================================================
  Execution time = 3.4022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3632e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336373274528
                                         uncertainty =       0.004455382650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336373274528
                                         uncertainty =       0.004455382650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410074225
  error estimate for blocks of size 2^( 2) =       0.000423071732
  error estimate for blocks of size 2^( 3) =       0.000435748934
  error estimate for blocks of size 2^( 4) =       0.000447386095
  error estimate for blocks of size 2^( 5) =       0.000458225279
  error estimate for blocks of size 2^( 6) =       0.000465104946
  error estimate for blocks of size 2^( 7) =       0.000472361182

      target function =                  N/A
              le_mean =     -16.906424664262
             les_mean =     286.163516500194
             stat err =       0.000460769376
             autocorr =       1.262531630791
              std dev =       0.579932530538
             le_variance =       0.336321739976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690642466426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906424664262       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906424829299       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906424796329       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906424871250       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906424847404       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906424810371       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906424833428       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906424867309       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906424882260       residual = 8.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 6.767429e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906424664262       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906424706164       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906424697403       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906424716884       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906424710686       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906424700362       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906424705443       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906424712750       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.702579e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906424664262       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906424674779       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906424672554       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906424677476       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906424675912       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906424673257       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906424674475       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906424676229       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 4.271161e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053040 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3405e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.112678e-01 1 1  ON 0
 uu_1                 1.437954e-01 1 1  ON 1
 uu_2                 4.176745e-02 1 1  ON 2
 uu_3                -2.114486e-02 1 1  ON 3
 uu_4                -6.731687e-02 1 1  ON 4
 uu_5                -1.023967e-01 1 1  ON 5
 uu_6                -1.301164e-01 1 1  ON 6
 uu_7                -1.439857e-01 1 1  ON 7
 uu_8                -1.367026e-01 1 1  ON 8
 uu_9                -1.066739e-01 1 1  ON 9
 ud_0                 4.503768e-01 1 1  ON 10
 ud_1                 1.843900e-01 1 1  ON 11
 ud_2                 6.370099e-02 1 1  ON 12
 ud_3                -7.832687e-03 1 1  ON 13
 ud_4                -6.536494e-02 1 1  ON 14
 ud_5                -1.075210e-01 1 1  ON 15
 ud_6                -1.355728e-01 1 1  ON 16
 ud_7                -1.522142e-01 1 1  ON 17
 ud_8                -1.532857e-01 1 1  ON 18
 ud_9                -1.445567e-01 1 1  ON 19
 eO_0                -7.588412e-01 1 1  ON 20
 eO_1                -4.370121e-01 1 1  ON 21
 eO_2                -2.096749e-02 1 1  ON 22
 eO_3                 2.976615e-01 1 1  ON 23
 eO_4                 5.258448e-01 1 1  ON 24
 eO_5                 4.893048e-01 1 1  ON 25
 eO_6                 2.620551e-01 1 1  ON 26
 eO_7                -4.039005e-02 1 1  ON 27
 eO_8                -2.245624e-01 1 1  ON 28
 eO_9                -9.090198e-02 1 1  ON 29
eH1_0                -2.522601e-01 1 1  ON 30
eH1_1                -1.488919e-01 1 1  ON 31
eH1_2                -1.001411e-01 1 1  ON 32
eH1_3                -4.522643e-02 1 1  ON 33
eH1_4                 3.434852e-03 1 1  ON 34
eH1_5                 3.777877e-02 1 1  ON 35
eH1_6                 9.681367e-02 1 1  ON 36
eH1_7                 1.548377e-01 1 1  ON 37
eH1_8                 1.822502e-01 1 1  ON 38
eH1_9                 7.468499e-02 1 1  ON 39
eH2_0                -2.505841e-01 1 1  ON 40
eH2_1                -1.465112e-01 1 1  ON 41
eH2_2                -9.766151e-02 1 1  ON 42
eH2_3                -4.297752e-02 1 1  ON 43
eH2_4                 6.007277e-03 1 1  ON 44
eH2_5                 4.036815e-02 1 1  ON 45
eH2_6                 9.981058e-02 1 1  ON 46
eH2_7                 1.560585e-01 1 1  ON 47
eH2_8                 1.865683e-01 1 1  ON 48
eH2_9                 6.473579e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8987
    reference variance = 0.265545
====================================================
  Execution time = 3.3121e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4176e-01
  Total weights = 2.0000e+06
  Execution time = 3.1158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341824022490
                                         uncertainty =       0.005770578420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341824022490
                                         uncertainty =       0.005770578420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413372687
  error estimate for blocks of size 2^( 2) =       0.000426698018
  error estimate for blocks of size 2^( 3) =       0.000439712520
  error estimate for blocks of size 2^( 4) =       0.000451513318
  error estimate for blocks of size 2^( 5) =       0.000463071656
  error estimate for blocks of size 2^( 6) =       0.000470759030
  error estimate for blocks of size 2^( 7) =       0.000474079299

      target function =                  N/A
              le_mean =     -16.906175310827
             les_mean =     286.160517426323
             stat err =       0.000464855826
             autocorr =       1.264599483462
              std dev =       0.584597260333
             le_variance =       0.341753956789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341831481694
                                         uncertainty =       0.005771515501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341831481694
                                         uncertainty =       0.005771515501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413377202
  error estimate for blocks of size 2^( 2) =       0.000426702103
  error estimate for blocks of size 2^( 3) =       0.000439716230
  error estimate for blocks of size 2^( 4) =       0.000451516885
  error estimate for blocks of size 2^( 5) =       0.000463075777
  error estimate for blocks of size 2^( 6) =       0.000470764787
  error estimate for blocks of size 2^( 7) =       0.000474086166

      target function =                  N/A
              le_mean =     -16.906175467585
             les_mean =     286.160530192381
             stat err =       0.000464860904
             autocorr =       1.264599488396
              std dev =       0.584603645626
             le_variance =       0.341761422479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341827486520
                                         uncertainty =       0.005771048207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341827486520
                                         uncertainty =       0.005771048207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413374784
  error estimate for blocks of size 2^( 2) =       0.000426699926
  error estimate for blocks of size 2^( 3) =       0.000439714262
  error estimate for blocks of size 2^( 4) =       0.000451515018
  error estimate for blocks of size 2^( 5) =       0.000463073651
  error estimate for blocks of size 2^( 6) =       0.000470761896
  error estimate for blocks of size 2^( 7) =       0.000474082754

      target function =                  N/A
              le_mean =     -16.906175396216
             les_mean =     286.160523781187
             stat err =       0.000464858330
             autocorr =       1.264600275976
              std dev =       0.584600226165
             le_variance =       0.341757424432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341824480727
                                         uncertainty =       0.005770638653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341824480727
                                         uncertainty =       0.005770638653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413372964
  error estimate for blocks of size 2^( 2) =       0.000426698271
  error estimate for blocks of size 2^( 3) =       0.000439712752
  error estimate for blocks of size 2^( 4) =       0.000451513544
  error estimate for blocks of size 2^( 5) =       0.000463071919
  error estimate for blocks of size 2^( 6) =       0.000470759404
  error estimate for blocks of size 2^( 7) =       0.000474079747

      target function =                  N/A
              le_mean =     -16.906175321337
             les_mean =     286.160518240391
             stat err =       0.000464856154
             autocorr =       1.264599570345
              std dev =       0.584597652650
             le_variance =       0.341754415483


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906175310827        initial
     3.8147e+00     3.8147e+01             6.7674e-05       -16.906175467585  <--
     1.5259e+01     1.5259e+02             1.7026e-05       -16.906175396216
     6.1035e+01     6.1035e+02             4.2712e-06       -16.906175321337

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.8813e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.112816e-01 1 1  ON 0
 uu_1                 1.438186e-01 1 1  ON 1
 uu_2                 4.177562e-02 1 1  ON 2
 uu_3                -2.114261e-02 1 1  ON 3
 uu_4                -6.728483e-02 1 1  ON 4
 uu_5                -1.024129e-01 1 1  ON 5
 uu_6                -1.301277e-01 1 1  ON 6
 uu_7                -1.440157e-01 1 1  ON 7
 uu_8                -1.367335e-01 1 1  ON 8
 uu_9                -1.066965e-01 1 1  ON 9
 ud_0                 4.503964e-01 1 1  ON 10
 ud_1                 1.843925e-01 1 1  ON 11
 ud_2                 6.371704e-02 1 1  ON 12
 ud_3                -7.814185e-03 1 1  ON 13
 ud_4                -6.536283e-02 1 1  ON 14
 ud_5                -1.075226e-01 1 1  ON 15
 ud_6                -1.355537e-01 1 1  ON 16
 ud_7                -1.522107e-01 1 1  ON 17
 ud_8                -1.533064e-01 1 1  ON 18
 ud_9                -1.445831e-01 1 1  ON 19
 eO_0                -7.588104e-01 1 1  ON 20
 eO_1                -4.369961e-01 1 1  ON 21
 eO_2                -2.095537e-02 1 1  ON 22
 eO_3                 2.976671e-01 1 1  ON 23
 eO_4                 5.258368e-01 1 1  ON 24
 eO_5                 4.893044e-01 1 1  ON 25
 eO_6                 2.620634e-01 1 1  ON 26
 eO_7                -4.039110e-02 1 1  ON 27
 eO_8                -2.245924e-01 1 1  ON 28
 eO_9                -9.093016e-02 1 1  ON 29
eH1_0                -2.523108e-01 1 1  ON 30
eH1_1                -1.489046e-01 1 1  ON 31
eH1_2                -1.001371e-01 1 1  ON 32
eH1_3                -4.521360e-02 1 1  ON 33
eH1_4                 3.451278e-03 1 1  ON 34
eH1_5                 3.777965e-02 1 1  ON 35
eH1_6                 9.680036e-02 1 1  ON 36
eH1_7                 1.548259e-01 1 1  ON 37
eH1_8                 1.822641e-01 1 1  ON 38
eH1_9                 7.471778e-02 1 1  ON 39
eH2_0                -2.506049e-01 1 1  ON 40
eH2_1                -1.465434e-01 1 1  ON 41
eH2_2                -9.767098e-02 1 1  ON 42
eH2_3                -4.297919e-02 1 1  ON 43
eH2_4                 6.016945e-03 1 1  ON 44
eH2_5                 4.036740e-02 1 1  ON 45
eH2_6                 9.980855e-02 1 1  ON 46
eH2_7                 1.560613e-01 1 1  ON 47
eH2_8                 1.865867e-01 1 1  ON 48
eH2_9                 6.477089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2225e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9764
    reference variance = 0.24604
====================================================
  Execution time = 3.4000e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4230e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342153346406
                                         uncertainty =       0.004678471675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342153346406
                                         uncertainty =       0.004678471675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413705078
  error estimate for blocks of size 2^( 2) =       0.000426680046
  error estimate for blocks of size 2^( 3) =       0.000439842646
  error estimate for blocks of size 2^( 4) =       0.000452508105
  error estimate for blocks of size 2^( 5) =       0.000463576995
  error estimate for blocks of size 2^( 6) =       0.000471867697
  error estimate for blocks of size 2^( 7) =       0.000479318191

      target function =                  N/A
              le_mean =     -16.906405460532
             les_mean =     286.168849207338
             stat err =       0.000466817747
             autocorr =       1.273248033232
              std dev =       0.585067331659
             le_variance =       0.342303782574


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690640546053e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906405460532       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906405936751       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906405883486       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906405880430       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906405932028       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906405802120       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906405840786       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906405943024       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906405917370       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.445150e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906405460532       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906405601725       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906405582409       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906405577564       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906405593277       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906405574253       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906405561837       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906405582923       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 6.408662e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906405460532       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906405497551       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906405492255       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906405490697       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906405494582       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906405491353       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906405486702       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906405491525       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.624910e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3309e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.112727e-01 1 1  ON 0
 uu_1                 1.438292e-01 1 1  ON 1
 uu_2                 4.178734e-02 1 1  ON 2
 uu_3                -2.113858e-02 1 1  ON 3
 uu_4                -6.728463e-02 1 1  ON 4
 uu_5                -1.024369e-01 1 1  ON 5
 uu_6                -1.301483e-01 1 1  ON 6
 uu_7                -1.440421e-01 1 1  ON 7
 uu_8                -1.367224e-01 1 1  ON 8
 uu_9                -1.066969e-01 1 1  ON 9
 ud_0                 4.503850e-01 1 1  ON 10
 ud_1                 1.843879e-01 1 1  ON 11
 ud_2                 6.371286e-02 1 1  ON 12
 ud_3                -7.818687e-03 1 1  ON 13
 ud_4                -6.534031e-02 1 1  ON 14
 ud_5                -1.074805e-01 1 1  ON 15
 ud_6                -1.355595e-01 1 1  ON 16
 ud_7                -1.522297e-01 1 1  ON 17
 ud_8                -1.533113e-01 1 1  ON 18
 ud_9                -1.445682e-01 1 1  ON 19
 eO_0                -7.587849e-01 1 1  ON 20
 eO_1                -4.369791e-01 1 1  ON 21
 eO_2                -2.096118e-02 1 1  ON 22
 eO_3                 2.976499e-01 1 1  ON 23
 eO_4                 5.258341e-01 1 1  ON 24
 eO_5                 4.893033e-01 1 1  ON 25
 eO_6                 2.620824e-01 1 1  ON 26
 eO_7                -4.038026e-02 1 1  ON 27
 eO_8                -2.245996e-01 1 1  ON 28
 eO_9                -9.096028e-02 1 1  ON 29
eH1_0                -2.523749e-01 1 1  ON 30
eH1_1                -1.489151e-01 1 1  ON 31
eH1_2                -1.001288e-01 1 1  ON 32
eH1_3                -4.524219e-02 1 1  ON 33
eH1_4                 3.452049e-03 1 1  ON 34
eH1_5                 3.777668e-02 1 1  ON 35
eH1_6                 9.676563e-02 1 1  ON 36
eH1_7                 1.548376e-01 1 1  ON 37
eH1_8                 1.823153e-01 1 1  ON 38
eH1_9                 7.477576e-02 1 1  ON 39
eH2_0                -2.506635e-01 1 1  ON 40
eH2_1                -1.465963e-01 1 1  ON 41
eH2_2                -9.767501e-02 1 1  ON 42
eH2_3                -4.296604e-02 1 1  ON 43
eH2_4                 6.009965e-03 1 1  ON 44
eH2_5                 4.037335e-02 1 1  ON 45
eH2_6                 9.984275e-02 1 1  ON 46
eH2_7                 1.560736e-01 1 1  ON 47
eH2_8                 1.865987e-01 1 1  ON 48
eH2_9                 6.481403e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9049
    reference variance = 0.348044
====================================================
  Execution time = 3.3264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4127e-01
  Total weights = 2.0000e+06
  Execution time = 3.1155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341314693521
                                         uncertainty =       0.004112968807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341314693521
                                         uncertainty =       0.004112968807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413090156
  error estimate for blocks of size 2^( 2) =       0.000425787330
  error estimate for blocks of size 2^( 3) =       0.000438376514
  error estimate for blocks of size 2^( 4) =       0.000449366812
  error estimate for blocks of size 2^( 5) =       0.000459358842
  error estimate for blocks of size 2^( 6) =       0.000465899842
  error estimate for blocks of size 2^( 7) =       0.000470227611

      target function =                  N/A
              le_mean =     -16.906840427250
             les_mean =     286.182540016617
             stat err =       0.000461213277
             autocorr =       1.246562070911
              std dev =       0.584197701787
             le_variance =       0.341286954773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341255409959
                                         uncertainty =       0.004114672097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341255409959
                                         uncertainty =       0.004114672097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413054292
  error estimate for blocks of size 2^( 2) =       0.000425752994
  error estimate for blocks of size 2^( 3) =       0.000438344119
  error estimate for blocks of size 2^( 4) =       0.000449337210
  error estimate for blocks of size 2^( 5) =       0.000459333749
  error estimate for blocks of size 2^( 6) =       0.000465875728
  error estimate for blocks of size 2^( 7) =       0.000470208950

      target function =                  N/A
              le_mean =     -16.906840370312
             les_mean =     286.182478832125
             stat err =       0.000461188909
             autocorr =       1.246646813874
              std dev =       0.584146981089
             le_variance =       0.341227695515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279106060
                                         uncertainty =       0.004113894878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341279106060
                                         uncertainty =       0.004113894878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413068629
  error estimate for blocks of size 2^( 2) =       0.000425766677
  error estimate for blocks of size 2^( 3) =       0.000438356916
  error estimate for blocks of size 2^( 4) =       0.000449348837
  error estimate for blocks of size 2^( 5) =       0.000459343544
  error estimate for blocks of size 2^( 6) =       0.000465885240
  error estimate for blocks of size 2^( 7) =       0.000470216405

      target function =                  N/A
              le_mean =     -16.906840337466
             les_mean =     286.182501410884
             stat err =       0.000461198507
             autocorr =       1.246612156991
              std dev =       0.584167257669
             le_variance =       0.341251384932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341310103373
                                         uncertainty =       0.004113090226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341310103373
                                         uncertainty =       0.004113090226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413087380
  error estimate for blocks of size 2^( 2) =       0.000425784663
  error estimate for blocks of size 2^( 3) =       0.000438373979
  error estimate for blocks of size 2^( 4) =       0.000449364487
  error estimate for blocks of size 2^( 5) =       0.000459356864
  error estimate for blocks of size 2^( 6) =       0.000465897964
  error estimate for blocks of size 2^( 7) =       0.000470226179

      target function =                  N/A
              le_mean =     -16.906840412036
             les_mean =     286.182534914303
             stat err =       0.000461211373
             autocorr =       1.246568540687
              std dev =       0.584193775135
             le_variance =       0.341282366906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906840427250        initial  <--
     9.5367e-01     9.5367e+00             2.4451e-04       -16.906840370312
     3.8147e+00     3.8147e+01             6.4087e-05       -16.906840337466
     1.5259e+01     1.5259e+02             1.6249e-05       -16.906840412036

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.9326
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.112816e-01 1 1  ON 0
 uu_1                 1.438186e-01 1 1  ON 1
 uu_2                 4.177562e-02 1 1  ON 2
 uu_3                -2.114261e-02 1 1  ON 3
 uu_4                -6.728483e-02 1 1  ON 4
 uu_5                -1.024129e-01 1 1  ON 5
 uu_6                -1.301277e-01 1 1  ON 6
 uu_7                -1.440157e-01 1 1  ON 7
 uu_8                -1.367335e-01 1 1  ON 8
 uu_9                -1.066965e-01 1 1  ON 9
 ud_0                 4.503964e-01 1 1  ON 10
 ud_1                 1.843925e-01 1 1  ON 11
 ud_2                 6.371704e-02 1 1  ON 12
 ud_3                -7.814185e-03 1 1  ON 13
 ud_4                -6.536283e-02 1 1  ON 14
 ud_5                -1.075226e-01 1 1  ON 15
 ud_6                -1.355537e-01 1 1  ON 16
 ud_7                -1.522107e-01 1 1  ON 17
 ud_8                -1.533064e-01 1 1  ON 18
 ud_9                -1.445831e-01 1 1  ON 19
 eO_0                -7.588104e-01 1 1  ON 20
 eO_1                -4.369961e-01 1 1  ON 21
 eO_2                -2.095537e-02 1 1  ON 22
 eO_3                 2.976671e-01 1 1  ON 23
 eO_4                 5.258368e-01 1 1  ON 24
 eO_5                 4.893044e-01 1 1  ON 25
 eO_6                 2.620634e-01 1 1  ON 26
 eO_7                -4.039110e-02 1 1  ON 27
 eO_8                -2.245924e-01 1 1  ON 28
 eO_9                -9.093016e-02 1 1  ON 29
eH1_0                -2.523108e-01 1 1  ON 30
eH1_1                -1.489046e-01 1 1  ON 31
eH1_2                -1.001371e-01 1 1  ON 32
eH1_3                -4.521360e-02 1 1  ON 33
eH1_4                 3.451278e-03 1 1  ON 34
eH1_5                 3.777965e-02 1 1  ON 35
eH1_6                 9.680036e-02 1 1  ON 36
eH1_7                 1.548259e-01 1 1  ON 37
eH1_8                 1.822641e-01 1 1  ON 38
eH1_9                 7.471778e-02 1 1  ON 39
eH2_0                -2.506049e-01 1 1  ON 40
eH2_1                -1.465434e-01 1 1  ON 41
eH2_2                -9.767098e-02 1 1  ON 42
eH2_3                -4.297919e-02 1 1  ON 43
eH2_4                 6.016945e-03 1 1  ON 44
eH2_5                 4.036740e-02 1 1  ON 45
eH2_6                 9.980855e-02 1 1  ON 46
eH2_7                 1.560613e-01 1 1  ON 47
eH2_8                 1.865867e-01 1 1  ON 48
eH2_9                 6.477089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.906
    reference variance = 0.337386
====================================================
  Execution time = 3.4390e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4983e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349917149112
                                         uncertainty =       0.011111673025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349917149112
                                         uncertainty =       0.011111673025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418229031
  error estimate for blocks of size 2^( 2) =       0.000430817983
  error estimate for blocks of size 2^( 3) =       0.000443866375
  error estimate for blocks of size 2^( 4) =       0.000456869228
  error estimate for blocks of size 2^( 5) =       0.000466266661
  error estimate for blocks of size 2^( 6) =       0.000474652631
  error estimate for blocks of size 2^( 7) =       0.000478584544

      target function =                  N/A
              le_mean =     -16.906496052528
             les_mean =     286.179439644378
             stat err =       0.000469093266
             autocorr =       1.258027241160
              std dev =       0.591465168164
             le_variance =       0.349831045151


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649605253e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906496052528       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906496124801       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906496112784       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906496159372       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906496146536       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906496145526       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906496157548       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906496159919       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.433407e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906496052528       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906496070840       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906496067945       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906496079705       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906496076367       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906496076269       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906496079150       residual = 9.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 6.020730e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906496052528       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906496057121       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906496056405       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906496059352       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906496058509       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906496058495       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906496059207       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.508271e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058280 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3599e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.112794e-01 1 1  ON 0
 uu_1                 1.438167e-01 1 1  ON 1
 uu_2                 4.177613e-02 1 1  ON 2
 uu_3                -2.114223e-02 1 1  ON 3
 uu_4                -6.728625e-02 1 1  ON 4
 uu_5                -1.024153e-01 1 1  ON 5
 uu_6                -1.301270e-01 1 1  ON 6
 uu_7                -1.440163e-01 1 1  ON 7
 uu_8                -1.367339e-01 1 1  ON 8
 uu_9                -1.066958e-01 1 1  ON 9
 ud_0                 4.503950e-01 1 1  ON 10
 ud_1                 1.843921e-01 1 1  ON 11
 ud_2                 6.371697e-02 1 1  ON 12
 ud_3                -7.812369e-03 1 1  ON 13
 ud_4                -6.536326e-02 1 1  ON 14
 ud_5                -1.075211e-01 1 1  ON 15
 ud_6                -1.355534e-01 1 1  ON 16
 ud_7                -1.522126e-01 1 1  ON 17
 ud_8                -1.533054e-01 1 1  ON 18
 ud_9                -1.445827e-01 1 1  ON 19
 eO_0                -7.588095e-01 1 1  ON 20
 eO_1                -4.369929e-01 1 1  ON 21
 eO_2                -2.095784e-02 1 1  ON 22
 eO_3                 2.976666e-01 1 1  ON 23
 eO_4                 5.258346e-01 1 1  ON 24
 eO_5                 4.893073e-01 1 1  ON 25
 eO_6                 2.620657e-01 1 1  ON 26
 eO_7                -4.039069e-02 1 1  ON 27
 eO_8                -2.245930e-01 1 1  ON 28
 eO_9                -9.093336e-02 1 1  ON 29
eH1_0                -2.523154e-01 1 1  ON 30
eH1_1                -1.489082e-01 1 1  ON 31
eH1_2                -1.001379e-01 1 1  ON 32
eH1_3                -4.521639e-02 1 1  ON 33
eH1_4                 3.451341e-03 1 1  ON 34
eH1_5                 3.778083e-02 1 1  ON 35
eH1_6                 9.680125e-02 1 1  ON 36
eH1_7                 1.548257e-01 1 1  ON 37
eH1_8                 1.822678e-01 1 1  ON 38
eH1_9                 7.472290e-02 1 1  ON 39
eH2_0                -2.506109e-01 1 1  ON 40
eH2_1                -1.465413e-01 1 1  ON 41
eH2_2                -9.767371e-02 1 1  ON 42
eH2_3                -4.298045e-02 1 1  ON 43
eH2_4                 6.015443e-03 1 1  ON 44
eH2_5                 4.036610e-02 1 1  ON 45
eH2_6                 9.980748e-02 1 1  ON 46
eH2_7                 1.560633e-01 1 1  ON 47
eH2_8                 1.865900e-01 1 1  ON 48
eH2_9                 6.477651e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8097
    reference variance = 0.21645
====================================================
  Execution time = 3.3135e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4365e-01
  Total weights = 2.0000e+06
  Execution time = 3.1293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343536567980
                                         uncertainty =       0.004014524325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343536567980
                                         uncertainty =       0.004014524325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414518544
  error estimate for blocks of size 2^( 2) =       0.000427181202
  error estimate for blocks of size 2^( 3) =       0.000440260659
  error estimate for blocks of size 2^( 4) =       0.000452793942
  error estimate for blocks of size 2^( 5) =       0.000463619328
  error estimate for blocks of size 2^( 6) =       0.000471743567
  error estimate for blocks of size 2^( 7) =       0.000476292354

      target function =                  N/A
              le_mean =     -16.905562987733
             les_mean =     286.141711007632
             stat err =       0.000466112298
             autocorr =       1.264425348589
              std dev =       0.586217747289
             le_variance =       0.343651247236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343526752018
                                         uncertainty =       0.004014444151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343526752018
                                         uncertainty =       0.004014444151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414512634
  error estimate for blocks of size 2^( 2) =       0.000427175603
  error estimate for blocks of size 2^( 3) =       0.000440255397
  error estimate for blocks of size 2^( 4) =       0.000452789012
  error estimate for blocks of size 2^( 5) =       0.000463614581
  error estimate for blocks of size 2^( 6) =       0.000471738757
  error estimate for blocks of size 2^( 7) =       0.000476287612

      target function =                  N/A
              le_mean =     -16.905563029232
             les_mean =     286.141702610712
             stat err =       0.000466107491
             autocorr =       1.264435327494
              std dev =       0.586209388515
             le_variance =       0.343641447184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343531820776
                                         uncertainty =       0.004014489236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343531820776
                                         uncertainty =       0.004014489236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414515687
  error estimate for blocks of size 2^( 2) =       0.000427178489
  error estimate for blocks of size 2^( 3) =       0.000440258101
  error estimate for blocks of size 2^( 4) =       0.000452791557
  error estimate for blocks of size 2^( 5) =       0.000463617030
  error estimate for blocks of size 2^( 6) =       0.000471741227
  error estimate for blocks of size 2^( 7) =       0.000476290041

      target function =                  N/A
              le_mean =     -16.905563006706
             les_mean =     286.141706911244
             stat err =       0.000466109964
             autocorr =       1.264430119010
              std dev =       0.586213706211
             le_variance =       0.343646509349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343535972277
                                         uncertainty =       0.004014519929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343535972277
                                         uncertainty =       0.004014519929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414518186
  error estimate for blocks of size 2^( 2) =       0.000427180862
  error estimate for blocks of size 2^( 3) =       0.000440260338
  error estimate for blocks of size 2^( 4) =       0.000452793642
  error estimate for blocks of size 2^( 5) =       0.000463619040
  error estimate for blocks of size 2^( 6) =       0.000471743274
  error estimate for blocks of size 2^( 7) =       0.000476292064

      target function =                  N/A
              le_mean =     -16.905562990110
             les_mean =     286.141710493461
             stat err =       0.000466112005
             autocorr =       1.264425947323
              std dev =       0.586217240199
             le_variance =       0.343650652707


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905562987733        initial
     9.5367e+00     9.5367e+01             2.4334e-05       -16.905563029232  <--
     3.8147e+01     3.8147e+02             6.0207e-06       -16.905563006706
     1.5259e+02     1.5259e+03             1.5083e-06       -16.905562990110

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 4.8887e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.112729e-01 1 1  ON 0
 uu_1                 1.438112e-01 1 1  ON 1
 uu_2                 4.177711e-02 1 1  ON 2
 uu_3                -2.114074e-02 1 1  ON 3
 uu_4                -6.729057e-02 1 1  ON 4
 uu_5                -1.024221e-01 1 1  ON 5
 uu_6                -1.301254e-01 1 1  ON 6
 uu_7                -1.440186e-01 1 1  ON 7
 uu_8                -1.367352e-01 1 1  ON 8
 uu_9                -1.066937e-01 1 1  ON 9
 ud_0                 4.503910e-01 1 1  ON 10
 ud_1                 1.843908e-01 1 1  ON 11
 ud_2                 6.371748e-02 1 1  ON 12
 ud_3                -7.807865e-03 1 1  ON 13
 ud_4                -6.536399e-02 1 1  ON 14
 ud_5                -1.075167e-01 1 1  ON 15
 ud_6                -1.355526e-01 1 1  ON 16
 ud_7                -1.522181e-01 1 1  ON 17
 ud_8                -1.533028e-01 1 1  ON 18
 ud_9                -1.445820e-01 1 1  ON 19
 eO_0                -7.588060e-01 1 1  ON 20
 eO_1                -4.369845e-01 1 1  ON 21
 eO_2                -2.096417e-02 1 1  ON 22
 eO_3                 2.976653e-01 1 1  ON 23
 eO_4                 5.258280e-01 1 1  ON 24
 eO_5                 4.893160e-01 1 1  ON 25
 eO_6                 2.620728e-01 1 1  ON 26
 eO_7                -4.038941e-02 1 1  ON 27
 eO_8                -2.245953e-01 1 1  ON 28
 eO_9                -9.094360e-02 1 1  ON 29
eH1_0                -2.523293e-01 1 1  ON 30
eH1_1                -1.489189e-01 1 1  ON 31
eH1_2                -1.001403e-01 1 1  ON 32
eH1_3                -4.522429e-02 1 1  ON 33
eH1_4                 3.450650e-03 1 1  ON 34
eH1_5                 3.778347e-02 1 1  ON 35
eH1_6                 9.680365e-02 1 1  ON 36
eH1_7                 1.548248e-01 1 1  ON 37
eH1_8                 1.822796e-01 1 1  ON 38
eH1_9                 7.473916e-02 1 1  ON 39
eH2_0                -2.506292e-01 1 1  ON 40
eH2_1                -1.465358e-01 1 1  ON 41
eH2_2                -9.768110e-02 1 1  ON 42
eH2_3                -4.298565e-02 1 1  ON 43
eH2_4                 6.010180e-03 1 1  ON 44
eH2_5                 4.036277e-02 1 1  ON 45
eH2_6                 9.980440e-02 1 1  ON 46
eH2_7                 1.560695e-01 1 1  ON 47
eH2_8                 1.866003e-01 1 1  ON 48
eH2_9                 6.479438e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2493e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9742
    reference variance = 0.293716
====================================================
  Execution time = 3.3905e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4773e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347773476656
                                         uncertainty =       0.007928962913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347773476656
                                         uncertainty =       0.007928962913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416971078
  error estimate for blocks of size 2^( 2) =       0.000429437354
  error estimate for blocks of size 2^( 3) =       0.000442435791
  error estimate for blocks of size 2^( 4) =       0.000454582878
  error estimate for blocks of size 2^( 5) =       0.000463918222
  error estimate for blocks of size 2^( 6) =       0.000471493201
  error estimate for blocks of size 2^( 7) =       0.000478048415

      target function =                  N/A
              le_mean =     -16.906213211359
             les_mean =     286.167774733031
             stat err =       0.000467010679
             autocorr =       1.254416502435
              std dev =       0.589686152943
             le_variance =       0.347729758973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621321136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213211359       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213394108       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906213649168       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906213954509       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906214053737       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906214150952       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906214030264       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906214006371       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 8.054301e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213211359       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213258953       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906213328497       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906213408644       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906213442182       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906213466236       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906213432915       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906213426816       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.030353e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213211359       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213223383       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906213241176       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906213261467       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906213270507       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906213276515       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906213267995       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906213266473       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.086159e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3131e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.112673e-01 1 1  ON 0
 uu_1                 1.438159e-01 1 1  ON 1
 uu_2                 4.178223e-02 1 1  ON 2
 uu_3                -2.114483e-02 1 1  ON 3
 uu_4                -6.727522e-02 1 1  ON 4
 uu_5                -1.024086e-01 1 1  ON 5
 uu_6                -1.301331e-01 1 1  ON 6
 uu_7                -1.440266e-01 1 1  ON 7
 uu_8                -1.367518e-01 1 1  ON 8
 uu_9                -1.067067e-01 1 1  ON 9
 ud_0                 4.503838e-01 1 1  ON 10
 ud_1                 1.844028e-01 1 1  ON 11
 ud_2                 6.372097e-02 1 1  ON 12
 ud_3                -7.799530e-03 1 1  ON 13
 ud_4                -6.536451e-02 1 1  ON 14
 ud_5                -1.075243e-01 1 1  ON 15
 ud_6                -1.355410e-01 1 1  ON 16
 ud_7                -1.522222e-01 1 1  ON 17
 ud_8                -1.533110e-01 1 1  ON 18
 ud_9                -1.445821e-01 1 1  ON 19
 eO_0                -7.587968e-01 1 1  ON 20
 eO_1                -4.369702e-01 1 1  ON 21
 eO_2                -2.096232e-02 1 1  ON 22
 eO_3                 2.976669e-01 1 1  ON 23
 eO_4                 5.258148e-01 1 1  ON 24
 eO_5                 4.893180e-01 1 1  ON 25
 eO_6                 2.620836e-01 1 1  ON 26
 eO_7                -4.038834e-02 1 1  ON 27
 eO_8                -2.246094e-01 1 1  ON 28
 eO_9                -9.095537e-02 1 1  ON 29
eH1_0                -2.523496e-01 1 1  ON 30
eH1_1                -1.489302e-01 1 1  ON 31
eH1_2                -1.001565e-01 1 1  ON 32
eH1_3                -4.522333e-02 1 1  ON 33
eH1_4                 3.457698e-03 1 1  ON 34
eH1_5                 3.778440e-02 1 1  ON 35
eH1_6                 9.680934e-02 1 1  ON 36
eH1_7                 1.548329e-01 1 1  ON 37
eH1_8                 1.822868e-01 1 1  ON 38
eH1_9                 7.475389e-02 1 1  ON 39
eH2_0                -2.506330e-01 1 1  ON 40
eH2_1                -1.465272e-01 1 1  ON 41
eH2_2                -9.769103e-02 1 1  ON 42
eH2_3                -4.298664e-02 1 1  ON 43
eH2_4                 6.009088e-03 1 1  ON 44
eH2_5                 4.035060e-02 1 1  ON 45
eH2_6                 9.979444e-02 1 1  ON 46
eH2_7                 1.560703e-01 1 1  ON 47
eH2_8                 1.866089e-01 1 1  ON 48
eH2_9                 6.481326e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8551
    reference variance = 0.236813
====================================================
  Execution time = 3.3183e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4254e-01
  Total weights = 2.0000e+06
  Execution time = 3.1199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342591001792
                                         uncertainty =       0.004737905322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342591001792
                                         uncertainty =       0.004737905322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413857507
  error estimate for blocks of size 2^( 2) =       0.000426358481
  error estimate for blocks of size 2^( 3) =       0.000439391833
  error estimate for blocks of size 2^( 4) =       0.000451360452
  error estimate for blocks of size 2^( 5) =       0.000462156120
  error estimate for blocks of size 2^( 6) =       0.000469669933
  error estimate for blocks of size 2^( 7) =       0.000476608924

      target function =                  N/A
              le_mean =     -16.907182266755
             les_mean =     286.195368101653
             stat err =       0.000464948857
             autocorr =       1.262143385504
              std dev =       0.585282898816
             le_variance =       0.342556071646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342551375325
                                         uncertainty =       0.004737263372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342551375325
                                         uncertainty =       0.004737263372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413833562
  error estimate for blocks of size 2^( 2) =       0.000426334832
  error estimate for blocks of size 2^( 3) =       0.000439368097
  error estimate for blocks of size 2^( 4) =       0.000451335925
  error estimate for blocks of size 2^( 5) =       0.000462133248
  error estimate for blocks of size 2^( 6) =       0.000469647636
  error estimate for blocks of size 2^( 7) =       0.000476588186

      target function =                  N/A
              le_mean =     -16.907182497209
             les_mean =     286.195336256163
             stat err =       0.000464926249
             autocorr =       1.262166690800
              std dev =       0.585249035433
             le_variance =       0.342516433475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342567943749
                                         uncertainty =       0.004737546413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342567943749
                                         uncertainty =       0.004737546413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413843573
  error estimate for blocks of size 2^( 2) =       0.000426344751
  error estimate for blocks of size 2^( 3) =       0.000439378104
  error estimate for blocks of size 2^( 4) =       0.000451346324
  error estimate for blocks of size 2^( 5) =       0.000462142939
  error estimate for blocks of size 2^( 6) =       0.000469657109
  error estimate for blocks of size 2^( 7) =       0.000476596942

      target function =                  N/A
              le_mean =     -16.907182388345
             les_mean =     286.195349147294
             stat err =       0.000464935829
             autocorr =       1.262157638593
              std dev =       0.585263193619
             le_variance =       0.342533005805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342587995342
                                         uncertainty =       0.004737859118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342587995342
                                         uncertainty =       0.004737859118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413855690
  error estimate for blocks of size 2^( 2) =       0.000426356692
  error estimate for blocks of size 2^( 3) =       0.000439390046
  error estimate for blocks of size 2^( 4) =       0.000451358615
  error estimate for blocks of size 2^( 5) =       0.000462154405
  error estimate for blocks of size 2^( 6) =       0.000469668266
  error estimate for blocks of size 2^( 7) =       0.000476607365

      target function =                  N/A
              le_mean =     -16.907182281637
             les_mean =     286.195365597388
             stat err =       0.000464947163
             autocorr =       1.262145264902
              std dev =       0.585280329542
             le_variance =       0.342553064149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907182266755        initial
     2.3842e+00     2.3842e+01             8.0543e-05       -16.907182497209  <--
     9.5367e+00     9.5367e+01             2.0304e-05       -16.907182388345
     3.8147e+01     3.8147e+02             5.0862e-06       -16.907182281637

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 4.8917e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.112533e-01 1 1  ON 0
 uu_1                 1.438298e-01 1 1  ON 1
 uu_2                 4.179597e-02 1 1  ON 2
 uu_3                -2.115220e-02 1 1  ON 3
 uu_4                -6.723484e-02 1 1  ON 4
 uu_5                -1.023697e-01 1 1  ON 5
 uu_6                -1.301540e-01 1 1  ON 6
 uu_7                -1.440507e-01 1 1  ON 7
 uu_8                -1.368013e-01 1 1  ON 8
 uu_9                -1.067457e-01 1 1  ON 9
 ud_0                 4.503693e-01 1 1  ON 10
 ud_1                 1.844330e-01 1 1  ON 11
 ud_2                 6.373254e-02 1 1  ON 12
 ud_3                -7.778103e-03 1 1  ON 13
 ud_4                -6.536413e-02 1 1  ON 14
 ud_5                -1.075450e-01 1 1  ON 15
 ud_6                -1.355104e-01 1 1  ON 16
 ud_7                -1.522335e-01 1 1  ON 17
 ud_8                -1.533354e-01 1 1  ON 18
 ud_9                -1.445828e-01 1 1  ON 19
 eO_0                -7.587667e-01 1 1  ON 20
 eO_1                -4.369297e-01 1 1  ON 21
 eO_2                -2.095628e-02 1 1  ON 22
 eO_3                 2.976702e-01 1 1  ON 23
 eO_4                 5.257761e-01 1 1  ON 24
 eO_5                 4.893235e-01 1 1  ON 25
 eO_6                 2.621155e-01 1 1  ON 26
 eO_7                -4.038519e-02 1 1  ON 27
 eO_8                -2.246512e-01 1 1  ON 28
 eO_9                -9.099026e-02 1 1  ON 29
eH1_0                -2.524099e-01 1 1  ON 30
eH1_1                -1.489641e-01 1 1  ON 31
eH1_2                -1.002019e-01 1 1  ON 32
eH1_3                -4.522206e-02 1 1  ON 33
eH1_4                 3.477960e-03 1 1  ON 34
eH1_5                 3.778768e-02 1 1  ON 35
eH1_6                 9.682626e-02 1 1  ON 36
eH1_7                 1.548571e-01 1 1  ON 37
eH1_8                 1.823080e-01 1 1  ON 38
eH1_9                 7.479734e-02 1 1  ON 39
eH2_0                -2.506432e-01 1 1  ON 40
eH2_1                -1.465044e-01 1 1  ON 41
eH2_2                -9.771770e-02 1 1  ON 42
eH2_3                -4.299026e-02 1 1  ON 43
eH2_4                 6.005901e-03 1 1  ON 44
eH2_5                 4.031496e-02 1 1  ON 45
eH2_6                 9.976455e-02 1 1  ON 46
eH2_7                 1.560725e-01 1 1  ON 47
eH2_8                 1.866342e-01 1 1  ON 48
eH2_9                 6.486907e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2055e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8355
    reference variance = 0.299997
====================================================
  Execution time = 3.3560e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3951e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339553249025
                                         uncertainty =       0.003326698464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339553249025
                                         uncertainty =       0.003326698464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412011231
  error estimate for blocks of size 2^( 2) =       0.000424691634
  error estimate for blocks of size 2^( 3) =       0.000437547375
  error estimate for blocks of size 2^( 4) =       0.000449525363
  error estimate for blocks of size 2^( 5) =       0.000459837403
  error estimate for blocks of size 2^( 6) =       0.000466157972
  error estimate for blocks of size 2^( 7) =       0.000471232187

      target function =                  N/A
              le_mean =     -16.906899596074
             les_mean =     286.182760290849
             stat err =       0.000461688231
             autocorr =       1.255681509731
              std dev =       0.582671870689
             le_variance =       0.339506508892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690689959607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906899596074       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906898748392       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906899339690       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906899144043       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906900120226       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906900410211       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906900223002       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906900193082       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906900248811       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.872917e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906899596074       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906899349694       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906899438978       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906899419398       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906899654076       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906899767991       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906899731024       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906899736663       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.055052e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906899596074       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906899531869       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906899547907       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906899547705       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906899608791       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906899636783       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906899627174       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906899630370       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.698855e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063855 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2777e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.112736e-01 1 1  ON 0
 uu_1                 1.438736e-01 1 1  ON 1
 uu_2                 4.183729e-02 1 1  ON 2
 uu_3                -2.110812e-02 1 1  ON 3
 uu_4                -6.723958e-02 1 1  ON 4
 uu_5                -1.023637e-01 1 1  ON 5
 uu_6                -1.301635e-01 1 1  ON 6
 uu_7                -1.440977e-01 1 1  ON 7
 uu_8                -1.368615e-01 1 1  ON 8
 uu_9                -1.068199e-01 1 1  ON 9
 ud_0                 4.503854e-01 1 1  ON 10
 ud_1                 1.844491e-01 1 1  ON 11
 ud_2                 6.374300e-02 1 1  ON 12
 ud_3                -7.757896e-03 1 1  ON 13
 ud_4                -6.532456e-02 1 1  ON 14
 ud_5                -1.074915e-01 1 1  ON 15
 ud_6                -1.355047e-01 1 1  ON 16
 ud_7                -1.522152e-01 1 1  ON 17
 ud_8                -1.533933e-01 1 1  ON 18
 ud_9                -1.446434e-01 1 1  ON 19
 eO_0                -7.587001e-01 1 1  ON 20
 eO_1                -4.369375e-01 1 1  ON 21
 eO_2                -2.095810e-02 1 1  ON 22
 eO_3                 2.976726e-01 1 1  ON 23
 eO_4                 5.257970e-01 1 1  ON 24
 eO_5                 4.893398e-01 1 1  ON 25
 eO_6                 2.621628e-01 1 1  ON 26
 eO_7                -4.037216e-02 1 1  ON 27
 eO_8                -2.247252e-01 1 1  ON 28
 eO_9                -9.105915e-02 1 1  ON 29
eH1_0                -2.525154e-01 1 1  ON 30
eH1_1                -1.489553e-01 1 1  ON 31
eH1_2                -1.002013e-01 1 1  ON 32
eH1_3                -4.529025e-02 1 1  ON 33
eH1_4                 3.508531e-03 1 1  ON 34
eH1_5                 3.779371e-02 1 1  ON 35
eH1_6                 9.684929e-02 1 1  ON 36
eH1_7                 1.548633e-01 1 1  ON 37
eH1_8                 1.823483e-01 1 1  ON 38
eH1_9                 7.486276e-02 1 1  ON 39
eH2_0                -2.506827e-01 1 1  ON 40
eH2_1                -1.465366e-01 1 1  ON 41
eH2_2                -9.777042e-02 1 1  ON 42
eH2_3                -4.295452e-02 1 1  ON 43
eH2_4                 5.977168e-03 1 1  ON 44
eH2_5                 4.027171e-02 1 1  ON 45
eH2_6                 9.974985e-02 1 1  ON 46
eH2_7                 1.561303e-01 1 1  ON 47
eH2_8                 1.866976e-01 1 1  ON 48
eH2_9                 6.493653e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9295
    reference variance = 0.195513
====================================================
  Execution time = 3.3014e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4319e-01
  Total weights = 2.0000e+06
  Execution time = 3.1065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343267346903
                                         uncertainty =       0.008630500034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343267346903
                                         uncertainty =       0.008630500034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414246067
  error estimate for blocks of size 2^( 2) =       0.000427036338
  error estimate for blocks of size 2^( 3) =       0.000439669448
  error estimate for blocks of size 2^( 4) =       0.000451613995
  error estimate for blocks of size 2^( 5) =       0.000462690954
  error estimate for blocks of size 2^( 6) =       0.000471038398
  error estimate for blocks of size 2^( 7) =       0.000473256463

      target function =                  N/A
              le_mean =     -16.906079110772
             les_mean =     286.158710335472
             stat err =       0.000464649953
             autocorr =       1.258157491237
              std dev =       0.585832405544
             le_variance =       0.343199607385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343239531313
                                         uncertainty =       0.008633548147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343239531313
                                         uncertainty =       0.008633548147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414229262
  error estimate for blocks of size 2^( 2) =       0.000427018767
  error estimate for blocks of size 2^( 3) =       0.000439652008
  error estimate for blocks of size 2^( 4) =       0.000451595852
  error estimate for blocks of size 2^( 5) =       0.000462676060
  error estimate for blocks of size 2^( 6) =       0.000471022716
  error estimate for blocks of size 2^( 7) =       0.000473237450

      target function =                  N/A
              le_mean =     -16.906078906224
             les_mean =     286.158675574714
             stat err =       0.000464633019
             autocorr =       1.258167868606
              std dev =       0.585808640106
             le_variance =       0.343171762823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343252882658
                                         uncertainty =       0.008632468808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343252882658
                                         uncertainty =       0.008632468808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414237322
  error estimate for blocks of size 2^( 2) =       0.000427027093
  error estimate for blocks of size 2^( 3) =       0.000439660383
  error estimate for blocks of size 2^( 4) =       0.000451604539
  error estimate for blocks of size 2^( 5) =       0.000462683562
  error estimate for blocks of size 2^( 6) =       0.000471030380
  error estimate for blocks of size 2^( 7) =       0.000473246542

      target function =                  N/A
              le_mean =     -16.906078997516
             les_mean =     286.158692017156
             stat err =       0.000464641256
             autocorr =       1.258163509709
              std dev =       0.585820039330
             le_variance =       0.343185118481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343265825725
                                         uncertainty =       0.008630784420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343265825725
                                         uncertainty =       0.008630784420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414245146
  error estimate for blocks of size 2^( 2) =       0.000427035335
  error estimate for blocks of size 2^( 3) =       0.000439668463
  error estimate for blocks of size 2^( 4) =       0.000451612948
  error estimate for blocks of size 2^( 5) =       0.000462690179
  error estimate for blocks of size 2^( 6) =       0.000471037527
  error estimate for blocks of size 2^( 7) =       0.000473255340

      target function =                  N/A
              le_mean =     -16.906079085640
             les_mean =     286.158707960901
             stat err =       0.000464648998
             autocorr =       1.258157913263
              std dev =       0.585831104149
             le_variance =       0.343198082589


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906079110772        initial  <--
     5.9605e-01     5.9605e+00             3.8729e-04       -16.906078906224
     2.3842e+00     2.3842e+01             1.0551e-04       -16.906078997516
     9.5367e+00     9.5367e+01             2.6989e-05       -16.906079085640

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.6721
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.112533e-01 1 1  ON 0
 uu_1                 1.438298e-01 1 1  ON 1
 uu_2                 4.179597e-02 1 1  ON 2
 uu_3                -2.115220e-02 1 1  ON 3
 uu_4                -6.723484e-02 1 1  ON 4
 uu_5                -1.023697e-01 1 1  ON 5
 uu_6                -1.301540e-01 1 1  ON 6
 uu_7                -1.440507e-01 1 1  ON 7
 uu_8                -1.368013e-01 1 1  ON 8
 uu_9                -1.067457e-01 1 1  ON 9
 ud_0                 4.503693e-01 1 1  ON 10
 ud_1                 1.844330e-01 1 1  ON 11
 ud_2                 6.373254e-02 1 1  ON 12
 ud_3                -7.778103e-03 1 1  ON 13
 ud_4                -6.536413e-02 1 1  ON 14
 ud_5                -1.075450e-01 1 1  ON 15
 ud_6                -1.355104e-01 1 1  ON 16
 ud_7                -1.522335e-01 1 1  ON 17
 ud_8                -1.533354e-01 1 1  ON 18
 ud_9                -1.445828e-01 1 1  ON 19
 eO_0                -7.587667e-01 1 1  ON 20
 eO_1                -4.369297e-01 1 1  ON 21
 eO_2                -2.095628e-02 1 1  ON 22
 eO_3                 2.976702e-01 1 1  ON 23
 eO_4                 5.257761e-01 1 1  ON 24
 eO_5                 4.893235e-01 1 1  ON 25
 eO_6                 2.621155e-01 1 1  ON 26
 eO_7                -4.038519e-02 1 1  ON 27
 eO_8                -2.246512e-01 1 1  ON 28
 eO_9                -9.099026e-02 1 1  ON 29
eH1_0                -2.524099e-01 1 1  ON 30
eH1_1                -1.489641e-01 1 1  ON 31
eH1_2                -1.002019e-01 1 1  ON 32
eH1_3                -4.522206e-02 1 1  ON 33
eH1_4                 3.477960e-03 1 1  ON 34
eH1_5                 3.778768e-02 1 1  ON 35
eH1_6                 9.682626e-02 1 1  ON 36
eH1_7                 1.548571e-01 1 1  ON 37
eH1_8                 1.823080e-01 1 1  ON 38
eH1_9                 7.479734e-02 1 1  ON 39
eH2_0                -2.506432e-01 1 1  ON 40
eH2_1                -1.465044e-01 1 1  ON 41
eH2_2                -9.771770e-02 1 1  ON 42
eH2_3                -4.299026e-02 1 1  ON 43
eH2_4                 6.005901e-03 1 1  ON 44
eH2_5                 4.031496e-02 1 1  ON 45
eH2_6                 9.976455e-02 1 1  ON 46
eH2_7                 1.560725e-01 1 1  ON 47
eH2_8                 1.866342e-01 1 1  ON 48
eH2_9                 6.486907e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1456e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9045
    reference variance = 0.539277
====================================================
  Execution time = 3.5743e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3599e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336043073456
                                         uncertainty =       0.002662283454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336043073456
                                         uncertainty =       0.002662283454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409872202
  error estimate for blocks of size 2^( 2) =       0.000422140264
  error estimate for blocks of size 2^( 3) =       0.000435334136
  error estimate for blocks of size 2^( 4) =       0.000447315706
  error estimate for blocks of size 2^( 5) =       0.000457428252
  error estimate for blocks of size 2^( 6) =       0.000465332082
  error estimate for blocks of size 2^( 7) =       0.000469024407

      target function =                  N/A
              le_mean =     -16.907342909966
             les_mean =     286.194234551508
             stat err =       0.000459775111
             autocorr =       1.258328364418
              std dev =       0.579646827223
             le_variance =       0.335990444310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690734290997e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907342909966       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907343077583       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907343147512       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907343153196       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907343089490       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907343076939       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907343071589       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907343078782       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.304918e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907342909966       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907342953059       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907342971017       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907342972833       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907342957993       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907342954416       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907342952775       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907342954357       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.086672e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907342909966       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907342920817       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907342925337       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907342925818       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907342922184       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907342921263       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907342920833       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907342921215       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.723341e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066537 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4846e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.112492e-01 1 1  ON 0
 uu_1                 1.438296e-01 1 1  ON 1
 uu_2                 4.180053e-02 1 1  ON 2
 uu_3                -2.115265e-02 1 1  ON 3
 uu_4                -6.722961e-02 1 1  ON 4
 uu_5                -1.023670e-01 1 1  ON 5
 uu_6                -1.301540e-01 1 1  ON 6
 uu_7                -1.440530e-01 1 1  ON 7
 uu_8                -1.368061e-01 1 1  ON 8
 uu_9                -1.067514e-01 1 1  ON 9
 ud_0                 4.503747e-01 1 1  ON 10
 ud_1                 1.844333e-01 1 1  ON 11
 ud_2                 6.373698e-02 1 1  ON 12
 ud_3                -7.776784e-03 1 1  ON 13
 ud_4                -6.536140e-02 1 1  ON 14
 ud_5                -1.075421e-01 1 1  ON 15
 ud_6                -1.355093e-01 1 1  ON 16
 ud_7                -1.522325e-01 1 1  ON 17
 ud_8                -1.533394e-01 1 1  ON 18
 ud_9                -1.445901e-01 1 1  ON 19
 eO_0                -7.587590e-01 1 1  ON 20
 eO_1                -4.369260e-01 1 1  ON 21
 eO_2                -2.095696e-02 1 1  ON 22
 eO_3                 2.976648e-01 1 1  ON 23
 eO_4                 5.257761e-01 1 1  ON 24
 eO_5                 4.893282e-01 1 1  ON 25
 eO_6                 2.621194e-01 1 1  ON 26
 eO_7                -4.038438e-02 1 1  ON 27
 eO_8                -2.246575e-01 1 1  ON 28
 eO_9                -9.099740e-02 1 1  ON 29
eH1_0                -2.524207e-01 1 1  ON 30
eH1_1                -1.489645e-01 1 1  ON 31
eH1_2                -1.002032e-01 1 1  ON 32
eH1_3                -4.522420e-02 1 1  ON 33
eH1_4                 3.485166e-03 1 1  ON 34
eH1_5                 3.778692e-02 1 1  ON 35
eH1_6                 9.682611e-02 1 1  ON 36
eH1_7                 1.548592e-01 1 1  ON 37
eH1_8                 1.823114e-01 1 1  ON 38
eH1_9                 7.480206e-02 1 1  ON 39
eH2_0                -2.506476e-01 1 1  ON 40
eH2_1                -1.465078e-01 1 1  ON 41
eH2_2                -9.772202e-02 1 1  ON 42
eH2_3                -4.299269e-02 1 1  ON 43
eH2_4                 6.004733e-03 1 1  ON 44
eH2_5                 4.031550e-02 1 1  ON 45
eH2_6                 9.976406e-02 1 1  ON 46
eH2_7                 1.560741e-01 1 1  ON 47
eH2_8                 1.866387e-01 1 1  ON 48
eH2_9                 6.487660e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9084
    reference variance = 0.200976
====================================================
  Execution time = 3.3347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3380e-01
  Total weights = 2.0000e+06
  Execution time = 3.1230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333876154253
                                         uncertainty =       0.002603732668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333876154253
                                         uncertainty =       0.002603732668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408536659
  error estimate for blocks of size 2^( 2) =       0.000421636084
  error estimate for blocks of size 2^( 3) =       0.000434538722
  error estimate for blocks of size 2^( 4) =       0.000446844679
  error estimate for blocks of size 2^( 5) =       0.000458720711
  error estimate for blocks of size 2^( 6) =       0.000466650909
  error estimate for blocks of size 2^( 7) =       0.000472845873

      target function =                  N/A
              le_mean =     -16.906073501378
             les_mean =     286.149125470935
             stat err =       0.000461265543
             autocorr =       1.274793854038
              std dev =       0.577758084191
             le_variance =       0.333804403848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333871612518
                                         uncertainty =       0.002603673527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333871612518
                                         uncertainty =       0.002603673527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408533878
  error estimate for blocks of size 2^( 2) =       0.000421633227
  error estimate for blocks of size 2^( 3) =       0.000434536170
  error estimate for blocks of size 2^( 4) =       0.000446842011
  error estimate for blocks of size 2^( 5) =       0.000458717714
  error estimate for blocks of size 2^( 6) =       0.000466647865
  error estimate for blocks of size 2^( 7) =       0.000472842826

      target function =                  N/A
              le_mean =     -16.906073690220
             les_mean =     286.149127311352
             stat err =       0.000461262604
             autocorr =       1.274794963723
              std dev =       0.577754151096
             le_variance =       0.333799859108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333873884668
                                         uncertainty =       0.002603701846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333873884668
                                         uncertainty =       0.002603701846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408535269
  error estimate for blocks of size 2^( 2) =       0.000421634656
  error estimate for blocks of size 2^( 3) =       0.000434537461
  error estimate for blocks of size 2^( 4) =       0.000446843358
  error estimate for blocks of size 2^( 5) =       0.000458719211
  error estimate for blocks of size 2^( 6) =       0.000466649380
  error estimate for blocks of size 2^( 7) =       0.000472844342

      target function =                  N/A
              le_mean =     -16.906073601640
             les_mean =     286.149126589814
             stat err =       0.000461264073
             autocorr =       1.274794401412
              std dev =       0.577756118657
             le_variance =       0.333802132645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333875869894
                                         uncertainty =       0.002603728770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333875869894
                                         uncertainty =       0.002603728770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408536485
  error estimate for blocks of size 2^( 2) =       0.000421635905
  error estimate for blocks of size 2^( 3) =       0.000434538564
  error estimate for blocks of size 2^( 4) =       0.000446844514
  error estimate for blocks of size 2^( 5) =       0.000458720523
  error estimate for blocks of size 2^( 6) =       0.000466650717
  error estimate for blocks of size 2^( 7) =       0.000472845681

      target function =                  N/A
              le_mean =     -16.906073514053
             les_mean =     286.149125614928
             stat err =       0.000461265359
             autocorr =       1.274793922537
              std dev =       0.577757837923
             le_variance =       0.333804119282


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906073501378        initial
     5.9605e+00     5.9605e+01             4.3049e-05       -16.906073690220  <--
     2.3842e+01     2.3842e+02             1.0867e-05       -16.906073601640
     9.5367e+01     9.5367e+02             2.7233e-06       -16.906073514053

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 4.9079e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.112375e-01 1 1  ON 0
 uu_1                 1.438294e-01 1 1  ON 1
 uu_2                 4.181311e-02 1 1  ON 2
 uu_3                -2.115325e-02 1 1  ON 3
 uu_4                -6.721477e-02 1 1  ON 4
 uu_5                -1.023590e-01 1 1  ON 5
 uu_6                -1.301541e-01 1 1  ON 6
 uu_7                -1.440601e-01 1 1  ON 7
 uu_8                -1.368204e-01 1 1  ON 8
 uu_9                -1.067684e-01 1 1  ON 9
 ud_0                 4.503900e-01 1 1  ON 10
 ud_1                 1.844347e-01 1 1  ON 11
 ud_2                 6.374984e-02 1 1  ON 12
 ud_3                -7.772355e-03 1 1  ON 13
 ud_4                -6.535320e-02 1 1  ON 14
 ud_5                -1.075338e-01 1 1  ON 15
 ud_6                -1.355061e-01 1 1  ON 16
 ud_7                -1.522294e-01 1 1  ON 17
 ud_8                -1.533515e-01 1 1  ON 18
 ud_9                -1.446120e-01 1 1  ON 19
 eO_0                -7.587360e-01 1 1  ON 20
 eO_1                -4.369147e-01 1 1  ON 21
 eO_2                -2.095873e-02 1 1  ON 22
 eO_3                 2.976482e-01 1 1  ON 23
 eO_4                 5.257762e-01 1 1  ON 24
 eO_5                 4.893423e-01 1 1  ON 25
 eO_6                 2.621310e-01 1 1  ON 26
 eO_7                -4.038198e-02 1 1  ON 27
 eO_8                -2.246763e-01 1 1  ON 28
 eO_9                -9.101871e-02 1 1  ON 29
eH1_0                -2.524529e-01 1 1  ON 30
eH1_1                -1.489658e-01 1 1  ON 31
eH1_2                -1.002074e-01 1 1  ON 32
eH1_3                -4.523038e-02 1 1  ON 33
eH1_4                 3.506310e-03 1 1  ON 34
eH1_5                 3.778484e-02 1 1  ON 35
eH1_6                 9.682563e-02 1 1  ON 36
eH1_7                 1.548654e-01 1 1  ON 37
eH1_8                 1.823214e-01 1 1  ON 38
eH1_9                 7.481612e-02 1 1  ON 39
eH2_0                -2.506605e-01 1 1  ON 40
eH2_1                -1.465180e-01 1 1  ON 41
eH2_2                -9.773490e-02 1 1  ON 42
eH2_3                -4.299995e-02 1 1  ON 43
eH2_4                 6.001245e-03 1 1  ON 44
eH2_5                 4.031714e-02 1 1  ON 45
eH2_6                 9.976265e-02 1 1  ON 46
eH2_7                 1.560790e-01 1 1  ON 47
eH2_8                 1.866522e-01 1 1  ON 48
eH2_9                 6.489905e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3933e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8658
    reference variance = 0.24965
====================================================
  Execution time = 3.3646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3870e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338593381696
                                         uncertainty =       0.003644150630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338593381696
                                         uncertainty =       0.003644150630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411522637
  error estimate for blocks of size 2^( 2) =       0.000424590674
  error estimate for blocks of size 2^( 3) =       0.000437728709
  error estimate for blocks of size 2^( 4) =       0.000450093390
  error estimate for blocks of size 2^( 5) =       0.000460498028
  error estimate for blocks of size 2^( 6) =       0.000468022637
  error estimate for blocks of size 2^( 7) =       0.000472511024

      target function =                  N/A
              le_mean =     -16.906355866094
             les_mean =     286.163570262794
             stat err =       0.000462781270
             autocorr =       1.264631769449
              std dev =       0.581980894144
             le_variance =       0.338701761149


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635586609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906355866094       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906356091233       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906356185143       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906356285310       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906356341585       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906356322113       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906356402931       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906356353224       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.720230e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906355866094       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906355928272       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906355953247       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906355982400       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906356004843       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906355999154       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906356017795       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906356006612       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.464874e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906355866094       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906355882056       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906355888418       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906355896006       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906355902196       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906355900990       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906355905436       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906355902775       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.127758e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2774e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.112396e-01 1 1  ON 0
 uu_1                 1.438357e-01 1 1  ON 1
 uu_2                 4.181226e-02 1 1  ON 2
 uu_3                -2.115722e-02 1 1  ON 3
 uu_4                -6.721210e-02 1 1  ON 4
 uu_5                -1.023770e-01 1 1  ON 5
 uu_6                -1.301559e-01 1 1  ON 6
 uu_7                -1.440415e-01 1 1  ON 7
 uu_8                -1.368271e-01 1 1  ON 8
 uu_9                -1.067862e-01 1 1  ON 9
 ud_0                 4.503977e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.376175e-02 1 1  ON 12
 ud_3                -7.782910e-03 1 1  ON 13
 ud_4                -6.534379e-02 1 1  ON 14
 ud_5                -1.075218e-01 1 1  ON 15
 ud_6                -1.355049e-01 1 1  ON 16
 ud_7                -1.522370e-01 1 1  ON 17
 ud_8                -1.533438e-01 1 1  ON 18
 ud_9                -1.446237e-01 1 1  ON 19
 eO_0                -7.587311e-01 1 1  ON 20
 eO_1                -4.369063e-01 1 1  ON 21
 eO_2                -2.096064e-02 1 1  ON 22
 eO_3                 2.976597e-01 1 1  ON 23
 eO_4                 5.257774e-01 1 1  ON 24
 eO_5                 4.893396e-01 1 1  ON 25
 eO_6                 2.621526e-01 1 1  ON 26
 eO_7                -4.037514e-02 1 1  ON 27
 eO_8                -2.246966e-01 1 1  ON 28
 eO_9                -9.104358e-02 1 1  ON 29
eH1_0                -2.524976e-01 1 1  ON 30
eH1_1                -1.489466e-01 1 1  ON 31
eH1_2                -1.002192e-01 1 1  ON 32
eH1_3                -4.524468e-02 1 1  ON 33
eH1_4                 3.513669e-03 1 1  ON 34
eH1_5                 3.778888e-02 1 1  ON 35
eH1_6                 9.681545e-02 1 1  ON 36
eH1_7                 1.548672e-01 1 1  ON 37
eH1_8                 1.823416e-01 1 1  ON 38
eH1_9                 7.484336e-02 1 1  ON 39
eH2_0                -2.506835e-01 1 1  ON 40
eH2_1                -1.465194e-01 1 1  ON 41
eH2_2                -9.772651e-02 1 1  ON 42
eH2_3                -4.300380e-02 1 1  ON 43
eH2_4                 5.985444e-03 1 1  ON 44
eH2_5                 4.031976e-02 1 1  ON 45
eH2_6                 9.975689e-02 1 1  ON 46
eH2_7                 1.560810e-01 1 1  ON 47
eH2_8                 1.866661e-01 1 1  ON 48
eH2_9                 6.492308e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.826
    reference variance = 0.431465
====================================================
  Execution time = 3.3361e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4250e-01
  Total weights = 2.0000e+06
  Execution time = 3.1236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342539165584
                                         uncertainty =       0.006616174978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342539165584
                                         uncertainty =       0.006616174978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413822239
  error estimate for blocks of size 2^( 2) =       0.000426892762
  error estimate for blocks of size 2^( 3) =       0.000440297706
  error estimate for blocks of size 2^( 4) =       0.000452808403
  error estimate for blocks of size 2^( 5) =       0.000463523272
  error estimate for blocks of size 2^( 6) =       0.000469552687
  error estimate for blocks of size 2^( 7) =       0.000475644393

      target function =                  N/A
              le_mean =     -16.906194271774
             les_mean =     286.161902275282
             stat err =       0.000465382189
             autocorr =       1.264712650037
              std dev =       0.585233023319
             le_variance =       0.342497691583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342542012795
                                         uncertainty =       0.006618545568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342542012795
                                         uncertainty =       0.006618545568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413823950
  error estimate for blocks of size 2^( 2) =       0.000426895031
  error estimate for blocks of size 2^( 3) =       0.000440300058
  error estimate for blocks of size 2^( 4) =       0.000452811571
  error estimate for blocks of size 2^( 5) =       0.000463527488
  error estimate for blocks of size 2^( 6) =       0.000469558387
  error estimate for blocks of size 2^( 7) =       0.000475649127

      target function =                  N/A
              le_mean =     -16.906194393742
             les_mean =     286.161909231412
             stat err =       0.000465386643
             autocorr =       1.264726403959
              std dev =       0.585235442947
             le_variance =       0.342500523681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342541097013
                                         uncertainty =       0.006617569095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342541097013
                                         uncertainty =       0.006617569095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413823400
  error estimate for blocks of size 2^( 2) =       0.000426894276
  error estimate for blocks of size 2^( 3) =       0.000440299287
  error estimate for blocks of size 2^( 4) =       0.000452810427
  error estimate for blocks of size 2^( 5) =       0.000463525860
  error estimate for blocks of size 2^( 6) =       0.000469556183
  error estimate for blocks of size 2^( 7) =       0.000475647308

      target function =                  N/A
              le_mean =     -16.906194328431
             les_mean =     286.161906112407
             stat err =       0.000465384945
             autocorr =       1.264720534398
              std dev =       0.585234664876
             le_variance =       0.342499612972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342539409063
                                         uncertainty =       0.006616357458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342539409063
                                         uncertainty =       0.006616357458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413822386
  error estimate for blocks of size 2^( 2) =       0.000426892956
  error estimate for blocks of size 2^( 3) =       0.000440297909
  error estimate for blocks of size 2^( 4) =       0.000452808662
  error estimate for blocks of size 2^( 5) =       0.000463523604
  error estimate for blocks of size 2^( 6) =       0.000469553140
  error estimate for blocks of size 2^( 7) =       0.000475644770

      target function =                  N/A
              le_mean =     -16.906194277554
             les_mean =     286.161902712838
             stat err =       0.000465382544
             autocorr =       1.264713687166
              std dev =       0.585233230177
             le_variance =       0.342497933704


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906194271774        initial
     1.4901e+00     1.4901e+01             1.7202e-04       -16.906194393742  <--
     5.9605e+00     5.9605e+01             4.4649e-05       -16.906194328431
     2.3842e+01     2.3842e+02             1.1278e-05       -16.906194277554

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 4.9097e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.112478e-01 1 1  ON 0
 uu_1                 1.438497e-01 1 1  ON 1
 uu_2                 4.181033e-02 1 1  ON 2
 uu_3                -2.116727e-02 1 1  ON 3
 uu_4                -6.720979e-02 1 1  ON 4
 uu_5                -1.024214e-01 1 1  ON 5
 uu_6                -1.301631e-01 1 1  ON 6
 uu_7                -1.439897e-01 1 1  ON 7
 uu_8                -1.368458e-01 1 1  ON 8
 uu_9                -1.068381e-01 1 1  ON 9
 ud_0                 4.504162e-01 1 1  ON 10
 ud_1                 1.844316e-01 1 1  ON 11
 ud_2                 6.378841e-02 1 1  ON 12
 ud_3                -7.802818e-03 1 1  ON 13
 ud_4                -6.532104e-02 1 1  ON 14
 ud_5                -1.074876e-01 1 1  ON 15
 ud_6                -1.355005e-01 1 1  ON 16
 ud_7                -1.522591e-01 1 1  ON 17
 ud_8                -1.533216e-01 1 1  ON 18
 ud_9                -1.446582e-01 1 1  ON 19
 eO_0                -7.587179e-01 1 1  ON 20
 eO_1                -4.368814e-01 1 1  ON 21
 eO_2                -2.096116e-02 1 1  ON 22
 eO_3                 2.976879e-01 1 1  ON 23
 eO_4                 5.257823e-01 1 1  ON 24
 eO_5                 4.893324e-01 1 1  ON 25
 eO_6                 2.622155e-01 1 1  ON 26
 eO_7                -4.035487e-02 1 1  ON 27
 eO_8                -2.247566e-01 1 1  ON 28
 eO_9                -9.111709e-02 1 1  ON 29
eH1_0                -2.526249e-01 1 1  ON 30
eH1_1                -1.488993e-01 1 1  ON 31
eH1_2                -1.002514e-01 1 1  ON 32
eH1_3                -4.528216e-02 1 1  ON 33
eH1_4                 3.530603e-03 1 1  ON 34
eH1_5                 3.780213e-02 1 1  ON 35
eH1_6                 9.678622e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824013e-01 1 1  ON 38
eH1_9                 7.492399e-02 1 1  ON 39
eH2_0                -2.507502e-01 1 1  ON 40
eH2_1                -1.465228e-01 1 1  ON 41
eH2_2                -9.770833e-02 1 1  ON 42
eH2_3                -4.301146e-02 1 1  ON 43
eH2_4                 5.940564e-03 1 1  ON 44
eH2_5                 4.032601e-02 1 1  ON 45
eH2_6                 9.973997e-02 1 1  ON 46
eH2_7                 1.560867e-01 1 1  ON 47
eH2_8                 1.867072e-01 1 1  ON 48
eH2_9                 6.499417e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1878e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.868
    reference variance = 0.340014
====================================================
  Execution time = 3.3994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3405e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.5020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334010939440
                                         uncertainty =       0.004013322143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334010939440
                                         uncertainty =       0.004013322143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408685030
  error estimate for blocks of size 2^( 2) =       0.000421439785
  error estimate for blocks of size 2^( 3) =       0.000434392626
  error estimate for blocks of size 2^( 4) =       0.000446784557
  error estimate for blocks of size 2^( 5) =       0.000457922161
  error estimate for blocks of size 2^( 6) =       0.000465013866
  error estimate for blocks of size 2^( 7) =       0.000467237555

      target function =                  N/A
              le_mean =     -16.905941419537
             les_mean =     286.144902020560
             stat err =       0.000459239535
             autocorr =       1.262702608104
              std dev =       0.577967911552
             le_variance =       0.334046906783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594141954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941419537       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905940929556       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905940343487       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905941011415       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905941943280       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905942088752       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905941178765       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905941398949       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905941565759       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905941639839       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 9.070154e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941419537       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905941256260       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905940950291       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905940916971       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905941126439       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905941337678       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905941161085       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905941208431       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905941225473       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 2.279210e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941419537       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905941375012       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905941277220       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905941247154       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905941287923       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905941340472       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905941310471       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905941322913       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 5.561127e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3504e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.112950e-01 1 1  ON 0
 uu_1                 1.438777e-01 1 1  ON 1
 uu_2                 4.178907e-02 1 1  ON 2
 uu_3                -2.111235e-02 1 1  ON 3
 uu_4                -6.719665e-02 1 1  ON 4
 uu_5                -1.024519e-01 1 1  ON 5
 uu_6                -1.302566e-01 1 1  ON 6
 uu_7                -1.440686e-01 1 1  ON 7
 uu_8                -1.367740e-01 1 1  ON 8
 uu_9                -1.068450e-01 1 1  ON 9
 ud_0                 4.504982e-01 1 1  ON 10
 ud_1                 1.844260e-01 1 1  ON 11
 ud_2                 6.373701e-02 1 1  ON 12
 ud_3                -7.785607e-03 1 1  ON 13
 ud_4                -6.534420e-02 1 1  ON 14
 ud_5                -1.075016e-01 1 1  ON 15
 ud_6                -1.354354e-01 1 1  ON 16
 ud_7                -1.523634e-01 1 1  ON 17
 ud_8                -1.533301e-01 1 1  ON 18
 ud_9                -1.446341e-01 1 1  ON 19
 eO_0                -7.586497e-01 1 1  ON 20
 eO_1                -4.368255e-01 1 1  ON 21
 eO_2                -2.092590e-02 1 1  ON 22
 eO_3                 2.976351e-01 1 1  ON 23
 eO_4                 5.257612e-01 1 1  ON 24
 eO_5                 4.893820e-01 1 1  ON 25
 eO_6                 2.622237e-01 1 1  ON 26
 eO_7                -4.036238e-02 1 1  ON 27
 eO_8                -2.247928e-01 1 1  ON 28
 eO_9                -9.120308e-02 1 1  ON 29
eH1_0                -2.527263e-01 1 1  ON 30
eH1_1                -1.489775e-01 1 1  ON 31
eH1_2                -1.002491e-01 1 1  ON 32
eH1_3                -4.523885e-02 1 1  ON 33
eH1_4                 3.532448e-03 1 1  ON 34
eH1_5                 3.778576e-02 1 1  ON 35
eH1_6                 9.675943e-02 1 1  ON 36
eH1_7                 1.548927e-01 1 1  ON 37
eH1_8                 1.824596e-01 1 1  ON 38
eH1_9                 7.502521e-02 1 1  ON 39
eH2_0                -2.508215e-01 1 1  ON 40
eH2_1                -1.465749e-01 1 1  ON 41
eH2_2                -9.779221e-02 1 1  ON 42
eH2_3                -4.304666e-02 1 1  ON 43
eH2_4                 5.864272e-03 1 1  ON 44
eH2_5                 4.029217e-02 1 1  ON 45
eH2_6                 9.967175e-02 1 1  ON 46
eH2_7                 1.560696e-01 1 1  ON 47
eH2_8                 1.868649e-01 1 1  ON 48
eH2_9                 6.522209e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9299
    reference variance = 0.242803
====================================================
  Execution time = 3.3418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4579e-01
  Total weights = 2.0000e+06
  Execution time = 3.1219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345719085656
                                         uncertainty =       0.007150700217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345719085656
                                         uncertainty =       0.007150700217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415733564
  error estimate for blocks of size 2^( 2) =       0.000428742141
  error estimate for blocks of size 2^( 3) =       0.000442138969
  error estimate for blocks of size 2^( 4) =       0.000454772183
  error estimate for blocks of size 2^( 5) =       0.000466744828
  error estimate for blocks of size 2^( 6) =       0.000475366950
  error estimate for blocks of size 2^( 7) =       0.000482354824

      target function =                  N/A
              le_mean =     -16.906397665723
             les_mean =     286.171950651609
             stat err =       0.000469809696
             autocorr =       1.277067268001
              std dev =       0.587936044893
             le_variance =       0.345668792884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345972459620
                                         uncertainty =       0.007151707005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345972459620
                                         uncertainty =       0.007151707005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415885888
  error estimate for blocks of size 2^( 2) =       0.000428885212
  error estimate for blocks of size 2^( 3) =       0.000442273403
  error estimate for blocks of size 2^( 4) =       0.000454901538
  error estimate for blocks of size 2^( 5) =       0.000466871861
  error estimate for blocks of size 2^( 6) =       0.000475493320
  error estimate for blocks of size 2^( 7) =       0.000482481272

      target function =                  N/A
              le_mean =     -16.906397196988
             les_mean =     286.172188152632
             stat err =       0.000469936998
             autocorr =       1.276823621773
              std dev =       0.588151462866
             le_variance =       0.345922143271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345956619157
                                         uncertainty =       0.007153645370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345956619157
                                         uncertainty =       0.007153645370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415876361
  error estimate for blocks of size 2^( 2) =       0.000428876261
  error estimate for blocks of size 2^( 3) =       0.000442265182
  error estimate for blocks of size 2^( 4) =       0.000454893676
  error estimate for blocks of size 2^( 5) =       0.000466863785
  error estimate for blocks of size 2^( 6) =       0.000475485391
  error estimate for blocks of size 2^( 7) =       0.000482472327

      target function =                  N/A
              le_mean =     -16.906397031078
             les_mean =     286.172166694687
             stat err =       0.000469928795
             autocorr =       1.276837544991
              std dev =       0.588137989922
             le_variance =       0.345906295190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345757684621
                                         uncertainty =       0.007151316266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345757684621
                                         uncertainty =       0.007151316266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415756771
  error estimate for blocks of size 2^( 2) =       0.000428763940
  error estimate for blocks of size 2^( 3) =       0.000442159522
  error estimate for blocks of size 2^( 4) =       0.000454792007
  error estimate for blocks of size 2^( 5) =       0.000466764211
  error estimate for blocks of size 2^( 6) =       0.000475386272
  error estimate for blocks of size 2^( 7) =       0.000482373912

      target function =                  N/A
              le_mean =     -16.906397530160
             les_mean =     286.171984660612
             stat err =       0.000469829101
             autocorr =       1.277030187296
              std dev =       0.587968864530
             le_variance =       0.345707385657


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906397665723        initial  <--
     3.7253e-01     3.7253e+00             9.0702e-04       -16.906397196988
     1.4901e+00     1.4901e+01             2.2792e-04       -16.906397031078
     5.9605e+00     5.9605e+01             5.5611e-05       -16.906397530160

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.1492
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.112478e-01 1 1  ON 0
 uu_1                 1.438497e-01 1 1  ON 1
 uu_2                 4.181033e-02 1 1  ON 2
 uu_3                -2.116727e-02 1 1  ON 3
 uu_4                -6.720979e-02 1 1  ON 4
 uu_5                -1.024214e-01 1 1  ON 5
 uu_6                -1.301631e-01 1 1  ON 6
 uu_7                -1.439897e-01 1 1  ON 7
 uu_8                -1.368458e-01 1 1  ON 8
 uu_9                -1.068381e-01 1 1  ON 9
 ud_0                 4.504162e-01 1 1  ON 10
 ud_1                 1.844316e-01 1 1  ON 11
 ud_2                 6.378841e-02 1 1  ON 12
 ud_3                -7.802818e-03 1 1  ON 13
 ud_4                -6.532104e-02 1 1  ON 14
 ud_5                -1.074876e-01 1 1  ON 15
 ud_6                -1.355005e-01 1 1  ON 16
 ud_7                -1.522591e-01 1 1  ON 17
 ud_8                -1.533216e-01 1 1  ON 18
 ud_9                -1.446582e-01 1 1  ON 19
 eO_0                -7.587179e-01 1 1  ON 20
 eO_1                -4.368814e-01 1 1  ON 21
 eO_2                -2.096116e-02 1 1  ON 22
 eO_3                 2.976879e-01 1 1  ON 23
 eO_4                 5.257823e-01 1 1  ON 24
 eO_5                 4.893324e-01 1 1  ON 25
 eO_6                 2.622155e-01 1 1  ON 26
 eO_7                -4.035487e-02 1 1  ON 27
 eO_8                -2.247566e-01 1 1  ON 28
 eO_9                -9.111709e-02 1 1  ON 29
eH1_0                -2.526249e-01 1 1  ON 30
eH1_1                -1.488993e-01 1 1  ON 31
eH1_2                -1.002514e-01 1 1  ON 32
eH1_3                -4.528216e-02 1 1  ON 33
eH1_4                 3.530603e-03 1 1  ON 34
eH1_5                 3.780213e-02 1 1  ON 35
eH1_6                 9.678622e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824013e-01 1 1  ON 38
eH1_9                 7.492399e-02 1 1  ON 39
eH2_0                -2.507502e-01 1 1  ON 40
eH2_1                -1.465228e-01 1 1  ON 41
eH2_2                -9.770833e-02 1 1  ON 42
eH2_3                -4.301146e-02 1 1  ON 43
eH2_4                 5.940564e-03 1 1  ON 44
eH2_5                 4.032601e-02 1 1  ON 45
eH2_6                 9.973997e-02 1 1  ON 46
eH2_7                 1.560867e-01 1 1  ON 47
eH2_8                 1.867072e-01 1 1  ON 48
eH2_9                 6.499417e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2660e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9812
    reference variance = 0.52471
====================================================
  Execution time = 3.5105e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4585e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345865161821
                                         uncertainty =       0.009153973732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345865161821
                                         uncertainty =       0.009153973732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415843233
  error estimate for blocks of size 2^( 2) =       0.000428928938
  error estimate for blocks of size 2^( 3) =       0.000441898521
  error estimate for blocks of size 2^( 4) =       0.000454164501
  error estimate for blocks of size 2^( 5) =       0.000465593847
  error estimate for blocks of size 2^( 6) =       0.000473763171
  error estimate for blocks of size 2^( 7) =       0.000478750495

      target function =                  N/A
              le_mean =     -16.906152340371
             les_mean =     286.163837971867
             stat err =       0.000468068003
             autocorr =       1.266947536148
              std dev =       0.588091140015
             le_variance =       0.345851188965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615234037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152340371       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152426161       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152414154       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152581767       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152671324       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152563664       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152590930       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152578004       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 7.156352e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152340371       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152362408       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152360361       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152406362       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152428241       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152403128       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152407863       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152405101       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.806990e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152340371       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152345918       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152345477       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152357256       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152362691       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152356551       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152357574       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152356936       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 4.528748e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075043 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4341e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.112470e-01 1 1  ON 0
 uu_1                 1.438507e-01 1 1  ON 1
 uu_2                 4.181079e-02 1 1  ON 2
 uu_3                -2.116881e-02 1 1  ON 3
 uu_4                -6.721015e-02 1 1  ON 4
 uu_5                -1.024255e-01 1 1  ON 5
 uu_6                -1.301653e-01 1 1  ON 6
 uu_7                -1.439936e-01 1 1  ON 7
 uu_8                -1.368471e-01 1 1  ON 8
 uu_9                -1.068399e-01 1 1  ON 9
 ud_0                 4.504186e-01 1 1  ON 10
 ud_1                 1.844300e-01 1 1  ON 11
 ud_2                 6.378513e-02 1 1  ON 12
 ud_3                -7.804229e-03 1 1  ON 13
 ud_4                -6.532451e-02 1 1  ON 14
 ud_5                -1.074835e-01 1 1  ON 15
 ud_6                -1.355004e-01 1 1  ON 16
 ud_7                -1.522596e-01 1 1  ON 17
 ud_8                -1.533170e-01 1 1  ON 18
 ud_9                -1.446561e-01 1 1  ON 19
 eO_0                -7.587084e-01 1 1  ON 20
 eO_1                -4.368808e-01 1 1  ON 21
 eO_2                -2.096013e-02 1 1  ON 22
 eO_3                 2.976828e-01 1 1  ON 23
 eO_4                 5.257796e-01 1 1  ON 24
 eO_5                 4.893398e-01 1 1  ON 25
 eO_6                 2.622167e-01 1 1  ON 26
 eO_7                -4.035435e-02 1 1  ON 27
 eO_8                -2.247599e-01 1 1  ON 28
 eO_9                -9.112487e-02 1 1  ON 29
eH1_0                -2.526430e-01 1 1  ON 30
eH1_1                -1.489060e-01 1 1  ON 31
eH1_2                -1.002502e-01 1 1  ON 32
eH1_3                -4.528649e-02 1 1  ON 33
eH1_4                 3.534082e-03 1 1  ON 34
eH1_5                 3.780403e-02 1 1  ON 35
eH1_6                 9.678427e-02 1 1  ON 36
eH1_7                 1.548748e-01 1 1  ON 37
eH1_8                 1.824105e-01 1 1  ON 38
eH1_9                 7.493580e-02 1 1  ON 39
eH2_0                -2.507607e-01 1 1  ON 40
eH2_1                -1.465280e-01 1 1  ON 41
eH2_2                -9.772244e-02 1 1  ON 42
eH2_3                -4.301057e-02 1 1  ON 43
eH2_4                 5.940400e-03 1 1  ON 44
eH2_5                 4.032603e-02 1 1  ON 45
eH2_6                 9.974858e-02 1 1  ON 46
eH2_7                 1.560910e-01 1 1  ON 47
eH2_8                 1.867092e-01 1 1  ON 48
eH2_9                 6.500713e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8871
    reference variance = 0.298424
====================================================
  Execution time = 3.3218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3462e-01
  Total weights = 2.0000e+06
  Execution time = 3.1305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334610500310
                                         uncertainty =       0.002452599180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334610500310
                                         uncertainty =       0.002452599180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409035789
  error estimate for blocks of size 2^( 2) =       0.000421707929
  error estimate for blocks of size 2^( 3) =       0.000434729731
  error estimate for blocks of size 2^( 4) =       0.000446984814
  error estimate for blocks of size 2^( 5) =       0.000457089525
  error estimate for blocks of size 2^( 6) =       0.000464862064
  error estimate for blocks of size 2^( 7) =       0.000470234131

      target function =                  N/A
              le_mean =     -16.906446325304
             les_mean =     286.162547735869
             stat err =       0.000459792633
             autocorr =       1.263576093793
              std dev =       0.578463959803
             le_variance =       0.334620552791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622831548
                                         uncertainty =       0.002452690342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334622831548
                                         uncertainty =       0.002452690342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409043326
  error estimate for blocks of size 2^( 2) =       0.000421714954
  error estimate for blocks of size 2^( 3) =       0.000434736252
  error estimate for blocks of size 2^( 4) =       0.000446991245
  error estimate for blocks of size 2^( 5) =       0.000457095462
  error estimate for blocks of size 2^( 6) =       0.000464867470
  error estimate for blocks of size 2^( 7) =       0.000470239543

      target function =                  N/A
              le_mean =     -16.906446011808
             les_mean =     286.162549467439
             stat err =       0.000459798430
             autocorr =       1.263561389043
              std dev =       0.578474618796
             le_variance =       0.334632884592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334617481959
                                         uncertainty =       0.002452650587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334617481959
                                         uncertainty =       0.002452650587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409040056
  error estimate for blocks of size 2^( 2) =       0.000421711910
  error estimate for blocks of size 2^( 3) =       0.000434733432
  error estimate for blocks of size 2^( 4) =       0.000446988455
  error estimate for blocks of size 2^( 5) =       0.000457092899
  error estimate for blocks of size 2^( 6) =       0.000464865158
  error estimate for blocks of size 2^( 7) =       0.000470237223

      target function =                  N/A
              le_mean =     -16.906446160546
             les_mean =     286.162549146705
             stat err =       0.000459795934
             autocorr =       1.263567870943
              std dev =       0.578469994547
             le_variance =       0.334627534591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334611401238
                                         uncertainty =       0.002452605818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334611401238
                                         uncertainty =       0.002452605818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409036339
  error estimate for blocks of size 2^( 2) =       0.000421708443
  error estimate for blocks of size 2^( 3) =       0.000434730209
  error estimate for blocks of size 2^( 4) =       0.000446985283
  error estimate for blocks of size 2^( 5) =       0.000457089960
  error estimate for blocks of size 2^( 6) =       0.000464862464
  error estimate for blocks of size 2^( 7) =       0.000470234530

      target function =                  N/A
              le_mean =     -16.906446304300
             les_mean =     286.162547926611
             stat err =       0.000459793059
             autocorr =       1.263575034994
              std dev =       0.578464738539
             le_variance =       0.334621453733


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906446325304        initial  <--
     3.7253e+00     3.7253e+01             7.1564e-05       -16.906446011808
     1.4901e+01     1.4901e+02             1.8070e-05       -16.906446160546
     5.9605e+01     5.9605e+02             4.5287e-06       -16.906446304300

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.9768
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.112478e-01 1 1  ON 0
 uu_1                 1.438497e-01 1 1  ON 1
 uu_2                 4.181033e-02 1 1  ON 2
 uu_3                -2.116727e-02 1 1  ON 3
 uu_4                -6.720979e-02 1 1  ON 4
 uu_5                -1.024214e-01 1 1  ON 5
 uu_6                -1.301631e-01 1 1  ON 6
 uu_7                -1.439897e-01 1 1  ON 7
 uu_8                -1.368458e-01 1 1  ON 8
 uu_9                -1.068381e-01 1 1  ON 9
 ud_0                 4.504162e-01 1 1  ON 10
 ud_1                 1.844316e-01 1 1  ON 11
 ud_2                 6.378841e-02 1 1  ON 12
 ud_3                -7.802818e-03 1 1  ON 13
 ud_4                -6.532104e-02 1 1  ON 14
 ud_5                -1.074876e-01 1 1  ON 15
 ud_6                -1.355005e-01 1 1  ON 16
 ud_7                -1.522591e-01 1 1  ON 17
 ud_8                -1.533216e-01 1 1  ON 18
 ud_9                -1.446582e-01 1 1  ON 19
 eO_0                -7.587179e-01 1 1  ON 20
 eO_1                -4.368814e-01 1 1  ON 21
 eO_2                -2.096116e-02 1 1  ON 22
 eO_3                 2.976879e-01 1 1  ON 23
 eO_4                 5.257823e-01 1 1  ON 24
 eO_5                 4.893324e-01 1 1  ON 25
 eO_6                 2.622155e-01 1 1  ON 26
 eO_7                -4.035487e-02 1 1  ON 27
 eO_8                -2.247566e-01 1 1  ON 28
 eO_9                -9.111709e-02 1 1  ON 29
eH1_0                -2.526249e-01 1 1  ON 30
eH1_1                -1.488993e-01 1 1  ON 31
eH1_2                -1.002514e-01 1 1  ON 32
eH1_3                -4.528216e-02 1 1  ON 33
eH1_4                 3.530603e-03 1 1  ON 34
eH1_5                 3.780213e-02 1 1  ON 35
eH1_6                 9.678622e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824013e-01 1 1  ON 38
eH1_9                 7.492399e-02 1 1  ON 39
eH2_0                -2.507502e-01 1 1  ON 40
eH2_1                -1.465228e-01 1 1  ON 41
eH2_2                -9.770833e-02 1 1  ON 42
eH2_3                -4.301146e-02 1 1  ON 43
eH2_4                 5.940564e-03 1 1  ON 44
eH2_5                 4.032601e-02 1 1  ON 45
eH2_6                 9.973997e-02 1 1  ON 46
eH2_7                 1.560867e-01 1 1  ON 47
eH2_8                 1.867072e-01 1 1  ON 48
eH2_9                 6.499417e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3326e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9325
    reference variance = 0.298452
====================================================
  Execution time = 3.3897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4663e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346701295183
                                         uncertainty =       0.007750227741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346701295183
                                         uncertainty =       0.007750227741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416311669
  error estimate for blocks of size 2^( 2) =       0.000428881803
  error estimate for blocks of size 2^( 3) =       0.000441698333
  error estimate for blocks of size 2^( 4) =       0.000453944763
  error estimate for blocks of size 2^( 5) =       0.000464859400
  error estimate for blocks of size 2^( 6) =       0.000473587191
  error estimate for blocks of size 2^( 7) =       0.000477145669

      target function =                  N/A
              le_mean =     -16.906583801886
             les_mean =     286.179206488158
             stat err =       0.000467384256
             autocorr =       1.260407530830
              std dev =       0.588753608280
             le_variance =       0.346630811263


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658380189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906583801886       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906583821594       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906583828664       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906583824848       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906583833149       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906583842417       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906583837508       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906583836085       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.599031e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906583801886       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906583806834       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906583808632       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906583807675       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906583809750       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906583812085       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906583810873       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906583810510       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.400292e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906583801886       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906583803125       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906583803576       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906583803337       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906583803855       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906583804441       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906583804138       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906583804046       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.501071e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077759 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3187e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.112482e-01 1 1  ON 0
 uu_1                 1.438493e-01 1 1  ON 1
 uu_2                 4.181090e-02 1 1  ON 2
 uu_3                -2.116756e-02 1 1  ON 3
 uu_4                -6.720963e-02 1 1  ON 4
 uu_5                -1.024214e-01 1 1  ON 5
 uu_6                -1.301641e-01 1 1  ON 6
 uu_7                -1.439909e-01 1 1  ON 7
 uu_8                -1.368461e-01 1 1  ON 8
 uu_9                -1.068380e-01 1 1  ON 9
 ud_0                 4.504157e-01 1 1  ON 10
 ud_1                 1.844317e-01 1 1  ON 11
 ud_2                 6.378856e-02 1 1  ON 12
 ud_3                -7.802510e-03 1 1  ON 13
 ud_4                -6.532188e-02 1 1  ON 14
 ud_5                -1.074869e-01 1 1  ON 15
 ud_6                -1.355008e-01 1 1  ON 16
 ud_7                -1.522598e-01 1 1  ON 17
 ud_8                -1.533211e-01 1 1  ON 18
 ud_9                -1.446573e-01 1 1  ON 19
 eO_0                -7.587171e-01 1 1  ON 20
 eO_1                -4.368816e-01 1 1  ON 21
 eO_2                -2.096072e-02 1 1  ON 22
 eO_3                 2.976876e-01 1 1  ON 23
 eO_4                 5.257822e-01 1 1  ON 24
 eO_5                 4.893329e-01 1 1  ON 25
 eO_6                 2.622157e-01 1 1  ON 26
 eO_7                -4.035531e-02 1 1  ON 27
 eO_8                -2.247569e-01 1 1  ON 28
 eO_9                -9.111759e-02 1 1  ON 29
eH1_0                -2.526263e-01 1 1  ON 30
eH1_1                -1.489003e-01 1 1  ON 31
eH1_2                -1.002512e-01 1 1  ON 32
eH1_3                -4.528295e-02 1 1  ON 33
eH1_4                 3.530594e-03 1 1  ON 34
eH1_5                 3.780243e-02 1 1  ON 35
eH1_6                 9.678690e-02 1 1  ON 36
eH1_7                 1.548729e-01 1 1  ON 37
eH1_8                 1.824019e-01 1 1  ON 38
eH1_9                 7.492493e-02 1 1  ON 39
eH2_0                -2.507509e-01 1 1  ON 40
eH2_1                -1.465237e-01 1 1  ON 41
eH2_2                -9.770926e-02 1 1  ON 42
eH2_3                -4.301158e-02 1 1  ON 43
eH2_4                 5.940554e-03 1 1  ON 44
eH2_5                 4.032569e-02 1 1  ON 45
eH2_6                 9.973986e-02 1 1  ON 46
eH2_7                 1.560870e-01 1 1  ON 47
eH2_8                 1.867080e-01 1 1  ON 48
eH2_9                 6.499557e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8576
    reference variance = 0.15836
====================================================
  Execution time = 3.3130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4037e-01
  Total weights = 2.0000e+06
  Execution time = 3.1251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340379799769
                                         uncertainty =       0.003491631425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340379799769
                                         uncertainty =       0.003491631425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412533130
  error estimate for blocks of size 2^( 2) =       0.000425100367
  error estimate for blocks of size 2^( 3) =       0.000437719143
  error estimate for blocks of size 2^( 4) =       0.000449374607
  error estimate for blocks of size 2^( 5) =       0.000458113998
  error estimate for blocks of size 2^( 6) =       0.000465115358
  error estimate for blocks of size 2^( 7) =       0.000470544747

      target function =                  N/A
              le_mean =     -16.905481599436
             les_mean =     286.135675105857
             stat err =       0.000460787177
             autocorr =       1.247622233669
              std dev =       0.583409947792
             le_variance =       0.340367167183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340376478993
                                         uncertainty =       0.003491611116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340376478993
                                         uncertainty =       0.003491611116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412531118
  error estimate for blocks of size 2^( 2) =       0.000425098454
  error estimate for blocks of size 2^( 3) =       0.000437717362
  error estimate for blocks of size 2^( 4) =       0.000449372872
  error estimate for blocks of size 2^( 5) =       0.000458112331
  error estimate for blocks of size 2^( 6) =       0.000465113681
  error estimate for blocks of size 2^( 7) =       0.000470543126

      target function =                  N/A
              le_mean =     -16.905481625500
             les_mean =     286.135672665893
             stat err =       0.000460785503
             autocorr =       1.247625338905
              std dev =       0.583407101400
             le_variance =       0.340363845964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340378124694
                                         uncertainty =       0.003491621183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340378124694
                                         uncertainty =       0.003491621183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412532115
  error estimate for blocks of size 2^( 2) =       0.000425099402
  error estimate for blocks of size 2^( 3) =       0.000437718244
  error estimate for blocks of size 2^( 4) =       0.000449373732
  error estimate for blocks of size 2^( 5) =       0.000458113157
  error estimate for blocks of size 2^( 6) =       0.000465114512
  error estimate for blocks of size 2^( 7) =       0.000470543929

      target function =                  N/A
              le_mean =     -16.905481612555
             les_mean =     286.135673874149
             stat err =       0.000460786333
             autocorr =       1.247623800211
              std dev =       0.583408512009
             le_variance =       0.340365491884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340379589904
                                         uncertainty =       0.003491630142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340379589904
                                         uncertainty =       0.003491630142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412533003
  error estimate for blocks of size 2^( 2) =       0.000425100246
  error estimate for blocks of size 2^( 3) =       0.000437719031
  error estimate for blocks of size 2^( 4) =       0.000449374497
  error estimate for blocks of size 2^( 5) =       0.000458113892
  error estimate for blocks of size 2^( 6) =       0.000465115252
  error estimate for blocks of size 2^( 7) =       0.000470544644

      target function =                  N/A
              le_mean =     -16.905481601076
             les_mean =     286.135674951435
             stat err =       0.000460787071
             autocorr =       1.247622429925
              std dev =       0.583409767908
             le_variance =       0.340366957291


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905481599436        initial
     3.7253e+01     3.7253e+02             5.5990e-06       -16.905481625500  <--
     1.4901e+02     1.4901e+03             1.4003e-06       -16.905481612555
     5.9605e+02     5.9605e+03             3.5011e-07       -16.905481601076

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 4.8855e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801597e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780330e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940525e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2051e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9874
    reference variance = 0.919687
====================================================
  Execution time = 3.4545e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5808e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358125684659
                                         uncertainty =       0.020433499903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358125684659
                                         uncertainty =       0.020433499903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423132618
  error estimate for blocks of size 2^( 2) =       0.000435891304
  error estimate for blocks of size 2^( 3) =       0.000448878962
  error estimate for blocks of size 2^( 4) =       0.000459842359
  error estimate for blocks of size 2^( 5) =       0.000470132388
  error estimate for blocks of size 2^( 6) =       0.000476353613
  error estimate for blocks of size 2^( 7) =       0.000482362884

      target function =                  N/A
              le_mean =     -16.905649495120
             les_mean =     286.159067096970
             stat err =       0.000472172811
             autocorr =       1.245228183914
              std dev =       0.598399886504
             le_variance =       0.358082424168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564949512e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905649495120       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905649542311       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905649649018       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905649654363       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905649673842       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905649683145       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905649677067       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905649674122       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.113155e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905649495120       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905649507056       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905649534329       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905649535627       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905649540357       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905649542826       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905649541332       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905649540589       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.289745e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905649495120       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905649498113       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905649504969       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905649505291       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905649506466       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905649507091       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905649506720       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905649506534       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.322867e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080557 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3723e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.112516e-01 1 1  ON 0
 uu_1                 1.438485e-01 1 1  ON 1
 uu_2                 4.181215e-02 1 1  ON 2
 uu_3                -2.116716e-02 1 1  ON 3
 uu_4                -6.720838e-02 1 1  ON 4
 uu_5                -1.024227e-01 1 1  ON 5
 uu_6                -1.301674e-01 1 1  ON 6
 uu_7                -1.439969e-01 1 1  ON 7
 uu_8                -1.368480e-01 1 1  ON 8
 uu_9                -1.068388e-01 1 1  ON 9
 ud_0                 4.504136e-01 1 1  ON 10
 ud_1                 1.844320e-01 1 1  ON 11
 ud_2                 6.378885e-02 1 1  ON 12
 ud_3                -7.801441e-03 1 1  ON 13
 ud_4                -6.532376e-02 1 1  ON 14
 ud_5                -1.074814e-01 1 1  ON 15
 ud_6                -1.355027e-01 1 1  ON 16
 ud_7                -1.522650e-01 1 1  ON 17
 ud_8                -1.533183e-01 1 1  ON 18
 ud_9                -1.446533e-01 1 1  ON 19
 eO_0                -7.587129e-01 1 1  ON 20
 eO_1                -4.368799e-01 1 1  ON 21
 eO_2                -2.095907e-02 1 1  ON 22
 eO_3                 2.976871e-01 1 1  ON 23
 eO_4                 5.257792e-01 1 1  ON 24
 eO_5                 4.893380e-01 1 1  ON 25
 eO_6                 2.622179e-01 1 1  ON 26
 eO_7                -4.035685e-02 1 1  ON 27
 eO_8                -2.247610e-01 1 1  ON 28
 eO_9                -9.112242e-02 1 1  ON 29
eH1_0                -2.526341e-01 1 1  ON 30
eH1_1                -1.489035e-01 1 1  ON 31
eH1_2                -1.002543e-01 1 1  ON 32
eH1_3                -4.528947e-02 1 1  ON 33
eH1_4                 3.529427e-03 1 1  ON 34
eH1_5                 3.780303e-02 1 1  ON 35
eH1_6                 9.679040e-02 1 1  ON 36
eH1_7                 1.548752e-01 1 1  ON 37
eH1_8                 1.824087e-01 1 1  ON 38
eH1_9                 7.493273e-02 1 1  ON 39
eH2_0                -2.507539e-01 1 1  ON 40
eH2_1                -1.465278e-01 1 1  ON 41
eH2_2                -9.771470e-02 1 1  ON 42
eH2_3                -4.301279e-02 1 1  ON 43
eH2_4                 5.938152e-03 1 1  ON 44
eH2_5                 4.032354e-02 1 1  ON 45
eH2_6                 9.973977e-02 1 1  ON 46
eH2_7                 1.560889e-01 1 1  ON 47
eH2_8                 1.867137e-01 1 1  ON 48
eH2_9                 6.500506e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8954
    reference variance = 0.153531
====================================================
  Execution time = 3.3205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4160e-01
  Total weights = 2.0000e+06
  Execution time = 3.1171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341692535376
                                         uncertainty =       0.004170248912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341692535376
                                         uncertainty =       0.004170248912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413282331
  error estimate for blocks of size 2^( 2) =       0.000425892021
  error estimate for blocks of size 2^( 3) =       0.000438712900
  error estimate for blocks of size 2^( 4) =       0.000450824038
  error estimate for blocks of size 2^( 5) =       0.000461455082
  error estimate for blocks of size 2^( 6) =       0.000468541004
  error estimate for blocks of size 2^( 7) =       0.000471436653

      target function =                  N/A
              le_mean =     -16.906103116306
             les_mean =     286.157926978504
             stat err =       0.000463064194
             autocorr =       1.255419080323
              std dev =       0.584469477506
             le_variance =       0.341604570136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341694325192
                                         uncertainty =       0.004170310928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341694325192
                                         uncertainty =       0.004170310928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413283412
  error estimate for blocks of size 2^( 2) =       0.000425893107
  error estimate for blocks of size 2^( 3) =       0.000438713941
  error estimate for blocks of size 2^( 4) =       0.000450824890
  error estimate for blocks of size 2^( 5) =       0.000461455844
  error estimate for blocks of size 2^( 6) =       0.000468541763
  error estimate for blocks of size 2^( 7) =       0.000471437230

      target function =                  N/A
              le_mean =     -16.906103060337
             les_mean =     286.157926872439
             stat err =       0.000463064932
             autocorr =       1.255416516674
              std dev =       0.584471005698
             le_variance =       0.341606356501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341693494834
                                         uncertainty =       0.004170281034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341693494834
                                         uncertainty =       0.004170281034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413282910
  error estimate for blocks of size 2^( 2) =       0.000425892601
  error estimate for blocks of size 2^( 3) =       0.000438713455
  error estimate for blocks of size 2^( 4) =       0.000450824496
  error estimate for blocks of size 2^( 5) =       0.000461455495
  error estimate for blocks of size 2^( 6) =       0.000468541414
  error estimate for blocks of size 2^( 7) =       0.000471436965

      target function =                  N/A
              le_mean =     -16.906103088121
             les_mean =     286.157926983179
             stat err =       0.000463064592
             autocorr =       1.255417721762
              std dev =       0.584470296784
             le_variance =       0.341605527823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341692657361
                                         uncertainty =       0.004170252964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341692657361
                                         uncertainty =       0.004170252964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413282405
  error estimate for blocks of size 2^( 2) =       0.000425892095
  error estimate for blocks of size 2^( 3) =       0.000438712970
  error estimate for blocks of size 2^( 4) =       0.000450824096
  error estimate for blocks of size 2^( 5) =       0.000461455134
  error estimate for blocks of size 2^( 6) =       0.000468541056
  error estimate for blocks of size 2^( 7) =       0.000471436692

      target function =                  N/A
              le_mean =     -16.906103112764
             les_mean =     286.157926980509
             stat err =       0.000463064245
             autocorr =       1.255418907941
              std dev =       0.584469581671
             le_variance =       0.341604691898


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906103116306        initial  <--
     9.3132e+00     9.3132e+01             2.1132e-05       -16.906103060337
     3.7253e+01     3.7253e+02             5.2897e-06       -16.906103088121
     1.4901e+02     1.4901e+03             1.3229e-06       -16.906103112764

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.9067
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801597e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780330e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940525e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2639e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9343
    reference variance = 0.196636
====================================================
  Execution time = 3.4023e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3870e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338701717943
                                         uncertainty =       0.004027949318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338701717943
                                         uncertainty =       0.004027949318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411522450
  error estimate for blocks of size 2^( 2) =       0.000423957954
  error estimate for blocks of size 2^( 3) =       0.000436942971
  error estimate for blocks of size 2^( 4) =       0.000448794592
  error estimate for blocks of size 2^( 5) =       0.000457527788
  error estimate for blocks of size 2^( 6) =       0.000463714963
  error estimate for blocks of size 2^( 7) =       0.000470226995

      target function =                  N/A
              le_mean =     -16.906815500786
             les_mean =     286.179111661680
             stat err =       0.000460066085
             autocorr =       1.249836988305
              std dev =       0.581980629764
             le_variance =       0.338701453420


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690681550079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906815500786       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906815500282       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906815501801       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906815505088       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906815509176       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906815512131       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906815510766       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906815510018       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.745447e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906815500786       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906815500660       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906815501040       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906815501862       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906815502885       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906815503625       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906815503283       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906815503098       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 6.867320e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906815500786       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906815500754       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906815500849       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906815501055       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906815501310       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906815501495       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906815501412       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906815501364       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.717061e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3289e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.112495e-01 1 1  ON 0
 uu_1                 1.438482e-01 1 1  ON 1
 uu_2                 4.181270e-02 1 1  ON 2
 uu_3                -2.116839e-02 1 1  ON 3
 uu_4                -6.720915e-02 1 1  ON 4
 uu_5                -1.024215e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439949e-01 1 1  ON 7
 uu_8                -1.368474e-01 1 1  ON 8
 uu_9                -1.068378e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844319e-01 1 1  ON 11
 ud_2                 6.378903e-02 1 1  ON 12
 ud_3                -7.801341e-03 1 1  ON 13
 ud_4                -6.532440e-02 1 1  ON 14
 ud_5                -1.074844e-01 1 1  ON 15
 ud_6                -1.355015e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533198e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587143e-01 1 1  ON 20
 eO_1                -4.368817e-01 1 1  ON 21
 eO_2                -2.095954e-02 1 1  ON 22
 eO_3                 2.976866e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893347e-01 1 1  ON 25
 eO_6                 2.622162e-01 1 1  ON 26
 eO_7                -4.035656e-02 1 1  ON 27
 eO_8                -2.247581e-01 1 1  ON 28
 eO_9                -9.111945e-02 1 1  ON 29
eH1_0                -2.526312e-01 1 1  ON 30
eH1_1                -1.489032e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528526e-02 1 1  ON 33
eH1_4                 3.530787e-03 1 1  ON 34
eH1_5                 3.780314e-02 1 1  ON 35
eH1_6                 9.678907e-02 1 1  ON 36
eH1_7                 1.548740e-01 1 1  ON 37
eH1_8                 1.824038e-01 1 1  ON 38
eH1_9                 7.492813e-02 1 1  ON 39
eH2_0                -2.507532e-01 1 1  ON 40
eH2_1                -1.465266e-01 1 1  ON 41
eH2_2                -9.771243e-02 1 1  ON 42
eH2_3                -4.301208e-02 1 1  ON 43
eH2_4                 5.940694e-03 1 1  ON 44
eH2_5                 4.032463e-02 1 1  ON 45
eH2_6                 9.973944e-02 1 1  ON 46
eH2_7                 1.560884e-01 1 1  ON 47
eH2_8                 1.867108e-01 1 1  ON 48
eH2_9                 6.500035e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9728
    reference variance = 2.08356
====================================================
  Execution time = 3.5531e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4019e-01
  Total weights = 2.0000e+06
  Execution time = 3.1243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339963551654
                                         uncertainty =       0.005776507155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339963551654
                                         uncertainty =       0.005776507155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412425427
  error estimate for blocks of size 2^( 2) =       0.000424784400
  error estimate for blocks of size 2^( 3) =       0.000437137353
  error estimate for blocks of size 2^( 4) =       0.000449371732
  error estimate for blocks of size 2^( 5) =       0.000459631046
  error estimate for blocks of size 2^( 6) =       0.000468138188
  error estimate for blocks of size 2^( 7) =       0.000473299989

      target function =                  N/A
              le_mean =     -16.906554677069
             les_mean =     286.171780343570
             stat err =       0.000462610239
             autocorr =       1.258170843799
              std dev =       0.583257631711
             le_variance =       0.340189464949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339963710324
                                         uncertainty =       0.005776511596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339963710324
                                         uncertainty =       0.005776511596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412425524
  error estimate for blocks of size 2^( 2) =       0.000424784481
  error estimate for blocks of size 2^( 3) =       0.000437137445
  error estimate for blocks of size 2^( 4) =       0.000449371813
  error estimate for blocks of size 2^( 5) =       0.000459631121
  error estimate for blocks of size 2^( 6) =       0.000468138266
  error estimate for blocks of size 2^( 7) =       0.000473300111

      target function =                  N/A
              le_mean =     -16.906554675913
             les_mean =     286.171780464596
             stat err =       0.000462610328
             autocorr =       1.258170736152
              std dev =       0.583257768972
             le_variance =       0.340189625067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339963632769
                                         uncertainty =       0.005776509392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339963632769
                                         uncertainty =       0.005776509392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412425476
  error estimate for blocks of size 2^( 2) =       0.000424784441
  error estimate for blocks of size 2^( 3) =       0.000437137400
  error estimate for blocks of size 2^( 4) =       0.000449371774
  error estimate for blocks of size 2^( 5) =       0.000459631085
  error estimate for blocks of size 2^( 6) =       0.000468138228
  error estimate for blocks of size 2^( 7) =       0.000473300051

      target function =                  N/A
              le_mean =     -16.906554676478
             les_mean =     286.171780405435
             stat err =       0.000462610284
             autocorr =       1.258170788279
              std dev =       0.583257701869
             le_variance =       0.340189546790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339963561848
                                         uncertainty =       0.005776507435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339963561848
                                         uncertainty =       0.005776507435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412425433
  error estimate for blocks of size 2^( 2) =       0.000424784405
  error estimate for blocks of size 2^( 3) =       0.000437137359
  error estimate for blocks of size 2^( 4) =       0.000449371737
  error estimate for blocks of size 2^( 5) =       0.000459631051
  error estimate for blocks of size 2^( 6) =       0.000468138193
  error estimate for blocks of size 2^( 7) =       0.000473299997

      target function =                  N/A
              le_mean =     -16.906554676994
             les_mean =     286.171780351338
             stat err =       0.000462610245
             autocorr =       1.258170836807
              std dev =       0.583257640527
             le_variance =       0.340189475234


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906554677069        initial  <--
     9.3132e+01     9.3132e+02             2.7454e-06       -16.906554675913
     3.7253e+02     3.7253e+03             6.8673e-07       -16.906554676478
     1.4901e+03     1.4901e+04             1.7171e-07       -16.906554676994

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.2850
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801597e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780330e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940525e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4582e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9319
    reference variance = 0.234055
====================================================
  Execution time = 3.4040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3101e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330970450169
                                         uncertainty =       0.004464034602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330970450169
                                         uncertainty =       0.004464034602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406825850
  error estimate for blocks of size 2^( 2) =       0.000419867504
  error estimate for blocks of size 2^( 3) =       0.000432882413
  error estimate for blocks of size 2^( 4) =       0.000444388778
  error estimate for blocks of size 2^( 5) =       0.000456227971
  error estimate for blocks of size 2^( 6) =       0.000463783484
  error estimate for blocks of size 2^( 7) =       0.000470012977

      target function =                  N/A
              le_mean =     -16.906168315712
             les_mean =     286.149541497837
             stat err =       0.000458603302
             autocorr =       1.270741679565
              std dev =       0.575338634339
             le_variance =       0.331014544164


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616831571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906168315712       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906168315987       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906168316236       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906168316414       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906168316676       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906168316540       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906168316517       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.167304e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906168315712       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906168315781       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906168315843       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906168315887       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906168315952       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906168315921       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906168315912       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.418418e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906168315712       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906168315729       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906168315745       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906168315758       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906168315766       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906168315777       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906168315777       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.354614e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3312e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116841e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368473e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378898e-02 1 1  ON 12
 ud_3                -7.801601e-03 1 1  ON 13
 ud_4                -6.532438e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355015e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095936e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893345e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111912e-02 1 1  ON 29
eH1_0                -2.526306e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530558e-03 1 1  ON 34
eH1_5                 3.780327e-02 1 1  ON 35
eH1_6                 9.678896e-02 1 1  ON 36
eH1_7                 1.548740e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492782e-02 1 1  ON 39
eH2_0                -2.507528e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771205e-02 1 1  ON 42
eH2_3                -4.301196e-02 1 1  ON 43
eH2_4                 5.940526e-03 1 1  ON 44
eH2_5                 4.032476e-02 1 1  ON 45
eH2_6                 9.973955e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499982e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9965
    reference variance = 0.271176
====================================================
  Execution time = 3.3826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4273e-01
  Total weights = 2.0000e+06
  Execution time = 3.1317e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342807315108
                                         uncertainty =       0.004247421952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342807315108
                                         uncertainty =       0.004247421952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413962321
  error estimate for blocks of size 2^( 2) =       0.000426759313
  error estimate for blocks of size 2^( 3) =       0.000439419988
  error estimate for blocks of size 2^( 4) =       0.000451740043
  error estimate for blocks of size 2^( 5) =       0.000461684624
  error estimate for blocks of size 2^( 6) =       0.000468907474
  error estimate for blocks of size 2^( 7) =       0.000475274461

      target function =                  N/A
              le_mean =     -16.906587952546
             les_mean =     286.175445631959
             stat err =       0.000464401651
             autocorr =       1.258536696085
              std dev =       0.585431128446
             le_variance =       0.342729606154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342807222431
                                         uncertainty =       0.004247421631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342807222431
                                         uncertainty =       0.004247421631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413962265
  error estimate for blocks of size 2^( 2) =       0.000426759258
  error estimate for blocks of size 2^( 3) =       0.000439419933
  error estimate for blocks of size 2^( 4) =       0.000451739990
  error estimate for blocks of size 2^( 5) =       0.000461684574
  error estimate for blocks of size 2^( 6) =       0.000468907427
  error estimate for blocks of size 2^( 7) =       0.000475274415

      target function =                  N/A
              le_mean =     -16.906587952330
             les_mean =     286.175445531951
             stat err =       0.000464401602
             autocorr =       1.258536770427
              std dev =       0.585431049275
             le_variance =       0.342729513455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342807268756
                                         uncertainty =       0.004247421792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342807268756
                                         uncertainty =       0.004247421792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413962293
  error estimate for blocks of size 2^( 2) =       0.000426759285
  error estimate for blocks of size 2^( 3) =       0.000439419961
  error estimate for blocks of size 2^( 4) =       0.000451740017
  error estimate for blocks of size 2^( 5) =       0.000461684599
  error estimate for blocks of size 2^( 6) =       0.000468907450
  error estimate for blocks of size 2^( 7) =       0.000475274438

      target function =                  N/A
              le_mean =     -16.906587952438
             les_mean =     286.175445581936
             stat err =       0.000464401626
             autocorr =       1.258536733265
              std dev =       0.585431088849
             le_variance =       0.342729559791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342807309314
                                         uncertainty =       0.004247421932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342807309314
                                         uncertainty =       0.004247421932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413962317
  error estimate for blocks of size 2^( 2) =       0.000426759309
  error estimate for blocks of size 2^( 3) =       0.000439419985
  error estimate for blocks of size 2^( 4) =       0.000451740040
  error estimate for blocks of size 2^( 5) =       0.000461684621
  error estimate for blocks of size 2^( 6) =       0.000468907471
  error estimate for blocks of size 2^( 7) =       0.000475274458

      target function =                  N/A
              le_mean =     -16.906587952532
             les_mean =     286.175445625706
             stat err =       0.000464401648
             autocorr =       1.258536700741
              std dev =       0.585431123497
             le_variance =       0.342729600358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906587952546        initial  <--
     9.3132e+02     9.3132e+03             2.1673e-07       -16.906587952330
     3.7253e+03     3.7253e+04             5.4184e-08       -16.906587952438
     1.4901e+04     1.4901e+05             1.3546e-08       -16.906587952532

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.5895
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801597e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780330e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940525e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2909e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9225
    reference variance = 0.584391
====================================================
  Execution time = 3.4029e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4433e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344321485088
                                         uncertainty =       0.004627731423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344321485088
                                         uncertainty =       0.004627731423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414927129
  error estimate for blocks of size 2^( 2) =       0.000427443903
  error estimate for blocks of size 2^( 3) =       0.000440221368
  error estimate for blocks of size 2^( 4) =       0.000451850452
  error estimate for blocks of size 2^( 5) =       0.000461424745
  error estimate for blocks of size 2^( 6) =       0.000470656964
  error estimate for blocks of size 2^( 7) =       0.000475389355

      target function =                  N/A
              le_mean =     -16.905933805398
             les_mean =     286.154926705224
             stat err =       0.000464830379
             autocorr =       1.255004679062
              std dev =       0.586795573340
             le_variance =       0.344329044892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593380540e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933805398       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933805404       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933805393       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933805429       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933805450       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933805416       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933805438       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.494556e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933805398       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933805399       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933805397       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933805407       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933805412       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933805390       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933805412       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 6.236412e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933805398       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933805398       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933805398       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933805400       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933805396       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933805404       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933805289       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.559105e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3388e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801600e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780330e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548740e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771204e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940525e-03 1 1  ON 44
eH2_5                 4.032472e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499978e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9692
    reference variance = 0.457333
====================================================
  Execution time = 3.3324e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3384e-01
  Total weights = 2.0000e+06
  Execution time = 3.1136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333255760168
                                         uncertainty =       0.002831969693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333255760168
                                         uncertainty =       0.002831969693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408561425
  error estimate for blocks of size 2^( 2) =       0.000421561995
  error estimate for blocks of size 2^( 3) =       0.000434542321
  error estimate for blocks of size 2^( 4) =       0.000446831325
  error estimate for blocks of size 2^( 5) =       0.000458337747
  error estimate for blocks of size 2^( 6) =       0.000468418083
  error estimate for blocks of size 2^( 7) =       0.000474331153

      target function =                  N/A
              le_mean =     -16.906038437731
             les_mean =     286.147980367427
             stat err =       0.000461979577
             autocorr =       1.278588617744
              std dev =       0.577793108577
             le_variance =       0.333844876319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333255775283
                                         uncertainty =       0.002831969844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333255775283
                                         uncertainty =       0.002831969844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408561434
  error estimate for blocks of size 2^( 2) =       0.000421562004
  error estimate for blocks of size 2^( 3) =       0.000434542329
  error estimate for blocks of size 2^( 4) =       0.000446831333
  error estimate for blocks of size 2^( 5) =       0.000458337755
  error estimate for blocks of size 2^( 6) =       0.000468418091
  error estimate for blocks of size 2^( 7) =       0.000474331160

      target function =                  N/A
              le_mean =     -16.906038437639
             les_mean =     286.147980379453
             stat err =       0.000461979585
             autocorr =       1.278588603391
              std dev =       0.577793121670
             le_variance =       0.333844891450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333255767726
                                         uncertainty =       0.002831969769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333255767726
                                         uncertainty =       0.002831969769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408561430
  error estimate for blocks of size 2^( 2) =       0.000421562000
  error estimate for blocks of size 2^( 3) =       0.000434542325
  error estimate for blocks of size 2^( 4) =       0.000446831329
  error estimate for blocks of size 2^( 5) =       0.000458337751
  error estimate for blocks of size 2^( 6) =       0.000468418087
  error estimate for blocks of size 2^( 7) =       0.000474331157

      target function =                  N/A
              le_mean =     -16.906038437685
             les_mean =     286.147980373440
             stat err =       0.000461979581
             autocorr =       1.278588610571
              std dev =       0.577793115124
             le_variance =       0.333844883884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333255761113
                                         uncertainty =       0.002831969703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333255761113
                                         uncertainty =       0.002831969703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408561426
  error estimate for blocks of size 2^( 2) =       0.000421561996
  error estimate for blocks of size 2^( 3) =       0.000434542322
  error estimate for blocks of size 2^( 4) =       0.000446831326
  error estimate for blocks of size 2^( 5) =       0.000458337747
  error estimate for blocks of size 2^( 6) =       0.000468418083
  error estimate for blocks of size 2^( 7) =       0.000474331153

      target function =                  N/A
              le_mean =     -16.906038437725
             les_mean =     286.147980368179
             stat err =       0.000461979577
             autocorr =       1.278588616855
              std dev =       0.577793109395
             le_variance =       0.333844877264


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906038437731        initial  <--
     9.3132e+03     9.3132e+04             2.4946e-08       -16.906038437639
     3.7253e+04     3.7253e+05             6.2364e-09       -16.906038437685
     1.4901e+05     1.4901e+06             1.5591e-09       -16.906038437725

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.0100
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801597e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780330e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940525e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2406e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9223
    reference variance = 0.168641
====================================================
  Execution time = 3.3868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5059e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3288e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350670400562
                                         uncertainty =       0.011684220780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350670400562
                                         uncertainty =       0.011684220780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418681493
  error estimate for blocks of size 2^( 2) =       0.000431003315
  error estimate for blocks of size 2^( 3) =       0.000443770521
  error estimate for blocks of size 2^( 4) =       0.000455376965
  error estimate for blocks of size 2^( 5) =       0.000465730121
  error estimate for blocks of size 2^( 6) =       0.000471846259
  error estimate for blocks of size 2^( 7) =       0.000475621398

      target function =                  N/A
              le_mean =     -16.905513868291
             les_mean =     286.146987361241
             stat err =       0.000467143685
             autocorr =       1.244897046473
              std dev =       0.592105046057
             le_variance =       0.350588385566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690551386829e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905513868291       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905513868302       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905513868308       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905513868316       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905513868322       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905513868323       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905513868322       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905513868344       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.080752e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905513868291       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905513868294       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905513868295       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905513868297       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905513868336       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905513867836       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905513868307       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905513868103       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 5.201884e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905513868291       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905513868291       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905513868292       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905513868152       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905513868239       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905513869236       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905513867814       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905513868203       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.300470e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090455 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3204e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801597e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780330e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940526e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9648
    reference variance = 0.380406
====================================================
  Execution time = 3.4534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3881e-01
  Total weights = 2.0000e+06
  Execution time = 3.1582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338836860701
                                         uncertainty =       0.004141818476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338836860701
                                         uncertainty =       0.004141818476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411587509
  error estimate for blocks of size 2^( 2) =       0.000424241954
  error estimate for blocks of size 2^( 3) =       0.000437982826
  error estimate for blocks of size 2^( 4) =       0.000450435642
  error estimate for blocks of size 2^( 5) =       0.000462360641
  error estimate for blocks of size 2^( 6) =       0.000470127855
  error estimate for blocks of size 2^( 7) =       0.000475106714

      target function =                  N/A
              le_mean =     -16.906318481028
             les_mean =     286.162412967355
             stat err =       0.000464507713
             autocorr =       1.273683397108
              std dev =       0.582072637051
             le_variance =       0.338808554804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338836861449
                                         uncertainty =       0.004141818476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338836861449
                                         uncertainty =       0.004141818476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411587509
  error estimate for blocks of size 2^( 2) =       0.000424241954
  error estimate for blocks of size 2^( 3) =       0.000437982827
  error estimate for blocks of size 2^( 4) =       0.000450435642
  error estimate for blocks of size 2^( 5) =       0.000462360642
  error estimate for blocks of size 2^( 6) =       0.000470127855
  error estimate for blocks of size 2^( 7) =       0.000475106715

      target function =                  N/A
              le_mean =     -16.906318481029
             les_mean =     286.162412968136
             stat err =       0.000464507713
             autocorr =       1.273683396172
              std dev =       0.582072637693
             le_variance =       0.338808555551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338836861075
                                         uncertainty =       0.004141818476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338836861075
                                         uncertainty =       0.004141818476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411587509
  error estimate for blocks of size 2^( 2) =       0.000424241954
  error estimate for blocks of size 2^( 3) =       0.000437982827
  error estimate for blocks of size 2^( 4) =       0.000450435642
  error estimate for blocks of size 2^( 5) =       0.000462360642
  error estimate for blocks of size 2^( 6) =       0.000470127855
  error estimate for blocks of size 2^( 7) =       0.000475106715

      target function =                  N/A
              le_mean =     -16.906318481029
             les_mean =     286.162412967746
             stat err =       0.000464507713
             autocorr =       1.273683396646
              std dev =       0.582072637372
             le_variance =       0.338808555178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338836860748
                                         uncertainty =       0.004141818476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338836860748
                                         uncertainty =       0.004141818476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411587509
  error estimate for blocks of size 2^( 2) =       0.000424241954
  error estimate for blocks of size 2^( 3) =       0.000437982826
  error estimate for blocks of size 2^( 4) =       0.000450435642
  error estimate for blocks of size 2^( 5) =       0.000462360641
  error estimate for blocks of size 2^( 6) =       0.000470127855
  error estimate for blocks of size 2^( 7) =       0.000475106714

      target function =                  N/A
              le_mean =     -16.906318481028
             les_mean =     286.162412967404
             stat err =       0.000464507713
             autocorr =       1.273683397043
              std dev =       0.582072637092
             le_variance =       0.338808554851


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906318481028        initial
     9.3132e+04     9.3132e+05             2.0808e-09       -16.906318481029  <--
     3.7253e+05     3.7253e+06             5.2019e-10       -16.906318481029
     1.4901e+06     1.4901e+07             1.3005e-10       -16.906318481028

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 5.0287e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3500e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9068
    reference variance = 0.281358
====================================================
  Execution time = 3.4047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4244e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485411120
                                         uncertainty =       0.005172201485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485411120
                                         uncertainty =       0.005172201485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413784616
  error estimate for blocks of size 2^( 2) =       0.000426326890
  error estimate for blocks of size 2^( 3) =       0.000439000529
  error estimate for blocks of size 2^( 4) =       0.000450907487
  error estimate for blocks of size 2^( 5) =       0.000461609698
  error estimate for blocks of size 2^( 6) =       0.000469895810
  error estimate for blocks of size 2^( 7) =       0.000473839855

      target function =                  N/A
              le_mean =     -16.906007554333
             les_mean =     286.155526673170
             stat err =       0.000464063213
             autocorr =       1.257782662045
              std dev =       0.585179816153
             le_variance =       0.342435417233


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600755433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906007554333       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906007554327       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906007554300       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906007554279       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906007554295       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906007554316       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906007554302       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906007554309       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 7.277098e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906007554333       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906007554331       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906007554325       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906007554321       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906007554323       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906007554254       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906007554293       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906007554360       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 1.819276e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906007554333       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906007554332       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906007554331       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906007554333       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906007554382       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906007554321       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906007554524       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906007553742       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 4.548192e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3324e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801597e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940526e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499978e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9582
    reference variance = 0.270832
====================================================
  Execution time = 3.3588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4913e-01
  Total weights = 2.0000e+06
  Execution time = 3.1309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349208698989
                                         uncertainty =       0.006890189798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349208698989
                                         uncertainty =       0.006890189798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417812129
  error estimate for blocks of size 2^( 2) =       0.000429982989
  error estimate for blocks of size 2^( 3) =       0.000443211448
  error estimate for blocks of size 2^( 4) =       0.000455602472
  error estimate for blocks of size 2^( 5) =       0.000466537106
  error estimate for blocks of size 2^( 6) =       0.000473544923
  error estimate for blocks of size 2^( 7) =       0.000478461639

      target function =                  N/A
              le_mean =     -16.906431391601
             les_mean =     286.176556174652
             stat err =       0.000468536535
             autocorr =       1.257548769316
              std dev =       0.590875579378
             le_variance =       0.349133950305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349208699038
                                         uncertainty =       0.006890189698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349208699038
                                         uncertainty =       0.006890189698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417812129
  error estimate for blocks of size 2^( 2) =       0.000429982989
  error estimate for blocks of size 2^( 3) =       0.000443211448
  error estimate for blocks of size 2^( 4) =       0.000455602472
  error estimate for blocks of size 2^( 5) =       0.000466537106
  error estimate for blocks of size 2^( 6) =       0.000473544923
  error estimate for blocks of size 2^( 7) =       0.000478461639

      target function =                  N/A
              le_mean =     -16.906431391595
             les_mean =     286.176556174492
             stat err =       0.000468536535
             autocorr =       1.257548768397
              std dev =       0.590875579418
             le_variance =       0.349133950353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349208699014
                                         uncertainty =       0.006890189748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349208699014
                                         uncertainty =       0.006890189748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417812129
  error estimate for blocks of size 2^( 2) =       0.000429982989
  error estimate for blocks of size 2^( 3) =       0.000443211448
  error estimate for blocks of size 2^( 4) =       0.000455602472
  error estimate for blocks of size 2^( 5) =       0.000466537106
  error estimate for blocks of size 2^( 6) =       0.000473544923
  error estimate for blocks of size 2^( 7) =       0.000478461639

      target function =                  N/A
              le_mean =     -16.906431391598
             les_mean =     286.176556174572
             stat err =       0.000468536535
             autocorr =       1.257548768855
              std dev =       0.590875579398
             le_variance =       0.349133950329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349208698992
                                         uncertainty =       0.006890189792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349208698992
                                         uncertainty =       0.006890189792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417812129
  error estimate for blocks of size 2^( 2) =       0.000429982989
  error estimate for blocks of size 2^( 3) =       0.000443211448
  error estimate for blocks of size 2^( 4) =       0.000455602472
  error estimate for blocks of size 2^( 5) =       0.000466537106
  error estimate for blocks of size 2^( 6) =       0.000473544923
  error estimate for blocks of size 2^( 7) =       0.000478461639

      target function =                  N/A
              le_mean =     -16.906431391601
             les_mean =     286.176556174642
             stat err =       0.000468536535
             autocorr =       1.257548769251
              std dev =       0.590875579381
             le_variance =       0.349133950308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906431391601        initial  <--
     2.3283e+04     2.3283e+05             7.2771e-09       -16.906431391595
     9.3132e+04     9.3132e+05             1.8193e-09       -16.906431391598
     3.7253e+05     3.7253e+06             4.5482e-10       -16.906431391601

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.3528
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2686e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.313788
====================================================
  Execution time = 3.3871e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4181e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341854618907
                                         uncertainty =       0.004915511128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341854618907
                                         uncertainty =       0.004915511128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413406386
  error estimate for blocks of size 2^( 2) =       0.000425795344
  error estimate for blocks of size 2^( 3) =       0.000438788735
  error estimate for blocks of size 2^( 4) =       0.000450755279
  error estimate for blocks of size 2^( 5) =       0.000461094074
  error estimate for blocks of size 2^( 6) =       0.000467660909
  error estimate for blocks of size 2^( 7) =       0.000471392619

      target function =                  N/A
              le_mean =     -16.905909971053
             les_mean =     286.151601458561
             stat err =       0.000462725720
             autocorr =       1.252832231065
              std dev =       0.584644917971
             le_variance =       0.341809680110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590997105e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905909971053       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905909971052       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905909971053       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905909971125       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905909971078       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905909971053       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905909971010       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 8.356238e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905909971053       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905909971053       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905909971053       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905909971053       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905909961062       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905909970898       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905909970999       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.089097e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905909971053       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905909971053       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905909971053       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905909971203       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905909972827       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905909970800       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905909973061       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 5.222616e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095424 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3024e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8346
    reference variance = 0.215582
====================================================
  Execution time = 3.3095e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3723e-01
  Total weights = 2.0000e+06
  Execution time = 3.1182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337270785313
                                         uncertainty =       0.003736218552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337270785313
                                         uncertainty =       0.003736218552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410626102
  error estimate for blocks of size 2^( 2) =       0.000423485422
  error estimate for blocks of size 2^( 3) =       0.000436664915
  error estimate for blocks of size 2^( 4) =       0.000448892749
  error estimate for blocks of size 2^( 5) =       0.000460112141
  error estimate for blocks of size 2^( 6) =       0.000468491459
  error estimate for blocks of size 2^( 7) =       0.000474342440

      target function =                  N/A
              le_mean =     -16.905713438877
             les_mean =     286.140374300121
             stat err =       0.000462959697
             autocorr =       1.271139651243
              std dev =       0.580713002520
             le_variance =       0.337227591295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337270784847
                                         uncertainty =       0.003736218544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337270784847
                                         uncertainty =       0.003736218544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410626102
  error estimate for blocks of size 2^( 2) =       0.000423485422
  error estimate for blocks of size 2^( 3) =       0.000436664915
  error estimate for blocks of size 2^( 4) =       0.000448892749
  error estimate for blocks of size 2^( 5) =       0.000460112141
  error estimate for blocks of size 2^( 6) =       0.000468491459
  error estimate for blocks of size 2^( 7) =       0.000474342440

      target function =                  N/A
              le_mean =     -16.905713438876
             les_mean =     286.140374299600
             stat err =       0.000462959697
             autocorr =       1.271139651594
              std dev =       0.580713002118
             le_variance =       0.337227590829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337270785080
                                         uncertainty =       0.003736218548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337270785080
                                         uncertainty =       0.003736218548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410626102
  error estimate for blocks of size 2^( 2) =       0.000423485422
  error estimate for blocks of size 2^( 3) =       0.000436664915
  error estimate for blocks of size 2^( 4) =       0.000448892749
  error estimate for blocks of size 2^( 5) =       0.000460112141
  error estimate for blocks of size 2^( 6) =       0.000468491459
  error estimate for blocks of size 2^( 7) =       0.000474342440

      target function =                  N/A
              le_mean =     -16.905713438877
             les_mean =     286.140374299861
             stat err =       0.000462959697
             autocorr =       1.271139651424
              std dev =       0.580713002319
             le_variance =       0.337227591062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337270785284
                                         uncertainty =       0.003736218551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337270785284
                                         uncertainty =       0.003736218551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410626102
  error estimate for blocks of size 2^( 2) =       0.000423485422
  error estimate for blocks of size 2^( 3) =       0.000436664915
  error estimate for blocks of size 2^( 4) =       0.000448892749
  error estimate for blocks of size 2^( 5) =       0.000460112141
  error estimate for blocks of size 2^( 6) =       0.000468491459
  error estimate for blocks of size 2^( 7) =       0.000474342440

      target function =                  N/A
              le_mean =     -16.905713438877
             les_mean =     286.140374300089
             stat err =       0.000462959697
             autocorr =       1.271139651272
              std dev =       0.580713002494
             le_variance =       0.337227591266


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905713438877        initial  <--
     2.3283e+05     2.3283e+06             8.3562e-10       -16.905713438876
     9.3132e+05     9.3132e+06             2.0891e-10       -16.905713438877
     3.7253e+06     3.7253e+07             5.2226e-11       -16.905713438877

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.7975
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1828e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8799
    reference variance = 0.255999
====================================================
  Execution time = 3.3402e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3804e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337983855900
                                         uncertainty =       0.003994122745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337983855900
                                         uncertainty =       0.003994122745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411117511
  error estimate for blocks of size 2^( 2) =       0.000423942374
  error estimate for blocks of size 2^( 3) =       0.000436579375
  error estimate for blocks of size 2^( 4) =       0.000448864265
  error estimate for blocks of size 2^( 5) =       0.000458808476
  error estimate for blocks of size 2^( 6) =       0.000467011329
  error estimate for blocks of size 2^( 7) =       0.000473228847

      target function =                  N/A
              le_mean =     -16.906016628937
             les_mean =     286.151433303872
             stat err =       0.000461978229
             autocorr =       1.262731661309
              std dev =       0.581407959169
             le_variance =       0.338035214985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601662894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016628937       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906016628937       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906016628937       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906016629841       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906016628937       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906016629720       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906016628133       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906016627816       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.018903e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016628937       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906016628937       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906016628937       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906016628937       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906016632824       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906016636526       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906016632935       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906016624499       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.547252e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016628937       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906016628937       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906016628937       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906016625844       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906016628332       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906016628937       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906016607484       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906016663491       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 6.368144e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098096 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2450e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9258
    reference variance = 0.255268
====================================================
  Execution time = 3.2851e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3555e-01
  Total weights = 2.0000e+06
  Execution time = 3.1162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335612043322
                                         uncertainty =       0.003831377572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335612043322
                                         uncertainty =       0.003831377572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409602714
  error estimate for blocks of size 2^( 2) =       0.000422661143
  error estimate for blocks of size 2^( 3) =       0.000435282968
  error estimate for blocks of size 2^( 4) =       0.000447606311
  error estimate for blocks of size 2^( 5) =       0.000458013949
  error estimate for blocks of size 2^( 6) =       0.000467327272
  error estimate for blocks of size 2^( 7) =       0.000473297921

      target function =                  N/A
              le_mean =     -16.906226783670
             les_mean =     286.156052659823
             stat err =       0.000461561364
             autocorr =       1.269793922195
              std dev =       0.579265713384
             le_variance =       0.335548766702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335612043333
                                         uncertainty =       0.003831377573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335612043333
                                         uncertainty =       0.003831377573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409602714
  error estimate for blocks of size 2^( 2) =       0.000422661143
  error estimate for blocks of size 2^( 3) =       0.000435282968
  error estimate for blocks of size 2^( 4) =       0.000447606311
  error estimate for blocks of size 2^( 5) =       0.000458013949
  error estimate for blocks of size 2^( 6) =       0.000467327272
  error estimate for blocks of size 2^( 7) =       0.000473297921

      target function =                  N/A
              le_mean =     -16.906226783670
             les_mean =     286.156052659837
             stat err =       0.000461561364
             autocorr =       1.269793922196
              std dev =       0.579265713394
             le_variance =       0.335548766714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335612043327
                                         uncertainty =       0.003831377573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335612043327
                                         uncertainty =       0.003831377573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409602714
  error estimate for blocks of size 2^( 2) =       0.000422661143
  error estimate for blocks of size 2^( 3) =       0.000435282968
  error estimate for blocks of size 2^( 4) =       0.000447606311
  error estimate for blocks of size 2^( 5) =       0.000458013949
  error estimate for blocks of size 2^( 6) =       0.000467327272
  error estimate for blocks of size 2^( 7) =       0.000473297921

      target function =                  N/A
              le_mean =     -16.906226783670
             les_mean =     286.156052659830
             stat err =       0.000461561364
             autocorr =       1.269793922200
              std dev =       0.579265713389
             le_variance =       0.335548766708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335612043322
                                         uncertainty =       0.003831377572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335612043322
                                         uncertainty =       0.003831377572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409602714
  error estimate for blocks of size 2^( 2) =       0.000422661143
  error estimate for blocks of size 2^( 3) =       0.000435282968
  error estimate for blocks of size 2^( 4) =       0.000447606311
  error estimate for blocks of size 2^( 5) =       0.000458013949
  error estimate for blocks of size 2^( 6) =       0.000467327272
  error estimate for blocks of size 2^( 7) =       0.000473297921

      target function =                  N/A
              le_mean =     -16.906226783670
             les_mean =     286.156052659824
             stat err =       0.000461561364
             autocorr =       1.269793922201
              std dev =       0.579265713385
             le_variance =       0.335548766703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906226783670        initial
     2.3283e+06     2.3283e+07             1.0189e-10       -16.906226783670  <--
     9.3132e+06     9.3132e+07             2.5473e-11       -16.906226783670
     3.7253e+07     3.7253e+08             6.3681e-12       -16.906226783670

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 4.8545e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1002e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8873
    reference variance = 0.372011
====================================================
  Execution time = 3.6192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4525e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345283473726
                                         uncertainty =       0.010166216372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345283473726
                                         uncertainty =       0.010166216372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415481934
  error estimate for blocks of size 2^( 2) =       0.000427791142
  error estimate for blocks of size 2^( 3) =       0.000440453713
  error estimate for blocks of size 2^( 4) =       0.000451764648
  error estimate for blocks of size 2^( 5) =       0.000462538464
  error estimate for blocks of size 2^( 6) =       0.000470123213
  error estimate for blocks of size 2^( 7) =       0.000476271098

      target function =                  N/A
              le_mean =     -16.906637658237
             les_mean =     286.179647208468
             stat err =       0.000465174356
             autocorr =       1.253508380010
              std dev =       0.587580185304
             le_variance =       0.345250474162


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663765824e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906637658237       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906637658238       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906637658238       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906637658239       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906637658388       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906637658143       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906637658414       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906637658240       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 5.900187e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906637658237       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906637658238       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906637658238       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906637659385       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906637657742       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906637658367       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906637655793       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906637658461       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.475046e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906637658237       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906637658237       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906637658237       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906637654918       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906637660764       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906637663250       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906637643255       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906637661873       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 3.687609e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5343e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111908e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8733
    reference variance = 0.203818
====================================================
  Execution time = 3.3642e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3781e-01
  Total weights = 2.0000e+06
  Execution time = 3.1547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337829972452
                                         uncertainty =       0.003324314101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337829972452
                                         uncertainty =       0.003324314101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410982680
  error estimate for blocks of size 2^( 2) =       0.000423633714
  error estimate for blocks of size 2^( 3) =       0.000436463335
  error estimate for blocks of size 2^( 4) =       0.000448772233
  error estimate for blocks of size 2^( 5) =       0.000458274143
  error estimate for blocks of size 2^( 6) =       0.000466120043
  error estimate for blocks of size 2^( 7) =       0.000472711488

      target function =                  N/A
              le_mean =     -16.906678148952
             les_mean =     286.173579390619
             stat err =       0.000461469477
             autocorr =       1.260778866494
              std dev =       0.581217280599
             le_variance =       0.337813527267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337829972574
                                         uncertainty =       0.003324314102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337829972574
                                         uncertainty =       0.003324314102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410982681
  error estimate for blocks of size 2^( 2) =       0.000423633714
  error estimate for blocks of size 2^( 3) =       0.000436463335
  error estimate for blocks of size 2^( 4) =       0.000448772233
  error estimate for blocks of size 2^( 5) =       0.000458274143
  error estimate for blocks of size 2^( 6) =       0.000466120043
  error estimate for blocks of size 2^( 7) =       0.000472711488

      target function =                  N/A
              le_mean =     -16.906678148953
             les_mean =     286.173579390759
             stat err =       0.000461469477
             autocorr =       1.260778866368
              std dev =       0.581217280704
             le_variance =       0.337813527389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337829972513
                                         uncertainty =       0.003324314101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337829972513
                                         uncertainty =       0.003324314101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410982680
  error estimate for blocks of size 2^( 2) =       0.000423633714
  error estimate for blocks of size 2^( 3) =       0.000436463335
  error estimate for blocks of size 2^( 4) =       0.000448772233
  error estimate for blocks of size 2^( 5) =       0.000458274143
  error estimate for blocks of size 2^( 6) =       0.000466120043
  error estimate for blocks of size 2^( 7) =       0.000472711488

      target function =                  N/A
              le_mean =     -16.906678148952
             les_mean =     286.173579390689
             stat err =       0.000461469477
             autocorr =       1.260778866426
              std dev =       0.581217280652
             le_variance =       0.337813527328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337829972459
                                         uncertainty =       0.003324314101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337829972459
                                         uncertainty =       0.003324314101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410982680
  error estimate for blocks of size 2^( 2) =       0.000423633714
  error estimate for blocks of size 2^( 3) =       0.000436463335
  error estimate for blocks of size 2^( 4) =       0.000448772233
  error estimate for blocks of size 2^( 5) =       0.000458274143
  error estimate for blocks of size 2^( 6) =       0.000466120043
  error estimate for blocks of size 2^( 7) =       0.000472711488

      target function =                  N/A
              le_mean =     -16.906678148952
             les_mean =     286.173579390627
             stat err =       0.000461469477
             autocorr =       1.260778866486
              std dev =       0.581217280606
             le_variance =       0.337813527274


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906678148952        initial
     5.8208e+05     5.8208e+06             5.9002e-10       -16.906678148953  <--
     2.3283e+06     2.3283e+07             1.4750e-10       -16.906678148952
     9.3132e+06     9.3132e+07             3.6876e-11       -16.906678148952

*****************************************************************************
Applying the update for shift_i =   5.8208e+05     and shift_s =   5.8208e+06
*****************************************************************************

  Execution time = 4.9464e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4816e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9797
    reference variance = 0.255401
====================================================
  Execution time = 3.3718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5586e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355971597469
                                         uncertainty =       0.018772900451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355971597469
                                         uncertainty =       0.018772900451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421819107
  error estimate for blocks of size 2^( 2) =       0.000434459631
  error estimate for blocks of size 2^( 3) =       0.000446782988
  error estimate for blocks of size 2^( 4) =       0.000458095528
  error estimate for blocks of size 2^( 5) =       0.000468063978
  error estimate for blocks of size 2^( 6) =       0.000475539907
  error estimate for blocks of size 2^( 7) =       0.000480155349

      target function =                  N/A
              le_mean =     -16.906455444543
             les_mean =     286.184098238370
             stat err =       0.000470463690
             autocorr =       1.243940839450
              std dev =       0.596542301909
             le_variance =       0.355862717967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645544454e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906455444543       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906455444538       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906455444540       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906455444478       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906455444564       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906455444645       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906455444549       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906455444549       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.430093e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906455444543       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906455444542       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906455444543       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906455444584       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906455444545       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906455444534       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906455444867       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906455445003       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.575235e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906455444543       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906455444543       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906455444543       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906455445158       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906455444697       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906455444406       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906455444518       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906455445192       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 8.938086e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2969e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8709
    reference variance = 0.178821
====================================================
  Execution time = 3.3311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5075e-01
  Total weights = 2.0000e+06
  Execution time = 3.1513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350821322118
                                         uncertainty =       0.008447653337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350821322118
                                         uncertainty =       0.008447653337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418778705
  error estimate for blocks of size 2^( 2) =       0.000431692584
  error estimate for blocks of size 2^( 3) =       0.000444494711
  error estimate for blocks of size 2^( 4) =       0.000456237146
  error estimate for blocks of size 2^( 5) =       0.000466835674
  error estimate for blocks of size 2^( 6) =       0.000475365365
  error estimate for blocks of size 2^( 7) =       0.000481594169

      target function =                  N/A
              le_mean =     -16.906904541445
             les_mean =     286.194172205430
             stat err =       0.000470008089
             autocorr =       1.259625619158
              std dev =       0.592242524035
             le_variance =       0.350751207276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350821323063
                                         uncertainty =       0.008447653343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350821323063
                                         uncertainty =       0.008447653343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418778705
  error estimate for blocks of size 2^( 2) =       0.000431692584
  error estimate for blocks of size 2^( 3) =       0.000444494712
  error estimate for blocks of size 2^( 4) =       0.000456237146
  error estimate for blocks of size 2^( 5) =       0.000466835675
  error estimate for blocks of size 2^( 6) =       0.000475365366
  error estimate for blocks of size 2^( 7) =       0.000481594169

      target function =                  N/A
              le_mean =     -16.906904541439
             les_mean =     286.194172206186
             stat err =       0.000470008089
             autocorr =       1.259625618205
              std dev =       0.592242524833
             le_variance =       0.350751208220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350821322590
                                         uncertainty =       0.008447653340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350821322590
                                         uncertainty =       0.008447653340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418778705
  error estimate for blocks of size 2^( 2) =       0.000431692584
  error estimate for blocks of size 2^( 3) =       0.000444494711
  error estimate for blocks of size 2^( 4) =       0.000456237146
  error estimate for blocks of size 2^( 5) =       0.000466835674
  error estimate for blocks of size 2^( 6) =       0.000475365365
  error estimate for blocks of size 2^( 7) =       0.000481594169

      target function =                  N/A
              le_mean =     -16.906904541442
             les_mean =     286.194172205808
             stat err =       0.000470008089
             autocorr =       1.259625618686
              std dev =       0.592242524434
             le_variance =       0.350751207748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350821322177
                                         uncertainty =       0.008447653337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350821322177
                                         uncertainty =       0.008447653337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418778705
  error estimate for blocks of size 2^( 2) =       0.000431692584
  error estimate for blocks of size 2^( 3) =       0.000444494711
  error estimate for blocks of size 2^( 4) =       0.000456237146
  error estimate for blocks of size 2^( 5) =       0.000466835674
  error estimate for blocks of size 2^( 6) =       0.000475365365
  error estimate for blocks of size 2^( 7) =       0.000481594169

      target function =                  N/A
              le_mean =     -16.906904541445
             les_mean =     286.194172205477
             stat err =       0.000470008089
             autocorr =       1.259625619107
              std dev =       0.592242524085
             le_variance =       0.350751207335


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906904541445        initial  <--
     1.4552e+05     1.4552e+06             1.4301e-09       -16.906904541439
     5.8208e+05     5.8208e+06             3.5752e-10       -16.906904541442
     2.3283e+06     2.3283e+07             8.9381e-11       -16.906904541445

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.0903
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2067e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.914
    reference variance = 0.268549
====================================================
  Execution time = 3.4167e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4366e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.5625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343671810553
                                         uncertainty =       0.005381717281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343671810553
                                         uncertainty =       0.005381717281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414521084
  error estimate for blocks of size 2^( 2) =       0.000427282298
  error estimate for blocks of size 2^( 3) =       0.000440463318
  error estimate for blocks of size 2^( 4) =       0.000453564769
  error estimate for blocks of size 2^( 5) =       0.000464543371
  error estimate for blocks of size 2^( 6) =       0.000472386594
  error estimate for blocks of size 2^( 7) =       0.000475077612

      target function =                  N/A
              le_mean =     -16.906043952222
             les_mean =     286.157977400922
             stat err =       0.000466393087
             autocorr =       1.265933691151
              std dev =       0.586221338981
             le_variance =       0.343655458276


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690604395222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906043952222       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906043952222       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906043952222       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906043952583       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906043952212       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043951710       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906043949479       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906043951936       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.590621e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906043952222       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906043952222       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906043952222       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906043952594       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906043951770       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043947041       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906043952178       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906043949165       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 3.976559e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906043952222       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906043952222       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906043952222       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906043952024       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906043938185       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043920626       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906043935582       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906043944156       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 9.941149e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106115 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3737e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9164
    reference variance = 0.176752
====================================================
  Execution time = 3.3703e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4369e-01
  Total weights = 2.0000e+06
  Execution time = 3.1427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343743761916
                                         uncertainty =       0.003931772204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343743761916
                                         uncertainty =       0.003931772204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414541318
  error estimate for blocks of size 2^( 2) =       0.000426822742
  error estimate for blocks of size 2^( 3) =       0.000439662554
  error estimate for blocks of size 2^( 4) =       0.000451750049
  error estimate for blocks of size 2^( 5) =       0.000461914157
  error estimate for blocks of size 2^( 6) =       0.000469652966
  error estimate for blocks of size 2^( 7) =       0.000476840280

      target function =                  N/A
              le_mean =     -16.906627837623
             les_mean =     286.177753676641
             stat err =       0.000465039363
             autocorr =       1.258472652750
              std dev =       0.586249954036
             le_variance =       0.343689008607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343743761786
                                         uncertainty =       0.003931772204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343743761786
                                         uncertainty =       0.003931772204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414541318
  error estimate for blocks of size 2^( 2) =       0.000426822742
  error estimate for blocks of size 2^( 3) =       0.000439662554
  error estimate for blocks of size 2^( 4) =       0.000451750049
  error estimate for blocks of size 2^( 5) =       0.000461914157
  error estimate for blocks of size 2^( 6) =       0.000469652966
  error estimate for blocks of size 2^( 7) =       0.000476840280

      target function =                  N/A
              le_mean =     -16.906627837622
             les_mean =     286.177753676504
             stat err =       0.000465039363
             autocorr =       1.258472652849
              std dev =       0.586249953925
             le_variance =       0.343689008477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343743761851
                                         uncertainty =       0.003931772204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343743761851
                                         uncertainty =       0.003931772204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414541318
  error estimate for blocks of size 2^( 2) =       0.000426822742
  error estimate for blocks of size 2^( 3) =       0.000439662554
  error estimate for blocks of size 2^( 4) =       0.000451750049
  error estimate for blocks of size 2^( 5) =       0.000461914157
  error estimate for blocks of size 2^( 6) =       0.000469652966
  error estimate for blocks of size 2^( 7) =       0.000476840280

      target function =                  N/A
              le_mean =     -16.906627837623
             les_mean =     286.177753676572
             stat err =       0.000465039363
             autocorr =       1.258472652796
              std dev =       0.586249953980
             le_variance =       0.343689008542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343743761907
                                         uncertainty =       0.003931772204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343743761907
                                         uncertainty =       0.003931772204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414541318
  error estimate for blocks of size 2^( 2) =       0.000426822742
  error estimate for blocks of size 2^( 3) =       0.000439662554
  error estimate for blocks of size 2^( 4) =       0.000451750049
  error estimate for blocks of size 2^( 5) =       0.000461914157
  error estimate for blocks of size 2^( 6) =       0.000469652966
  error estimate for blocks of size 2^( 7) =       0.000476840280

      target function =                  N/A
              le_mean =     -16.906627837623
             les_mean =     286.177753676633
             stat err =       0.000465039363
             autocorr =       1.258472652751
              std dev =       0.586249954029
             le_variance =       0.343689008599


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906627837623        initial  <--
     1.4552e+06     1.4552e+07             1.5906e-10       -16.906627837622
     5.8208e+06     5.8208e+07             3.9766e-11       -16.906627837623
     2.3283e+07     2.3283e+08             9.9411e-12       -16.906627837623

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.4751
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3219e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8402
    reference variance = 0.243845
====================================================
  Execution time = 3.5869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3712e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337059685997
                                         uncertainty =       0.004158046164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337059685997
                                         uncertainty =       0.004158046164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410560605
  error estimate for blocks of size 2^( 2) =       0.000423391347
  error estimate for blocks of size 2^( 3) =       0.000436461574
  error estimate for blocks of size 2^( 4) =       0.000449275959
  error estimate for blocks of size 2^( 5) =       0.000460778260
  error estimate for blocks of size 2^( 6) =       0.000470082831
  error estimate for blocks of size 2^( 7) =       0.000477335778

      target function =                  N/A
              le_mean =     -16.906278496296
             les_mean =     286.159372447130
             stat err =       0.000464368207
             autocorr =       1.279294126356
              std dev =       0.580620376283
             le_variance =       0.337120021356


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627849630e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906278496296       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906278496296       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906278496296       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906278497769       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906278485959       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906278496887       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906278495511       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.870124e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906278496296       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906278496296       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906278496296       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906278496296       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906278492107       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906278500844       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906278487758       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 4.675323e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906278496296       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906278496296       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906278496296       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906278496289       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906278510214       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906278445617       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906278499118       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.168849e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5177e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9084
    reference variance = 0.267091
====================================================
  Execution time = 3.3398e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4667e-01
  Total weights = 2.0000e+06
  Execution time = 3.1475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346717295939
                                         uncertainty =       0.009350281160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346717295939
                                         uncertainty =       0.009350281160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416333800
  error estimate for blocks of size 2^( 2) =       0.000428681090
  error estimate for blocks of size 2^( 3) =       0.000441932657
  error estimate for blocks of size 2^( 4) =       0.000453871641
  error estimate for blocks of size 2^( 5) =       0.000464155776
  error estimate for blocks of size 2^( 6) =       0.000471334296
  error estimate for blocks of size 2^( 7) =       0.000475880429

      target function =                  N/A
              le_mean =     -16.905723546279
             les_mean =     286.150156115727
             stat err =       0.000466310535
             autocorr =       1.254489741678
              std dev =       0.588784906272
             le_variance =       0.346667665854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346717295943
                                         uncertainty =       0.009350281159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346717295943
                                         uncertainty =       0.009350281159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416333800
  error estimate for blocks of size 2^( 2) =       0.000428681090
  error estimate for blocks of size 2^( 3) =       0.000441932657
  error estimate for blocks of size 2^( 4) =       0.000453871641
  error estimate for blocks of size 2^( 5) =       0.000464155776
  error estimate for blocks of size 2^( 6) =       0.000471334296
  error estimate for blocks of size 2^( 7) =       0.000475880429

      target function =                  N/A
              le_mean =     -16.905723546279
             les_mean =     286.150156115730
             stat err =       0.000466310535
             autocorr =       1.254489741678
              std dev =       0.588784906276
             le_variance =       0.346667665858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346717295941
                                         uncertainty =       0.009350281160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346717295941
                                         uncertainty =       0.009350281160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416333800
  error estimate for blocks of size 2^( 2) =       0.000428681090
  error estimate for blocks of size 2^( 3) =       0.000441932657
  error estimate for blocks of size 2^( 4) =       0.000453871641
  error estimate for blocks of size 2^( 5) =       0.000464155776
  error estimate for blocks of size 2^( 6) =       0.000471334296
  error estimate for blocks of size 2^( 7) =       0.000475880429

      target function =                  N/A
              le_mean =     -16.905723546279
             les_mean =     286.150156115729
             stat err =       0.000466310535
             autocorr =       1.254489741683
              std dev =       0.588784906274
             le_variance =       0.346667665856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346717295939
                                         uncertainty =       0.009350281160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346717295939
                                         uncertainty =       0.009350281160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416333800
  error estimate for blocks of size 2^( 2) =       0.000428681090
  error estimate for blocks of size 2^( 3) =       0.000441932657
  error estimate for blocks of size 2^( 4) =       0.000453871641
  error estimate for blocks of size 2^( 5) =       0.000464155776
  error estimate for blocks of size 2^( 6) =       0.000471334296
  error estimate for blocks of size 2^( 7) =       0.000475880429

      target function =                  N/A
              le_mean =     -16.905723546279
             les_mean =     286.150156115727
             stat err =       0.000466310535
             autocorr =       1.254489741670
              std dev =       0.588784906273
             le_variance =       0.346667665855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905723546279        initial  <--
     1.4552e+07     1.4552e+08             1.8701e-11       -16.905723546279
     5.8208e+07     5.8208e+08             4.6753e-12       -16.905723546279
     2.3283e+08     2.3283e+09             1.1688e-12       -16.905723546279

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.2762
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4461e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8966
    reference variance = 0.350524
====================================================
  Execution time = 3.3811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3754e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.5538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337613688132
                                         uncertainty =       0.002766191964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337613688132
                                         uncertainty =       0.002766191964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410817756
  error estimate for blocks of size 2^( 2) =       0.000423502774
  error estimate for blocks of size 2^( 3) =       0.000436695469
  error estimate for blocks of size 2^( 4) =       0.000448222781
  error estimate for blocks of size 2^( 5) =       0.000458218989
  error estimate for blocks of size 2^( 6) =       0.000464910287
  error estimate for blocks of size 2^( 7) =       0.000470209899

      target function =                  N/A
              le_mean =     -16.906428071735
             les_mean =     286.164852432715
             stat err =       0.000460390489
             autocorr =       1.255897729091
              std dev =       0.580984041734
             le_variance =       0.337542456749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690642807173e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906428071735       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906428071735       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906428071735       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906428182877       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906428073818       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906428071735       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906428009692       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.385493e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906428071735       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906428071735       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906428071735       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906428085051       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906428145080       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906428086935       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906427868526       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 3.463770e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906428071735       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906428071735       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906428071735       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906428071735       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906428071735       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906427913325       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906425789944       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906429107537       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 8.742086e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3371e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8465
    reference variance = 0.184988
====================================================
  Execution time = 3.3083e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3738e-01
  Total weights = 2.0000e+06
  Execution time = 3.1481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337334365847
                                         uncertainty =       0.002901419610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337334365847
                                         uncertainty =       0.002901419610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410717368
  error estimate for blocks of size 2^( 2) =       0.000422907037
  error estimate for blocks of size 2^( 3) =       0.000436005159
  error estimate for blocks of size 2^( 4) =       0.000448588864
  error estimate for blocks of size 2^( 5) =       0.000459215101
  error estimate for blocks of size 2^( 6) =       0.000467503780
  error estimate for blocks of size 2^( 7) =       0.000472033636

      target function =                  N/A
              le_mean =     -16.906419482118
             les_mean =     286.164397049809
             stat err =       0.000461835345
             autocorr =       1.264410802206
              std dev =       0.580842072480
             le_variance =       0.337377513163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337334365846
                                         uncertainty =       0.002901419610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337334365846
                                         uncertainty =       0.002901419610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410717368
  error estimate for blocks of size 2^( 2) =       0.000422907037
  error estimate for blocks of size 2^( 3) =       0.000436005159
  error estimate for blocks of size 2^( 4) =       0.000448588864
  error estimate for blocks of size 2^( 5) =       0.000459215101
  error estimate for blocks of size 2^( 6) =       0.000467503780
  error estimate for blocks of size 2^( 7) =       0.000472033636

      target function =                  N/A
              le_mean =     -16.906419482118
             les_mean =     286.164397049808
             stat err =       0.000461835345
             autocorr =       1.264410802199
              std dev =       0.580842072480
             le_variance =       0.337377513162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337334365846
                                         uncertainty =       0.002901419610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337334365846
                                         uncertainty =       0.002901419610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410717368
  error estimate for blocks of size 2^( 2) =       0.000422907037
  error estimate for blocks of size 2^( 3) =       0.000436005159
  error estimate for blocks of size 2^( 4) =       0.000448588864
  error estimate for blocks of size 2^( 5) =       0.000459215101
  error estimate for blocks of size 2^( 6) =       0.000467503780
  error estimate for blocks of size 2^( 7) =       0.000472033636

      target function =                  N/A
              le_mean =     -16.906419482118
             les_mean =     286.164397049808
             stat err =       0.000461835345
             autocorr =       1.264410802205
              std dev =       0.580842072480
             le_variance =       0.337377513163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337334365847
                                         uncertainty =       0.002901419610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337334365847
                                         uncertainty =       0.002901419610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410717368
  error estimate for blocks of size 2^( 2) =       0.000422907037
  error estimate for blocks of size 2^( 3) =       0.000436005159
  error estimate for blocks of size 2^( 4) =       0.000448588864
  error estimate for blocks of size 2^( 5) =       0.000459215101
  error estimate for blocks of size 2^( 6) =       0.000467503780
  error estimate for blocks of size 2^( 7) =       0.000472033636

      target function =                  N/A
              le_mean =     -16.906419482118
             les_mean =     286.164397049809
             stat err =       0.000461835345
             autocorr =       1.264410802205
              std dev =       0.580842072480
             le_variance =       0.337377513163


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906419482118        initial  <--
     1.4552e+08     1.4552e+09             1.3855e-12       -16.906419482118
     5.8208e+08     5.8208e+09             3.4638e-13       -16.906419482118
     2.3283e+09     2.3283e+10             8.7421e-14       -16.906419482118

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.9638
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.2343e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8749
    reference variance = 0.20931
====================================================
  Execution time = 3.3491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4943e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349471332687
                                         uncertainty =       0.010060251603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349471332687
                                         uncertainty =       0.010060251603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417986767
  error estimate for blocks of size 2^( 2) =       0.000430567578
  error estimate for blocks of size 2^( 3) =       0.000443277313
  error estimate for blocks of size 2^( 4) =       0.000454619597
  error estimate for blocks of size 2^( 5) =       0.000464881071
  error estimate for blocks of size 2^( 6) =       0.000471982737
  error estimate for blocks of size 2^( 7) =       0.000477383269

      target function =                  N/A
              le_mean =     -16.905787394269
             les_mean =     286.155073120863
             stat err =       0.000467216668
             autocorr =       1.249429023589
              std dev =       0.591122555276
             le_variance =       0.349425875356


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578739427e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905787394269       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905787394269       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905787394269       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905787394269       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905787268384       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905787390523       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905787395409       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905786713040       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+09 is 1.675307e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905787394269       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905787394269       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905787394269       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905784798103       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905785956574       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905775981650       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799870366       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905797857323       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905778523895       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905759964038       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905758453674       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905885195186       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905953513758       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905735686397       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905905153923       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905807844888       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905982733807       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905062048760       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904813850579       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905721309236       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905450906081       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906137893458       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905274786608       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906284302169       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905372634678       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.905674528750       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905695267102       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.905466406050       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.905653588238       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.905728047500       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.905785921358       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.905025045115       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.905837476833       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.906176696716       residual = 1.77e-05           smallest_sin_value = 9.99e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 4.213700e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905787394269       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905787394269       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905787394269       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905787394269       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905799515395       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905778858859       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905782685362       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905781341377       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905771447440       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905869383443       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905650026564       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905852027472       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905849922075       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905472854146       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907127094172       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906309580946       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905838337623       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905629068750       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904460655662       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906095033826       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905285488652       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906346224864       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.908166630223       residual = 7.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908951611455       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.908024692963       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906295873922       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903923750092       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.905222598951       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.905672423759       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.904965863919       residual = 8.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.904310883910       residual = 2.75e-04           smallest_sin_value = 9.98e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 1.043629e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259506 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2984e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8679
    reference variance = 0.215647
====================================================
  Execution time = 3.3040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3488e-01
  Total weights = 2.0000e+06
  Execution time = 3.1460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334848657589
                                         uncertainty =       0.003704502497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334848657589
                                         uncertainty =       0.003704502497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409193277
  error estimate for blocks of size 2^( 2) =       0.000421736530
  error estimate for blocks of size 2^( 3) =       0.000434704112
  error estimate for blocks of size 2^( 4) =       0.000445753034
  error estimate for blocks of size 2^( 5) =       0.000455718682
  error estimate for blocks of size 2^( 6) =       0.000464296263
  error estimate for blocks of size 2^( 7) =       0.000468658838

      target function =                  N/A
              le_mean =     -16.906763248505
             les_mean =     286.173521648693
             stat err =       0.000458606704
             autocorr =       1.256098856242
              std dev =       0.578686681304
             le_variance =       0.334878275118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334848657589
                                         uncertainty =       0.003704502497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334848657589
                                         uncertainty =       0.003704502497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409193277
  error estimate for blocks of size 2^( 2) =       0.000421736530
  error estimate for blocks of size 2^( 3) =       0.000434704112
  error estimate for blocks of size 2^( 4) =       0.000445753034
  error estimate for blocks of size 2^( 5) =       0.000455718682
  error estimate for blocks of size 2^( 6) =       0.000464296263
  error estimate for blocks of size 2^( 7) =       0.000468658838

      target function =                  N/A
              le_mean =     -16.906763248505
             les_mean =     286.173521648693
             stat err =       0.000458606704
             autocorr =       1.256098856251
              std dev =       0.578686681304
             le_variance =       0.334878275118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334848657589
                                         uncertainty =       0.003704502497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334848657589
                                         uncertainty =       0.003704502497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409193277
  error estimate for blocks of size 2^( 2) =       0.000421736530
  error estimate for blocks of size 2^( 3) =       0.000434704112
  error estimate for blocks of size 2^( 4) =       0.000445753034
  error estimate for blocks of size 2^( 5) =       0.000455718682
  error estimate for blocks of size 2^( 6) =       0.000464296263
  error estimate for blocks of size 2^( 7) =       0.000468658838

      target function =                  N/A
              le_mean =     -16.906763248505
             les_mean =     286.173521648693
             stat err =       0.000458606704
             autocorr =       1.256098856249
              std dev =       0.578686681304
             le_variance =       0.334878275118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334848657589
                                         uncertainty =       0.003704502497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334848657589
                                         uncertainty =       0.003704502497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409193277
  error estimate for blocks of size 2^( 2) =       0.000421736530
  error estimate for blocks of size 2^( 3) =       0.000434704112
  error estimate for blocks of size 2^( 4) =       0.000445753034
  error estimate for blocks of size 2^( 5) =       0.000455718682
  error estimate for blocks of size 2^( 6) =       0.000464296263
  error estimate for blocks of size 2^( 7) =       0.000468658838

      target function =                  N/A
              le_mean =     -16.906763248505
             les_mean =     286.173521648693
             stat err =       0.000458606704
             autocorr =       1.256098856249
              std dev =       0.578686681303
             le_variance =       0.334878275118


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906763248505        initial
     1.4552e+09     1.4552e+10             1.6753e-13       -16.906763248505
     5.8208e+09     5.8208e+10             4.2137e-14       -16.906763248505
     2.3283e+10     2.3283e+11             1.0436e-14       -16.906763248505  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e+10     and shift_s =   2.3283e+11
*****************************************************************************

  Execution time = 4.8901e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.1892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9114
    reference variance = 0.512971
====================================================
  Execution time = 3.3619e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3640e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336452677946
                                         uncertainty =       0.003798075959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336452677946
                                         uncertainty =       0.003798075959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410124336
  error estimate for blocks of size 2^( 2) =       0.000422275899
  error estimate for blocks of size 2^( 3) =       0.000435193213
  error estimate for blocks of size 2^( 4) =       0.000446648775
  error estimate for blocks of size 2^( 5) =       0.000456142798
  error estimate for blocks of size 2^( 6) =       0.000464192082
  error estimate for blocks of size 2^( 7) =       0.000471038152

      target function =                  N/A
              le_mean =     -16.906012713350
             les_mean =     286.149669638368
             stat err =       0.000459505452
             autocorr =       1.255307881361
              std dev =       0.580003398813
             le_variance =       0.336403942635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601271335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906012713349       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906012713349       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906012713349       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906012002966       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906011505643       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906012603228       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906012712662       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906019099275       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 3.299128e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906012713349       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906012713349       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906012713350       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906012771074       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906038025378       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906009205537       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906011005703       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906010819707       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 8.268937e-15

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906012713349       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906012713349       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906012713349       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906005362892       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906041878700       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906001924619       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906029889997       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906008416904       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906077017345       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906043855171       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905979535158       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906117268542       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906088153525       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.909252753421       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904335373844       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905828630072       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.893677375765       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906589574866       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905542670668       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.904333018699       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910666081874       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.912363532953       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.900775833975       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.904930422343       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.895807269231       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.907704610788       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.927712156211       residual = 6.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.920156335953       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.900961184811       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.897525106550       residual = 9.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.893458899810       residual = 2.14e-02           smallest_sin_value = 9.99e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 2.054400e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2996e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8399
    reference variance = 0.217316
====================================================
  Execution time = 3.5171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3659e-01
  Total weights = 2.0000e+06
  Execution time = 3.1449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336590861352
                                         uncertainty =       0.003545470114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336590861352
                                         uncertainty =       0.003545470114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410239189
  error estimate for blocks of size 2^( 2) =       0.000422562575
  error estimate for blocks of size 2^( 3) =       0.000435383709
  error estimate for blocks of size 2^( 4) =       0.000446681767
  error estimate for blocks of size 2^( 5) =       0.000456779646
  error estimate for blocks of size 2^( 6) =       0.000464572315
  error estimate for blocks of size 2^( 7) =       0.000470758217

      target function =                  N/A
              le_mean =     -16.906079065395
             les_mean =     286.152101581630
             stat err =       0.000459697986
             autocorr =       1.255656683717
              std dev =       0.580165825025
             le_variance =       0.336592384527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336590861352
                                         uncertainty =       0.003545470114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336590861352
                                         uncertainty =       0.003545470114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410239189
  error estimate for blocks of size 2^( 2) =       0.000422562575
  error estimate for blocks of size 2^( 3) =       0.000435383709
  error estimate for blocks of size 2^( 4) =       0.000446681767
  error estimate for blocks of size 2^( 5) =       0.000456779646
  error estimate for blocks of size 2^( 6) =       0.000464572315
  error estimate for blocks of size 2^( 7) =       0.000470758217

      target function =                  N/A
              le_mean =     -16.906079065395
             les_mean =     286.152101581630
             stat err =       0.000459697986
             autocorr =       1.255656683714
              std dev =       0.580165825025
             le_variance =       0.336592384527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336590861352
                                         uncertainty =       0.003545470114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336590861352
                                         uncertainty =       0.003545470114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410239189
  error estimate for blocks of size 2^( 2) =       0.000422562575
  error estimate for blocks of size 2^( 3) =       0.000435383709
  error estimate for blocks of size 2^( 4) =       0.000446681767
  error estimate for blocks of size 2^( 5) =       0.000456779646
  error estimate for blocks of size 2^( 6) =       0.000464572315
  error estimate for blocks of size 2^( 7) =       0.000470758217

      target function =                  N/A
              le_mean =     -16.906079065395
             les_mean =     286.152101581630
             stat err =       0.000459697986
             autocorr =       1.255656683718
              std dev =       0.580165825025
             le_variance =       0.336592384527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336590861352
                                         uncertainty =       0.003545470114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336590861352
                                         uncertainty =       0.003545470114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410239189
  error estimate for blocks of size 2^( 2) =       0.000422562575
  error estimate for blocks of size 2^( 3) =       0.000435383709
  error estimate for blocks of size 2^( 4) =       0.000446681767
  error estimate for blocks of size 2^( 5) =       0.000456779646
  error estimate for blocks of size 2^( 6) =       0.000464572315
  error estimate for blocks of size 2^( 7) =       0.000470758217

      target function =                  N/A
              le_mean =     -16.906079065395
             les_mean =     286.152101581630
             stat err =       0.000459697986
             autocorr =       1.255656683718
              std dev =       0.580165825025
             le_variance =       0.336592384527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906079065395        initial  <--
     5.8208e+09     5.8208e+10             3.2991e-14       -16.906079065395
     2.3283e+10     2.3283e+11             8.2689e-15       -16.906079065395
     9.3132e+10     9.3132e+11             2.0544e-15       -16.906079065395

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.0200
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.112493e-01 1 1  ON 0
 uu_1                 1.438480e-01 1 1  ON 1
 uu_2                 4.181258e-02 1 1  ON 2
 uu_3                -2.116843e-02 1 1  ON 3
 uu_4                -6.720914e-02 1 1  ON 4
 uu_5                -1.024212e-01 1 1  ON 5
 uu_6                -1.301670e-01 1 1  ON 6
 uu_7                -1.439945e-01 1 1  ON 7
 uu_8                -1.368472e-01 1 1  ON 8
 uu_9                -1.068377e-01 1 1  ON 9
 ud_0                 4.504141e-01 1 1  ON 10
 ud_1                 1.844321e-01 1 1  ON 11
 ud_2                 6.378900e-02 1 1  ON 12
 ud_3                -7.801596e-03 1 1  ON 13
 ud_4                -6.532437e-02 1 1  ON 14
 ud_5                -1.074847e-01 1 1  ON 15
 ud_6                -1.355016e-01 1 1  ON 16
 ud_7                -1.522621e-01 1 1  ON 17
 ud_8                -1.533195e-01 1 1  ON 18
 ud_9                -1.446549e-01 1 1  ON 19
 eO_0                -7.587149e-01 1 1  ON 20
 eO_1                -4.368821e-01 1 1  ON 21
 eO_2                -2.095939e-02 1 1  ON 22
 eO_3                 2.976869e-01 1 1  ON 23
 eO_4                 5.257818e-01 1 1  ON 24
 eO_5                 4.893344e-01 1 1  ON 25
 eO_6                 2.622161e-01 1 1  ON 26
 eO_7                -4.035664e-02 1 1  ON 27
 eO_8                -2.247578e-01 1 1  ON 28
 eO_9                -9.111909e-02 1 1  ON 29
eH1_0                -2.526305e-01 1 1  ON 30
eH1_1                -1.489031e-01 1 1  ON 31
eH1_2                -1.002505e-01 1 1  ON 32
eH1_3                -4.528531e-02 1 1  ON 33
eH1_4                 3.530556e-03 1 1  ON 34
eH1_5                 3.780331e-02 1 1  ON 35
eH1_6                 9.678894e-02 1 1  ON 36
eH1_7                 1.548739e-01 1 1  ON 37
eH1_8                 1.824037e-01 1 1  ON 38
eH1_9                 7.492777e-02 1 1  ON 39
eH2_0                -2.507527e-01 1 1  ON 40
eH2_1                -1.465265e-01 1 1  ON 41
eH2_2                -9.771203e-02 1 1  ON 42
eH2_3                -4.301194e-02 1 1  ON 43
eH2_4                 5.940527e-03 1 1  ON 44
eH2_5                 4.032473e-02 1 1  ON 45
eH2_6                 9.973953e-02 1 1  ON 46
eH2_7                 1.560881e-01 1 1  ON 47
eH2_8                 1.867106e-01 1 1  ON 48
eH2_9                 6.499977e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4022e+01 secs
  Total Execution time = 3.7258e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
