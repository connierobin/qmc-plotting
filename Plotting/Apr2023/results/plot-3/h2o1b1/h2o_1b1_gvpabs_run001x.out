Rank =    0  Free Memory = 83783 MB
Rank =    1  Free Memory = 83783 MB
Rank =    2  Free Memory = 83783 MB
Rank =    3  Free Memory = 83783 MB
Rank =    4  Free Memory = 83782 MB
Rank =    5  Free Memory = 83782 MB
Rank =    6  Free Memory = 83782 MB
Rank =    7  Free Memory = 83782 MB
Rank =    8  Free Memory = 83782 MB
Rank =    9  Free Memory = 83781 MB
Rank =   10  Free Memory = 83780 MB
Rank =   11  Free Memory = 83780 MB
Rank =   12  Free Memory = 83780 MB
Rank =   13  Free Memory = 83779 MB
Rank =   14  Free Memory = 83779 MB
Rank =   15  Free Memory = 83766 MB
Rank =   16  Free Memory = 83766 MB
Rank =   17  Free Memory = 83766 MB
Rank =   18  Free Memory = 83766 MB
Rank =   19  Free Memory = 83766 MB
Rank =   20  Free Memory = 83766 MB
Rank =   21  Free Memory = 83766 MB
Rank =   22  Free Memory = 83766 MB
Rank =   23  Free Memory = 83766 MB
Rank =   24  Free Memory = 83766 MB
Rank =   25  Free Memory = 83766 MB
Rank =   26  Free Memory = 83766 MB
Rank =   27  Free Memory = 83766 MB
Rank =   28  Free Memory = 83766 MB
Rank =   29  Free Memory = 83766 MB
Rank =   30  Free Memory = 83766 MB
Rank =   31  Free Memory = 83766 MB
Rank =   32  Free Memory = 64945 MB
Rank =   33  Free Memory = 64945 MB
Rank =   34  Free Memory = 64945 MB
Rank =   35  Free Memory = 64945 MB
Rank =   36  Free Memory = 64945 MB
Rank =   37  Free Memory = 64945 MB
Rank =   38  Free Memory = 64945 MB
Rank =   39  Free Memory = 64945 MB
Rank =   40  Free Memory = 64945 MB
Rank =   41  Free Memory = 64945 MB
Rank =   42  Free Memory = 64945 MB
Rank =   43  Free Memory = 64945 MB
Rank =   44  Free Memory = 64945 MB
Rank =   45  Free Memory = 64945 MB
Rank =   46  Free Memory = 64945 MB
Rank =   47  Free Memory = 64945 MB
Rank =   48  Free Memory = 64945 MB
Rank =   49  Free Memory = 64945 MB
Rank =   50  Free Memory = 64945 MB
Rank =   51  Free Memory = 64945 MB
Rank =   52  Free Memory = 64945 MB
Rank =   53  Free Memory = 64945 MB
Rank =   54  Free Memory = 64945 MB
Rank =   55  Free Memory = 64945 MB
Rank =   56  Free Memory = 64945 MB
Rank =   57  Free Memory = 64945 MB
Rank =   58  Free Memory = 64944 MB
Rank =   59  Free Memory = 64944 MB
Rank =   60  Free Memory = 64944 MB
Rank =   61  Free Memory = 64944 MB
Rank =   62  Free Memory = 64944 MB
Rank =   63  Free Memory = 64944 MB
Rank =   64  Free Memory = 86424 MB
Rank =   65  Free Memory = 86424 MB
Rank =   66  Free Memory = 86424 MB
Rank =   67  Free Memory = 86424 MB
Rank =   68  Free Memory = 86424 MB
Rank =   69  Free Memory = 86424 MB
Rank =   70  Free Memory = 86424 MB
Rank =   71  Free Memory = 86424 MB
Rank =   72  Free Memory = 86424 MB
Rank =   73  Free Memory = 86423 MB
Rank =   74  Free Memory = 86423 MB
Rank =   75  Free Memory = 86423 MB
Rank =   76  Free Memory = 86423 MB
Rank =   77  Free Memory = 86423 MB
Rank =   78  Free Memory = 86423 MB
Rank =   79  Free Memory = 86423 MB
Rank =   80  Free Memory = 86423 MB
Rank =   81  Free Memory = 86423 MB
Rank =   82  Free Memory = 86423 MB
Rank =   83  Free Memory = 86423 MB
Rank =   84  Free Memory = 86423 MB
Rank =   85  Free Memory = 86423 MB
Rank =   86  Free Memory = 86423 MB
Rank =   87  Free Memory = 86423 MB
Rank =   88  Free Memory = 86423 MB
Rank =   89  Free Memory = 86423 MB
Rank =   90  Free Memory = 86423 MB
Rank =   91  Free Memory = 86423 MB
Rank =   92  Free Memory = 86423 MB
Rank =   93  Free Memory = 86423 MB
Rank =   94  Free Memory = 86423 MB
Rank =   95  Free Memory = 86423 MB
Rank =   96  Free Memory = 70999 MB
Rank =   97  Free Memory = 70999 MB
Rank =   98  Free Memory = 70999 MB
Rank =   99  Free Memory = 70999 MB
Rank =  100  Free Memory = 70999 MB
Rank =  101  Free Memory = 70999 MB
Rank =  102  Free Memory = 70999 MB
Rank =  103  Free Memory = 70999 MB
Rank =  104  Free Memory = 70999 MB
Rank =  105  Free Memory = 70999 MB
Rank =  106  Free Memory = 70999 MB
Rank =  107  Free Memory = 70999 MB
Rank =  108  Free Memory = 70999 MB
Rank =  109  Free Memory = 70999 MB
Rank =  110  Free Memory = 70999 MB
Rank =  111  Free Memory = 70999 MB
Rank =  112  Free Memory = 70999 MB
Rank =  113  Free Memory = 70999 MB
Rank =  114  Free Memory = 70999 MB
Rank =  115  Free Memory = 70999 MB
Rank =  116  Free Memory = 70999 MB
Rank =  117  Free Memory = 70999 MB
Rank =  118  Free Memory = 70999 MB
Rank =  119  Free Memory = 70999 MB
Rank =  120  Free Memory = 70999 MB
Rank =  121  Free Memory = 70999 MB
Rank =  122  Free Memory = 70999 MB
Rank =  123  Free Memory = 70999 MB
Rank =  124  Free Memory = 70999 MB
Rank =  125  Free Memory = 70999 MB
Rank =  126  Free Memory = 70999 MB
Rank =  127  Free Memory = 70999 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001x.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001x.xml

  Project = H2O
  date    = 2023-04-25 15:54:03 PDT
  host    = n0061.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 523

  Range of prime numbers to use as seeds over processors and threads = 3769-4877


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.112546e-01    1         1  ON     0
     uu_1                 1.438520e-01    1         1  ON     1
     uu_2                 4.180917e-02    1         1  ON     2
     uu_3                -2.116735e-02    1         1  ON     3
     uu_4                -6.721216e-02    1         1  ON     4
     uu_5                -1.024246e-01    1         1  ON     5
     uu_6                -1.301746e-01    1         1  ON     6
     uu_7                -1.439971e-01    1         1  ON     7
     uu_8                -1.368485e-01    1         1  ON     8
     uu_9                -1.068389e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.504177e-01    1         1  ON     0
     ud_1                 1.844348e-01    1         1  ON     1
     ud_2                 6.378291e-02    1         1  ON     2
     ud_3                -7.801669e-03    1         1  ON     3
     ud_4                -6.532610e-02    1         1  ON     4
     ud_5                -1.074863e-01    1         1  ON     5
     ud_6                -1.355021e-01    1         1  ON     6
     ud_7                -1.522620e-01    1         1  ON     7
     ud_8                -1.533181e-01    1         1  ON     8
     ud_9                -1.446516e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.587170e-01    1         1  ON     0
     eO_1                -4.368766e-01    1         1  ON     1
     eO_2                -2.095645e-02    1         1  ON     2
     eO_3                 2.976861e-01    1         1  ON     3
     eO_4                 5.257810e-01    1         1  ON     4
     eO_5                 4.893323e-01    1         1  ON     5
     eO_6                 2.622174e-01    1         1  ON     6
     eO_7                -4.035154e-02    1         1  ON     7
     eO_8                -2.247603e-01    1         1  ON     8
     eO_9                -9.112497e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.526402e-01    1         1  ON     0
     eH1_1                -1.489061e-01    1         1  ON     1
     eH1_2                -1.002493e-01    1         1  ON     2
     eH1_3                -4.528759e-02    1         1  ON     3
     eH1_4                 3.528862e-03    1         1  ON     4
     eH1_5                 3.780026e-02    1         1  ON     5
     eH1_6                 9.678964e-02    1         1  ON     6
     eH1_7                 1.548725e-01    1         1  ON     7
     eH1_8                 1.824106e-01    1         1  ON     8
     eH1_9                 7.493813e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.507586e-01    1         1  ON     0
     eH2_1                -1.465311e-01    1         1  ON     1
     eH2_2                -9.771999e-02    1         1  ON     2
     eH2_3                -4.301310e-02    1         1  ON     3
     eH2_4                 5.944044e-03    1         1  ON     4
     eH2_5                 4.032358e-02    1         1  ON     5
     eH2_6                 9.974133e-02    1         1  ON     6
     eH2_7                 1.560912e-01    1         1  ON     7
     eH2_8                 1.867146e-01    1         1  ON     8
     eH2_9                 6.500792e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.256095e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.1500e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8232
    reference variance = 0.918629
====================================================
  Execution time = 2.1228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4282e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342787264358
                                         uncertainty =       0.005074282788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342787264358
                                         uncertainty =       0.005074282788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414019213
  error estimate for blocks of size 2^( 2) =       0.000426329920
  error estimate for blocks of size 2^( 3) =       0.000439470630
  error estimate for blocks of size 2^( 4) =       0.000451536890
  error estimate for blocks of size 2^( 5) =       0.000462039472
  error estimate for blocks of size 2^( 6) =       0.000471173341
  error estimate for blocks of size 2^( 7) =       0.000477246170

      target function =                  N/A
              le_mean =     -16.905866555953
             les_mean =     286.151147653911
             stat err =       0.000465498968
             autocorr =       1.264143726776
              std dev =       0.585511586255
             le_variance =       0.342823817639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690586655595e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905866555953       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905867617235       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905867994357       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905868540512       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905869347463       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905870406755       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905870675889       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905870981989       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905870484716       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905870699202       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905870561588       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.123374e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905866555953       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905866948615       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905867015828       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905867076657       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905867451796       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905867944025       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905867828406       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905867849922       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.228803e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905866555953       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905866667503       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905866680321       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905866684788       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905866810342       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905866944296       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905866915249       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905866904738       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.660992e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6920e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.111506e-01                 1 1 ON  0
uu_1  1.438653e-01                 1 1 ON  1
uu_2  4.179344e-02                 1 1 ON  2
uu_3  -2.124063e-02                1 1 ON  3
uu_4  -6.718082e-02                1 1 ON  4
uu_5  -1.024815e-01                1 1 ON  5
uu_6  -1.302124e-01                1 1 ON  6
uu_7  -1.439941e-01                1 1 ON  7
uu_8  -1.368368e-01                1 1 ON  8
uu_9  -1.067760e-01                1 1 ON  9
ud_0  4.504243e-01                 1 1 ON  10
ud_1  1.843860e-01                 1 1 ON  11
ud_2  6.377173e-02                 1 1 ON  12
ud_3  -7.843040e-03                1 1 ON  13
ud_4  -6.539477e-02                1 1 ON  14
ud_5  -1.075303e-01                1 1 ON  15
ud_6  -1.355607e-01                1 1 ON  16
ud_7  -1.523527e-01                1 1 ON  17
ud_8  -1.532280e-01                1 1 ON  18
ud_9  -1.444745e-01                1 1 ON  19
eO_0  -7.585446e-01                1 1 ON  20
eO_1  -4.368564e-01                1 1 ON  21
eO_2  -2.100743e-02                1 1 ON  22
eO_3  2.975529e-01                 1 1 ON  23
eO_4  5.257641e-01                 1 1 ON  24
eO_5  4.894122e-01                 1 1 ON  25
eO_6  2.622852e-01                 1 1 ON  26
eO_7  -4.035710e-02                1 1 ON  27
eO_8  -2.247981e-01                1 1 ON  28
eO_9  -9.120038e-02                1 1 ON  29
eH1_0 -2.528332e-01                1 1 ON  30
eH1_1 -1.490291e-01                1 1 ON  31
eH1_2 -1.003690e-01                1 1 ON  32
eH1_3 -4.533155e-02                1 1 ON  33
eH1_4 3.555555e-03                 1 1 ON  34
eH1_5 3.776523e-02                 1 1 ON  35
eH1_6 9.671693e-02                 1 1 ON  36
eH1_7 1.549657e-01                 1 1 ON  37
eH1_8 1.826335e-01                 1 1 ON  38
eH1_9 7.515864e-02                 1 1 ON  39
eH2_0 -2.509514e-01                1 1 ON  40
eH2_1 -1.466315e-01                1 1 ON  41
eH2_2 -9.778424e-02                1 1 ON  42
eH2_3 -4.296486e-02                1 1 ON  43
eH2_4 6.038673e-03                 1 1 ON  44
eH2_5 4.021368e-02                 1 1 ON  45
eH2_6 9.973867e-02                 1 1 ON  46
eH2_7 1.560831e-01                 1 1 ON  47
eH2_8 1.867902e-01                 1 1 ON  48
eH2_9 6.521425e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8749
    reference variance = 0.209246
====================================================
  Execution time = 2.0105e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3598e-01
  Total weights = 2.0000e+06
  Execution time = 1.8844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336017204374
                                         uncertainty =       0.003783861614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336017204374
                                         uncertainty =       0.003783861614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409863074
  error estimate for blocks of size 2^( 2) =       0.000423123674
  error estimate for blocks of size 2^( 3) =       0.000436269930
  error estimate for blocks of size 2^( 4) =       0.000449406675
  error estimate for blocks of size 2^( 5) =       0.000460264109
  error estimate for blocks of size 2^( 6) =       0.000468302537
  error estimate for blocks of size 2^( 7) =       0.000471498512

      target function =                  N/A
              le_mean =     -16.906133090166
             les_mean =     286.153311373872
             stat err =       0.000462367958
             autocorr =       1.272617449745
              std dev =       0.579633918469
             le_variance =       0.335975479439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335997185734
                                         uncertainty =       0.003783600475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335997185734
                                         uncertainty =       0.003783600475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409850855
  error estimate for blocks of size 2^( 2) =       0.000423112128
  error estimate for blocks of size 2^( 3) =       0.000436258764
  error estimate for blocks of size 2^( 4) =       0.000449398077
  error estimate for blocks of size 2^( 5) =       0.000460256729
  error estimate for blocks of size 2^( 6) =       0.000468287489
  error estimate for blocks of size 2^( 7) =       0.000471473198

      target function =                  N/A
              le_mean =     -16.906132667847
             les_mean =     286.153277061829
             stat err =       0.000462353873
             autocorr =       1.272615795710
              std dev =       0.579616637920
             le_variance =       0.335955446953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336026830841
                                         uncertainty =       0.003783848407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336026830841
                                         uncertainty =       0.003783848407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409868937
  error estimate for blocks of size 2^( 2) =       0.000423128988
  error estimate for blocks of size 2^( 3) =       0.000436274261
  error estimate for blocks of size 2^( 4) =       0.000449412078
  error estimate for blocks of size 2^( 5) =       0.000460270183
  error estimate for blocks of size 2^( 6) =       0.000468302643
  error estimate for blocks of size 2^( 7) =       0.000471492313

      target function =                  N/A
              le_mean =     -16.906132655941
             les_mean =     286.153306303288
             stat err =       0.000462369304
             autocorr =       1.272588452024
              std dev =       0.579642209463
             le_variance =       0.335985090992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336020827480
                                         uncertainty =       0.003783888905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336020827480
                                         uncertainty =       0.003783888905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409865283
  error estimate for blocks of size 2^( 2) =       0.000423125738
  error estimate for blocks of size 2^( 3) =       0.000436271773
  error estimate for blocks of size 2^( 4) =       0.000449408637
  error estimate for blocks of size 2^( 5) =       0.000460266144
  error estimate for blocks of size 2^( 6) =       0.000468303651
  error estimate for blocks of size 2^( 7) =       0.000471498727

      target function =                  N/A
              le_mean =     -16.906132993492
             les_mean =     286.153311725970
             stat err =       0.000462369290
             autocorr =       1.272611064307
              std dev =       0.579637041888
             le_variance =       0.335979100329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906133090166        initial  <--
     2.5000e-01     2.5000e+00             9.1234e-04       -16.906132667847
     1.0000e+00     1.0000e+01             2.2288e-04       -16.906132655941
     4.0000e+00     4.0000e+01             5.6610e-05       -16.906132993492

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5676
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.112546e-01 1 1  ON 0
 uu_1                 1.438520e-01 1 1  ON 1
 uu_2                 4.180917e-02 1 1  ON 2
 uu_3                -2.116735e-02 1 1  ON 3
 uu_4                -6.721216e-02 1 1  ON 4
 uu_5                -1.024246e-01 1 1  ON 5
 uu_6                -1.301746e-01 1 1  ON 6
 uu_7                -1.439971e-01 1 1  ON 7
 uu_8                -1.368485e-01 1 1  ON 8
 uu_9                -1.068389e-01 1 1  ON 9
 ud_0                 4.504177e-01 1 1  ON 10
 ud_1                 1.844348e-01 1 1  ON 11
 ud_2                 6.378291e-02 1 1  ON 12
 ud_3                -7.801669e-03 1 1  ON 13
 ud_4                -6.532610e-02 1 1  ON 14
 ud_5                -1.074863e-01 1 1  ON 15
 ud_6                -1.355021e-01 1 1  ON 16
 ud_7                -1.522620e-01 1 1  ON 17
 ud_8                -1.533181e-01 1 1  ON 18
 ud_9                -1.446516e-01 1 1  ON 19
 eO_0                -7.587170e-01 1 1  ON 20
 eO_1                -4.368766e-01 1 1  ON 21
 eO_2                -2.095645e-02 1 1  ON 22
 eO_3                 2.976861e-01 1 1  ON 23
 eO_4                 5.257810e-01 1 1  ON 24
 eO_5                 4.893323e-01 1 1  ON 25
 eO_6                 2.622174e-01 1 1  ON 26
 eO_7                -4.035154e-02 1 1  ON 27
 eO_8                -2.247603e-01 1 1  ON 28
 eO_9                -9.112497e-02 1 1  ON 29
eH1_0                -2.526402e-01 1 1  ON 30
eH1_1                -1.489061e-01 1 1  ON 31
eH1_2                -1.002493e-01 1 1  ON 32
eH1_3                -4.528759e-02 1 1  ON 33
eH1_4                 3.528862e-03 1 1  ON 34
eH1_5                 3.780026e-02 1 1  ON 35
eH1_6                 9.678964e-02 1 1  ON 36
eH1_7                 1.548725e-01 1 1  ON 37
eH1_8                 1.824106e-01 1 1  ON 38
eH1_9                 7.493813e-02 1 1  ON 39
eH2_0                -2.507586e-01 1 1  ON 40
eH2_1                -1.465311e-01 1 1  ON 41
eH2_2                -9.771999e-02 1 1  ON 42
eH2_3                -4.301310e-02 1 1  ON 43
eH2_4                 5.944044e-03 1 1  ON 44
eH2_5                 4.032358e-02 1 1  ON 45
eH2_6                 9.974133e-02 1 1  ON 46
eH2_7                 1.560912e-01 1 1  ON 47
eH2_8                 1.867146e-01 1 1  ON 48
eH2_9                 6.500792e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6496e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6849e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8875
    reference variance = 0.353031
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4406e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5570e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344091433009
                                         uncertainty =       0.005406658959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344091433009
                                         uncertainty =       0.005406658959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414763702
  error estimate for blocks of size 2^( 2) =       0.000426905991
  error estimate for blocks of size 2^( 3) =       0.000439534359
  error estimate for blocks of size 2^( 4) =       0.000450198478
  error estimate for blocks of size 2^( 5) =       0.000459695908
  error estimate for blocks of size 2^( 6) =       0.000466379406
  error estimate for blocks of size 2^( 7) =       0.000469973130

      target function =                  N/A
              le_mean =     -16.906683702394
             les_mean =     286.180011498109
             stat err =       0.000461561731
             autocorr =       1.238391895708
              std dev =       0.586564452846
             le_variance =       0.344057857342


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690668370239e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906683702394       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906684472525       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906684685958       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906684815217       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906684752755       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906684788924       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906684928860       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906684933845       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 7.178119e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906683702394       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906683905285       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906683967756       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906684000541       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906683983326       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906683993440       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906684028764       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906684029352       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.851753e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906683702394       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906683753808       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906683770082       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906683778306       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906683773916       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906683776541       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906683785370       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906683785490       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 4.668658e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149442 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5936e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.112597e-01 1 1  ON 0
 uu_1                 1.438592e-01 1 1  ON 1
 uu_2                 4.180872e-02 1 1  ON 2
 uu_3                -2.117298e-02 1 1  ON 3
 uu_4                -6.720294e-02 1 1  ON 4
 uu_5                -1.024236e-01 1 1  ON 5
 uu_6                -1.301761e-01 1 1  ON 6
 uu_7                -1.439965e-01 1 1  ON 7
 uu_8                -1.368577e-01 1 1  ON 8
 uu_9                -1.068530e-01 1 1  ON 9
 ud_0                 4.504103e-01 1 1  ON 10
 ud_1                 1.844524e-01 1 1  ON 11
 ud_2                 6.379471e-02 1 1  ON 12
 ud_3                -7.793031e-03 1 1  ON 13
 ud_4                -6.532216e-02 1 1  ON 14
 ud_5                -1.074850e-01 1 1  ON 15
 ud_6                -1.354897e-01 1 1  ON 16
 ud_7                -1.522766e-01 1 1  ON 17
 ud_8                -1.533320e-01 1 1  ON 18
 ud_9                -1.446623e-01 1 1  ON 19
 eO_0                -7.586985e-01 1 1  ON 20
 eO_1                -4.368670e-01 1 1  ON 21
 eO_2                -2.095395e-02 1 1  ON 22
 eO_3                 2.976778e-01 1 1  ON 23
 eO_4                 5.257765e-01 1 1  ON 24
 eO_5                 4.893372e-01 1 1  ON 25
 eO_6                 2.622289e-01 1 1  ON 26
 eO_7                -4.035119e-02 1 1  ON 27
 eO_8                -2.247766e-01 1 1  ON 28
 eO_9                -9.113995e-02 1 1  ON 29
eH1_0                -2.526541e-01 1 1  ON 30
eH1_1                -1.489206e-01 1 1  ON 31
eH1_2                -1.002441e-01 1 1  ON 32
eH1_3                -4.529077e-02 1 1  ON 33
eH1_4                 3.530698e-03 1 1  ON 34
eH1_5                 3.780023e-02 1 1  ON 35
eH1_6                 9.679461e-02 1 1  ON 36
eH1_7                 1.548667e-01 1 1  ON 37
eH1_8                 1.824214e-01 1 1  ON 38
eH1_9                 7.495319e-02 1 1  ON 39
eH2_0                -2.507656e-01 1 1  ON 40
eH2_1                -1.465324e-01 1 1  ON 41
eH2_2                -9.772596e-02 1 1  ON 42
eH2_3                -4.301309e-02 1 1  ON 43
eH2_4                 5.944949e-03 1 1  ON 44
eH2_5                 4.031539e-02 1 1  ON 45
eH2_6                 9.973121e-02 1 1  ON 46
eH2_7                 1.560956e-01 1 1  ON 47
eH2_8                 1.867261e-01 1 1  ON 48
eH2_9                 6.502503e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.993
    reference variance = 0.458387
====================================================
  Execution time = 1.9906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4176e-01
  Total weights = 2.0000e+06
  Execution time = 1.8905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341704562904
                                         uncertainty =       0.004665178034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341704562904
                                         uncertainty =       0.004665178034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413383529
  error estimate for blocks of size 2^( 2) =       0.000426066253
  error estimate for blocks of size 2^( 3) =       0.000439241409
  error estimate for blocks of size 2^( 4) =       0.000451572496
  error estimate for blocks of size 2^( 5) =       0.000462541650
  error estimate for blocks of size 2^( 6) =       0.000470890420
  error estimate for blocks of size 2^( 7) =       0.000477723945

      target function =                  N/A
              le_mean =     -16.906293097994
             les_mean =     286.164518028880
             stat err =       0.000465682128
             autocorr =       1.269032673244
              std dev =       0.584612593505
             le_variance =       0.341771884484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341647194593
                                         uncertainty =       0.004663639589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341647194593
                                         uncertainty =       0.004663639589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413348843
  error estimate for blocks of size 2^( 2) =       0.000426032384
  error estimate for blocks of size 2^( 3) =       0.000439208327
  error estimate for blocks of size 2^( 4) =       0.000451539771
  error estimate for blocks of size 2^( 5) =       0.000462510963
  error estimate for blocks of size 2^( 6) =       0.000470861637
  error estimate for blocks of size 2^( 7) =       0.000477698007

      target function =                  N/A
              le_mean =     -16.906293104364
             les_mean =     286.164460891313
             stat err =       0.000465652594
             autocorr =       1.269084680305
              std dev =       0.584563539333
             le_variance =       0.341714531517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341671567242
                                         uncertainty =       0.004664284302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341671567242
                                         uncertainty =       0.004664284302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413363579
  error estimate for blocks of size 2^( 2) =       0.000426046814
  error estimate for blocks of size 2^( 3) =       0.000439222464
  error estimate for blocks of size 2^( 4) =       0.000451553779
  error estimate for blocks of size 2^( 5) =       0.000462524043
  error estimate for blocks of size 2^( 6) =       0.000470873842
  error estimate for blocks of size 2^( 7) =       0.000477708905

      target function =                  N/A
              le_mean =     -16.906293090569
             les_mean =     286.164484790966
             stat err =       0.000465665142
             autocorr =       1.269062587127
              std dev =       0.584584380234
             le_variance =       0.341738897613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341700277520
                                         uncertainty =       0.004665061791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341700277520
                                         uncertainty =       0.004665061791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413380938
  error estimate for blocks of size 2^( 2) =       0.000426063730
  error estimate for blocks of size 2^( 3) =       0.000439238950
  error estimate for blocks of size 2^( 4) =       0.000451570068
  error estimate for blocks of size 2^( 5) =       0.000462539363
  error estimate for blocks of size 2^( 6) =       0.000470888265
  error estimate for blocks of size 2^( 7) =       0.000477721986

      target function =                  N/A
              le_mean =     -16.906293095880
             les_mean =     286.164513673151
             stat err =       0.000465679920
             autocorr =       1.269036550604
              std dev =       0.584608929315
             le_variance =       0.341767600235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906293097994        initial
     2.5000e+00     2.5000e+01             7.1781e-05       -16.906293104364  <--
     1.0000e+01     1.0000e+02             1.8518e-05       -16.906293090569
     4.0000e+01     4.0000e+02             4.6687e-06       -16.906293095880

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.9409e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.112750e-01 1 1  ON 0
 uu_1                 1.438782e-01 1 1  ON 1
 uu_2                 4.180922e-02 1 1  ON 2
 uu_3                -2.118645e-02 1 1  ON 3
 uu_4                -6.717870e-02 1 1  ON 4
 uu_5                -1.024199e-01 1 1  ON 5
 uu_6                -1.301802e-01 1 1  ON 6
 uu_7                -1.439946e-01 1 1  ON 7
 uu_8                -1.368853e-01 1 1  ON 8
 uu_9                -1.068952e-01 1 1  ON 9
 ud_0                 4.503962e-01 1 1  ON 10
 ud_1                 1.844990e-01 1 1  ON 11
 ud_2                 6.382868e-02 1 1  ON 12
 ud_3                -7.768570e-03 1 1  ON 13
 ud_4                -6.530888e-02 1 1  ON 14
 ud_5                -1.074814e-01 1 1  ON 15
 ud_6                -1.354557e-01 1 1  ON 16
 ud_7                -1.523182e-01 1 1  ON 17
 ud_8                -1.533734e-01 1 1  ON 18
 ud_9                -1.446944e-01 1 1  ON 19
 eO_0                -7.586452e-01 1 1  ON 20
 eO_1                -4.368360e-01 1 1  ON 21
 eO_2                -2.094647e-02 1 1  ON 22
 eO_3                 2.976521e-01 1 1  ON 23
 eO_4                 5.257631e-01 1 1  ON 24
 eO_5                 4.893515e-01 1 1  ON 25
 eO_6                 2.622630e-01 1 1  ON 26
 eO_7                -4.035016e-02 1 1  ON 27
 eO_8                -2.248252e-01 1 1  ON 28
 eO_9                -9.118437e-02 1 1  ON 29
eH1_0                -2.526955e-01 1 1  ON 30
eH1_1                -1.489610e-01 1 1  ON 31
eH1_2                -1.002314e-01 1 1  ON 32
eH1_3                -4.529919e-02 1 1  ON 33
eH1_4                 3.536047e-03 1 1  ON 34
eH1_5                 3.780023e-02 1 1  ON 35
eH1_6                 9.680926e-02 1 1  ON 36
eH1_7                 1.548497e-01 1 1  ON 37
eH1_8                 1.824533e-01 1 1  ON 38
eH1_9                 7.499766e-02 1 1  ON 39
eH2_0                -2.507862e-01 1 1  ON 40
eH2_1                -1.465372e-01 1 1  ON 41
eH2_2                -9.774243e-02 1 1  ON 42
eH2_3                -4.301339e-02 1 1  ON 43
eH2_4                 5.947871e-03 1 1  ON 44
eH2_5                 4.029138e-02 1 1  ON 45
eH2_6                 9.970093e-02 1 1  ON 46
eH2_7                 1.561086e-01 1 1  ON 47
eH2_8                 1.867602e-01 1 1  ON 48
eH2_9                 6.507563e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5354e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9147
    reference variance = 0.488714
====================================================
  Execution time = 2.0548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4338e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343482028922
                                         uncertainty =       0.003892000069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343482028922
                                         uncertainty =       0.003892000069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414352383
  error estimate for blocks of size 2^( 2) =       0.000427080477
  error estimate for blocks of size 2^( 3) =       0.000440150750
  error estimate for blocks of size 2^( 4) =       0.000452310515
  error estimate for blocks of size 2^( 5) =       0.000462244586
  error estimate for blocks of size 2^( 6) =       0.000470648283
  error estimate for blocks of size 2^( 7) =       0.000474740130

      target function =                  N/A
              le_mean =     -16.906455176139
             les_mean =     286.171602245385
             stat err =       0.000464985878
             autocorr =       1.259330860192
              std dev =       0.585982759375
             le_variance =       0.343375794285


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645517614e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906455176139       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906456989514       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906457149102       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906456947710       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906457121709       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906457130703       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906457222186       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906457455000       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.991800e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906455176139       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906455713333       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906455743774       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906455690396       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906455737746       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906455760733       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906455747187       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906455801250       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.050271e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906455176139       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906455316948       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906455323839       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906455310731       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906455322561       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906455329047       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906455324712       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906455337587       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.663106e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152129 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6101e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.113025e-01 1 1  ON 0
 uu_1                 1.439068e-01 1 1  ON 1
 uu_2                 4.185074e-02 1 1  ON 2
 uu_3                -2.116954e-02 1 1  ON 3
 uu_4                -6.718861e-02 1 1  ON 4
 uu_5                -1.024603e-01 1 1  ON 5
 uu_6                -1.302361e-01 1 1  ON 6
 uu_7                -1.440311e-01 1 1  ON 7
 uu_8                -1.369105e-01 1 1  ON 8
 uu_9                -1.069070e-01 1 1  ON 9
 ud_0                 4.503758e-01 1 1  ON 10
 ud_1                 1.844813e-01 1 1  ON 11
 ud_2                 6.382168e-02 1 1  ON 12
 ud_3                -7.770530e-03 1 1  ON 13
 ud_4                -6.530424e-02 1 1  ON 14
 ud_5                -1.074683e-01 1 1  ON 15
 ud_6                -1.354564e-01 1 1  ON 16
 ud_7                -1.523315e-01 1 1  ON 17
 ud_8                -1.533514e-01 1 1  ON 18
 ud_9                -1.446531e-01 1 1  ON 19
 eO_0                -7.585720e-01 1 1  ON 20
 eO_1                -4.367931e-01 1 1  ON 21
 eO_2                -2.096606e-02 1 1  ON 22
 eO_3                 2.976399e-01 1 1  ON 23
 eO_4                 5.257493e-01 1 1  ON 24
 eO_5                 4.893213e-01 1 1  ON 25
 eO_6                 2.622818e-01 1 1  ON 26
 eO_7                -4.033204e-02 1 1  ON 27
 eO_8                -2.248576e-01 1 1  ON 28
 eO_9                -9.122408e-02 1 1  ON 29
eH1_0                -2.528006e-01 1 1  ON 30
eH1_1                -1.489913e-01 1 1  ON 31
eH1_2                -1.002481e-01 1 1  ON 32
eH1_3                -4.533180e-02 1 1  ON 33
eH1_4                 3.541707e-03 1 1  ON 34
eH1_5                 3.780559e-02 1 1  ON 35
eH1_6                 9.680705e-02 1 1  ON 36
eH1_7                 1.548597e-01 1 1  ON 37
eH1_8                 1.825135e-01 1 1  ON 38
eH1_9                 7.508791e-02 1 1  ON 39
eH2_0                -2.508358e-01 1 1  ON 40
eH2_1                -1.465784e-01 1 1  ON 41
eH2_2                -9.774059e-02 1 1  ON 42
eH2_3                -4.301548e-02 1 1  ON 43
eH2_4                 5.923298e-03 1 1  ON 44
eH2_5                 4.029062e-02 1 1  ON 45
eH2_6                 9.969677e-02 1 1  ON 46
eH2_7                 1.561189e-01 1 1  ON 47
eH2_8                 1.867929e-01 1 1  ON 48
eH2_9                 6.514252e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.988
    reference variance = 0.408084
====================================================
  Execution time = 2.2329e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4203e-01
  Total weights = 2.0000e+06
  Execution time = 1.8880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342037211156
                                         uncertainty =       0.003711260435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342037211156
                                         uncertainty =       0.003711260435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413553860
  error estimate for blocks of size 2^( 2) =       0.000426039566
  error estimate for blocks of size 2^( 3) =       0.000439396992
  error estimate for blocks of size 2^( 4) =       0.000451379412
  error estimate for blocks of size 2^( 5) =       0.000462958822
  error estimate for blocks of size 2^( 6) =       0.000467819845
  error estimate for blocks of size 2^( 7) =       0.000469393618

      target function =                  N/A
              le_mean =     -16.905405384533
             les_mean =     286.134784635376
             stat err =       0.000462887924
             autocorr =       1.252816728705
              std dev =       0.584853478239
             le_variance =       0.342053591008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341959593384
                                         uncertainty =       0.003710398176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341959593384
                                         uncertainty =       0.003710398176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413506932
  error estimate for blocks of size 2^( 2) =       0.000425994050
  error estimate for blocks of size 2^( 3) =       0.000439353353
  error estimate for blocks of size 2^( 4) =       0.000451338800
  error estimate for blocks of size 2^( 5) =       0.000462921057
  error estimate for blocks of size 2^( 6) =       0.000467785792
  error estimate for blocks of size 2^( 7) =       0.000469360570

      target function =                  N/A
              le_mean =     -16.905405974806
             les_mean =     286.134726967468
             stat err =       0.000462851555
             autocorr =       1.252904199670
              std dev =       0.584787111229
             le_variance =       0.341975965460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341993097226
                                         uncertainty =       0.003710730114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341993097226
                                         uncertainty =       0.003710730114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413527191
  error estimate for blocks of size 2^( 2) =       0.000426013663
  error estimate for blocks of size 2^( 3) =       0.000439372205
  error estimate for blocks of size 2^( 4) =       0.000451356527
  error estimate for blocks of size 2^( 5) =       0.000462937587
  error estimate for blocks of size 2^( 6) =       0.000467800886
  error estimate for blocks of size 2^( 7) =       0.000469375219

      target function =                  N/A
              le_mean =     -16.905405728159
             les_mean =     286.134752137520
             stat err =       0.000462867555
             autocorr =       1.252868056387
              std dev =       0.584815761457
             le_variance =       0.342009474849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342031393029
                                         uncertainty =       0.003711188722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342031393029
                                         uncertainty =       0.003711188722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413550343
  error estimate for blocks of size 2^( 2) =       0.000426036148
  error estimate for blocks of size 2^( 3) =       0.000439393720
  error estimate for blocks of size 2^( 4) =       0.000451376396
  error estimate for blocks of size 2^( 5) =       0.000462956020
  error estimate for blocks of size 2^( 6) =       0.000467817341
  error estimate for blocks of size 2^( 7) =       0.000469391187

      target function =                  N/A
              le_mean =     -16.905405423398
             les_mean =     286.134780131188
             stat err =       0.000462885236
             autocorr =       1.252823488469
              std dev =       0.584848504114
             le_variance =       0.342047772765


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905405384533        initial
     6.2500e-01     6.2500e+00             3.9918e-04       -16.905405974806  <--
     2.5000e+00     2.5000e+01             1.0503e-04       -16.905405728159
     1.0000e+01     1.0000e+02             2.6631e-05       -16.905405423398

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.1828e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.113879e-01 1 1  ON 0
 uu_1                 1.439879e-01 1 1  ON 1
 uu_2                 4.195044e-02 1 1  ON 2
 uu_3                -2.112211e-02 1 1  ON 3
 uu_4                -6.721177e-02 1 1  ON 4
 uu_5                -1.025581e-01 1 1  ON 5
 uu_6                -1.303957e-01 1 1  ON 6
 uu_7                -1.441462e-01 1 1  ON 7
 uu_8                -1.369846e-01 1 1  ON 8
 uu_9                -1.069393e-01 1 1  ON 9
 ud_0                 4.503123e-01 1 1  ON 10
 ud_1                 1.844359e-01 1 1  ON 11
 ud_2                 6.380361e-02 1 1  ON 12
 ud_3                -7.774937e-03 1 1  ON 13
 ud_4                -6.528870e-02 1 1  ON 14
 ud_5                -1.074376e-01 1 1  ON 15
 ud_6                -1.354545e-01 1 1  ON 16
 ud_7                -1.523692e-01 1 1  ON 17
 ud_8                -1.532919e-01 1 1  ON 18
 ud_9                -1.445348e-01 1 1  ON 19
 eO_0                -7.583859e-01 1 1  ON 20
 eO_1                -4.366674e-01 1 1  ON 21
 eO_2                -2.098672e-02 1 1  ON 22
 eO_3                 2.975960e-01 1 1  ON 23
 eO_4                 5.257083e-01 1 1  ON 24
 eO_5                 4.892344e-01 1 1  ON 25
 eO_6                 2.623319e-01 1 1  ON 26
 eO_7                -4.028120e-02 1 1  ON 27
 eO_8                -2.249500e-01 1 1  ON 28
 eO_9                -9.133755e-02 1 1  ON 29
eH1_0                -2.530947e-01 1 1  ON 30
eH1_1                -1.490760e-01 1 1  ON 31
eH1_2                -1.003118e-01 1 1  ON 32
eH1_3                -4.541665e-02 1 1  ON 33
eH1_4                 3.551327e-03 1 1  ON 34
eH1_5                 3.782340e-02 1 1  ON 35
eH1_6                 9.680269e-02 1 1  ON 36
eH1_7                 1.548880e-01 1 1  ON 37
eH1_8                 1.826863e-01 1 1  ON 38
eH1_9                 7.534708e-02 1 1  ON 39
eH2_0                -2.509794e-01 1 1  ON 40
eH2_1                -1.466794e-01 1 1  ON 41
eH2_2                -9.775819e-02 1 1  ON 42
eH2_3                -4.302331e-02 1 1  ON 43
eH2_4                 5.868171e-03 1 1  ON 44
eH2_5                 4.028437e-02 1 1  ON 45
eH2_6                 9.968328e-02 1 1  ON 46
eH2_7                 1.561470e-01 1 1  ON 47
eH2_8                 1.868866e-01 1 1  ON 48
eH2_9                 6.533458e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8987
    reference variance = 0.190565
====================================================
  Execution time = 2.0514e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3685e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336863889780
                                         uncertainty =       0.002995008622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336863889780
                                         uncertainty =       0.002995008622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410396669
  error estimate for blocks of size 2^( 2) =       0.000423120169
  error estimate for blocks of size 2^( 3) =       0.000435995493
  error estimate for blocks of size 2^( 4) =       0.000447841845
  error estimate for blocks of size 2^( 5) =       0.000457910593
  error estimate for blocks of size 2^( 6) =       0.000463693952
  error estimate for blocks of size 2^( 7) =       0.000465426407

      target function =                  N/A
              le_mean =     -16.906358893245
             les_mean =     286.161821710840
             stat err =       0.000458718199
             autocorr =       1.249350477768
              std dev =       0.580388535442
             le_variance =       0.336850852073


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635889324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906358893245       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906360402633       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906360704401       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361054282       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361755615       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906362539033       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906362671429       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906363408625       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906362901309       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906362859644       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906362871126       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906362990483       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.438436e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906358893245       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906359609900       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906359781350       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906359943331       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906359759742       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906360225320       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906360120500       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906360235465       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906360211103       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.576705e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906358893245       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906359124364       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906359187739       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906359241007       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906359168899       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906359268570       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906359236185       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906359264563       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.855674e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155922 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6078e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.114666e-01 1 1  ON 0
 uu_1                 1.439979e-01 1 1  ON 1
 uu_2                 4.194683e-02 1 1  ON 2
 uu_3                -2.108675e-02 1 1  ON 3
 uu_4                -6.728118e-02 1 1  ON 4
 uu_5                -1.025474e-01 1 1  ON 5
 uu_6                -1.304261e-01 1 1  ON 6
 uu_7                -1.442758e-01 1 1  ON 7
 uu_8                -1.370677e-01 1 1  ON 8
 uu_9                -1.070300e-01 1 1  ON 9
 ud_0                 4.503662e-01 1 1  ON 10
 ud_1                 1.845082e-01 1 1  ON 11
 ud_2                 6.382327e-02 1 1  ON 12
 ud_3                -7.708283e-03 1 1  ON 13
 ud_4                -6.517473e-02 1 1  ON 14
 ud_5                -1.073591e-01 1 1  ON 15
 ud_6                -1.352967e-01 1 1  ON 16
 ud_7                -1.524406e-01 1 1  ON 17
 ud_8                -1.535738e-01 1 1  ON 18
 ud_9                -1.446004e-01 1 1  ON 19
 eO_0                -7.582472e-01 1 1  ON 20
 eO_1                -4.365144e-01 1 1  ON 21
 eO_2                -2.101612e-02 1 1  ON 22
 eO_3                 2.976430e-01 1 1  ON 23
 eO_4                 5.257034e-01 1 1  ON 24
 eO_5                 4.893336e-01 1 1  ON 25
 eO_6                 2.624367e-01 1 1  ON 26
 eO_7                -4.028216e-02 1 1  ON 27
 eO_8                -2.251806e-01 1 1  ON 28
 eO_9                -9.157146e-02 1 1  ON 29
eH1_0                -2.533538e-01 1 1  ON 30
eH1_1                -1.492779e-01 1 1  ON 31
eH1_2                -1.004672e-01 1 1  ON 32
eH1_3                -4.552884e-02 1 1  ON 33
eH1_4                 3.467362e-03 1 1  ON 34
eH1_5                 3.787019e-02 1 1  ON 35
eH1_6                 9.686787e-02 1 1  ON 36
eH1_7                 1.550397e-01 1 1  ON 37
eH1_8                 1.829772e-01 1 1  ON 38
eH1_9                 7.562821e-02 1 1  ON 39
eH2_0                -2.512928e-01 1 1  ON 40
eH2_1                -1.467081e-01 1 1  ON 41
eH2_2                -9.773677e-02 1 1  ON 42
eH2_3                -4.300498e-02 1 1  ON 43
eH2_4                 5.906748e-03 1 1  ON 44
eH2_5                 4.036440e-02 1 1  ON 45
eH2_6                 9.946109e-02 1 1  ON 46
eH2_7                 1.560291e-01 1 1  ON 47
eH2_8                 1.870542e-01 1 1  ON 48
eH2_9                 6.569225e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.7995
    reference variance = 0.189426
====================================================
  Execution time = 2.0021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3384e-01
  Total weights = 2.0000e+06
  Execution time = 1.8878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333830645089
                                         uncertainty =       0.002763189000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333830645089
                                         uncertainty =       0.002763189000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408557758
  error estimate for blocks of size 2^( 2) =       0.000421805943
  error estimate for blocks of size 2^( 3) =       0.000434733960
  error estimate for blocks of size 2^( 4) =       0.000447108440
  error estimate for blocks of size 2^( 5) =       0.000457303497
  error estimate for blocks of size 2^( 6) =       0.000466292949
  error estimate for blocks of size 2^( 7) =       0.000470034512

      target function =                  N/A
              le_mean =     -16.905711653656
             les_mean =     286.136925232382
             stat err =       0.000460184850
             autocorr =       1.268696408246
              std dev =       0.577787921946
             le_variance =       0.333838882747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333780205759
                                         uncertainty =       0.002763057951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333780205759
                                         uncertainty =       0.002763057951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408526899
  error estimate for blocks of size 2^( 2) =       0.000421773228
  error estimate for blocks of size 2^( 3) =       0.000434699395
  error estimate for blocks of size 2^( 4) =       0.000447071322
  error estimate for blocks of size 2^( 5) =       0.000457266193
  error estimate for blocks of size 2^( 6) =       0.000466257857
  error estimate for blocks of size 2^( 7) =       0.000470002379

      target function =                  N/A
              le_mean =     -16.905712233442
             les_mean =     286.136894407229
             stat err =       0.000460149438
             autocorr =       1.268692805679
              std dev =       0.577744280961
             le_variance =       0.333788454184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333838821161
                                         uncertainty =       0.002763478396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333838821161
                                         uncertainty =       0.002763478396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408562781
  error estimate for blocks of size 2^( 2) =       0.000421808086
  error estimate for blocks of size 2^( 3) =       0.000434733151
  error estimate for blocks of size 2^( 4) =       0.000447105504
  error estimate for blocks of size 2^( 5) =       0.000457300543
  error estimate for blocks of size 2^( 6) =       0.000466290549
  error estimate for blocks of size 2^( 7) =       0.000470035972

      target function =                  N/A
              le_mean =     -16.905712273773
             les_mean =     286.136954408099
             stat err =       0.000460183142
             autocorr =       1.268655799862
              std dev =       0.577795025429
             le_variance =       0.333847091411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333830244606
                                         uncertainty =       0.002763202213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333830244606
                                         uncertainty =       0.002763202213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408557515
  error estimate for blocks of size 2^( 2) =       0.000421805270
  error estimate for blocks of size 2^( 3) =       0.000434732817
  error estimate for blocks of size 2^( 4) =       0.000447106979
  error estimate for blocks of size 2^( 5) =       0.000457302149
  error estimate for blocks of size 2^( 6) =       0.000466291586
  error estimate for blocks of size 2^( 7) =       0.000470033906

      target function =                  N/A
              le_mean =     -16.905711724211
             les_mean =     286.136927221984
             stat err =       0.000460183655
             autocorr =       1.268691327589
              std dev =       0.577787579292
             le_variance =       0.333838486784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905711653656        initial
     1.5625e-01     1.5625e+00             1.4384e-03       -16.905712233442
     6.2500e-01     6.2500e+00             3.5767e-04       -16.905712273773  <--
     2.5000e+00     2.5000e+01             8.8557e-05       -16.905711724211

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9573e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.114666e-01 1 1  ON 0
 uu_1                 1.439979e-01 1 1  ON 1
 uu_2                 4.194683e-02 1 1  ON 2
 uu_3                -2.108675e-02 1 1  ON 3
 uu_4                -6.728118e-02 1 1  ON 4
 uu_5                -1.025474e-01 1 1  ON 5
 uu_6                -1.304261e-01 1 1  ON 6
 uu_7                -1.442758e-01 1 1  ON 7
 uu_8                -1.370677e-01 1 1  ON 8
 uu_9                -1.070300e-01 1 1  ON 9
 ud_0                 4.503662e-01 1 1  ON 10
 ud_1                 1.845082e-01 1 1  ON 11
 ud_2                 6.382327e-02 1 1  ON 12
 ud_3                -7.708283e-03 1 1  ON 13
 ud_4                -6.517473e-02 1 1  ON 14
 ud_5                -1.073591e-01 1 1  ON 15
 ud_6                -1.352967e-01 1 1  ON 16
 ud_7                -1.524406e-01 1 1  ON 17
 ud_8                -1.535738e-01 1 1  ON 18
 ud_9                -1.446004e-01 1 1  ON 19
 eO_0                -7.582472e-01 1 1  ON 20
 eO_1                -4.365144e-01 1 1  ON 21
 eO_2                -2.101612e-02 1 1  ON 22
 eO_3                 2.976430e-01 1 1  ON 23
 eO_4                 5.257034e-01 1 1  ON 24
 eO_5                 4.893336e-01 1 1  ON 25
 eO_6                 2.624367e-01 1 1  ON 26
 eO_7                -4.028216e-02 1 1  ON 27
 eO_8                -2.251806e-01 1 1  ON 28
 eO_9                -9.157146e-02 1 1  ON 29
eH1_0                -2.533538e-01 1 1  ON 30
eH1_1                -1.492779e-01 1 1  ON 31
eH1_2                -1.004672e-01 1 1  ON 32
eH1_3                -4.552884e-02 1 1  ON 33
eH1_4                 3.467362e-03 1 1  ON 34
eH1_5                 3.787019e-02 1 1  ON 35
eH1_6                 9.686787e-02 1 1  ON 36
eH1_7                 1.550397e-01 1 1  ON 37
eH1_8                 1.829772e-01 1 1  ON 38
eH1_9                 7.562821e-02 1 1  ON 39
eH2_0                -2.512928e-01 1 1  ON 40
eH2_1                -1.467081e-01 1 1  ON 41
eH2_2                -9.773677e-02 1 1  ON 42
eH2_3                -4.300498e-02 1 1  ON 43
eH2_4                 5.906748e-03 1 1  ON 44
eH2_5                 4.036440e-02 1 1  ON 45
eH2_6                 9.946109e-02 1 1  ON 46
eH2_7                 1.560291e-01 1 1  ON 47
eH2_8                 1.870542e-01 1 1  ON 48
eH2_9                 6.569225e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5658e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.0019
    reference variance = 0.22619
====================================================
  Execution time = 2.0374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4557e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345570081187
                                         uncertainty =       0.006888299636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345570081187
                                         uncertainty =       0.006888299636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415677087
  error estimate for blocks of size 2^( 2) =       0.000428322151
  error estimate for blocks of size 2^( 3) =       0.000441316662
  error estimate for blocks of size 2^( 4) =       0.000453885902
  error estimate for blocks of size 2^( 5) =       0.000464885774
  error estimate for blocks of size 2^( 6) =       0.000471868812
  error estimate for blocks of size 2^( 7) =       0.000478146597

      target function =                  N/A
              le_mean =     -16.907003770005
             les_mean =     286.192351186834
             stat err =       0.000467196771
             autocorr =       1.263244728744
              std dev =       0.587856173438
             le_variance =       0.345574880649


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690700377001e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907003770005       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907006206464       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907006159150       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907005751339       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907007218778       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907007250232       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907006007679       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907005573120       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907006540710       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907006871722       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.334694e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907003770005       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907004768952       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907004644587       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907004552557       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907004788846       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907004594345       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907004545404       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907004423671       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907004573772       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.333008e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907003770005       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907004067311       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907004019080       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907004004270       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907004010660       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907003916112       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907003940380       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907003927437       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.175780e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159105 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6066e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.113457e-01 1 1  ON 0
 uu_1                 1.440170e-01 1 1  ON 1
 uu_2                 4.203109e-02 1 1  ON 2
 uu_3                -2.104012e-02 1 1  ON 3
 uu_4                -6.716360e-02 1 1  ON 4
 uu_5                -1.025647e-01 1 1  ON 5
 uu_6                -1.303911e-01 1 1  ON 6
 uu_7                -1.444009e-01 1 1  ON 7
 uu_8                -1.371408e-01 1 1  ON 8
 uu_9                -1.071510e-01 1 1  ON 9
 ud_0                 4.503617e-01 1 1  ON 10
 ud_1                 1.845401e-01 1 1  ON 11
 ud_2                 6.388565e-02 1 1  ON 12
 ud_3                -7.665020e-03 1 1  ON 13
 ud_4                -6.507187e-02 1 1  ON 14
 ud_5                -1.072321e-01 1 1  ON 15
 ud_6                -1.353284e-01 1 1  ON 16
 ud_7                -1.524317e-01 1 1  ON 17
 ud_8                -1.536448e-01 1 1  ON 18
 ud_9                -1.446914e-01 1 1  ON 19
 eO_0                -7.580031e-01 1 1  ON 20
 eO_1                -4.363024e-01 1 1  ON 21
 eO_2                -2.092438e-02 1 1  ON 22
 eO_3                 2.974553e-01 1 1  ON 23
 eO_4                 5.256264e-01 1 1  ON 24
 eO_5                 4.893604e-01 1 1  ON 25
 eO_6                 2.625160e-01 1 1  ON 26
 eO_7                -4.023317e-02 1 1  ON 27
 eO_8                -2.253260e-01 1 1  ON 28
 eO_9                -9.181331e-02 1 1  ON 29
eH1_0                -2.537871e-01 1 1  ON 30
eH1_1                -1.493101e-01 1 1  ON 31
eH1_2                -1.004363e-01 1 1  ON 32
eH1_3                -4.543688e-02 1 1  ON 33
eH1_4                 3.435900e-03 1 1  ON 34
eH1_5                 3.774718e-02 1 1  ON 35
eH1_6                 9.681812e-02 1 1  ON 36
eH1_7                 1.551772e-01 1 1  ON 37
eH1_8                 1.831352e-01 1 1  ON 38
eH1_9                 7.585067e-02 1 1  ON 39
eH2_0                -2.513915e-01 1 1  ON 40
eH2_1                -1.467015e-01 1 1  ON 41
eH2_2                -9.781129e-02 1 1  ON 42
eH2_3                -4.318083e-02 1 1  ON 43
eH2_4                 5.831115e-03 1 1  ON 44
eH2_5                 4.033908e-02 1 1  ON 45
eH2_6                 9.933565e-02 1 1  ON 46
eH2_7                 1.560645e-01 1 1  ON 47
eH2_8                 1.872099e-01 1 1  ON 48
eH2_9                 6.603084e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8517
    reference variance = 0.529691
====================================================
  Execution time = 1.9969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4497e-01
  Total weights = 2.0000e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344972231846
                                         uncertainty =       0.005171543962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344972231846
                                         uncertainty =       0.005171543962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415400551
  error estimate for blocks of size 2^( 2) =       0.000427910089
  error estimate for blocks of size 2^( 3) =       0.000440777337
  error estimate for blocks of size 2^( 4) =       0.000452358092
  error estimate for blocks of size 2^( 5) =       0.000463099424
  error estimate for blocks of size 2^( 6) =       0.000471927542
  error estimate for blocks of size 2^( 7) =       0.000479590089

      target function =                  N/A
              le_mean =     -16.906454396484
             les_mean =     286.173315323316
             stat err =       0.000466743787
             autocorr =       1.262475486630
              std dev =       0.587465092987
             le_variance =       0.345115235478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344621443827
                                         uncertainty =       0.005165945516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344621443827
                                         uncertainty =       0.005165945516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415189263
  error estimate for blocks of size 2^( 2) =       0.000427705135
  error estimate for blocks of size 2^( 3) =       0.000440580706
  error estimate for blocks of size 2^( 4) =       0.000452171872
  error estimate for blocks of size 2^( 5) =       0.000462925071
  error estimate for blocks of size 2^( 6) =       0.000471766967
  error estimate for blocks of size 2^( 7) =       0.000479441646

      target function =                  N/A
              le_mean =     -16.906454521619
             les_mean =     286.172968566923
             stat err =       0.000466576389
             autocorr =       1.262854417750
              std dev =       0.587166286263
             le_variance =       0.344764247724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344686419243
                                         uncertainty =       0.005166577425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344686419243
                                         uncertainty =       0.005166577425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415228381
  error estimate for blocks of size 2^( 2) =       0.000427744198
  error estimate for blocks of size 2^( 3) =       0.000440618951
  error estimate for blocks of size 2^( 4) =       0.000452208168
  error estimate for blocks of size 2^( 5) =       0.000462957833
  error estimate for blocks of size 2^( 6) =       0.000471796480
  error estimate for blocks of size 2^( 7) =       0.000479467024

      target function =                  N/A
              le_mean =     -16.906454254320
             les_mean =     286.173024498349
             stat err =       0.000466607376
             autocorr =       1.262784199649
              std dev =       0.587221608373
             le_variance =       0.344829217341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344924969697
                                         uncertainty =       0.005170702038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344924969697
                                         uncertainty =       0.005170702038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415372091
  error estimate for blocks of size 2^( 2) =       0.000427882739
  error estimate for blocks of size 2^( 3) =       0.000440751247
  error estimate for blocks of size 2^( 4) =       0.000452333322
  error estimate for blocks of size 2^( 5) =       0.000463075897
  error estimate for blocks of size 2^( 6) =       0.000471905659
  error estimate for blocks of size 2^( 7) =       0.000479569388

      target function =                  N/A
              le_mean =     -16.906454247683
             les_mean =     286.173263004070
             stat err =       0.000466721067
             autocorr =       1.262525571748
              std dev =       0.587424844221
             le_variance =       0.345067947609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906454396484        initial
     1.5625e-01     1.5625e+00             1.3347e-03       -16.906454521619  <--
     6.2500e-01     6.2500e+00             4.3330e-04       -16.906454254320
     2.5000e+00     2.5000e+01             1.1758e-04       -16.906454247683

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9466e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.112289e-01 1 1  ON 0
 uu_1                 1.440472e-01 1 1  ON 1
 uu_2                 4.214173e-02 1 1  ON 2
 uu_3                -2.090354e-02 1 1  ON 3
 uu_4                -6.696756e-02 1 1  ON 4
 uu_5                -1.025084e-01 1 1  ON 5
 uu_6                -1.304092e-01 1 1  ON 6
 uu_7                -1.446722e-01 1 1  ON 7
 uu_8                -1.373434e-01 1 1  ON 8
 uu_9                -1.075094e-01 1 1  ON 9
 ud_0                 4.504165e-01 1 1  ON 10
 ud_1                 1.846298e-01 1 1  ON 11
 ud_2                 6.403364e-02 1 1  ON 12
 ud_3                -7.475682e-03 1 1  ON 13
 ud_4                -6.484610e-02 1 1  ON 14
 ud_5                -1.069565e-01 1 1  ON 15
 ud_6                -1.353440e-01 1 1  ON 16
 ud_7                -1.524235e-01 1 1  ON 17
 ud_8                -1.538270e-01 1 1  ON 18
 ud_9                -1.449577e-01 1 1  ON 19
 eO_0                -7.573099e-01 1 1  ON 20
 eO_1                -4.358130e-01 1 1  ON 21
 eO_2                -2.068395e-02 1 1  ON 22
 eO_3                 2.971223e-01 1 1  ON 23
 eO_4                 5.254262e-01 1 1  ON 24
 eO_5                 4.894008e-01 1 1  ON 25
 eO_6                 2.627169e-01 1 1  ON 26
 eO_7                -4.009444e-02 1 1  ON 27
 eO_8                -2.257461e-01 1 1  ON 28
 eO_9                -9.251494e-02 1 1  ON 29
eH1_0                -2.546885e-01 1 1  ON 30
eH1_1                -1.493909e-01 1 1  ON 31
eH1_2                -1.004981e-01 1 1  ON 32
eH1_3                -4.538116e-02 1 1  ON 33
eH1_4                 3.343840e-03 1 1  ON 34
eH1_5                 3.748056e-02 1 1  ON 35
eH1_6                 9.663541e-02 1 1  ON 36
eH1_7                 1.555319e-01 1 1  ON 37
eH1_8                 1.835848e-01 1 1  ON 38
eH1_9                 7.649361e-02 1 1  ON 39
eH2_0                -2.516914e-01 1 1  ON 40
eH2_1                -1.468364e-01 1 1  ON 41
eH2_2                -9.807264e-02 1 1  ON 42
eH2_3                -4.346560e-02 1 1  ON 43
eH2_4                 5.562470e-03 1 1  ON 44
eH2_5                 4.026692e-02 1 1  ON 45
eH2_6                 9.901407e-02 1 1  ON 46
eH2_7                 1.561704e-01 1 1  ON 47
eH2_8                 1.876586e-01 1 1  ON 48
eH2_9                 6.700691e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5539e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8606
    reference variance = 0.44899
====================================================
  Execution time = 2.0418e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3972e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339702519235
                                         uncertainty =       0.003499683474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339702519235
                                         uncertainty =       0.003499683474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412139975
  error estimate for blocks of size 2^( 2) =       0.000424988869
  error estimate for blocks of size 2^( 3) =       0.000437693038
  error estimate for blocks of size 2^( 4) =       0.000449908737
  error estimate for blocks of size 2^( 5) =       0.000460505303
  error estimate for blocks of size 2^( 6) =       0.000467817447
  error estimate for blocks of size 2^( 7) =       0.000472010164

      target function =                  N/A
              le_mean =     -16.906563465979
             les_mean =     286.171606778128
             stat err =       0.000462560412
             autocorr =       1.259642894604
              std dev =       0.582853942944
             le_variance =       0.339718718805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690656346598e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906563465979       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906565628308       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906566967391       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906568673201       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906569055314       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906569797758       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906571891164       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906573180758       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906573555635       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906572579045       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906573460344       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906572866867       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906573172434       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906573454805       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.689084e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906563465979       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906564840935       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906565480392       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906566666111       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906566388036       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906566700611       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906567930714       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906567546783       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906567610576       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906567635594       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906567456292       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.170092e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906563465979       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906564025694       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906564258307       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906564449455       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906564624429       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906564776864       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906564839922       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906564801071       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906564843205       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.268437e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164412 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6034e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.111614e-01 1 1  ON 0
 uu_1                 1.439066e-01 1 1  ON 1
 uu_2                 4.195198e-02 1 1  ON 2
 uu_3                -2.081744e-02 1 1  ON 3
 uu_4                -6.688034e-02 1 1  ON 4
 uu_5                -1.022789e-01 1 1  ON 5
 uu_6                -1.305504e-01 1 1  ON 6
 uu_7                -1.446018e-01 1 1  ON 7
 uu_8                -1.376146e-01 1 1  ON 8
 uu_9                -1.080340e-01 1 1  ON 9
 ud_0                 4.504569e-01 1 1  ON 10
 ud_1                 1.848125e-01 1 1  ON 11
 ud_2                 6.417206e-02 1 1  ON 12
 ud_3                -7.350713e-03 1 1  ON 13
 ud_4                -6.479923e-02 1 1  ON 14
 ud_5                -1.068918e-01 1 1  ON 15
 ud_6                -1.352893e-01 1 1  ON 16
 ud_7                -1.524947e-01 1 1  ON 17
 ud_8                -1.539369e-01 1 1  ON 18
 ud_9                -1.449896e-01 1 1  ON 19
 eO_0                -7.569341e-01 1 1  ON 20
 eO_1                -4.352079e-01 1 1  ON 21
 eO_2                -2.017457e-02 1 1  ON 22
 eO_3                 2.965742e-01 1 1  ON 23
 eO_4                 5.252698e-01 1 1  ON 24
 eO_5                 4.897265e-01 1 1  ON 25
 eO_6                 2.629296e-01 1 1  ON 26
 eO_7                -3.996609e-02 1 1  ON 27
 eO_8                -2.264249e-01 1 1  ON 28
 eO_9                -9.317128e-02 1 1  ON 29
eH1_0                -2.555558e-01 1 1  ON 30
eH1_1                -1.500736e-01 1 1  ON 31
eH1_2                -1.010603e-01 1 1  ON 32
eH1_3                -4.592435e-02 1 1  ON 33
eH1_4                 3.050405e-03 1 1  ON 34
eH1_5                 3.741585e-02 1 1  ON 35
eH1_6                 9.711666e-02 1 1  ON 36
eH1_7                 1.559432e-01 1 1  ON 37
eH1_8                 1.844962e-01 1 1  ON 38
eH1_9                 7.754369e-02 1 1  ON 39
eH2_0                -2.527649e-01 1 1  ON 40
eH2_1                -1.473195e-01 1 1  ON 41
eH2_2                -9.824881e-02 1 1  ON 42
eH2_3                -4.353323e-02 1 1  ON 43
eH2_4                 5.353735e-03 1 1  ON 44
eH2_5                 4.010656e-02 1 1  ON 45
eH2_6                 9.906528e-02 1 1  ON 46
eH2_7                 1.564216e-01 1 1  ON 47
eH2_8                 1.882840e-01 1 1  ON 48
eH2_9                 6.817700e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8459
    reference variance = 0.236691
====================================================
  Execution time = 2.0182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4302e-01
  Total weights = 2.0000e+06
  Execution time = 1.8809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343217482760
                                         uncertainty =       0.004639383589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343217482760
                                         uncertainty =       0.004639383589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414229530
  error estimate for blocks of size 2^( 2) =       0.000426446802
  error estimate for blocks of size 2^( 3) =       0.000439199727
  error estimate for blocks of size 2^( 4) =       0.000450747204
  error estimate for blocks of size 2^( 5) =       0.000461731412
  error estimate for blocks of size 2^( 6) =       0.000469209268
  error estimate for blocks of size 2^( 7) =       0.000473457950

      target function =                  N/A
              le_mean =     -16.905927713997
             les_mean =     286.153563907004
             stat err =       0.000463786458
             autocorr =       1.253585658098
              std dev =       0.585809019807
             le_variance =       0.343172207687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343004938787
                                         uncertainty =       0.004635141640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343004938787
                                         uncertainty =       0.004635141640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414101209
  error estimate for blocks of size 2^( 2) =       0.000426319560
  error estimate for blocks of size 2^( 3) =       0.000439076538
  error estimate for blocks of size 2^( 4) =       0.000450634142
  error estimate for blocks of size 2^( 5) =       0.000461620123
  error estimate for blocks of size 2^( 6) =       0.000469099858
  error estimate for blocks of size 2^( 7) =       0.000473346499

      target function =                  N/A
              le_mean =     -16.905928255827
             les_mean =     286.153369641697
             stat err =       0.000463675155
             autocorr =       1.253760710263
              std dev =       0.585627545468
             le_variance =       0.342959622011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342918676922
                                         uncertainty =       0.004631278551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342918676922
                                         uncertainty =       0.004631278551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414049137
  error estimate for blocks of size 2^( 2) =       0.000426269629
  error estimate for blocks of size 2^( 3) =       0.000439028776
  error estimate for blocks of size 2^( 4) =       0.000450591184
  error estimate for blocks of size 2^( 5) =       0.000461580270
  error estimate for blocks of size 2^( 6) =       0.000469063900
  error estimate for blocks of size 2^( 7) =       0.000473317120

      target function =                  N/A
              le_mean =     -16.905927442469
             les_mean =     286.153255894117
             stat err =       0.000463638119
             autocorr =       1.253875747470
              std dev =       0.585553904877
             le_variance =       0.342873375517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343158542959
                                         uncertainty =       0.004637479811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343158542959
                                         uncertainty =       0.004637479811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414193944
  error estimate for blocks of size 2^( 2) =       0.000426411696
  error estimate for blocks of size 2^( 3) =       0.000439165525
  error estimate for blocks of size 2^( 4) =       0.000450716190
  error estimate for blocks of size 2^( 5) =       0.000461701551
  error estimate for blocks of size 2^( 6) =       0.000469180719
  error estimate for blocks of size 2^( 7) =       0.000473429821

      target function =                  N/A
              le_mean =     -16.905927417580
             les_mean =     286.153494923076
             stat err =       0.000463757070
             autocorr =       1.253642188191
              std dev =       0.585758692768
             le_variance =       0.343113246153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905927713997        initial
     3.9062e-02     3.9062e-01             4.6891e-03       -16.905928255827  <--
     1.5625e-01     1.5625e+00             1.1701e-03       -16.905927442469
     6.2500e-01     6.2500e+00             3.2684e-04       -16.905927417580

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 2.9631e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.111344e-01 1 1  ON 0
 uu_1                 1.438247e-01 1 1  ON 1
 uu_2                 4.187562e-02 1 1  ON 2
 uu_3                -2.076548e-02 1 1  ON 3
 uu_4                -6.678932e-02 1 1  ON 4
 uu_5                -1.022175e-01 1 1  ON 5
 uu_6                -1.307658e-01 1 1  ON 6
 uu_7                -1.449939e-01 1 1  ON 7
 uu_8                -1.382390e-01 1 1  ON 8
 uu_9                -1.093773e-01 1 1  ON 9
 ud_0                 4.507527e-01 1 1  ON 10
 ud_1                 1.851211e-01 1 1  ON 11
 ud_2                 6.446386e-02 1 1  ON 12
 ud_3                -7.052343e-03 1 1  ON 13
 ud_4                -6.450570e-02 1 1  ON 14
 ud_5                -1.066570e-01 1 1  ON 15
 ud_6                -1.352784e-01 1 1  ON 16
 ud_7                -1.526211e-01 1 1  ON 17
 ud_8                -1.541563e-01 1 1  ON 18
 ud_9                -1.450462e-01 1 1  ON 19
 eO_0                -7.558882e-01 1 1  ON 20
 eO_1                -4.341137e-01 1 1  ON 21
 eO_2                -1.923594e-02 1 1  ON 22
 eO_3                 2.965463e-01 1 1  ON 23
 eO_4                 5.251426e-01 1 1  ON 24
 eO_5                 4.901469e-01 1 1  ON 25
 eO_6                 2.635116e-01 1 1  ON 26
 eO_7                -3.961349e-02 1 1  ON 27
 eO_8                -2.283813e-01 1 1  ON 28
 eO_9                -9.513488e-02 1 1  ON 29
eH1_0                -2.575295e-01 1 1  ON 30
eH1_1                -1.518516e-01 1 1  ON 31
eH1_2                -1.026883e-01 1 1  ON 32
eH1_3                -4.752505e-02 1 1  ON 33
eH1_4                 1.895558e-03 1 1  ON 34
eH1_5                 3.699030e-02 1 1  ON 35
eH1_6                 9.791533e-02 1 1  ON 36
eH1_7                 1.572171e-01 1 1  ON 37
eH1_8                 1.872720e-01 1 1  ON 38
eH1_9                 8.075048e-02 1 1  ON 39
eH2_0                -2.544706e-01 1 1  ON 40
eH2_1                -1.485710e-01 1 1  ON 41
eH2_2                -9.927954e-02 1 1  ON 42
eH2_3                -4.449504e-02 1 1  ON 43
eH2_4                 4.552421e-03 1 1  ON 44
eH2_5                 3.957188e-02 1 1  ON 45
eH2_6                 9.906463e-02 1 1  ON 46
eH2_7                 1.571292e-01 1 1  ON 47
eH2_8                 1.901068e-01 1 1  ON 48
eH2_9                 7.169599e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5672e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.911
    reference variance = 0.291649
====================================================
  Execution time = 2.0741e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.9470e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394720909091
                                         uncertainty =       0.037648660429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394720909091
                                         uncertainty =       0.037648660429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444240750
  error estimate for blocks of size 2^( 2) =       0.000456111427
  error estimate for blocks of size 2^( 3) =       0.000468415253
  error estimate for blocks of size 2^( 4) =       0.000479273643
  error estimate for blocks of size 2^( 5) =       0.000489016494
  error estimate for blocks of size 2^( 6) =       0.000494087082
  error estimate for blocks of size 2^( 7) =       0.000499215505

      target function =                  N/A
              le_mean =     -16.906026904172
             les_mean =     286.208445174440
             stat err =       0.000490398181
             autocorr =       1.218599274163
              std dev =       0.628251293023
             le_variance =       0.394699687185


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602690417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906026904172       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023395993       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906026478094       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027692056       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906026953016       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027430652       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906030045980       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906035614831       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906041914370       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906046257061       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906046559845       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906048085613       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906045515897       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906046204443       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906047037621       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906048548612       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906049661696       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906049004605       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906049047158       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.757016e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906026904172       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023687730       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906026575115       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027515759       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906026812826       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027398058       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906029467141       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906032095821       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906033452498       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906034187205       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906033717150       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906033169727       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906032962546       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906032663931       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 7.013503e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906026904172       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906024490580       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906026602009       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906026721010       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906026845646       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027243907       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906027761843       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906028164500       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906028147925       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906028510974       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906028413818       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.763057e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6268e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.112822e-01 1 1  ON 0
 uu_1                 1.433197e-01 1 1  ON 1
 uu_2                 4.122554e-02 1 1  ON 2
 uu_3                -2.124369e-02 1 1  ON 3
 uu_4                -6.719000e-02 1 1  ON 4
 uu_5                -1.026801e-01 1 1  ON 5
 uu_6                -1.308572e-01 1 1  ON 6
 uu_7                -1.453326e-01 1 1  ON 7
 uu_8                -1.386697e-01 1 1  ON 8
 uu_9                -1.113612e-01 1 1  ON 9
 ud_0                 4.514688e-01 1 1  ON 10
 ud_1                 1.853256e-01 1 1  ON 11
 ud_2                 6.477967e-02 1 1  ON 12
 ud_3                -6.341060e-03 1 1  ON 13
 ud_4                -6.383336e-02 1 1  ON 14
 ud_5                -1.063270e-01 1 1  ON 15
 ud_6                -1.352558e-01 1 1  ON 16
 ud_7                -1.542673e-01 1 1  ON 17
 ud_8                -1.557175e-01 1 1  ON 18
 ud_9                -1.455926e-01 1 1  ON 19
 eO_0                -7.546804e-01 1 1  ON 20
 eO_1                -4.330551e-01 1 1  ON 21
 eO_2                -1.900772e-02 1 1  ON 22
 eO_3                 2.971145e-01 1 1  ON 23
 eO_4                 5.259061e-01 1 1  ON 24
 eO_5                 4.912723e-01 1 1  ON 25
 eO_6                 2.637362e-01 1 1  ON 26
 eO_7                -3.884380e-02 1 1  ON 27
 eO_8                -2.304783e-01 1 1  ON 28
 eO_9                -9.842222e-02 1 1  ON 29
eH1_0                -2.584075e-01 1 1  ON 30
eH1_1                -1.528265e-01 1 1  ON 31
eH1_2                -1.037103e-01 1 1  ON 32
eH1_3                -4.885667e-02 1 1  ON 33
eH1_4                 2.393593e-04 1 1  ON 34
eH1_5                 3.526771e-02 1 1  ON 35
eH1_6                 9.758057e-02 1 1  ON 36
eH1_7                 1.585427e-01 1 1  ON 37
eH1_8                 1.890604e-01 1 1  ON 38
eH1_9                 8.468473e-02 1 1  ON 39
eH2_0                -2.558284e-01 1 1  ON 40
eH2_1                -1.511144e-01 1 1  ON 41
eH2_2                -1.019558e-01 1 1  ON 42
eH2_3                -4.679667e-02 1 1  ON 43
eH2_4                 2.359665e-03 1 1  ON 44
eH2_5                 3.745378e-02 1 1  ON 45
eH2_6                 9.929620e-02 1 1  ON 46
eH2_7                 1.578886e-01 1 1  ON 47
eH2_8                 1.937945e-01 1 1  ON 48
eH2_9                 7.870950e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8686
    reference variance = 0.249917
====================================================
  Execution time = 1.9834e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.4117e-01
  Total weights = 2.0000e+06
  Execution time = 1.8836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340626363688
                                         uncertainty =       0.005063840502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340626363688
                                         uncertainty =       0.005063840502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412635373
  error estimate for blocks of size 2^( 2) =       0.000425154516
  error estimate for blocks of size 2^( 3) =       0.000437695188
  error estimate for blocks of size 2^( 4) =       0.000449649566
  error estimate for blocks of size 2^( 5) =       0.000460160656
  error estimate for blocks of size 2^( 6) =       0.000467611852
  error estimate for blocks of size 2^( 7) =       0.000469376295

      target function =                  N/A
              le_mean =     -16.907500246189
             les_mean =     286.204100306854
             stat err =       0.000461699592
             autocorr =       1.251947370025
              std dev =       0.583554540926
             le_variance =       0.340535902235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341486785034
                                         uncertainty =       0.005074285424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341486785034
                                         uncertainty =       0.005074285424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413156110
  error estimate for blocks of size 2^( 2) =       0.000425652574
  error estimate for blocks of size 2^( 3) =       0.000438161729
  error estimate for blocks of size 2^( 4) =       0.000450084631
  error estimate for blocks of size 2^( 5) =       0.000460545833
  error estimate for blocks of size 2^( 6) =       0.000467964804
  error estimate for blocks of size 2^( 7) =       0.000469705824

      target function =                  N/A
              le_mean =     -16.907504435885
             les_mean =     286.205102021892
             stat err =       0.000462075273
             autocorr =       1.250826567800
              std dev =       0.584290974689
             le_variance =       0.341395943103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341937099776
                                         uncertainty =       0.005078140453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341937099776
                                         uncertainty =       0.005078140453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413428360
  error estimate for blocks of size 2^( 2) =       0.000425913673
  error estimate for blocks of size 2^( 3) =       0.000438417297
  error estimate for blocks of size 2^( 4) =       0.000450341987
  error estimate for blocks of size 2^( 5) =       0.000460802990
  error estimate for blocks of size 2^( 6) =       0.000468221466
  error estimate for blocks of size 2^( 7) =       0.000469975486

      target function =                  N/A
              le_mean =     -16.907512112278
             les_mean =     286.205811673567
             stat err =       0.000462335482
             autocorr =       1.250587030760
              std dev =       0.584675993753
             le_variance =       0.341846017671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341170535883
                                         uncertainty =       0.005069201400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341170535883
                                         uncertainty =       0.005069201400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412964773
  error estimate for blocks of size 2^( 2) =       0.000425467751
  error estimate for blocks of size 2^( 3) =       0.000437992331
  error estimate for blocks of size 2^( 4) =       0.000449935901
  error estimate for blocks of size 2^( 5) =       0.000460432356
  error estimate for blocks of size 2^( 6) =       0.000467873066
  error estimate for blocks of size 2^( 7) =       0.000469636331

      target function =                  N/A
              le_mean =     -16.907501885999
             les_mean =     286.204699661259
             stat err =       0.000461969413
             autocorr =       1.251412336164
              std dev =       0.584020382118
             le_variance =       0.341079806729


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907500246189        initial
     9.7656e-03     9.7656e-02             2.7570e-02       -16.907504435885
     3.9062e-02     3.9062e-01             7.0135e-03       -16.907512112278  <--
     1.5625e-01     1.5625e+00             1.7631e-03       -16.907501885999

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 2.9293e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.112822e-01 1 1  ON 0
 uu_1                 1.433197e-01 1 1  ON 1
 uu_2                 4.122554e-02 1 1  ON 2
 uu_3                -2.124369e-02 1 1  ON 3
 uu_4                -6.719000e-02 1 1  ON 4
 uu_5                -1.026801e-01 1 1  ON 5
 uu_6                -1.308572e-01 1 1  ON 6
 uu_7                -1.453326e-01 1 1  ON 7
 uu_8                -1.386697e-01 1 1  ON 8
 uu_9                -1.113612e-01 1 1  ON 9
 ud_0                 4.514688e-01 1 1  ON 10
 ud_1                 1.853256e-01 1 1  ON 11
 ud_2                 6.477967e-02 1 1  ON 12
 ud_3                -6.341060e-03 1 1  ON 13
 ud_4                -6.383336e-02 1 1  ON 14
 ud_5                -1.063270e-01 1 1  ON 15
 ud_6                -1.352558e-01 1 1  ON 16
 ud_7                -1.542673e-01 1 1  ON 17
 ud_8                -1.557175e-01 1 1  ON 18
 ud_9                -1.455926e-01 1 1  ON 19
 eO_0                -7.546804e-01 1 1  ON 20
 eO_1                -4.330551e-01 1 1  ON 21
 eO_2                -1.900772e-02 1 1  ON 22
 eO_3                 2.971145e-01 1 1  ON 23
 eO_4                 5.259061e-01 1 1  ON 24
 eO_5                 4.912723e-01 1 1  ON 25
 eO_6                 2.637362e-01 1 1  ON 26
 eO_7                -3.884380e-02 1 1  ON 27
 eO_8                -2.304783e-01 1 1  ON 28
 eO_9                -9.842222e-02 1 1  ON 29
eH1_0                -2.584075e-01 1 1  ON 30
eH1_1                -1.528265e-01 1 1  ON 31
eH1_2                -1.037103e-01 1 1  ON 32
eH1_3                -4.885667e-02 1 1  ON 33
eH1_4                 2.393593e-04 1 1  ON 34
eH1_5                 3.526771e-02 1 1  ON 35
eH1_6                 9.758057e-02 1 1  ON 36
eH1_7                 1.585427e-01 1 1  ON 37
eH1_8                 1.890604e-01 1 1  ON 38
eH1_9                 8.468473e-02 1 1  ON 39
eH2_0                -2.558284e-01 1 1  ON 40
eH2_1                -1.511144e-01 1 1  ON 41
eH2_2                -1.019558e-01 1 1  ON 42
eH2_3                -4.679667e-02 1 1  ON 43
eH2_4                 2.359665e-03 1 1  ON 44
eH2_5                 3.745378e-02 1 1  ON 45
eH2_6                 9.929620e-02 1 1  ON 46
eH2_7                 1.578886e-01 1 1  ON 47
eH2_8                 1.937945e-01 1 1  ON 48
eH2_9                 7.870950e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5567e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9374
    reference variance = 0.26476
====================================================
  Execution time = 2.0382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3988e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339970291173
                                         uncertainty =       0.006902160808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339970291173
                                         uncertainty =       0.006902160808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412240897
  error estimate for blocks of size 2^( 2) =       0.000425325045
  error estimate for blocks of size 2^( 3) =       0.000437773820
  error estimate for blocks of size 2^( 4) =       0.000450536845
  error estimate for blocks of size 2^( 5) =       0.000460386203
  error estimate for blocks of size 2^( 6) =       0.000467644093
  error estimate for blocks of size 2^( 7) =       0.000471455700

      target function =                  N/A
              le_mean =     -16.906603220005
             les_mean =     286.173117382831
             stat err =       0.000462505710
             autocorr =       1.258728454264
              std dev =       0.582996667314
             le_variance =       0.339885114099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660322000e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906603220005       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906605063317       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906606384073       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906607009367       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906610995658       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906614300407       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906616900443       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906617562532       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906617671524       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906624088945       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906628453903       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906629994356       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906632103305       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906632163874       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906632031459       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906630366537       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906630608508       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906632643521       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906633645621       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906634255879       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906633896305       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906633323514       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.881431e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906603220005       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906604904939       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906606059911       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906606566369       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906609710234       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906611919207       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906613526103       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906612362595       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906612571079       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906614071758       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906614922721       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906615202741       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906615273838       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906615110242       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 7.149867e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906603220005       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906604473973       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906605276574       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906605580732       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906607087900       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906608154687       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906608151168       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906607920112       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906607974739       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906608144705       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906608093860       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.782129e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5961e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.110792e-01 1 1  ON 0
 uu_1                 1.440635e-01 1 1  ON 1
 uu_2                 4.187721e-02 1 1  ON 2
 uu_3                -2.132346e-02 1 1  ON 3
 uu_4                -6.776521e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.323522e-01 1 1  ON 6
 uu_7                -1.468374e-01 1 1  ON 7
 uu_8                -1.398516e-01 1 1  ON 8
 uu_9                -1.112577e-01 1 1  ON 9
 ud_0                 4.511794e-01 1 1  ON 10
 ud_1                 1.854580e-01 1 1  ON 11
 ud_2                 6.485158e-02 1 1  ON 12
 ud_3                -6.537135e-03 1 1  ON 13
 ud_4                -6.404680e-02 1 1  ON 14
 ud_5                -1.064941e-01 1 1  ON 15
 ud_6                -1.351013e-01 1 1  ON 16
 ud_7                -1.531512e-01 1 1  ON 17
 ud_8                -1.553021e-01 1 1  ON 18
 ud_9                -1.449590e-01 1 1  ON 19
 eO_0                -7.548662e-01 1 1  ON 20
 eO_1                -4.331202e-01 1 1  ON 21
 eO_2                -1.808054e-02 1 1  ON 22
 eO_3                 2.988251e-01 1 1  ON 23
 eO_4                 5.270528e-01 1 1  ON 24
 eO_5                 4.922197e-01 1 1  ON 25
 eO_6                 2.644988e-01 1 1  ON 26
 eO_7                -3.851449e-02 1 1  ON 27
 eO_8                -2.327753e-01 1 1  ON 28
 eO_9                -1.012952e-01 1 1  ON 29
eH1_0                -2.596254e-01 1 1  ON 30
eH1_1                -1.545945e-01 1 1  ON 31
eH1_2                -1.054378e-01 1 1  ON 32
eH1_3                -4.961818e-02 1 1  ON 33
eH1_4                -6.065921e-05 1 1  ON 34
eH1_5                 3.542047e-02 1 1  ON 35
eH1_6                 9.719082e-02 1 1  ON 36
eH1_7                 1.577018e-01 1 1  ON 37
eH1_8                 1.905631e-01 1 1  ON 38
eH1_9                 8.862364e-02 1 1  ON 39
eH2_0                -2.591692e-01 1 1  ON 40
eH2_1                -1.537956e-01 1 1  ON 41
eH2_2                -1.049192e-01 1 1  ON 42
eH2_3                -4.972071e-02 1 1  ON 43
eH2_4                 5.290870e-04 1 1  ON 44
eH2_5                 3.633038e-02 1 1  ON 45
eH2_6                 9.962249e-02 1 1  ON 46
eH2_7                 1.593073e-01 1 1  ON 47
eH2_8                 1.983916e-01 1 1  ON 48
eH2_9                 8.585936e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9709
    reference variance = 0.679688
====================================================
  Execution time = 2.0151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4698e-01
  Total weights = 2.0000e+06
  Execution time = 1.8775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347241775572
                                         uncertainty =       0.009537648293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347241775572
                                         uncertainty =       0.009537648293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416724390
  error estimate for blocks of size 2^( 2) =       0.000428813684
  error estimate for blocks of size 2^( 3) =       0.000441649960
  error estimate for blocks of size 2^( 4) =       0.000452728263
  error estimate for blocks of size 2^( 5) =       0.000462684919
  error estimate for blocks of size 2^( 6) =       0.000469247843
  error estimate for blocks of size 2^( 7) =       0.000472417382

      target function =                  N/A
              le_mean =     -16.906543329418
             les_mean =     286.178525610909
             stat err =       0.000464269602
             autocorr =       1.241202547424
              std dev =       0.589337284644
             le_variance =       0.347318435071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347084496291
                                         uncertainty =       0.009509822145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347084496291
                                         uncertainty =       0.009509822145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416630442
  error estimate for blocks of size 2^( 2) =       0.000428734795
  error estimate for blocks of size 2^( 3) =       0.000441569319
  error estimate for blocks of size 2^( 4) =       0.000452632537
  error estimate for blocks of size 2^( 5) =       0.000462567003
  error estimate for blocks of size 2^( 6) =       0.000469113831
  error estimate for blocks of size 2^( 7) =       0.000472232000

      target function =                  N/A
              le_mean =     -16.906546073402
             les_mean =     286.178461809168
             stat err =       0.000464136343
             autocorr =       1.241049638659
              std dev =       0.589204421815
             le_variance =       0.347161850687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346611265045
                                         uncertainty =       0.009489075772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346611265045
                                         uncertainty =       0.009489075772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416346546
  error estimate for blocks of size 2^( 2) =       0.000428467547
  error estimate for blocks of size 2^( 3) =       0.000441316171
  error estimate for blocks of size 2^( 4) =       0.000452393788
  error estimate for blocks of size 2^( 5) =       0.000462348778
  error estimate for blocks of size 2^( 6) =       0.000468919582
  error estimate for blocks of size 2^( 7) =       0.000472032400

      target function =                  N/A
              le_mean =     -16.906550828056
             les_mean =     286.178149620685
             stat err =       0.000463923637
             autocorr =       1.241603903228
              std dev =       0.588802931710
             le_variance =       0.346688892391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346885256671
                                         uncertainty =       0.009518900937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346885256671
                                         uncertainty =       0.009518900937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416510616
  error estimate for blocks of size 2^( 2) =       0.000428610114
  error estimate for blocks of size 2^( 3) =       0.000441451617
  error estimate for blocks of size 2^( 4) =       0.000452532970
  error estimate for blocks of size 2^( 5) =       0.000462493856
  error estimate for blocks of size 2^( 6) =       0.000469066965
  error estimate for blocks of size 2^( 7) =       0.000472219874

      target function =                  N/A
              le_mean =     -16.906541762147
             les_mean =     286.178116367579
             stat err =       0.000464078416
             autocorr =       1.241453882307
              std dev =       0.589034961463
             le_variance =       0.346962185826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906543329418        initial
     9.7656e-03     9.7656e-02             2.8814e-02       -16.906546073402
     3.9062e-02     3.9062e-01             7.1499e-03       -16.906550828056  <--
     1.5625e-01     1.5625e+00             1.7821e-03       -16.906541762147

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.3180e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.110792e-01 1 1  ON 0
 uu_1                 1.440635e-01 1 1  ON 1
 uu_2                 4.187721e-02 1 1  ON 2
 uu_3                -2.132346e-02 1 1  ON 3
 uu_4                -6.776521e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.323522e-01 1 1  ON 6
 uu_7                -1.468374e-01 1 1  ON 7
 uu_8                -1.398516e-01 1 1  ON 8
 uu_9                -1.112577e-01 1 1  ON 9
 ud_0                 4.511794e-01 1 1  ON 10
 ud_1                 1.854580e-01 1 1  ON 11
 ud_2                 6.485158e-02 1 1  ON 12
 ud_3                -6.537135e-03 1 1  ON 13
 ud_4                -6.404680e-02 1 1  ON 14
 ud_5                -1.064941e-01 1 1  ON 15
 ud_6                -1.351013e-01 1 1  ON 16
 ud_7                -1.531512e-01 1 1  ON 17
 ud_8                -1.553021e-01 1 1  ON 18
 ud_9                -1.449590e-01 1 1  ON 19
 eO_0                -7.548662e-01 1 1  ON 20
 eO_1                -4.331202e-01 1 1  ON 21
 eO_2                -1.808054e-02 1 1  ON 22
 eO_3                 2.988251e-01 1 1  ON 23
 eO_4                 5.270528e-01 1 1  ON 24
 eO_5                 4.922197e-01 1 1  ON 25
 eO_6                 2.644988e-01 1 1  ON 26
 eO_7                -3.851449e-02 1 1  ON 27
 eO_8                -2.327753e-01 1 1  ON 28
 eO_9                -1.012952e-01 1 1  ON 29
eH1_0                -2.596254e-01 1 1  ON 30
eH1_1                -1.545945e-01 1 1  ON 31
eH1_2                -1.054378e-01 1 1  ON 32
eH1_3                -4.961818e-02 1 1  ON 33
eH1_4                -6.065921e-05 1 1  ON 34
eH1_5                 3.542047e-02 1 1  ON 35
eH1_6                 9.719082e-02 1 1  ON 36
eH1_7                 1.577018e-01 1 1  ON 37
eH1_8                 1.905631e-01 1 1  ON 38
eH1_9                 8.862364e-02 1 1  ON 39
eH2_0                -2.591692e-01 1 1  ON 40
eH2_1                -1.537956e-01 1 1  ON 41
eH2_2                -1.049192e-01 1 1  ON 42
eH2_3                -4.972071e-02 1 1  ON 43
eH2_4                 5.290870e-04 1 1  ON 44
eH2_5                 3.633038e-02 1 1  ON 45
eH2_6                 9.962249e-02 1 1  ON 46
eH2_7                 1.593073e-01 1 1  ON 47
eH2_8                 1.983916e-01 1 1  ON 48
eH2_9                 8.585936e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9162e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9359
    reference variance = 0.778476
====================================================
  Execution time = 2.0410e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4114e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341143245313
                                         uncertainty =       0.004575495558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341143245313
                                         uncertainty =       0.004575495558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413000397
  error estimate for blocks of size 2^( 2) =       0.000425481720
  error estimate for blocks of size 2^( 3) =       0.000438053512
  error estimate for blocks of size 2^( 4) =       0.000450173419
  error estimate for blocks of size 2^( 5) =       0.000460503846
  error estimate for blocks of size 2^( 6) =       0.000470119393
  error estimate for blocks of size 2^( 7) =       0.000475343657

      target function =                  N/A
              le_mean =     -16.906698848422
             les_mean =     286.177604437031
             stat err =       0.000464035079
             autocorr =       1.262410755321
              std dev =       0.584070763138
             le_variance =       0.341138656353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690669884842e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906698848422       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906700141940       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906702074047       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906705497312       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906708165543       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906705669730       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906703623647       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906710276040       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906713999832       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906716410869       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906715411274       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906715920890       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906719849316       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906722368206       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906721592795       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906722651480       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906723123607       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906722950168       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906722991977       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.311735e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906698848422       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906699969908       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906701593352       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906704834439       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906706520739       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703677560       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906704171129       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906707772379       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906708886622       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906708319491       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906708288789       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906708184765       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906708655956       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906708921174       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.865497e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906698848422       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906699580472       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906700663778       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906703020288       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906703079271       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703040476       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906702752295       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906703988199       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906703315183       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906703456041       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906703329423       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.456769e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190775 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5967e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.112333e-01 1 1  ON 0
 uu_1                 1.438029e-01 1 1  ON 1
 uu_2                 4.172746e-02 1 1  ON 2
 uu_3                -2.151021e-02 1 1  ON 3
 uu_4                -6.787758e-02 1 1  ON 4
 uu_5                -1.039486e-01 1 1  ON 5
 uu_6                -1.326752e-01 1 1  ON 6
 uu_7                -1.485490e-01 1 1  ON 7
 uu_8                -1.418198e-01 1 1  ON 8
 uu_9                -1.116771e-01 1 1  ON 9
 ud_0                 4.517519e-01 1 1  ON 10
 ud_1                 1.858649e-01 1 1  ON 11
 ud_2                 6.534826e-02 1 1  ON 12
 ud_3                -5.849136e-03 1 1  ON 13
 ud_4                -6.356656e-02 1 1  ON 14
 ud_5                -1.063073e-01 1 1  ON 15
 ud_6                -1.350766e-01 1 1  ON 16
 ud_7                -1.536712e-01 1 1  ON 17
 ud_8                -1.554421e-01 1 1  ON 18
 ud_9                -1.448554e-01 1 1  ON 19
 eO_0                -7.535759e-01 1 1  ON 20
 eO_1                -4.320473e-01 1 1  ON 21
 eO_2                -1.763965e-02 1 1  ON 22
 eO_3                 2.993645e-01 1 1  ON 23
 eO_4                 5.275461e-01 1 1  ON 24
 eO_5                 4.926618e-01 1 1  ON 25
 eO_6                 2.679130e-01 1 1  ON 26
 eO_7                -3.863332e-02 1 1  ON 27
 eO_8                -2.366019e-01 1 1  ON 28
 eO_9                -1.043710e-01 1 1  ON 29
eH1_0                -2.609881e-01 1 1  ON 30
eH1_1                -1.555956e-01 1 1  ON 31
eH1_2                -1.066435e-01 1 1  ON 32
eH1_3                -5.107464e-02 1 1  ON 33
eH1_4                -1.664290e-03 1 1  ON 34
eH1_5                 3.426758e-02 1 1  ON 35
eH1_6                 9.557181e-02 1 1  ON 36
eH1_7                 1.572442e-01 1 1  ON 37
eH1_8                 1.932268e-01 1 1  ON 38
eH1_9                 9.448914e-02 1 1  ON 39
eH2_0                -2.603987e-01 1 1  ON 40
eH2_1                -1.542742e-01 1 1  ON 41
eH2_2                -1.053760e-01 1 1  ON 42
eH2_3                -4.983076e-02 1 1  ON 43
eH2_4                -1.488537e-05 1 1  ON 44
eH2_5                 3.628843e-02 1 1  ON 45
eH2_6                 9.725392e-02 1 1  ON 46
eH2_7                 1.586160e-01 1 1  ON 47
eH2_8                 1.999335e-01 1 1  ON 48
eH2_9                 9.002031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8752
    reference variance = 0.230181
====================================================
  Execution time = 2.0067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3862e-01
  Total weights = 2.0000e+06
  Execution time = 1.8799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338548671928
                                         uncertainty =       0.004208137047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338548671928
                                         uncertainty =       0.004208137047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411425278
  error estimate for blocks of size 2^( 2) =       0.000424124308
  error estimate for blocks of size 2^( 3) =       0.000437638176
  error estimate for blocks of size 2^( 4) =       0.000451141614
  error estimate for blocks of size 2^( 5) =       0.000461792568
  error estimate for blocks of size 2^( 6) =       0.000471065752
  error estimate for blocks of size 2^( 7) =       0.000478325126

      target function =                  N/A
              le_mean =     -16.906221099376
             les_mean =     286.158853211121
             stat err =       0.000465581265
             autocorr =       1.280586881819
              std dev =       0.581843208620
             le_variance =       0.338541519418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338784639286
                                         uncertainty =       0.004210193646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338784639286
                                         uncertainty =       0.004210193646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411568630
  error estimate for blocks of size 2^( 2) =       0.000424257637
  error estimate for blocks of size 2^( 3) =       0.000437752373
  error estimate for blocks of size 2^( 4) =       0.000451231436
  error estimate for blocks of size 2^( 5) =       0.000461869685
  error estimate for blocks of size 2^( 6) =       0.000471151058
  error estimate for blocks of size 2^( 7) =       0.000478402215

      target function =                  N/A
              le_mean =     -16.906221174199
             les_mean =     286.159091696285
             stat err =       0.000465663599
             autocorr =       1.280147608093
              std dev =       0.582045938682
             le_variance =       0.338777474736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338730052900
                                         uncertainty =       0.004209064609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338730052900
                                         uncertainty =       0.004209064609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411535380
  error estimate for blocks of size 2^( 2) =       0.000424229490
  error estimate for blocks of size 2^( 3) =       0.000437736840
  error estimate for blocks of size 2^( 4) =       0.000451228895
  error estimate for blocks of size 2^( 5) =       0.000461880716
  error estimate for blocks of size 2^( 6) =       0.000471167123
  error estimate for blocks of size 2^( 7) =       0.000478422710

      target function =                  N/A
              le_mean =     -16.906223426656
             les_mean =     286.159113120511
             stat err =       0.000465674861
             autocorr =       1.280416411794
              std dev =       0.581998915674
             le_variance =       0.338722737846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652159898
                                         uncertainty =       0.004209095808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652159898
                                         uncertainty =       0.004209095808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411488092
  error estimate for blocks of size 2^( 2) =       0.000424184286
  error estimate for blocks of size 2^( 3) =       0.000437696160
  error estimate for blocks of size 2^( 4) =       0.000451196505
  error estimate for blocks of size 2^( 5) =       0.000461846060
  error estimate for blocks of size 2^( 6) =       0.000471120233
  error estimate for blocks of size 2^( 7) =       0.000478379035

      target function =                  N/A
              le_mean =     -16.906219069630
             les_mean =     286.158887960151
             stat err =       0.000465635458
             autocorr =       1.280493994728
              std dev =       0.581932039983
             le_variance =       0.338644899158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906221099376        initial
     9.7656e-03     9.7656e-02             2.3117e-02       -16.906221174199
     3.9062e-02     3.9062e-01             5.8655e-03       -16.906223426656  <--
     1.5625e-01     1.5625e+00             1.4568e-03       -16.906219069630

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 2.9519e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.112333e-01 1 1  ON 0
 uu_1                 1.438029e-01 1 1  ON 1
 uu_2                 4.172746e-02 1 1  ON 2
 uu_3                -2.151021e-02 1 1  ON 3
 uu_4                -6.787758e-02 1 1  ON 4
 uu_5                -1.039486e-01 1 1  ON 5
 uu_6                -1.326752e-01 1 1  ON 6
 uu_7                -1.485490e-01 1 1  ON 7
 uu_8                -1.418198e-01 1 1  ON 8
 uu_9                -1.116771e-01 1 1  ON 9
 ud_0                 4.517519e-01 1 1  ON 10
 ud_1                 1.858649e-01 1 1  ON 11
 ud_2                 6.534826e-02 1 1  ON 12
 ud_3                -5.849136e-03 1 1  ON 13
 ud_4                -6.356656e-02 1 1  ON 14
 ud_5                -1.063073e-01 1 1  ON 15
 ud_6                -1.350766e-01 1 1  ON 16
 ud_7                -1.536712e-01 1 1  ON 17
 ud_8                -1.554421e-01 1 1  ON 18
 ud_9                -1.448554e-01 1 1  ON 19
 eO_0                -7.535759e-01 1 1  ON 20
 eO_1                -4.320473e-01 1 1  ON 21
 eO_2                -1.763965e-02 1 1  ON 22
 eO_3                 2.993645e-01 1 1  ON 23
 eO_4                 5.275461e-01 1 1  ON 24
 eO_5                 4.926618e-01 1 1  ON 25
 eO_6                 2.679130e-01 1 1  ON 26
 eO_7                -3.863332e-02 1 1  ON 27
 eO_8                -2.366019e-01 1 1  ON 28
 eO_9                -1.043710e-01 1 1  ON 29
eH1_0                -2.609881e-01 1 1  ON 30
eH1_1                -1.555956e-01 1 1  ON 31
eH1_2                -1.066435e-01 1 1  ON 32
eH1_3                -5.107464e-02 1 1  ON 33
eH1_4                -1.664290e-03 1 1  ON 34
eH1_5                 3.426758e-02 1 1  ON 35
eH1_6                 9.557181e-02 1 1  ON 36
eH1_7                 1.572442e-01 1 1  ON 37
eH1_8                 1.932268e-01 1 1  ON 38
eH1_9                 9.448914e-02 1 1  ON 39
eH2_0                -2.603987e-01 1 1  ON 40
eH2_1                -1.542742e-01 1 1  ON 41
eH2_2                -1.053760e-01 1 1  ON 42
eH2_3                -4.983076e-02 1 1  ON 43
eH2_4                -1.488537e-05 1 1  ON 44
eH2_5                 3.628843e-02 1 1  ON 45
eH2_6                 9.725392e-02 1 1  ON 46
eH2_7                 1.586160e-01 1 1  ON 47
eH2_8                 1.999335e-01 1 1  ON 48
eH2_9                 9.002031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5493e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9015
    reference variance = 0.421016
====================================================
  Execution time = 2.0526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4031e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6047e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416154617
                                         uncertainty =       0.002986602342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416154617
                                         uncertainty =       0.002986602342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412501514
  error estimate for blocks of size 2^( 2) =       0.000425344869
  error estimate for blocks of size 2^( 3) =       0.000438276185
  error estimate for blocks of size 2^( 4) =       0.000451430330
  error estimate for blocks of size 2^( 5) =       0.000461731068
  error estimate for blocks of size 2^( 6) =       0.000470911570
  error estimate for blocks of size 2^( 7) =       0.000476969866

      target function =                  N/A
              le_mean =     -16.906353988021
             les_mean =     286.165119996590
             stat err =       0.000465260708
             autocorr =       1.272159779396
              std dev =       0.583365235907
             le_variance =       0.340314998464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635398802e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906353988021       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906358122067       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906358337051       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906356100477       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906358012479       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906350159353       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906348780817       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906350569744       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906350843239       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906358772474       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906359116554       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906366166919       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906363738780       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906364053061       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906365995290       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906365312563       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906365123107       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906364950081       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906365846559       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906365925901       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 1.751767e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906353988021       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906357710157       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906357864882       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906356021589       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906357884065       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906351955163       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906350176716       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906352000397       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906352663159       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906356295802       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906355802374       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906357428019       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906356705217       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906356602973       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.422917e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906353988021       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906356649439       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906356790075       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906355983265       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906356702952       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906352945945       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906353110690       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906353578221       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906354751723       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906354416259       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906354847243       residual = 6.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.107918e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6143e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.101537e-01 1 1  ON 0
 uu_1                 1.435159e-01 1 1  ON 1
 uu_2                 4.138304e-02 1 1  ON 2
 uu_3                -2.131869e-02 1 1  ON 3
 uu_4                -6.784067e-02 1 1  ON 4
 uu_5                -1.039281e-01 1 1  ON 5
 uu_6                -1.325247e-01 1 1  ON 6
 uu_7                -1.481086e-01 1 1  ON 7
 uu_8                -1.426906e-01 1 1  ON 8
 uu_9                -1.136226e-01 1 1  ON 9
 ud_0                 4.523280e-01 1 1  ON 10
 ud_1                 1.865888e-01 1 1  ON 11
 ud_2                 6.609614e-02 1 1  ON 12
 ud_3                -5.466401e-03 1 1  ON 13
 ud_4                -6.326641e-02 1 1  ON 14
 ud_5                -1.059244e-01 1 1  ON 15
 ud_6                -1.345370e-01 1 1  ON 16
 ud_7                -1.526250e-01 1 1  ON 17
 ud_8                -1.552129e-01 1 1  ON 18
 ud_9                -1.467847e-01 1 1  ON 19
 eO_0                -7.523226e-01 1 1  ON 20
 eO_1                -4.313241e-01 1 1  ON 21
 eO_2                -1.677346e-02 1 1  ON 22
 eO_3                 3.003770e-01 1 1  ON 23
 eO_4                 5.293830e-01 1 1  ON 24
 eO_5                 4.939173e-01 1 1  ON 25
 eO_6                 2.677013e-01 1 1  ON 26
 eO_7                -3.886169e-02 1 1  ON 27
 eO_8                -2.390702e-01 1 1  ON 28
 eO_9                -1.078211e-01 1 1  ON 29
eH1_0                -2.621384e-01 1 1  ON 30
eH1_1                -1.564033e-01 1 1  ON 31
eH1_2                -1.079191e-01 1 1  ON 32
eH1_3                -5.268950e-02 1 1  ON 33
eH1_4                -2.692578e-03 1 1  ON 34
eH1_5                 3.365969e-02 1 1  ON 35
eH1_6                 9.489769e-02 1 1  ON 36
eH1_7                 1.571639e-01 1 1  ON 37
eH1_8                 1.955100e-01 1 1  ON 38
eH1_9                 9.891205e-02 1 1  ON 39
eH2_0                -2.615302e-01 1 1  ON 40
eH2_1                -1.551638e-01 1 1  ON 41
eH2_2                -1.063477e-01 1 1  ON 42
eH2_3                -5.098450e-02 1 1  ON 43
eH2_4                -1.188080e-03 1 1  ON 44
eH2_5                 3.453430e-02 1 1  ON 45
eH2_6                 9.639265e-02 1 1  ON 46
eH2_7                 1.604028e-01 1 1  ON 47
eH2_8                 2.018366e-01 1 1  ON 48
eH2_9                 9.390611e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8585
    reference variance = 0.24225
====================================================
  Execution time = 1.9905e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3533e-01
  Total weights = 2.0000e+06
  Execution time = 1.8752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335702950699
                                         uncertainty =       0.003052826163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335702950699
                                         uncertainty =       0.003052826163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409696776
  error estimate for blocks of size 2^( 2) =       0.000422257427
  error estimate for blocks of size 2^( 3) =       0.000435780605
  error estimate for blocks of size 2^( 4) =       0.000448336335
  error estimate for blocks of size 2^( 5) =       0.000459383602
  error estimate for blocks of size 2^( 6) =       0.000468108047
  error estimate for blocks of size 2^( 7) =       0.000471676671

      target function =                  N/A
              le_mean =     -16.906763397371
             les_mean =     286.174351304180
             stat err =       0.000461876164
             autocorr =       1.270942804762
              std dev =       0.579398737773
             le_variance =       0.335702897333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335243865013
                                         uncertainty =       0.003053237594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335243865013
                                         uncertainty =       0.003053237594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409416544
  error estimate for blocks of size 2^( 2) =       0.000421986841
  error estimate for blocks of size 2^( 3) =       0.000435520462
  error estimate for blocks of size 2^( 4) =       0.000448074268
  error estimate for blocks of size 2^( 5) =       0.000459107831
  error estimate for blocks of size 2^( 6) =       0.000467795536
  error estimate for blocks of size 2^( 7) =       0.000471334732

      target function =                  N/A
              le_mean =     -16.906756341316
             les_mean =     286.173653630483
             stat err =       0.000461578092
             autocorr =       1.271041111132
              std dev =       0.579002429596
             le_variance =       0.335243813478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334981543559
                                         uncertainty =       0.003054175945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334981543559
                                         uncertainty =       0.003054175945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409256299
  error estimate for blocks of size 2^( 2) =       0.000421837756
  error estimate for blocks of size 2^( 3) =       0.000435387297
  error estimate for blocks of size 2^( 4) =       0.000447954112
  error estimate for blocks of size 2^( 5) =       0.000458998623
  error estimate for blocks of size 2^( 6) =       0.000467685765
  error estimate for blocks of size 2^( 7) =       0.000471222840

      target function =                  N/A
              le_mean =     -16.906757129117
             les_mean =     286.173417892184
             stat err =       0.000461465335
             autocorr =       1.271415259975
              std dev =       0.578775808687
             le_variance =       0.334981436722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335413262448
                                         uncertainty =       0.003052941139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335413262448
                                         uncertainty =       0.003052941139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409519947
  error estimate for blocks of size 2^( 2) =       0.000422089716
  error estimate for blocks of size 2^( 3) =       0.000435623551
  error estimate for blocks of size 2^( 4) =       0.000448185274
  error estimate for blocks of size 2^( 5) =       0.000459233875
  error estimate for blocks of size 2^( 6) =       0.000467949773
  error estimate for blocks of size 2^( 7) =       0.000471510297

      target function =                  N/A
              le_mean =     -16.906759823381
             les_mean =     286.173940732327
             stat err =       0.000461719805
             autocorr =       1.271179514335
              std dev =       0.579148663593
             le_variance =       0.335413174542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906763397371        initial  <--
     9.7656e-03     9.7656e-02             1.7518e-02       -16.906756341316
     3.9062e-02     3.9062e-01             4.4229e-03       -16.906757129117
     1.5625e-01     1.5625e+00             1.1079e-03       -16.906759823381

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3445
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.112333e-01 1 1  ON 0
 uu_1                 1.438029e-01 1 1  ON 1
 uu_2                 4.172746e-02 1 1  ON 2
 uu_3                -2.151021e-02 1 1  ON 3
 uu_4                -6.787758e-02 1 1  ON 4
 uu_5                -1.039486e-01 1 1  ON 5
 uu_6                -1.326752e-01 1 1  ON 6
 uu_7                -1.485490e-01 1 1  ON 7
 uu_8                -1.418198e-01 1 1  ON 8
 uu_9                -1.116771e-01 1 1  ON 9
 ud_0                 4.517519e-01 1 1  ON 10
 ud_1                 1.858649e-01 1 1  ON 11
 ud_2                 6.534826e-02 1 1  ON 12
 ud_3                -5.849136e-03 1 1  ON 13
 ud_4                -6.356656e-02 1 1  ON 14
 ud_5                -1.063073e-01 1 1  ON 15
 ud_6                -1.350766e-01 1 1  ON 16
 ud_7                -1.536712e-01 1 1  ON 17
 ud_8                -1.554421e-01 1 1  ON 18
 ud_9                -1.448554e-01 1 1  ON 19
 eO_0                -7.535759e-01 1 1  ON 20
 eO_1                -4.320473e-01 1 1  ON 21
 eO_2                -1.763965e-02 1 1  ON 22
 eO_3                 2.993645e-01 1 1  ON 23
 eO_4                 5.275461e-01 1 1  ON 24
 eO_5                 4.926618e-01 1 1  ON 25
 eO_6                 2.679130e-01 1 1  ON 26
 eO_7                -3.863332e-02 1 1  ON 27
 eO_8                -2.366019e-01 1 1  ON 28
 eO_9                -1.043710e-01 1 1  ON 29
eH1_0                -2.609881e-01 1 1  ON 30
eH1_1                -1.555956e-01 1 1  ON 31
eH1_2                -1.066435e-01 1 1  ON 32
eH1_3                -5.107464e-02 1 1  ON 33
eH1_4                -1.664290e-03 1 1  ON 34
eH1_5                 3.426758e-02 1 1  ON 35
eH1_6                 9.557181e-02 1 1  ON 36
eH1_7                 1.572442e-01 1 1  ON 37
eH1_8                 1.932268e-01 1 1  ON 38
eH1_9                 9.448914e-02 1 1  ON 39
eH2_0                -2.603987e-01 1 1  ON 40
eH2_1                -1.542742e-01 1 1  ON 41
eH2_2                -1.053760e-01 1 1  ON 42
eH2_3                -4.983076e-02 1 1  ON 43
eH2_4                -1.488537e-05 1 1  ON 44
eH2_5                 3.628843e-02 1 1  ON 45
eH2_6                 9.725392e-02 1 1  ON 46
eH2_7                 1.586160e-01 1 1  ON 47
eH2_8                 1.999335e-01 1 1  ON 48
eH2_9                 9.002031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9312
    reference variance = 0.348917
====================================================
  Execution time = 2.0471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5038e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350405471877
                                         uncertainty =       0.011056096388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350405471877
                                         uncertainty =       0.011056096388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418557726
  error estimate for blocks of size 2^( 2) =       0.000430980469
  error estimate for blocks of size 2^( 3) =       0.000443989409
  error estimate for blocks of size 2^( 4) =       0.000456288938
  error estimate for blocks of size 2^( 5) =       0.000467450691
  error estimate for blocks of size 2^( 6) =       0.000474037404
  error estimate for blocks of size 2^( 7) =       0.000481474450

      target function =                  N/A
              le_mean =     -16.906204671424
             les_mean =     286.170137356806
             stat err =       0.000469812871
             autocorr =       1.259908759093
              std dev =       0.591930012674
             le_variance =       0.350381139904


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620467142e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204671424       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204984993       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906204533141       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906205000888       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906207056351       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906206098050       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906207819460       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906207321550       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906207060735       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906207317656       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906207286300       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906207493640       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.205727e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204671424       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204838327       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906204688675       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906204579836       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906205529588       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906205708192       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906205632052       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906205819450       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906205595472       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.467914e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906204671424       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906204729560       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906204698287       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906204600446       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906204833788       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906204965084       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906204951843       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906204927746       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906204942285       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.388310e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203218 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6058e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.112567e-01 1 1  ON 0
 uu_1                 1.437765e-01 1 1  ON 1
 uu_2                 4.155176e-02 1 1  ON 2
 uu_3                -2.156893e-02 1 1  ON 3
 uu_4                -6.785401e-02 1 1  ON 4
 uu_5                -1.042015e-01 1 1  ON 5
 uu_6                -1.329545e-01 1 1  ON 6
 uu_7                -1.484960e-01 1 1  ON 7
 uu_8                -1.417091e-01 1 1  ON 8
 uu_9                -1.117011e-01 1 1  ON 9
 ud_0                 4.519481e-01 1 1  ON 10
 ud_1                 1.858255e-01 1 1  ON 11
 ud_2                 6.527119e-02 1 1  ON 12
 ud_3                -6.004783e-03 1 1  ON 13
 ud_4                -6.359859e-02 1 1  ON 14
 ud_5                -1.063166e-01 1 1  ON 15
 ud_6                -1.352520e-01 1 1  ON 16
 ud_7                -1.534942e-01 1 1  ON 17
 ud_8                -1.553014e-01 1 1  ON 18
 ud_9                -1.447893e-01 1 1  ON 19
 eO_0                -7.535508e-01 1 1  ON 20
 eO_1                -4.319935e-01 1 1  ON 21
 eO_2                -1.734727e-02 1 1  ON 22
 eO_3                 2.994102e-01 1 1  ON 23
 eO_4                 5.275882e-01 1 1  ON 24
 eO_5                 4.927120e-01 1 1  ON 25
 eO_6                 2.677215e-01 1 1  ON 26
 eO_7                -3.862627e-02 1 1  ON 27
 eO_8                -2.366133e-01 1 1  ON 28
 eO_9                -1.046160e-01 1 1  ON 29
eH1_0                -2.611366e-01 1 1  ON 30
eH1_1                -1.558897e-01 1 1  ON 31
eH1_2                -1.067775e-01 1 1  ON 32
eH1_3                -5.114769e-02 1 1  ON 33
eH1_4                -1.762964e-03 1 1  ON 34
eH1_5                 3.398142e-02 1 1  ON 35
eH1_6                 9.558290e-02 1 1  ON 36
eH1_7                 1.572862e-01 1 1  ON 37
eH1_8                 1.934803e-01 1 1  ON 38
eH1_9                 9.503593e-02 1 1  ON 39
eH2_0                -2.605162e-01 1 1  ON 40
eH2_1                -1.546325e-01 1 1  ON 41
eH2_2                -1.053590e-01 1 1  ON 42
eH2_3                -4.983174e-02 1 1  ON 43
eH2_4                -3.097724e-04 1 1  ON 44
eH2_5                 3.615405e-02 1 1  ON 45
eH2_6                 9.727235e-02 1 1  ON 46
eH2_7                 1.587080e-01 1 1  ON 47
eH2_8                 2.001405e-01 1 1  ON 48
eH2_9                 9.052405e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8932
    reference variance = 0.274626
====================================================
  Execution time = 1.9825e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5741e-01
  Total weights = 2.0000e+06
  Execution time = 1.8701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357194399407
                                         uncertainty =       0.009747441853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357194399407
                                         uncertainty =       0.009747441853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422569778
  error estimate for blocks of size 2^( 2) =       0.000434721597
  error estimate for blocks of size 2^( 3) =       0.000446793318
  error estimate for blocks of size 2^( 4) =       0.000458020032
  error estimate for blocks of size 2^( 5) =       0.000467372437
  error estimate for blocks of size 2^( 6) =       0.000474832401
  error estimate for blocks of size 2^( 7) =       0.000480394274

      target function =                  N/A
              le_mean =     -16.906730914854
             les_mean =     286.194680482595
             stat err =       0.000470154786
             autocorr =       1.237897988761
              std dev =       0.597603910523
             le_variance =       0.357130433873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357660082742
                                         uncertainty =       0.009758585343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357660082742
                                         uncertainty =       0.009758585343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422844984
  error estimate for blocks of size 2^( 2) =       0.000434987844
  error estimate for blocks of size 2^( 3) =       0.000447052328
  error estimate for blocks of size 2^( 4) =       0.000458270360
  error estimate for blocks of size 2^( 5) =       0.000467613854
  error estimate for blocks of size 2^( 6) =       0.000475070516
  error estimate for blocks of size 2^( 7) =       0.000480636979

      target function =                  N/A
              le_mean =     -16.906730245751
             les_mean =     286.195123185034
             stat err =       0.000470397927
             autocorr =       1.237566179914
              std dev =       0.597993111374
             le_variance =       0.357595761251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357763786900
                                         uncertainty =       0.009761843490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357763786900
                                         uncertainty =       0.009761843490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422906267
  error estimate for blocks of size 2^( 2) =       0.000435046211
  error estimate for blocks of size 2^( 3) =       0.000447107564
  error estimate for blocks of size 2^( 4) =       0.000458322780
  error estimate for blocks of size 2^( 5) =       0.000467665967
  error estimate for blocks of size 2^( 6) =       0.000475123563
  error estimate for blocks of size 2^( 7) =       0.000480690344

      target function =                  N/A
              le_mean =     -16.906731104758
             les_mean =     286.195255891105
             stat err =       0.000470450664
             autocorr =       1.237484959075
              std dev =       0.598079778424
             le_variance =       0.357699421360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357310775291
                                         uncertainty =       0.009750474861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357310775291
                                         uncertainty =       0.009750474861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422638574
  error estimate for blocks of size 2^( 2) =       0.000434787772
  error estimate for blocks of size 2^( 3) =       0.000446857195
  error estimate for blocks of size 2^( 4) =       0.000458081462
  error estimate for blocks of size 2^( 5) =       0.000467432259
  error estimate for blocks of size 2^( 6) =       0.000474891788
  error estimate for blocks of size 2^( 7) =       0.000480454383

      target function =                  N/A
              le_mean =     -16.906730879157
             les_mean =     286.194795569258
             stat err =       0.000470214973
             autocorr =       1.237811874284
              std dev =       0.597701202650
             le_variance =       0.357246727650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906730914854        initial
     9.7656e-02     9.7656e-01             2.2057e-03       -16.906730245751
     3.9062e-01     3.9062e+00             5.4679e-04       -16.906731104758  <--
     1.5625e+00     1.5625e+01             1.3883e-04       -16.906730879157

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9368e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.112567e-01 1 1  ON 0
 uu_1                 1.437765e-01 1 1  ON 1
 uu_2                 4.155176e-02 1 1  ON 2
 uu_3                -2.156893e-02 1 1  ON 3
 uu_4                -6.785401e-02 1 1  ON 4
 uu_5                -1.042015e-01 1 1  ON 5
 uu_6                -1.329545e-01 1 1  ON 6
 uu_7                -1.484960e-01 1 1  ON 7
 uu_8                -1.417091e-01 1 1  ON 8
 uu_9                -1.117011e-01 1 1  ON 9
 ud_0                 4.519481e-01 1 1  ON 10
 ud_1                 1.858255e-01 1 1  ON 11
 ud_2                 6.527119e-02 1 1  ON 12
 ud_3                -6.004783e-03 1 1  ON 13
 ud_4                -6.359859e-02 1 1  ON 14
 ud_5                -1.063166e-01 1 1  ON 15
 ud_6                -1.352520e-01 1 1  ON 16
 ud_7                -1.534942e-01 1 1  ON 17
 ud_8                -1.553014e-01 1 1  ON 18
 ud_9                -1.447893e-01 1 1  ON 19
 eO_0                -7.535508e-01 1 1  ON 20
 eO_1                -4.319935e-01 1 1  ON 21
 eO_2                -1.734727e-02 1 1  ON 22
 eO_3                 2.994102e-01 1 1  ON 23
 eO_4                 5.275882e-01 1 1  ON 24
 eO_5                 4.927120e-01 1 1  ON 25
 eO_6                 2.677215e-01 1 1  ON 26
 eO_7                -3.862627e-02 1 1  ON 27
 eO_8                -2.366133e-01 1 1  ON 28
 eO_9                -1.046160e-01 1 1  ON 29
eH1_0                -2.611366e-01 1 1  ON 30
eH1_1                -1.558897e-01 1 1  ON 31
eH1_2                -1.067775e-01 1 1  ON 32
eH1_3                -5.114769e-02 1 1  ON 33
eH1_4                -1.762964e-03 1 1  ON 34
eH1_5                 3.398142e-02 1 1  ON 35
eH1_6                 9.558290e-02 1 1  ON 36
eH1_7                 1.572862e-01 1 1  ON 37
eH1_8                 1.934803e-01 1 1  ON 38
eH1_9                 9.503593e-02 1 1  ON 39
eH2_0                -2.605162e-01 1 1  ON 40
eH2_1                -1.546325e-01 1 1  ON 41
eH2_2                -1.053590e-01 1 1  ON 42
eH2_3                -4.983174e-02 1 1  ON 43
eH2_4                -3.097724e-04 1 1  ON 44
eH2_5                 3.615405e-02 1 1  ON 45
eH2_6                 9.727235e-02 1 1  ON 46
eH2_7                 1.587080e-01 1 1  ON 47
eH2_8                 2.001405e-01 1 1  ON 48
eH2_9                 9.052405e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5433e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8926
    reference variance = 0.264803
====================================================
  Execution time = 2.0436e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5102e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351050815728
                                         uncertainty =       0.015255072274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351050815728
                                         uncertainty =       0.015255072274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418940033
  error estimate for blocks of size 2^( 2) =       0.000431682403
  error estimate for blocks of size 2^( 3) =       0.000445053109
  error estimate for blocks of size 2^( 4) =       0.000457701220
  error estimate for blocks of size 2^( 5) =       0.000468391712
  error estimate for blocks of size 2^( 6) =       0.000477263368
  error estimate for blocks of size 2^( 7) =       0.000484492728

      target function =                  N/A
              le_mean =     -16.906314370397
             les_mean =     286.174486918038
             stat err =       0.000471962257
             autocorr =       1.269143741578
              std dev =       0.592470676784
             le_variance =       0.351021502849


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631437040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906314370397       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906314713337       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906317206874       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906318213376       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906320148054       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906317734356       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906318955113       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906319860350       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906318635683       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906317689227       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906318074234       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906318537078       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906319025837       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.683672e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906314370397       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906314539665       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906315449351       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906315919177       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906316588212       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906315990231       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906316221210       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906316564336       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906316228141       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 6.523331e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906314370397       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906314426341       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906314697366       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906314801410       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906314918505       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906314835705       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906314894622       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906314963049       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.613385e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207129 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5949e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.111480e-01 1 1  ON 0
 uu_1                 1.437122e-01 1 1  ON 1
 uu_2                 4.149879e-02 1 1  ON 2
 uu_3                -2.163065e-02 1 1  ON 3
 uu_4                -6.789785e-02 1 1  ON 4
 uu_5                -1.040829e-01 1 1  ON 5
 uu_6                -1.333883e-01 1 1  ON 6
 uu_7                -1.486629e-01 1 1  ON 7
 uu_8                -1.415172e-01 1 1  ON 8
 uu_9                -1.115618e-01 1 1  ON 9
 ud_0                 4.518021e-01 1 1  ON 10
 ud_1                 1.857080e-01 1 1  ON 11
 ud_2                 6.521936e-02 1 1  ON 12
 ud_3                -6.230649e-03 1 1  ON 13
 ud_4                -6.377477e-02 1 1  ON 14
 ud_5                -1.064557e-01 1 1  ON 15
 ud_6                -1.352942e-01 1 1  ON 16
 ud_7                -1.534854e-01 1 1  ON 17
 ud_8                -1.549289e-01 1 1  ON 18
 ud_9                -1.443146e-01 1 1  ON 19
 eO_0                -7.535033e-01 1 1  ON 20
 eO_1                -4.319438e-01 1 1  ON 21
 eO_2                -1.719757e-02 1 1  ON 22
 eO_3                 2.994988e-01 1 1  ON 23
 eO_4                 5.274723e-01 1 1  ON 24
 eO_5                 4.927169e-01 1 1  ON 25
 eO_6                 2.675629e-01 1 1  ON 26
 eO_7                -3.851487e-02 1 1  ON 27
 eO_8                -2.365130e-01 1 1  ON 28
 eO_9                -1.048075e-01 1 1  ON 29
eH1_0                -2.611652e-01 1 1  ON 30
eH1_1                -1.559375e-01 1 1  ON 31
eH1_2                -1.068708e-01 1 1  ON 32
eH1_3                -5.137881e-02 1 1  ON 33
eH1_4                -1.888694e-03 1 1  ON 34
eH1_5                 3.387359e-02 1 1  ON 35
eH1_6                 9.532791e-02 1 1  ON 36
eH1_7                 1.573104e-01 1 1  ON 37
eH1_8                 1.938136e-01 1 1  ON 38
eH1_9                 9.550851e-02 1 1  ON 39
eH2_0                -2.608212e-01 1 1  ON 40
eH2_1                -1.548629e-01 1 1  ON 41
eH2_2                -1.055568e-01 1 1  ON 42
eH2_3                -5.000514e-02 1 1  ON 43
eH2_4                -3.528809e-04 1 1  ON 44
eH2_5                 3.610973e-02 1 1  ON 45
eH2_6                 9.729178e-02 1 1  ON 46
eH2_7                 1.586630e-01 1 1  ON 47
eH2_8                 2.003439e-01 1 1  ON 48
eH2_9                 9.117638e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9808
    reference variance = 0.439117
====================================================
  Execution time = 2.0051e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4379e-01
  Total weights = 2.0000e+06
  Execution time = 1.8537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343916182132
                                         uncertainty =       0.007729105939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343916182132
                                         uncertainty =       0.007729105939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414644879
  error estimate for blocks of size 2^( 2) =       0.000427134133
  error estimate for blocks of size 2^( 3) =       0.000439887757
  error estimate for blocks of size 2^( 4) =       0.000451158086
  error estimate for blocks of size 2^( 5) =       0.000460544000
  error estimate for blocks of size 2^( 6) =       0.000467343179
  error estimate for blocks of size 2^( 7) =       0.000469288587

      target function =                  N/A
              le_mean =     -16.906452487097
             les_mean =     286.171996277750
             stat err =       0.000462083463
             autocorr =       1.241904615258
              std dev =       0.586396411313
             le_variance =       0.343860751201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343854254400
                                         uncertainty =       0.007730558579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343854254400
                                         uncertainty =       0.007730558579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414607478
  error estimate for blocks of size 2^( 2) =       0.000427105312
  error estimate for blocks of size 2^( 3) =       0.000439866906
  error estimate for blocks of size 2^( 4) =       0.000451140721
  error estimate for blocks of size 2^( 5) =       0.000460520299
  error estimate for blocks of size 2^( 6) =       0.000467311154
  error estimate for blocks of size 2^( 7) =       0.000469250445

      target function =                  N/A
              le_mean =     -16.906453136094
             les_mean =     286.171956192267
             stat err =       0.000462055655
             autocorr =       1.241979187601
              std dev =       0.586343518116
             le_variance =       0.343798721237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343787557794
                                         uncertainty =       0.007729179999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343787557794
                                         uncertainty =       0.007729179999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414567255
  error estimate for blocks of size 2^( 2) =       0.000427065130
  error estimate for blocks of size 2^( 3) =       0.000439825719
  error estimate for blocks of size 2^( 4) =       0.000451098545
  error estimate for blocks of size 2^( 5) =       0.000460479936
  error estimate for blocks of size 2^( 6) =       0.000467271924
  error estimate for blocks of size 2^( 7) =       0.000469215881

      target function =                  N/A
              le_mean =     -16.906453597791
             les_mean =     286.171905101018
             stat err =       0.000462016571
             autocorr =       1.242010058049
              std dev =       0.586286635212
             le_variance =       0.343732018629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343889752577
                                         uncertainty =       0.007728859130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343889752577
                                         uncertainty =       0.007728859130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414628930
  error estimate for blocks of size 2^( 2) =       0.000427119637
  error estimate for blocks of size 2^( 3) =       0.000439874335
  error estimate for blocks of size 2^( 4) =       0.000451145079
  error estimate for blocks of size 2^( 5) =       0.000460530405
  error estimate for blocks of size 2^( 6) =       0.000467328372
  error estimate for blocks of size 2^( 7) =       0.000469273890

      target function =                  N/A
              le_mean =     -16.906452627159
             les_mean =     286.171974561574
             stat err =       0.000462069436
             autocorr =       1.241924756463
              std dev =       0.586373856093
             le_variance =       0.343834299109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906452487097        initial
     9.7656e-02     9.7656e-01             2.6837e-03       -16.906453136094
     3.9062e-01     3.9062e+00             6.5233e-04       -16.906453597791  <--
     1.5625e+00     1.5625e+01             1.6134e-04       -16.906452627159

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9404e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.111480e-01 1 1  ON 0
 uu_1                 1.437122e-01 1 1  ON 1
 uu_2                 4.149879e-02 1 1  ON 2
 uu_3                -2.163065e-02 1 1  ON 3
 uu_4                -6.789785e-02 1 1  ON 4
 uu_5                -1.040829e-01 1 1  ON 5
 uu_6                -1.333883e-01 1 1  ON 6
 uu_7                -1.486629e-01 1 1  ON 7
 uu_8                -1.415172e-01 1 1  ON 8
 uu_9                -1.115618e-01 1 1  ON 9
 ud_0                 4.518021e-01 1 1  ON 10
 ud_1                 1.857080e-01 1 1  ON 11
 ud_2                 6.521936e-02 1 1  ON 12
 ud_3                -6.230649e-03 1 1  ON 13
 ud_4                -6.377477e-02 1 1  ON 14
 ud_5                -1.064557e-01 1 1  ON 15
 ud_6                -1.352942e-01 1 1  ON 16
 ud_7                -1.534854e-01 1 1  ON 17
 ud_8                -1.549289e-01 1 1  ON 18
 ud_9                -1.443146e-01 1 1  ON 19
 eO_0                -7.535033e-01 1 1  ON 20
 eO_1                -4.319438e-01 1 1  ON 21
 eO_2                -1.719757e-02 1 1  ON 22
 eO_3                 2.994988e-01 1 1  ON 23
 eO_4                 5.274723e-01 1 1  ON 24
 eO_5                 4.927169e-01 1 1  ON 25
 eO_6                 2.675629e-01 1 1  ON 26
 eO_7                -3.851487e-02 1 1  ON 27
 eO_8                -2.365130e-01 1 1  ON 28
 eO_9                -1.048075e-01 1 1  ON 29
eH1_0                -2.611652e-01 1 1  ON 30
eH1_1                -1.559375e-01 1 1  ON 31
eH1_2                -1.068708e-01 1 1  ON 32
eH1_3                -5.137881e-02 1 1  ON 33
eH1_4                -1.888694e-03 1 1  ON 34
eH1_5                 3.387359e-02 1 1  ON 35
eH1_6                 9.532791e-02 1 1  ON 36
eH1_7                 1.573104e-01 1 1  ON 37
eH1_8                 1.938136e-01 1 1  ON 38
eH1_9                 9.550851e-02 1 1  ON 39
eH2_0                -2.608212e-01 1 1  ON 40
eH2_1                -1.548629e-01 1 1  ON 41
eH2_2                -1.055568e-01 1 1  ON 42
eH2_3                -5.000514e-02 1 1  ON 43
eH2_4                -3.528809e-04 1 1  ON 44
eH2_5                 3.610973e-02 1 1  ON 45
eH2_6                 9.729178e-02 1 1  ON 46
eH2_7                 1.586630e-01 1 1  ON 47
eH2_8                 2.003439e-01 1 1  ON 48
eH2_9                 9.117638e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8123
    reference variance = 0.29158
====================================================
  Execution time = 2.0427e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5099e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351055030004
                                         uncertainty =       0.015384330870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351055030004
                                         uncertainty =       0.015384330870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418922962
  error estimate for blocks of size 2^( 2) =       0.000431302252
  error estimate for blocks of size 2^( 3) =       0.000444148396
  error estimate for blocks of size 2^( 4) =       0.000456357950
  error estimate for blocks of size 2^( 5) =       0.000466651303
  error estimate for blocks of size 2^( 6) =       0.000473547532
  error estimate for blocks of size 2^( 7) =       0.000477246944

      target function =                  N/A
              le_mean =     -16.906399890676
             les_mean =     286.177349983703
             stat err =       0.000468450932
             autocorr =       1.250431439950
              std dev =       0.592446534075
             le_variance =       0.350992895738


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690639989068e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906399890676       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906399033617       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906398966002       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906401431160       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906402317040       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906401080922       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906401389783       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906400826211       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906400812796       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906400731474       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906401248731       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906401722250       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.646565e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906399890676       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906399464572       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906399263995       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906400324794       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906400812615       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906400640774       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906400422202       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906400524203       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906400364615       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.083205e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906399890676       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906399749176       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906399634590       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906399915126       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906400098180       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906400162408       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906400104127       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906400135321       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.158838e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5999e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.110974e-01 1 1  ON 0
 uu_1                 1.436499e-01 1 1  ON 1
 uu_2                 4.144275e-02 1 1  ON 2
 uu_3                -2.166492e-02 1 1  ON 3
 uu_4                -6.798910e-02 1 1  ON 4
 uu_5                -1.040048e-01 1 1  ON 5
 uu_6                -1.331869e-01 1 1  ON 6
 uu_7                -1.487288e-01 1 1  ON 7
 uu_8                -1.415522e-01 1 1  ON 8
 uu_9                -1.118694e-01 1 1  ON 9
 ud_0                 4.517587e-01 1 1  ON 10
 ud_1                 1.858821e-01 1 1  ON 11
 ud_2                 6.541634e-02 1 1  ON 12
 ud_3                -6.020085e-03 1 1  ON 13
 ud_4                -6.371103e-02 1 1  ON 14
 ud_5                -1.063775e-01 1 1  ON 15
 ud_6                -1.351369e-01 1 1  ON 16
 ud_7                -1.533950e-01 1 1  ON 17
 ud_8                -1.551914e-01 1 1  ON 18
 ud_9                -1.447224e-01 1 1  ON 19
 eO_0                -7.533360e-01 1 1  ON 20
 eO_1                -4.319364e-01 1 1  ON 21
 eO_2                -1.711212e-02 1 1  ON 22
 eO_3                 2.995455e-01 1 1  ON 23
 eO_4                 5.277020e-01 1 1  ON 24
 eO_5                 4.929680e-01 1 1  ON 25
 eO_6                 2.675546e-01 1 1  ON 26
 eO_7                -3.857620e-02 1 1  ON 27
 eO_8                -2.368670e-01 1 1  ON 28
 eO_9                -1.051389e-01 1 1  ON 29
eH1_0                -2.613267e-01 1 1  ON 30
eH1_1                -1.562941e-01 1 1  ON 31
eH1_2                -1.069221e-01 1 1  ON 32
eH1_3                -5.142873e-02 1 1  ON 33
eH1_4                -2.028213e-03 1 1  ON 34
eH1_5                 3.387765e-02 1 1  ON 35
eH1_6                 9.542301e-02 1 1  ON 36
eH1_7                 1.573304e-01 1 1  ON 37
eH1_8                 1.940445e-01 1 1  ON 38
eH1_9                 9.583794e-02 1 1  ON 39
eH2_0                -2.610006e-01 1 1  ON 40
eH2_1                -1.549783e-01 1 1  ON 41
eH2_2                -1.057713e-01 1 1  ON 42
eH2_3                -5.016650e-02 1 1  ON 43
eH2_4                -1.566479e-04 1 1  ON 44
eH2_5                 3.601372e-02 1 1  ON 45
eH2_6                 9.709468e-02 1 1  ON 46
eH2_7                 1.588032e-01 1 1  ON 47
eH2_8                 2.004629e-01 1 1  ON 48
eH2_9                 9.158470e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8958
    reference variance = 0.192868
====================================================
  Execution time = 2.0073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4408e-01
  Total weights = 2.0000e+06
  Execution time = 1.8639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344367370061
                                         uncertainty =       0.007646138121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344367370061
                                         uncertainty =       0.007646138121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414916105
  error estimate for blocks of size 2^( 2) =       0.000427289014
  error estimate for blocks of size 2^( 3) =       0.000439666196
  error estimate for blocks of size 2^( 4) =       0.000451458706
  error estimate for blocks of size 2^( 5) =       0.000462041434
  error estimate for blocks of size 2^( 6) =       0.000468885392
  error estimate for blocks of size 2^( 7) =       0.000475303018

      target function =                  N/A
              le_mean =     -16.906580691588
             les_mean =     286.176781258021
             stat err =       0.000464422137
             autocorr =       1.252867778864
              std dev =       0.586779983476
             le_variance =       0.344310749008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343977669513
                                         uncertainty =       0.007639540197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343977669513
                                         uncertainty =       0.007639540197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414681331
  error estimate for blocks of size 2^( 2) =       0.000427061630
  error estimate for blocks of size 2^( 3) =       0.000439445915
  error estimate for blocks of size 2^( 4) =       0.000451244178
  error estimate for blocks of size 2^( 5) =       0.000461832538
  error estimate for blocks of size 2^( 6) =       0.000468685049
  error estimate for blocks of size 2^( 7) =       0.000475115328

      target function =                  N/A
              le_mean =     -16.906580150378
             les_mean =     286.176373421070
             stat err =       0.000464219273
             autocorr =       1.253191289117
              std dev =       0.586447961791
             le_variance =       0.343921211889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343918188257
                                         uncertainty =       0.007637876901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343918188257
                                         uncertainty =       0.007637876901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414645480
  error estimate for blocks of size 2^( 2) =       0.000427029049
  error estimate for blocks of size 2^( 3) =       0.000439417311
  error estimate for blocks of size 2^( 4) =       0.000451219627
  error estimate for blocks of size 2^( 5) =       0.000461809626
  error estimate for blocks of size 2^( 6) =       0.000468662557
  error estimate for blocks of size 2^( 7) =       0.000475092191

      target function =                  N/A
              le_mean =     -16.906580092329
             les_mean =     286.176311995073
             stat err =       0.000464196000
             autocorr =       1.253282328986
              std dev =       0.586397261821
             le_variance =       0.343861748672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344264850874
                                         uncertainty =       0.007643973588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344264850874
                                         uncertainty =       0.007643973588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414854352
  error estimate for blocks of size 2^( 2) =       0.000427229776
  error estimate for blocks of size 2^( 3) =       0.000439609595
  error estimate for blocks of size 2^( 4) =       0.000451404540
  error estimate for blocks of size 2^( 5) =       0.000461988884
  error estimate for blocks of size 2^( 6) =       0.000468834860
  error estimate for blocks of size 2^( 7) =       0.000475254138

      target function =                  N/A
              le_mean =     -16.906580478322
             les_mean =     286.176671564025
             stat err =       0.000464370605
             autocorr =       1.252962699587
              std dev =       0.586692650486
             le_variance =       0.344208266134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906580691588        initial  <--
     9.7656e-02     9.7656e-01             1.6466e-03       -16.906580150378
     3.9062e-01     3.9062e+00             4.0832e-04       -16.906580092329
     1.5625e+00     1.5625e+01             1.1588e-04       -16.906580478322

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4791
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.111480e-01 1 1  ON 0
 uu_1                 1.437122e-01 1 1  ON 1
 uu_2                 4.149879e-02 1 1  ON 2
 uu_3                -2.163065e-02 1 1  ON 3
 uu_4                -6.789785e-02 1 1  ON 4
 uu_5                -1.040829e-01 1 1  ON 5
 uu_6                -1.333883e-01 1 1  ON 6
 uu_7                -1.486629e-01 1 1  ON 7
 uu_8                -1.415172e-01 1 1  ON 8
 uu_9                -1.115618e-01 1 1  ON 9
 ud_0                 4.518021e-01 1 1  ON 10
 ud_1                 1.857080e-01 1 1  ON 11
 ud_2                 6.521936e-02 1 1  ON 12
 ud_3                -6.230649e-03 1 1  ON 13
 ud_4                -6.377477e-02 1 1  ON 14
 ud_5                -1.064557e-01 1 1  ON 15
 ud_6                -1.352942e-01 1 1  ON 16
 ud_7                -1.534854e-01 1 1  ON 17
 ud_8                -1.549289e-01 1 1  ON 18
 ud_9                -1.443146e-01 1 1  ON 19
 eO_0                -7.535033e-01 1 1  ON 20
 eO_1                -4.319438e-01 1 1  ON 21
 eO_2                -1.719757e-02 1 1  ON 22
 eO_3                 2.994988e-01 1 1  ON 23
 eO_4                 5.274723e-01 1 1  ON 24
 eO_5                 4.927169e-01 1 1  ON 25
 eO_6                 2.675629e-01 1 1  ON 26
 eO_7                -3.851487e-02 1 1  ON 27
 eO_8                -2.365130e-01 1 1  ON 28
 eO_9                -1.048075e-01 1 1  ON 29
eH1_0                -2.611652e-01 1 1  ON 30
eH1_1                -1.559375e-01 1 1  ON 31
eH1_2                -1.068708e-01 1 1  ON 32
eH1_3                -5.137881e-02 1 1  ON 33
eH1_4                -1.888694e-03 1 1  ON 34
eH1_5                 3.387359e-02 1 1  ON 35
eH1_6                 9.532791e-02 1 1  ON 36
eH1_7                 1.573104e-01 1 1  ON 37
eH1_8                 1.938136e-01 1 1  ON 38
eH1_9                 9.550851e-02 1 1  ON 39
eH2_0                -2.608212e-01 1 1  ON 40
eH2_1                -1.548629e-01 1 1  ON 41
eH2_2                -1.055568e-01 1 1  ON 42
eH2_3                -5.000514e-02 1 1  ON 43
eH2_4                -3.528809e-04 1 1  ON 44
eH2_5                 3.610973e-02 1 1  ON 45
eH2_6                 9.729178e-02 1 1  ON 46
eH2_7                 1.586630e-01 1 1  ON 47
eH2_8                 2.003439e-01 1 1  ON 48
eH2_9                 9.117638e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8821
    reference variance = 0.224833
====================================================
  Execution time = 2.2690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3923e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339265753262
                                         uncertainty =       0.004281579161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339265753262
                                         uncertainty =       0.004281579161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411841654
  error estimate for blocks of size 2^( 2) =       0.000424537819
  error estimate for blocks of size 2^( 3) =       0.000437840011
  error estimate for blocks of size 2^( 4) =       0.000450544847
  error estimate for blocks of size 2^( 5) =       0.000461274159
  error estimate for blocks of size 2^( 6) =       0.000468514998
  error estimate for blocks of size 2^( 7) =       0.000475732223

      target function =                  N/A
              le_mean =     -16.905445567867
             les_mean =     286.133316773752
             stat err =       0.000464016557
             autocorr =       1.269423156441
              std dev =       0.582432052035
             le_variance =       0.339227095238


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690544556787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905445567867       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905446321994       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905446424276       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905446966607       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905447534634       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905447716306       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905447455680       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905447432489       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905447463925       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.080225e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905445567867       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905445773701       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905445829884       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905446019706       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905446135002       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905446186184       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905446137264       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.860625e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905445567867       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905445620534       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905445637381       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905445691446       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905445715145       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905445728669       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905445718195       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.265932e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8245e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.111615e-01 1 1  ON 0
 uu_1                 1.436636e-01 1 1  ON 1
 uu_2                 4.147893e-02 1 1  ON 2
 uu_3                -2.164712e-02 1 1  ON 3
 uu_4                -6.790998e-02 1 1  ON 4
 uu_5                -1.040819e-01 1 1  ON 5
 uu_6                -1.333711e-01 1 1  ON 6
 uu_7                -1.486326e-01 1 1  ON 7
 uu_8                -1.415149e-01 1 1  ON 8
 uu_9                -1.115773e-01 1 1  ON 9
 ud_0                 4.517885e-01 1 1  ON 10
 ud_1                 1.857402e-01 1 1  ON 11
 ud_2                 6.522323e-02 1 1  ON 12
 ud_3                -6.223549e-03 1 1  ON 13
 ud_4                -6.380048e-02 1 1  ON 14
 ud_5                -1.064421e-01 1 1  ON 15
 ud_6                -1.353119e-01 1 1  ON 16
 ud_7                -1.534859e-01 1 1  ON 17
 ud_8                -1.549136e-01 1 1  ON 18
 ud_9                -1.443132e-01 1 1  ON 19
 eO_0                -7.534781e-01 1 1  ON 20
 eO_1                -4.319624e-01 1 1  ON 21
 eO_2                -1.720354e-02 1 1  ON 22
 eO_3                 2.995246e-01 1 1  ON 23
 eO_4                 5.275022e-01 1 1  ON 24
 eO_5                 4.926998e-01 1 1  ON 25
 eO_6                 2.675525e-01 1 1  ON 26
 eO_7                -3.850541e-02 1 1  ON 27
 eO_8                -2.365190e-01 1 1  ON 28
 eO_9                -1.048344e-01 1 1  ON 29
eH1_0                -2.611806e-01 1 1  ON 30
eH1_1                -1.559383e-01 1 1  ON 31
eH1_2                -1.068863e-01 1 1  ON 32
eH1_3                -5.141315e-02 1 1  ON 33
eH1_4                -1.895996e-03 1 1  ON 34
eH1_5                 3.383619e-02 1 1  ON 35
eH1_6                 9.533139e-02 1 1  ON 36
eH1_7                 1.573309e-01 1 1  ON 37
eH1_8                 1.938411e-01 1 1  ON 38
eH1_9                 9.555579e-02 1 1  ON 39
eH2_0                -2.608448e-01 1 1  ON 40
eH2_1                -1.548521e-01 1 1  ON 41
eH2_2                -1.055647e-01 1 1  ON 42
eH2_3                -5.002073e-02 1 1  ON 43
eH2_4                -3.493743e-04 1 1  ON 44
eH2_5                 3.608352e-02 1 1  ON 45
eH2_6                 9.727553e-02 1 1  ON 46
eH2_7                 1.586794e-01 1 1  ON 47
eH2_8                 2.003590e-01 1 1  ON 48
eH2_9                 9.121426e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9455
    reference variance = 0.261564
====================================================
  Execution time = 1.9952e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3709e-01
  Total weights = 2.0000e+06
  Execution time = 1.8580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337053517906
                                         uncertainty =       0.005043317283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337053517906
                                         uncertainty =       0.005043317283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410556687
  error estimate for blocks of size 2^( 2) =       0.000422980690
  error estimate for blocks of size 2^( 3) =       0.000435733274
  error estimate for blocks of size 2^( 4) =       0.000447842204
  error estimate for blocks of size 2^( 5) =       0.000457219621
  error estimate for blocks of size 2^( 6) =       0.000465187981
  error estimate for blocks of size 2^( 7) =       0.000470227075

      target function =                  N/A
              le_mean =     -16.906806074500
             les_mean =     286.177205059304
             stat err =       0.000460119220
             autocorr =       1.256014025092
              std dev =       0.580614835413
             le_variance =       0.337113587102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336997210549
                                         uncertainty =       0.005042108983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336997210549
                                         uncertainty =       0.005042108983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410522371
  error estimate for blocks of size 2^( 2) =       0.000422948837
  error estimate for blocks of size 2^( 3) =       0.000435704305
  error estimate for blocks of size 2^( 4) =       0.000447814947
  error estimate for blocks of size 2^( 5) =       0.000457192885
  error estimate for blocks of size 2^( 6) =       0.000465161090
  error estimate for blocks of size 2^( 7) =       0.000470197764

      target function =                  N/A
              le_mean =     -16.906805909786
             les_mean =     286.177143136227
             stat err =       0.000460091672
             autocorr =       1.256073599347
              std dev =       0.580566304205
             le_variance =       0.337057233579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337008307095
                                         uncertainty =       0.005042183339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337008307095
                                         uncertainty =       0.005042183339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410529136
  error estimate for blocks of size 2^( 2) =       0.000422954848
  error estimate for blocks of size 2^( 3) =       0.000435709381
  error estimate for blocks of size 2^( 4) =       0.000447819521
  error estimate for blocks of size 2^( 5) =       0.000457197425
  error estimate for blocks of size 2^( 6) =       0.000465165912
  error estimate for blocks of size 2^( 7) =       0.000470204008

      target function =                  N/A
              le_mean =     -16.906806075740
             les_mean =     286.177159856941
             stat err =       0.000460096716
             autocorr =       1.256059745108
              std dev =       0.580575871691
             le_variance =       0.337068342789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337047269492
                                         uncertainty =       0.005043158645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337047269492
                                         uncertainty =       0.005043158645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410552880
  error estimate for blocks of size 2^( 2) =       0.000422977109
  error estimate for blocks of size 2^( 3) =       0.000435729954
  error estimate for blocks of size 2^( 4) =       0.000447839046
  error estimate for blocks of size 2^( 5) =       0.000457216535
  error estimate for blocks of size 2^( 6) =       0.000465184918
  error estimate for blocks of size 2^( 7) =       0.000470223882

      target function =                  N/A
              le_mean =     -16.906806076171
             les_mean =     286.177198862832
             stat err =       0.000460116095
             autocorr =       1.256020261405
              std dev =       0.580609450607
             le_variance =       0.337107334134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906806074500        initial
     9.7656e-01     9.7656e+00             2.0802e-04       -16.906805909786
     3.9062e+00     3.9062e+01             4.8606e-05       -16.906806075740
     1.5625e+01     1.5625e+02             1.2659e-05       -16.906806076171  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.9352e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.111519e-01 1 1  ON 0
 uu_1                 1.436996e-01 1 1  ON 1
 uu_2                 4.149380e-02 1 1  ON 2
 uu_3                -2.163482e-02 1 1  ON 3
 uu_4                -6.790096e-02 1 1  ON 4
 uu_5                -1.040826e-01 1 1  ON 5
 uu_6                -1.333840e-01 1 1  ON 6
 uu_7                -1.486552e-01 1 1  ON 7
 uu_8                -1.415166e-01 1 1  ON 8
 uu_9                -1.115657e-01 1 1  ON 9
 ud_0                 4.517982e-01 1 1  ON 10
 ud_1                 1.857167e-01 1 1  ON 11
 ud_2                 6.522017e-02 1 1  ON 12
 ud_3                -6.228632e-03 1 1  ON 13
 ud_4                -6.378156e-02 1 1  ON 14
 ud_5                -1.064520e-01 1 1  ON 15
 ud_6                -1.352988e-01 1 1  ON 16
 ud_7                -1.534855e-01 1 1  ON 17
 ud_8                -1.549251e-01 1 1  ON 18
 ud_9                -1.443143e-01 1 1  ON 19
 eO_0                -7.534966e-01 1 1  ON 20
 eO_1                -4.319489e-01 1 1  ON 21
 eO_2                -1.719906e-02 1 1  ON 22
 eO_3                 2.995053e-01 1 1  ON 23
 eO_4                 5.274799e-01 1 1  ON 24
 eO_5                 4.927126e-01 1 1  ON 25
 eO_6                 2.675603e-01 1 1  ON 26
 eO_7                -3.851250e-02 1 1  ON 27
 eO_8                -2.365145e-01 1 1  ON 28
 eO_9                -1.048143e-01 1 1  ON 29
eH1_0                -2.611691e-01 1 1  ON 30
eH1_1                -1.559376e-01 1 1  ON 31
eH1_2                -1.068746e-01 1 1  ON 32
eH1_3                -5.138779e-02 1 1  ON 33
eH1_4                -1.890349e-03 1 1  ON 34
eH1_5                 3.386410e-02 1 1  ON 35
eH1_6                 9.532876e-02 1 1  ON 36
eH1_7                 1.573156e-01 1 1  ON 37
eH1_8                 1.938205e-01 1 1  ON 38
eH1_9                 9.552047e-02 1 1  ON 39
eH2_0                -2.608273e-01 1 1  ON 40
eH2_1                -1.548602e-01 1 1  ON 41
eH2_2                -1.055587e-01 1 1  ON 42
eH2_3                -5.000925e-02 1 1  ON 43
eH2_4                -3.518502e-04 1 1  ON 44
eH2_5                 3.610310e-02 1 1  ON 45
eH2_6                 9.728769e-02 1 1  ON 46
eH2_7                 1.586671e-01 1 1  ON 47
eH2_8                 2.003477e-01 1 1  ON 48
eH2_9                 9.118596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7604e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8295
    reference variance = 0.277281
====================================================
  Execution time = 2.0532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4040e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340380594379
                                         uncertainty =       0.004602075181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340380594379
                                         uncertainty =       0.004602075181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412551247
  error estimate for blocks of size 2^( 2) =       0.000425368234
  error estimate for blocks of size 2^( 3) =       0.000438010260
  error estimate for blocks of size 2^( 4) =       0.000450300851
  error estimate for blocks of size 2^( 5) =       0.000460470152
  error estimate for blocks of size 2^( 6) =       0.000466549888
  error estimate for blocks of size 2^( 7) =       0.000467962954

      target function =                  N/A
              le_mean =     -16.906079149836
             les_mean =     286.155909113168
             stat err =       0.000461320961
             autocorr =       1.250404614250
              std dev =       0.583435568714
             le_variance =       0.340397062841


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607914984e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906079149836       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906079174233       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906079210164       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906079269619       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906079320711       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906079325895       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906079269743       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906079273592       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.520264e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906079149836       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906079156093       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906079165388       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906079179977       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906079192877       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906079194673       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906079180921       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906079180882       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.136130e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906079149836       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906079151411       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906079153755       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906079157384       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906079160613       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906079161090       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906079157679       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906079157604       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 2.844277e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215906 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6155e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.111480e-01 1 1  ON 0
 uu_1                 1.436990e-01 1 1  ON 1
 uu_2                 4.149618e-02 1 1  ON 2
 uu_3                -2.163152e-02 1 1  ON 3
 uu_4                -6.790857e-02 1 1  ON 4
 uu_5                -1.040813e-01 1 1  ON 5
 uu_6                -1.333807e-01 1 1  ON 6
 uu_7                -1.486497e-01 1 1  ON 7
 uu_8                -1.415159e-01 1 1  ON 8
 uu_9                -1.115743e-01 1 1  ON 9
 ud_0                 4.517959e-01 1 1  ON 10
 ud_1                 1.857268e-01 1 1  ON 11
 ud_2                 6.522104e-02 1 1  ON 12
 ud_3                -6.225951e-03 1 1  ON 13
 ud_4                -6.378447e-02 1 1  ON 14
 ud_5                -1.064472e-01 1 1  ON 15
 ud_6                -1.352939e-01 1 1  ON 16
 ud_7                -1.534863e-01 1 1  ON 17
 ud_8                -1.549292e-01 1 1  ON 18
 ud_9                -1.443235e-01 1 1  ON 19
 eO_0                -7.534929e-01 1 1  ON 20
 eO_1                -4.319514e-01 1 1  ON 21
 eO_2                -1.719703e-02 1 1  ON 22
 eO_3                 2.995101e-01 1 1  ON 23
 eO_4                 5.274861e-01 1 1  ON 24
 eO_5                 4.927169e-01 1 1  ON 25
 eO_6                 2.675597e-01 1 1  ON 26
 eO_7                -3.851223e-02 1 1  ON 27
 eO_8                -2.365211e-01 1 1  ON 28
 eO_9                -1.048244e-01 1 1  ON 29
eH1_0                -2.611750e-01 1 1  ON 30
eH1_1                -1.559484e-01 1 1  ON 31
eH1_2                -1.068800e-01 1 1  ON 32
eH1_3                -5.138757e-02 1 1  ON 33
eH1_4                -1.881895e-03 1 1  ON 34
eH1_5                 3.387046e-02 1 1  ON 35
eH1_6                 9.532909e-02 1 1  ON 36
eH1_7                 1.573113e-01 1 1  ON 37
eH1_8                 1.938228e-01 1 1  ON 38
eH1_9                 9.552923e-02 1 1  ON 39
eH2_0                -2.608278e-01 1 1  ON 40
eH2_1                -1.548650e-01 1 1  ON 41
eH2_2                -1.055646e-01 1 1  ON 42
eH2_3                -5.001664e-02 1 1  ON 43
eH2_4                -3.479875e-04 1 1  ON 44
eH2_5                 3.610581e-02 1 1  ON 45
eH2_6                 9.728502e-02 1 1  ON 46
eH2_7                 1.586668e-01 1 1  ON 47
eH2_8                 2.003500e-01 1 1  ON 48
eH2_9                 9.119732e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9064
    reference variance = 0.417672
====================================================
  Execution time = 2.0602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4132e-01
  Total weights = 2.0000e+06
  Execution time = 1.8581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449798772
                                         uncertainty =       0.003585321475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341449798772
                                         uncertainty =       0.003585321475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413116533
  error estimate for blocks of size 2^( 2) =       0.000425615763
  error estimate for blocks of size 2^( 3) =       0.000438741391
  error estimate for blocks of size 2^( 4) =       0.000451504031
  error estimate for blocks of size 2^( 5) =       0.000462371138
  error estimate for blocks of size 2^( 6) =       0.000469581334
  error estimate for blocks of size 2^( 7) =       0.000473214156

      target function =                  N/A
              le_mean =     -16.907036414696
             les_mean =     286.189210697246
             stat err =       0.000464167665
             autocorr =       1.262422173243
              std dev =       0.584235004135
             le_variance =       0.341330540057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341422171312
                                         uncertainty =       0.003584823302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341422171312
                                         uncertainty =       0.003584823302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413099824
  error estimate for blocks of size 2^( 2) =       0.000425599477
  error estimate for blocks of size 2^( 3) =       0.000438725275
  error estimate for blocks of size 2^( 4) =       0.000451488117
  error estimate for blocks of size 2^( 5) =       0.000462355474
  error estimate for blocks of size 2^( 6) =       0.000469566304
  error estimate for blocks of size 2^( 7) =       0.000473198271

      target function =                  N/A
              le_mean =     -16.907036266637
             les_mean =     286.189178079960
             stat err =       0.000464152042
             autocorr =       1.262439313104
              std dev =       0.584211373754
             le_variance =       0.341302929223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341434494194
                                         uncertainty =       0.003585049735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341434494194
                                         uncertainty =       0.003585049735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413107277
  error estimate for blocks of size 2^( 2) =       0.000425606754
  error estimate for blocks of size 2^( 3) =       0.000438732494
  error estimate for blocks of size 2^( 4) =       0.000451495261
  error estimate for blocks of size 2^( 5) =       0.000462362505
  error estimate for blocks of size 2^( 6) =       0.000469573051
  error estimate for blocks of size 2^( 7) =       0.000473205402

      target function =                  N/A
              le_mean =     -16.907036327323
             les_mean =     286.189192447358
             stat err =       0.000464159055
             autocorr =       1.262431911980
              std dev =       0.584221913821
             le_variance =       0.341315244588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341447833346
                                         uncertainty =       0.003585286732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341447833346
                                         uncertainty =       0.003585286732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413115345
  error estimate for blocks of size 2^( 2) =       0.000425614607
  error estimate for blocks of size 2^( 3) =       0.000438740249
  error estimate for blocks of size 2^( 4) =       0.000451502906
  error estimate for blocks of size 2^( 5) =       0.000462370031
  error estimate for blocks of size 2^( 6) =       0.000469580272
  error estimate for blocks of size 2^( 7) =       0.000473213033

      target function =                  N/A
              le_mean =     -16.907036403127
             les_mean =     286.189208341794
             stat err =       0.000464166560
             autocorr =       1.262423430750
              std dev =       0.584233323080
             le_variance =       0.341328575797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907036414696        initial  <--
     3.9062e+00     3.9062e+01             4.5203e-05       -16.907036266637
     1.5625e+01     1.5625e+02             1.1361e-05       -16.907036327323
     6.2500e+01     6.2500e+02             2.8443e-06       -16.907036403127

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9703
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.111519e-01 1 1  ON 0
 uu_1                 1.436996e-01 1 1  ON 1
 uu_2                 4.149380e-02 1 1  ON 2
 uu_3                -2.163482e-02 1 1  ON 3
 uu_4                -6.790096e-02 1 1  ON 4
 uu_5                -1.040826e-01 1 1  ON 5
 uu_6                -1.333840e-01 1 1  ON 6
 uu_7                -1.486552e-01 1 1  ON 7
 uu_8                -1.415166e-01 1 1  ON 8
 uu_9                -1.115657e-01 1 1  ON 9
 ud_0                 4.517982e-01 1 1  ON 10
 ud_1                 1.857167e-01 1 1  ON 11
 ud_2                 6.522017e-02 1 1  ON 12
 ud_3                -6.228632e-03 1 1  ON 13
 ud_4                -6.378156e-02 1 1  ON 14
 ud_5                -1.064520e-01 1 1  ON 15
 ud_6                -1.352988e-01 1 1  ON 16
 ud_7                -1.534855e-01 1 1  ON 17
 ud_8                -1.549251e-01 1 1  ON 18
 ud_9                -1.443143e-01 1 1  ON 19
 eO_0                -7.534966e-01 1 1  ON 20
 eO_1                -4.319489e-01 1 1  ON 21
 eO_2                -1.719906e-02 1 1  ON 22
 eO_3                 2.995053e-01 1 1  ON 23
 eO_4                 5.274799e-01 1 1  ON 24
 eO_5                 4.927126e-01 1 1  ON 25
 eO_6                 2.675603e-01 1 1  ON 26
 eO_7                -3.851250e-02 1 1  ON 27
 eO_8                -2.365145e-01 1 1  ON 28
 eO_9                -1.048143e-01 1 1  ON 29
eH1_0                -2.611691e-01 1 1  ON 30
eH1_1                -1.559376e-01 1 1  ON 31
eH1_2                -1.068746e-01 1 1  ON 32
eH1_3                -5.138779e-02 1 1  ON 33
eH1_4                -1.890349e-03 1 1  ON 34
eH1_5                 3.386410e-02 1 1  ON 35
eH1_6                 9.532876e-02 1 1  ON 36
eH1_7                 1.573156e-01 1 1  ON 37
eH1_8                 1.938205e-01 1 1  ON 38
eH1_9                 9.552047e-02 1 1  ON 39
eH2_0                -2.608273e-01 1 1  ON 40
eH2_1                -1.548602e-01 1 1  ON 41
eH2_2                -1.055587e-01 1 1  ON 42
eH2_3                -5.000925e-02 1 1  ON 43
eH2_4                -3.518502e-04 1 1  ON 44
eH2_5                 3.610310e-02 1 1  ON 45
eH2_6                 9.728769e-02 1 1  ON 46
eH2_7                 1.586671e-01 1 1  ON 47
eH2_8                 2.003477e-01 1 1  ON 48
eH2_9                 9.118596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8955
    reference variance = 0.250462
====================================================
  Execution time = 2.0410e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3474e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821991721
                                         uncertainty =       0.002981111252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334821991721
                                         uncertainty =       0.002981111252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409107047
  error estimate for blocks of size 2^( 2) =       0.000421823370
  error estimate for blocks of size 2^( 3) =       0.000435064779
  error estimate for blocks of size 2^( 4) =       0.000447072304
  error estimate for blocks of size 2^( 5) =       0.000458478974
  error estimate for blocks of size 2^( 6) =       0.000466126309
  error estimate for blocks of size 2^( 7) =       0.000472569715

      target function =                  N/A
              le_mean =     -16.906641769768
             les_mean =     286.169272916125
             stat err =       0.000461061825
             autocorr =       1.270118989187
              std dev =       0.578564734682
             le_variance =       0.334737152218


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690664176977e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906641769768       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906641760216       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906641754969       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906641760913       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906641769203       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906641770491       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906641769932       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906641770870       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.514940e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906641769768       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906641767369       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906641766047       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906641767521       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906641769605       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906641769929       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906641769784       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906641770015       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.380248e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906641769768       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906641769168       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906641768837       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906641769205       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906641769726       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906641769808       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906641769770       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906641769828       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.451572e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218554 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5986e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.111516e-01 1 1  ON 0
 uu_1                 1.436991e-01 1 1  ON 1
 uu_2                 4.149396e-02 1 1  ON 2
 uu_3                -2.163469e-02 1 1  ON 3
 uu_4                -6.790122e-02 1 1  ON 4
 uu_5                -1.040826e-01 1 1  ON 5
 uu_6                -1.333835e-01 1 1  ON 6
 uu_7                -1.486553e-01 1 1  ON 7
 uu_8                -1.415169e-01 1 1  ON 8
 uu_9                -1.115661e-01 1 1  ON 9
 ud_0                 4.517972e-01 1 1  ON 10
 ud_1                 1.857172e-01 1 1  ON 11
 ud_2                 6.522046e-02 1 1  ON 12
 ud_3                -6.227780e-03 1 1  ON 13
 ud_4                -6.378166e-02 1 1  ON 14
 ud_5                -1.064519e-01 1 1  ON 15
 ud_6                -1.352986e-01 1 1  ON 16
 ud_7                -1.534856e-01 1 1  ON 17
 ud_8                -1.549250e-01 1 1  ON 18
 ud_9                -1.443146e-01 1 1  ON 19
 eO_0                -7.534963e-01 1 1  ON 20
 eO_1                -4.319489e-01 1 1  ON 21
 eO_2                -1.719914e-02 1 1  ON 22
 eO_3                 2.995054e-01 1 1  ON 23
 eO_4                 5.274801e-01 1 1  ON 24
 eO_5                 4.927135e-01 1 1  ON 25
 eO_6                 2.675602e-01 1 1  ON 26
 eO_7                -3.851257e-02 1 1  ON 27
 eO_8                -2.365149e-01 1 1  ON 28
 eO_9                -1.048151e-01 1 1  ON 29
eH1_0                -2.611691e-01 1 1  ON 30
eH1_1                -1.559384e-01 1 1  ON 31
eH1_2                -1.068756e-01 1 1  ON 32
eH1_3                -5.138851e-02 1 1  ON 33
eH1_4                -1.890649e-03 1 1  ON 34
eH1_5                 3.386422e-02 1 1  ON 35
eH1_6                 9.532900e-02 1 1  ON 36
eH1_7                 1.573158e-01 1 1  ON 37
eH1_8                 1.938212e-01 1 1  ON 38
eH1_9                 9.552176e-02 1 1  ON 39
eH2_0                -2.608280e-01 1 1  ON 40
eH2_1                -1.548594e-01 1 1  ON 41
eH2_2                -1.055586e-01 1 1  ON 42
eH2_3                -5.000960e-02 1 1  ON 43
eH2_4                -3.515381e-04 1 1  ON 44
eH2_5                 3.610172e-02 1 1  ON 45
eH2_6                 9.728741e-02 1 1  ON 46
eH2_7                 1.586675e-01 1 1  ON 47
eH2_8                 2.003479e-01 1 1  ON 48
eH2_9                 9.118685e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9708
    reference variance = 0.270741
====================================================
  Execution time = 2.0064e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4402e-01
  Total weights = 2.0000e+06
  Execution time = 1.8539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344085935121
                                         uncertainty =       0.004799545198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344085935121
                                         uncertainty =       0.004799545198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414739111
  error estimate for blocks of size 2^( 2) =       0.000427216999
  error estimate for blocks of size 2^( 3) =       0.000439596878
  error estimate for blocks of size 2^( 4) =       0.000451557407
  error estimate for blocks of size 2^( 5) =       0.000463252531
  error estimate for blocks of size 2^( 6) =       0.000471600754
  error estimate for blocks of size 2^( 7) =       0.000475847725

      target function =                  N/A
              le_mean =     -16.905306685518
             les_mean =     286.133411019823
             stat err =       0.000465564604
             autocorr =       1.260114253602
              std dev =       0.586529675646
             le_variance =       0.344017060414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344080365903
                                         uncertainty =       0.004799486615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344080365903
                                         uncertainty =       0.004799486615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414735753
  error estimate for blocks of size 2^( 2) =       0.000427213809
  error estimate for blocks of size 2^( 3) =       0.000439593843
  error estimate for blocks of size 2^( 4) =       0.000451554539
  error estimate for blocks of size 2^( 5) =       0.000463249803
  error estimate for blocks of size 2^( 6) =       0.000471598051
  error estimate for blocks of size 2^( 7) =       0.000475845129

      target function =                  N/A
              le_mean =     -16.905306665682
             les_mean =     286.133404779027
             stat err =       0.000465561881
             autocorr =       1.260119913387
              std dev =       0.586524927241
             le_variance =       0.344011490275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344083127936
                                         uncertainty =       0.004799515589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344083127936
                                         uncertainty =       0.004799515589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414737419
  error estimate for blocks of size 2^( 2) =       0.000427215391
  error estimate for blocks of size 2^( 3) =       0.000439595348
  error estimate for blocks of size 2^( 4) =       0.000451555961
  error estimate for blocks of size 2^( 5) =       0.000463251156
  error estimate for blocks of size 2^( 6) =       0.000471599392
  error estimate for blocks of size 2^( 7) =       0.000475846416

      target function =                  N/A
              le_mean =     -16.905306675513
             les_mean =     286.133407873903
             stat err =       0.000465563231
             autocorr =       1.260117105125
              std dev =       0.586527282197
             le_variance =       0.344014252762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344085583497
                                         uncertainty =       0.004799541487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344085583497
                                         uncertainty =       0.004799541487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414738899
  error estimate for blocks of size 2^( 2) =       0.000427216797
  error estimate for blocks of size 2^( 3) =       0.000439596686
  error estimate for blocks of size 2^( 4) =       0.000451557225
  error estimate for blocks of size 2^( 5) =       0.000463252359
  error estimate for blocks of size 2^( 6) =       0.000471600583
  error estimate for blocks of size 2^( 7) =       0.000475847561

      target function =                  N/A
              le_mean =     -16.905306684263
             les_mean =     286.133410625703
             stat err =       0.000465564432
             autocorr =       1.260114610707
              std dev =       0.586529375847
             le_variance =       0.344016708731


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905306685518        initial  <--
     3.9062e+01     3.9062e+02             5.5149e-06       -16.905306665682
     1.5625e+02     1.5625e+03             1.3802e-06       -16.905306675513
     6.2500e+02     6.2500e+03             3.4516e-07       -16.905306684263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4237
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.111519e-01 1 1  ON 0
 uu_1                 1.436996e-01 1 1  ON 1
 uu_2                 4.149380e-02 1 1  ON 2
 uu_3                -2.163482e-02 1 1  ON 3
 uu_4                -6.790096e-02 1 1  ON 4
 uu_5                -1.040826e-01 1 1  ON 5
 uu_6                -1.333840e-01 1 1  ON 6
 uu_7                -1.486552e-01 1 1  ON 7
 uu_8                -1.415166e-01 1 1  ON 8
 uu_9                -1.115657e-01 1 1  ON 9
 ud_0                 4.517982e-01 1 1  ON 10
 ud_1                 1.857167e-01 1 1  ON 11
 ud_2                 6.522017e-02 1 1  ON 12
 ud_3                -6.228632e-03 1 1  ON 13
 ud_4                -6.378156e-02 1 1  ON 14
 ud_5                -1.064520e-01 1 1  ON 15
 ud_6                -1.352988e-01 1 1  ON 16
 ud_7                -1.534855e-01 1 1  ON 17
 ud_8                -1.549251e-01 1 1  ON 18
 ud_9                -1.443143e-01 1 1  ON 19
 eO_0                -7.534966e-01 1 1  ON 20
 eO_1                -4.319489e-01 1 1  ON 21
 eO_2                -1.719906e-02 1 1  ON 22
 eO_3                 2.995053e-01 1 1  ON 23
 eO_4                 5.274799e-01 1 1  ON 24
 eO_5                 4.927126e-01 1 1  ON 25
 eO_6                 2.675603e-01 1 1  ON 26
 eO_7                -3.851250e-02 1 1  ON 27
 eO_8                -2.365145e-01 1 1  ON 28
 eO_9                -1.048143e-01 1 1  ON 29
eH1_0                -2.611691e-01 1 1  ON 30
eH1_1                -1.559376e-01 1 1  ON 31
eH1_2                -1.068746e-01 1 1  ON 32
eH1_3                -5.138779e-02 1 1  ON 33
eH1_4                -1.890349e-03 1 1  ON 34
eH1_5                 3.386410e-02 1 1  ON 35
eH1_6                 9.532876e-02 1 1  ON 36
eH1_7                 1.573156e-01 1 1  ON 37
eH1_8                 1.938205e-01 1 1  ON 38
eH1_9                 9.552047e-02 1 1  ON 39
eH2_0                -2.608273e-01 1 1  ON 40
eH2_1                -1.548602e-01 1 1  ON 41
eH2_2                -1.055587e-01 1 1  ON 42
eH2_3                -5.000925e-02 1 1  ON 43
eH2_4                -3.518502e-04 1 1  ON 44
eH2_5                 3.610310e-02 1 1  ON 45
eH2_6                 9.728769e-02 1 1  ON 46
eH2_7                 1.586671e-01 1 1  ON 47
eH2_8                 2.003477e-01 1 1  ON 48
eH2_9                 9.118596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5416e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.959
    reference variance = 0.256906
====================================================
  Execution time = 2.0405e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3295e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6075e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332934123711
                                         uncertainty =       0.002221461759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332934123711
                                         uncertainty =       0.002221461759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408012505
  error estimate for blocks of size 2^( 2) =       0.000421288319
  error estimate for blocks of size 2^( 3) =       0.000435609620
  error estimate for blocks of size 2^( 4) =       0.000447487519
  error estimate for blocks of size 2^( 5) =       0.000457568336
  error estimate for blocks of size 2^( 6) =       0.000465701531
  error estimate for blocks of size 2^( 7) =       0.000470311242

      target function =                  N/A
              le_mean =     -16.906421294183
             les_mean =     286.160029218630
             stat err =       0.000460267157
             autocorr =       1.272544635808
              std dev =       0.577016818398
             le_variance =       0.332948408714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690642129418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906421294183       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906421294247       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906421294418       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421294492       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906421295826       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906421295841       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906421295667       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906421295618       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 4.055259e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906421294183       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906421294199       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906421294241       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421294260       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906421294594       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906421294597       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906421294553       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906421294543       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.013847e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906421294183       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906421294187       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906421294197       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421294202       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906421294285       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906421294285       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906421294281       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906421294268       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 2.534637e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6019e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.111519e-01 1 1  ON 0
 uu_1                 1.436996e-01 1 1  ON 1
 uu_2                 4.149384e-02 1 1  ON 2
 uu_3                -2.163483e-02 1 1  ON 3
 uu_4                -6.790095e-02 1 1  ON 4
 uu_5                -1.040827e-01 1 1  ON 5
 uu_6                -1.333840e-01 1 1  ON 6
 uu_7                -1.486552e-01 1 1  ON 7
 uu_8                -1.415167e-01 1 1  ON 8
 uu_9                -1.115658e-01 1 1  ON 9
 ud_0                 4.517982e-01 1 1  ON 10
 ud_1                 1.857168e-01 1 1  ON 11
 ud_2                 6.522018e-02 1 1  ON 12
 ud_3                -6.228615e-03 1 1  ON 13
 ud_4                -6.378153e-02 1 1  ON 14
 ud_5                -1.064520e-01 1 1  ON 15
 ud_6                -1.352987e-01 1 1  ON 16
 ud_7                -1.534855e-01 1 1  ON 17
 ud_8                -1.549251e-01 1 1  ON 18
 ud_9                -1.443144e-01 1 1  ON 19
 eO_0                -7.534965e-01 1 1  ON 20
 eO_1                -4.319490e-01 1 1  ON 21
 eO_2                -1.719904e-02 1 1  ON 22
 eO_3                 2.995054e-01 1 1  ON 23
 eO_4                 5.274800e-01 1 1  ON 24
 eO_5                 4.927126e-01 1 1  ON 25
 eO_6                 2.675603e-01 1 1  ON 26
 eO_7                -3.851250e-02 1 1  ON 27
 eO_8                -2.365146e-01 1 1  ON 28
 eO_9                -1.048144e-01 1 1  ON 29
eH1_0                -2.611692e-01 1 1  ON 30
eH1_1                -1.559376e-01 1 1  ON 31
eH1_2                -1.068746e-01 1 1  ON 32
eH1_3                -5.138781e-02 1 1  ON 33
eH1_4                -1.890354e-03 1 1  ON 34
eH1_5                 3.386414e-02 1 1  ON 35
eH1_6                 9.532874e-02 1 1  ON 36
eH1_7                 1.573156e-01 1 1  ON 37
eH1_8                 1.938206e-01 1 1  ON 38
eH1_9                 9.552056e-02 1 1  ON 39
eH2_0                -2.608274e-01 1 1  ON 40
eH2_1                -1.548602e-01 1 1  ON 41
eH2_2                -1.055587e-01 1 1  ON 42
eH2_3                -5.000923e-02 1 1  ON 43
eH2_4                -3.518178e-04 1 1  ON 44
eH2_5                 3.610303e-02 1 1  ON 45
eH2_6                 9.728774e-02 1 1  ON 46
eH2_7                 1.586672e-01 1 1  ON 47
eH2_8                 2.003477e-01 1 1  ON 48
eH2_9                 9.118604e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8922
    reference variance = 0.188624
====================================================
  Execution time = 1.9999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4822e-01
  Total weights = 2.0000e+06
  Execution time = 1.8556e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348258552208
                                         uncertainty =       0.009472517088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348258552208
                                         uncertainty =       0.009472517088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417264364
  error estimate for blocks of size 2^( 2) =       0.000430089911
  error estimate for blocks of size 2^( 3) =       0.000442864586
  error estimate for blocks of size 2^( 4) =       0.000455022123
  error estimate for blocks of size 2^( 5) =       0.000464254498
  error estimate for blocks of size 2^( 6) =       0.000474211412
  error estimate for blocks of size 2^( 7) =       0.000479539648

      target function =                  N/A
              le_mean =     -16.906615935338
             les_mean =     286.181881310387
             stat err =       0.000468256920
             autocorr =       1.259348174316
              std dev =       0.590100923113
             le_variance =       0.348219099459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348258437103
                                         uncertainty =       0.009472503800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348258437103
                                         uncertainty =       0.009472503800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417264295
  error estimate for blocks of size 2^( 2) =       0.000430089844
  error estimate for blocks of size 2^( 3) =       0.000442864521
  error estimate for blocks of size 2^( 4) =       0.000455022058
  error estimate for blocks of size 2^( 5) =       0.000464254434
  error estimate for blocks of size 2^( 6) =       0.000474211350
  error estimate for blocks of size 2^( 7) =       0.000479539588

      target function =                  N/A
              le_mean =     -16.906615935375
             les_mean =     286.181881196441
             stat err =       0.000468256857
             autocorr =       1.259348251533
              std dev =       0.590100825529
             le_variance =       0.348218984291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348258494583
                                         uncertainty =       0.009472510437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348258494583
                                         uncertainty =       0.009472510437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417264330
  error estimate for blocks of size 2^( 2) =       0.000430089878
  error estimate for blocks of size 2^( 3) =       0.000442864553
  error estimate for blocks of size 2^( 4) =       0.000455022091
  error estimate for blocks of size 2^( 5) =       0.000464254466
  error estimate for blocks of size 2^( 6) =       0.000474211381
  error estimate for blocks of size 2^( 7) =       0.000479539618

      target function =                  N/A
              le_mean =     -16.906615935357
             les_mean =     286.181881253345
             stat err =       0.000468256889
             autocorr =       1.259348212969
              std dev =       0.590100874260
             le_variance =       0.348219041803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348258545002
                                         uncertainty =       0.009472516257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348258545002
                                         uncertainty =       0.009472516257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417264360
  error estimate for blocks of size 2^( 2) =       0.000430089907
  error estimate for blocks of size 2^( 3) =       0.000442864582
  error estimate for blocks of size 2^( 4) =       0.000455022119
  error estimate for blocks of size 2^( 5) =       0.000464254494
  error estimate for blocks of size 2^( 6) =       0.000474211409
  error estimate for blocks of size 2^( 7) =       0.000479539644

      target function =                  N/A
              le_mean =     -16.906615935341
             les_mean =     286.181881303254
             stat err =       0.000468256917
             autocorr =       1.259348179147
              std dev =       0.590100917004
             le_variance =       0.348219092249


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906615935338        initial
     3.9062e+02     3.9062e+03             4.0553e-07       -16.906615935375  <--
     1.5625e+03     1.5625e+04             1.0138e-07       -16.906615935357
     6.2500e+03     6.2500e+04             2.5346e-08       -16.906615935341

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.9376e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.111519e-01 1 1  ON 0
 uu_1                 1.436995e-01 1 1  ON 1
 uu_2                 4.149396e-02 1 1  ON 2
 uu_3                -2.163486e-02 1 1  ON 3
 uu_4                -6.790089e-02 1 1  ON 4
 uu_5                -1.040827e-01 1 1  ON 5
 uu_6                -1.333840e-01 1 1  ON 6
 uu_7                -1.486551e-01 1 1  ON 7
 uu_8                -1.415168e-01 1 1  ON 8
 uu_9                -1.115661e-01 1 1  ON 9
 ud_0                 4.517983e-01 1 1  ON 10
 ud_1                 1.857169e-01 1 1  ON 11
 ud_2                 6.522021e-02 1 1  ON 12
 ud_3                -6.228564e-03 1 1  ON 13
 ud_4                -6.378144e-02 1 1  ON 14
 ud_5                -1.064518e-01 1 1  ON 15
 ud_6                -1.352987e-01 1 1  ON 16
 ud_7                -1.534854e-01 1 1  ON 17
 ud_8                -1.549252e-01 1 1  ON 18
 ud_9                -1.443147e-01 1 1  ON 19
 eO_0                -7.534965e-01 1 1  ON 20
 eO_1                -4.319491e-01 1 1  ON 21
 eO_2                -1.719897e-02 1 1  ON 22
 eO_3                 2.995054e-01 1 1  ON 23
 eO_4                 5.274803e-01 1 1  ON 24
 eO_5                 4.927128e-01 1 1  ON 25
 eO_6                 2.675603e-01 1 1  ON 26
 eO_7                -3.851250e-02 1 1  ON 27
 eO_8                -2.365148e-01 1 1  ON 28
 eO_9                -1.048147e-01 1 1  ON 29
eH1_0                -2.611695e-01 1 1  ON 30
eH1_1                -1.559377e-01 1 1  ON 31
eH1_2                -1.068747e-01 1 1  ON 32
eH1_3                -5.138789e-02 1 1  ON 33
eH1_4                -1.890370e-03 1 1  ON 34
eH1_5                 3.386426e-02 1 1  ON 35
eH1_6                 9.532871e-02 1 1  ON 36
eH1_7                 1.573156e-01 1 1  ON 37
eH1_8                 1.938207e-01 1 1  ON 38
eH1_9                 9.552083e-02 1 1  ON 39
eH2_0                -2.608276e-01 1 1  ON 40
eH2_1                -1.548603e-01 1 1  ON 41
eH2_2                -1.055588e-01 1 1  ON 42
eH2_3                -5.000920e-02 1 1  ON 43
eH2_4                -3.517204e-04 1 1  ON 44
eH2_5                 3.610285e-02 1 1  ON 45
eH2_6                 9.728789e-02 1 1  ON 46
eH2_7                 1.586673e-01 1 1  ON 47
eH2_8                 2.003477e-01 1 1  ON 48
eH2_9                 9.118626e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5403e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9678
    reference variance = 0.284197
====================================================
  Execution time = 2.0522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4079e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340791032372
                                         uncertainty =       0.004117657501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340791032372
                                         uncertainty =       0.004117657501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412790999
  error estimate for blocks of size 2^( 2) =       0.000425523387
  error estimate for blocks of size 2^( 3) =       0.000438602591
  error estimate for blocks of size 2^( 4) =       0.000451629710
  error estimate for blocks of size 2^( 5) =       0.000462908119
  error estimate for blocks of size 2^( 6) =       0.000468131895
  error estimate for blocks of size 2^( 7) =       0.000474131718

      target function =                  N/A
              le_mean =     -16.905670345488
             les_mean =     286.142482478084
             stat err =       0.000464200361
             autocorr =       1.264592229422
              std dev =       0.583774629594
             le_variance =       0.340792818158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567034549e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905670345488       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905670348761       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905670351225       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905670350330       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905670348842       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905670349750       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905670348760       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905670349207       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.848429e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905670345488       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905670346308       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905670346926       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905670346713       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905670346337       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905670346558       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905670346311       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905670346425       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 4.622969e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905670345488       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905670345693       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905670345848       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905670345795       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905670345701       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905670345756       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905670345695       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905670345723       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.155861e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223739 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6111e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.111520e-01 1 1  ON 0
 uu_1                 1.436992e-01 1 1  ON 1
 uu_2                 4.149400e-02 1 1  ON 2
 uu_3                -2.163483e-02 1 1  ON 3
 uu_4                -6.790125e-02 1 1  ON 4
 uu_5                -1.040825e-01 1 1  ON 5
 uu_6                -1.333838e-01 1 1  ON 6
 uu_7                -1.486552e-01 1 1  ON 7
 uu_8                -1.415169e-01 1 1  ON 8
 uu_9                -1.115663e-01 1 1  ON 9
 ud_0                 4.517984e-01 1 1  ON 10
 ud_1                 1.857170e-01 1 1  ON 11
 ud_2                 6.522041e-02 1 1  ON 12
 ud_3                -6.228533e-03 1 1  ON 13
 ud_4                -6.378183e-02 1 1  ON 14
 ud_5                -1.064517e-01 1 1  ON 15
 ud_6                -1.352988e-01 1 1  ON 16
 ud_7                -1.534854e-01 1 1  ON 17
 ud_8                -1.549250e-01 1 1  ON 18
 ud_9                -1.443147e-01 1 1  ON 19
 eO_0                -7.534964e-01 1 1  ON 20
 eO_1                -4.319492e-01 1 1  ON 21
 eO_2                -1.719905e-02 1 1  ON 22
 eO_3                 2.995056e-01 1 1  ON 23
 eO_4                 5.274805e-01 1 1  ON 24
 eO_5                 4.927128e-01 1 1  ON 25
 eO_6                 2.675603e-01 1 1  ON 26
 eO_7                -3.851236e-02 1 1  ON 27
 eO_8                -2.365150e-01 1 1  ON 28
 eO_9                -1.048150e-01 1 1  ON 29
eH1_0                -2.611699e-01 1 1  ON 30
eH1_1                -1.559379e-01 1 1  ON 31
eH1_2                -1.068748e-01 1 1  ON 32
eH1_3                -5.138821e-02 1 1  ON 33
eH1_4                -1.890384e-03 1 1  ON 34
eH1_5                 3.386438e-02 1 1  ON 35
eH1_6                 9.532881e-02 1 1  ON 36
eH1_7                 1.573157e-01 1 1  ON 37
eH1_8                 1.938209e-01 1 1  ON 38
eH1_9                 9.552125e-02 1 1  ON 39
eH2_0                -2.608278e-01 1 1  ON 40
eH2_1                -1.548603e-01 1 1  ON 41
eH2_2                -1.055590e-01 1 1  ON 42
eH2_3                -5.000946e-02 1 1  ON 43
eH2_4                -3.517126e-04 1 1  ON 44
eH2_5                 3.610265e-02 1 1  ON 45
eH2_6                 9.728783e-02 1 1  ON 46
eH2_7                 1.586675e-01 1 1  ON 47
eH2_8                 2.003479e-01 1 1  ON 48
eH2_9                 9.118667e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.947
    reference variance = 0.595014
====================================================
  Execution time = 1.9973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5752e-01
  Total weights = 2.0000e+06
  Execution time = 1.8543e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357538383841
                                         uncertainty =       0.014423445330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357538383841
                                         uncertainty =       0.014423445330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422801957
  error estimate for blocks of size 2^( 2) =       0.000435193240
  error estimate for blocks of size 2^( 3) =       0.000447202286
  error estimate for blocks of size 2^( 4) =       0.000458724777
  error estimate for blocks of size 2^( 5) =       0.000468423114
  error estimate for blocks of size 2^( 6) =       0.000474978858
  error estimate for blocks of size 2^( 7) =       0.000477838329

      target function =                  N/A
              le_mean =     -16.906550448696
             les_mean =     286.188970885668
             stat err =       0.000469991270
             autocorr =       1.235678821013
              std dev =       0.597932262169
             le_variance =       0.357522990142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357538015041
                                         uncertainty =       0.014423392042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357538015041
                                         uncertainty =       0.014423392042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422801739
  error estimate for blocks of size 2^( 2) =       0.000435193050
  error estimate for blocks of size 2^( 3) =       0.000447202120
  error estimate for blocks of size 2^( 4) =       0.000458724639
  error estimate for blocks of size 2^( 5) =       0.000468423002
  error estimate for blocks of size 2^( 6) =       0.000474978721
  error estimate for blocks of size 2^( 7) =       0.000477838226

      target function =                  N/A
              le_mean =     -16.906550458052
             les_mean =     286.188970833249
             stat err =       0.000469991147
             autocorr =       1.235679451316
              std dev =       0.597931953787
             le_variance =       0.357522621359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357538198787
                                         uncertainty =       0.014423418620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357538198787
                                         uncertainty =       0.014423418620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422801848
  error estimate for blocks of size 2^( 2) =       0.000435193145
  error estimate for blocks of size 2^( 3) =       0.000447202203
  error estimate for blocks of size 2^( 4) =       0.000458724708
  error estimate for blocks of size 2^( 5) =       0.000468423058
  error estimate for blocks of size 2^( 6) =       0.000474978789
  error estimate for blocks of size 2^( 7) =       0.000477838278

      target function =                  N/A
              le_mean =     -16.906550453383
             les_mean =     286.188970859124
             stat err =       0.000469991208
             autocorr =       1.235679137462
              std dev =       0.597932107431
             le_variance =       0.357522805097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357538360686
                                         uncertainty =       0.014423441989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357538360686
                                         uncertainty =       0.014423441989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422801944
  error estimate for blocks of size 2^( 2) =       0.000435193228
  error estimate for blocks of size 2^( 3) =       0.000447202276
  error estimate for blocks of size 2^( 4) =       0.000458724769
  error estimate for blocks of size 2^( 5) =       0.000468423107
  error estimate for blocks of size 2^( 6) =       0.000474978849
  error estimate for blocks of size 2^( 7) =       0.000477838323

      target function =                  N/A
              le_mean =     -16.906550449281
             les_mean =     286.188970882328
             stat err =       0.000469991262
             autocorr =       1.235678860605
              std dev =       0.597932242808
             le_variance =       0.357522966989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906550448696        initial
     9.7656e+01     9.7656e+02             1.8484e-06       -16.906550458052  <--
     3.9062e+02     3.9062e+03             4.6230e-07       -16.906550453383
     1.5625e+03     1.5625e+04             1.1559e-07       -16.906550449281

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 2.9325e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.111522e-01 1 1  ON 0
 uu_1                 1.436983e-01 1 1  ON 1
 uu_2                 4.149409e-02 1 1  ON 2
 uu_3                -2.163476e-02 1 1  ON 3
 uu_4                -6.790233e-02 1 1  ON 4
 uu_5                -1.040819e-01 1 1  ON 5
 uu_6                -1.333832e-01 1 1  ON 6
 uu_7                -1.486555e-01 1 1  ON 7
 uu_8                -1.415169e-01 1 1  ON 8
 uu_9                -1.115669e-01 1 1  ON 9
 ud_0                 4.517988e-01 1 1  ON 10
 ud_1                 1.857170e-01 1 1  ON 11
 ud_2                 6.522099e-02 1 1  ON 12
 ud_3                -6.228439e-03 1 1  ON 13
 ud_4                -6.378301e-02 1 1  ON 14
 ud_5                -1.064515e-01 1 1  ON 15
 ud_6                -1.352992e-01 1 1  ON 16
 ud_7                -1.534853e-01 1 1  ON 17
 ud_8                -1.549246e-01 1 1  ON 18
 ud_9                -1.443146e-01 1 1  ON 19
 eO_0                -7.534959e-01 1 1  ON 20
 eO_1                -4.319494e-01 1 1  ON 21
 eO_2                -1.719928e-02 1 1  ON 22
 eO_3                 2.995062e-01 1 1  ON 23
 eO_4                 5.274811e-01 1 1  ON 24
 eO_5                 4.927130e-01 1 1  ON 25
 eO_6                 2.675601e-01 1 1  ON 26
 eO_7                -3.851195e-02 1 1  ON 27
 eO_8                -2.365154e-01 1 1  ON 28
 eO_9                -1.048160e-01 1 1  ON 29
eH1_0                -2.611713e-01 1 1  ON 30
eH1_1                -1.559383e-01 1 1  ON 31
eH1_2                -1.068753e-01 1 1  ON 32
eH1_3                -5.138915e-02 1 1  ON 33
eH1_4                -1.890425e-03 1 1  ON 34
eH1_5                 3.386471e-02 1 1  ON 35
eH1_6                 9.532911e-02 1 1  ON 36
eH1_7                 1.573160e-01 1 1  ON 37
eH1_8                 1.938217e-01 1 1  ON 38
eH1_9                 9.552251e-02 1 1  ON 39
eH2_0                -2.608282e-01 1 1  ON 40
eH2_1                -1.548606e-01 1 1  ON 41
eH2_2                -1.055596e-01 1 1  ON 42
eH2_3                -5.001027e-02 1 1  ON 43
eH2_4                -3.516901e-04 1 1  ON 44
eH2_5                 3.610208e-02 1 1  ON 45
eH2_6                 9.728765e-02 1 1  ON 46
eH2_7                 1.586683e-01 1 1  ON 47
eH2_8                 2.003485e-01 1 1  ON 48
eH2_9                 9.118790e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5491e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9364
    reference variance = 0.208015
====================================================
  Execution time = 2.0878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4137e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341418586206
                                         uncertainty =       0.004737732790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341418586206
                                         uncertainty =       0.004737732790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413141001
  error estimate for blocks of size 2^( 2) =       0.000425963563
  error estimate for blocks of size 2^( 3) =       0.000439488423
  error estimate for blocks of size 2^( 4) =       0.000451839839
  error estimate for blocks of size 2^( 5) =       0.000462782371
  error estimate for blocks of size 2^( 6) =       0.000472317392
  error estimate for blocks of size 2^( 7) =       0.000478060340

      target function =                  N/A
              le_mean =     -16.905450155363
             les_mean =     286.135615758313
             stat err =       0.000466249985
             autocorr =       1.273623510365
              std dev =       0.584269606895
             le_variance =       0.341370973541


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690545015536e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905450155363       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905450165870       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905450136047       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905450128316       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905450124962       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905450137991       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905450139863       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905450140238       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 6.296551e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905450155363       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905450157998       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905450150470       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905450148520       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905450147672       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905450150931       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905450151402       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905450151497       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.575594e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905450155363       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905450156022       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905450154136       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905450153647       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905450153435       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905450154249       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905450154367       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905450154392       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 3.939893e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6469e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.111528e-01 1 1  ON 0
 uu_1                 1.436974e-01 1 1  ON 1
 uu_2                 4.149384e-02 1 1  ON 2
 uu_3                -2.163431e-02 1 1  ON 3
 uu_4                -6.790248e-02 1 1  ON 4
 uu_5                -1.040823e-01 1 1  ON 5
 uu_6                -1.333824e-01 1 1  ON 6
 uu_7                -1.486560e-01 1 1  ON 7
 uu_8                -1.415165e-01 1 1  ON 8
 uu_9                -1.115674e-01 1 1  ON 9
 ud_0                 4.517992e-01 1 1  ON 10
 ud_1                 1.857179e-01 1 1  ON 11
 ud_2                 6.522055e-02 1 1  ON 12
 ud_3                -6.228758e-03 1 1  ON 13
 ud_4                -6.378328e-02 1 1  ON 14
 ud_5                -1.064520e-01 1 1  ON 15
 ud_6                -1.352987e-01 1 1  ON 16
 ud_7                -1.534842e-01 1 1  ON 17
 ud_8                -1.549246e-01 1 1  ON 18
 ud_9                -1.443148e-01 1 1  ON 19
 eO_0                -7.534960e-01 1 1  ON 20
 eO_1                -4.319495e-01 1 1  ON 21
 eO_2                -1.719910e-02 1 1  ON 22
 eO_3                 2.995065e-01 1 1  ON 23
 eO_4                 5.274825e-01 1 1  ON 24
 eO_5                 4.927134e-01 1 1  ON 25
 eO_6                 2.675603e-01 1 1  ON 26
 eO_7                -3.851218e-02 1 1  ON 27
 eO_8                -2.365159e-01 1 1  ON 28
 eO_9                -1.048172e-01 1 1  ON 29
eH1_0                -2.611719e-01 1 1  ON 30
eH1_1                -1.559386e-01 1 1  ON 31
eH1_2                -1.068767e-01 1 1  ON 32
eH1_3                -5.139071e-02 1 1  ON 33
eH1_4                -1.890288e-03 1 1  ON 34
eH1_5                 3.386429e-02 1 1  ON 35
eH1_6                 9.533003e-02 1 1  ON 36
eH1_7                 1.573169e-01 1 1  ON 37
eH1_8                 1.938229e-01 1 1  ON 38
eH1_9                 9.552376e-02 1 1  ON 39
eH2_0                -2.608284e-01 1 1  ON 40
eH2_1                -1.548595e-01 1 1  ON 41
eH2_2                -1.055603e-01 1 1  ON 42
eH2_3                -5.001170e-02 1 1  ON 43
eH2_4                -3.512779e-04 1 1  ON 44
eH2_5                 3.610072e-02 1 1  ON 45
eH2_6                 9.728732e-02 1 1  ON 46
eH2_7                 1.586690e-01 1 1  ON 47
eH2_8                 2.003488e-01 1 1  ON 48
eH2_9                 9.118947e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9064
    reference variance = 0.188908
====================================================
  Execution time = 2.2658e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3824e-01
  Total weights = 2.0000e+06
  Execution time = 1.8823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337955643003
                                         uncertainty =       0.003309984317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337955643003
                                         uncertainty =       0.003309984317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240225
  error estimate for blocks of size 2^( 2) =       0.000424178937
  error estimate for blocks of size 2^( 3) =       0.000437341640
  error estimate for blocks of size 2^( 4) =       0.000449199648
  error estimate for blocks of size 2^( 5) =       0.000459673345
  error estimate for blocks of size 2^( 6) =       0.000465427005
  error estimate for blocks of size 2^( 7) =       0.000470013080

      target function =                  N/A
              le_mean =     -16.906342706598
             les_mean =     286.162660588385
             stat err =       0.000461078270
             autocorr =       1.257066156800
              std dev =       0.581581502934
             le_variance =       0.338237044555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337957980762
                                         uncertainty =       0.003309996461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337957980762
                                         uncertainty =       0.003309996461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411241651
  error estimate for blocks of size 2^( 2) =       0.000424180239
  error estimate for blocks of size 2^( 3) =       0.000437342841
  error estimate for blocks of size 2^( 4) =       0.000449200779
  error estimate for blocks of size 2^( 5) =       0.000459674317
  error estimate for blocks of size 2^( 6) =       0.000465427768
  error estimate for blocks of size 2^( 7) =       0.000470014057

      target function =                  N/A
              le_mean =     -16.906342714228
             les_mean =     286.162663193569
             stat err =       0.000461079231
             autocorr =       1.257062672291
              std dev =       0.581583520879
             le_variance =       0.338239391758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337956810252
                                         uncertainty =       0.003309990316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337956810252
                                         uncertainty =       0.003309990316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240937
  error estimate for blocks of size 2^( 2) =       0.000424179586
  error estimate for blocks of size 2^( 3) =       0.000437342239
  error estimate for blocks of size 2^( 4) =       0.000449200212
  error estimate for blocks of size 2^( 5) =       0.000459673828
  error estimate for blocks of size 2^( 6) =       0.000465427383
  error estimate for blocks of size 2^( 7) =       0.000470013566

      target function =                  N/A
              le_mean =     -16.906342710274
             les_mean =     286.162661884689
             stat err =       0.000461078747
             autocorr =       1.257064405527
              std dev =       0.581582510538
             le_variance =       0.338238216564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337955788828
                                         uncertainty =       0.003309985064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337955788828
                                         uncertainty =       0.003309985064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240314
  error estimate for blocks of size 2^( 2) =       0.000424179018
  error estimate for blocks of size 2^( 3) =       0.000437341715
  error estimate for blocks of size 2^( 4) =       0.000449199719
  error estimate for blocks of size 2^( 5) =       0.000459673406
  error estimate for blocks of size 2^( 6) =       0.000465427052
  error estimate for blocks of size 2^( 7) =       0.000470013141

      target function =                  N/A
              le_mean =     -16.906342707049
             les_mean =     286.162660750063
             stat err =       0.000461078329
             autocorr =       1.257065937597
              std dev =       0.581581628816
             le_variance =       0.338237190976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906342706598        initial
     2.4414e+01     2.4414e+02             6.2966e-06       -16.906342714228  <--
     9.7656e+01     9.7656e+02             1.5756e-06       -16.906342710274
     3.9062e+02     3.9062e+03             3.9399e-07       -16.906342707049

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 3.2043e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.111548e-01 1 1  ON 0
 uu_1                 1.436948e-01 1 1  ON 1
 uu_2                 4.149311e-02 1 1  ON 2
 uu_3                -2.163298e-02 1 1  ON 3
 uu_4                -6.790293e-02 1 1  ON 4
 uu_5                -1.040837e-01 1 1  ON 5
 uu_6                -1.333802e-01 1 1  ON 6
 uu_7                -1.486575e-01 1 1  ON 7
 uu_8                -1.415154e-01 1 1  ON 8
 uu_9                -1.115691e-01 1 1  ON 9
 ud_0                 4.518004e-01 1 1  ON 10
 ud_1                 1.857205e-01 1 1  ON 11
 ud_2                 6.521925e-02 1 1  ON 12
 ud_3                -6.229715e-03 1 1  ON 13
 ud_4                -6.378411e-02 1 1  ON 14
 ud_5                -1.064534e-01 1 1  ON 15
 ud_6                -1.352971e-01 1 1  ON 16
 ud_7                -1.534807e-01 1 1  ON 17
 ud_8                -1.549248e-01 1 1  ON 18
 ud_9                -1.443154e-01 1 1  ON 19
 eO_0                -7.534963e-01 1 1  ON 20
 eO_1                -4.319496e-01 1 1  ON 21
 eO_2                -1.719858e-02 1 1  ON 22
 eO_3                 2.995073e-01 1 1  ON 23
 eO_4                 5.274869e-01 1 1  ON 24
 eO_5                 4.927146e-01 1 1  ON 25
 eO_6                 2.675607e-01 1 1  ON 26
 eO_7                -3.851287e-02 1 1  ON 27
 eO_8                -2.365173e-01 1 1  ON 28
 eO_9                -1.048209e-01 1 1  ON 29
eH1_0                -2.611735e-01 1 1  ON 30
eH1_1                -1.559394e-01 1 1  ON 31
eH1_2                -1.068811e-01 1 1  ON 32
eH1_3                -5.139536e-02 1 1  ON 33
eH1_4                -1.889897e-03 1 1  ON 34
eH1_5                 3.386304e-02 1 1  ON 35
eH1_6                 9.533279e-02 1 1  ON 36
eH1_7                 1.573195e-01 1 1  ON 37
eH1_8                 1.938264e-01 1 1  ON 38
eH1_9                 9.552750e-02 1 1  ON 39
eH2_0                -2.608288e-01 1 1  ON 40
eH2_1                -1.548565e-01 1 1  ON 41
eH2_2                -1.055625e-01 1 1  ON 42
eH2_3                -5.001595e-02 1 1  ON 43
eH2_4                -3.500610e-04 1 1  ON 44
eH2_5                 3.609665e-02 1 1  ON 45
eH2_6                 9.728630e-02 1 1  ON 46
eH2_7                 1.586711e-01 1 1  ON 47
eH2_8                 2.003498e-01 1 1  ON 48
eH2_9                 9.119420e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8520e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9057
    reference variance = 0.24051
====================================================
  Execution time = 2.0314e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2851e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328552179699
                                         uncertainty =       0.002369173659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328552179699
                                         uncertainty =       0.002369173659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405281899
  error estimate for blocks of size 2^( 2) =       0.000418519313
  error estimate for blocks of size 2^( 3) =       0.000431708072
  error estimate for blocks of size 2^( 4) =       0.000444502154
  error estimate for blocks of size 2^( 5) =       0.000455982981
  error estimate for blocks of size 2^( 6) =       0.000464372755
  error estimate for blocks of size 2^( 7) =       0.000469521780

      target function =                  N/A
              le_mean =     -16.904943472410
             les_mean =     286.105620476955
             stat err =       0.000458594917
             autocorr =       1.280395262681
              std dev =       0.573155158614
             le_variance =       0.328506835846


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690494347241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904943472410       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904943477689       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904943463278       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904943371174       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904943362591       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904943344023       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904943363721       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904943374018       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.541249e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904943472410       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904943473754       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904943469812       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904943446082       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904943443518       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904943438579       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904943443350       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904943445922       residual = 1.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 8.869863e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904943472410       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904943472747       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904943471739       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904943465761       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904943465091       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904943463836       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904943465017       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.095658e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5839e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.111602e-01 1 1  ON 0
 uu_1                 1.436925e-01 1 1  ON 1
 uu_2                 4.148831e-02 1 1  ON 2
 uu_3                -2.163269e-02 1 1  ON 3
 uu_4                -6.790864e-02 1 1  ON 4
 uu_5                -1.040817e-01 1 1  ON 5
 uu_6                -1.333831e-01 1 1  ON 6
 uu_7                -1.486592e-01 1 1  ON 7
 uu_8                -1.415118e-01 1 1  ON 8
 uu_9                -1.115688e-01 1 1  ON 9
 ud_0                 4.518045e-01 1 1  ON 10
 ud_1                 1.857194e-01 1 1  ON 11
 ud_2                 6.521730e-02 1 1  ON 12
 ud_3                -6.230765e-03 1 1  ON 13
 ud_4                -6.378381e-02 1 1  ON 14
 ud_5                -1.064525e-01 1 1  ON 15
 ud_6                -1.353006e-01 1 1  ON 16
 ud_7                -1.534815e-01 1 1  ON 17
 ud_8                -1.549225e-01 1 1  ON 18
 ud_9                -1.443125e-01 1 1  ON 19
 eO_0                -7.534928e-01 1 1  ON 20
 eO_1                -4.319541e-01 1 1  ON 21
 eO_2                -1.719607e-02 1 1  ON 22
 eO_3                 2.995080e-01 1 1  ON 23
 eO_4                 5.274891e-01 1 1  ON 24
 eO_5                 4.927200e-01 1 1  ON 25
 eO_6                 2.675550e-01 1 1  ON 26
 eO_7                -3.851139e-02 1 1  ON 27
 eO_8                -2.365176e-01 1 1  ON 28
 eO_9                -1.048253e-01 1 1  ON 29
eH1_0                -2.611817e-01 1 1  ON 30
eH1_1                -1.559415e-01 1 1  ON 31
eH1_2                -1.068830e-01 1 1  ON 32
eH1_3                -5.140054e-02 1 1  ON 33
eH1_4                -1.890425e-03 1 1  ON 34
eH1_5                 3.386347e-02 1 1  ON 35
eH1_6                 9.533199e-02 1 1  ON 36
eH1_7                 1.573213e-01 1 1  ON 37
eH1_8                 1.938321e-01 1 1  ON 38
eH1_9                 9.553637e-02 1 1  ON 39
eH2_0                -2.608277e-01 1 1  ON 40
eH2_1                -1.548558e-01 1 1  ON 41
eH2_2                -1.055648e-01 1 1  ON 42
eH2_3                -5.001487e-02 1 1  ON 43
eH2_4                -3.553444e-04 1 1  ON 44
eH2_5                 3.609503e-02 1 1  ON 45
eH2_6                 9.728518e-02 1 1  ON 46
eH2_7                 1.586683e-01 1 1  ON 47
eH2_8                 2.003512e-01 1 1  ON 48
eH2_9                 9.120153e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8994
    reference variance = 0.163084
====================================================
  Execution time = 1.9819e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3955e-01
  Total weights = 2.0000e+06
  Execution time = 1.8509e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339556647813
                                         uncertainty =       0.003860745034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339556647813
                                         uncertainty =       0.003860745034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412031576
  error estimate for blocks of size 2^( 2) =       0.000424834364
  error estimate for blocks of size 2^( 3) =       0.000437739858
  error estimate for blocks of size 2^( 4) =       0.000449192281
  error estimate for blocks of size 2^( 5) =       0.000459527960
  error estimate for blocks of size 2^( 6) =       0.000466520487
  error estimate for blocks of size 2^( 7) =       0.000470398048

      target function =                  N/A
              le_mean =     -16.906473349088
             les_mean =     286.168380973360
             stat err =       0.000461409694
             autocorr =       1.254043003774
              std dev =       0.582700643297
             le_variance =       0.339540039699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339583153495
                                         uncertainty =       0.003861034259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339583153495
                                         uncertainty =       0.003861034259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412047653
  error estimate for blocks of size 2^( 2) =       0.000424849713
  error estimate for blocks of size 2^( 3) =       0.000437754575
  error estimate for blocks of size 2^( 4) =       0.000449206580
  error estimate for blocks of size 2^( 5) =       0.000459541691
  error estimate for blocks of size 2^( 6) =       0.000466533516
  error estimate for blocks of size 2^( 7) =       0.000470411161

      target function =                  N/A
              le_mean =     -16.906473578274
             les_mean =     286.168415219164
             stat err =       0.000461423237
             autocorr =       1.254018763503
              std dev =       0.582723378700
             le_variance =       0.339566536084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339570654956
                                         uncertainty =       0.003860895930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339570654956
                                         uncertainty =       0.003860895930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412040072
  error estimate for blocks of size 2^( 2) =       0.000424842468
  error estimate for blocks of size 2^( 3) =       0.000437747621
  error estimate for blocks of size 2^( 4) =       0.000449199824
  error estimate for blocks of size 2^( 5) =       0.000459535198
  error estimate for blocks of size 2^( 6) =       0.000466527359
  error estimate for blocks of size 2^( 7) =       0.000470404966

      target function =                  N/A
              le_mean =     -16.906473469611
             les_mean =     286.168399050611
             stat err =       0.000461416837
             autocorr =       1.254030118094
              std dev =       0.582712657947
             le_variance =       0.339554041732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339558483201
                                         uncertainty =       0.003860763965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339558483201
                                         uncertainty =       0.003860763965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412032689
  error estimate for blocks of size 2^( 2) =       0.000424835424
  error estimate for blocks of size 2^( 3) =       0.000437740871
  error estimate for blocks of size 2^( 4) =       0.000449193263
  error estimate for blocks of size 2^( 5) =       0.000459528902
  error estimate for blocks of size 2^( 6) =       0.000466521382
  error estimate for blocks of size 2^( 7) =       0.000470398948

      target function =                  N/A
              le_mean =     -16.906473364572
             les_mean =     286.168383331551
             stat err =       0.000461410624
             autocorr =       1.254041282749
              std dev =       0.582702217557
             le_variance =       0.339541874346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906473349088        initial
     6.1035e+00     6.1035e+01             3.5412e-05       -16.906473578274  <--
     2.4414e+01     2.4414e+02             8.8699e-06       -16.906473469611
     9.7656e+01     9.7656e+02             2.0957e-06       -16.906473364572

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 2.9154e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.111756e-01 1 1  ON 0
 uu_1                 1.436856e-01 1 1  ON 1
 uu_2                 4.147489e-02 1 1  ON 2
 uu_3                -2.163264e-02 1 1  ON 3
 uu_4                -6.792462e-02 1 1  ON 4
 uu_5                -1.040764e-01 1 1  ON 5
 uu_6                -1.333914e-01 1 1  ON 6
 uu_7                -1.486639e-01 1 1  ON 7
 uu_8                -1.415013e-01 1 1  ON 8
 uu_9                -1.115681e-01 1 1  ON 9
 ud_0                 4.518157e-01 1 1  ON 10
 ud_1                 1.857160e-01 1 1  ON 11
 ud_2                 6.521186e-02 1 1  ON 12
 ud_3                -6.233796e-03 1 1  ON 13
 ud_4                -6.378292e-02 1 1  ON 14
 ud_5                -1.064500e-01 1 1  ON 15
 ud_6                -1.353104e-01 1 1  ON 16
 ud_7                -1.534840e-01 1 1  ON 17
 ud_8                -1.549157e-01 1 1  ON 18
 ud_9                -1.443038e-01 1 1  ON 19
 eO_0                -7.534828e-01 1 1  ON 20
 eO_1                -4.319667e-01 1 1  ON 21
 eO_2                -1.718909e-02 1 1  ON 22
 eO_3                 2.995103e-01 1 1  ON 23
 eO_4                 5.274958e-01 1 1  ON 24
 eO_5                 4.927359e-01 1 1  ON 25
 eO_6                 2.675379e-01 1 1  ON 26
 eO_7                -3.850698e-02 1 1  ON 27
 eO_8                -2.365184e-01 1 1  ON 28
 eO_9                -1.048386e-01 1 1  ON 29
eH1_0                -2.612060e-01 1 1  ON 30
eH1_1                -1.559477e-01 1 1  ON 31
eH1_2                -1.068889e-01 1 1  ON 32
eH1_3                -5.141574e-02 1 1  ON 33
eH1_4                -1.892311e-03 1 1  ON 34
eH1_5                 3.386485e-02 1 1  ON 35
eH1_6                 9.532967e-02 1 1  ON 36
eH1_7                 1.573267e-01 1 1  ON 37
eH1_8                 1.938494e-01 1 1  ON 38
eH1_9                 9.556292e-02 1 1  ON 39
eH2_0                -2.608245e-01 1 1  ON 40
eH2_1                -1.548538e-01 1 1  ON 41
eH2_2                -1.055715e-01 1 1  ON 42
eH2_3                -5.001185e-02 1 1  ON 43
eH2_4                -3.708665e-04 1 1  ON 44
eH2_5                 3.609020e-02 1 1  ON 45
eH2_6                 9.728179e-02 1 1  ON 46
eH2_7                 1.586601e-01 1 1  ON 47
eH2_8                 2.003554e-01 1 1  ON 48
eH2_9                 9.122348e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4999e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9408
    reference variance = 0.179002
====================================================
  Execution time = 2.0535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3209e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332166811973
                                         uncertainty =       0.002453741438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332166811973
                                         uncertainty =       0.002453741438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407486342
  error estimate for blocks of size 2^( 2) =       0.000420134327
  error estimate for blocks of size 2^( 3) =       0.000432722920
  error estimate for blocks of size 2^( 4) =       0.000444690971
  error estimate for blocks of size 2^( 5) =       0.000456092038
  error estimate for blocks of size 2^( 6) =       0.000463024822
  error estimate for blocks of size 2^( 7) =       0.000464937063

      target function =                  N/A
              le_mean =     -16.906811773802
             les_mean =     286.172374426075
             stat err =       0.000457186224
             autocorr =       1.258809923561
              std dev =       0.576272710934
             le_variance =       0.332090237367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690681177380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906811773802       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906812068478       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906812025984       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906812130687       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906812045173       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906812083074       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906812108730       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906812144964       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.254574e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906811773802       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906811856738       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906811843683       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906811871329       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906811850567       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906811860294       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906811868905       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906811876586       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.233275e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906811773802       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906811795209       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906811791772       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906811798793       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906811793657       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906811796122       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906811798450       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906811800277       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 8.145663e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6075e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.111624e-01 1 1  ON 0
 uu_1                 1.436679e-01 1 1  ON 1
 uu_2                 4.148063e-02 1 1  ON 2
 uu_3                -2.163272e-02 1 1  ON 3
 uu_4                -6.792405e-02 1 1  ON 4
 uu_5                -1.040745e-01 1 1  ON 5
 uu_6                -1.334025e-01 1 1  ON 6
 uu_7                -1.486480e-01 1 1  ON 7
 uu_8                -1.415047e-01 1 1  ON 8
 uu_9                -1.115738e-01 1 1  ON 9
 ud_0                 4.518134e-01 1 1  ON 10
 ud_1                 1.857195e-01 1 1  ON 11
 ud_2                 6.521176e-02 1 1  ON 12
 ud_3                -6.228929e-03 1 1  ON 13
 ud_4                -6.379495e-02 1 1  ON 14
 ud_5                -1.064516e-01 1 1  ON 15
 ud_6                -1.353193e-01 1 1  ON 16
 ud_7                -1.534663e-01 1 1  ON 17
 ud_8                -1.548947e-01 1 1  ON 18
 ud_9                -1.443061e-01 1 1  ON 19
 eO_0                -7.534796e-01 1 1  ON 20
 eO_1                -4.319570e-01 1 1  ON 21
 eO_2                -1.718494e-02 1 1  ON 22
 eO_3                 2.995134e-01 1 1  ON 23
 eO_4                 5.274960e-01 1 1  ON 24
 eO_5                 4.927538e-01 1 1  ON 25
 eO_6                 2.675338e-01 1 1  ON 26
 eO_7                -3.850596e-02 1 1  ON 27
 eO_8                -2.365280e-01 1 1  ON 28
 eO_9                -1.048601e-01 1 1  ON 29
eH1_0                -2.612383e-01 1 1  ON 30
eH1_1                -1.559637e-01 1 1  ON 31
eH1_2                -1.068867e-01 1 1  ON 32
eH1_3                -5.141140e-02 1 1  ON 33
eH1_4                -1.892187e-03 1 1  ON 34
eH1_5                 3.384902e-02 1 1  ON 35
eH1_6                 9.533674e-02 1 1  ON 36
eH1_7                 1.573284e-01 1 1  ON 37
eH1_8                 1.938617e-01 1 1  ON 38
eH1_9                 9.559467e-02 1 1  ON 39
eH2_0                -2.608356e-01 1 1  ON 40
eH2_1                -1.548683e-01 1 1  ON 41
eH2_2                -1.055793e-01 1 1  ON 42
eH2_3                -5.004035e-02 1 1  ON 43
eH2_4                -3.624880e-04 1 1  ON 44
eH2_5                 3.607634e-02 1 1  ON 45
eH2_6                 9.728650e-02 1 1  ON 46
eH2_7                 1.586708e-01 1 1  ON 47
eH2_8                 2.003730e-01 1 1  ON 48
eH2_9                 9.125401e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9231
    reference variance = 0.15308
====================================================
  Execution time = 2.0303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4263e-01
  Total weights = 2.0000e+06
  Execution time = 1.8605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342722462639
                                         uncertainty =       0.004910551740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342722462639
                                         uncertainty =       0.004910551740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413911978
  error estimate for blocks of size 2^( 2) =       0.000426671685
  error estimate for blocks of size 2^( 3) =       0.000439294408
  error estimate for blocks of size 2^( 4) =       0.000451498832
  error estimate for blocks of size 2^( 5) =       0.000462219746
  error estimate for blocks of size 2^( 6) =       0.000469368289
  error estimate for blocks of size 2^( 7) =       0.000474558101

      target function =                  N/A
              le_mean =     -16.906879788448
             les_mean =     286.185230261134
             stat err =       0.000464411242
             autocorr =       1.258894855916
              std dev =       0.585359933225
             le_variance =       0.342646251425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342676244066
                                         uncertainty =       0.004910001583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342676244066
                                         uncertainty =       0.004910001583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413884076
  error estimate for blocks of size 2^( 2) =       0.000426645800
  error estimate for blocks of size 2^( 3) =       0.000439270166
  error estimate for blocks of size 2^( 4) =       0.000451476154
  error estimate for blocks of size 2^( 5) =       0.000462198447
  error estimate for blocks of size 2^( 6) =       0.000469348705
  error estimate for blocks of size 2^( 7) =       0.000474541752

      target function =                  N/A
              le_mean =     -16.906880199224
             les_mean =     286.185197956227
             stat err =       0.000464391264
             autocorr =       1.258956280585
              std dev =       0.585320473433
             le_variance =       0.342600056620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342695058490
                                         uncertainty =       0.004910194313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342695058490
                                         uncertainty =       0.004910194313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413895434
  error estimate for blocks of size 2^( 2) =       0.000426656341
  error estimate for blocks of size 2^( 3) =       0.000439279999
  error estimate for blocks of size 2^( 4) =       0.000451485365
  error estimate for blocks of size 2^( 5) =       0.000462207142
  error estimate for blocks of size 2^( 6) =       0.000469356725
  error estimate for blocks of size 2^( 7) =       0.000474548338

      target function =                  N/A
              le_mean =     -16.906880033472
             les_mean =     286.185211155574
             stat err =       0.000464399392
             autocorr =       1.258931250937
              std dev =       0.585336536251
             le_variance =       0.342618860671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342718866220
                                         uncertainty =       0.004910503817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342718866220
                                         uncertainty =       0.004910503817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413909807
  error estimate for blocks of size 2^( 2) =       0.000426669671
  error estimate for blocks of size 2^( 3) =       0.000439292515
  error estimate for blocks of size 2^( 4) =       0.000451497063
  error estimate for blocks of size 2^( 5) =       0.000462218091
  error estimate for blocks of size 2^( 6) =       0.000469366772
  error estimate for blocks of size 2^( 7) =       0.000474556817

      target function =                  N/A
              le_mean =     -16.906879819824
             les_mean =     286.185227727397
             stat err =       0.000464409686
             autocorr =       1.258899626039
              std dev =       0.585356862719
             le_variance =       0.342642656732


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906879788448        initial
     1.5259e+00     1.5259e+01             1.2546e-04       -16.906880199224  <--
     6.1035e+00     6.1035e+01             3.2333e-05       -16.906880033472
     2.4414e+01     2.4414e+02             8.1457e-06       -16.906879819824

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.9648e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.111237e-01 1 1  ON 0
 uu_1                 1.436267e-01 1 1  ON 1
 uu_2                 4.148819e-02 1 1  ON 2
 uu_3                -2.163041e-02 1 1  ON 3
 uu_4                -6.792467e-02 1 1  ON 4
 uu_5                -1.040696e-01 1 1  ON 5
 uu_6                -1.334337e-01 1 1  ON 6
 uu_7                -1.486044e-01 1 1  ON 7
 uu_8                -1.415143e-01 1 1  ON 8
 uu_9                -1.115902e-01 1 1  ON 9
 ud_0                 4.518097e-01 1 1  ON 10
 ud_1                 1.857282e-01 1 1  ON 11
 ud_2                 6.521250e-02 1 1  ON 12
 ud_3                -6.219008e-03 1 1  ON 13
 ud_4                -6.382558e-02 1 1  ON 14
 ud_5                -1.064589e-01 1 1  ON 15
 ud_6                -1.353445e-01 1 1  ON 16
 ud_7                -1.534174e-01 1 1  ON 17
 ud_8                -1.548327e-01 1 1  ON 18
 ud_9                -1.443118e-01 1 1  ON 19
 eO_0                -7.534693e-01 1 1  ON 20
 eO_1                -4.319306e-01 1 1  ON 21
 eO_2                -1.717047e-02 1 1  ON 22
 eO_3                 2.995227e-01 1 1  ON 23
 eO_4                 5.274960e-01 1 1  ON 24
 eO_5                 4.928054e-01 1 1  ON 25
 eO_6                 2.675217e-01 1 1  ON 26
 eO_7                -3.850297e-02 1 1  ON 27
 eO_8                -2.365557e-01 1 1  ON 28
 eO_9                -1.049231e-01 1 1  ON 29
eH1_0                -2.613315e-01 1 1  ON 30
eH1_1                -1.560063e-01 1 1  ON 31
eH1_2                -1.068835e-01 1 1  ON 32
eH1_3                -5.140107e-02 1 1  ON 33
eH1_4                -1.890134e-03 1 1  ON 34
eH1_5                 3.380173e-02 1 1  ON 35
eH1_6                 9.535608e-02 1 1  ON 36
eH1_7                 1.573329e-01 1 1  ON 37
eH1_8                 1.938978e-01 1 1  ON 38
eH1_9                 9.568800e-02 1 1  ON 39
eH2_0                -2.608679e-01 1 1  ON 40
eH2_1                -1.549125e-01 1 1  ON 41
eH2_2                -1.056042e-01 1 1  ON 42
eH2_3                -5.011832e-02 1 1  ON 43
eH2_4                -3.433322e-04 1 1  ON 44
eH2_5                 3.603699e-02 1 1  ON 45
eH2_6                 9.730082e-02 1 1  ON 46
eH2_7                 1.587029e-01 1 1  ON 47
eH2_8                 2.004253e-01 1 1  ON 48
eH2_9                 9.134378e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8759
    reference variance = 0.195127
====================================================
  Execution time = 2.0295e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3829e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338407833327
                                         uncertainty =       0.004445971414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338407833327
                                         uncertainty =       0.004445971414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411273840
  error estimate for blocks of size 2^( 2) =       0.000423740645
  error estimate for blocks of size 2^( 3) =       0.000436435132
  error estimate for blocks of size 2^( 4) =       0.000448747510
  error estimate for blocks of size 2^( 5) =       0.000458876180
  error estimate for blocks of size 2^( 6) =       0.000464436019
  error estimate for blocks of size 2^( 7) =       0.000468360932

      target function =                  N/A
              le_mean =     -16.906756891319
             les_mean =     286.176720756419
             stat err =       0.000460105160
             autocorr =       1.251561039680
              std dev =       0.581629042785
             le_variance =       0.338292343412


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690675689132e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906756891319       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906756777844       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906755610341       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906756176334       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906756474643       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906756945133       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906756871928       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906756999580       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906756769636       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.532403e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906756891319       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906756853052       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906756447640       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906756538151       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906756649464       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906756827676       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906756814770       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906756847978       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.127138e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906756891319       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906756880838       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906756769148       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906756786241       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906756813884       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906756865528       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906756864367       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906756872069       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.855431e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234339 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5924e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.111212e-01 1 1  ON 0
 uu_1                 1.436093e-01 1 1  ON 1
 uu_2                 4.145359e-02 1 1  ON 2
 uu_3                -2.159470e-02 1 1  ON 3
 uu_4                -6.794998e-02 1 1  ON 4
 uu_5                -1.040326e-01 1 1  ON 5
 uu_6                -1.334322e-01 1 1  ON 6
 uu_7                -1.485850e-01 1 1  ON 7
 uu_8                -1.415291e-01 1 1  ON 8
 uu_9                -1.116404e-01 1 1  ON 9
 ud_0                 4.518419e-01 1 1  ON 10
 ud_1                 1.857782e-01 1 1  ON 11
 ud_2                 6.523047e-02 1 1  ON 12
 ud_3                -6.211353e-03 1 1  ON 13
 ud_4                -6.382944e-02 1 1  ON 14
 ud_5                -1.064761e-01 1 1  ON 15
 ud_6                -1.353582e-01 1 1  ON 16
 ud_7                -1.533872e-01 1 1  ON 17
 ud_8                -1.548615e-01 1 1  ON 18
 ud_9                -1.443550e-01 1 1  ON 19
 eO_0                -7.534931e-01 1 1  ON 20
 eO_1                -4.318947e-01 1 1  ON 21
 eO_2                -1.712254e-02 1 1  ON 22
 eO_3                 2.995372e-01 1 1  ON 23
 eO_4                 5.275971e-01 1 1  ON 24
 eO_5                 4.928347e-01 1 1  ON 25
 eO_6                 2.674705e-01 1 1  ON 26
 eO_7                -3.849853e-02 1 1  ON 27
 eO_8                -2.366151e-01 1 1  ON 28
 eO_9                -1.050058e-01 1 1  ON 29
eH1_0                -2.613972e-01 1 1  ON 30
eH1_1                -1.560204e-01 1 1  ON 31
eH1_2                -1.069550e-01 1 1  ON 32
eH1_3                -5.144161e-02 1 1  ON 33
eH1_4                -1.907563e-03 1 1  ON 34
eH1_5                 3.384308e-02 1 1  ON 35
eH1_6                 9.537546e-02 1 1  ON 36
eH1_7                 1.573626e-01 1 1  ON 37
eH1_8                 1.939299e-01 1 1  ON 38
eH1_9                 9.575616e-02 1 1  ON 39
eH2_0                -2.608387e-01 1 1  ON 40
eH2_1                -1.548997e-01 1 1  ON 41
eH2_2                -1.056731e-01 1 1  ON 42
eH2_3                -5.020913e-02 1 1  ON 43
eH2_4                -3.018569e-04 1 1  ON 44
eH2_5                 3.600427e-02 1 1  ON 45
eH2_6                 9.725221e-02 1 1  ON 46
eH2_7                 1.587089e-01 1 1  ON 47
eH2_8                 2.004378e-01 1 1  ON 48
eH2_9                 9.145649e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8271
    reference variance = 0.324596
====================================================
  Execution time = 1.9967e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5126e-01
  Total weights = 2.0000e+06
  Execution time = 1.8538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351058223011
                                         uncertainty =       0.008577041717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351058223011
                                         uncertainty =       0.008577041717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419067643
  error estimate for blocks of size 2^( 2) =       0.000431569447
  error estimate for blocks of size 2^( 3) =       0.000444496734
  error estimate for blocks of size 2^( 4) =       0.000456838606
  error estimate for blocks of size 2^( 5) =       0.000467630485
  error estimate for blocks of size 2^( 6) =       0.000478133021
  error estimate for blocks of size 2^( 7) =       0.000489070704

      target function =                  N/A
              le_mean =     -16.905843144731
             les_mean =     286.158767637014
             stat err =       0.000472918204
             autocorr =       1.273514239098
              std dev =       0.592651143901
             le_variance =       0.351235378367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351139805829
                                         uncertainty =       0.008578976816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351139805829
                                         uncertainty =       0.008578976816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419116361
  error estimate for blocks of size 2^( 2) =       0.000431615972
  error estimate for blocks of size 2^( 3) =       0.000444538472
  error estimate for blocks of size 2^( 4) =       0.000456876882
  error estimate for blocks of size 2^( 5) =       0.000467664972
  error estimate for blocks of size 2^( 6) =       0.000478163167
  error estimate for blocks of size 2^( 7) =       0.000489103263

      target function =                  N/A
              le_mean =     -16.905842780584
             les_mean =     286.158836993470
             stat err =       0.000472952071
             autocorr =       1.273400555502
              std dev =       0.592720041261
             le_variance =       0.351317047312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351109233412
                                         uncertainty =       0.008578444644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351109233412
                                         uncertainty =       0.008578444644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419098111
  error estimate for blocks of size 2^( 2) =       0.000431598619
  error estimate for blocks of size 2^( 3) =       0.000444522821
  error estimate for blocks of size 2^( 4) =       0.000456862867
  error estimate for blocks of size 2^( 5) =       0.000467652457
  error estimate for blocks of size 2^( 6) =       0.000478152969
  error estimate for blocks of size 2^( 7) =       0.000489092761

      target function =                  N/A
              le_mean =     -16.905843102089
             les_mean =     286.158817270024
             stat err =       0.000472940263
             autocorr =       1.273447870102
              std dev =       0.592694232482
             le_variance =       0.351286453217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351064333550
                                         uncertainty =       0.008577228687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351064333550
                                         uncertainty =       0.008577228687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419071294
  error estimate for blocks of size 2^( 2) =       0.000431572932
  error estimate for blocks of size 2^( 3) =       0.000444499809
  error estimate for blocks of size 2^( 4) =       0.000456841447
  error estimate for blocks of size 2^( 5) =       0.000467633021
  error estimate for blocks of size 2^( 6) =       0.000478135327
  error estimate for blocks of size 2^( 7) =       0.000489073340

      target function =                  N/A
              le_mean =     -16.905843134034
             les_mean =     286.158773395996
             stat err =       0.000472920784
             autocorr =       1.273505940490
              std dev =       0.592656307703
             le_variance =       0.351241499060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905843144731        initial  <--
     3.8147e-01     3.8147e+00             4.5324e-04       -16.905842780584
     1.5259e+00     1.5259e+01             1.1271e-04       -16.905843102089
     6.1035e+00     6.1035e+01             2.8554e-05       -16.905843134034

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3130
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.111237e-01 1 1  ON 0
 uu_1                 1.436267e-01 1 1  ON 1
 uu_2                 4.148819e-02 1 1  ON 2
 uu_3                -2.163041e-02 1 1  ON 3
 uu_4                -6.792467e-02 1 1  ON 4
 uu_5                -1.040696e-01 1 1  ON 5
 uu_6                -1.334337e-01 1 1  ON 6
 uu_7                -1.486044e-01 1 1  ON 7
 uu_8                -1.415143e-01 1 1  ON 8
 uu_9                -1.115902e-01 1 1  ON 9
 ud_0                 4.518097e-01 1 1  ON 10
 ud_1                 1.857282e-01 1 1  ON 11
 ud_2                 6.521250e-02 1 1  ON 12
 ud_3                -6.219008e-03 1 1  ON 13
 ud_4                -6.382558e-02 1 1  ON 14
 ud_5                -1.064589e-01 1 1  ON 15
 ud_6                -1.353445e-01 1 1  ON 16
 ud_7                -1.534174e-01 1 1  ON 17
 ud_8                -1.548327e-01 1 1  ON 18
 ud_9                -1.443118e-01 1 1  ON 19
 eO_0                -7.534693e-01 1 1  ON 20
 eO_1                -4.319306e-01 1 1  ON 21
 eO_2                -1.717047e-02 1 1  ON 22
 eO_3                 2.995227e-01 1 1  ON 23
 eO_4                 5.274960e-01 1 1  ON 24
 eO_5                 4.928054e-01 1 1  ON 25
 eO_6                 2.675217e-01 1 1  ON 26
 eO_7                -3.850297e-02 1 1  ON 27
 eO_8                -2.365557e-01 1 1  ON 28
 eO_9                -1.049231e-01 1 1  ON 29
eH1_0                -2.613315e-01 1 1  ON 30
eH1_1                -1.560063e-01 1 1  ON 31
eH1_2                -1.068835e-01 1 1  ON 32
eH1_3                -5.140107e-02 1 1  ON 33
eH1_4                -1.890134e-03 1 1  ON 34
eH1_5                 3.380173e-02 1 1  ON 35
eH1_6                 9.535608e-02 1 1  ON 36
eH1_7                 1.573329e-01 1 1  ON 37
eH1_8                 1.938978e-01 1 1  ON 38
eH1_9                 9.568800e-02 1 1  ON 39
eH2_0                -2.608679e-01 1 1  ON 40
eH2_1                -1.549125e-01 1 1  ON 41
eH2_2                -1.056042e-01 1 1  ON 42
eH2_3                -5.011832e-02 1 1  ON 43
eH2_4                -3.433322e-04 1 1  ON 44
eH2_5                 3.603699e-02 1 1  ON 45
eH2_6                 9.730082e-02 1 1  ON 46
eH2_7                 1.587029e-01 1 1  ON 47
eH2_8                 2.004253e-01 1 1  ON 48
eH2_9                 9.134378e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9043
    reference variance = 0.491497
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3621e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336160912484
                                         uncertainty =       0.003076391332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336160912484
                                         uncertainty =       0.003076391332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410009025
  error estimate for blocks of size 2^( 2) =       0.000423266016
  error estimate for blocks of size 2^( 3) =       0.000436652239
  error estimate for blocks of size 2^( 4) =       0.000449326007
  error estimate for blocks of size 2^( 5) =       0.000460546889
  error estimate for blocks of size 2^( 6) =       0.000470157576
  error estimate for blocks of size 2^( 7) =       0.000478206010

      target function =                  N/A
              le_mean =     -16.906157111576
             les_mean =     286.154362914144
             stat err =       0.000464559121
             autocorr =       1.283793431585
              std dev =       0.579840323679
             le_variance =       0.336214800964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615711158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157111576       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906157184070       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906157139166       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906157227211       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906157353571       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906157353845       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906157308073       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906157312957       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 7.754882e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157111576       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906157130198       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906157119927       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906157144096       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906157174120       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906157172638       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906157162466       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.849875e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157111576       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906157116264       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906157113768       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906157120043       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906157127322       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906157126864       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906157124419       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 4.638172e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6186e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.111149e-01 1 1  ON 0
 uu_1                 1.436229e-01 1 1  ON 1
 uu_2                 4.148574e-02 1 1  ON 2
 uu_3                -2.163036e-02 1 1  ON 3
 uu_4                -6.792290e-02 1 1  ON 4
 uu_5                -1.040730e-01 1 1  ON 5
 uu_6                -1.334341e-01 1 1  ON 6
 uu_7                -1.486093e-01 1 1  ON 7
 uu_8                -1.415060e-01 1 1  ON 8
 uu_9                -1.115870e-01 1 1  ON 9
 ud_0                 4.518092e-01 1 1  ON 10
 ud_1                 1.857270e-01 1 1  ON 11
 ud_2                 6.520728e-02 1 1  ON 12
 ud_3                -6.219695e-03 1 1  ON 13
 ud_4                -6.382924e-02 1 1  ON 14
 ud_5                -1.064608e-01 1 1  ON 15
 ud_6                -1.353453e-01 1 1  ON 16
 ud_7                -1.534177e-01 1 1  ON 17
 ud_8                -1.548209e-01 1 1  ON 18
 ud_9                -1.443056e-01 1 1  ON 19
 eO_0                -7.534687e-01 1 1  ON 20
 eO_1                -4.319229e-01 1 1  ON 21
 eO_2                -1.717451e-02 1 1  ON 22
 eO_3                 2.995201e-01 1 1  ON 23
 eO_4                 5.275012e-01 1 1  ON 24
 eO_5                 4.928095e-01 1 1  ON 25
 eO_6                 2.675173e-01 1 1  ON 26
 eO_7                -3.850146e-02 1 1  ON 27
 eO_8                -2.365547e-01 1 1  ON 28
 eO_9                -1.049300e-01 1 1  ON 29
eH1_0                -2.613349e-01 1 1  ON 30
eH1_1                -1.560050e-01 1 1  ON 31
eH1_2                -1.068870e-01 1 1  ON 32
eH1_3                -5.141179e-02 1 1  ON 33
eH1_4                -1.888936e-03 1 1  ON 34
eH1_5                 3.379817e-02 1 1  ON 35
eH1_6                 9.535790e-02 1 1  ON 36
eH1_7                 1.573361e-01 1 1  ON 37
eH1_8                 1.939050e-01 1 1  ON 38
eH1_9                 9.569672e-02 1 1  ON 39
eH2_0                -2.608688e-01 1 1  ON 40
eH2_1                -1.549116e-01 1 1  ON 41
eH2_2                -1.056098e-01 1 1  ON 42
eH2_3                -5.013107e-02 1 1  ON 43
eH2_4                -3.523417e-04 1 1  ON 44
eH2_5                 3.603828e-02 1 1  ON 45
eH2_6                 9.729573e-02 1 1  ON 46
eH2_7                 1.587010e-01 1 1  ON 47
eH2_8                 2.004344e-01 1 1  ON 48
eH2_9                 9.136228e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9641
    reference variance = 0.326245
====================================================
  Execution time = 2.0067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3480e-01
  Total weights = 2.0000e+06
  Execution time = 1.8596e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334881862507
                                         uncertainty =       0.002904184533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334881862507
                                         uncertainty =       0.002904184533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409144103
  error estimate for blocks of size 2^( 2) =       0.000422249760
  error estimate for blocks of size 2^( 3) =       0.000436428805
  error estimate for blocks of size 2^( 4) =       0.000450283527
  error estimate for blocks of size 2^( 5) =       0.000461923633
  error estimate for blocks of size 2^( 6) =       0.000472044115
  error estimate for blocks of size 2^( 7) =       0.000477515172

      target function =                  N/A
              le_mean =     -16.905738801275
             les_mean =     286.138802042810
             stat err =       0.000465441612
             autocorr =       1.294129760887
              std dev =       0.578617138768
             le_variance =       0.334797793276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334887022292
                                         uncertainty =       0.002904136912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334887022292
                                         uncertainty =       0.002904136912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409147252
  error estimate for blocks of size 2^( 2) =       0.000422252989
  error estimate for blocks of size 2^( 3) =       0.000436432328
  error estimate for blocks of size 2^( 4) =       0.000450286586
  error estimate for blocks of size 2^( 5) =       0.000461926277
  error estimate for blocks of size 2^( 6) =       0.000472046169
  error estimate for blocks of size 2^( 7) =       0.000477515641

      target function =                  N/A
              le_mean =     -16.905738960479
             les_mean =     286.138812579792
             stat err =       0.000465443668
             autocorr =       1.294121273027
              std dev =       0.578621592535
             le_variance =       0.334802947347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334886186898
                                         uncertainty =       0.002904167264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334886186898
                                         uncertainty =       0.002904167264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409146743
  error estimate for blocks of size 2^( 2) =       0.000422252381
  error estimate for blocks of size 2^( 3) =       0.000436431545
  error estimate for blocks of size 2^( 4) =       0.000450285983
  error estimate for blocks of size 2^( 5) =       0.000461925832
  error estimate for blocks of size 2^( 6) =       0.000472045966
  error estimate for blocks of size 2^( 7) =       0.000477516166

      target function =                  N/A
              le_mean =     -16.905738890793
             les_mean =     286.138809390345
             stat err =       0.000465443486
             autocorr =       1.294123483787
              std dev =       0.578620872474
             le_variance =       0.334802114063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334882410083
                                         uncertainty =       0.002904182344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334882410083
                                         uncertainty =       0.002904182344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409144437
  error estimate for blocks of size 2^( 2) =       0.000422250092
  error estimate for blocks of size 2^( 3) =       0.000436429151
  error estimate for blocks of size 2^( 4) =       0.000450283837
  error estimate for blocks of size 2^( 5) =       0.000461923911
  error estimate for blocks of size 2^( 6) =       0.000472044349
  error estimate for blocks of size 2^( 7) =       0.000477515297

      target function =                  N/A
              le_mean =     -16.905738812564
             les_mean =     286.138802971629
             stat err =       0.000465441849
             autocorr =       1.294128962546
              std dev =       0.578617611543
             le_variance =       0.334798340387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905738801275        initial
     3.8147e+00     3.8147e+01             7.7549e-05       -16.905738960479  <--
     1.5259e+01     1.5259e+02             1.8499e-05       -16.905738890793
     6.1035e+01     6.1035e+02             4.6382e-06       -16.905738812564

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 2.9445e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.110891e-01 1 1  ON 0
 uu_1                 1.436121e-01 1 1  ON 1
 uu_2                 4.147858e-02 1 1  ON 2
 uu_3                -2.163126e-02 1 1  ON 3
 uu_4                -6.791891e-02 1 1  ON 4
 uu_5                -1.040821e-01 1 1  ON 5
 uu_6                -1.334338e-01 1 1  ON 6
 uu_7                -1.486249e-01 1 1  ON 7
 uu_8                -1.414821e-01 1 1  ON 8
 uu_9                -1.115786e-01 1 1  ON 9
 ud_0                 4.518067e-01 1 1  ON 10
 ud_1                 1.857231e-01 1 1  ON 11
 ud_2                 6.519518e-02 1 1  ON 12
 ud_3                -6.223222e-03 1 1  ON 13
 ud_4                -6.383762e-02 1 1  ON 14
 ud_5                -1.064671e-01 1 1  ON 15
 ud_6                -1.353455e-01 1 1  ON 16
 ud_7                -1.534193e-01 1 1  ON 17
 ud_8                -1.547873e-01 1 1  ON 18
 ud_9                -1.442881e-01 1 1  ON 19
 eO_0                -7.534641e-01 1 1  ON 20
 eO_1                -4.319034e-01 1 1  ON 21
 eO_2                -1.718405e-02 1 1  ON 22
 eO_3                 2.995145e-01 1 1  ON 23
 eO_4                 5.275159e-01 1 1  ON 24
 eO_5                 4.928224e-01 1 1  ON 25
 eO_6                 2.675046e-01 1 1  ON 26
 eO_7                -3.849758e-02 1 1  ON 27
 eO_8                -2.365526e-01 1 1  ON 28
 eO_9                -1.049527e-01 1 1  ON 29
eH1_0                -2.613455e-01 1 1  ON 30
eH1_1                -1.560034e-01 1 1  ON 31
eH1_2                -1.068983e-01 1 1  ON 32
eH1_3                -5.144287e-02 1 1  ON 33
eH1_4                -1.884654e-03 1 1  ON 34
eH1_5                 3.378775e-02 1 1  ON 35
eH1_6                 9.536289e-02 1 1  ON 36
eH1_7                 1.573455e-01 1 1  ON 37
eH1_8                 1.939276e-01 1 1  ON 38
eH1_9                 9.572443e-02 1 1  ON 39
eH2_0                -2.608725e-01 1 1  ON 40
eH2_1                -1.549106e-01 1 1  ON 41
eH2_2                -1.056248e-01 1 1  ON 42
eH2_3                -5.017110e-02 1 1  ON 43
eH2_4                -3.796497e-04 1 1  ON 44
eH2_5                 3.604072e-02 1 1  ON 45
eH2_6                 9.727929e-02 1 1  ON 46
eH2_7                 1.586952e-01 1 1  ON 47
eH2_8                 2.004631e-01 1 1  ON 48
eH2_9                 9.142133e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.878
    reference variance = 0.185388
====================================================
  Execution time = 2.0423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3970e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339026499130
                                         uncertainty =       0.003251421127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339026499130
                                         uncertainty =       0.003251421127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412128044
  error estimate for blocks of size 2^( 2) =       0.000424967251
  error estimate for blocks of size 2^( 3) =       0.000437725800
  error estimate for blocks of size 2^( 4) =       0.000450086973
  error estimate for blocks of size 2^( 5) =       0.000460189911
  error estimate for blocks of size 2^( 6) =       0.000466738935
  error estimate for blocks of size 2^( 7) =       0.000470218010

      target function =                  N/A
              le_mean =     -16.906231176527
             les_mean =     286.160351474378
             stat err =       0.000461808457
             autocorr =       1.255623476052
              std dev =       0.582837069900
             le_variance =       0.339699050050


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623117653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906231176527       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906231205780       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906231091284       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906231323312       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906230963976       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906231202093       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906231417671       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906231439760       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.081792e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906231176527       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906231185153       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906231155906       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906231228096       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906231142559       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906231175938       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906231250227       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.088182e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906231176527       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906231178785       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906231171462       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906231190603       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906231170142       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906231177013       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906231195944       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.285653e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6093e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.110895e-01 1 1  ON 0
 uu_1                 1.436061e-01 1 1  ON 1
 uu_2                 4.148293e-02 1 1  ON 2
 uu_3                -2.161927e-02 1 1  ON 3
 uu_4                -6.794613e-02 1 1  ON 4
 uu_5                -1.040805e-01 1 1  ON 5
 uu_6                -1.334252e-01 1 1  ON 6
 uu_7                -1.486048e-01 1 1  ON 7
 uu_8                -1.414961e-01 1 1  ON 8
 uu_9                -1.116085e-01 1 1  ON 9
 ud_0                 4.518070e-01 1 1  ON 10
 ud_1                 1.857294e-01 1 1  ON 11
 ud_2                 6.518849e-02 1 1  ON 12
 ud_3                -6.209949e-03 1 1  ON 13
 ud_4                -6.382720e-02 1 1  ON 14
 ud_5                -1.064626e-01 1 1  ON 15
 ud_6                -1.353392e-01 1 1  ON 16
 ud_7                -1.534260e-01 1 1  ON 17
 ud_8                -1.548041e-01 1 1  ON 18
 ud_9                -1.442983e-01 1 1  ON 19
 eO_0                -7.534243e-01 1 1  ON 20
 eO_1                -4.318927e-01 1 1  ON 21
 eO_2                -1.720122e-02 1 1  ON 22
 eO_3                 2.995008e-01 1 1  ON 23
 eO_4                 5.275346e-01 1 1  ON 24
 eO_5                 4.928579e-01 1 1  ON 25
 eO_6                 2.675108e-01 1 1  ON 26
 eO_7                -3.851080e-02 1 1  ON 27
 eO_8                -2.365853e-01 1 1  ON 28
 eO_9                -1.049825e-01 1 1  ON 29
eH1_0                -2.613856e-01 1 1  ON 30
eH1_1                -1.560040e-01 1 1  ON 31
eH1_2                -1.069085e-01 1 1  ON 32
eH1_3                -5.145315e-02 1 1  ON 33
eH1_4                -1.878409e-03 1 1  ON 34
eH1_5                 3.377895e-02 1 1  ON 35
eH1_6                 9.535786e-02 1 1  ON 36
eH1_7                 1.573336e-01 1 1  ON 37
eH1_8                 1.939507e-01 1 1  ON 38
eH1_9                 9.577531e-02 1 1  ON 39
eH2_0                -2.608621e-01 1 1  ON 40
eH2_1                -1.549134e-01 1 1  ON 41
eH2_2                -1.056319e-01 1 1  ON 42
eH2_3                -5.017668e-02 1 1  ON 43
eH2_4                -3.730512e-04 1 1  ON 44
eH2_5                 3.600703e-02 1 1  ON 45
eH2_6                 9.725524e-02 1 1  ON 46
eH2_7                 1.586832e-01 1 1  ON 47
eH2_8                 2.004803e-01 1 1  ON 48
eH2_9                 9.146764e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9147
    reference variance = 0.27741
====================================================
  Execution time = 2.0123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4724e-01
  Total weights = 2.0000e+06
  Execution time = 1.8525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347304354556
                                         uncertainty =       0.005888907186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347304354556
                                         uncertainty =       0.005888907186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416679498
  error estimate for blocks of size 2^( 2) =       0.000429251869
  error estimate for blocks of size 2^( 3) =       0.000441530348
  error estimate for blocks of size 2^( 4) =       0.000453116010
  error estimate for blocks of size 2^( 5) =       0.000463849252
  error estimate for blocks of size 2^( 6) =       0.000471197625
  error estimate for blocks of size 2^( 7) =       0.000475937536

      target function =                  N/A
              le_mean =     -16.906005697844
             les_mean =     286.160272089413
             stat err =       0.000466025106
             autocorr =       1.250876297876
              std dev =       0.589273796709
             le_variance =       0.347243607487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347290359644
                                         uncertainty =       0.005889022616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347290359644
                                         uncertainty =       0.005889022616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416671090
  error estimate for blocks of size 2^( 2) =       0.000429243004
  error estimate for blocks of size 2^( 3) =       0.000441521806
  error estimate for blocks of size 2^( 4) =       0.000453107769
  error estimate for blocks of size 2^( 5) =       0.000463842077
  error estimate for blocks of size 2^( 6) =       0.000471189679
  error estimate for blocks of size 2^( 7) =       0.000475927959

      target function =                  N/A
              le_mean =     -16.906005317481
             les_mean =     286.160245214839
             stat err =       0.000466016871
             autocorr =       1.250882574686
              std dev =       0.589261905906
             le_variance =       0.347229593752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347297135711
                                         uncertainty =       0.005889069844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347297135711
                                         uncertainty =       0.005889069844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416675160
  error estimate for blocks of size 2^( 2) =       0.000429247218
  error estimate for blocks of size 2^( 3) =       0.000441525880
  error estimate for blocks of size 2^( 4) =       0.000453111677
  error estimate for blocks of size 2^( 5) =       0.000463845549
  error estimate for blocks of size 2^( 6) =       0.000471193227
  error estimate for blocks of size 2^( 7) =       0.000475932360

      target function =                  N/A
              le_mean =     -16.906005423569
             les_mean =     286.160255585533
             stat err =       0.000466020703
             autocorr =       1.250878708391
              std dev =       0.589267661942
             le_variance =       0.347236377411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303567643
                                         uncertainty =       0.005888930758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303567643
                                         uncertainty =       0.005888930758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416679025
  error estimate for blocks of size 2^( 2) =       0.000429251348
  error estimate for blocks of size 2^( 3) =       0.000441529849
  error estimate for blocks of size 2^( 4) =       0.000453115531
  error estimate for blocks of size 2^( 5) =       0.000463848857
  error estimate for blocks of size 2^( 6) =       0.000471197129
  error estimate for blocks of size 2^( 7) =       0.000475936945

      target function =                  N/A
              le_mean =     -16.906005659188
             les_mean =     286.160269993970
             stat err =       0.000466024615
             autocorr =       1.250876506002
              std dev =       0.589273127755
             le_variance =       0.347242819094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906005697844        initial  <--
     9.5367e-01     9.5367e+00             2.0818e-04       -16.906005317481
     3.8147e+00     3.8147e+01             5.0882e-05       -16.906005423569
     1.5259e+01     1.5259e+02             1.2857e-05       -16.906005659188

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4576
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.110891e-01 1 1  ON 0
 uu_1                 1.436121e-01 1 1  ON 1
 uu_2                 4.147858e-02 1 1  ON 2
 uu_3                -2.163126e-02 1 1  ON 3
 uu_4                -6.791891e-02 1 1  ON 4
 uu_5                -1.040821e-01 1 1  ON 5
 uu_6                -1.334338e-01 1 1  ON 6
 uu_7                -1.486249e-01 1 1  ON 7
 uu_8                -1.414821e-01 1 1  ON 8
 uu_9                -1.115786e-01 1 1  ON 9
 ud_0                 4.518067e-01 1 1  ON 10
 ud_1                 1.857231e-01 1 1  ON 11
 ud_2                 6.519518e-02 1 1  ON 12
 ud_3                -6.223222e-03 1 1  ON 13
 ud_4                -6.383762e-02 1 1  ON 14
 ud_5                -1.064671e-01 1 1  ON 15
 ud_6                -1.353455e-01 1 1  ON 16
 ud_7                -1.534193e-01 1 1  ON 17
 ud_8                -1.547873e-01 1 1  ON 18
 ud_9                -1.442881e-01 1 1  ON 19
 eO_0                -7.534641e-01 1 1  ON 20
 eO_1                -4.319034e-01 1 1  ON 21
 eO_2                -1.718405e-02 1 1  ON 22
 eO_3                 2.995145e-01 1 1  ON 23
 eO_4                 5.275159e-01 1 1  ON 24
 eO_5                 4.928224e-01 1 1  ON 25
 eO_6                 2.675046e-01 1 1  ON 26
 eO_7                -3.849758e-02 1 1  ON 27
 eO_8                -2.365526e-01 1 1  ON 28
 eO_9                -1.049527e-01 1 1  ON 29
eH1_0                -2.613455e-01 1 1  ON 30
eH1_1                -1.560034e-01 1 1  ON 31
eH1_2                -1.068983e-01 1 1  ON 32
eH1_3                -5.144287e-02 1 1  ON 33
eH1_4                -1.884654e-03 1 1  ON 34
eH1_5                 3.378775e-02 1 1  ON 35
eH1_6                 9.536289e-02 1 1  ON 36
eH1_7                 1.573455e-01 1 1  ON 37
eH1_8                 1.939276e-01 1 1  ON 38
eH1_9                 9.572443e-02 1 1  ON 39
eH2_0                -2.608725e-01 1 1  ON 40
eH2_1                -1.549106e-01 1 1  ON 41
eH2_2                -1.056248e-01 1 1  ON 42
eH2_3                -5.017110e-02 1 1  ON 43
eH2_4                -3.796497e-04 1 1  ON 44
eH2_5                 3.604072e-02 1 1  ON 45
eH2_6                 9.727929e-02 1 1  ON 46
eH2_7                 1.586952e-01 1 1  ON 47
eH2_8                 2.004631e-01 1 1  ON 48
eH2_9                 9.142133e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9099
    reference variance = 0.245064
====================================================
  Execution time = 2.2659e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3573e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335765786060
                                         uncertainty =       0.003383589977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335765786060
                                         uncertainty =       0.003383589977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409710687
  error estimate for blocks of size 2^( 2) =       0.000422003447
  error estimate for blocks of size 2^( 3) =       0.000435564812
  error estimate for blocks of size 2^( 4) =       0.000447565974
  error estimate for blocks of size 2^( 5) =       0.000457616551
  error estimate for blocks of size 2^( 6) =       0.000465882249
  error estimate for blocks of size 2^( 7) =       0.000470751025

      target function =                  N/A
              le_mean =     -16.906280626280
             les_mean =     286.158050141404
             stat err =       0.000460453949
             autocorr =       1.263042077553
              std dev =       0.579418410756
             le_variance =       0.335725694724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628062628e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906280626280       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906280678135       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906280706283       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906280672431       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906280645739       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906280624106       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906280651443       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906280649583       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.022903e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906280626280       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906280639568       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906280646897       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906280638860       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906280632274       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906280626592       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906280632873       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906280632410       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.064651e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906280626280       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906280629623       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906280631474       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906280629493       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906280627854       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906280626417       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906280627945       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906280627835       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.266637e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8261e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.110896e-01 1 1  ON 0
 uu_1                 1.436136e-01 1 1  ON 1
 uu_2                 4.147762e-02 1 1  ON 2
 uu_3                -2.163120e-02 1 1  ON 3
 uu_4                -6.791666e-02 1 1  ON 4
 uu_5                -1.040839e-01 1 1  ON 5
 uu_6                -1.334318e-01 1 1  ON 6
 uu_7                -1.486253e-01 1 1  ON 7
 uu_8                -1.414853e-01 1 1  ON 8
 uu_9                -1.115808e-01 1 1  ON 9
 ud_0                 4.518088e-01 1 1  ON 10
 ud_1                 1.857233e-01 1 1  ON 11
 ud_2                 6.519819e-02 1 1  ON 12
 ud_3                -6.224115e-03 1 1  ON 13
 ud_4                -6.383755e-02 1 1  ON 14
 ud_5                -1.064660e-01 1 1  ON 15
 ud_6                -1.353459e-01 1 1  ON 16
 ud_7                -1.534169e-01 1 1  ON 17
 ud_8                -1.547872e-01 1 1  ON 18
 ud_9                -1.442908e-01 1 1  ON 19
 eO_0                -7.534618e-01 1 1  ON 20
 eO_1                -4.319054e-01 1 1  ON 21
 eO_2                -1.718051e-02 1 1  ON 22
 eO_3                 2.995135e-01 1 1  ON 23
 eO_4                 5.275192e-01 1 1  ON 24
 eO_5                 4.928246e-01 1 1  ON 25
 eO_6                 2.675047e-01 1 1  ON 26
 eO_7                -3.849791e-02 1 1  ON 27
 eO_8                -2.365560e-01 1 1  ON 28
 eO_9                -1.049566e-01 1 1  ON 29
eH1_0                -2.613481e-01 1 1  ON 30
eH1_1                -1.560084e-01 1 1  ON 31
eH1_2                -1.068989e-01 1 1  ON 32
eH1_3                -5.144311e-02 1 1  ON 33
eH1_4                -1.883308e-03 1 1  ON 34
eH1_5                 3.378645e-02 1 1  ON 35
eH1_6                 9.536439e-02 1 1  ON 36
eH1_7                 1.573471e-01 1 1  ON 37
eH1_8                 1.939295e-01 1 1  ON 38
eH1_9                 9.572794e-02 1 1  ON 39
eH2_0                -2.608747e-01 1 1  ON 40
eH2_1                -1.549090e-01 1 1  ON 41
eH2_2                -1.056259e-01 1 1  ON 42
eH2_3                -5.017169e-02 1 1  ON 43
eH2_4                -3.805989e-04 1 1  ON 44
eH2_5                 3.603832e-02 1 1  ON 45
eH2_6                 9.727945e-02 1 1  ON 46
eH2_7                 1.586943e-01 1 1  ON 47
eH2_8                 2.004638e-01 1 1  ON 48
eH2_9                 9.142639e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8673
    reference variance = 0.212189
====================================================
  Execution time = 2.0124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3383e-01
  Total weights = 2.0000e+06
  Execution time = 1.8581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333854592104
                                         uncertainty =       0.003043706567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333854592104
                                         uncertainty =       0.003043706567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408552152
  error estimate for blocks of size 2^( 2) =       0.000421307618
  error estimate for blocks of size 2^( 3) =       0.000433822479
  error estimate for blocks of size 2^( 4) =       0.000445256478
  error estimate for blocks of size 2^( 5) =       0.000453777288
  error estimate for blocks of size 2^( 6) =       0.000459077943
  error estimate for blocks of size 2^( 7) =       0.000463229679

      target function =                  N/A
              le_mean =     -16.906657115782
             les_mean =     286.168884385443
             stat err =       0.000455335347
             autocorr =       1.242131928453
              std dev =       0.577779994247
             le_variance =       0.333829721752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333855640604
                                         uncertainty =       0.003043781314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333855640604
                                         uncertainty =       0.003043781314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408552792
  error estimate for blocks of size 2^( 2) =       0.000421308159
  error estimate for blocks of size 2^( 3) =       0.000433823001
  error estimate for blocks of size 2^( 4) =       0.000445256920
  error estimate for blocks of size 2^( 5) =       0.000453777593
  error estimate for blocks of size 2^( 6) =       0.000459078172
  error estimate for blocks of size 2^( 7) =       0.000463229549

      target function =                  N/A
              le_mean =     -16.906657213576
             les_mean =     286.168888738654
             stat err =       0.000455335558
             autocorr =       1.242129189040
              std dev =       0.577780899836
             le_variance =       0.333830768216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333855166827
                                         uncertainty =       0.003043745671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333855166827
                                         uncertainty =       0.003043745671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408552503
  error estimate for blocks of size 2^( 2) =       0.000421307918
  error estimate for blocks of size 2^( 3) =       0.000433822771
  error estimate for blocks of size 2^( 4) =       0.000445256728
  error estimate for blocks of size 2^( 5) =       0.000453777468
  error estimate for blocks of size 2^( 6) =       0.000459078084
  error estimate for blocks of size 2^( 7) =       0.000463229639

      target function =                  N/A
              le_mean =     -16.906657166838
             les_mean =     286.168886685520
             stat err =       0.000455335480
             autocorr =       1.242130519665
              std dev =       0.577780490717
             le_variance =       0.333830295453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333854665381
                                         uncertainty =       0.003043711512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333854665381
                                         uncertainty =       0.003043711512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408552197
  error estimate for blocks of size 2^( 2) =       0.000421307657
  error estimate for blocks of size 2^( 3) =       0.000433822516
  error estimate for blocks of size 2^( 4) =       0.000445256510
  error estimate for blocks of size 2^( 5) =       0.000453777311
  error estimate for blocks of size 2^( 6) =       0.000459077961
  error estimate for blocks of size 2^( 7) =       0.000463229675

      target function =                  N/A
              le_mean =     -16.906657122207
             les_mean =     286.168884675873
             stat err =       0.000455335364
             autocorr =       1.242131751126
              std dev =       0.577780057549
             le_variance =       0.333829794901


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906657115782        initial
     9.5367e+00     9.5367e+01             2.0229e-05       -16.906657213576  <--
     3.8147e+01     3.8147e+02             5.0647e-06       -16.906657166838
     1.5259e+02     1.5259e+03             1.2666e-06       -16.906657122207

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 2.9480e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.110911e-01 1 1  ON 0
 uu_1                 1.436181e-01 1 1  ON 1
 uu_2                 4.147498e-02 1 1  ON 2
 uu_3                -2.163100e-02 1 1  ON 3
 uu_4                -6.791009e-02 1 1  ON 4
 uu_5                -1.040889e-01 1 1  ON 5
 uu_6                -1.334258e-01 1 1  ON 6
 uu_7                -1.486264e-01 1 1  ON 7
 uu_8                -1.414947e-01 1 1  ON 8
 uu_9                -1.115872e-01 1 1  ON 9
 ud_0                 4.518150e-01 1 1  ON 10
 ud_1                 1.857242e-01 1 1  ON 11
 ud_2                 6.520684e-02 1 1  ON 12
 ud_3                -6.226520e-03 1 1  ON 13
 ud_4                -6.383738e-02 1 1  ON 14
 ud_5                -1.064625e-01 1 1  ON 15
 ud_6                -1.353469e-01 1 1  ON 16
 ud_7                -1.534100e-01 1 1  ON 17
 ud_8                -1.547869e-01 1 1  ON 18
 ud_9                -1.442990e-01 1 1  ON 19
 eO_0                -7.534549e-01 1 1  ON 20
 eO_1                -4.319112e-01 1 1  ON 21
 eO_2                -1.717014e-02 1 1  ON 22
 eO_3                 2.995107e-01 1 1  ON 23
 eO_4                 5.275291e-01 1 1  ON 24
 eO_5                 4.928313e-01 1 1  ON 25
 eO_6                 2.675049e-01 1 1  ON 26
 eO_7                -3.849889e-02 1 1  ON 27
 eO_8                -2.365661e-01 1 1  ON 28
 eO_9                -1.049681e-01 1 1  ON 29
eH1_0                -2.613559e-01 1 1  ON 30
eH1_1                -1.560229e-01 1 1  ON 31
eH1_2                -1.069009e-01 1 1  ON 32
eH1_3                -5.144390e-02 1 1  ON 33
eH1_4                -1.879372e-03 1 1  ON 34
eH1_5                 3.378260e-02 1 1  ON 35
eH1_6                 9.536886e-02 1 1  ON 36
eH1_7                 1.573517e-01 1 1  ON 37
eH1_8                 1.939350e-01 1 1  ON 38
eH1_9                 9.573846e-02 1 1  ON 39
eH2_0                -2.608812e-01 1 1  ON 40
eH2_1                -1.549042e-01 1 1  ON 41
eH2_2                -1.056291e-01 1 1  ON 42
eH2_3                -5.017346e-02 1 1  ON 43
eH2_4                -3.834208e-04 1 1  ON 44
eH2_5                 3.603118e-02 1 1  ON 45
eH2_6                 9.727993e-02 1 1  ON 46
eH2_7                 1.586914e-01 1 1  ON 47
eH2_8                 2.004662e-01 1 1  ON 48
eH2_9                 9.144156e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7747e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8544
    reference variance = 0.403395
====================================================
  Execution time = 2.0649e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3542e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335486147542
                                         uncertainty =       0.004197376670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335486147542
                                         uncertainty =       0.004197376670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409523113
  error estimate for blocks of size 2^( 2) =       0.000422502136
  error estimate for blocks of size 2^( 3) =       0.000434754884
  error estimate for blocks of size 2^( 4) =       0.000446850219
  error estimate for blocks of size 2^( 5) =       0.000457766368
  error estimate for blocks of size 2^( 6) =       0.000467000595
  error estimate for blocks of size 2^( 7) =       0.000473515828

      target function =                  N/A
              le_mean =     -16.906452016977
             les_mean =     286.163537995495
             stat err =       0.000461283252
             autocorr =       1.268757251649
              std dev =       0.579153141099
             le_variance =       0.335418360845


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645201698e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906452016977       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906452191739       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906452390982       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906452379013       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906452440854       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906452448659       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906452489322       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906452468751       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 7.076964e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906452016977       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906452063091       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906452116298       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906452112785       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906452130900       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906452137084       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906452147369       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906452143373       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.821153e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906452016977       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906452028668       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906452042209       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906452041293       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906452045995       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906452047865       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906452050471       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906452049585       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.588083e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6171e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.110957e-01 1 1  ON 0
 uu_1                 1.436123e-01 1 1  ON 1
 uu_2                 4.147298e-02 1 1  ON 2
 uu_3                -2.162844e-02 1 1  ON 3
 uu_4                -6.790699e-02 1 1  ON 4
 uu_5                -1.040758e-01 1 1  ON 5
 uu_6                -1.334192e-01 1 1  ON 6
 uu_7                -1.486447e-01 1 1  ON 7
 uu_8                -1.415056e-01 1 1  ON 8
 uu_9                -1.115918e-01 1 1  ON 9
 ud_0                 4.518087e-01 1 1  ON 10
 ud_1                 1.857387e-01 1 1  ON 11
 ud_2                 6.521331e-02 1 1  ON 12
 ud_3                -6.221595e-03 1 1  ON 13
 ud_4                -6.384520e-02 1 1  ON 14
 ud_5                -1.064649e-01 1 1  ON 15
 ud_6                -1.353375e-01 1 1  ON 16
 ud_7                -1.534073e-01 1 1  ON 17
 ud_8                -1.547878e-01 1 1  ON 18
 ud_9                -1.443077e-01 1 1  ON 19
 eO_0                -7.534461e-01 1 1  ON 20
 eO_1                -4.319171e-01 1 1  ON 21
 eO_2                -1.715708e-02 1 1  ON 22
 eO_3                 2.995139e-01 1 1  ON 23
 eO_4                 5.275365e-01 1 1  ON 24
 eO_5                 4.928317e-01 1 1  ON 25
 eO_6                 2.675067e-01 1 1  ON 26
 eO_7                -3.850183e-02 1 1  ON 27
 eO_8                -2.365756e-01 1 1  ON 28
 eO_9                -1.049823e-01 1 1  ON 29
eH1_0                -2.613641e-01 1 1  ON 30
eH1_1                -1.560265e-01 1 1  ON 31
eH1_2                -1.069068e-01 1 1  ON 32
eH1_3                -5.145230e-02 1 1  ON 33
eH1_4                -1.883059e-03 1 1  ON 34
eH1_5                 3.378353e-02 1 1  ON 35
eH1_6                 9.536305e-02 1 1  ON 36
eH1_7                 1.573539e-01 1 1  ON 37
eH1_8                 1.939521e-01 1 1  ON 38
eH1_9                 9.575355e-02 1 1  ON 39
eH2_0                -2.608806e-01 1 1  ON 40
eH2_1                -1.549087e-01 1 1  ON 41
eH2_2                -1.056274e-01 1 1  ON 42
eH2_3                -5.017413e-02 1 1  ON 43
eH2_4                -3.949584e-04 1 1  ON 44
eH2_5                 3.602124e-02 1 1  ON 45
eH2_6                 9.728944e-02 1 1  ON 46
eH2_7                 1.586900e-01 1 1  ON 47
eH2_8                 2.004660e-01 1 1  ON 48
eH2_9                 9.145529e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8294
    reference variance = 0.177888
====================================================
  Execution time = 2.0296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4406e-01
  Total weights = 2.0000e+06
  Execution time = 1.8535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344073166055
                                         uncertainty =       0.005887210511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344073166055
                                         uncertainty =       0.005887210511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414774847
  error estimate for blocks of size 2^( 2) =       0.000427206811
  error estimate for blocks of size 2^( 3) =       0.000439903232
  error estimate for blocks of size 2^( 4) =       0.000452051512
  error estimate for blocks of size 2^( 5) =       0.000461015995
  error estimate for blocks of size 2^( 6) =       0.000466361205
  error estimate for blocks of size 2^( 7) =       0.000471263752

      target function =                  N/A
              le_mean =     -16.905927479688
             les_mean =     286.154460123834
             stat err =       0.000462673116
             autocorr =       1.244296005655
              std dev =       0.586580213953
             le_variance =       0.344076347401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344028055090
                                         uncertainty =       0.005887648007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344028055090
                                         uncertainty =       0.005887648007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414747656
  error estimate for blocks of size 2^( 2) =       0.000427180887
  error estimate for blocks of size 2^( 3) =       0.000439878800
  error estimate for blocks of size 2^( 4) =       0.000452028017
  error estimate for blocks of size 2^( 5) =       0.000460994405
  error estimate for blocks of size 2^( 6) =       0.000466340524
  error estimate for blocks of size 2^( 7) =       0.000471244800

      target function =                  N/A
              le_mean =     -16.905928002850
             les_mean =     286.154432701295
             stat err =       0.000462651936
             autocorr =       1.244345233549
              std dev =       0.586541759618
             le_variance =       0.344031235776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344046155743
                                         uncertainty =       0.005887352000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344046155743
                                         uncertainty =       0.005887352000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414758567
  error estimate for blocks of size 2^( 2) =       0.000427191297
  error estimate for blocks of size 2^( 3) =       0.000439888615
  error estimate for blocks of size 2^( 4) =       0.000452037459
  error estimate for blocks of size 2^( 5) =       0.000461003035
  error estimate for blocks of size 2^( 6) =       0.000466348760
  error estimate for blocks of size 2^( 7) =       0.000471252283

      target function =                  N/A
              le_mean =     -16.905927761453
             les_mean =     286.154442640775
             stat err =       0.000462660384
             autocorr =       1.244325205626
              std dev =       0.586557190175
             le_variance =       0.344049337346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344069628974
                                         uncertainty =       0.005887225564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344069628974
                                         uncertainty =       0.005887225564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414772715
  error estimate for blocks of size 2^( 2) =       0.000427204779
  error estimate for blocks of size 2^( 3) =       0.000439901318
  error estimate for blocks of size 2^( 4) =       0.000452049672
  error estimate for blocks of size 2^( 5) =       0.000461014296
  error estimate for blocks of size 2^( 6) =       0.000466359573
  error estimate for blocks of size 2^( 7) =       0.000471262245

      target function =                  N/A
              le_mean =     -16.905927515309
             les_mean =     286.154457791211
             stat err =       0.000462671446
             autocorr =       1.244299815939
              std dev =       0.586577198985
             le_variance =       0.344072810369


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905927479688        initial
     2.3842e+00     2.3842e+01             7.0770e-05       -16.905928002850  <--
     9.5367e+00     9.5367e+01             1.8212e-05       -16.905927761453
     3.8147e+01     3.8147e+02             4.5881e-06       -16.905927515309

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 2.9639e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.111061e-01 1 1  ON 0
 uu_1                 1.435979e-01 1 1  ON 1
 uu_2                 4.146883e-02 1 1  ON 2
 uu_3                -2.162105e-02 1 1  ON 3
 uu_4                -6.789624e-02 1 1  ON 4
 uu_5                -1.040406e-01 1 1  ON 5
 uu_6                -1.333996e-01 1 1  ON 6
 uu_7                -1.486972e-01 1 1  ON 7
 uu_8                -1.415385e-01 1 1  ON 8
 uu_9                -1.116060e-01 1 1  ON 9
 ud_0                 4.517975e-01 1 1  ON 10
 ud_1                 1.857762e-01 1 1  ON 11
 ud_2                 6.523142e-02 1 1  ON 12
 ud_3                -6.209156e-03 1 1  ON 13
 ud_4                -6.386563e-02 1 1  ON 14
 ud_5                -1.064724e-01 1 1  ON 15
 ud_6                -1.353112e-01 1 1  ON 16
 ud_7                -1.533985e-01 1 1  ON 17
 ud_8                -1.547901e-01 1 1  ON 18
 ud_9                -1.443340e-01 1 1  ON 19
 eO_0                -7.534215e-01 1 1  ON 20
 eO_1                -4.319303e-01 1 1  ON 21
 eO_2                -1.712009e-02 1 1  ON 22
 eO_3                 2.995244e-01 1 1  ON 23
 eO_4                 5.275573e-01 1 1  ON 24
 eO_5                 4.928330e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -3.851053e-02 1 1  ON 27
 eO_8                -2.366043e-01 1 1  ON 28
 eO_9                -1.050250e-01 1 1  ON 29
eH1_0                -2.613883e-01 1 1  ON 30
eH1_1                -1.560371e-01 1 1  ON 31
eH1_2                -1.069253e-01 1 1  ON 32
eH1_3                -5.147664e-02 1 1  ON 33
eH1_4                -1.894753e-03 1 1  ON 34
eH1_5                 3.378642e-02 1 1  ON 35
eH1_6                 9.534583e-02 1 1  ON 36
eH1_7                 1.573606e-01 1 1  ON 37
eH1_8                 1.940034e-01 1 1  ON 38
eH1_9                 9.579887e-02 1 1  ON 39
eH2_0                -2.608792e-01 1 1  ON 40
eH2_1                -1.549207e-01 1 1  ON 41
eH2_2                -1.056233e-01 1 1  ON 42
eH2_3                -5.017606e-02 1 1  ON 43
eH2_4                -4.286984e-04 1 1  ON 44
eH2_5                 3.599107e-02 1 1  ON 45
eH2_6                 9.731740e-02 1 1  ON 46
eH2_7                 1.586858e-01 1 1  ON 47
eH2_8                 2.004657e-01 1 1  ON 48
eH2_9                 9.149654e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5817e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8871
    reference variance = 0.323434
====================================================
  Execution time = 2.0620e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4553e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345396802553
                                         uncertainty =       0.008479631345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345396802553
                                         uncertainty =       0.008479631345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415647783
  error estimate for blocks of size 2^( 2) =       0.000427951946
  error estimate for blocks of size 2^( 3) =       0.000441243664
  error estimate for blocks of size 2^( 4) =       0.000454121677
  error estimate for blocks of size 2^( 5) =       0.000465874889
  error estimate for blocks of size 2^( 6) =       0.000473327919
  error estimate for blocks of size 2^( 7) =       0.000477405585

      target function =                  N/A
              le_mean =     -16.906427211905
             les_mean =     286.172807057272
             stat err =       0.000467682517
             autocorr =       1.266051392183
              std dev =       0.587814731522
             le_variance =       0.345526158594


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690642721190e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906427211905       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906427200870       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906427796720       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906427950858       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906428283952       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906428013137       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906427849135       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906428054349       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906428152262       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.649968e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906427211905       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906427208635       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906427355285       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906427366368       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906427494282       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906427457265       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906427402714       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906427427036       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 8.990731e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906427211905       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906427211048       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906427246739       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906427247705       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906427282124       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906427275297       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906427263330       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906427266632       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.263868e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247186 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6158e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.110647e-01 1 1  ON 0
 uu_1                 1.435830e-01 1 1  ON 1
 uu_2                 4.142389e-02 1 1  ON 2
 uu_3                -2.165027e-02 1 1  ON 3
 uu_4                -6.789190e-02 1 1  ON 4
 uu_5                -1.040456e-01 1 1  ON 5
 uu_6                -1.333280e-01 1 1  ON 6
 uu_7                -1.486618e-01 1 1  ON 7
 uu_8                -1.415533e-01 1 1  ON 8
 uu_9                -1.116381e-01 1 1  ON 9
 ud_0                 4.518081e-01 1 1  ON 10
 ud_1                 1.858283e-01 1 1  ON 11
 ud_2                 6.525187e-02 1 1  ON 12
 ud_3                -6.191325e-03 1 1  ON 13
 ud_4                -6.387358e-02 1 1  ON 14
 ud_5                -1.064993e-01 1 1  ON 15
 ud_6                -1.353172e-01 1 1  ON 16
 ud_7                -1.533802e-01 1 1  ON 17
 ud_8                -1.548142e-01 1 1  ON 18
 ud_9                -1.443546e-01 1 1  ON 19
 eO_0                -7.534084e-01 1 1  ON 20
 eO_1                -4.319513e-01 1 1  ON 21
 eO_2                -1.706833e-02 1 1  ON 22
 eO_3                 2.995530e-01 1 1  ON 23
 eO_4                 5.276021e-01 1 1  ON 24
 eO_5                 4.928261e-01 1 1  ON 25
 eO_6                 2.674949e-01 1 1  ON 26
 eO_7                -3.850766e-02 1 1  ON 27
 eO_8                -2.366430e-01 1 1  ON 28
 eO_9                -1.050740e-01 1 1  ON 29
eH1_0                -2.614293e-01 1 1  ON 30
eH1_1                -1.560723e-01 1 1  ON 31
eH1_2                -1.069445e-01 1 1  ON 32
eH1_3                -5.152465e-02 1 1  ON 33
eH1_4                -1.882156e-03 1 1  ON 34
eH1_5                 3.374734e-02 1 1  ON 35
eH1_6                 9.532668e-02 1 1  ON 36
eH1_7                 1.573650e-01 1 1  ON 37
eH1_8                 1.940718e-01 1 1  ON 38
eH1_9                 9.588877e-02 1 1  ON 39
eH2_0                -2.608808e-01 1 1  ON 40
eH2_1                -1.549434e-01 1 1  ON 41
eH2_2                -1.056525e-01 1 1  ON 42
eH2_3                -5.016144e-02 1 1  ON 43
eH2_4                -4.700981e-04 1 1  ON 44
eH2_5                 3.595721e-02 1 1  ON 45
eH2_6                 9.730491e-02 1 1  ON 46
eH2_7                 1.587162e-01 1 1  ON 47
eH2_8                 2.004933e-01 1 1  ON 48
eH2_9                 9.156369e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9181
    reference variance = 0.260276
====================================================
  Execution time = 2.0500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4036e-01
  Total weights = 2.0000e+06
  Execution time = 1.8525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340436509088
                                         uncertainty =       0.006275644055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340436509088
                                         uncertainty =       0.006275644055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412539043
  error estimate for blocks of size 2^( 2) =       0.000425261452
  error estimate for blocks of size 2^( 3) =       0.000437251766
  error estimate for blocks of size 2^( 4) =       0.000448945999
  error estimate for blocks of size 2^( 5) =       0.000458434444
  error estimate for blocks of size 2^( 6) =       0.000466847614
  error estimate for blocks of size 2^( 7) =       0.000472546525

      target function =                  N/A
              le_mean =     -16.906926734040
             les_mean =     286.184548343260
             stat err =       0.000461693646
             autocorr =       1.252499848164
              std dev =       0.583418308980
             le_variance =       0.340376923253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416205984
                                         uncertainty =       0.006274248909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340416205984
                                         uncertainty =       0.006274248909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412526725
  error estimate for blocks of size 2^( 2) =       0.000425249600
  error estimate for blocks of size 2^( 3) =       0.000437238591
  error estimate for blocks of size 2^( 4) =       0.000448932454
  error estimate for blocks of size 2^( 5) =       0.000458418367
  error estimate for blocks of size 2^( 6) =       0.000466830936
  error estimate for blocks of size 2^( 7) =       0.000472528488

      target function =                  N/A
              le_mean =     -16.906925868030
             les_mean =     286.184498734808
             stat err =       0.000461677561
             autocorr =       1.252487374075
              std dev =       0.583400889542
             le_variance =       0.340356597918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340408321669
                                         uncertainty =       0.006274724151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340408321669
                                         uncertainty =       0.006274724151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412521953
  error estimate for blocks of size 2^( 2) =       0.000425245144
  error estimate for blocks of size 2^( 3) =       0.000437235018
  error estimate for blocks of size 2^( 4) =       0.000448929375
  error estimate for blocks of size 2^( 5) =       0.000458416427
  error estimate for blocks of size 2^( 6) =       0.000466829404
  error estimate for blocks of size 2^( 7) =       0.000472528031

      target function =                  N/A
              le_mean =     -16.906926127779
             les_mean =     286.184499642859
             stat err =       0.000461675809
             autocorr =       1.252506846125
              std dev =       0.583394140223
             le_variance =       0.340348722846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340431964825
                                         uncertainty =       0.006275515275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340431964825
                                         uncertainty =       0.006275515275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412536288
  error estimate for blocks of size 2^( 2) =       0.000425258819
  error estimate for blocks of size 2^( 3) =       0.000437249085
  error estimate for blocks of size 2^( 4) =       0.000448943339
  error estimate for blocks of size 2^( 5) =       0.000458431602
  error estimate for blocks of size 2^( 6) =       0.000466844747
  error estimate for blocks of size 2^( 7) =       0.000472543642

      target function =                  N/A
              le_mean =     -16.906926648160
             les_mean =     286.184540893344
             stat err =       0.000461690833
             autocorr =       1.252501313596
              std dev =       0.583414412981
             le_variance =       0.340372377274


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906926734040        initial  <--
     5.9605e-01     5.9605e+00             3.6500e-04       -16.906925868030
     2.3842e+00     2.3842e+01             8.9907e-05       -16.906926127779
     9.5367e+00     9.5367e+01             2.2639e-05       -16.906926648160

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9079
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.111061e-01 1 1  ON 0
 uu_1                 1.435979e-01 1 1  ON 1
 uu_2                 4.146883e-02 1 1  ON 2
 uu_3                -2.162105e-02 1 1  ON 3
 uu_4                -6.789624e-02 1 1  ON 4
 uu_5                -1.040406e-01 1 1  ON 5
 uu_6                -1.333996e-01 1 1  ON 6
 uu_7                -1.486972e-01 1 1  ON 7
 uu_8                -1.415385e-01 1 1  ON 8
 uu_9                -1.116060e-01 1 1  ON 9
 ud_0                 4.517975e-01 1 1  ON 10
 ud_1                 1.857762e-01 1 1  ON 11
 ud_2                 6.523142e-02 1 1  ON 12
 ud_3                -6.209156e-03 1 1  ON 13
 ud_4                -6.386563e-02 1 1  ON 14
 ud_5                -1.064724e-01 1 1  ON 15
 ud_6                -1.353112e-01 1 1  ON 16
 ud_7                -1.533985e-01 1 1  ON 17
 ud_8                -1.547901e-01 1 1  ON 18
 ud_9                -1.443340e-01 1 1  ON 19
 eO_0                -7.534215e-01 1 1  ON 20
 eO_1                -4.319303e-01 1 1  ON 21
 eO_2                -1.712009e-02 1 1  ON 22
 eO_3                 2.995244e-01 1 1  ON 23
 eO_4                 5.275573e-01 1 1  ON 24
 eO_5                 4.928330e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -3.851053e-02 1 1  ON 27
 eO_8                -2.366043e-01 1 1  ON 28
 eO_9                -1.050250e-01 1 1  ON 29
eH1_0                -2.613883e-01 1 1  ON 30
eH1_1                -1.560371e-01 1 1  ON 31
eH1_2                -1.069253e-01 1 1  ON 32
eH1_3                -5.147664e-02 1 1  ON 33
eH1_4                -1.894753e-03 1 1  ON 34
eH1_5                 3.378642e-02 1 1  ON 35
eH1_6                 9.534583e-02 1 1  ON 36
eH1_7                 1.573606e-01 1 1  ON 37
eH1_8                 1.940034e-01 1 1  ON 38
eH1_9                 9.579887e-02 1 1  ON 39
eH2_0                -2.608792e-01 1 1  ON 40
eH2_1                -1.549207e-01 1 1  ON 41
eH2_2                -1.056233e-01 1 1  ON 42
eH2_3                -5.017606e-02 1 1  ON 43
eH2_4                -4.286984e-04 1 1  ON 44
eH2_5                 3.599107e-02 1 1  ON 45
eH2_6                 9.731740e-02 1 1  ON 46
eH2_7                 1.586858e-01 1 1  ON 47
eH2_8                 2.004657e-01 1 1  ON 48
eH2_9                 9.149654e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6075e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.917
    reference variance = 0.618609
====================================================
  Execution time = 2.0754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4061e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340574410485
                                         uncertainty =       0.005654642701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340574410485
                                         uncertainty =       0.005654642701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412682536
  error estimate for blocks of size 2^( 2) =       0.000425267629
  error estimate for blocks of size 2^( 3) =       0.000437583520
  error estimate for blocks of size 2^( 4) =       0.000449455565
  error estimate for blocks of size 2^( 5) =       0.000459968539
  error estimate for blocks of size 2^( 6) =       0.000468065062
  error estimate for blocks of size 2^( 7) =       0.000471961495

      target function =                  N/A
              le_mean =     -16.906512761439
             les_mean =     286.170787333125
             stat err =       0.000462362665
             autocorr =       1.255258976707
              std dev =       0.583621239116
             le_variance =       0.340613750747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690651276144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906512761439       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906512713615       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906512715083       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906512714497       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906512793566       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906512777749       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906512799107       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906512798851       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.063540e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906512761439       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906512749234       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906512749259       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906512748752       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906512769006       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906512765121       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906512770452       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906512770446       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.018609e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906512761439       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906512758371       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906512758355       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906512758204       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906512763298       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906512762332       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906512763663       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906512763666       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.548235e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249827 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6341e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.111029e-01 1 1  ON 0
 uu_1                 1.435988e-01 1 1  ON 1
 uu_2                 4.146729e-02 1 1  ON 2
 uu_3                -2.162039e-02 1 1  ON 3
 uu_4                -6.789811e-02 1 1  ON 4
 uu_5                -1.040408e-01 1 1  ON 5
 uu_6                -1.333958e-01 1 1  ON 6
 uu_7                -1.486993e-01 1 1  ON 7
 uu_8                -1.415420e-01 1 1  ON 8
 uu_9                -1.116075e-01 1 1  ON 9
 ud_0                 4.517955e-01 1 1  ON 10
 ud_1                 1.857745e-01 1 1  ON 11
 ud_2                 6.523049e-02 1 1  ON 12
 ud_3                -6.208170e-03 1 1  ON 13
 ud_4                -6.386486e-02 1 1  ON 14
 ud_5                -1.064746e-01 1 1  ON 15
 ud_6                -1.353084e-01 1 1  ON 16
 ud_7                -1.533958e-01 1 1  ON 17
 ud_8                -1.547867e-01 1 1  ON 18
 ud_9                -1.443342e-01 1 1  ON 19
 eO_0                -7.534245e-01 1 1  ON 20
 eO_1                -4.319247e-01 1 1  ON 21
 eO_2                -1.711879e-02 1 1  ON 22
 eO_3                 2.995257e-01 1 1  ON 23
 eO_4                 5.275592e-01 1 1  ON 24
 eO_5                 4.928347e-01 1 1  ON 25
 eO_6                 2.675118e-01 1 1  ON 26
 eO_7                -3.851010e-02 1 1  ON 27
 eO_8                -2.366065e-01 1 1  ON 28
 eO_9                -1.050304e-01 1 1  ON 29
eH1_0                -2.613934e-01 1 1  ON 30
eH1_1                -1.560391e-01 1 1  ON 31
eH1_2                -1.069285e-01 1 1  ON 32
eH1_3                -5.147887e-02 1 1  ON 33
eH1_4                -1.897868e-03 1 1  ON 34
eH1_5                 3.378580e-02 1 1  ON 35
eH1_6                 9.534479e-02 1 1  ON 36
eH1_7                 1.573597e-01 1 1  ON 37
eH1_8                 1.940093e-01 1 1  ON 38
eH1_9                 9.580905e-02 1 1  ON 39
eH2_0                -2.608814e-01 1 1  ON 40
eH2_1                -1.549185e-01 1 1  ON 41
eH2_2                -1.056240e-01 1 1  ON 42
eH2_3                -5.017911e-02 1 1  ON 43
eH2_4                -4.273901e-04 1 1  ON 44
eH2_5                 3.598533e-02 1 1  ON 45
eH2_6                 9.731597e-02 1 1  ON 46
eH2_7                 1.586861e-01 1 1  ON 47
eH2_8                 2.004664e-01 1 1  ON 48
eH2_9                 9.150323e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.293766
====================================================
  Execution time = 2.0126e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3421e-01
  Total weights = 2.0000e+06
  Execution time = 1.8545e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334162630474
                                         uncertainty =       0.002930174876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334162630474
                                         uncertainty =       0.002930174876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408784342
  error estimate for blocks of size 2^( 2) =       0.000421514401
  error estimate for blocks of size 2^( 3) =       0.000434601042
  error estimate for blocks of size 2^( 4) =       0.000446777077
  error estimate for blocks of size 2^( 5) =       0.000457663783
  error estimate for blocks of size 2^( 6) =       0.000465481292
  error estimate for blocks of size 2^( 7) =       0.000469091334

      target function =                  N/A
              le_mean =     -16.906542138411
             les_mean =     286.165376187213
             stat err =       0.000459753372
             autocorr =       1.264914994924
              std dev =       0.578108360478
             le_variance =       0.334209276455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334160311033
                                         uncertainty =       0.002930219579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334160311033
                                         uncertainty =       0.002930219579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408782921
  error estimate for blocks of size 2^( 2) =       0.000421513066
  error estimate for blocks of size 2^( 3) =       0.000434599817
  error estimate for blocks of size 2^( 4) =       0.000446776282
  error estimate for blocks of size 2^( 5) =       0.000457663018
  error estimate for blocks of size 2^( 6) =       0.000465480469
  error estimate for blocks of size 2^( 7) =       0.000469090362

      target function =                  N/A
              le_mean =     -16.906542055997
             les_mean =     286.165371076463
             stat err =       0.000459752533
             autocorr =       1.264919176697
              std dev =       0.578106350407
             le_variance =       0.334206952381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334161460393
                                         uncertainty =       0.002930198085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334161460393
                                         uncertainty =       0.002930198085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408783625
  error estimate for blocks of size 2^( 2) =       0.000421513727
  error estimate for blocks of size 2^( 3) =       0.000434600423
  error estimate for blocks of size 2^( 4) =       0.000446776680
  error estimate for blocks of size 2^( 5) =       0.000457663401
  error estimate for blocks of size 2^( 6) =       0.000465480879
  error estimate for blocks of size 2^( 7) =       0.000469090849

      target function =                  N/A
              le_mean =     -16.906542096143
             les_mean =     286.165373585496
             stat err =       0.000459752952
             autocorr =       1.264917125058
              std dev =       0.578107346382
             le_variance =       0.334208103941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334162483651
                                         uncertainty =       0.002930177807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334162483651
                                         uncertainty =       0.002930177807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408784252
  error estimate for blocks of size 2^( 2) =       0.000421514316
  error estimate for blocks of size 2^( 3) =       0.000434600964
  error estimate for blocks of size 2^( 4) =       0.000446777028
  error estimate for blocks of size 2^( 5) =       0.000457663735
  error estimate for blocks of size 2^( 6) =       0.000465481240
  error estimate for blocks of size 2^( 7) =       0.000469091273

      target function =                  N/A
              le_mean =     -16.906542133057
             les_mean =     286.165375859061
             stat err =       0.000459753319
             autocorr =       1.264915262462
              std dev =       0.578108233226
             le_variance =       0.334209129324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906542138411        initial  <--
     5.9605e+00     5.9605e+01             4.0635e-05       -16.906542055997
     2.3842e+01     2.3842e+02             1.0186e-05       -16.906542096143
     9.5367e+01     9.5367e+02             2.5482e-06       -16.906542133057

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5128
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.111061e-01 1 1  ON 0
 uu_1                 1.435979e-01 1 1  ON 1
 uu_2                 4.146883e-02 1 1  ON 2
 uu_3                -2.162105e-02 1 1  ON 3
 uu_4                -6.789624e-02 1 1  ON 4
 uu_5                -1.040406e-01 1 1  ON 5
 uu_6                -1.333996e-01 1 1  ON 6
 uu_7                -1.486972e-01 1 1  ON 7
 uu_8                -1.415385e-01 1 1  ON 8
 uu_9                -1.116060e-01 1 1  ON 9
 ud_0                 4.517975e-01 1 1  ON 10
 ud_1                 1.857762e-01 1 1  ON 11
 ud_2                 6.523142e-02 1 1  ON 12
 ud_3                -6.209156e-03 1 1  ON 13
 ud_4                -6.386563e-02 1 1  ON 14
 ud_5                -1.064724e-01 1 1  ON 15
 ud_6                -1.353112e-01 1 1  ON 16
 ud_7                -1.533985e-01 1 1  ON 17
 ud_8                -1.547901e-01 1 1  ON 18
 ud_9                -1.443340e-01 1 1  ON 19
 eO_0                -7.534215e-01 1 1  ON 20
 eO_1                -4.319303e-01 1 1  ON 21
 eO_2                -1.712009e-02 1 1  ON 22
 eO_3                 2.995244e-01 1 1  ON 23
 eO_4                 5.275573e-01 1 1  ON 24
 eO_5                 4.928330e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -3.851053e-02 1 1  ON 27
 eO_8                -2.366043e-01 1 1  ON 28
 eO_9                -1.050250e-01 1 1  ON 29
eH1_0                -2.613883e-01 1 1  ON 30
eH1_1                -1.560371e-01 1 1  ON 31
eH1_2                -1.069253e-01 1 1  ON 32
eH1_3                -5.147664e-02 1 1  ON 33
eH1_4                -1.894753e-03 1 1  ON 34
eH1_5                 3.378642e-02 1 1  ON 35
eH1_6                 9.534583e-02 1 1  ON 36
eH1_7                 1.573606e-01 1 1  ON 37
eH1_8                 1.940034e-01 1 1  ON 38
eH1_9                 9.579887e-02 1 1  ON 39
eH2_0                -2.608792e-01 1 1  ON 40
eH2_1                -1.549207e-01 1 1  ON 41
eH2_2                -1.056233e-01 1 1  ON 42
eH2_3                -5.017606e-02 1 1  ON 43
eH2_4                -4.286984e-04 1 1  ON 44
eH2_5                 3.599107e-02 1 1  ON 45
eH2_6                 9.731740e-02 1 1  ON 46
eH2_7                 1.586858e-01 1 1  ON 47
eH2_8                 2.004657e-01 1 1  ON 48
eH2_9                 9.149654e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5860e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8818
    reference variance = 0.24219
====================================================
  Execution time = 2.0614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3353e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333531120233
                                         uncertainty =       0.003008152678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333531120233
                                         uncertainty =       0.003008152678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408370439
  error estimate for blocks of size 2^( 2) =       0.000420928740
  error estimate for blocks of size 2^( 3) =       0.000434078818
  error estimate for blocks of size 2^( 4) =       0.000446813140
  error estimate for blocks of size 2^( 5) =       0.000458116511
  error estimate for blocks of size 2^( 6) =       0.000465320320
  error estimate for blocks of size 2^( 7) =       0.000470194780

      target function =                  N/A
              le_mean =     -16.905749242391
             les_mean =     286.137890111055
             stat err =       0.000460111188
             autocorr =       1.269454069396
              std dev =       0.577523013574
             le_variance =       0.333532831208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574924239e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749242391       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749249534       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749256563       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749263976       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749263156       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749258658       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749258715       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749258209       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.293214e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749242391       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749244180       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749245957       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749247848       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749247486       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749246486       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749246502       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749246375       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 8.234713e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905749242391       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749242839       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749243284       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749243757       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749243658       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749243416       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749243421       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749243389       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.058783e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252487 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6287e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.111062e-01 1 1  ON 0
 uu_1                 1.435978e-01 1 1  ON 1
 uu_2                 4.146855e-02 1 1  ON 2
 uu_3                -2.162086e-02 1 1  ON 3
 uu_4                -6.789666e-02 1 1  ON 4
 uu_5                -1.040406e-01 1 1  ON 5
 uu_6                -1.333996e-01 1 1  ON 6
 uu_7                -1.486970e-01 1 1  ON 7
 uu_8                -1.415388e-01 1 1  ON 8
 uu_9                -1.116060e-01 1 1  ON 9
 ud_0                 4.517976e-01 1 1  ON 10
 ud_1                 1.857766e-01 1 1  ON 11
 ud_2                 6.523137e-02 1 1  ON 12
 ud_3                -6.208949e-03 1 1  ON 13
 ud_4                -6.386577e-02 1 1  ON 14
 ud_5                -1.064723e-01 1 1  ON 15
 ud_6                -1.353110e-01 1 1  ON 16
 ud_7                -1.533986e-01 1 1  ON 17
 ud_8                -1.547902e-01 1 1  ON 18
 ud_9                -1.443340e-01 1 1  ON 19
 eO_0                -7.534212e-01 1 1  ON 20
 eO_1                -4.319306e-01 1 1  ON 21
 eO_2                -1.711987e-02 1 1  ON 22
 eO_3                 2.995243e-01 1 1  ON 23
 eO_4                 5.275579e-01 1 1  ON 24
 eO_5                 4.928338e-01 1 1  ON 25
 eO_6                 2.675123e-01 1 1  ON 26
 eO_7                -3.851071e-02 1 1  ON 27
 eO_8                -2.366048e-01 1 1  ON 28
 eO_9                -1.050255e-01 1 1  ON 29
eH1_0                -2.613886e-01 1 1  ON 30
eH1_1                -1.560376e-01 1 1  ON 31
eH1_2                -1.069254e-01 1 1  ON 32
eH1_3                -5.147696e-02 1 1  ON 33
eH1_4                -1.894899e-03 1 1  ON 34
eH1_5                 3.378653e-02 1 1  ON 35
eH1_6                 9.534583e-02 1 1  ON 36
eH1_7                 1.573605e-01 1 1  ON 37
eH1_8                 1.940038e-01 1 1  ON 38
eH1_9                 9.579959e-02 1 1  ON 39
eH2_0                -2.608792e-01 1 1  ON 40
eH2_1                -1.549211e-01 1 1  ON 41
eH2_2                -1.056238e-01 1 1  ON 42
eH2_3                -5.017639e-02 1 1  ON 43
eH2_4                -4.286650e-04 1 1  ON 44
eH2_5                 3.599060e-02 1 1  ON 45
eH2_6                 9.731747e-02 1 1  ON 46
eH2_7                 1.586860e-01 1 1  ON 47
eH2_8                 2.004661e-01 1 1  ON 48
eH2_9                 9.149736e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.964
    reference variance = 0.252884
====================================================
  Execution time = 2.0212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4010e-01
  Total weights = 2.0000e+06
  Execution time = 1.8599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340203273520
                                         uncertainty =       0.004681713337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340203273520
                                         uncertainty =       0.004681713337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412371915
  error estimate for blocks of size 2^( 2) =       0.000425171843
  error estimate for blocks of size 2^( 3) =       0.000437854823
  error estimate for blocks of size 2^( 4) =       0.000451042040
  error estimate for blocks of size 2^( 5) =       0.000461696154
  error estimate for blocks of size 2^( 6) =       0.000469537188
  error estimate for blocks of size 2^( 7) =       0.000472919976

      target function =                  N/A
              le_mean =     -16.906655400479
             les_mean =     286.175097853030
             stat err =       0.000463798840
             autocorr =       1.264972709794
              std dev =       0.583181954911
             le_variance =       0.340101192534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340203510366
                                         uncertainty =       0.004681719061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340203510366
                                         uncertainty =       0.004681719061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412372058
  error estimate for blocks of size 2^( 2) =       0.000425171975
  error estimate for blocks of size 2^( 3) =       0.000437854940
  error estimate for blocks of size 2^( 4) =       0.000451042165
  error estimate for blocks of size 2^( 5) =       0.000461696283
  error estimate for blocks of size 2^( 6) =       0.000469537312
  error estimate for blocks of size 2^( 7) =       0.000472920131

      target function =                  N/A
              le_mean =     -16.906655404643
             les_mean =     286.175098230487
             stat err =       0.000463798973
             autocorr =       1.264972555037
              std dev =       0.583182157814
             le_variance =       0.340101429193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340203392197
                                         uncertainty =       0.004681716194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340203392197
                                         uncertainty =       0.004681716194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412371987
  error estimate for blocks of size 2^( 2) =       0.000425171909
  error estimate for blocks of size 2^( 3) =       0.000437854881
  error estimate for blocks of size 2^( 4) =       0.000451042103
  error estimate for blocks of size 2^( 5) =       0.000461696219
  error estimate for blocks of size 2^( 6) =       0.000469537250
  error estimate for blocks of size 2^( 7) =       0.000472920054

      target function =                  N/A
              le_mean =     -16.906655402537
             les_mean =     286.175098041206
             stat err =       0.000463798906
             autocorr =       1.264972632794
              std dev =       0.583182056580
             le_variance =       0.340101311117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340203288357
                                         uncertainty =       0.004681713694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340203288357
                                         uncertainty =       0.004681713694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412371924
  error estimate for blocks of size 2^( 2) =       0.000425171851
  error estimate for blocks of size 2^( 3) =       0.000437854830
  error estimate for blocks of size 2^( 4) =       0.000451042048
  error estimate for blocks of size 2^( 5) =       0.000461696162
  error estimate for blocks of size 2^( 6) =       0.000469537196
  error estimate for blocks of size 2^( 7) =       0.000472919986

      target function =                  N/A
              le_mean =     -16.906655400735
             les_mean =     286.175097876512
             stat err =       0.000463798848
             autocorr =       1.264972700185
              std dev =       0.583181967622
             le_variance =       0.340101207360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906655400479        initial
     5.9605e+01     5.9605e+02             3.2932e-06       -16.906655404643  <--
     2.3842e+02     2.3842e+03             8.2347e-07       -16.906655402537
     9.5367e+02     9.5367e+03             2.0588e-07       -16.906655400735

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 2.9587e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.111063e-01 1 1  ON 0
 uu_1                 1.435975e-01 1 1  ON 1
 uu_2                 4.146772e-02 1 1  ON 2
 uu_3                -2.162027e-02 1 1  ON 3
 uu_4                -6.789794e-02 1 1  ON 4
 uu_5                -1.040407e-01 1 1  ON 5
 uu_6                -1.333995e-01 1 1  ON 6
 uu_7                -1.486964e-01 1 1  ON 7
 uu_8                -1.415395e-01 1 1  ON 8
 uu_9                -1.116063e-01 1 1  ON 9
 ud_0                 4.517981e-01 1 1  ON 10
 ud_1                 1.857781e-01 1 1  ON 11
 ud_2                 6.523122e-02 1 1  ON 12
 ud_3                -6.208333e-03 1 1  ON 13
 ud_4                -6.386616e-02 1 1  ON 14
 ud_5                -1.064721e-01 1 1  ON 15
 ud_6                -1.353106e-01 1 1  ON 16
 ud_7                -1.533989e-01 1 1  ON 17
 ud_8                -1.547906e-01 1 1  ON 18
 ud_9                -1.443342e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319316e-01 1 1  ON 21
 eO_2                -1.711921e-02 1 1  ON 22
 eO_3                 2.995240e-01 1 1  ON 23
 eO_4                 5.275596e-01 1 1  ON 24
 eO_5                 4.928360e-01 1 1  ON 25
 eO_6                 2.675117e-01 1 1  ON 26
 eO_7                -3.851126e-02 1 1  ON 27
 eO_8                -2.366061e-01 1 1  ON 28
 eO_9                -1.050271e-01 1 1  ON 29
eH1_0                -2.613893e-01 1 1  ON 30
eH1_1                -1.560391e-01 1 1  ON 31
eH1_2                -1.069256e-01 1 1  ON 32
eH1_3                -5.147791e-02 1 1  ON 33
eH1_4                -1.895338e-03 1 1  ON 34
eH1_5                 3.378686e-02 1 1  ON 35
eH1_6                 9.534582e-02 1 1  ON 36
eH1_7                 1.573603e-01 1 1  ON 37
eH1_8                 1.940049e-01 1 1  ON 38
eH1_9                 9.580175e-02 1 1  ON 39
eH2_0                -2.608793e-01 1 1  ON 40
eH2_1                -1.549223e-01 1 1  ON 41
eH2_2                -1.056252e-01 1 1  ON 42
eH2_3                -5.017739e-02 1 1  ON 43
eH2_4                -4.285663e-04 1 1  ON 44
eH2_5                 3.598919e-02 1 1  ON 45
eH2_6                 9.731769e-02 1 1  ON 46
eH2_7                 1.586866e-01 1 1  ON 47
eH2_8                 2.004673e-01 1 1  ON 48
eH2_9                 9.149983e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5883e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9508
    reference variance = 0.250734
====================================================
  Execution time = 2.1118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6621e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366304070119
                                         uncertainty =       0.026188604592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366304070119
                                         uncertainty =       0.026188604592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427910016
  error estimate for blocks of size 2^( 2) =       0.000439961914
  error estimate for blocks of size 2^( 3) =       0.000452306095
  error estimate for blocks of size 2^( 4) =       0.000464584536
  error estimate for blocks of size 2^( 5) =       0.000475782151
  error estimate for blocks of size 2^( 6) =       0.000482972192
  error estimate for blocks of size 2^( 7) =       0.000488770846

      target function =                  N/A
              le_mean =     -16.905965710485
             les_mean =     286.177890384387
             stat err =       0.000478027431
             autocorr =       1.247960197976
              std dev =       0.605156147941
             le_variance =       0.366213963391


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596571049e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905965710485       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905965751398       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905965729554       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905965740446       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905965750199       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905965751921       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905965748010       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905965749875       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.254431e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905965710485       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905965720809       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905965715261       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905965718113       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905965720455       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905965720960       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905965720008       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905965720464       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.138614e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905965710485       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905965713072       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905965711680       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905965712400       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905965712981       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905965713111       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905965712875       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905965712988       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 7.848112e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255166 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6980e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.111061e-01 1 1  ON 0
 uu_1                 1.435966e-01 1 1  ON 1
 uu_2                 4.146727e-02 1 1  ON 2
 uu_3                -2.162121e-02 1 1  ON 3
 uu_4                -6.789770e-02 1 1  ON 4
 uu_5                -1.040408e-01 1 1  ON 5
 uu_6                -1.333999e-01 1 1  ON 6
 uu_7                -1.486957e-01 1 1  ON 7
 uu_8                -1.415406e-01 1 1  ON 8
 uu_9                -1.116066e-01 1 1  ON 9
 ud_0                 4.517976e-01 1 1  ON 10
 ud_1                 1.857779e-01 1 1  ON 11
 ud_2                 6.523145e-02 1 1  ON 12
 ud_3                -6.206721e-03 1 1  ON 13
 ud_4                -6.386636e-02 1 1  ON 14
 ud_5                -1.064715e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533998e-01 1 1  ON 17
 ud_8                -1.547907e-01 1 1  ON 18
 ud_9                -1.443343e-01 1 1  ON 19
 eO_0                -7.534186e-01 1 1  ON 20
 eO_1                -4.319323e-01 1 1  ON 21
 eO_2                -1.711807e-02 1 1  ON 22
 eO_3                 2.995257e-01 1 1  ON 23
 eO_4                 5.275587e-01 1 1  ON 24
 eO_5                 4.928366e-01 1 1  ON 25
 eO_6                 2.675114e-01 1 1  ON 26
 eO_7                -3.851145e-02 1 1  ON 27
 eO_8                -2.366071e-01 1 1  ON 28
 eO_9                -1.050287e-01 1 1  ON 29
eH1_0                -2.613892e-01 1 1  ON 30
eH1_1                -1.560418e-01 1 1  ON 31
eH1_2                -1.069250e-01 1 1  ON 32
eH1_3                -5.147941e-02 1 1  ON 33
eH1_4                -1.895744e-03 1 1  ON 34
eH1_5                 3.378614e-02 1 1  ON 35
eH1_6                 9.534491e-02 1 1  ON 36
eH1_7                 1.573615e-01 1 1  ON 37
eH1_8                 1.940061e-01 1 1  ON 38
eH1_9                 9.580421e-02 1 1  ON 39
eH2_0                -2.608805e-01 1 1  ON 40
eH2_1                -1.549225e-01 1 1  ON 41
eH2_2                -1.056281e-01 1 1  ON 42
eH2_3                -5.017967e-02 1 1  ON 43
eH2_4                -4.290666e-04 1 1  ON 44
eH2_5                 3.598871e-02 1 1  ON 45
eH2_6                 9.731879e-02 1 1  ON 46
eH2_7                 1.586881e-01 1 1  ON 47
eH2_8                 2.004683e-01 1 1  ON 48
eH2_9                 9.150297e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9087
    reference variance = 0.277331
====================================================
  Execution time = 2.0000e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5071e-01
  Total weights = 2.0000e+06
  Execution time = 1.8539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350728041326
                                         uncertainty =       0.007167133197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350728041326
                                         uncertainty =       0.007167133197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418752792
  error estimate for blocks of size 2^( 2) =       0.000431365897
  error estimate for blocks of size 2^( 3) =       0.000444782342
  error estimate for blocks of size 2^( 4) =       0.000456676078
  error estimate for blocks of size 2^( 5) =       0.000467293625
  error estimate for blocks of size 2^( 6) =       0.000475682730
  error estimate for blocks of size 2^( 7) =       0.000478441106

      target function =                  N/A
              le_mean =     -16.906756329666
             les_mean =     286.189117217459
             stat err =       0.000469523385
             autocorr =       1.257184513563
              std dev =       0.592205878144
             le_variance =       0.350707802108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350724685280
                                         uncertainty =       0.007166864923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350724685280
                                         uncertainty =       0.007166864923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418750788
  error estimate for blocks of size 2^( 2) =       0.000431364033
  error estimate for blocks of size 2^( 3) =       0.000444780600
  error estimate for blocks of size 2^( 4) =       0.000456674449
  error estimate for blocks of size 2^( 5) =       0.000467291890
  error estimate for blocks of size 2^( 6) =       0.000475680942
  error estimate for blocks of size 2^( 7) =       0.000478439227

      target function =                  N/A
              le_mean =     -16.906756313563
             les_mean =     286.189113315413
             stat err =       0.000469521627
             autocorr =       1.257187136023
              std dev =       0.592203043351
             le_variance =       0.350704444554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350726359995
                                         uncertainty =       0.007166996459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350726359995
                                         uncertainty =       0.007166996459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418751788
  error estimate for blocks of size 2^( 2) =       0.000431364963
  error estimate for blocks of size 2^( 3) =       0.000444781470
  error estimate for blocks of size 2^( 4) =       0.000456675262
  error estimate for blocks of size 2^( 5) =       0.000467292756
  error estimate for blocks of size 2^( 6) =       0.000475681835
  error estimate for blocks of size 2^( 7) =       0.000478440164

      target function =                  N/A
              le_mean =     -16.906756321443
             les_mean =     286.189115257316
             stat err =       0.000469522504
             autocorr =       1.257185829161
              std dev =       0.592204457949
             le_variance =       0.350706120014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350727831025
                                         uncertainty =       0.007167116022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350727831025
                                         uncertainty =       0.007167116022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418752667
  error estimate for blocks of size 2^( 2) =       0.000431365780
  error estimate for blocks of size 2^( 3) =       0.000444782233
  error estimate for blocks of size 2^( 4) =       0.000456675976
  error estimate for blocks of size 2^( 5) =       0.000467293517
  error estimate for blocks of size 2^( 6) =       0.000475682618
  error estimate for blocks of size 2^( 7) =       0.000478440988

      target function =                  N/A
              le_mean =     -16.906756328621
             les_mean =     286.189116971740
             stat err =       0.000469523275
             autocorr =       1.257184678090
              std dev =       0.592205700506
             le_variance =       0.350707591711


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906756329666        initial  <--
     1.4901e+01     1.4901e+02             1.2544e-05       -16.906756313563
     5.9605e+01     5.9605e+02             3.1386e-06       -16.906756321443
     2.3842e+02     2.3842e+03             7.8481e-07       -16.906756328621

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3571
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.111063e-01 1 1  ON 0
 uu_1                 1.435975e-01 1 1  ON 1
 uu_2                 4.146772e-02 1 1  ON 2
 uu_3                -2.162027e-02 1 1  ON 3
 uu_4                -6.789794e-02 1 1  ON 4
 uu_5                -1.040407e-01 1 1  ON 5
 uu_6                -1.333995e-01 1 1  ON 6
 uu_7                -1.486964e-01 1 1  ON 7
 uu_8                -1.415395e-01 1 1  ON 8
 uu_9                -1.116063e-01 1 1  ON 9
 ud_0                 4.517981e-01 1 1  ON 10
 ud_1                 1.857781e-01 1 1  ON 11
 ud_2                 6.523122e-02 1 1  ON 12
 ud_3                -6.208333e-03 1 1  ON 13
 ud_4                -6.386616e-02 1 1  ON 14
 ud_5                -1.064721e-01 1 1  ON 15
 ud_6                -1.353106e-01 1 1  ON 16
 ud_7                -1.533989e-01 1 1  ON 17
 ud_8                -1.547906e-01 1 1  ON 18
 ud_9                -1.443342e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319316e-01 1 1  ON 21
 eO_2                -1.711921e-02 1 1  ON 22
 eO_3                 2.995240e-01 1 1  ON 23
 eO_4                 5.275596e-01 1 1  ON 24
 eO_5                 4.928360e-01 1 1  ON 25
 eO_6                 2.675117e-01 1 1  ON 26
 eO_7                -3.851126e-02 1 1  ON 27
 eO_8                -2.366061e-01 1 1  ON 28
 eO_9                -1.050271e-01 1 1  ON 29
eH1_0                -2.613893e-01 1 1  ON 30
eH1_1                -1.560391e-01 1 1  ON 31
eH1_2                -1.069256e-01 1 1  ON 32
eH1_3                -5.147791e-02 1 1  ON 33
eH1_4                -1.895338e-03 1 1  ON 34
eH1_5                 3.378686e-02 1 1  ON 35
eH1_6                 9.534582e-02 1 1  ON 36
eH1_7                 1.573603e-01 1 1  ON 37
eH1_8                 1.940049e-01 1 1  ON 38
eH1_9                 9.580175e-02 1 1  ON 39
eH2_0                -2.608793e-01 1 1  ON 40
eH2_1                -1.549223e-01 1 1  ON 41
eH2_2                -1.056252e-01 1 1  ON 42
eH2_3                -5.017739e-02 1 1  ON 43
eH2_4                -4.285663e-04 1 1  ON 44
eH2_5                 3.598919e-02 1 1  ON 45
eH2_6                 9.731769e-02 1 1  ON 46
eH2_7                 1.586866e-01 1 1  ON 47
eH2_8                 2.004673e-01 1 1  ON 48
eH2_9                 9.149983e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9827
    reference variance = 0.23505
====================================================
  Execution time = 2.0408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4268e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342689344793
                                         uncertainty =       0.004595352131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342689344793
                                         uncertainty =       0.004595352131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413932232
  error estimate for blocks of size 2^( 2) =       0.000426251746
  error estimate for blocks of size 2^( 3) =       0.000439371806
  error estimate for blocks of size 2^( 4) =       0.000451732350
  error estimate for blocks of size 2^( 5) =       0.000462287687
  error estimate for blocks of size 2^( 6) =       0.000469987135
  error estimate for blocks of size 2^( 7) =       0.000474626958

      target function =                  N/A
              le_mean =     -16.906989335968
             les_mean =     286.188968021370
             stat err =       0.000464658533
             autocorr =       1.260112564029
              std dev =       0.585388577078
             le_variance =       0.342679786174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690698933597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906989335968       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906989334724       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906989332938       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906989330164       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906989335513       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906989335763       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906989334623       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906989335601       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.168699e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906989335968       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906989335657       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906989335209       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906989334515       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906989335854       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906989335917       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906989335631       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906989335875       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.922362e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906989335968       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906989335890       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906989335778       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906989335605       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906989335939       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906989335957       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906989335884       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906989335943       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 7.306289e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257716 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5944e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.111062e-01 1 1  ON 0
 uu_1                 1.435975e-01 1 1  ON 1
 uu_2                 4.146770e-02 1 1  ON 2
 uu_3                -2.162013e-02 1 1  ON 3
 uu_4                -6.789799e-02 1 1  ON 4
 uu_5                -1.040407e-01 1 1  ON 5
 uu_6                -1.333993e-01 1 1  ON 6
 uu_7                -1.486964e-01 1 1  ON 7
 uu_8                -1.415398e-01 1 1  ON 8
 uu_9                -1.116064e-01 1 1  ON 9
 ud_0                 4.517980e-01 1 1  ON 10
 ud_1                 1.857782e-01 1 1  ON 11
 ud_2                 6.523117e-02 1 1  ON 12
 ud_3                -6.208257e-03 1 1  ON 13
 ud_4                -6.386615e-02 1 1  ON 14
 ud_5                -1.064720e-01 1 1  ON 15
 ud_6                -1.353105e-01 1 1  ON 16
 ud_7                -1.533988e-01 1 1  ON 17
 ud_8                -1.547907e-01 1 1  ON 18
 ud_9                -1.443343e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319315e-01 1 1  ON 21
 eO_2                -1.711925e-02 1 1  ON 22
 eO_3                 2.995242e-01 1 1  ON 23
 eO_4                 5.275595e-01 1 1  ON 24
 eO_5                 4.928361e-01 1 1  ON 25
 eO_6                 2.675118e-01 1 1  ON 26
 eO_7                -3.851128e-02 1 1  ON 27
 eO_8                -2.366063e-01 1 1  ON 28
 eO_9                -1.050273e-01 1 1  ON 29
eH1_0                -2.613893e-01 1 1  ON 30
eH1_1                -1.560392e-01 1 1  ON 31
eH1_2                -1.069257e-01 1 1  ON 32
eH1_3                -5.147791e-02 1 1  ON 33
eH1_4                -1.895568e-03 1 1  ON 34
eH1_5                 3.378698e-02 1 1  ON 35
eH1_6                 9.534569e-02 1 1  ON 36
eH1_7                 1.573603e-01 1 1  ON 37
eH1_8                 1.940051e-01 1 1  ON 38
eH1_9                 9.580202e-02 1 1  ON 39
eH2_0                -2.608794e-01 1 1  ON 40
eH2_1                -1.549224e-01 1 1  ON 41
eH2_2                -1.056254e-01 1 1  ON 42
eH2_3                -5.017738e-02 1 1  ON 43
eH2_4                -4.284991e-04 1 1  ON 44
eH2_5                 3.598917e-02 1 1  ON 45
eH2_6                 9.731790e-02 1 1  ON 46
eH2_7                 1.586865e-01 1 1  ON 47
eH2_8                 2.004673e-01 1 1  ON 48
eH2_9                 9.150007e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8501
    reference variance = 0.350886
====================================================
  Execution time = 2.0053e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3967e-01
  Total weights = 2.0000e+06
  Execution time = 1.8546e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646659533
                                         uncertainty =       0.003981274120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646659533
                                         uncertainty =       0.003981274120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110959
  error estimate for blocks of size 2^( 2) =       0.000424719713
  error estimate for blocks of size 2^( 3) =       0.000438179757
  error estimate for blocks of size 2^( 4) =       0.000450222447
  error estimate for blocks of size 2^( 5) =       0.000459642044
  error estimate for blocks of size 2^( 6) =       0.000468405964
  error estimate for blocks of size 2^( 7) =       0.000472356813

      target function =                  N/A
              le_mean =     -16.906136058456
             les_mean =     286.157107142848
             stat err =       0.000462656817
             autocorr =       1.260345465876
              std dev =       0.582812907939
             le_variance =       0.339670885660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646162159
                                         uncertainty =       0.003981270908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646162159
                                         uncertainty =       0.003981270908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110657
  error estimate for blocks of size 2^( 2) =       0.000424719422
  error estimate for blocks of size 2^( 3) =       0.000438179471
  error estimate for blocks of size 2^( 4) =       0.000450222161
  error estimate for blocks of size 2^( 5) =       0.000459641724
  error estimate for blocks of size 2^( 6) =       0.000468405637
  error estimate for blocks of size 2^( 7) =       0.000472356471

      target function =                  N/A
              le_mean =     -16.906136069350
             les_mean =     286.157107013387
             stat err =       0.000462656498
             autocorr =       1.260345577045
              std dev =       0.582812480849
             le_variance =       0.339670387833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646410296
                                         uncertainty =       0.003981272511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646410296
                                         uncertainty =       0.003981272511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110808
  error estimate for blocks of size 2^( 2) =       0.000424719567
  error estimate for blocks of size 2^( 3) =       0.000438179613
  error estimate for blocks of size 2^( 4) =       0.000450222304
  error estimate for blocks of size 2^( 5) =       0.000459641883
  error estimate for blocks of size 2^( 6) =       0.000468405800
  error estimate for blocks of size 2^( 7) =       0.000472356641

      target function =                  N/A
              le_mean =     -16.906136063912
             les_mean =     286.157107077852
             stat err =       0.000462656657
             autocorr =       1.260345521607
              std dev =       0.582812693921
             le_variance =       0.339670636196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646628360
                                         uncertainty =       0.003981273918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646628360
                                         uncertainty =       0.003981273918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412110940
  error estimate for blocks of size 2^( 2) =       0.000424719695
  error estimate for blocks of size 2^( 3) =       0.000438179739
  error estimate for blocks of size 2^( 4) =       0.000450222429
  error estimate for blocks of size 2^( 5) =       0.000459642024
  error estimate for blocks of size 2^( 6) =       0.000468405944
  error estimate for blocks of size 2^( 7) =       0.000472356791

      target function =                  N/A
              le_mean =     -16.906136059138
             les_mean =     286.157107134711
             stat err =       0.000462656797
             autocorr =       1.260345472852
              std dev =       0.582812881171
             le_variance =       0.339670854459


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906136058456        initial
     1.4901e+02     1.4901e+03             1.1687e-06       -16.906136069350  <--
     5.9605e+02     5.9605e+03             2.9224e-07       -16.906136063912
     2.3842e+03     2.3842e+04             7.3063e-08       -16.906136059138

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 2.9411e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.111059e-01 1 1  ON 0
 uu_1                 1.435974e-01 1 1  ON 1
 uu_2                 4.146763e-02 1 1  ON 2
 uu_3                -2.161971e-02 1 1  ON 3
 uu_4                -6.789815e-02 1 1  ON 4
 uu_5                -1.040406e-01 1 1  ON 5
 uu_6                -1.333987e-01 1 1  ON 6
 uu_7                -1.486963e-01 1 1  ON 7
 uu_8                -1.415407e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517976e-01 1 1  ON 10
 ud_1                 1.857786e-01 1 1  ON 11
 ud_2                 6.523102e-02 1 1  ON 12
 ud_3                -6.208027e-03 1 1  ON 13
 ud_4                -6.386611e-02 1 1  ON 14
 ud_5                -1.064716e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533986e-01 1 1  ON 17
 ud_8                -1.547909e-01 1 1  ON 18
 ud_9                -1.443347e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319310e-01 1 1  ON 21
 eO_2                -1.711936e-02 1 1  ON 22
 eO_3                 2.995249e-01 1 1  ON 23
 eO_4                 5.275594e-01 1 1  ON 24
 eO_5                 4.928363e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851134e-02 1 1  ON 27
 eO_8                -2.366068e-01 1 1  ON 28
 eO_9                -1.050280e-01 1 1  ON 29
eH1_0                -2.613895e-01 1 1  ON 30
eH1_1                -1.560393e-01 1 1  ON 31
eH1_2                -1.069262e-01 1 1  ON 32
eH1_3                -5.147791e-02 1 1  ON 33
eH1_4                -1.896256e-03 1 1  ON 34
eH1_5                 3.378733e-02 1 1  ON 35
eH1_6                 9.534531e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940056e-01 1 1  ON 38
eH1_9                 9.580281e-02 1 1  ON 39
eH2_0                -2.608797e-01 1 1  ON 40
eH2_1                -1.549227e-01 1 1  ON 41
eH2_2                -1.056259e-01 1 1  ON 42
eH2_3                -5.017735e-02 1 1  ON 43
eH2_4                -4.282977e-04 1 1  ON 44
eH2_5                 3.598910e-02 1 1  ON 45
eH2_6                 9.731852e-02 1 1  ON 46
eH2_7                 1.586862e-01 1 1  ON 47
eH2_8                 2.004672e-01 1 1  ON 48
eH2_9                 9.150076e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5363e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9227
    reference variance = 0.344374
====================================================
  Execution time = 2.0088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5014e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350182059856
                                         uncertainty =       0.008697002050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350182059856
                                         uncertainty =       0.008697002050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418413680
  error estimate for blocks of size 2^( 2) =       0.000430830541
  error estimate for blocks of size 2^( 3) =       0.000443698902
  error estimate for blocks of size 2^( 4) =       0.000455287039
  error estimate for blocks of size 2^( 5) =       0.000465907918
  error estimate for blocks of size 2^( 6) =       0.000472565785
  error estimate for blocks of size 2^( 7) =       0.000478492386

      target function =                  N/A
              le_mean =     -16.906196007500
             les_mean =     286.169603283713
             stat err =       0.000468063282
             autocorr =       1.251403592391
              std dev =       0.591726300558
             le_variance =       0.350140014772


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619600750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906196007500       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906196019215       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906196026104       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906196035197       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906196039056       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906196040410       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906196044471       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906196041935       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 4.821475e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906196007500       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906196010436       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906196012194       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906196014477       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906196015461       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906196015813       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906196016828       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906196016201       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.205554e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906196007500       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906196008235       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906196008676       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906196009248       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906196009495       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906196009583       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906196009837       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906196009681       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.014001e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260354 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5591e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.111060e-01 1 1  ON 0
 uu_1                 1.435973e-01 1 1  ON 1
 uu_2                 4.146696e-02 1 1  ON 2
 uu_3                -2.161954e-02 1 1  ON 3
 uu_4                -6.789846e-02 1 1  ON 4
 uu_5                -1.040400e-01 1 1  ON 5
 uu_6                -1.333989e-01 1 1  ON 6
 uu_7                -1.486965e-01 1 1  ON 7
 uu_8                -1.415408e-01 1 1  ON 8
 uu_9                -1.116071e-01 1 1  ON 9
 ud_0                 4.517977e-01 1 1  ON 10
 ud_1                 1.857789e-01 1 1  ON 11
 ud_2                 6.523126e-02 1 1  ON 12
 ud_3                -6.208374e-03 1 1  ON 13
 ud_4                -6.386568e-02 1 1  ON 14
 ud_5                -1.064718e-01 1 1  ON 15
 ud_6                -1.353099e-01 1 1  ON 16
 ud_7                -1.533985e-01 1 1  ON 17
 ud_8                -1.547908e-01 1 1  ON 18
 ud_9                -1.443349e-01 1 1  ON 19
 eO_0                -7.534203e-01 1 1  ON 20
 eO_1                -4.319307e-01 1 1  ON 21
 eO_2                -1.711889e-02 1 1  ON 22
 eO_3                 2.995245e-01 1 1  ON 23
 eO_4                 5.275598e-01 1 1  ON 24
 eO_5                 4.928371e-01 1 1  ON 25
 eO_6                 2.675117e-01 1 1  ON 26
 eO_7                -3.851106e-02 1 1  ON 27
 eO_8                -2.366071e-01 1 1  ON 28
 eO_9                -1.050290e-01 1 1  ON 29
eH1_0                -2.613896e-01 1 1  ON 30
eH1_1                -1.560395e-01 1 1  ON 31
eH1_2                -1.069267e-01 1 1  ON 32
eH1_3                -5.147844e-02 1 1  ON 33
eH1_4                -1.897009e-03 1 1  ON 34
eH1_5                 3.378658e-02 1 1  ON 35
eH1_6                 9.534554e-02 1 1  ON 36
eH1_7                 1.573608e-01 1 1  ON 37
eH1_8                 1.940065e-01 1 1  ON 38
eH1_9                 9.580401e-02 1 1  ON 39
eH2_0                -2.608801e-01 1 1  ON 40
eH2_1                -1.549218e-01 1 1  ON 41
eH2_2                -1.056269e-01 1 1  ON 42
eH2_3                -5.017767e-02 1 1  ON 43
eH2_4                -4.286787e-04 1 1  ON 44
eH2_5                 3.598880e-02 1 1  ON 45
eH2_6                 9.731881e-02 1 1  ON 46
eH2_7                 1.586862e-01 1 1  ON 47
eH2_8                 2.004673e-01 1 1  ON 48
eH2_9                 9.150187e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8916
    reference variance = 0.348871
====================================================
  Execution time = 2.0059e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5141e-01
  Total weights = 2.0000e+06
  Execution time = 1.8567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351429450122
                                         uncertainty =       0.006968942730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351429450122
                                         uncertainty =       0.006968942730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419170892
  error estimate for blocks of size 2^( 2) =       0.000431591840
  error estimate for blocks of size 2^( 3) =       0.000443387933
  error estimate for blocks of size 2^( 4) =       0.000454302731
  error estimate for blocks of size 2^( 5) =       0.000463285429
  error estimate for blocks of size 2^( 6) =       0.000470964511
  error estimate for blocks of size 2^( 7) =       0.000474677787

      target function =                  N/A
              le_mean =     -16.906928585230
             les_mean =     286.195642483022
             stat err =       0.000465807614
             autocorr =       1.234897564761
              std dev =       0.592797159781
             le_variance =       0.351408472644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351430477560
                                         uncertainty =       0.006968953835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351430477560
                                         uncertainty =       0.006968953835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419171504
  error estimate for blocks of size 2^( 2) =       0.000431592426
  error estimate for blocks of size 2^( 3) =       0.000443388458
  error estimate for blocks of size 2^( 4) =       0.000454303238
  error estimate for blocks of size 2^( 5) =       0.000463285862
  error estimate for blocks of size 2^( 6) =       0.000470964886
  error estimate for blocks of size 2^( 7) =       0.000474678175

      target function =                  N/A
              le_mean =     -16.906928575718
             les_mean =     286.195643188465
             stat err =       0.000465808040
             autocorr =       1.234896213508
              std dev =       0.592798026098
             le_variance =       0.351409499746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351429963430
                                         uncertainty =       0.006968948138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351429963430
                                         uncertainty =       0.006968948138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419171198
  error estimate for blocks of size 2^( 2) =       0.000431592132
  error estimate for blocks of size 2^( 3) =       0.000443388195
  error estimate for blocks of size 2^( 4) =       0.000454302984
  error estimate for blocks of size 2^( 5) =       0.000463285645
  error estimate for blocks of size 2^( 6) =       0.000470964698
  error estimate for blocks of size 2^( 7) =       0.000474677980

      target function =                  N/A
              le_mean =     -16.906928580470
             les_mean =     286.195642835200
             stat err =       0.000465807827
             autocorr =       1.234896888250
              std dev =       0.592797592592
             le_variance =       0.351408985783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351429514260
                                         uncertainty =       0.006968943401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351429514260
                                         uncertainty =       0.006968943401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419170930
  error estimate for blocks of size 2^( 2) =       0.000431591876
  error estimate for blocks of size 2^( 3) =       0.000443387966
  error estimate for blocks of size 2^( 4) =       0.000454302762
  error estimate for blocks of size 2^( 5) =       0.000463285456
  error estimate for blocks of size 2^( 6) =       0.000470964534
  error estimate for blocks of size 2^( 7) =       0.000474677811

      target function =                  N/A
              le_mean =     -16.906928584634
             les_mean =     286.195642526970
             stat err =       0.000465807641
             autocorr =       1.234897480162
              std dev =       0.592797213861
             le_variance =       0.351408536761


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906928585230        initial  <--
     3.7253e+01     3.7253e+02             4.8215e-06       -16.906928575718
     1.4901e+02     1.4901e+03             1.2056e-06       -16.906928580470
     5.9605e+02     5.9605e+03             3.0140e-07       -16.906928584634

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4110
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.111059e-01 1 1  ON 0
 uu_1                 1.435974e-01 1 1  ON 1
 uu_2                 4.146763e-02 1 1  ON 2
 uu_3                -2.161971e-02 1 1  ON 3
 uu_4                -6.789815e-02 1 1  ON 4
 uu_5                -1.040406e-01 1 1  ON 5
 uu_6                -1.333987e-01 1 1  ON 6
 uu_7                -1.486963e-01 1 1  ON 7
 uu_8                -1.415407e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517976e-01 1 1  ON 10
 ud_1                 1.857786e-01 1 1  ON 11
 ud_2                 6.523102e-02 1 1  ON 12
 ud_3                -6.208027e-03 1 1  ON 13
 ud_4                -6.386611e-02 1 1  ON 14
 ud_5                -1.064716e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533986e-01 1 1  ON 17
 ud_8                -1.547909e-01 1 1  ON 18
 ud_9                -1.443347e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319310e-01 1 1  ON 21
 eO_2                -1.711936e-02 1 1  ON 22
 eO_3                 2.995249e-01 1 1  ON 23
 eO_4                 5.275594e-01 1 1  ON 24
 eO_5                 4.928363e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851134e-02 1 1  ON 27
 eO_8                -2.366068e-01 1 1  ON 28
 eO_9                -1.050280e-01 1 1  ON 29
eH1_0                -2.613895e-01 1 1  ON 30
eH1_1                -1.560393e-01 1 1  ON 31
eH1_2                -1.069262e-01 1 1  ON 32
eH1_3                -5.147791e-02 1 1  ON 33
eH1_4                -1.896256e-03 1 1  ON 34
eH1_5                 3.378733e-02 1 1  ON 35
eH1_6                 9.534531e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940056e-01 1 1  ON 38
eH1_9                 9.580281e-02 1 1  ON 39
eH2_0                -2.608797e-01 1 1  ON 40
eH2_1                -1.549227e-01 1 1  ON 41
eH2_2                -1.056259e-01 1 1  ON 42
eH2_3                -5.017735e-02 1 1  ON 43
eH2_4                -4.282977e-04 1 1  ON 44
eH2_5                 3.598910e-02 1 1  ON 45
eH2_6                 9.731852e-02 1 1  ON 46
eH2_7                 1.586862e-01 1 1  ON 47
eH2_8                 2.004672e-01 1 1  ON 48
eH2_9                 9.150076e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8698
    reference variance = 0.264799
====================================================
  Execution time = 2.0432e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3948e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339563726760
                                         uncertainty =       0.004916532514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339563726760
                                         uncertainty =       0.004916532514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411997337
  error estimate for blocks of size 2^( 2) =       0.000424972932
  error estimate for blocks of size 2^( 3) =       0.000439149889
  error estimate for blocks of size 2^( 4) =       0.000451740102
  error estimate for blocks of size 2^( 5) =       0.000461429981
  error estimate for blocks of size 2^( 6) =       0.000469674916
  error estimate for blocks of size 2^( 7) =       0.000471972449

      target function =                  N/A
              le_mean =     -16.905764453054
             les_mean =     286.144355184324
             stat err =       0.000463704362
             autocorr =       1.266757673630
              std dev =       0.582652222097
             le_variance =       0.339483611915


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576445305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764453054       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764455576       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764455897       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764455873       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764455477       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764455261       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764455529       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764455628       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 6.116093e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764453054       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764453685       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764453765       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764453759       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764453660       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764453606       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764453671       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764453697       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.529152e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905764453054       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905764453212       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764453232       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905764453228       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905764453205       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905764453198       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905764453209       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905764453209       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.822959e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6000e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.111060e-01 1 1  ON 0
 uu_1                 1.435973e-01 1 1  ON 1
 uu_2                 4.146752e-02 1 1  ON 2
 uu_3                -2.161973e-02 1 1  ON 3
 uu_4                -6.789820e-02 1 1  ON 4
 uu_5                -1.040406e-01 1 1  ON 5
 uu_6                -1.333987e-01 1 1  ON 6
 uu_7                -1.486963e-01 1 1  ON 7
 uu_8                -1.415407e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517976e-01 1 1  ON 10
 ud_1                 1.857788e-01 1 1  ON 11
 ud_2                 6.523098e-02 1 1  ON 12
 ud_3                -6.208034e-03 1 1  ON 13
 ud_4                -6.386611e-02 1 1  ON 14
 ud_5                -1.064716e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533986e-01 1 1  ON 17
 ud_8                -1.547909e-01 1 1  ON 18
 ud_9                -1.443347e-01 1 1  ON 19
 eO_0                -7.534201e-01 1 1  ON 20
 eO_1                -4.319310e-01 1 1  ON 21
 eO_2                -1.711930e-02 1 1  ON 22
 eO_3                 2.995249e-01 1 1  ON 23
 eO_4                 5.275594e-01 1 1  ON 24
 eO_5                 4.928364e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851135e-02 1 1  ON 27
 eO_8                -2.366068e-01 1 1  ON 28
 eO_9                -1.050280e-01 1 1  ON 29
eH1_0                -2.613895e-01 1 1  ON 30
eH1_1                -1.560394e-01 1 1  ON 31
eH1_2                -1.069263e-01 1 1  ON 32
eH1_3                -5.147790e-02 1 1  ON 33
eH1_4                -1.896281e-03 1 1  ON 34
eH1_5                 3.378736e-02 1 1  ON 35
eH1_6                 9.534531e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940057e-01 1 1  ON 38
eH1_9                 9.580294e-02 1 1  ON 39
eH2_0                -2.608797e-01 1 1  ON 40
eH2_1                -1.549227e-01 1 1  ON 41
eH2_2                -1.056259e-01 1 1  ON 42
eH2_3                -5.017743e-02 1 1  ON 43
eH2_4                -4.283749e-04 1 1  ON 44
eH2_5                 3.598895e-02 1 1  ON 45
eH2_6                 9.731854e-02 1 1  ON 46
eH2_7                 1.586863e-01 1 1  ON 47
eH2_8                 2.004673e-01 1 1  ON 48
eH2_9                 9.150090e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8709
    reference variance = 0.267994
====================================================
  Execution time = 2.0084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4933e-01
  Total weights = 2.0000e+06
  Execution time = 1.8541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349356047941
                                         uncertainty =       0.015631279028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349356047941
                                         uncertainty =       0.015631279028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417928525
  error estimate for blocks of size 2^( 2) =       0.000430564854
  error estimate for blocks of size 2^( 3) =       0.000443144028
  error estimate for blocks of size 2^( 4) =       0.000455883175
  error estimate for blocks of size 2^( 5) =       0.000466381117
  error estimate for blocks of size 2^( 6) =       0.000474111660
  error estimate for blocks of size 2^( 7) =       0.000478843513

      target function =                  N/A
              le_mean =     -16.906306520709
             les_mean =     286.172528502009
             stat err =       0.000468804866
             autocorr =       1.258288399847
              std dev =       0.591040188582
             le_variance =       0.349328504519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349356068558
                                         uncertainty =       0.015631246380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349356068558
                                         uncertainty =       0.015631246380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417928537
  error estimate for blocks of size 2^( 2) =       0.000430564862
  error estimate for blocks of size 2^( 3) =       0.000443144030
  error estimate for blocks of size 2^( 4) =       0.000455883169
  error estimate for blocks of size 2^( 5) =       0.000466381117
  error estimate for blocks of size 2^( 6) =       0.000474111645
  error estimate for blocks of size 2^( 7) =       0.000478843505

      target function =                  N/A
              le_mean =     -16.906306520867
             les_mean =     286.172528527403
             stat err =       0.000468804859
             autocorr =       1.258288290655
              std dev =       0.591040205527
             le_variance =       0.349328524550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349356058173
                                         uncertainty =       0.015631262698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349356058173
                                         uncertainty =       0.015631262698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417928531
  error estimate for blocks of size 2^( 2) =       0.000430564858
  error estimate for blocks of size 2^( 3) =       0.000443144029
  error estimate for blocks of size 2^( 4) =       0.000455883172
  error estimate for blocks of size 2^( 5) =       0.000466381117
  error estimate for blocks of size 2^( 6) =       0.000474111653
  error estimate for blocks of size 2^( 7) =       0.000478843509

      target function =                  N/A
              le_mean =     -16.906306520787
             les_mean =     286.172528514608
             stat err =       0.000468804863
             autocorr =       1.258288345283
              std dev =       0.591040196990
             le_variance =       0.349328514458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349356049217
                                         uncertainty =       0.015631276987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349356049217
                                         uncertainty =       0.015631276987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417928526
  error estimate for blocks of size 2^( 2) =       0.000430564855
  error estimate for blocks of size 2^( 3) =       0.000443144028
  error estimate for blocks of size 2^( 4) =       0.000455883175
  error estimate for blocks of size 2^( 5) =       0.000466381117
  error estimate for blocks of size 2^( 6) =       0.000474111659
  error estimate for blocks of size 2^( 7) =       0.000478843512

      target function =                  N/A
              le_mean =     -16.906306520718
             les_mean =     286.172528503580
             stat err =       0.000468804866
             autocorr =       1.258288393031
              std dev =       0.591040189631
             le_variance =       0.349328505759


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906306520709        initial
     3.7253e+02     3.7253e+03             6.1161e-07       -16.906306520867  <--
     1.4901e+03     1.4901e+04             1.5292e-07       -16.906306520787
     5.9605e+03     5.9605e+04             3.8230e-08       -16.906306520718

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 2.9433e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.111061e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146717e-02 1 1  ON 2
 uu_3                -2.161981e-02 1 1  ON 3
 uu_4                -6.789835e-02 1 1  ON 4
 uu_5                -1.040405e-01 1 1  ON 5
 uu_6                -1.333986e-01 1 1  ON 6
 uu_7                -1.486963e-01 1 1  ON 7
 uu_8                -1.415406e-01 1 1  ON 8
 uu_9                -1.116067e-01 1 1  ON 9
 ud_0                 4.517975e-01 1 1  ON 10
 ud_1                 1.857791e-01 1 1  ON 11
 ud_2                 6.523085e-02 1 1  ON 12
 ud_3                -6.208055e-03 1 1  ON 13
 ud_4                -6.386612e-02 1 1  ON 14
 ud_5                -1.064715e-01 1 1  ON 15
 ud_6                -1.353103e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547907e-01 1 1  ON 18
 ud_9                -1.443346e-01 1 1  ON 19
 eO_0                -7.534199e-01 1 1  ON 20
 eO_1                -4.319311e-01 1 1  ON 21
 eO_2                -1.711910e-02 1 1  ON 22
 eO_3                 2.995249e-01 1 1  ON 23
 eO_4                 5.275594e-01 1 1  ON 24
 eO_5                 4.928365e-01 1 1  ON 25
 eO_6                 2.675120e-01 1 1  ON 26
 eO_7                -3.851138e-02 1 1  ON 27
 eO_8                -2.366070e-01 1 1  ON 28
 eO_9                -1.050282e-01 1 1  ON 29
eH1_0                -2.613897e-01 1 1  ON 30
eH1_1                -1.560395e-01 1 1  ON 31
eH1_2                -1.069265e-01 1 1  ON 32
eH1_3                -5.147788e-02 1 1  ON 33
eH1_4                -1.896354e-03 1 1  ON 34
eH1_5                 3.378744e-02 1 1  ON 35
eH1_6                 9.534531e-02 1 1  ON 36
eH1_7                 1.573601e-01 1 1  ON 37
eH1_8                 1.940058e-01 1 1  ON 38
eH1_9                 9.580331e-02 1 1  ON 39
eH2_0                -2.608796e-01 1 1  ON 40
eH2_1                -1.549226e-01 1 1  ON 41
eH2_2                -1.056261e-01 1 1  ON 42
eH2_3                -5.017767e-02 1 1  ON 43
eH2_4                -4.286067e-04 1 1  ON 44
eH2_5                 3.598849e-02 1 1  ON 45
eH2_6                 9.731858e-02 1 1  ON 46
eH2_7                 1.586864e-01 1 1  ON 47
eH2_8                 2.004675e-01 1 1  ON 48
eH2_9                 9.150131e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9146
    reference variance = 0.225178
====================================================
  Execution time = 2.0551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4159e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5556e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341710680972
                                         uncertainty =       0.004388685378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341710680972
                                         uncertainty =       0.004388685378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413274208
  error estimate for blocks of size 2^( 2) =       0.000425904396
  error estimate for blocks of size 2^( 3) =       0.000439234574
  error estimate for blocks of size 2^( 4) =       0.000451721077
  error estimate for blocks of size 2^( 5) =       0.000462020968
  error estimate for blocks of size 2^( 6) =       0.000468583329
  error estimate for blocks of size 2^( 7) =       0.000475194675

      target function =                  N/A
              le_mean =     -16.905895779011
             les_mean =     286.150903061636
             stat err =       0.000464380012
             autocorr =       1.262613513087
              std dev =       0.584457989638
             le_variance =       0.341591141652


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589577901e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895779011       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895779954       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905895774353       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895773449       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905895776667       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905895777840       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905895776776       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905895778014       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.473391e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895779011       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895779247       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905895777843       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895777616       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905895778422       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905895778714       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905895778449       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905895778758       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 6.184123e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895779011       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895779070       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905895778719       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895778663       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905895778864       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905895778936       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905895778870       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905895778947       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.546071e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6115e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.111061e-01 1 1  ON 0
 uu_1                 1.435968e-01 1 1  ON 1
 uu_2                 4.146731e-02 1 1  ON 2
 uu_3                -2.162005e-02 1 1  ON 3
 uu_4                -6.789824e-02 1 1  ON 4
 uu_5                -1.040406e-01 1 1  ON 5
 uu_6                -1.333986e-01 1 1  ON 6
 uu_7                -1.486963e-01 1 1  ON 7
 uu_8                -1.415406e-01 1 1  ON 8
 uu_9                -1.116067e-01 1 1  ON 9
 ud_0                 4.517978e-01 1 1  ON 10
 ud_1                 1.857790e-01 1 1  ON 11
 ud_2                 6.523095e-02 1 1  ON 12
 ud_3                -6.208099e-03 1 1  ON 13
 ud_4                -6.386603e-02 1 1  ON 14
 ud_5                -1.064714e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533988e-01 1 1  ON 17
 ud_8                -1.547909e-01 1 1  ON 18
 ud_9                -1.443348e-01 1 1  ON 19
 eO_0                -7.534197e-01 1 1  ON 20
 eO_1                -4.319310e-01 1 1  ON 21
 eO_2                -1.711912e-02 1 1  ON 22
 eO_3                 2.995249e-01 1 1  ON 23
 eO_4                 5.275595e-01 1 1  ON 24
 eO_5                 4.928365e-01 1 1  ON 25
 eO_6                 2.675120e-01 1 1  ON 26
 eO_7                -3.851139e-02 1 1  ON 27
 eO_8                -2.366071e-01 1 1  ON 28
 eO_9                -1.050286e-01 1 1  ON 29
eH1_0                -2.613902e-01 1 1  ON 30
eH1_1                -1.560399e-01 1 1  ON 31
eH1_2                -1.069266e-01 1 1  ON 32
eH1_3                -5.147788e-02 1 1  ON 33
eH1_4                -1.896062e-03 1 1  ON 34
eH1_5                 3.378728e-02 1 1  ON 35
eH1_6                 9.534507e-02 1 1  ON 36
eH1_7                 1.573600e-01 1 1  ON 37
eH1_8                 1.940063e-01 1 1  ON 38
eH1_9                 9.580393e-02 1 1  ON 39
eH2_0                -2.608796e-01 1 1  ON 40
eH2_1                -1.549228e-01 1 1  ON 41
eH2_2                -1.056262e-01 1 1  ON 42
eH2_3                -5.017766e-02 1 1  ON 43
eH2_4                -4.286199e-04 1 1  ON 44
eH2_5                 3.598819e-02 1 1  ON 45
eH2_6                 9.731864e-02 1 1  ON 46
eH2_7                 1.586864e-01 1 1  ON 47
eH2_8                 2.004676e-01 1 1  ON 48
eH2_9                 9.150174e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9165
    reference variance = 0.225366
====================================================
  Execution time = 1.9933e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3491e-01
  Total weights = 2.0000e+06
  Execution time = 1.8492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334985952179
                                         uncertainty =       0.002791292756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334985952179
                                         uncertainty =       0.002791292756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409212246
  error estimate for blocks of size 2^( 2) =       0.000421373960
  error estimate for blocks of size 2^( 3) =       0.000433996467
  error estimate for blocks of size 2^( 4) =       0.000445176485
  error estimate for blocks of size 2^( 5) =       0.000454779964
  error estimate for blocks of size 2^( 6) =       0.000461158306
  error estimate for blocks of size 2^( 7) =       0.000465446422

      target function =                  N/A
              le_mean =     -16.906481397204
             les_mean =     286.164022390695
             stat err =       0.000456640294
             autocorr =       1.245234713569
              std dev =       0.578713507833
             le_variance =       0.334909324148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334986327458
                                         uncertainty =       0.002791295475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334986327458
                                         uncertainty =       0.002791295475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409212475
  error estimate for blocks of size 2^( 2) =       0.000421374187
  error estimate for blocks of size 2^( 3) =       0.000433996687
  error estimate for blocks of size 2^( 4) =       0.000445176705
  error estimate for blocks of size 2^( 5) =       0.000454780165
  error estimate for blocks of size 2^( 6) =       0.000461158510
  error estimate for blocks of size 2^( 7) =       0.000465446635

      target function =                  N/A
              le_mean =     -16.906481392473
             les_mean =     286.164022605773
             stat err =       0.000456640504
             autocorr =       1.245234462153
              std dev =       0.578713831852
             le_variance =       0.334909699176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334986140684
                                         uncertainty =       0.002791294120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334986140684
                                         uncertainty =       0.002791294120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409212361
  error estimate for blocks of size 2^( 2) =       0.000421374074
  error estimate for blocks of size 2^( 3) =       0.000433996577
  error estimate for blocks of size 2^( 4) =       0.000445176596
  error estimate for blocks of size 2^( 5) =       0.000454780065
  error estimate for blocks of size 2^( 6) =       0.000461158408
  error estimate for blocks of size 2^( 7) =       0.000465446529

      target function =                  N/A
              le_mean =     -16.906481394818
             les_mean =     286.164022498401
             stat err =       0.000456640399
             autocorr =       1.245234587383
              std dev =       0.578713670589
             le_variance =       0.334909512527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334985975767
                                         uncertainty =       0.002791292926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334985975767
                                         uncertainty =       0.002791292926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409212260
  error estimate for blocks of size 2^( 2) =       0.000421373974
  error estimate for blocks of size 2^( 3) =       0.000433996480
  error estimate for blocks of size 2^( 4) =       0.000445176499
  error estimate for blocks of size 2^( 5) =       0.000454779976
  error estimate for blocks of size 2^( 6) =       0.000461158318
  error estimate for blocks of size 2^( 7) =       0.000465446435

      target function =                  N/A
              le_mean =     -16.906481396905
             les_mean =     286.164022404153
             stat err =       0.000456640307
             autocorr =       1.245234697784
              std dev =       0.578713528199
             le_variance =       0.334909347720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906481397204        initial  <--
     9.3132e+01     9.3132e+02             2.4734e-06       -16.906481392473
     3.7253e+02     3.7253e+03             6.1841e-07       -16.906481394818
     1.4901e+03     1.4901e+04             1.5461e-07       -16.906481396905

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2543
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.111061e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146717e-02 1 1  ON 2
 uu_3                -2.161981e-02 1 1  ON 3
 uu_4                -6.789835e-02 1 1  ON 4
 uu_5                -1.040405e-01 1 1  ON 5
 uu_6                -1.333986e-01 1 1  ON 6
 uu_7                -1.486963e-01 1 1  ON 7
 uu_8                -1.415406e-01 1 1  ON 8
 uu_9                -1.116067e-01 1 1  ON 9
 ud_0                 4.517975e-01 1 1  ON 10
 ud_1                 1.857791e-01 1 1  ON 11
 ud_2                 6.523085e-02 1 1  ON 12
 ud_3                -6.208055e-03 1 1  ON 13
 ud_4                -6.386612e-02 1 1  ON 14
 ud_5                -1.064715e-01 1 1  ON 15
 ud_6                -1.353103e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547907e-01 1 1  ON 18
 ud_9                -1.443346e-01 1 1  ON 19
 eO_0                -7.534199e-01 1 1  ON 20
 eO_1                -4.319311e-01 1 1  ON 21
 eO_2                -1.711910e-02 1 1  ON 22
 eO_3                 2.995249e-01 1 1  ON 23
 eO_4                 5.275594e-01 1 1  ON 24
 eO_5                 4.928365e-01 1 1  ON 25
 eO_6                 2.675120e-01 1 1  ON 26
 eO_7                -3.851138e-02 1 1  ON 27
 eO_8                -2.366070e-01 1 1  ON 28
 eO_9                -1.050282e-01 1 1  ON 29
eH1_0                -2.613897e-01 1 1  ON 30
eH1_1                -1.560395e-01 1 1  ON 31
eH1_2                -1.069265e-01 1 1  ON 32
eH1_3                -5.147788e-02 1 1  ON 33
eH1_4                -1.896354e-03 1 1  ON 34
eH1_5                 3.378744e-02 1 1  ON 35
eH1_6                 9.534531e-02 1 1  ON 36
eH1_7                 1.573601e-01 1 1  ON 37
eH1_8                 1.940058e-01 1 1  ON 38
eH1_9                 9.580331e-02 1 1  ON 39
eH2_0                -2.608796e-01 1 1  ON 40
eH2_1                -1.549226e-01 1 1  ON 41
eH2_2                -1.056261e-01 1 1  ON 42
eH2_3                -5.017767e-02 1 1  ON 43
eH2_4                -4.286067e-04 1 1  ON 44
eH2_5                 3.598849e-02 1 1  ON 45
eH2_6                 9.731858e-02 1 1  ON 46
eH2_7                 1.586864e-01 1 1  ON 47
eH2_8                 2.004675e-01 1 1  ON 48
eH2_9                 9.150131e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5376e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9008
    reference variance = 0.279964
====================================================
  Execution time = 2.0398e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3340e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333349059033
                                         uncertainty =       0.002980048041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333349059033
                                         uncertainty =       0.002980048041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408289556
  error estimate for blocks of size 2^( 2) =       0.000421519072
  error estimate for blocks of size 2^( 3) =       0.000434953698
  error estimate for blocks of size 2^( 4) =       0.000447170738
  error estimate for blocks of size 2^( 5) =       0.000458530792
  error estimate for blocks of size 2^( 6) =       0.000464486648
  error estimate for blocks of size 2^( 7) =       0.000469672208

      target function =                  N/A
              le_mean =     -16.906646148894
             les_mean =     286.168084559582
             stat err =       0.000459965097
             autocorr =       1.269150760413
              std dev =       0.577408626869
             le_variance =       0.333400722383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690664614889e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906646148894       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906646149433       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906646149664       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906646150275       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906646150120       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906646150447       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906646150603       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 1.978676e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906646148894       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906646149029       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906646149086       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906646149240       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906646149201       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906646149282       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906646149322       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 4.947852e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906646148894       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906646148927       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906646148942       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906646148981       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906646148975       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906646148998       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906646149020       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.237036e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267812 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5989e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.111061e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146718e-02 1 1  ON 2
 uu_3                -2.161982e-02 1 1  ON 3
 uu_4                -6.789833e-02 1 1  ON 4
 uu_5                -1.040405e-01 1 1  ON 5
 uu_6                -1.333986e-01 1 1  ON 6
 uu_7                -1.486963e-01 1 1  ON 7
 uu_8                -1.415406e-01 1 1  ON 8
 uu_9                -1.116067e-01 1 1  ON 9
 ud_0                 4.517976e-01 1 1  ON 10
 ud_1                 1.857791e-01 1 1  ON 11
 ud_2                 6.523085e-02 1 1  ON 12
 ud_3                -6.208053e-03 1 1  ON 13
 ud_4                -6.386613e-02 1 1  ON 14
 ud_5                -1.064715e-01 1 1  ON 15
 ud_6                -1.353103e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547908e-01 1 1  ON 18
 ud_9                -1.443346e-01 1 1  ON 19
 eO_0                -7.534199e-01 1 1  ON 20
 eO_1                -4.319311e-01 1 1  ON 21
 eO_2                -1.711908e-02 1 1  ON 22
 eO_3                 2.995249e-01 1 1  ON 23
 eO_4                 5.275594e-01 1 1  ON 24
 eO_5                 4.928365e-01 1 1  ON 25
 eO_6                 2.675120e-01 1 1  ON 26
 eO_7                -3.851138e-02 1 1  ON 27
 eO_8                -2.366070e-01 1 1  ON 28
 eO_9                -1.050283e-01 1 1  ON 29
eH1_0                -2.613898e-01 1 1  ON 30
eH1_1                -1.560395e-01 1 1  ON 31
eH1_2                -1.069265e-01 1 1  ON 32
eH1_3                -5.147791e-02 1 1  ON 33
eH1_4                -1.896324e-03 1 1  ON 34
eH1_5                 3.378744e-02 1 1  ON 35
eH1_6                 9.534532e-02 1 1  ON 36
eH1_7                 1.573601e-01 1 1  ON 37
eH1_8                 1.940058e-01 1 1  ON 38
eH1_9                 9.580336e-02 1 1  ON 39
eH2_0                -2.608796e-01 1 1  ON 40
eH2_1                -1.549226e-01 1 1  ON 41
eH2_2                -1.056261e-01 1 1  ON 42
eH2_3                -5.017768e-02 1 1  ON 43
eH2_4                -4.285987e-04 1 1  ON 44
eH2_5                 3.598849e-02 1 1  ON 45
eH2_6                 9.731857e-02 1 1  ON 46
eH2_7                 1.586864e-01 1 1  ON 47
eH2_8                 2.004675e-01 1 1  ON 48
eH2_9                 9.150135e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9468
    reference variance = 0.290011
====================================================
  Execution time = 2.2327e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5377e-01
  Total weights = 2.0000e+06
  Execution time = 1.8536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353636280811
                                         uncertainty =       0.012507038947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353636280811
                                         uncertainty =       0.012507038947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420576693
  error estimate for blocks of size 2^( 2) =       0.000433075333
  error estimate for blocks of size 2^( 3) =       0.000446370037
  error estimate for blocks of size 2^( 4) =       0.000459013709
  error estimate for blocks of size 2^( 5) =       0.000468448311
  error estimate for blocks of size 2^( 6) =       0.000478004528
  error estimate for blocks of size 2^( 7) =       0.000479451194

      target function =                  N/A
              le_mean =     -16.905952061115
             les_mean =     286.164984425261
             stat err =       0.000471229436
             autocorr =       1.255377724762
              std dev =       0.594785263302
             le_variance =       0.353769509441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353636476601
                                         uncertainty =       0.012507046309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353636476601
                                         uncertainty =       0.012507046309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420576810
  error estimate for blocks of size 2^( 2) =       0.000433075444
  error estimate for blocks of size 2^( 3) =       0.000446370142
  error estimate for blocks of size 2^( 4) =       0.000459013809
  error estimate for blocks of size 2^( 5) =       0.000468448406
  error estimate for blocks of size 2^( 6) =       0.000478004621
  error estimate for blocks of size 2^( 7) =       0.000479451288

      target function =                  N/A
              le_mean =     -16.905952061351
             les_mean =     286.164984629231
             stat err =       0.000471229531
             autocorr =       1.255377538221
              std dev =       0.594785428055
             le_variance =       0.353769705426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353636378732
                                         uncertainty =       0.012507042629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353636378732
                                         uncertainty =       0.012507042629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420576751
  error estimate for blocks of size 2^( 2) =       0.000433075389
  error estimate for blocks of size 2^( 3) =       0.000446370089
  error estimate for blocks of size 2^( 4) =       0.000459013759
  error estimate for blocks of size 2^( 5) =       0.000468448358
  error estimate for blocks of size 2^( 6) =       0.000478004574
  error estimate for blocks of size 2^( 7) =       0.000479451241

      target function =                  N/A
              le_mean =     -16.905952061233
             les_mean =     286.164984527275
             stat err =       0.000471229483
             autocorr =       1.255377631466
              std dev =       0.594785345701
             le_variance =       0.353769607460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353636293052
                                         uncertainty =       0.012507039407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353636293052
                                         uncertainty =       0.012507039407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420576700
  error estimate for blocks of size 2^( 2) =       0.000433075340
  error estimate for blocks of size 2^( 3) =       0.000446370044
  error estimate for blocks of size 2^( 4) =       0.000459013716
  error estimate for blocks of size 2^( 5) =       0.000468448317
  error estimate for blocks of size 2^( 6) =       0.000478004534
  error estimate for blocks of size 2^( 7) =       0.000479451200

      target function =                  N/A
              le_mean =     -16.905952061129
             les_mean =     286.164984438014
             stat err =       0.000471229442
             autocorr =       1.255377713094
              std dev =       0.594785273603
             le_variance =       0.353769521695


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905952061115        initial
     9.3132e+02     9.3132e+03             1.9787e-07       -16.905952061351  <--
     3.7253e+03     3.7253e+04             4.9479e-08       -16.905952061233
     1.4901e+04     1.4901e+05             1.2370e-08       -16.905952061129

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 3.1666e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.111061e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146719e-02 1 1  ON 2
 uu_3                -2.161984e-02 1 1  ON 3
 uu_4                -6.789827e-02 1 1  ON 4
 uu_5                -1.040404e-01 1 1  ON 5
 uu_6                -1.333987e-01 1 1  ON 6
 uu_7                -1.486964e-01 1 1  ON 7
 uu_8                -1.415407e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517977e-01 1 1  ON 10
 ud_1                 1.857791e-01 1 1  ON 11
 ud_2                 6.523084e-02 1 1  ON 12
 ud_3                -6.208045e-03 1 1  ON 13
 ud_4                -6.386617e-02 1 1  ON 14
 ud_5                -1.064716e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547908e-01 1 1  ON 18
 ud_9                -1.443346e-01 1 1  ON 19
 eO_0                -7.534199e-01 1 1  ON 20
 eO_1                -4.319311e-01 1 1  ON 21
 eO_2                -1.711900e-02 1 1  ON 22
 eO_3                 2.995249e-01 1 1  ON 23
 eO_4                 5.275594e-01 1 1  ON 24
 eO_5                 4.928365e-01 1 1  ON 25
 eO_6                 2.675120e-01 1 1  ON 26
 eO_7                -3.851140e-02 1 1  ON 27
 eO_8                -2.366070e-01 1 1  ON 28
 eO_9                -1.050284e-01 1 1  ON 29
eH1_0                -2.613898e-01 1 1  ON 30
eH1_1                -1.560397e-01 1 1  ON 31
eH1_2                -1.069265e-01 1 1  ON 32
eH1_3                -5.147802e-02 1 1  ON 33
eH1_4                -1.896232e-03 1 1  ON 34
eH1_5                 3.378744e-02 1 1  ON 35
eH1_6                 9.534536e-02 1 1  ON 36
eH1_7                 1.573601e-01 1 1  ON 37
eH1_8                 1.940059e-01 1 1  ON 38
eH1_9                 9.580349e-02 1 1  ON 39
eH2_0                -2.608796e-01 1 1  ON 40
eH2_1                -1.549226e-01 1 1  ON 41
eH2_2                -1.056262e-01 1 1  ON 42
eH2_3                -5.017771e-02 1 1  ON 43
eH2_4                -4.285746e-04 1 1  ON 44
eH2_5                 3.598850e-02 1 1  ON 45
eH2_6                 9.731855e-02 1 1  ON 46
eH2_7                 1.586864e-01 1 1  ON 47
eH2_8                 2.004676e-01 1 1  ON 48
eH2_9                 9.150147e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9434
    reference variance = 0.174435
====================================================
  Execution time = 2.0219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4230e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342374055700
                                         uncertainty =       0.005354779121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342374055700
                                         uncertainty =       0.005354779121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413701469
  error estimate for blocks of size 2^( 2) =       0.000426500023
  error estimate for blocks of size 2^( 3) =       0.000439829045
  error estimate for blocks of size 2^( 4) =       0.000452790727
  error estimate for blocks of size 2^( 5) =       0.000463167605
  error estimate for blocks of size 2^( 6) =       0.000471605941
  error estimate for blocks of size 2^( 7) =       0.000476663377

      target function =                  N/A
              le_mean =     -16.906152021005
             les_mean =     286.160273796630
             stat err =       0.000466056913
             autocorr =       1.269123197146
              std dev =       0.585062227847
             le_variance =       0.342297810453


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615202100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152021005       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152022228       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152020454       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152019402       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152019258       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152019146       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152019469       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 9.518781e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152021005       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152021311       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152020867       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152020604       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152020567       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152020539       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152020620       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.381181e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906152021005       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152021081       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152020970       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152020905       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152020895       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906152020887       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152020909       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.953882e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5765e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.111060e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146720e-02 1 1  ON 2
 uu_3                -2.161984e-02 1 1  ON 3
 uu_4                -6.789843e-02 1 1  ON 4
 uu_5                -1.040404e-01 1 1  ON 5
 uu_6                -1.333985e-01 1 1  ON 6
 uu_7                -1.486964e-01 1 1  ON 7
 uu_8                -1.415407e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517977e-01 1 1  ON 10
 ud_1                 1.857792e-01 1 1  ON 11
 ud_2                 6.523077e-02 1 1  ON 12
 ud_3                -6.207989e-03 1 1  ON 13
 ud_4                -6.386615e-02 1 1  ON 14
 ud_5                -1.064717e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547907e-01 1 1  ON 18
 ud_9                -1.443346e-01 1 1  ON 19
 eO_0                -7.534200e-01 1 1  ON 20
 eO_1                -4.319311e-01 1 1  ON 21
 eO_2                -1.711907e-02 1 1  ON 22
 eO_3                 2.995250e-01 1 1  ON 23
 eO_4                 5.275595e-01 1 1  ON 24
 eO_5                 4.928366e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851140e-02 1 1  ON 27
 eO_8                -2.366071e-01 1 1  ON 28
 eO_9                -1.050285e-01 1 1  ON 29
eH1_0                -2.613899e-01 1 1  ON 30
eH1_1                -1.560396e-01 1 1  ON 31
eH1_2                -1.069267e-01 1 1  ON 32
eH1_3                -5.147807e-02 1 1  ON 33
eH1_4                -1.896293e-03 1 1  ON 34
eH1_5                 3.378742e-02 1 1  ON 35
eH1_6                 9.534538e-02 1 1  ON 36
eH1_7                 1.573601e-01 1 1  ON 37
eH1_8                 1.940060e-01 1 1  ON 38
eH1_9                 9.580367e-02 1 1  ON 39
eH2_0                -2.608796e-01 1 1  ON 40
eH2_1                -1.549227e-01 1 1  ON 41
eH2_2                -1.056264e-01 1 1  ON 42
eH2_3                -5.017787e-02 1 1  ON 43
eH2_4                -4.285597e-04 1 1  ON 44
eH2_5                 3.598844e-02 1 1  ON 45
eH2_6                 9.731859e-02 1 1  ON 46
eH2_7                 1.586865e-01 1 1  ON 47
eH2_8                 2.004676e-01 1 1  ON 48
eH2_9                 9.150165e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8922
    reference variance = 0.225765
====================================================
  Execution time = 1.9820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3178e-01
  Total weights = 2.0000e+06
  Execution time = 1.8567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790758306
                                         uncertainty =       0.002707933651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790758306
                                         uncertainty =       0.002707933651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407296977
  error estimate for blocks of size 2^( 2) =       0.000419811422
  error estimate for blocks of size 2^( 3) =       0.000432479591
  error estimate for blocks of size 2^( 4) =       0.000443924451
  error estimate for blocks of size 2^( 5) =       0.000452706919
  error estimate for blocks of size 2^( 6) =       0.000457465883
  error estimate for blocks of size 2^( 7) =       0.000460130667

      target function =                  N/A
              le_mean =     -16.906327972495
             les_mean =     286.155707002335
             stat err =       0.000453556980
             autocorr =       1.240056110467
              std dev =       0.576004908525
             le_variance =       0.331781654645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790933060
                                         uncertainty =       0.002707938887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790933060
                                         uncertainty =       0.002707938887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407297084
  error estimate for blocks of size 2^( 2) =       0.000419811524
  error estimate for blocks of size 2^( 3) =       0.000432479684
  error estimate for blocks of size 2^( 4) =       0.000443924534
  error estimate for blocks of size 2^( 5) =       0.000452706999
  error estimate for blocks of size 2^( 6) =       0.000457465940
  error estimate for blocks of size 2^( 7) =       0.000460130695

      target function =                  N/A
              le_mean =     -16.906327976496
             les_mean =     286.155707312247
             stat err =       0.000453557042
             autocorr =       1.240055796135
              std dev =       0.576005060130
             le_variance =       0.331781829296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790845766
                                         uncertainty =       0.002707936272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790845766
                                         uncertainty =       0.002707936272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407297030
  error estimate for blocks of size 2^( 2) =       0.000419811473
  error estimate for blocks of size 2^( 3) =       0.000432479637
  error estimate for blocks of size 2^( 4) =       0.000443924492
  error estimate for blocks of size 2^( 5) =       0.000452706959
  error estimate for blocks of size 2^( 6) =       0.000457465911
  error estimate for blocks of size 2^( 7) =       0.000460130681

      target function =                  N/A
              le_mean =     -16.906327974496
             les_mean =     286.155707157391
             stat err =       0.000453557011
             autocorr =       1.240055953143
              std dev =       0.576004984400
             le_variance =       0.331781742054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790769241
                                         uncertainty =       0.002707933979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790769241
                                         uncertainty =       0.002707933979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407296984
  error estimate for blocks of size 2^( 2) =       0.000419811428
  error estimate for blocks of size 2^( 3) =       0.000432479597
  error estimate for blocks of size 2^( 4) =       0.000443924456
  error estimate for blocks of size 2^( 5) =       0.000452706924
  error estimate for blocks of size 2^( 6) =       0.000457465886
  error estimate for blocks of size 2^( 7) =       0.000460130669

      target function =                  N/A
              le_mean =     -16.906327972745
             les_mean =     286.155707021718
             stat err =       0.000453556984
             autocorr =       1.240056090796
              std dev =       0.576004918011
             le_variance =       0.331781665573


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906327972495        initial
     2.3283e+02     2.3283e+03             9.5188e-07       -16.906327976496  <--
     9.3132e+02     9.3132e+03             2.3812e-07       -16.906327974496
     3.7253e+03     3.7253e+04             5.9539e-08       -16.906327972745

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 2.9269e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.111059e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146726e-02 1 1  ON 2
 uu_3                -2.161982e-02 1 1  ON 3
 uu_4                -6.789891e-02 1 1  ON 4
 uu_5                -1.040403e-01 1 1  ON 5
 uu_6                -1.333982e-01 1 1  ON 6
 uu_7                -1.486965e-01 1 1  ON 7
 uu_8                -1.415408e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517977e-01 1 1  ON 10
 ud_1                 1.857793e-01 1 1  ON 11
 ud_2                 6.523055e-02 1 1  ON 12
 ud_3                -6.207823e-03 1 1  ON 13
 ud_4                -6.386610e-02 1 1  ON 14
 ud_5                -1.064719e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547905e-01 1 1  ON 18
 ud_9                -1.443345e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319309e-01 1 1  ON 21
 eO_2                -1.711926e-02 1 1  ON 22
 eO_3                 2.995254e-01 1 1  ON 23
 eO_4                 5.275598e-01 1 1  ON 24
 eO_5                 4.928369e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851143e-02 1 1  ON 27
 eO_8                -2.366073e-01 1 1  ON 28
 eO_9                -1.050289e-01 1 1  ON 29
eH1_0                -2.613900e-01 1 1  ON 30
eH1_1                -1.560396e-01 1 1  ON 31
eH1_2                -1.069274e-01 1 1  ON 32
eH1_3                -5.147821e-02 1 1  ON 33
eH1_4                -1.896475e-03 1 1  ON 34
eH1_5                 3.378736e-02 1 1  ON 35
eH1_6                 9.534544e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940064e-01 1 1  ON 38
eH1_9                 9.580420e-02 1 1  ON 39
eH2_0                -2.608797e-01 1 1  ON 40
eH2_1                -1.549228e-01 1 1  ON 41
eH2_2                -1.056267e-01 1 1  ON 42
eH2_3                -5.017834e-02 1 1  ON 43
eH2_4                -4.285150e-04 1 1  ON 44
eH2_5                 3.598826e-02 1 1  ON 45
eH2_6                 9.731870e-02 1 1  ON 46
eH2_7                 1.586867e-01 1 1  ON 47
eH2_8                 2.004678e-01 1 1  ON 48
eH2_9                 9.150219e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5041e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8591
    reference variance = 0.190887
====================================================
  Execution time = 2.0059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3304e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333074547277
                                         uncertainty =       0.002116488207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333074547277
                                         uncertainty =       0.002116488207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408066860
  error estimate for blocks of size 2^( 2) =       0.000420847564
  error estimate for blocks of size 2^( 3) =       0.000434233742
  error estimate for blocks of size 2^( 4) =       0.000446496109
  error estimate for blocks of size 2^( 5) =       0.000456616055
  error estimate for blocks of size 2^( 6) =       0.000464905521
  error estimate for blocks of size 2^( 7) =       0.000468908274

      target function =                  N/A
              le_mean =     -16.906977785623
             les_mean =     286.178934801124
             stat err =       0.000459231490
             autocorr =       1.266486802188
              std dev =       0.577093687442
             le_variance =       0.333037124085


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690697778562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906977785623       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906977806817       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906977820041       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906977820671       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906977825867       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906977828156       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906977826666       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906977825106       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 4.376194e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906977785623       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906977790936       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906977794260       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906977794419       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906977795729       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906977796305       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906977795942       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906977795544       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 1.094810e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906977785623       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906977786952       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906977787784       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906977787824       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906977788153       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906977788297       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906977788207       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906977788108       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.737502e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5669e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.111061e-01 1 1  ON 0
 uu_1                 1.435974e-01 1 1  ON 1
 uu_2                 4.146707e-02 1 1  ON 2
 uu_3                -2.161955e-02 1 1  ON 3
 uu_4                -6.789875e-02 1 1  ON 4
 uu_5                -1.040400e-01 1 1  ON 5
 uu_6                -1.333977e-01 1 1  ON 6
 uu_7                -1.486964e-01 1 1  ON 7
 uu_8                -1.415419e-01 1 1  ON 8
 uu_9                -1.116075e-01 1 1  ON 9
 ud_0                 4.517976e-01 1 1  ON 10
 ud_1                 1.857801e-01 1 1  ON 11
 ud_2                 6.523109e-02 1 1  ON 12
 ud_3                -6.207865e-03 1 1  ON 13
 ud_4                -6.386538e-02 1 1  ON 14
 ud_5                -1.064717e-01 1 1  ON 15
 ud_6                -1.353098e-01 1 1  ON 16
 ud_7                -1.533982e-01 1 1  ON 17
 ud_8                -1.547916e-01 1 1  ON 18
 ud_9                -1.443355e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319305e-01 1 1  ON 21
 eO_2                -1.711905e-02 1 1  ON 22
 eO_3                 2.995256e-01 1 1  ON 23
 eO_4                 5.275601e-01 1 1  ON 24
 eO_5                 4.928371e-01 1 1  ON 25
 eO_6                 2.675122e-01 1 1  ON 26
 eO_7                -3.851143e-02 1 1  ON 27
 eO_8                -2.366082e-01 1 1  ON 28
 eO_9                -1.050295e-01 1 1  ON 29
eH1_0                -2.613901e-01 1 1  ON 30
eH1_1                -1.560400e-01 1 1  ON 31
eH1_2                -1.069281e-01 1 1  ON 32
eH1_3                -5.147822e-02 1 1  ON 33
eH1_4                -1.896434e-03 1 1  ON 34
eH1_5                 3.378739e-02 1 1  ON 35
eH1_6                 9.534565e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940067e-01 1 1  ON 38
eH1_9                 9.580475e-02 1 1  ON 39
eH2_0                -2.608799e-01 1 1  ON 40
eH2_1                -1.549229e-01 1 1  ON 41
eH2_2                -1.056272e-01 1 1  ON 42
eH2_3                -5.017793e-02 1 1  ON 43
eH2_4                -4.289760e-04 1 1  ON 44
eH2_5                 3.598833e-02 1 1  ON 45
eH2_6                 9.731876e-02 1 1  ON 46
eH2_7                 1.586867e-01 1 1  ON 47
eH2_8                 2.004680e-01 1 1  ON 48
eH2_9                 9.150276e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.876
    reference variance = 0.265357
====================================================
  Execution time = 2.0267e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3766e-01
  Total weights = 2.0000e+06
  Execution time = 1.8520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337754540382
                                         uncertainty =       0.004150417976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337754540382
                                         uncertainty =       0.004150417976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410886973
  error estimate for blocks of size 2^( 2) =       0.000423618830
  error estimate for blocks of size 2^( 3) =       0.000436768853
  error estimate for blocks of size 2^( 4) =       0.000448094219
  error estimate for blocks of size 2^( 5) =       0.000458147853
  error estimate for blocks of size 2^( 6) =       0.000466829850
  error estimate for blocks of size 2^( 7) =       0.000471833254

      target function =                  N/A
              le_mean =     -16.906931875943
             les_mean =     286.182001498910
             stat err =       0.000461226294
             autocorr =       1.260037208714
              std dev =       0.581081930516
             le_variance =       0.337656209972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337753187216
                                         uncertainty =       0.004150411997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337753187216
                                         uncertainty =       0.004150411997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410886151
  error estimate for blocks of size 2^( 2) =       0.000423618012
  error estimate for blocks of size 2^( 3) =       0.000436768007
  error estimate for blocks of size 2^( 4) =       0.000448093339
  error estimate for blocks of size 2^( 5) =       0.000458146997
  error estimate for blocks of size 2^( 6) =       0.000466829007
  error estimate for blocks of size 2^( 7) =       0.000471832436

      target function =                  N/A
              le_mean =     -16.906931858281
             les_mean =     286.181999549402
             stat err =       0.000461225445
             autocorr =       1.260037614817
              std dev =       0.581080766907
             le_variance =       0.337654857669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337753856586
                                         uncertainty =       0.004150414934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337753856586
                                         uncertainty =       0.004150414934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410886558
  error estimate for blocks of size 2^( 2) =       0.000423618417
  error estimate for blocks of size 2^( 3) =       0.000436768426
  error estimate for blocks of size 2^( 4) =       0.000448093775
  error estimate for blocks of size 2^( 5) =       0.000458147421
  error estimate for blocks of size 2^( 6) =       0.000466829424
  error estimate for blocks of size 2^( 7) =       0.000471832841

      target function =                  N/A
              le_mean =     -16.906931867058
             les_mean =     286.182000515114
             stat err =       0.000461225865
             autocorr =       1.260037416775
              std dev =       0.581081342505
             le_variance =       0.337655526608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337754454672
                                         uncertainty =       0.004150417594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337754454672
                                         uncertainty =       0.004150417594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410886921
  error estimate for blocks of size 2^( 2) =       0.000423618778
  error estimate for blocks of size 2^( 3) =       0.000436768800
  error estimate for blocks of size 2^( 4) =       0.000448094164
  error estimate for blocks of size 2^( 5) =       0.000458147798
  error estimate for blocks of size 2^( 6) =       0.000466829796
  error estimate for blocks of size 2^( 7) =       0.000471833202

      target function =                  N/A
              le_mean =     -16.906931874829
             les_mean =     286.182001375604
             stat err =       0.000461226240
             autocorr =       1.260037234888
              std dev =       0.581081856812
             le_variance =       0.337656124316


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906931875943        initial  <--
     5.8208e+01     5.8208e+02             4.3762e-06       -16.906931858281
     2.3283e+02     2.3283e+03             1.0948e-06       -16.906931867058
     9.3132e+02     9.3132e+03             2.7375e-07       -16.906931874829

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5933
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.111059e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146726e-02 1 1  ON 2
 uu_3                -2.161982e-02 1 1  ON 3
 uu_4                -6.789891e-02 1 1  ON 4
 uu_5                -1.040403e-01 1 1  ON 5
 uu_6                -1.333982e-01 1 1  ON 6
 uu_7                -1.486965e-01 1 1  ON 7
 uu_8                -1.415408e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517977e-01 1 1  ON 10
 ud_1                 1.857793e-01 1 1  ON 11
 ud_2                 6.523055e-02 1 1  ON 12
 ud_3                -6.207823e-03 1 1  ON 13
 ud_4                -6.386610e-02 1 1  ON 14
 ud_5                -1.064719e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547905e-01 1 1  ON 18
 ud_9                -1.443345e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319309e-01 1 1  ON 21
 eO_2                -1.711926e-02 1 1  ON 22
 eO_3                 2.995254e-01 1 1  ON 23
 eO_4                 5.275598e-01 1 1  ON 24
 eO_5                 4.928369e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851143e-02 1 1  ON 27
 eO_8                -2.366073e-01 1 1  ON 28
 eO_9                -1.050289e-01 1 1  ON 29
eH1_0                -2.613900e-01 1 1  ON 30
eH1_1                -1.560396e-01 1 1  ON 31
eH1_2                -1.069274e-01 1 1  ON 32
eH1_3                -5.147821e-02 1 1  ON 33
eH1_4                -1.896475e-03 1 1  ON 34
eH1_5                 3.378736e-02 1 1  ON 35
eH1_6                 9.534544e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940064e-01 1 1  ON 38
eH1_9                 9.580420e-02 1 1  ON 39
eH2_0                -2.608797e-01 1 1  ON 40
eH2_1                -1.549228e-01 1 1  ON 41
eH2_2                -1.056267e-01 1 1  ON 42
eH2_3                -5.017834e-02 1 1  ON 43
eH2_4                -4.285150e-04 1 1  ON 44
eH2_5                 3.598826e-02 1 1  ON 45
eH2_6                 9.731870e-02 1 1  ON 46
eH2_7                 1.586867e-01 1 1  ON 47
eH2_8                 2.004678e-01 1 1  ON 48
eH2_9                 9.150219e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5269e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8341
    reference variance = 0.155268
====================================================
  Execution time = 2.0298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4978e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349834078194
                                         uncertainty =       0.016322999819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349834078194
                                         uncertainty =       0.016322999819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418198389
  error estimate for blocks of size 2^( 2) =       0.000430814223
  error estimate for blocks of size 2^( 3) =       0.000443473524
  error estimate for blocks of size 2^( 4) =       0.000456694873
  error estimate for blocks of size 2^( 5) =       0.000467920884
  error estimate for blocks of size 2^( 6) =       0.000475157168
  error estimate for blocks of size 2^( 7) =       0.000480491101

      target function =                  N/A
              le_mean =     -16.906571716207
             les_mean =     286.181946805036
             stat err =       0.000470066007
             autocorr =       1.263435226043
              std dev =       0.591421833101
             le_variance =       0.349779784668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690657171621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906571716207       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906571717608       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906571718657       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906571718782       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906571718283       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906571718355       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906571718402       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906571718273       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.862978e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906571716207       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906571716557       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906571716820       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906571716851       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906571716726       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906571716745       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906571716756       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906571716724       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 9.660563e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906571716207       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906571716295       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906571716360       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906571716367       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906571716344       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906571716345       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906571716347       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906571716330       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.415336e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5866e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.111058e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146724e-02 1 1  ON 2
 uu_3                -2.161980e-02 1 1  ON 3
 uu_4                -6.789892e-02 1 1  ON 4
 uu_5                -1.040403e-01 1 1  ON 5
 uu_6                -1.333982e-01 1 1  ON 6
 uu_7                -1.486965e-01 1 1  ON 7
 uu_8                -1.415408e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517977e-01 1 1  ON 10
 ud_1                 1.857793e-01 1 1  ON 11
 ud_2                 6.523056e-02 1 1  ON 12
 ud_3                -6.207818e-03 1 1  ON 13
 ud_4                -6.386612e-02 1 1  ON 14
 ud_5                -1.064719e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533986e-01 1 1  ON 17
 ud_8                -1.547905e-01 1 1  ON 18
 ud_9                -1.443345e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319309e-01 1 1  ON 21
 eO_2                -1.711928e-02 1 1  ON 22
 eO_3                 2.995254e-01 1 1  ON 23
 eO_4                 5.275599e-01 1 1  ON 24
 eO_5                 4.928370e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851145e-02 1 1  ON 27
 eO_8                -2.366074e-01 1 1  ON 28
 eO_9                -1.050289e-01 1 1  ON 29
eH1_0                -2.613900e-01 1 1  ON 30
eH1_1                -1.560396e-01 1 1  ON 31
eH1_2                -1.069275e-01 1 1  ON 32
eH1_3                -5.147822e-02 1 1  ON 33
eH1_4                -1.896482e-03 1 1  ON 34
eH1_5                 3.378735e-02 1 1  ON 35
eH1_6                 9.534546e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940064e-01 1 1  ON 38
eH1_9                 9.580426e-02 1 1  ON 39
eH2_0                -2.608797e-01 1 1  ON 40
eH2_1                -1.549228e-01 1 1  ON 41
eH2_2                -1.056268e-01 1 1  ON 42
eH2_3                -5.017833e-02 1 1  ON 43
eH2_4                -4.285365e-04 1 1  ON 44
eH2_5                 3.598827e-02 1 1  ON 45
eH2_6                 9.731870e-02 1 1  ON 46
eH2_7                 1.586867e-01 1 1  ON 47
eH2_8                 2.004679e-01 1 1  ON 48
eH2_9                 9.150226e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8418
    reference variance = 0.24516
====================================================
  Execution time = 2.0233e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3886e-01
  Total weights = 2.0000e+06
  Execution time = 1.8605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876910012
                                         uncertainty =       0.004197188516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876910012
                                         uncertainty =       0.004197188516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411621300
  error estimate for blocks of size 2^( 2) =       0.000424654351
  error estimate for blocks of size 2^( 3) =       0.000437935548
  error estimate for blocks of size 2^( 4) =       0.000451625652
  error estimate for blocks of size 2^( 5) =       0.000463543747
  error estimate for blocks of size 2^( 6) =       0.000472916015
  error estimate for blocks of size 2^( 7) =       0.000479994793

      target function =                  N/A
              le_mean =     -16.906245635967
             les_mean =     286.160005523283
             stat err =       0.000467020052
             autocorr =       1.287286977141
              std dev =       0.582120424868
             le_variance =       0.338864189048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876818899
                                         uncertainty =       0.004197184467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876818899
                                         uncertainty =       0.004197184467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411621245
  error estimate for blocks of size 2^( 2) =       0.000424654297
  error estimate for blocks of size 2^( 3) =       0.000437935495
  error estimate for blocks of size 2^( 4) =       0.000451625595
  error estimate for blocks of size 2^( 5) =       0.000463543684
  error estimate for blocks of size 2^( 6) =       0.000472915946
  error estimate for blocks of size 2^( 7) =       0.000479994723

      target function =                  N/A
              le_mean =     -16.906245634544
             les_mean =     286.160005384167
             stat err =       0.000467019987
             autocorr =       1.287286965446
              std dev =       0.582120346703
             le_variance =       0.338864098046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876864416
                                         uncertainty =       0.004197186490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876864416
                                         uncertainty =       0.004197186490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411621272
  error estimate for blocks of size 2^( 2) =       0.000424654324
  error estimate for blocks of size 2^( 3) =       0.000437935522
  error estimate for blocks of size 2^( 4) =       0.000451625624
  error estimate for blocks of size 2^( 5) =       0.000463543715
  error estimate for blocks of size 2^( 6) =       0.000472915980
  error estimate for blocks of size 2^( 7) =       0.000479994758

      target function =                  N/A
              le_mean =     -16.906245635255
             les_mean =     286.160005453663
             stat err =       0.000467020019
             autocorr =       1.287286971310
              std dev =       0.582120385751
             le_variance =       0.338864143507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876904311
                                         uncertainty =       0.004197188263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338876904311
                                         uncertainty =       0.004197188263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411621296
  error estimate for blocks of size 2^( 2) =       0.000424654347
  error estimate for blocks of size 2^( 3) =       0.000437935545
  error estimate for blocks of size 2^( 4) =       0.000451625649
  error estimate for blocks of size 2^( 5) =       0.000463543743
  error estimate for blocks of size 2^( 6) =       0.000472916010
  error estimate for blocks of size 2^( 7) =       0.000479994789

      target function =                  N/A
              le_mean =     -16.906245635878
             les_mean =     286.160005514578
             stat err =       0.000467020048
             autocorr =       1.287286976417
              std dev =       0.582120419977
             le_variance =       0.338864183354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906245635967        initial  <--
     5.8208e+02     5.8208e+03             3.8630e-07       -16.906245634544
     2.3283e+03     2.3283e+04             9.6606e-08       -16.906245635255
     9.3132e+03     9.3132e+04             2.4153e-08       -16.906245635878

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6013
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.111059e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146726e-02 1 1  ON 2
 uu_3                -2.161982e-02 1 1  ON 3
 uu_4                -6.789891e-02 1 1  ON 4
 uu_5                -1.040403e-01 1 1  ON 5
 uu_6                -1.333982e-01 1 1  ON 6
 uu_7                -1.486965e-01 1 1  ON 7
 uu_8                -1.415408e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517977e-01 1 1  ON 10
 ud_1                 1.857793e-01 1 1  ON 11
 ud_2                 6.523055e-02 1 1  ON 12
 ud_3                -6.207823e-03 1 1  ON 13
 ud_4                -6.386610e-02 1 1  ON 14
 ud_5                -1.064719e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547905e-01 1 1  ON 18
 ud_9                -1.443345e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319309e-01 1 1  ON 21
 eO_2                -1.711926e-02 1 1  ON 22
 eO_3                 2.995254e-01 1 1  ON 23
 eO_4                 5.275598e-01 1 1  ON 24
 eO_5                 4.928369e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851143e-02 1 1  ON 27
 eO_8                -2.366073e-01 1 1  ON 28
 eO_9                -1.050289e-01 1 1  ON 29
eH1_0                -2.613900e-01 1 1  ON 30
eH1_1                -1.560396e-01 1 1  ON 31
eH1_2                -1.069274e-01 1 1  ON 32
eH1_3                -5.147821e-02 1 1  ON 33
eH1_4                -1.896475e-03 1 1  ON 34
eH1_5                 3.378736e-02 1 1  ON 35
eH1_6                 9.534544e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940064e-01 1 1  ON 38
eH1_9                 9.580420e-02 1 1  ON 39
eH2_0                -2.608797e-01 1 1  ON 40
eH2_1                -1.549228e-01 1 1  ON 41
eH2_2                -1.056267e-01 1 1  ON 42
eH2_3                -5.017834e-02 1 1  ON 43
eH2_4                -4.285150e-04 1 1  ON 44
eH2_5                 3.598826e-02 1 1  ON 45
eH2_6                 9.731870e-02 1 1  ON 46
eH2_7                 1.586867e-01 1 1  ON 47
eH2_8                 2.004678e-01 1 1  ON 48
eH2_9                 9.150219e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5473e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8307
    reference variance = 0.247182
====================================================
  Execution time = 2.0192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4340e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343506466302
                                         uncertainty =       0.005447138824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343506466302
                                         uncertainty =       0.005447138824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414367133
  error estimate for blocks of size 2^( 2) =       0.000427236799
  error estimate for blocks of size 2^( 3) =       0.000440319379
  error estimate for blocks of size 2^( 4) =       0.000452327722
  error estimate for blocks of size 2^( 5) =       0.000462768009
  error estimate for blocks of size 2^( 6) =       0.000471197395
  error estimate for blocks of size 2^( 7) =       0.000476670389

      target function =                  N/A
              le_mean =     -16.906733234719
             les_mean =     286.181028739356
             stat err =       0.000465740879
             autocorr =       1.263333803672
              std dev =       0.586003618664
             le_variance =       0.343400241087


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690673323472e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906733234719       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906733234806       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906733234887       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906733234920       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906733234941       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906733234939       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906733234985       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.271046e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906733234719       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906733234741       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906733234761       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906733234774       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906733234794       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906733234776       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906733234786       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 8.177651e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906733234719       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906733234725       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906733234730       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906733234735       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906733234772       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906733234715       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906733234755       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.044415e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277515 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5870e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.111059e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146725e-02 1 1  ON 2
 uu_3                -2.161982e-02 1 1  ON 3
 uu_4                -6.789891e-02 1 1  ON 4
 uu_5                -1.040403e-01 1 1  ON 5
 uu_6                -1.333982e-01 1 1  ON 6
 uu_7                -1.486965e-01 1 1  ON 7
 uu_8                -1.415408e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517977e-01 1 1  ON 10
 ud_1                 1.857793e-01 1 1  ON 11
 ud_2                 6.523055e-02 1 1  ON 12
 ud_3                -6.207820e-03 1 1  ON 13
 ud_4                -6.386610e-02 1 1  ON 14
 ud_5                -1.064719e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547905e-01 1 1  ON 18
 ud_9                -1.443345e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319309e-01 1 1  ON 21
 eO_2                -1.711925e-02 1 1  ON 22
 eO_3                 2.995254e-01 1 1  ON 23
 eO_4                 5.275598e-01 1 1  ON 24
 eO_5                 4.928369e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851142e-02 1 1  ON 27
 eO_8                -2.366073e-01 1 1  ON 28
 eO_9                -1.050289e-01 1 1  ON 29
eH1_0                -2.613900e-01 1 1  ON 30
eH1_1                -1.560396e-01 1 1  ON 31
eH1_2                -1.069274e-01 1 1  ON 32
eH1_3                -5.147821e-02 1 1  ON 33
eH1_4                -1.896471e-03 1 1  ON 34
eH1_5                 3.378736e-02 1 1  ON 35
eH1_6                 9.534543e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940064e-01 1 1  ON 38
eH1_9                 9.580421e-02 1 1  ON 39
eH2_0                -2.608797e-01 1 1  ON 40
eH2_1                -1.549228e-01 1 1  ON 41
eH2_2                -1.056267e-01 1 1  ON 42
eH2_3                -5.017834e-02 1 1  ON 43
eH2_4                -4.285178e-04 1 1  ON 44
eH2_5                 3.598826e-02 1 1  ON 45
eH2_6                 9.731870e-02 1 1  ON 46
eH2_7                 1.586867e-01 1 1  ON 47
eH2_8                 2.004678e-01 1 1  ON 48
eH2_9                 9.150220e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9372
    reference variance = 0.304958
====================================================
  Execution time = 2.0047e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3418e-01
  Total weights = 2.0000e+06
  Execution time = 1.8484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334023779575
                                         uncertainty =       0.002637593911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334023779575
                                         uncertainty =       0.002637593911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408768122
  error estimate for blocks of size 2^( 2) =       0.000421740647
  error estimate for blocks of size 2^( 3) =       0.000434895861
  error estimate for blocks of size 2^( 4) =       0.000446630030
  error estimate for blocks of size 2^( 5) =       0.000458408275
  error estimate for blocks of size 2^( 6) =       0.000468006969
  error estimate for blocks of size 2^( 7) =       0.000473555479

      target function =                  N/A
              le_mean =     -16.905820957990
             les_mean =     286.140964851269
             stat err =       0.000461650188
             autocorr =       1.275475129276
              std dev =       0.578085421681
             le_variance =       0.334182754760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334023797373
                                         uncertainty =       0.002637594124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334023797373
                                         uncertainty =       0.002637594124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408768133
  error estimate for blocks of size 2^( 2) =       0.000421740657
  error estimate for blocks of size 2^( 3) =       0.000434895871
  error estimate for blocks of size 2^( 4) =       0.000446630039
  error estimate for blocks of size 2^( 5) =       0.000458408284
  error estimate for blocks of size 2^( 6) =       0.000468006977
  error estimate for blocks of size 2^( 7) =       0.000473555488

      target function =                  N/A
              le_mean =     -16.905820958089
             les_mean =     286.140964872437
             stat err =       0.000461650197
             autocorr =       1.275475109620
              std dev =       0.578085437076
             le_variance =       0.334182772559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334023788475
                                         uncertainty =       0.002637594018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334023788475
                                         uncertainty =       0.002637594018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408768127
  error estimate for blocks of size 2^( 2) =       0.000421740652
  error estimate for blocks of size 2^( 3) =       0.000434895866
  error estimate for blocks of size 2^( 4) =       0.000446630034
  error estimate for blocks of size 2^( 5) =       0.000458408279
  error estimate for blocks of size 2^( 6) =       0.000468006973
  error estimate for blocks of size 2^( 7) =       0.000473555483

      target function =                  N/A
              le_mean =     -16.905820958039
             les_mean =     286.140964861853
             stat err =       0.000461650192
             autocorr =       1.275475119445
              std dev =       0.578085429379
             le_variance =       0.334182763660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334023780687
                                         uncertainty =       0.002637593924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334023780687
                                         uncertainty =       0.002637593924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408768122
  error estimate for blocks of size 2^( 2) =       0.000421740648
  error estimate for blocks of size 2^( 3) =       0.000434895862
  error estimate for blocks of size 2^( 4) =       0.000446630030
  error estimate for blocks of size 2^( 5) =       0.000458408275
  error estimate for blocks of size 2^( 6) =       0.000468006969
  error estimate for blocks of size 2^( 7) =       0.000473555480

      target function =                  N/A
              le_mean =     -16.905820957996
             les_mean =     286.140964852592
             stat err =       0.000461650189
             autocorr =       1.275475128051
              std dev =       0.578085422643
             le_variance =       0.334182755872


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905820957990        initial
     5.8208e+03     5.8208e+04             3.2710e-08       -16.905820958089  <--
     2.3283e+04     2.3283e+05             8.1777e-09       -16.905820958039
     9.3132e+04     9.3132e+05             2.0444e-09       -16.905820957996

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 2.9379e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.111059e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146725e-02 1 1  ON 2
 uu_3                -2.161982e-02 1 1  ON 3
 uu_4                -6.789891e-02 1 1  ON 4
 uu_5                -1.040403e-01 1 1  ON 5
 uu_6                -1.333982e-01 1 1  ON 6
 uu_7                -1.486965e-01 1 1  ON 7
 uu_8                -1.415408e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517977e-01 1 1  ON 10
 ud_1                 1.857793e-01 1 1  ON 11
 ud_2                 6.523056e-02 1 1  ON 12
 ud_3                -6.207809e-03 1 1  ON 13
 ud_4                -6.386609e-02 1 1  ON 14
 ud_5                -1.064718e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547905e-01 1 1  ON 18
 ud_9                -1.443345e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319309e-01 1 1  ON 21
 eO_2                -1.711924e-02 1 1  ON 22
 eO_3                 2.995254e-01 1 1  ON 23
 eO_4                 5.275598e-01 1 1  ON 24
 eO_5                 4.928369e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851142e-02 1 1  ON 27
 eO_8                -2.366073e-01 1 1  ON 28
 eO_9                -1.050289e-01 1 1  ON 29
eH1_0                -2.613900e-01 1 1  ON 30
eH1_1                -1.560396e-01 1 1  ON 31
eH1_2                -1.069274e-01 1 1  ON 32
eH1_3                -5.147822e-02 1 1  ON 33
eH1_4                -1.896461e-03 1 1  ON 34
eH1_5                 3.378736e-02 1 1  ON 35
eH1_6                 9.534543e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940064e-01 1 1  ON 38
eH1_9                 9.580422e-02 1 1  ON 39
eH2_0                -2.608797e-01 1 1  ON 40
eH2_1                -1.549228e-01 1 1  ON 41
eH2_2                -1.056267e-01 1 1  ON 42
eH2_3                -5.017835e-02 1 1  ON 43
eH2_4                -4.285259e-04 1 1  ON 44
eH2_5                 3.598826e-02 1 1  ON 45
eH2_6                 9.731871e-02 1 1  ON 46
eH2_7                 1.586867e-01 1 1  ON 47
eH2_8                 2.004679e-01 1 1  ON 48
eH2_9                 9.150222e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5257e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9708
    reference variance = 0.307523
====================================================
  Execution time = 2.0237e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3782e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337925896573
                                         uncertainty =       0.003414960890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337925896573
                                         uncertainty =       0.003414960890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410987150
  error estimate for blocks of size 2^( 2) =       0.000423512597
  error estimate for blocks of size 2^( 3) =       0.000436352757
  error estimate for blocks of size 2^( 4) =       0.000448109299
  error estimate for blocks of size 2^( 5) =       0.000459053411
  error estimate for blocks of size 2^( 6) =       0.000467684293
  error estimate for blocks of size 2^( 7) =       0.000473059875

      target function =                  N/A
              le_mean =     -16.906702929057
             les_mean =     286.174424637365
             stat err =       0.000461976720
             autocorr =       1.263524579787
              std dev =       0.581223601452
             le_variance =       0.337820874885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690670292906e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906702929057       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906702928983       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906702929188       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906702929407       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906702929395       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906702929543       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906702929551       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.170773e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906702929057       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906702929039       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906702929090       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906702929145       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906702929141       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906702929178       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906702929182       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 2.927045e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906702929057       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906702929053       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906702929065       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906702929079       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906702929075       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906702929083       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906702929083       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 7.317682e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5839e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.111059e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146724e-02 1 1  ON 2
 uu_3                -2.161982e-02 1 1  ON 3
 uu_4                -6.789891e-02 1 1  ON 4
 uu_5                -1.040403e-01 1 1  ON 5
 uu_6                -1.333981e-01 1 1  ON 6
 uu_7                -1.486965e-01 1 1  ON 7
 uu_8                -1.415408e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517977e-01 1 1  ON 10
 ud_1                 1.857793e-01 1 1  ON 11
 ud_2                 6.523057e-02 1 1  ON 12
 ud_3                -6.207797e-03 1 1  ON 13
 ud_4                -6.386609e-02 1 1  ON 14
 ud_5                -1.064718e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547905e-01 1 1  ON 18
 ud_9                -1.443345e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319309e-01 1 1  ON 21
 eO_2                -1.711922e-02 1 1  ON 22
 eO_3                 2.995255e-01 1 1  ON 23
 eO_4                 5.275598e-01 1 1  ON 24
 eO_5                 4.928369e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851142e-02 1 1  ON 27
 eO_8                -2.366074e-01 1 1  ON 28
 eO_9                -1.050289e-01 1 1  ON 29
eH1_0                -2.613900e-01 1 1  ON 30
eH1_1                -1.560396e-01 1 1  ON 31
eH1_2                -1.069274e-01 1 1  ON 32
eH1_3                -5.147825e-02 1 1  ON 33
eH1_4                -1.896461e-03 1 1  ON 34
eH1_5                 3.378737e-02 1 1  ON 35
eH1_6                 9.534542e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940064e-01 1 1  ON 38
eH1_9                 9.580425e-02 1 1  ON 39
eH2_0                -2.608797e-01 1 1  ON 40
eH2_1                -1.549228e-01 1 1  ON 41
eH2_2                -1.056267e-01 1 1  ON 42
eH2_3                -5.017836e-02 1 1  ON 43
eH2_4                -4.285324e-04 1 1  ON 44
eH2_5                 3.598824e-02 1 1  ON 45
eH2_6                 9.731871e-02 1 1  ON 46
eH2_7                 1.586867e-01 1 1  ON 47
eH2_8                 2.004679e-01 1 1  ON 48
eH2_9                 9.150225e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8782
    reference variance = 0.203935
====================================================
  Execution time = 2.0047e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3774e-01
  Total weights = 2.0000e+06
  Execution time = 1.8469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758119783
                                         uncertainty =       0.006341108729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758119783
                                         uncertainty =       0.006341108729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410937408
  error estimate for blocks of size 2^( 2) =       0.000423900610
  error estimate for blocks of size 2^( 3) =       0.000437150169
  error estimate for blocks of size 2^( 4) =       0.000449976208
  error estimate for blocks of size 2^( 5) =       0.000461391959
  error estimate for blocks of size 2^( 6) =       0.000469405404
  error estimate for blocks of size 2^( 7) =       0.000475744551

      target function =                  N/A
              le_mean =     -16.905717219606
             les_mean =     286.141013647112
             stat err =       0.000464129531
             autocorr =       1.275636827211
              std dev =       0.581153255762
             le_variance =       0.337739106682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337757982916
                                         uncertainty =       0.006341107397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337757982916
                                         uncertainty =       0.006341107397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410937325
  error estimate for blocks of size 2^( 2) =       0.000423900531
  error estimate for blocks of size 2^( 3) =       0.000437150093
  error estimate for blocks of size 2^( 4) =       0.000449976134
  error estimate for blocks of size 2^( 5) =       0.000461391886
  error estimate for blocks of size 2^( 6) =       0.000469405333
  error estimate for blocks of size 2^( 7) =       0.000475744481

      target function =                  N/A
              le_mean =     -16.905717218917
             les_mean =     286.141013486958
             stat err =       0.000464129459
             autocorr =       1.275636948708
              std dev =       0.581153138030
             le_variance =       0.337738969842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758051334
                                         uncertainty =       0.006341108063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758051334
                                         uncertainty =       0.006341108063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410937366
  error estimate for blocks of size 2^( 2) =       0.000423900570
  error estimate for blocks of size 2^( 3) =       0.000437150131
  error estimate for blocks of size 2^( 4) =       0.000449976171
  error estimate for blocks of size 2^( 5) =       0.000461391922
  error estimate for blocks of size 2^( 6) =       0.000469405369
  error estimate for blocks of size 2^( 7) =       0.000475744516

      target function =                  N/A
              le_mean =     -16.905717219262
             les_mean =     286.141013567015
             stat err =       0.000464129495
             autocorr =       1.275636887974
              std dev =       0.581153196882
             le_variance =       0.337739038247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758111226
                                         uncertainty =       0.006341108646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758111226
                                         uncertainty =       0.006341108646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410937403
  error estimate for blocks of size 2^( 2) =       0.000423900605
  error estimate for blocks of size 2^( 3) =       0.000437150164
  error estimate for blocks of size 2^( 4) =       0.000449976203
  error estimate for blocks of size 2^( 5) =       0.000461391954
  error estimate for blocks of size 2^( 6) =       0.000469405400
  error estimate for blocks of size 2^( 7) =       0.000475744547

      target function =                  N/A
              le_mean =     -16.905717219563
             les_mean =     286.141013637099
             stat err =       0.000464129526
             autocorr =       1.275636834804
              std dev =       0.581153248401
             le_variance =       0.337739098128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905717219606        initial  <--
     1.4552e+03     1.4552e+04             1.1708e-07       -16.905717218917
     5.8208e+03     5.8208e+04             2.9270e-08       -16.905717219262
     2.3283e+04     2.3283e+05             7.3177e-09       -16.905717219563

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3813
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.111059e-01 1 1  ON 0
 uu_1                 1.435972e-01 1 1  ON 1
 uu_2                 4.146725e-02 1 1  ON 2
 uu_3                -2.161982e-02 1 1  ON 3
 uu_4                -6.789891e-02 1 1  ON 4
 uu_5                -1.040403e-01 1 1  ON 5
 uu_6                -1.333982e-01 1 1  ON 6
 uu_7                -1.486965e-01 1 1  ON 7
 uu_8                -1.415408e-01 1 1  ON 8
 uu_9                -1.116068e-01 1 1  ON 9
 ud_0                 4.517977e-01 1 1  ON 10
 ud_1                 1.857793e-01 1 1  ON 11
 ud_2                 6.523056e-02 1 1  ON 12
 ud_3                -6.207809e-03 1 1  ON 13
 ud_4                -6.386609e-02 1 1  ON 14
 ud_5                -1.064718e-01 1 1  ON 15
 ud_6                -1.353102e-01 1 1  ON 16
 ud_7                -1.533987e-01 1 1  ON 17
 ud_8                -1.547905e-01 1 1  ON 18
 ud_9                -1.443345e-01 1 1  ON 19
 eO_0                -7.534202e-01 1 1  ON 20
 eO_1                -4.319309e-01 1 1  ON 21
 eO_2                -1.711924e-02 1 1  ON 22
 eO_3                 2.995254e-01 1 1  ON 23
 eO_4                 5.275598e-01 1 1  ON 24
 eO_5                 4.928369e-01 1 1  ON 25
 eO_6                 2.675119e-01 1 1  ON 26
 eO_7                -3.851142e-02 1 1  ON 27
 eO_8                -2.366073e-01 1 1  ON 28
 eO_9                -1.050289e-01 1 1  ON 29
eH1_0                -2.613900e-01 1 1  ON 30
eH1_1                -1.560396e-01 1 1  ON 31
eH1_2                -1.069274e-01 1 1  ON 32
eH1_3                -5.147822e-02 1 1  ON 33
eH1_4                -1.896461e-03 1 1  ON 34
eH1_5                 3.378736e-02 1 1  ON 35
eH1_6                 9.534543e-02 1 1  ON 36
eH1_7                 1.573602e-01 1 1  ON 37
eH1_8                 1.940064e-01 1 1  ON 38
eH1_9                 9.580422e-02 1 1  ON 39
eH2_0                -2.608797e-01 1 1  ON 40
eH2_1                -1.549228e-01 1 1  ON 41
eH2_2                -1.056267e-01 1 1  ON 42
eH2_3                -5.017835e-02 1 1  ON 43
eH2_4                -4.285259e-04 1 1  ON 44
eH2_5                 3.598826e-02 1 1  ON 45
eH2_6                 9.731871e-02 1 1  ON 46
eH2_7                 1.586867e-01 1 1  ON 47
eH2_8                 2.004679e-01 1 1  ON 48
eH2_9                 9.150222e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5226e+01 secs
  Total Execution time = 2.2376e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
